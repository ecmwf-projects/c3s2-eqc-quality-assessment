
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. ERA5 monthly averaged data on pressure levels for studies on climate variability &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-era5-pressure-levels-monthly-means_variability_q04';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark pst-js-only" alt="eqcbook - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. ERA5 monthly averaged data on pressure levels for studies on climate variability</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-era5-pressure-levels-monthly-means_variability_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-era5-pressure-levels-monthly-means_variability_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ERA5 monthly averaged data on pressure levels for studies on climate variability</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitor-the-impact-of-enso-in-the-variability-of-tropospheric-circulation-in-the-tropical-pacific">🌍 Use case: Monitor the impact of ENSO in the variability of tropospheric circulation in the tropical Pacific.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request">Define data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval-and-computation-of-the-weighted-average">2. Datasets retrieval and computation of the weighted average</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-and-transform-data">Retrieve and transform data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-timing-of-major-el-nino-episodes">Define the timing of major El Niño episodes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="era5-monthly-averaged-data-on-pressure-levels-for-studies-on-climate-variability">
<h1><span class="section-number">3.1. </span>ERA5 monthly averaged data on pressure levels for studies on climate variability<a class="headerlink" href="#era5-monthly-averaged-data-on-pressure-levels-for-studies-on-climate-variability" title="Link to this heading">#</a></h1>
<p>Production date: 22-05-2024</p>
<section id="use-case-monitor-the-impact-of-enso-in-the-variability-of-tropospheric-circulation-in-the-tropical-pacific">
<h2>🌍 Use case: Monitor the impact of ENSO in the variability of tropospheric circulation in the tropical Pacific.<a class="headerlink" href="#use-case-monitor-the-impact-of-enso-in-the-variability-of-tropospheric-circulation-in-the-tropical-pacific" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>❓ Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is ERA5 able to consistently represent the impact of ENSO on the vertical structure of the tropical troposphere over the Pacific throughout the entire period 1940-present</strong></p></li>
</ul>
<p>The El Niño Southern Oscillation (ENSO) affects weather patterns worldwide, influencing precipitation, storm activity, and temperatures <a class="reference external" href="https://doi.org/10.1002/9781119548164.ch14">[1]</a>. It can cause extreme weather events such as floods, droughts, and hurricanes, impacting agriculture, water resources, and ecosystems. Understanding and predicting ENSO is crucial for mitigating its impacts on society and the environment.</p>
<p>This notebook provides an assessment of the quality of ERA5 in providing a long-term physically consistent description of the atmospheric variability in the tropics with specific reference to the central Pacific, in the area of the ENSO.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>ERA5 data on pressure levels provide a long-term time consistent description of the major El Niño episodes since 1940.</p></li>
<li><p>ERA5 provides physically coherent information on the expected impact the major warm El Nino episodes on the local variability of tropospheric dynamics.</p></li>
<li><p>Hence, ERA5 data on  is a reliable source for the investigation of the longer-term impact of climate change on the dynamics of El Niño Southern Oscillation</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis is focused in particular on the area underpinning the Niño 3.4 index (5S-5N, 170W-120W). We consider the variability of the Walker circulation <a class="reference external" href="https://doi.org/10.3402/tellusa.v18i4.9712">[2]</a> , a large-scale atmospheric circulation pattern over the equatorial Pacific, characterized by east-west trade winds at the surface, rising air over the warm western Pacific, west-to-east upper-level winds, and descending air over the cooler eastern Pacific. The analysis is performed by considering the monthly anomalies of temperature and the associated changes in the low-level easterly winds as well as the corresponding higher-level westerlies. The impact on realtive humidity and cloud cover is also considered.</p>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id1"><span class="std std-ref">1. Choose the data to use and setup the code</span></a></strong></p>
<ul class="simple">
<li><p>Import required packages</p></li>
<li><p>Define data request</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id2"><span class="std std-ref">2. Datasets retrieval and computation of the weighted average</span></a></strong></p>
<ul class="simple">
<li><p>Dataset retrieval an processing</p></li>
<li><p>Define the timing of major El Niño episodes</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id3"><span class="std std-ref">3. Plot and describe results</span></a></strong></p>
<ul class="simple">
<li><p>Display results</p></li>
<li><p>Discussion</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-setup-the-code">
<span id="reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id1"></span><h3>1. Choose the data to use and setup the code<a class="headerlink" href="#choose-the-data-to-use-and-setup-the-code" title="Link to this heading">#</a></h3>
<section id="import-required-packages">
<h4>Import required packages<a class="headerlink" href="#import-required-packages" title="Link to this heading">#</a></h4>
<p>Only a few standard libraries are sufficients for this notebook: <code class="docutils literal notranslate"><span class="pre">xarray</span></code> for the handling of datasets, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> for the graphical output and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to convert the dates of the major ENSO events.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span>
<span class="kn">from</span> <span class="nn">c3s_eqc_automatic_quality_control</span> <span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-data-request">
<h4>Define data request<a class="headerlink" href="#define-data-request" title="Link to this heading">#</a></h4>
<p>For this quality assessement, data with the following characteristics are required:</p>
<ul class="simple">
<li><p>the entire time span of ERA5, from 1940 to present;</p></li>
<li><p>5 variables to summarize key dynamic, thermodynamic and chemical aspects of the state of the atmosphere;</p></li>
<li><p>27 pressure levels of ERA5.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-pressure-levels-monthly-means&quot;</span>

<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1940-01&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># None: present</span>

<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;u_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;relative_humidity&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fraction_of_cloud_cover&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;vertical_velocity&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">pressure_levels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;100&quot;</span><span class="p">,</span><span class="s2">&quot;125&quot;</span><span class="p">,</span><span class="s2">&quot;150&quot;</span><span class="p">,</span><span class="s2">&quot;175&quot;</span><span class="p">,</span><span class="s2">&quot;200&quot;</span><span class="p">,</span><span class="s2">&quot;225&quot;</span><span class="p">,</span><span class="s2">&quot;250&quot;</span><span class="p">,</span><span class="s2">&quot;300&quot;</span><span class="p">,</span><span class="s2">&quot;350&quot;</span><span class="p">,</span><span class="s2">&quot;400&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;450&quot;</span><span class="p">,</span><span class="s2">&quot;500&quot;</span><span class="p">,</span><span class="s2">&quot;550&quot;</span><span class="p">,</span><span class="s2">&quot;600&quot;</span><span class="p">,</span><span class="s2">&quot;650&quot;</span><span class="p">,</span><span class="s2">&quot;700&quot;</span><span class="p">,</span><span class="s2">&quot;750&quot;</span><span class="p">,</span><span class="s2">&quot;775&quot;</span><span class="p">,</span><span class="s2">&quot;800&quot;</span><span class="p">,</span><span class="s2">&quot;825&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;850&quot;</span><span class="p">,</span><span class="s2">&quot;875&quot;</span><span class="p">,</span><span class="s2">&quot;900&quot;</span><span class="p">,</span><span class="s2">&quot;925&quot;</span><span class="p">,</span><span class="s2">&quot;950&quot;</span><span class="p">,</span><span class="s2">&quot;975&quot;</span><span class="p">,</span><span class="s2">&quot;1000&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="datasets-retrieval-and-computation-of-the-weighted-average">
<span id="reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id2"></span><h3>2. Datasets retrieval and computation of the weighted average<a class="headerlink" href="#datasets-retrieval-and-computation-of-the-weighted-average" title="Link to this heading">#</a></h3>
<section id="retrieve-and-transform-data">
<h4>Retrieve and transform data<a class="headerlink" href="#retrieve-and-transform-data" title="Link to this heading">#</a></h4>
<p>The analysis in focused on the local effects of ENSO. Therefore ERA5 data on pressure levels are retrieved over the area of the NINO3.4 index <a class="reference external" href="https://doi.org/10.1175/1520-0477(1997)078%3C2771:TDOENO%3E2.0.CO;2">[3]</a>, which is commonly adopted as a conventional basis for the definition of NINO events.</p>
<p>A basic processing is applied to the data, consisting of:</p>
<ol class="arabic simple">
<li><p>Download the ERA5 monthly temperature, U component of wind, vertical velocity, realtive humidity and cloud cover for the period 1940 - to present on all pressure levels available.</p></li>
<li><p>Calculate the spatial weighted mean of each variable over the NINO3.4 area.</p></li>
<li><p>Calculate the difference betweethe monthly vertical profiles of each variable and the corresponding monthly climatology.</p></li>
</ol>
<p>NOTE: the units of the vertical pressure levels are converted from Pascal (Pa) to hecto-Pascal (hPa), which is equivalent to millibars (mb).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading and processing </span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1">#Define a general request</span>
    <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
     <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
     <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">,</span>
     <span class="s2">&quot;pressure_level&quot;</span><span class="p">:</span> <span class="n">pressure_levels</span> <span class="p">,</span>
     <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
     <span class="s2">&quot;area&quot;</span><span class="p">:</span> 
        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">170</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="c1">#Update the request dictionary to include all dates between start and stop</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">stop</span><span class="p">)</span>
    
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
      <span class="n">collection_id</span><span class="p">,</span>
      <span class="n">requests</span><span class="p">,</span>
      <span class="n">transform_func</span><span class="o">=</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">,</span>
      <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">ds_era5</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>

<span class="c1">#Convert plev to hPa (mb)</span>
<span class="n">ds_era5</span><span class="p">[</span><span class="s2">&quot;plev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era5</span><span class="p">[</span><span class="s2">&quot;plev&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span>
<span class="n">ds_era5</span><span class="p">[</span><span class="s2">&quot;plev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Level&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;hPa&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and processing temperature
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 84/84 [00:08&lt;00:00, 10.27it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and processing u_component_of_wind
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 84/84 [00:07&lt;00:00, 10.96it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and processing relative_humidity
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 84/84 [00:07&lt;00:00, 10.60it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and processing fraction_of_cloud_cover
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 84/84 [00:07&lt;00:00, 11.62it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading and processing vertical_velocity
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 84/84 [00:07&lt;00:00, 10.85it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-the-timing-of-major-el-nino-episodes">
<h4>Define the timing of major El Niño episodes<a class="headerlink" href="#define-the-timing-of-major-el-nino-episodes" title="Link to this heading">#</a></h4>
<p>The timing of the major Niño episodes are derived from an independent source - the <a class="reference external" href="https://origin.cpc.ncep.noaa.gov/products/analysis_monitoring/ensostuff/ONI_v5.php">
Historical El Niño/ La Niña episodes (1950-present)</a>  web page at the Climate Prediction Center CPC - and  only episodes with Oceanic Niño Index &gt; 1°C are considered. For convenience, we set the timing of each warm episode at the beginning of the central month of the corresponding peak value of the Oceanic Niño Index in the CPC table. Note that the CPC table reports past El Niño episodes until 1950, whereas the analysis performed with ERA5 goes back to 1940.
.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ninos</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;1951-10-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1958-01-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1963-11-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1965-10-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1969-01-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1972-10-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1982-11-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1987-08-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1992-01-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1997-10-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2002-11-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2009-12-01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2015-11-01&#39;</span><span class="p">,</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="reanalysis-reanalysis-era5-pressure-levels-monthly-means-variability-q04-id3"></span><h3>3. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<p>Results are illustrated by means of Hovmöller diagrams showing each variable as a function in time vs pressure, with vertical lines emphasizing the timing of all major El Niño episodes</p>
<p>The local impact of El Niño on atmospheric dynamics is described by showing for each variable the time series of the vertical profiles of monthly anomalies compared to the mean values over the entire period covered by ERA5.  The color ranges are set to emphasize the main features in the long term variability. We use a linear vertical scale for all variables, in order to focus on the processes occurring in the troposphere.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">ds_anoma</span> <span class="o">=</span> <span class="n">ds_era5</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time.month&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">ds_era5</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">varname</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_anoma</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
      <span class="n">ds_anoma</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era5</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; anomaly&quot;</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">varname</span><span class="si">}</span><span class="s2"> min.:</span><span class="si">{</span><span class="n">ds_anoma</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">plev</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">  max:</span><span class="si">{</span><span class="n">ds_anoma</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">plev</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">toplot</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Temperature&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;vname&quot;</span>   <span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span>
       <span class="s2">&quot;levels&quot;</span>  <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
       <span class="s2">&quot;cmap&quot;</span>    <span class="p">:</span> <span class="s2">&quot;RdBu_r&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;U component of wind&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;vname&quot;</span>   <span class="p">:</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span>
       <span class="s2">&quot;levels&quot;</span>  <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="s2">&quot;cmap&quot;</span>    <span class="p">:</span> <span class="s2">&quot;PuOr&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Vertical velocity&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;vname&quot;</span>   <span class="p">:</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span>
       <span class="s2">&quot;levels&quot;</span>  <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">+</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
       <span class="s2">&quot;cmap&quot;</span>    <span class="p">:</span> <span class="s2">&quot;PuOr&quot;</span>
    <span class="p">},</span>    
    <span class="s2">&quot;Relative Humidity&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;vname&quot;</span>   <span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span>
       <span class="s2">&quot;levels&quot;</span>  <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
       <span class="s2">&quot;cmap&quot;</span>    <span class="p">:</span> <span class="s2">&quot;BrBG&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Fraction of Cloud Cover&quot;</span> <span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;vname&quot;</span>   <span class="p">:</span> <span class="s2">&quot;cc&quot;</span><span class="p">,</span>
       <span class="s2">&quot;levels&quot;</span>  <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
       <span class="s2">&quot;cmap&quot;</span>    <span class="p">:</span> <span class="s2">&quot;PRGn&quot;</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toplot</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toplot</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ds_anoma</span><span class="p">[</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">],</span><span class="n">ds_anoma</span><span class="p">[</span><span class="s2">&quot;plev&quot;</span><span class="p">],</span>
                         <span class="n">ds_anoma</span><span class="p">[</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;vname&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;plev&quot;</span><span class="p">,</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">),</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;levels&quot;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">varname</span> <span class="o">+</span> <span class="s1">&#39; Anomaly&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[mb]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">ds_anoma</span><span class="p">[</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;vname&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">])</span>   
    <span class="c1"># Add eruptions</span>
    <span class="k">for</span> <span class="n">nino</span> <span class="ow">in</span> <span class="n">ninos</span><span class="p">:</span>   
        <span class="n">nino_date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">nino</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">nino_date</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Major El Nino events in the Nino3.4 area&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.92</span><span class="p">)</span>    
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t min.:-4.911510087996021  max:3.7686599673425007
u min.:-25.134435210605417  max:19.398713666322774
r min.:-23.12863555654127  max:46.092628059811325
cc min.:-0.11318701877117414  max:0.491990246796542
w min.:-0.12235996312153946  max:0.03926223057248084
</pre></div>
</div>
<img alt="../_images/273eabec3386eb2748cce8d9389ba7903778e5cde230c6885b8d2c331dbb4779.png" src="../_images/273eabec3386eb2748cce8d9389ba7903778e5cde230c6885b8d2c331dbb4779.png" />
</div>
</div>
<p>In the figure above, all major El Niño episodes are well described, and the vertical structure of the local atmospheric dynamics over the NINO3.4 index area is coherent with the mechanism of variability described by Lau and Yang (2003)<a class="reference external" href="https://doi.org/10.1016/B0-12-227090-8/00450-4">[4]</a>.</p>
<ul class="simple">
<li><p>Warm <strong>temperature</strong> anomalies are  occur in the higher troposphere, in line with the atmospheric deep convenction mechanism initially described in previous studies <a class="reference external" href="https://doi.org/10.1029/JC092iC13p14197">[5]</a>.</p></li>
<li><p>During El Niño episodes the the weakening of easterly winds (from west to east) at the surface correspond to a positive sign anomaly in the <strong>U component of the wind</strong> (which is positive from west to east).  At the same time, the weakening of westerly winds at in the higer troposphere is associated to anomalies of a negative sign.</p></li>
<li><p>Negative anomalies in the <strong>vertical velocity</strong> expressed <span class="math notranslate nohighlight">\(\omega\)</span> in <span class="math notranslate nohighlight">\(Pa/s^{-1}\)</span>, correspond to stronger uplift in terms of vertical velocity <span class="math notranslate nohighlight">\(w\)</span> expressed in <span class="math notranslate nohighlight">\(m/s\)</span>, corresponding to a stronger deep convection activity.</p></li>
<li><p>As a consequence, the area is also characterized by higher values of <strong>relative umidity</strong> and a larger fraction of <strong>cloud cover</strong> by high clouds.</p></li>
</ul>
<p>Notice that the stong El Niño episode of 1940-1942 is not reported in the CPC table but has been already docuemented in previous studies <a class="reference external" href="https://doi.org/10.1038/nature02982">[6]</a> and is well captured in the back extention of ERA5, consistently with the more recent episodes.</p>
<p>A closer look at this mechanism of variability is presented in the figure below, which shows in more details the El Niño episode of 1997/1998.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Set time interval to display</span>
<span class="n">xlim</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;1995-10-01&#39;</span><span class="p">,</span><span class="s1">&#39;2000-10-01&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64&#39;</span><span class="p">)</span> <span class="c1"># Zoom on the warm event of 1997-1998</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toplot</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">varname</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toplot</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ds_anoma</span><span class="p">[</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">],</span><span class="n">ds_anoma</span><span class="p">[</span><span class="s2">&quot;plev&quot;</span><span class="p">],</span>
                         <span class="n">ds_anoma</span><span class="p">[</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;vname&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="s2">&quot;plev&quot;</span><span class="p">,</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">),</span>
                         <span class="n">cmap</span><span class="o">=</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;levels&quot;</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">800</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">varname</span> <span class="o">+</span> <span class="s1">&#39; Anomaly&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[mb]&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">ds_anoma</span><span class="p">[</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;vname&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">])</span>   
    <span class="c1"># Add eruptions</span>
    <span class="k">for</span> <span class="n">nino</span> <span class="ow">in</span> <span class="n">ninos</span><span class="p">:</span>   
        <span class="n">nino_date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">nino</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">nino_date</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;El Nino 1997-1998&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.92</span><span class="p">)</span>    
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/53136e2cc34e77db4ed1b79b22141d1a5a1db3a70fb00340eba59f9bf6ba1017.png" src="../_images/53136e2cc34e77db4ed1b79b22141d1a5a1db3a70fb00340eba59f9bf6ba1017.png" />
</div>
</div>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1002/9781119548164.ch14">[1]</a> Taschetto, A. S., Ummenhofer, C. C., Stuecker, M. F., Dommenget, D., Ashok, K., Rodrigues, R. R., &amp; Yeh, S. W. (2020). ENSO atmospheric teleconnections. El Niño southern oscillation in a changing climate, 309-335.</p>
<p><a class="reference external" href="https://doi.org/10.3402/tellusa.v18i4.9712">[2]</a> Bjerknes, J. (1966). A possible response of the atmospheric Hadley circulation to equatorial anomalies of ocean temperature. Tellus, 18(4), 820-829.</p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0477(1997)078%3C2771:TDOENO%3E2.0.CO;2">[3]</a> Trenberth, K. E. (1997). The definition of el nino. Bulletin of the American Meteorological Society, 78(12), 2771-2778.</p>
<p><a class="reference external" href="https://doi.org/10.1016/B0-12-227090-8/00450-4">[4]</a> Lau, K. M., &amp; Yang, S. (2003). Walker circulation. Encyclopedia of atmospheric sciences, 2505(2510), 00450-4.</p>
<p><a class="reference external" href="https://doi.org/10.1029/JC092iC13p14197">[5]</a> Gage, K. S., &amp; Reid, G. C. (1987). Longitudinal variations in tropical tropopause properties in relation to tropical convection and El Niño‐Southern Oscillation events. Journal of Geophysical Research: Oceans, 92(C13), 14197-14203.</p>
<p><a class="reference external" href="https://doi.org/10.1038/nature02982">[6]</a> Brönnimann, S., Luterbacher, J., Staehelin, J., Svendby, T. M., Hansen, G., &amp; Svenøe, T. (2004). Extreme climate of the global troposphere and stratosphere in 1940–42 related to El Niño. Nature, 431(7011), 971-974.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitor-the-impact-of-enso-in-the-variability-of-tropospheric-circulation-in-the-tropical-pacific">🌍 Use case: Monitor the impact of ENSO in the variability of tropospheric circulation in the tropical Pacific.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request">Define data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval-and-computation-of-the-weighted-average">2. Datasets retrieval and computation of the weighted average</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-and-transform-data">Retrieve and transform data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-timing-of-major-el-nino-episodes">Define the timing of major El Niño episodes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>