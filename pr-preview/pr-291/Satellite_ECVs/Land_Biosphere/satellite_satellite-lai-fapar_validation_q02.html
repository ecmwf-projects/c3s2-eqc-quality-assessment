
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4.1. Trend Analysis of Annual LAI in China &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Biosphere/satellite_satellite-lai-fapar_validation_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5. Land Hydrology" href="../Land_Hydrology/Land_Hydrology.html" />
    <link rel="prev" title="1.4. Land Biosphere" href="Land_Biosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark pst-js-only" alt="eqcbook - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Biosphere.html">1.4. Land Biosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.4.1. Trend Analysis of Annual LAI in China</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Biosphere/satellite_satellite-lai-fapar_validation_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Biosphere/satellite_satellite-lai-fapar_validation_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Trend Analysis of Annual LAI in China</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-utilize-satellite-effecive-lai-data-to-monitor-vegetation-dynamics-under-climate-change">🌍 Use case: Utilize satellite effecive LAI data to monitor vegetation dynamics under climate change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and Download Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import Packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">Set Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">Define functions to cache</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">Download and transform</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">2. Plot time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-to-literature">3. Comparison to Literature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="trend-analysis-of-annual-lai-in-china">
<h1><span class="section-number">1.4.1. </span>Trend Analysis of Annual LAI in China<a class="headerlink" href="#trend-analysis-of-annual-lai-in-china" title="Link to this heading">#</a></h1>
<p>Production date: 09-Jan-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-utilize-satellite-effecive-lai-data-to-monitor-vegetation-dynamics-under-climate-change">
<h2>🌍 Use case: Utilize satellite effecive LAI data to monitor vegetation dynamics under climate change<a class="headerlink" href="#use-case-utilize-satellite-effecive-lai-data-to-monitor-vegetation-dynamics-under-climate-change" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>❓ Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<p><strong>Are satellite data suitable for detecting changes in the yearly mean of effective LAI observed in China over the past 20 years?</strong></p>
<p>The dataset: Leaf Area Index (LAI) and Fraction Absorbed of Photosynthetically Active Radiation 10-daily gridded data from 1981 to present, by the Climate Data Store (CDS), contains LAI (effective) values derived from observations of different satellites and sensors. LAI is defined as half the developed area of photosynthetically active elements of the vegetation per unit horizontal ground area. It relates to effective LAI through a canopy-dependent structure factor. This parameter is a useful tool for assessing vegetation, understanding ecosystem dynamics, and addressing environmental and agricultural challenges.</p>
<p>The goal of this quality assessment is to analyze the trend of yearly mean LAI (effective) over the past 20 years in China. An increase in LAI has been observed over China in the past two decades due to factors such as climate change and human activities <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a>. Ma et al. (2023) observed a linear trend with a strong positive correlation of true LAI over time. They used data from GLASS LAI, which is based on MODIS <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0034425722000992">[2]</a>. Because of the period for analysis, we used version 3 of the dataset, relying on data from SPOT-VGT (Système Probatoire pour l’Observation de la Terre) for the period 2001–2013 and from PROBA-V (Project for On-Board Autonomy) for 2014–2019. Therefore, we analyzed the transition and differences between the data from these two satellites.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Effective LAI values derived from PROBA-V and its predecessor SPOT-VGT show notable differences, likely due to PROBA-V’s superior spatial detail. This enhanced resolution, particularly in fragmented landscapes, makes the data from 2014 onwards more reliable.</p></li>
<li><p>Effective LAI values (CDS dataset) are generally lower than true LAI (GLASS dataset) due to differences in canopy structure assumptions. True LAI from GLASS showed a slope of 0.0202 yr⁻¹, closer to PROBA-V’s effective LAI than SPOT-VGT’s.</p></li>
<li><p>The trend of effective LAI over time shows a possitive linear correlation, which reflects the greening of China over the past two decades. Altough, it is worth mentioning the last full year with information was 2019 at the moment the analysis was carried out.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-lai-fapar-validation-q02-section-1"><span class="std std-ref">1. Request and Download Data</span></a></strong></p>
<ul class="simple">
<li><p>Download the LAI (effective) variable with dekad frecuency for the period 2001-2019.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lai-fapar-validation-q02-section-2"><span class="std std-ref">2. Plot time series</span></a></strong></p>
<ul class="simple">
<li><p>Plot the effective LAI values over time and calculate linear trends.</p></li>
<li><p>Analize the results.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lai-fapar-validation-q02-section-3"><span class="std std-ref">3. Comparison to Literature</span></a></strong></p>
<ul class="simple">
<li><p>Compare the results obtained in this work and the ones from literature.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="request-and-download-data">
<span id="satellite-satellite-lai-fapar-validation-q02-section-1"></span><h3>1. Request and Download Data<a class="headerlink" href="#request-and-download-data" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import Packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/trigoso_camila/.cdsapirc&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>Set Parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<p>Since the year 2020 only has information for the first half of the  year, we only downloaded data from 2001 to 2019.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_start</span> <span class="o">=</span> <span class="mi">2001</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2019</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests">
<h4>Define requests<a class="headerlink" href="#define-requests" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-lai-fapar&quot;</span>
<span class="n">base_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;lai&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span>
    <span class="s2">&quot;product_version&quot;</span><span class="p">:</span> <span class="s2">&quot;v3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">53</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">135</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;ME&quot;</span><span class="p">):</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">base_request</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;spot&quot;</span> <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">2013</span> <span class="k">else</span> <span class="s2">&quot;proba&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">year</span><span class="p">),</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nominal_day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">day</span><span class="p">)],</span>
        <span class="p">}</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-to-cache">
<h4>Define functions to cache<a class="headerlink" href="#define-functions-to-cache" title="Link to this heading">#</a></h4>
<p>In this step, we also filtered out data flagged as unreliable, keeping only the “good” data. The instructions in the <a class="reference external" href="http://dast.data.compute.cci2.ecmwf.int/documents/satellite-lai-fapar/D3.3.9-v3.0_PUGS_CDR_LAI_FAPAR_MULTI_SENSOR_v3.0_PRODUCTS_v1.0.1.pdf">documentation</a> related to flags were followed.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">spatial_weighted_mean_over_china</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">defined_regions</span><span class="o">.</span><span class="n">natural_earth_v5_0_0</span><span class="o">.</span><span class="n">countries_110</span>

    <span class="n">spatial_mask</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">regions</span><span class="o">.</span><span class="n">map_keys</span><span class="p">([</span><span class="s2">&quot;China&quot;</span><span class="p">])]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
    <span class="n">flag_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;retrieval_flag&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFC1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">lai_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;LAI&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">65_535</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s2">&quot;LAI&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spatial_mask</span> <span class="o">&amp;</span> <span class="n">flag_mask</span> <span class="o">&amp;</span> <span class="n">lai_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform">
<h4>Download and transform<a class="headerlink" href="#download-and-transform" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">spatial_weighted_mean_over_china</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;LAI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 228/228 [00:07&lt;00:00, 29.10it/s]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-time-series">
<span id="satellite-satellite-lai-fapar-validation-q02-section-2"></span><h3>2. Plot time series<a class="headerlink" href="#plot-time-series" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.39563351, 0.39747345, 0.40319939, 0.40436953, 0.39948895,
       0.40948193, 0.40769001, 0.43228232, 0.42104475, 0.42800853,
       0.41800598, 0.43288172, 0.47039173, 0.49593169, 0.51579111,
       0.53632915, 0.56801868, 0.57510155, 0.56714279])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract LAI values into a Python list</span>
<span class="n">lai</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Extract years into a Python list</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Splitting data for trendlines</span>
<span class="n">years_2001_2013</span> <span class="o">=</span> <span class="n">years</span><span class="p">[:</span><span class="mi">13</span><span class="p">]</span>
<span class="n">lai_2001_2013</span> <span class="o">=</span> <span class="n">lai</span><span class="p">[:</span><span class="mi">13</span><span class="p">]</span>

<span class="n">years_2014_2019</span> <span class="o">=</span> <span class="n">years</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>
<span class="n">lai_2014_2019</span> <span class="o">=</span> <span class="n">lai</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>

<span class="c1"># Trendline for 2001-2013</span>
<span class="n">slope_2001_2013</span><span class="p">,</span> <span class="n">intercept_2001_2013</span><span class="p">,</span> <span class="n">r_value_2001_2013</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">years_2001_2013</span><span class="p">,</span> <span class="n">lai_2001_2013</span><span class="p">)</span>
<span class="n">trendline_2001_2013</span> <span class="o">=</span> <span class="p">[</span><span class="n">slope_2001_2013</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept_2001_2013</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">years_2001_2013</span><span class="p">]</span>

<span class="c1"># Trendline for 2014-2019</span>
<span class="n">slope_2014_2019</span><span class="p">,</span> <span class="n">intercept_2014_2019</span><span class="p">,</span> <span class="n">r_value_2014_2019</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">years_2014_2019</span><span class="p">,</span> <span class="n">lai_2014_2019</span><span class="p">)</span>
<span class="n">trendline_2014_2019</span> <span class="o">=</span> <span class="p">[</span><span class="n">slope_2014_2019</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept_2014_2019</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">years_2014_2019</span><span class="p">]</span>

<span class="c1"># Trendline for all data</span>
<span class="n">slope_all</span><span class="p">,</span> <span class="n">intercept_all</span><span class="p">,</span> <span class="n">r_value_all</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">lai</span><span class="p">)</span>
<span class="n">trendline_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">slope_all</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept_all</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">lai</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_2001_2013</span><span class="p">,</span> <span class="n">trendline_2001_2013</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Trend 2001-2013 SPOT (R²=</span><span class="si">{</span><span class="n">r_value_2001_2013</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_2014_2019</span><span class="p">,</span> <span class="n">trendline_2014_2019</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Trend 2014-2019 PROBA (R²=</span><span class="si">{</span><span class="n">r_value_2014_2019</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">trendline_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Trend All (R²=</span><span class="si">{</span><span class="n">r_value_all</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">years</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="c1"># Labels and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Effective LAI (m²/m²)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Save the plot as a file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LeafIndex/lai_trend_ALL_2001_2019.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/a98f71003ef4607e947fa3c7a35e3d35aa5ec425e16e1207e05918f9558ba14d.png" src="../../_images/a98f71003ef4607e947fa3c7a35e3d35aa5ec425e16e1207e05918f9558ba14d.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-annual-lai-all-cds" style="width: 100%">
<img alt="../../_images/1ed6b630-351d-48b2-8e53-69514c15ee7a.png" src="../../_images/1ed6b630-351d-48b2-8e53-69514c15ee7a.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.4.1.1 </span><span class="caption-text">Scattered plot of the spatial and yearly mean of effective LAI in China for all years between 2001-2019 with trendlines.</span><a class="headerlink" href="#fig-annual-lai-all-cds" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the equations of the trendlines</span>
<span class="n">eq_2001_2013</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;2001-2013: y = </span><span class="si">{</span><span class="n">slope_2001_2013</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="n">intercept_2001_2013</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">eq_2014_2019</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;2014-2019: y = </span><span class="si">{</span><span class="n">slope_2014_2019</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="n">intercept_2014_2019</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">eq_all</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;All: y = </span><span class="si">{</span><span class="n">slope_all</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">x + </span><span class="si">{</span><span class="n">intercept_all</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eq_2001_2013</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eq_2014_2019</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eq_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2001-2013: y = 0.0045x + -8.6438
2014-2019: y = 0.0162x + -32.0480
All: y = 0.0106x + -20.7846
</pre></div>
</div>
</div>
</div>
<p>The data presented in (<a class="reference internal" href="#fig-annual-lai-all-cds"><span class="std std-ref">Scattered plot of the spatial and yearly mean of effective LAI in China for all years between 2001-2019 with trendlines.</span></a>) was sourced from the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lai-fapar?tab=download">CDS</a>. We utilized version 3 of this dataset, which incorporates data from different satellites and sensors over varying time periods. For our analysis, we selected data from SPOT-VGT for the period 2001–2013, and from PROBA-V for 2014–2019. SPOT-VGT provided data for 15 years until May 2014, when it was replaced by PROBA-V. Both satellites offer a horizontal resolution of 1 km. Despite sharing the same nominal spatial resolution, their sensors exhibit differing levels of spatial quality. Notably, PROBA-V delivers higher spatial detail, which is particularly significant in fragmented landscapes <a class="reference external" href="https://publications.jrc.ec.europa.eu/repository/bitstream/JRC96277/lb-na-27327-en-n%20.pdf">[3]</a>.</p>
<p>The results of our analysis indicate a positive correlation of effective LAI over time. Notably, the slopes of the linear trends differ significantly depending on the satellite used. For the period 2001–2013, data from SPOT-VGT yielded a slope of 0.0045 yr<sup>-1</sup>. In contrast, for the period 2014–2019, PROBA-V data produced a steeper slope of 0.0162 yr<sup>-1</sup>, which is 3.6 times higher. Given that the analysis encompasses the entire surface of China, PROBA-V likely provides more accurate measurements, particularly in areas with fragmented landscapes. Its ability to capture finer vegetation details and higher LAI values in border regions between agricultural land and other land use types enhances the quality of the measurements.</p>
</section>
<section id="comparison-to-literature">
<span id="satellite-satellite-lai-fapar-validation-q02-section-3"></span><h3>3. Comparison to Literature<a class="headerlink" href="#comparison-to-literature" title="Link to this heading">#</a></h3>
<p>Ma et al. (2023)<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a> studied the trend of Leaf Area Index (LAI) in China from 2001 to 2020 within the context of climate change. They analyzed its relationship with various parameters, including temperature, precipitation, aerosol optical depth, and photosynthetically active radiation. For their study, they utilized the Global Land Surface Satellite (GLASS) LAI dataset, which was found to be more accurate than the CYCLOPES and Moderate Resolution Imaging Spectroradiometer (MODIS) LAI products when compared to ground measurements <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a>.</p>
<p>The GLASS LAI product is based on MODIS data but addresses several of its limitations, such as frequent temporal fluctuations, large data gaps, high dependence on surface reflectance quality, and low computational efficiency. This was achieved through the application of a deep learning model. Among the four machine learning models tested, the Bidirectional Long Short-Term Memory (Bi-LSTM) model was identified as the most effective solution <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0034425722000992">[2]</a>.</p>
<p>An important distinction between the CDS data we used and the GLASS data is that CDS provides effective LAI values, while GLASS offers true LAI values.</p>
<p>The definition of true LAI is half of the total green leaf area per unit of horizontal land surface, often used in 3D simulations <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0034425722000992">[2]</a>. In contrast, effective LAI assumes a homogeneous canopy composed of infinitesimally small Lambertian surfaces, resembling a turbid medium. This assumption aligns with the principles of the Two-stream Model, as described in Pinty et al. (2006) <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2005JD005952">[4]</a>.</p>
<p>According to Pinty et al.:</p>
<p>“The values of effective LAI appropriate for 1-D models should be smaller than the true values by a factor varying from 0.3 for sparse to 0.8 for dense forest canopies” <a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2005JD005952">[4]</a>.</p>
<p>As noted by the <a class="reference external" href="http://dast.data.compute.cci2.ecmwf.int/documents/satellite-lai-fapar/D3.3.9-v3.0_PUGS_CDR_LAI_FAPAR_MULTI_SENSOR_v3.0_PRODUCTS_v1.0.1.pdf">documentation</a> of the CDS dataset, the effective LAI is related to “true” LAI through a canopy-dependent structure factor. Because the extent of the study is China, one potential approach to approximating the true LAI, without resorting to overly complex methods, could involve referencing bibliographic sources to estimate the canopy-dependent structure factor based on land-use or land cover types. For example, using supplementary data, such as MODIS Land Cover data.</p>
<figure class="align-default" id="fig-annual-lai-glass-lai">
<a class="reference internal image-reference" href="../../_images/b838e0c7-e293-44a0-900f-52d7a6aa432e.png"><img alt="../../_images/b838e0c7-e293-44a0-900f-52d7a6aa432e.png" src="../../_images/b838e0c7-e293-44a0-900f-52d7a6aa432e.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.4.1.2 </span><span class="caption-text">Annual mean true LAI in China from 2001 to 2020 and rendline. Source: (Ma et al. 2023) <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a></span><a class="headerlink" href="#fig-annual-lai-glass-lai" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Therefore, compraring (<a class="reference internal" href="#fig-annual-lai-all-cds"><span class="std std-ref">Scattered plot of the spatial and yearly mean of effective LAI in China for all years between 2001-2019 with trendlines.</span></a>) and (<a class="reference internal" href="#fig-annual-lai-glass-lai"><span class="std std-ref">Annual mean true LAI in China from 2001 to 2020 and rendline. Source: (Ma et al. 2023) [1]</span></a>), it can be observed that, as it would be expected, the values of effective LAI are lower than the ones of the true LAI. The slopes are also lower for the effective LAI. The slope for true LAI was of 0.0202 yr<sup>-1</sup> which is closer to the one obesrved for the effective LAI retrived by PROBA-V than by SPOT-VGT.</p>
<p>Although calculating true LAI demands additional steps and supplementary data, the effective LAI dataset remains highly valuable. It aligns with the well-documented greening trend observed in China over the past two decades due to human activities and climate change impacts <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a>.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>List some key resources related to this assessment. E.g. CDS entries, applications, dataset documentation, external pages.
Also list any code libraries used (if applicable).</p>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">BOpen</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1470160X23012438">[1]</a> Ma, Y., Wang, W., Jin, S., Li, H., Liu, B., Gong, W., Fan, R., &amp; Li, H. (2023). Spatiotemporal variation of LAI in different vegetation types and its response to climate change in China from 2001 to 2020. Ecological Indicators.</p>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0034425722000992">[2]</a> Ma, H. &amp; Liang, S. (2022). Development of the GLASS 250-m leaf area index product (version 6) from MODIS data using the bidirectional LSTM deep learning model. Remote Sensing of Environment.</p>
<p><a class="reference external" href="https://publications.jrc.ec.europa.eu/repository/bitstream/JRC96277/lb-na-27327-en-n%20.pdf">[3]</a> Meroni, M., Fasbender, D., Balaghi, R., Dali, M., Hafani, M., Haythem, I., Hooker, J., Lahlou, M., Lopez-Lozano, R., Mahyou, H., Moncef, B. M., Sghaier, N., Wafa, T., &amp; Leo, O. (2015). Testing VGT data continuity between SPOT and PROBA-V missions for operational yield forecasting in North African countries. Joint Research Centre (JRC).</p>
<p><a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2005JD005952">[4]</a> Pinty, B., Lavergne, T., Dickinson, R. E., Widlowski, J.-L., Gobron, N., &amp; Verstraete, M. M. (2006). Simplifying the interaction of land surfaces with radiation for relating remote sensing products to climate models. Journal of Geophysical Research: AtmospheresVolume 111, Issue D2.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Biosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Biosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Hydrology/Land_Hydrology.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-utilize-satellite-effecive-lai-data-to-monitor-vegetation-dynamics-under-climate-change">🌍 Use case: Utilize satellite effecive LAI data to monitor vegetation dynamics under climate change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and Download Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import Packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">Set Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests">Define requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">Define functions to cache</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">Download and transform</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">2. Plot time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-to-literature">3. Comparison to Literature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>