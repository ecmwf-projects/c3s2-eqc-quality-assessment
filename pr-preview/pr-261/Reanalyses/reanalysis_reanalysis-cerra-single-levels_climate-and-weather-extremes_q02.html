
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Validation of CERRA for application in urban adaptation to climate extremes &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-cerra-single-levels_climate-and-weather-extremes_q02';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark pst-js-only" alt="eqcbook - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Validation of CERRA for application in urban adaptation to climate extremes</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-cerra-single-levels_climate-and-weather-extremes_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-cerra-single-levels_climate-and-weather-extremes_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Validation of CERRA for application in urban adaptation to climate extremes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-the-heat-waves-over-urban-areas">üåç Use case: Monitoring the heat-waves over urban areas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request">Define data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval-and-maximum-monthly-temperatures">2. Datasets retrieval and maximum monthly temperatures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-maximum-temperature-function">The maximum temperature function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval">Datasets retrieval</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-results">Display results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="validation-of-cerra-for-application-in-urban-adaptation-to-climate-extremes">
<h1><span class="section-number">3.1. </span>Validation of CERRA for application in urban adaptation to climate extremes<a class="headerlink" href="#validation-of-cerra-for-application-in-urban-adaptation-to-climate-extremes" title="Link to this heading">#</a></h1>
<p>Production date: 24-05-2024</p>
<p>Produced by: Sandro Calmanti (ENEA), Chiara Volta (ENEA)</p>
<section id="use-case-monitoring-the-heat-waves-over-urban-areas">
<h2>üåç Use case: Monitoring the heat-waves over urban areas<a class="headerlink" href="#use-case-monitoring-the-heat-waves-over-urban-areas" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question:<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>What is the added value of using  CERRA in assessing the impact of heat waves over urban areas compared to ERA5 and ERA5-Land?</p></li>
</ul>
<p>This notebook presents an assessment of the potential added value of the reanalysis CERRA <a class="reference external" href="https://doi.org/10.1002/qj.4764">[1]</a> compared to the coarser resolution reanalyses ERA5 and ERA5-Land. While ERA5 and ERA5-Land data have a spatial resolution of 0.1¬∞ x 0.1¬∞ (about 10 km) and 0.25¬∞ x 0.25¬∞ (about 25 km), respectively, CERRA resolution is 5.5 km owing to its utilization of a layered model for the Earth‚Äôs surface (SURFEXV8.1), which offers a more comprehensive representation of surface topography and physiographic data <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+European+Regional+ReAnalysis+%28CERRA%29%3A+product+user+guide">[2]</a>. As a consequence, CERRA is expected to provide a more accurate information concerning meteorological variables.  The three datasets also differ in terms of temporal resolution (1 hour in ERA5 and ERA5-Land, 3 hours in CERRA) and reanalysis methods, which rely on data assimilation in CERRA and ERA5 (i.e., 3D-VAR and 4D-VAR, respectively) and simulations forced by the atmospheric forcing of ERA5 in ERA5-Land <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+European+Regional+ReAnalysis+%28CERRA%29%3A+product+user+guide">[2]</a> <a class="reference external" href="https://rmets.onlinelibrary.wiley.com/doi/full/10.1002/qj.3803">[3]</a> <a class="reference external" href="https://essd.copernicus.org/articles/13/4349/2021/">[4]</a>.<br />
The analysis performed in this notebook compares the three datasets to examine the quality of CERRA in accurately describing the distribution of temperature extremes during August 2020 in the area around Rome (i.e., Lazio, Italy; see map below), a region characterized by the coexistence of different climatic regimes due to its abundant orographic features and variety of land use properties <a class="reference external" href="https://www.int-res.com/abstracts/cr/v62/n3/p173-188/">[5]</a>.<br />
The overall objective of this analysis is to provide valuable insights into the utility of CERRA as a reference dataset for climate impact studies, which encompass the bias correction of climate predictions and longer-term projections <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/28/17/jcli-d-14-00754.1.xml">[6]</a> <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S2405880717300067?via%3Dihub">[7]</a>, including the challenge of correcting extremes <a class="reference external" href="https://www.mdpi.com/2225-1154/11/1/3">[8]</a>.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/a481576a-8c31-41e1-b664-0ebd239037a4.png"><img alt="../_images/a481576a-8c31-41e1-b664-0ebd239037a4.png" src="../_images/a481576a-8c31-41e1-b664-0ebd239037a4.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.1.1 </span><span class="caption-text">The full geographical domain of CERRA and, highlighted in red, the focus area for the quality assessment presented in this notebook.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>CERRA provides an accurate description of local temperature values, taking into account the effect of orographic features at a uniform horizontal resolution of 5.5 km.</p></li>
<li><p>The analysis of climate extreme, such as heat waves over urban areas, is expected to benefit from the adoption of CERRA as a reference dataset.</p></li>
<li><p>CERRA represents a suitable reference for the downscaling and bias correction of climate predictions and long-term projections.</p></li>
<li><p>The geographical coverage of CERRA is limited to the European region. Therefore, applications based on CERRA are not replicable outside Europe.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis focuses on maximum temperature data from the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-cerra-single-levels?tab=overview">CERRA reanalysis</a> over central Italy during the period 1986-2020. The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-1"><span class="std std-ref">1. Choose the data to use and setup the code</span></a></strong></p>
<ul class="simple">
<li><p>Import required packages</p></li>
<li><p>Define data request</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-2"><span class="std std-ref">2. Datasets retrieval and maximum monthly temperatures</span></a></strong></p>
<ul class="simple">
<li><p>The maximum temperature function</p></li>
<li><p>Datasets retrieval</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-3"><span class="std std-ref">3. Plot and describe results</span></a></strong></p>
<ul class="simple">
<li><p>Display results</p></li>
<li><p>Discussion</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-setup-the-code">
<span id="reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-1"></span><h3>1. Choose the data to use and setup the code<a class="headerlink" href="#choose-the-data-to-use-and-setup-the-code" title="Link to this heading">#</a></h3>
<section id="import-required-packages">
<h4>Import required packages<a class="headerlink" href="#import-required-packages" title="Link to this heading">#</a></h4>
<p>Besides the standard libraries <code class="docutils literal notranslate"><span class="pre">xarray</span></code> for the handling of datasets and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> for the graphical outputs, we use <code class="docutils literal notranslate"><span class="pre">cartopy</span></code> for the map projection functions. We also use one of the <code class="docutils literal notranslate"><span class="pre">utils</span></code> included in the <a class="reference internal" href="#reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-idbopen"><span class="std std-ref">C3S EQC custom function</span></a> <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> to crop the CERRA dataset over the area of interest because, differently from ERA5 and ERA5-Land, the reanalysis CERRA does not allow the extraction of areal subsets on retrieval.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">Gridliner</span>
<span class="kn">from</span> <span class="nn">c3s_eqc_automatic_quality_control</span> <span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;tableau-colorblind10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-data-request">
<h4>Define data request<a class="headerlink" href="#define-data-request" title="Link to this heading">#</a></h4>
<p>The analysis performed in this notebook focuses on the maximum temperature values calculated using temperature data at a height of 2m above the surface (i.e., t2m) from CERRA, ERA5 and ERA5-Land datasets during August 2020 in the Lazio region (Italy). The choice of using a single month of data is made to simplify the analysis without compromising the primary objective of the quality assessment. Indeed, this timeframe proves sufficient to showcase the potential advantages of CERRA compared to ERA5 and ERA5-Land. However, different months and years, as well as different regions (e.g., Alps, Italy and Scandinavia) can be selected and analysed in this notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select region of interest</span>
<span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;Lazio&quot;</span>
<span class="n">region_slices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Alps&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">43</span><span class="p">)},</span>
    <span class="s2">&quot;Scandinavia&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">62</span><span class="p">)},</span>
    <span class="s2">&quot;Lazio&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">41</span><span class="p">)},</span>
    <span class="s2">&quot;Italy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">36</span><span class="p">)},</span>
<span class="p">}</span>
<span class="k">assert</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">region_slices</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2"> is invalid&quot;</span>

<span class="c1"># Select time range</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">2020</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2020</span>

<span class="c1"># Select month of interest</span>
<span class="n">month</span> <span class="o">=</span> <span class="mi">8</span>
<span class="k">assert</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">=}</span><span class="s2"> is invalid&quot;</span>

<span class="c1"># Define data request</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="n">region_slices</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">]</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="n">region_slices</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s2">&quot;lat_slice&quot;</span><span class="p">]</span>
<span class="n">lons</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">-</span> <span class="mi">180</span> <span class="k">for</span> <span class="n">lon</span> <span class="ow">in</span> <span class="p">(</span><span class="n">lon_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">))</span>
<span class="n">lats</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>

<span class="n">requests_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)],</span>
    <span class="p">},</span>
    <span class="s2">&quot;reanalysis-era5-land&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)],</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)],</span>
    <span class="p">},</span>
    <span class="s2">&quot;reanalysis-cerra-single-levels&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;level_type&quot;</span><span class="p">:</span> <span class="s2">&quot;surface_or_atmosphere&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="datasets-retrieval-and-maximum-monthly-temperatures">
<span id="reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-2"></span><h3>2. Datasets retrieval and maximum monthly temperatures<a class="headerlink" href="#datasets-retrieval-and-maximum-monthly-temperatures" title="Link to this heading">#</a></h3>
<section id="the-maximum-temperature-function">
<h4>The maximum temperature function<a class="headerlink" href="#the-maximum-temperature-function" title="Link to this heading">#</a></h4>
<p>Maximum monthly values of temperature for the region of interest are extracted on-the-fly during the download through the <code class="docutils literal notranslate"><span class="pre">regionalized_max</span></code> function.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">regionalised_max</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lon_slice</span> <span class="ow">and</span> <span class="n">lat_slice</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">lon_slice</span> <span class="o">==</span> <span class="n">lat_slice</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;leadtime&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">time</span> <span class="o">+=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;leadtime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;leadtime&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="datasets-retrieval">
<h4>Datasets retrieval<a class="headerlink" href="#datasets-retrieval" title="Link to this heading">#</a></h4>
<p>The three datasets are downloaded separately through a specific request and data are then organized into one dictionary <code class="docutils literal notranslate"><span class="pre">datarrays</span></code>. Temperature data unit in <span class="math notranslate nohighlight">\(K\)</span> is converted in <span class="math notranslate nohighlight">\(¬∞C\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataarrays</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="n">region_slices</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;area&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">region</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">time_request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">month</span><span class="p">,</span>
            <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="p">}</span>
        <span class="n">requests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">request</span> <span class="o">|</span> <span class="n">time_request</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">regionalised_max</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span><span class="n">varname</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">-=</span> <span class="mf">273.15</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;¬∞C&quot;</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00,  7.72it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 42.78it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 10.45it/s]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-section-3"></span><h3>3. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<section id="display-results">
<h4>Display results<a class="headerlink" href="#display-results" title="Link to this heading">#</a></h4>
<p>Maps of maximum temperature are displayed for each dataset analysed. The map color scale is dynamically adjusted to accommodate maximum and minimum temperature from all datasets and enable a more effective visual analysis.
Normalized histograms of the maximum temperature values depicted in the maps are also shown.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set common cbar and map projection projection</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">dataarrays</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">dataarrays</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="n">region_slices</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">]</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="n">region_slices</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s2">&quot;lat_slice&quot;</span><span class="p">]</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span>
    <span class="n">central_longitude</span><span class="o">=</span><span class="p">(</span><span class="n">lon_slice</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">lon_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">central_latitude</span><span class="o">=</span><span class="p">(</span><span class="n">lat_slice</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Set the longitude and latitude extent of the map</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">min</span><span class="p">(</span><span class="n">lon_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
    <span class="nb">max</span><span class="p">(</span><span class="n">lon_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
    <span class="nb">min</span><span class="p">(</span><span class="n">lat_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
    <span class="nb">max</span><span class="p">(</span><span class="n">lat_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Set title</span>
<span class="n">years</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">{</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">}))</span>
<span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Max  - </span><span class="si">{</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">month</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">years</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

<span class="c1"># Plot maps</span>
<span class="k">for</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">dataarrays</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">)</span>
    <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plot_obj</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>

    <span class="c1"># Set the position of longitude labels below the bottom axis</span>
    <span class="n">gridliners</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">plot_obj</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">artists</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Gridliner</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">gl</span> <span class="ow">in</span> <span class="n">gridliners</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">x_inline</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rotation&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot histograms</span>
<span class="c1">#stacked_data = {</span>
<span class="c1">#    collection_id: da.stack(dim=da.dims).values</span>
<span class="c1">#    for collection_id, da in dataarrays.items()</span>
<span class="c1">#}</span>

<span class="n">stacked_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">collection_id</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stack_dim</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="k">for</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">dataarrays</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">stacked_data</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
    <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">dataarrays</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability density&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/460f95b2cb94da376ab8692a08fd274284533897f5835d1dc238b9d588c79c52.png" src="../_images/460f95b2cb94da376ab8692a08fd274284533897f5835d1dc238b9d588c79c52.png" />
<img alt="../_images/5afc38f4cf67848f3e4ed7564b3b88148497fa04b3672a642bac1baf23bf658b.png" src="../_images/5afc38f4cf67848f3e4ed7564b3b88148497fa04b3672a642bac1baf23bf658b.png" />
<img alt="../_images/53da070966328d7a64426a7cc32a1a65b02ff0eee7c0cc035a2f2acc3b0a648b.png" src="../_images/53da070966328d7a64426a7cc32a1a65b02ff0eee7c0cc035a2f2acc3b0a648b.png" />
<img alt="../_images/54e5c0c9d866d203dbc5ffa83a4e60762dd0c80f25c2e1c691e4c47e3c4a8da1.png" src="../_images/54e5c0c9d866d203dbc5ffa83a4e60762dd0c80f25c2e1c691e4c47e3c4a8da1.png" />
</div>
</div>
</section>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p><strong>Maximum temperature maps:</strong> Comparison of the maximum temperature maps for the three datasets shows that CERRA provides a better description of the spatial distribution of maximum temperatures and shows a relatively larger variability than ERA5 and ERA5-Land. Indeed, CERRA is able to clearly distinguish between the warmer coastal areas to the west and the colder mountainous regions to the east, and accurately portrays the key geographical features of the region. In particular, the relatively cold area to the northwest corresponds to Mount Amiata (1738 m), while the eastern region, which includes the Gran Sasso massif (maximum altitude 2912 m), displays the lowest maximum temperature. CERRA also identifies a central area characterized by the warmest temperatures due to the heat island effect from the city of Rome, as well as the presence of volcanic lakes north and south of Rome (i.e., orangish patches within the warmer area in the map) and a southeast area showing a narrow valley between two parallel mountain ridges, which act as hot spot facilitating the recirculation of warm air.<br />
Moreover, it is worth noticing that, although the range of observed maximum temperature is similar in both ERA5 and ERA5-Land, ERA5-Land offers a more detailed spatial description than ERA5.</p>
<p><strong>Maximum temperature histogram:</strong> Differences between the three datasets are further illustrated as normalized histograms of the maximum temperature values depicted in the maps. The distribution of temperature values for ERA5 and ERA5-Land drop off sharply around 27 ¬∞C and 38 ¬∞C, respectively, whereas in the case of CERRA, the distribution‚Äôs tails extend over a broader range. Consequently, CERRA is expected to greatly enhance the detection of local extremes, as well as the outcome bias-correction and statistical downscaling procedures.</p>
<p>The results presented in this notebook agree with the assessment produced by <a class="reference external" href="https://www.mdpi.com/2073-4441/12/6/1669">[9]</a> on evapotranspiration. Comparison of the maximum temperatures from the three datasets with highly-resolved observational systems indicate that CERRA is more able to capture horizontal temperature gradients than both ERA5 and ERA5-Land, even in a complex area such as the city of Rome <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S2212095522002735?via%3Dihub">[10]</a>. Furthermore, numerical comparison with summer average observations for years 2019 and 2020 reported in <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S2212095522002735?via%3Dihub">[11]</a> suggests that the maximum temperature would be overestimated by CERRA and ERA5-Land and underestimated by ERA5. However, it is worth noting that monitoring stations are often installed on rooftops, which are typically higher than the 2m reference of the reanalysis datasets and more exposed to wind cooling, and would therefore measure relatively lower temperatures.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>CDS catalogue entries used in this notebook are <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-cerra-single-levels?tab=overview">CERRA sub-daily regional reanalysis data for Europe on single levels from 1984 to present</a>, <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=form">ERA5 hourly data on single levels from 1940 to present</a> and <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=overview">ERA5-Land hourly data from 1950 to present</a></p></li>
<li><p>Product Documentation for <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-cerra-single-levels?tab=doc">CERRA</a>, <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=doc">ERA5</a> and <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land?tab=doc">ERA5-Land</a> is available</p></li>
</ul>
<p id="reanalysis-reanalysis-cerra-single-levels-climate-and-weather-extremes-q02-idbopen">Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/">BOpen</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1002/qj.4764">[1]</a> Ridal, M., Bazile, E., Le Moigne, P., Randriamampianina, R., Schimanke, S., Andrae, U., ‚Ä¶ &amp; Wang, Z. Q. (2024). CERRA, the Copernicus European Regional Reanalysis system. Quarterly Journal of the Royal Meteorological Society.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+European+Regional+ReAnalysis+%28CERRA%29%3A+product+user+guide">[2]</a> Schimanke, S., Isaksson, L., &amp; Edvinsson, L. (2022). Copernicus European Regional ReAnalysis (CERRA): product user guide.</p>
<p><a class="reference external" href="https://rmets.onlinelibrary.wiley.com/doi/full/10.1002/qj.3803">[3]</a> Hersbach, H., Bell, B., Berrisford, P., Hirahara, S., Hor√°nyi, A., Mu√±oz-Sabater, J., ‚Ä¶ &amp; Th√©paut, J-N. (2020). The ERA5 global reanalysis. Quarterly Journal of the Royal Meteorological Society, 146, 1999-2049.</p>
<p><a class="reference external" href="https://essd.copernicus.org/articles/13/4349/2021/">[4]</a> Mu√±oz-Sabater, J., Dutra, E., Agust√≠-Panareda, A., Albergel, C., Arduini, G., Balsamo, G., ‚Ä¶ &amp; Th√©paut, J-N. (2021). ERA5-Land: a state-of-the-art global reanalysis dataset for land applications. Earth System Science Data, 13, 4349-4383.</p>
<p><a class="reference external" href="https://www.int-res.com/abstracts/cr/v62/n3/p173-188/">[5]</a> Calmanti, S., Dell‚ÄôAquila, A., Maimone, F., &amp; Pelino, V. (2015). Evaluation of climate patterns in a regional climate model over Italy using long-term records from SYNOP weather stations and cluster analysis. Climate Research, 62(3), 173-188.</p>
<p><a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/28/17/jcli-d-14-00754.1.xml">[6]</a> Cannon, A. J., Sobie, S. R., &amp; Murdock, T. Q. (2015). Bias correction of GCM precipitation by quantile mapping: how well do methods preserve changes in quantiles and extremes?. Journal of Climate, 28(17), 6938-6959.</p>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S2405880717300067?via%3Dihub">[7]</a> Manzanas, R., Guti√©rrez, J. M., Fern√°ndez, J., Van Meijgaard, E., Calmanti, S., Magari√±o, M. E., ‚Ä¶ &amp; Herrera, S. (2018). Dynamical and statistical downscaling of seasonal temperature forecasts in Europe: Added value for user applications. Climate Services, 9, 44-56.</p>
<p><a class="reference external" href="https://www.mdpi.com/2225-1154/11/1/3">[8]</a> Trentini, L., Dal Gesso, S., Venturini, M., Guerrini, F., Calmanti, S., &amp; Petitta, M. (2022). A Novel Bias Correction Method for Extreme Events. Climate, 11(1), 3.</p>
<p><a class="reference external" href="https://www.mdpi.com/2073-4441/12/6/1669">[9]</a> Pelosi, A., Terribile, F., D‚ÄôUrso, G., &amp; Chirico, G. B. (2020). Comparison of ERA5-Land and UERRA MESCAN-SURFEX reanalysis data with spatially interpolated weather observations for the regional assessment of reference evapotranspiration. Water, 12(6), 1669.</p>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S2212095522002735?via%3Dihub">[10]</a> Cecilia, A., Casasanta, G., Petenko, I., Conidi, A., Argentini, S. (2023). Measuring the urban heat island of Rome through a dense weather station network and remote sensing imperviousness data. Urban Climate, 47, 101355.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-the-heat-waves-over-urban-areas">üåç Use case: Monitoring the heat-waves over urban areas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request">Define data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval-and-maximum-monthly-temperatures">2. Datasets retrieval and maximum monthly temperatures</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-maximum-temperature-function">The maximum temperature function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-retrieval">Datasets retrieval</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-results">Display results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>