
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Monitoring Extreme U.S. Temperatures: July 2022 Heatwave &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_extremes-detection_q02';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Monitoring Extreme U.S. Temperatures: July 2022 Heatwave</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-era5-land-monthly-means_extremes-detection_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_extremes-detection_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Monitoring Extreme U.S. Temperatures: July 2022 Heatwave</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-monthly-temperature-anomalies-to-detect-and-monitor-heatwave-conditions-in-the-united-states">üåç Use case: Using monthly temperature anomalies to detect and monitor heatwave conditions in the United States.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-anomalies-nationwide">2. Temperature anomalies nationwide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#anomalies-calculation">Anomalies calculation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-anomalies-nationwide">Plot anomalies nationwide</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-mean-temperatures-comparison">3. Spatial mean temperatures comparison</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="monitoring-extreme-u-s-temperatures-july-2022-heatwave">
<h1><span class="section-number">3.1. </span>Monitoring Extreme U.S. Temperatures: July 2022 Heatwave<a class="headerlink" href="#monitoring-extreme-u-s-temperatures-july-2022-heatwave" title="Link to this heading">#</a></h1>
<p>Production date: 09-10-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-using-monthly-temperature-anomalies-to-detect-and-monitor-heatwave-conditions-in-the-united-states">
<h2>üåç Use case: Using monthly temperature anomalies to detect and monitor heatwave conditions in the United States.<a class="headerlink" href="#use-case-using-monthly-temperature-anomalies-to-detect-and-monitor-heatwave-conditions-in-the-united-states" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>Can ERA5-Land monthly-averaged 2‚ÄØm temperature data reliably detect extreme temperature events documented in the literature, such as the July 2022 U.S. heatwave, and are these results consistent with observation-based datasets like NOAA‚Äôs NClimGrid?</strong></p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-land-monthly-means?tab=overview" rel="noreferrer" target="_blank">ERA5-Land monthly averaged data (1950‚Äìpresent)</a> is a reanalysis dataset available from the Climate Data Store (CDS). It features a regular spatial resolution on a latitude/longitude grid of 0.1¬∞ x 0.1¬∞ (native resolution: 9 km). The dataset provides monthly averaged and hourly averaged by month data for various parameters. It includes 31 instantaneous parameters, one of which is the 2-meter air temperature, often called air temperature. This parameter is particularly valuable for climate monitoring, including the tracking of extreme temperature events such as heatwaves.</p>
<p>The summer of 2022 witnessed a significant heatwave across the United States, characterized by a prolonged period of elevated temperatures and intensified drought conditions. This compound drought-heatwave event was notably pronounced in the western and central regions, including Texas, and was influenced by varying land-atmosphere coupling mechanisms <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100722" rel="noreferrer" target="_blank">[1]</a>.</p>
<p>The goal of this quality assessment is to evaluate whether the ERA5-Land dataset can effectively capture extreme temperature events documented in the literature. As a case study, we focused on the July 2022 heatwave in the United States. To validate ERA5-Land 2‚ÄØm temperature results, we compared them with observations from the NOAA Monthly U.S. Climate Gridded Dataset (NClimGrid). Although the heatwave persisted across multiple months, July was selected for this analysis to maintain focus and brevity, particularly since Texas experienced pronounced temperature extremes during this period.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>ERA5-Land monthly-averaged 2‚ÄØm temperature data captured the extreme temperature event of July 2022 in the U.S., as evidenced by strong spatial agreement with NOAA‚Äôs NClimGrid anomalies.</p></li>
<li><p>During heatwave events, average temperatures across the contiguous United States and in Texas show that ERA5-Land values are slightly higher than those of NClimGrid, likely because ERA5-Land accounts for all hours of the day, whereas NClimGrid computes averages only from daily maximum and minimum temperatures.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>Monthly 2-meter temperature data from ERA5-Land were downloaded for 1991‚Äì2024 and spatially clipped to the contiguous United States. Temperature anomalies for July 2022 were calculated relative to the 1991‚Äì2020 climatological mean. The anomalies were mapped and visually compared to the NOAA NClimGrid dataset to assess consistency. Spatial mean temperatures were also computed for the contiguous U.S. and Texas for selected months and compared to values published in NOAA‚Äôs Montly Climate to validate the results.</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-1"><span class="std std-ref">1. Request and download data</span></a></strong></p>
<ul class="simple">
<li><p>Download monthly averaged 2-meter temperature from the ERA5-Land monthly means dataset for the period 1991‚Äì2024.</p></li>
<li><p>Select the spatial domain covering the contiguous United States.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-2"><span class="std std-ref">2. Temperature anomalies nationwide</span></a></strong></p>
<ul class="simple">
<li><p>Clip the ERA5-Land data to the U.S. boundary.</p></li>
<li><p>Calculate temperature anomalies for July 2022 relative to the 1991‚Äì2020 July climatological mean.</p></li>
<li><p>Visualize the anomalies on a map of the contiguous United States.</p></li>
<li><p>Compare the anomaly patterns visually with the corresponding NClimGrid dataset.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-3"><span class="std std-ref">3. Spatial mean temperatures comparison</span></a></strong></p>
<ul class="simple">
<li><p>Compute the mean spatial temperature for: July 2022 across the contiguous United States, July 2022 in Texas and August 2011 in Texas.</p></li>
<li><p>Compare the results to official NOAA values.</p></li>
<li><p>Analyse the results.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="request-and-download-data">
<span id="reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-1"></span><h3>1. Request and download data<a class="headerlink" href="#request-and-download-data" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">unary_union</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.io.shapereader</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">shpreader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/trigoso_camila/.cdsapirc&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-the-data-request">
<h4>Set the data request<a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_start</span> <span class="o">=</span> <span class="mi">1991</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2024</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land-monthly-means&quot;</span>

<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data">
<h4>Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 34/34 [00:01&lt;00:00, 17.01it/s]
</pre></div>
</div>
</div>
</div>
<p>Convert temperature to ¬∞F.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span> <span class="o">*</span> <span class="mi">9</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span>  <span class="c1"># Convert Kelvin to Fahrenheit</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;¬∞F&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="temperature-anomalies-nationwide">
<span id="reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-2"></span><h3>2. Temperature anomalies nationwide<a class="headerlink" href="#temperature-anomalies-nationwide" title="Link to this heading">#</a></h3>
<p>Clip data to the contiguous USA area.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- Load U.S. states shapefile (TIGER 2023) ---</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www2.census.gov/geo/tiger/TIGER2023/STATE/tl_2023_us_state.zip&quot;</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="o">~</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;STUSPS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;HI&#39;</span><span class="p">,</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span> <span class="s1">&#39;GU&#39;</span><span class="p">,</span> <span class="s1">&#39;VI&#39;</span><span class="p">,</span> <span class="s1">&#39;MP&#39;</span><span class="p">,</span> <span class="s1">&#39;AS&#39;</span><span class="p">])]</span>

<span class="c1"># --- Load Natural Earth lake polygons ---</span>
<span class="n">lakes_shp</span> <span class="o">=</span> <span class="n">shpreader</span><span class="o">.</span><span class="n">natural_earth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lakes&#39;</span><span class="p">)</span>
<span class="n">lakes</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">lakes_shp</span><span class="p">)</span>

<span class="c1"># --- Filter only the Great Lakes ---</span>
<span class="n">great_lakes_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lake Superior&#39;</span><span class="p">,</span> <span class="s1">&#39;Lake Michigan&#39;</span><span class="p">,</span> <span class="s1">&#39;Lake Huron&#39;</span><span class="p">,</span> <span class="s1">&#39;Lake Erie&#39;</span><span class="p">,</span> <span class="s1">&#39;Lake Ontario&#39;</span><span class="p">]</span>
<span class="n">great_lakes</span> <span class="o">=</span> <span class="n">lakes</span><span class="p">[</span><span class="n">lakes</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">great_lakes_names</span><span class="p">)]</span>
<span class="n">great_lakes_union</span> <span class="o">=</span> <span class="n">unary_union</span><span class="p">(</span><span class="n">great_lakes</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

<span class="c1"># --- Subtract Great Lakes from state polygons ---</span>
<span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">geom</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">great_lakes_union</span><span class="p">))</span>

<span class="c1"># Ensure your DataArray has a CRS</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Convert GeoDataFrame geometries to a list</span>
<span class="n">state_geoms</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Mask the raster using the states without lakes</span>
<span class="n">da_clipped</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">state_geoms</span><span class="p">,</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="anomalies-calculation">
<h4>Anomalies calculation<a class="headerlink" href="#anomalies-calculation" title="Link to this heading">#</a></h4>
<p>Calculate temperature anomalies for July 2022 in relation to the baseline 1991-2020.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract July 2022</span>
<span class="n">da_july_2022</span> <span class="o">=</span> <span class="n">da_clipped</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;2022-07-01&quot;</span><span class="p">)</span>

<span class="c1"># Baseline calculation </span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_time_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span><span class="p">):</span>
    
    <span class="c1"># Filter the data by the specified month and year range</span>
    <span class="n">da_filtered</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
        <span class="n">forecast_reference_time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">forecast_reference_time</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">forecast_reference_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="n">month</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">forecast_reference_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="n">start_year</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">forecast_reference_time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="n">end_year</span><span class="p">),</span>
            <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">da_filtered</span>

<span class="c1"># Baseline 1991-2020</span>
<span class="n">da_baseline_91_20</span> <span class="o">=</span> <span class="n">compute_time_weighted_mean</span><span class="p">(</span><span class="n">da_clipped</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1991</span><span class="p">,</span> <span class="mi">2020</span><span class="p">)</span>
<span class="n">da_baseline_91_20_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">(</span><span class="n">da_baseline_91_20</span><span class="p">)</span>
<span class="c1"># Anomalies calculation</span>
<span class="n">da_anomalies_91_20</span> <span class="o">=</span> <span class="n">da_july_2022</span> <span class="o">-</span> <span class="n">da_baseline_91_20_mean</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-anomalies-nationwide">
<h4>Plot anomalies nationwide<a class="headerlink" href="#plot-anomalies-nationwide" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define your custom color map exactly as before</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">-</span><span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;#142660&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;#132B63&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">9</span><span class="p">:</span>  <span class="s2">&quot;#0E3669&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">8</span><span class="p">:</span>  <span class="s2">&quot;#0D4473&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">7</span><span class="p">:</span>  <span class="s2">&quot;#0D537C&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">6</span><span class="p">:</span>  <span class="s2">&quot;#0C607E&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">5</span><span class="p">:</span>  <span class="s2">&quot;#0D809A&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">4</span><span class="p">:</span>  <span class="s2">&quot;#1F97AC&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">3</span><span class="p">:</span>  <span class="s2">&quot;#5BBCCB&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">2</span><span class="p">:</span>  <span class="s2">&quot;#9ADDE6&quot;</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="s2">&quot;#D9F8FB&quot;</span><span class="p">,</span>
     <span class="mi">0</span><span class="p">:</span>  <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>
     <span class="mi">1</span><span class="p">:</span>  <span class="s2">&quot;#FFE8E5&quot;</span><span class="p">,</span>
     <span class="mi">2</span><span class="p">:</span>  <span class="s2">&quot;#FCBFB9&quot;</span><span class="p">,</span>
     <span class="mi">3</span><span class="p">:</span>  <span class="s2">&quot;#E88F88&quot;</span><span class="p">,</span>
     <span class="mi">4</span><span class="p">:</span>  <span class="s2">&quot;#D26960&quot;</span><span class="p">,</span>
     <span class="mi">5</span><span class="p">:</span>  <span class="s2">&quot;#BC4C43&quot;</span><span class="p">,</span>
     <span class="mi">6</span><span class="p">:</span>  <span class="s2">&quot;#A2352E&quot;</span><span class="p">,</span>
     <span class="mi">7</span><span class="p">:</span>  <span class="s2">&quot;#86241E&quot;</span><span class="p">,</span>
     <span class="mi">8</span><span class="p">:</span>  <span class="s2">&quot;#6F1814&quot;</span><span class="p">,</span>
     <span class="mi">9</span><span class="p">:</span>  <span class="s2">&quot;#5A0D0A&quot;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span>  <span class="s2">&quot;#4C0604&quot;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span>  <span class="s2">&quot;#512B2B&quot;</span>
<span class="p">}</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">11</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">color_positions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">norm</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">items</span><span class="p">())]</span>
<span class="n">custom_cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;custom_diverging&quot;</span><span class="p">,</span> <span class="n">color_positions</span><span class="p">)</span>

<span class="c1">#Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Plot the temperature anomalies DataArray (replace this with your actual xarray DataArray)</span>
<span class="n">temperature_plot</span> <span class="o">=</span> <span class="n">da_anomalies_91_20</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">11</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">11</span>
<span class="p">)</span>

<span class="c1"># Focus on CONUS</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plot shapefile outlines</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Add state abbreviations</span>
<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">centroid</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">centroid</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">centroid</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;STUSPS&#39;</span><span class="p">],</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
    <span class="p">)</span>

<span class="c1"># Title and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;July 2022 Temperature Anomaly Relative to 1991‚Äì2020 Baseline Average&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude&quot;</span><span class="p">)</span>

<span class="c1"># Colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">temperature_plot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.06</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Temperature Anomaly (¬∞F)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/f9b12d2aee37bb92238307a2705d5731e7a7d6b4d6ec9ab8d6a7ee42741db612.png" src="../_images/f9b12d2aee37bb92238307a2705d5731e7a7d6b4d6ec9ab8d6a7ee42741db612.png" />
</div>
</div>
<p><em>Figure 1. July 2022 2-meter temperature anomaly (¬∞F) relative to 1991‚Äì2020 baseline, calculated using the ERA5-Land dataset.</em></p>
<p><img alt="Temperature--Monthly--Difference-from-average--CONUS--2022-07-00--small.png" src="../_images/a6d0c358-1287-4042-9cb0-5f5dd7aa2c6b.png" /></p>
<p><em>Figure 2. July 2022 average temperature anomaly (¬∞F) relative to 1991‚Äì2020 baseline produced by NOAA using NClimGrid. Source: NOAA (Download Directories), 2022 <a class="reference external" href="https://www.climate.gov/data/Temperature--Monthly--Difference-from-average--CONUS/01-small/Temperature--Monthly--Difference-from-average--CONUS--2022-07-00--small.png" rel="noreferrer" target="_blank">[2]</a>.</em></p>
<p>In general, the temperature anomalies shown in Figures 1 and 2 are quite similar. Both indicate a major positive anomaly in average temperature across Texas, Oklahoma, and parts of Arkansas, Missouri, and Kansas during July 2022. Most of the rest of the country also experienced positive anomalies, though of smaller magnitude than in those states.</p>
<p>Some regional differences appear between Figures 1 and 2, particularly in areas with slight negative anomalies. In South Carolina, Georgia, and Alabama, ERA5-Land shows a slight negative anomaly, while NClimGrid depicts near-normal conditions (white). The negative anomalies along the California coast and around the Great Lakes are more pronounced with ERA5-Land than with NClimGrid. Conversely, northern Kansas, Missouri, and Illinois display a negative anomaly in Figure 2 (NClimGrid), whereas Figure 2 (ERA5-Land) shows temperatures closer to normal in those areas.</p>
<p>Differences between the two datasets are expected, as ERA5-Land and NClimGrid obtain temperature information in fundamentally different ways. ERA5-Land is a reanalysis product that uses ERA5 atmospheric data as forcing but runs the land surface model at a higher spatial resolution. It does not assimilate observations directly, yet it benefits indirectly from ERA5‚Äôs data assimilation of various atmospheric variables used in the forcing fields.</p>
<p>In contrast, the NOAA Monthly U.S. Climate Gridded Dataset (NClimGrid) is an observational product derived from temperature and precipitation measurements in the Global Historical Climatology Network‚ÄìDaily (GHCN-D). The second version of NClimGrid incorporates data from 10,325 temperature and 14,702 precipitation stations across the contiguous United States. The dataset is produced on a 5 √ó 5 km grid, where missing grid cells are filled using a climatologically aided interpolation.</p>
<p>The climatologically aided interpolation requires the calculation of three main grids:</p>
<p>i) Normal grid: A baseline grid of climate normals (long-term averages) is generated for each station, month, and variable. These normals are then interpolated to the 5 km grid using a thin-plate smoothing spline method.</p>
<p>ii) Anomaly grid: Anomalies are calculated for each station, year, and month relative to the corresponding climate normal. The resulting anomalies are interpolated to the grid using inverse-distance weighting.</p>
<p>iii) Composite grid: Obtained by combining the anomaly and normal grids.</p>
<p>It is important to note that the temperature data collected from weather stations consist of daily maximum and minimum temperatures. The average temperature is estimated as the mean of the minimum and the maximum <a class="reference external" href="https://www.climate.gov/maps-data/data-snapshots/data-source/temperature-us-monthly-difference-average" rel="noreferrer" target="_blank">[3]</a> <a class="reference external" href="https://doi.org/10.1175/JAMC-D-13-0248.1" rel="noreferrer" target="_blank">[4]</a>.</p>
</section>
</section>
<section id="spatial-mean-temperatures-comparison">
<span id="reanalysis-reanalysis-era5-land-monthly-means-extremes-detection-q02-section-3"></span><h3>3. Spatial mean temperatures comparison<a class="headerlink" href="#spatial-mean-temperatures-comparison" title="Link to this heading">#</a></h3>
<p>The NOAA National Centers for Environmental Information (NCEI) publishes monthly National Climate Reports. According to the report for July 2022, that month ranked as the third warmest July (up to 2022) for the contiguous United States, with an average temperature of 76.4¬∞F. In Texas, the average temperature reached 87.3¬∞F, making it the second warmest month in the state‚Äôs history, surpassed only by August 2011, which averaged 89.5¬∞F (also up to 2022) <a class="reference external" href="https://www.ncei.noaa.gov/access/monitoring/monthly-report/national/202207" rel="noreferrer" target="_blank">[5]</a>.</p>
<p>For comparison, the following averages were calculated using ERA5-Land reanalysis data:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_july_2022_spatial_mean_usa</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da_july_2022</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Contiguous U.S. average temperature during July, 2022: </span><span class="si">{</span><span class="n">da_july_2022_spatial_mean_usa</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ¬∞F&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Contiguous U.S. average temperature during July, 2022: 77.8 ¬∞F
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only Texas</span>
<span class="n">texas</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Texas&quot;</span><span class="p">]</span>
<span class="n">da_clipped</span> <span class="o">=</span> <span class="n">da_clipped</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Convert GeoSeries -&gt; list of Shapely geometries</span>
<span class="n">texas_geom</span> <span class="o">=</span> <span class="n">texas</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># or list(texas.geometry)</span>

<span class="c1"># Clip</span>
<span class="n">da_texas</span> <span class="o">=</span> <span class="n">da_clipped</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">texas_geom</span><span class="p">,</span> <span class="n">texas</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">da_tx_jul_2022</span> <span class="o">=</span> <span class="n">da_texas</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;2022-07-01&quot;</span><span class="p">)</span>
<span class="n">da_tx_jul_2022_spatial_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da_tx_jul_2022</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Texas average temperature during July, 2022: </span><span class="si">{</span><span class="n">da_tx_jul_2022_spatial_mean</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ¬∞F&quot;</span><span class="p">)</span>

<span class="n">da_tx_aug_2011</span> <span class="o">=</span> <span class="n">da_texas</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;2011-08-01&quot;</span><span class="p">)</span>
<span class="n">da_tx_aug_2011_spatial_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da_tx_aug_2011</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Texas average temperature during August, 2011: </span><span class="si">{</span><span class="n">da_tx_aug_2011_spatial_mean</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ¬∞F&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Texas average temperature during July, 2022: 88.1 ¬∞F
Texas average temperature during August, 2011: 89.5 ¬∞F
</pre></div>
</div>
</div>
</div>
<p><em>Table 1. Average Temperatures comparison</em></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Area</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>ERA5-Land 2m T(¬∞F)</p></th>
<th class="head"><p>NOAA T(¬∞F) <a class="reference external" href="https://www.ncei.noaa.gov/access/monitoring/monthly-report/national/202207" rel="noreferrer" target="_blank">[5]</a></p></th>
<th class="head"><p>Difference T(¬∞F)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Contiguous USA</p></td>
<td><p>July, 2022</p></td>
<td><p>77.8</p></td>
<td><p>76.4</p></td>
<td><p>1.4</p></td>
</tr>
<tr class="row-odd"><td><p>Texas</p></td>
<td><p>July, 2022</p></td>
<td><p>88.1</p></td>
<td><p>87.3</p></td>
<td><p>0.8</p></td>
</tr>
<tr class="row-even"><td><p>Texas</p></td>
<td><p>August, 2011</p></td>
<td><p>89.5</p></td>
<td><p>88.2</p></td>
<td><p>1.3</p></td>
</tr>
</tbody>
</table>
</div>
<p>The results in the table show that the ERA5-Land 2m temperature tends to be slightly higher than the average temperature reported by NOAA. The differences range from 0.8 to 1.4 ¬∞F, indicating good overall agreement between the datasets.</p>
<p>This discrepancy can be explained by the different methods used to calculate the averages. NOAA‚Äôs product computes the mean as the average of the daily maximum and minimum temperatures, whereas ERA5-Land provides hourly temperature data, which are averaged to produce daily and monthly means. Consequently, since probably more hours of the day during a heatwave event are closer to the daily maximum than to the minimum, the ERA5-Land averages tend to be slightly higher than NOAA‚Äôs mean of the daily extremes.</p>
<p>The agreement between the anomalies shown in Figures 1 and 2, along with the close correspondence of the averages over large areas, provides confidence in the ERA5-Land results. It is also possible that the ERA5-Land averages better represent the true mean temperature, since they incorporate data from all hours of the day.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>J. Mu√±oz-Sabater, Dutra, E., Agust√≠-Panareda, A., Albergel, C., Arduini, G., Balsamo, G., Boussetta, S., Choulga, M., Harrigan, S., Hersbach, H., Martens, B., Miralles, D. G., Piles, M., Rodr√≠guez-Fern√°ndez, N. J., Zsoter, E., Buontempo, C., &amp; Th√©paut, J.-N. (2021) ERA5-Land: A state-of-the-art global reanalysis dataset for land applications, Earth Syst. Sci. Data,13, 4349‚Äì4383. <a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank"></a>.</p></li>
<li><p>ECMWF (2025) ERA5-Land: data documentation. <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation" rel="noreferrer" target="_blank"></a></p></li>
<li><p>Xie, J., Tang, Q., Golaz, J.-C., &amp; Lin, W. (2024) Record High 2022 September-Mean Temperature in Western North America. Bull. Amer. Meteor. Soc. 105, E306‚ÄìE312. <a class="reference external" href="https://doi.org/10.1175/BAMS-D-23-0148.1" rel="noreferrer" target="_blank"></a></p></li>
<li><p>Meng, Y., Hao, Z., Zhang, Y., &amp; Feng, S. (2023) The 2022-like compound dry and hot extreme in the Northern Hemisphere: Extremeness, attribution, and projection. Atmos. Res. 295, 107009. <a class="reference external" href="https://doi.org/10.1016/j.atmosres.2023.107009" rel="noreferrer" target="_blank"></a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100722" rel="noreferrer" target="_blank">[1]</a> Yoon, D., Chen, J.-H., &amp; Seo, E. (2024). Contribution of land-atmosphere coupling in 2022 CONUS compound drought-heatwave events and implications for forecasting. Weather and Climate Extremes, 46, 100722.</p>
<p><a class="reference external" href="https://www.climate.gov/data/Temperature--Monthly--Difference-from-average--CONUS/01-small/Temperature--Monthly--Difference-from-average--CONUS--2022-07-00--small.png" rel="noreferrer" target="_blank">[2]</a> NOAA Climate (2023). Temperature‚ÄìMonthly‚ÄìDifference-from-average‚ÄìCONUS‚Äì2022-07-00‚Äìsmall.png.</p>
<p><a class="reference external" href="https://www.climate.gov/maps-data/data-snapshots/data-source/temperature-us-monthly-difference-average" rel="noreferrer" target="_blank">[3]</a> NOAA Climate (2024). Temperature - US Monthly, Difference from Average.</p>
<p><a class="reference external" href="https://doi.org/10.1175/JAMC-D-13-0248.1" rel="noreferrer" target="_blank">[4]</a> Vose, R. S., Applequist, S., Squires, M., Durre, I., Menne, M. J., Williams, C. N. Jr., Fenimore, C., Gleason, K., &amp; Arndt, D. (2014) Improved Historical Temperature and Precipitation Time Series for U.S. Climate Divisions. J. Appl. Meteor. Climatol. 53, 1232‚Äì1251.</p>
<p><a class="reference external" href="https://www.ncei.noaa.gov/access/monitoring/monthly-report/national/202207" rel="noreferrer" target="_blank">[5]</a> National Centers for Environmental Information (2022). July 2022 National Climate Report. NOAA</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-monthly-temperature-anomalies-to-detect-and-monitor-heatwave-conditions-in-the-united-states">üåç Use case: Using monthly temperature anomalies to detect and monitor heatwave conditions in the United States.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-anomalies-nationwide">2. Temperature anomalies nationwide</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#anomalies-calculation">Anomalies calculation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-anomalies-nationwide">Plot anomalies nationwide</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-mean-temperatures-comparison">3. Spatial mean temperatures comparison</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>