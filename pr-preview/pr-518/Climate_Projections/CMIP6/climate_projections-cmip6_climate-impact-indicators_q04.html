
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1.1. Projections of future ice-free periods for the Arctic and Antarctic &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1.2. Historical accuracy of sea ice extent in the CMIP6 projections" href="climate_projections-cmip6_model-performance_q02.html" />
    <link rel="prev" title="5.1. CMIP6" href="CMIP6.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.1. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.2. Suitability of satellite sea ice thickness data for studying climate change</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../climate.html">5. Quality assessments for Climate Projections</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="CMIP6.html">5.1. CMIP6</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">5.1.1. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q02.html">5.1.2. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q03.html">5.1.3. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FClimate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Projections of future ice-free periods for the Arctic and Antarctic</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-projected-future-ice-free-conditions-to-inform-product-creation">üåç Use case: Scientific assessment of projected future ice-free conditions to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-compute-time-series-of-extent-and-area">1.4 Define functions to compute time series of extent and area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-post-process-and-plot-time-series">1.5 Functions to post-process and plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-monthly-climatologies">1.6 Functions to create the monthly climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatology-maps">1.7 Functions to plot climatology maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-the-access-to-a-given-area">1.8 Functions to plot the access to a given area</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-downloading-parameters">2.1 Set some downloading parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-satellite-data-for-time-series">2.2 Download and transform satellite data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cmip6-data-for-time-series">2.3 Download and transform CMIP6 data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-climatologies-for-cmip6-projections">2.4 Download and process climatologies for CMIP6 projections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-sea-ice-minima-and-the-projected-probabilities-of-an-ice-free-arctic">3.1 Arctic sea ice minima and the projected probabilities of an ice-free Arctic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-sea-ice-maxima">3.2 Arctic sea ice maxima</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-sea-ice-minima-and-the-projected-probabilities-of-being-ice-free-around-antarctica">3.3 Antarctic sea ice minima and the projected probabilities of being ice-free around Antarctica</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-sea-ice-maxima">3.4 Antarctic sea ice maxima</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#projected-access-to-arctic-shipping-routes">3.5 Projected access to Arctic shipping routes</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#northern-sea-route">3.5.1 Northern sea route</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#transpolar-shipping-route">3.5.2 Transpolar shipping route</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="projections-of-future-ice-free-periods-for-the-arctic-and-antarctic">
<h1><span class="section-number">5.1.1. </span>Projections of future ice-free periods for the Arctic and Antarctic<a class="headerlink" href="#projections-of-future-ice-free-periods-for-the-arctic-and-antarctic" title="Link to this heading">#</a></h1>
<p>Production date: 2025-04-23</p>
<p>Produced by: Timothy Williams, Nansen Environmental and Remote Sensing Center (NERSC)</p>
<section id="use-case-scientific-assessment-of-projected-future-ice-free-conditions-to-inform-product-creation">
<h2>üåç Use case: Scientific assessment of projected future ice-free conditions to inform product creation<a class="headerlink" href="#use-case-scientific-assessment-of-projected-future-ice-free-conditions-to-inform-product-creation" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>How likely are sea-ice-free conditions in the Arctic and Antarctic, and along the Arctic shipping routes, and when under which warming scenarios would they become more likely?</strong></p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Depending on the warming scenario, the Arctic itself has varying chances of being ice-free in the summer. While some authors project the first ice-free year as being before 2050 (regardless of warming scenario) (eg. <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community, 2020</span></a>; <a class="reference external" href="https://doi.org/10.1029/2022EF002708" rel="noreferrer" target="_blank"><span style="color:blue">X. Zhao et al., 2022</span></a>), we find (considering the full set of models proving sea ice concentration) more dependence on the warming scenario, with only 40% of models projecting an ice-free Arctic in 2050 under <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> while 60% of them project it under <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>. In 2070 this range has increased to between 50% and 85%. The period with high probabilities also lengthens according to the warming scenario, from just September in <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> to the 6-month period from June to December in <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>.</p></li>
<li><p>The maximum Arctic area is projected to drop by between <span class="math notranslate nohighlight">\(4\times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> and <span class="math notranslate nohighlight">\(8\times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> from the pre-1960 levels of about <span class="math notranslate nohighlight">\(17\times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span>.</p></li>
<li><p>Around Antarctica, the climate models predict too little ice by quite a large margin, as seen by <a class="reference external" href="https://doi.org/10.1029/2019GL086729" rel="noreferrer" target="_blank"><span style="color:blue">Roach et al. (2023)</span></a> and the <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html" rel="noreferrer" target="_blank"><span style="color:blue">CDS assessment of historical sea ice extent</span></a>, and this limits the conclusions that can be made about accessibility in this region. However with a definition of ice-free conditions consistent with the Arctic, we also see a similar pattern of increased overall probability and length of the period of high probabilities with increased warming.</p></li>
<li><p>We also see this behaviour for the two Arctic shipping routes, the Northern Sea Route (NSR) and the Transpolar Sea Route (TSR). There is higher probability of the TSR being ice-free in December than for the NSR. This is consistent with the results of other authors (<a class="reference external" href="https://doi.org/10.1016/j.accre.2023.11.011" rel="noreferrer" target="_blank"><span style="color:blue">Chen et al, 2023</span></a>; <a class="reference external" href="https://doi.org/10.1029/2022GL099157" rel="noreferrer" target="_blank"><span style="color:blue">Min et al., 2022</span></a>).</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>Related to this assessment are the assessments of <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html" rel="noreferrer" target="_blank"><span style="color:blue">sea ice extent</span></a> and <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html" rel="noreferrer" target="_blank"><span style="color:blue">Arctic sea ice thickness</span></a> in the CMIP6 historical experiment. The sea ice thickness bias is not directly relevant to this one, but it could have been used in subsetting the models.</p>
<p>For each experiment, we take all the models that provide sea ice concentration (SIC) outputs for our ensemble - i.e. we don‚Äôt do any subsetting of models in the results shown. We did do some sensitivity testing for the accessibility results however, and found no change to these results when using different model subsets. Specifically, noting that <a class="reference external" href="https://doi.org/10.1029/2022GL102077" rel="noreferrer" target="_blank"><span style="color:blue">Pan et al. (2023)</span></a> found that climate models whose ocean model component was NEMO (Nucleus for European Modelling of the Ocean) had noticeably reduced Arctic sea ice in projections compared to other climate models, we tried either excluding or only using such models. Users should still bear in mind that using a different subset could still effect results. For example, the <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community (2020)</span></a> selected models whose ensemble spread of sea ice area in the historical experiment included the satellite estimate. Alternatively, subsetting with ‚Äúemergent constraints‚Äù (physically explainable empirical relationships) has been used to reduce the uncertainty in predictions. In examples of this approach, <a class="reference external" href="https://doi.org/10.1029/2022EF002708" rel="noreferrer" target="_blank"><span style="color:blue">X. Zhao et al. (2022)</span></a> used the accuracy of the mean April SIT and the response of the minimum sea ice area to the mean April SIT (compared to the value from Pan-Arctic Ice-Ocean Assimlation System, or PIOMAS) to select models, while <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac0b17" rel="noreferrer" target="_blank"><span style="color:blue">Wang et al. (2021)</span></a> used the accuracy of the surface air temperature and the sensitivity of the ice area to the surface air temperature. Another approach is to use weighted statistics (as done by <a class="reference external" href="https://doi.org/10.1029/2022EF002708" rel="noreferrer" target="_blank"><span style="color:blue">J. Zhou et al., 2022</span></a>), where weights are determined by model skill and interdependance.</p>
<p>We also do not consider the individual ensemble members available for each model, as the <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community (2020)</span></a> did, but only the ensemble mean for each model. This is done to save computational cost, but also avoids biasing the mean towards models with larger ensembles. Also note that we only use the monthly mean - considering daily means as done by <a class="reference external" href="https://doi.org/10.1038/s41467-024-54508-3" rel="noreferrer" target="_blank"><span style="color:blue">Heuze &amp; Jahn (2024)</span></a> can lead to projected estimates of a much earlier first ice-free year (before 2030) than estimated using monthly means.</p>
<p>As well as the historical experiment, which has 33 models that output SIC, we use the following projection experiments, chosen because they provide a sufficiently large ensemble:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> (22 models outputting SIC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> (22 models outputting SIC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> (21 models outputting SIC)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> (21 models outputting SIC)</p></li>
</ul>
<p>The experiments are ordered by expected warming with <code class="docutils literal notranslate"><span class="pre">ssp_1_2_6</span></code> giving the least warming (reaching 2.6 W/m<span class="math notranslate nohighlight">\(^2\)</span> in 2100, which is a kind of ‚Äúbest case‚Äù warming scenario) and <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> giving high warming (8.5 W/m<span class="math notranslate nohighlight">\(^2\)</span> in 2100).
The first number refers to which of the five <a class="reference external" href="https://www.dkrz.de/en/communication/climate-simulations/cmip6-en/the-ssp-scenarios" rel="noreferrer" target="_blank"><span style="color:blue">Shared Socioeconomic Pathways</span></a> (SSP) that the experiment corresponds to.</p>
<p>We calculate the minimum and maximum sea ice areas for the Arctic and Antarctica, show the historical and projected results as well as results derived from satellite observations, and show some climatological maps to show projected changes in the spatial distribution of SIC.
To calculate the area we remap the model SIC onto the equal-area grids used by the observations. The ice-covered area in each grid cell can be determined from the SIC and the grid cell area, and then summed up to get the total ice-covered area.
For each experiment, we then have an ensemble of areal time series (one from each model) and we plot the median and IQL (inter-quartile limits) of this ensemble.
For the climatological maps we follow a similar procedure but average over time instead of space before plotting on the same grids that the observations use.</p>
<p>We also calculate the probability of them being ‚Äúsea-ice-free‚Äù in the future as the fraction of models predicting the sea ice area dropping below a given region-dependent threshold (discussed below). We also do the same calculations for two Arctic shipping routes - the Transpolar Sea Route (TSR) and the Northern |Sea Route (NSR).</p>
<p>One point to note here is that we need to choose an area threshold for when a region is ice-free. A consequence of this is that the probabilities we calculate are a little arbitrary and so we should pay more attention to how they are changing with time than the absolute values.
The thresholds we use to decide when the regions are ice-free are as follows. The ice-free threshold for the Arctic is usually taken as <span class="math notranslate nohighlight">\(10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> (e.g. <a class="reference external" href="https://doi.org/10.1002/2016GL070067" rel="noreferrer" target="_blank"><span style="color:blue">Jahn et al., 2016</span></a>). For the Antarctic this is too high since nearly all of the CMIP6 models significantly underestimate the Antarctic area and accordingly the minimum area for these models is less than <span class="math notranslate nohighlight">\(10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> even in the historical period (<a class="reference external" href="https://doi.org/10.1029/2019GL086729" rel="noreferrer" target="_blank"><span style="color:blue">Roach et al., 2023</span></a>; <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html" rel="noreferrer" target="_blank"><span style="color:blue">CDS assessment of historical sea ice extent</span></a>). Therefore we choose the threshold to be <span class="math notranslate nohighlight">\(0.25 \times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span>, which is about one seventh of the pre-1970 Antarctic minima (according to the models) of about <span class="math notranslate nohighlight">\(1.8 \times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span>. This relationship is the approximate relationship in the Arctic, since the pre-1970 Arctic minima are about <span class="math notranslate nohighlight">\(7 \times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span>. For the two shipping routes, we also divide the pre-1970 Antarctic minima (again according to the models) by seven, giving thresholds of <span class="math notranslate nohighlight">\(0.14 \times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> for the NSR and <span class="math notranslate nohighlight">\(0.21 \times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> for the TSR.</p>
<p>Other authors have also studied accessibility of these and other shipping routes (eg. <a class="reference external" href="https://doi.org/10.1016/j.accre.2023.11.011" rel="noreferrer" target="_blank"><span style="color:blue">Chen et al, 2023</span></a>;<a class="reference external" href="https://doi.org/10.1029/2022EF002708" rel="noreferrer" target="_blank"><span style="color:blue">X. Zhao et al., 2022</span></a>; <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac0b17" rel="noreferrer" target="_blank"><span style="color:blue">Wang et al, 2021</span></a>; <a class="reference external" href="https://doi.org/10.1029/2022GL099157" rel="noreferrer" target="_blank"><span style="color:blue">Min et al., 2022</span></a>; <a class="reference external" href="https://doi.org/10.1007/s10584-021-03172-3" rel="noreferrer" target="_blank"><span style="color:blue">Li et al., 2021</span></a>). For these authors, accessibility is determined by the polar class of the ship (how much ice strengthening the ship has) (if any) and the sea ice concentration and thickness. These variables are generally used as inputs into numerical ship-routing software like the Arctic Transport Accessibility Model (<a class="reference external" href="https://doi.org/10.1017/jog.2020.73" rel="noreferrer" target="_blank"><span style="color:blue">Smith &amp; Stephenson, 2013</span></a>) to create an ensemble of routes (created by using different start and end points for the journey) which are then analysed. Our approach, which would be applicable to open water vessels without ice strengthening, is comparatively simpler but is enough to give an overview of how likely the routes are to be clear and the effect of increased warming.</p>
<p>The ‚ÄúAnalysis and results‚Äù section is organised as follows:</p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-1"><span class="std std-ref">1. Import libraries, set parameters and definitions of functions</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-2"><span class="std std-ref">2. Download and transform data</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3"><span class="std std-ref">3. Results</span></a></strong></p>
<p>¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-1"><span class="std std-ref">3.1 Arctic sea ice minima and the projected probabilities of an ice-free Arctic</span></a></strong></p>
<p>¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-2"><span class="std std-ref">3.2 Arctic sea ice maxima</span></a></strong></p>
<p>¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-3"><span class="std std-ref">3.3 Antarctic sea ice minima and the projected probabilities of being ice-free around Antarctica</span></a></strong></p>
<p>¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-4"><span class="std std-ref">3.4 Antarctic sea ice maxima</span></a></strong></p>
<p>¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-5"><span class="std std-ref">3.5 Projected access to Arctic shipping routes</span></a></strong></p>
<p>¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-5-1"><span class="std std-ref">3.5.1 Northern sea route</span></a></strong></p>
<p>¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <strong><a class="reference internal" href="#climate-projections-cmip6-climate-impact-indicators-q04-section-3-5-2"><span class="std std-ref">3.5.2 Transpolar shipping route</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="import-libraries-set-parameters-and-definitions-of-functions">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-1"></span><h3>1. Import libraries, set parameters and definitions of functions<a class="headerlink" href="#import-libraries-set-parameters-and-definitions-of-functions" title="Link to this heading">#</a></h3>
<section id="import-libraries">
<h4>1.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Import the required libraries, including the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cmocean</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;cf_xarray&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>1.2 Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Set the time period to be analysed with <code class="docutils literal notranslate"><span class="pre">year_start</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop</span></code>.</p></li>
<li><p>Set the regions to be analysed with the list <code class="docutils literal notranslate"><span class="pre">sea_masks</span></code>.</p></li>
<li><p>Set the area thresholds for determining when each region is ice-free with <code class="docutils literal notranslate"><span class="pre">area_thresholds</span></code>.</p></li>
<li><p>Set the concentration threshold <code class="docutils literal notranslate"><span class="pre">sic_threshold</span></code> for determining sea ice extent (we use 30% to be consistent with the ice edge product).</p></li>
<li><p>Set the months we want to determine climatologies for with <code class="docutils literal notranslate"><span class="pre">clim_months</span></code>.</p></li>
<li><p>Set the averaging window (in years) for the climatologies for with <code class="docutils literal notranslate"><span class="pre">clim_length</span></code>.</p></li>
<li><p>Set the starting years for the climatologies for with <code class="docutils literal notranslate"><span class="pre">clim_start_years</span></code>.</p></li>
<li><p>Set the map projections for plotting climatologies with <code class="docutils literal notranslate"><span class="pre">projections</span></code>.</p></li>
<li><p>Set the map extents for plotting climatologies with <code class="docutils literal notranslate"><span class="pre">map_slices</span></code>.</p></li>
<li><p>Set the experiments to be considered with the list <code class="docutils literal notranslate"><span class="pre">experiments</span></code>.</p></li>
<li><p>Set the models to be evaluated with the dictionary <code class="docutils literal notranslate"><span class="pre">models_dict</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1850</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2100</span>
<span class="k">assert</span> <span class="n">year_start</span> <span class="o">&gt;=</span> <span class="mi">1850</span> <span class="ow">and</span> <span class="n">year_stop</span> <span class="o">&lt;=</span> <span class="mi">2100</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">year_start</span> <span class="o">%</span> <span class="mi">10</span>

<span class="c1"># Select masks</span>
<span class="n">sea_masks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;arctic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;antarctic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;transpolar_shipping_route&quot;</span><span class="p">,</span>
    <span class="s2">&quot;northern_sea_shipping_route&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">sea_masks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">{</span>
    <span class="s2">&quot;arctic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;antarctic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;transpolar_shipping_route&quot;</span><span class="p">,</span>
    <span class="s2">&quot;northern_sea_shipping_route&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Extent thresholds for being considered ice-free (units 10^6 km^2)</span>
<span class="c1"># - we take the Antarctic threshold to be about one seventh of the pre-1970 minima,</span>
<span class="c1">#   since this is the relationship in the Arctic</span>
<span class="n">area_thresholds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Arctic&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># usual threshold for Arctic</span>
    <span class="s2">&quot;Antarctic&quot;</span> <span class="p">:</span> <span class="mf">.25</span><span class="p">,</span> <span class="c1"># ~ 1.8 / 7</span>
    <span class="s2">&quot;Northern Sea Shipping Route&quot;</span><span class="p">:</span> <span class="mf">.14</span><span class="p">,</span> <span class="c1"># ~ 1 / 7</span>
    <span class="s2">&quot;Transpolar Shipping Route&quot;</span><span class="p">:</span> <span class="mf">.21</span><span class="p">,</span> <span class="c1"># ~ 1.5 / 7</span>
<span class="p">}</span>

<span class="c1"># Sea Ice Concentration Threshold</span>
<span class="n">sic_threshold</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># %</span>

<span class="c1"># Months to get climatologies for</span>
<span class="n">clim_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>

<span class="c1"># Lengths of climatology windows</span>
<span class="n">clim_length</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># years</span>

<span class="c1"># Start years of the climatologies</span>
<span class="n">clim_start_years</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2095</span><span class="p">,</span> <span class="n">clim_length</span><span class="p">)</span>

<span class="c1"># Map projections for plotting climatologies</span>
<span class="n">projections</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Arctic&quot;</span> <span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mf">90.</span><span class="p">),</span>
    <span class="s2">&quot;Antarctic&quot;</span> <span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=-</span><span class="mf">90.</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Slices in x and y directions (on observation grid) for zooming in on climatologies</span>
<span class="n">map_slices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Arctic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;yc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)},</span>
    <span class="s2">&quot;Antarctic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;yc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)},</span>
<span class="p">}</span>

<span class="c1"># Models</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp1_2_6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp2_4_5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp3_7_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp5_8_5&quot;</span>
<span class="p">]</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">{</span>
    <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp1_1_9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp1_2_6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp2_4_5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp3_7_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp4_3_4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp4_6_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssp5_8_5&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">models_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;historical&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;access_esm1_5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cams_csm1_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_hr4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_esm2_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;e3sm_1_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;e3sm_1_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;e3sm_1_1_eca&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_aerchem&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;giss_e2_1_h&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm5a2_inca&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;norcpm1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;taiesm1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp1_1_9&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gfdl_esm4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp1_2_6&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gfdl_esm4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm5a2_inca&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;taiesm1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp2_4_5&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_esm2_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;taiesm1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp3_7_0&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_aerchem&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gfdl_esm4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm5a2_inca&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;taiesm1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp4_3_4&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp4_6_0&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">&quot;ssp5_8_5&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;e3sm_1_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fgoals_g3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gfdl_esm4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests-for-cds-data">
<h4>1.3 Define requests for CDS data<a class="headerlink" href="#define-requests-for-cds-data" title="Link to this heading">#</a></h4>
<p>Define the download requests in the format needed by the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_months</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>

<span class="n">request_cmip6_historical</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;projections-cmip6&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_area_percentage_on_ocean_grid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="mi">1850</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span> <span class="mi">2014</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">all_months</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_cmip6_projections</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;projections-cmip6&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_area_percentage_on_ocean_grid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="mi">2015</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span> <span class="mi">2100</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">all_months</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_eumetsat</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span><span class="p">,</span>
    <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;EUMETSAT OSI SAF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;ssmis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span><span class="w"> </span><span class="mi">1979</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">request_esa</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span><span class="p">,</span>
    <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;ESA CCI&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;amsr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span><span class="w"> </span><span class="mi">2002</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span><span class="w"> </span><span class="mi">2017</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-to-compute-time-series-of-extent-and-area">
<h4>1.4 Define functions to compute time series of extent and area<a class="headerlink" href="#define-functions-to-compute-time-series-of-extent-and-area" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apply_sea_mask</span></code> chooses the region to analyse.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_extent_and_area_from_sic</span></code> computes the extent and area from a sea ice concentration field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolate_to_satellite_grid</span></code> interpolates the model sea ice concentration to the reference grid (chosen to be the grid of the satellite sea ice concentration dataset).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_interpolated_sea_ice_extent_and_area</span></code> calls <code class="docutils literal notranslate"><span class="pre">interpolate_to_satellite_grid</span></code> to interpolate the model sea ice concentration to the reference grid and then calls <code class="docutils literal notranslate"><span class="pre">compute_extent_and_area_from_sic</span></code> to calculate the extent and area.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_sea_mask</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">):</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sea_mask</span> <span class="o">==</span> <span class="s2">&quot;transpolar_shipping_route&quot;</span><span class="p">:</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Chuckchi_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">180.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">66.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Siberian_Laptev_Kara_Seas&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">35.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">180.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">83.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Barents_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">35.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">68.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_max&quot;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
    <span class="k">elif</span> <span class="n">sea_mask</span> <span class="o">==</span> <span class="s2">&quot;northern_sea_shipping_route&quot;</span><span class="p">:</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Chuckchi_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">177.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">192.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">66.0</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Siberian_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">141.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">177.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">68.0</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Laptev_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">96.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">141.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">70.0</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Kara_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">65.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">96.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">66.0</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;Barents_Sea&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;lon_min&quot;</span><span class="p">:</span> <span class="mf">35.0</span><span class="p">,</span>
                <span class="s2">&quot;lon_max&quot;</span><span class="p">:</span> <span class="mf">65.0</span><span class="p">,</span>
                <span class="s2">&quot;lat_min&quot;</span><span class="p">:</span> <span class="mf">68.0</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>
        <span class="n">lat_verts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">71</span><span class="p">]</span>
        <span class="n">lat_buffer</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">sea_limits</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">lat_verts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_verts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lon_max&quot;</span><span class="p">]</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lon_min&quot;</span><span class="p">]</span>
            <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lat_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">lat_buffer</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">lon</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;arctic&quot;</span><span class="p">,</span> <span class="s2">&quot;antarctic&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sea_mask</span><span class="si">}</span><span class="s2">=&quot;</span><span class="p">)</span>

    <span class="c1"># Convert longitude</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sea_limits</span> <span class="ow">in</span> <span class="n">limits</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">lon</span> <span class="o">&gt;=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lon_min&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">lon</span> <span class="o">&lt;=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lon_max&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&gt;=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lat_min&quot;</span><span class="p">])</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">lat</span> <span class="o">&lt;=</span> <span class="n">sea_limits</span><span class="p">[</span><span class="s2">&quot;lat_max&quot;</span><span class="p">]),</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="n">mask</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_extent_and_area_from_sic</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">apply_sea_mask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">)</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>

    <span class="c1"># Compute diagnostics</span>
    <span class="n">sic_is_normalized</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;(0 - 1)&quot;</span>
    <span class="n">siextent</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">sic</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">sic_threshold</span> <span class="o">/</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">sic_is_normalized</span> <span class="k">else</span> <span class="n">sic_threshold</span><span class="p">),</span>
        <span class="n">grid_cell_area</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">siarea</span> <span class="o">=</span> <span class="n">sic</span> <span class="o">*</span> <span class="p">(</span><span class="n">grid_cell_area</span> <span class="k">if</span> <span class="n">sic_is_normalized</span> <span class="k">else</span> <span class="n">grid_cell_area</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Merge and add attributes</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">siextent</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;siextent&quot;</span><span class="p">),</span> <span class="n">siarea</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;siarea&quot;</span><span class="p">)])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.0e-6</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="n">var</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;si&quot;</span><span class="p">,</span> <span class="s2">&quot;sea_ice_&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">var</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;si&quot;</span><span class="p">,</span> <span class="s2">&quot;Sea ice &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">):</span>
    <span class="c1"># Remove nan columns</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">dim</span> <span class="ow">or</span> <span class="s2">&quot;lon&quot;</span> <span class="ow">in</span> <span class="n">dim</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop_isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>

    <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;ESA CCI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;amsr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">grid_out</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_interpolated_sea_ice_extent_and_area</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interpolate to 25x25km grid and return sea ice diagnostics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds: xr.Dataset</span>
<span class="sd">        Dataset to process</span>
<span class="sd">    sic_threshold: float</span>
<span class="sd">        Sea ice concentration threshold (%)</span>
<span class="sd">    **regrid_kwargs: Any</span>
<span class="sd">        xesmf regrid kwargs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xr.Dataset</span>
<span class="sd">        Dataset with siarea and siextend (km2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]]</span>

    <span class="c1"># Monthly resample</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>

    <span class="k">if</span> <span class="n">regrid_kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="s2">&quot;arctic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transpolar_shipping_route&quot;</span><span class="p">,</span>
            <span class="s2">&quot;northern_sea_shipping_route&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;northern_hemisphere&quot;</span>
        <span class="k">elif</span> <span class="n">sea_mask</span> <span class="o">==</span> <span class="s2">&quot;antarctic&quot;</span><span class="p">:</span>
            <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;southern_hemisphere&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sea_mask</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">compute_extent_and_area_from_sic</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="o">=</span><span class="mi">25</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="n">sea_mask</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-post-process-and-plot-time-series">
<h4>1.5 Functions to post-process and plot time series<a class="headerlink" href="#functions-to-post-process-and-plot-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code> makes the combined dataset easier to work with by making sure all each individual dataset uses the same calendar, and by renaming some variables and attributes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full_year_only_resample</span></code> resamples a time series to yearly, by either taking the minimum or maximum for the year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_timeseries</span></code>loops over each experiment and plots the median and the interquartile range (IQR) of the sea ice area of the ensemble of models. It also plots the area given by the satellite sea ice concentration products. The time series are reduced to yearly frequency according to the argument <code class="docutils literal notranslate"><span class="pre">reduction</span></code> which is a string eg <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_time_series_regional_reduction</span></code> loops over two different time periods, the full CMIP6 period and a ‚Äúzoomed-in‚Äù period (1980-2080 or 2020-2100), and calls <code class="docutils literal notranslate"><span class="pre">plot_time_series</span></code> for each.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">postprocess_dataset</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">var</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">full_year_only_resample</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate yearly reduction eg to get the yearly min or max of a time series</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : xr.Dataset</span>
<span class="sd">    reduction : str</span>
<span class="sd">        eg min or max</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ds_reduced : xr.Dataset</span>
<span class="sd">        resampled time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sel_dict</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ds</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;YE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">12</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;YE&quot;</span><span class="p">),</span> <span class="n">reduction</span><span class="p">)()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ice_free_level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Define colors</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">datasets_satellite</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">datasets_cmip6</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="n">vname</span> <span class="o">=</span> <span class="s2">&quot;Sea ice area&quot;</span>
    <span class="c1"># Get dataarrays</span>
    <span class="n">dataarrays_satellite</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">full_year_only_resample</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="n">vname</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_satellite</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">dataarrays_cmip6</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">full_year_only_resample</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="n">vname</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_cmip6</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">legend_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">legend_labels</span> <span class="o">=</span> <span class="p">[]</span>
      
    <span class="c1"># Plot satellites</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">satellite</span><span class="p">,</span> <span class="n">da_satellite</span><span class="p">),</span> <span class="n">ls</span><span class="p">,</span> <span class="n">zorder</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">dataarrays_satellite</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">da_satellite</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">legend_lines</span> <span class="o">+=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da_satellite</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">da_satellite</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">satellite</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">legend_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="n">satellite</span><span class="p">]</span>
        
    <span class="c1"># Plot CMIP6</span>
    <span class="n">quantiles</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">experiment</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">dataarrays_cmip6</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">size</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">da_quantiles</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">legend_lines</span> <span class="o">+=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da_quantiles</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">da_quantiles</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">experiment</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">legend_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;CMIP6 </span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2"> median&quot;</span><span class="p">]</span>
        
        <span class="n">legend_lines</span> <span class="o">+=</span> <span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">da_quantiles</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
            <span class="n">da_quantiles</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">da_quantiles</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">experiment</span><span class="p">],</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)]</span>
        <span class="n">legend_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;CMIP6 </span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2"> IQL&quot;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># plot the ice-free level if it is passed in</span>
    <span class="k">if</span> <span class="n">ice_free_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">[</span><span class="n">ice_free_level</span><span class="p">]</span>
        <span class="n">legend_lines</span> <span class="o">+=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">legend_labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Ice-free&quot;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># set xtick label format</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center_baseline&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">legend_lines</span><span class="p">,</span> <span class="n">legend_labels</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">,</span> <span class="n">reduction</span><span class="p">,</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a regional time-reduction eg yearly Arctic minima, once for the full period and once zooming in on</span>
<span class="sd">    either the post-1980 period or the post-2020 period</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sea_mask : str</span>
<span class="sd">        eg &#39;Arctic&#39;, &#39;Antarctic&#39;</span>
<span class="sd">    reduction : str</span>
<span class="sd">        eg &#39;min&#39;, &#39;max&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">suptitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Yearly </span><span class="si">{</span><span class="n">sea_mask</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">reduction</span><span class="si">}</span><span class="s2">ima&quot;</span>
    <span class="n">periods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1850&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Full period&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">zoom_projection_period</span><span class="p">:</span>
        <span class="n">periods</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">&quot;2020-2100&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">periods</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1980&quot;</span><span class="p">,</span> <span class="s2">&quot;2080&quot;</span><span class="p">),</span> <span class="s2">&quot;1980-2080&quot;</span><span class="p">),</span>
        <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">time_slice</span><span class="p">,</span> <span class="n">title</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">periods</span><span class="p">,</span> <span class="n">axs</span><span class="p">)):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">plot_timeseries</span><span class="p">(</span>
            <span class="n">datasets_satellite</span><span class="p">,</span>
            <span class="n">datasets_cmip6</span><span class="p">,</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">reduction</span><span class="o">=</span><span class="n">reduction</span><span class="p">,</span>
            <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time_slice</span><span class="p">,</span> <span class="s2">&quot;sea_mask&quot;</span><span class="p">:</span> <span class="n">sea_mask</span><span class="p">},</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">legend_lines</span><span class="p">,</span> <span class="n">legend_labels</span> <span class="o">=</span> <span class="n">out</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Sea ice area [$10^6$km$^2$]&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_lines</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.84</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-create-the-monthly-climatologies">
<h4>1.6 Functions to create the monthly climatologies<a class="headerlink" href="#functions-to-create-the-monthly-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compute_monthly_climatology</span></code> is the function that is used by <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code>.  It takes in an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> and takes the temporal mean for each month, before calling <code class="docutils literal notranslate"><span class="pre">interpolate_to_satellite_grid</span></code> to interpolate the result to the satellite grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_climatology</span></code> makes the dataset easier to use by renaming some variables and ensuring the sea ice concentration has units <code class="docutils literal notranslate"><span class="pre">%</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_climatology_model</span></code> finalises the request to be passed to <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code>, calls <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code>, and then calls <code class="docutils literal notranslate"><span class="pre">postprocess_climatology</span></code> and returns the post-processed dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_climatologies_cmip6</span></code> creates the ensemble mean of monthly climatologies of the sea ice concentration, for a given experiment and time period. It does this by looping over the models in a given experiment and and calling <code class="docutils literal notranslate"><span class="pre">get_monthly_climatology_model</span></code> for each.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_monthly_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">year</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">year1</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">year2</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">ds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year1</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">year2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">postprocess_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># rename month</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    
    <span class="c1"># rename SIC and convert to %</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>
    <span class="n">old_name</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">name</span>
    <span class="n">new_name</span> <span class="o">=</span> <span class="s2">&quot;Sea ice concentration&quot;</span>
    <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
    <span class="n">sic_is_normalized</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;(0 - 1)&quot;</span>
    <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">sic</span> <span class="k">if</span> <span class="n">sic_is_normalized</span> <span class="k">else</span> <span class="n">sic</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">old_name</span><span class="p">:</span> <span class="n">new_name</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_climatology_model</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">=</span> <span class="n">request</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">cid</span><span class="p">,</span>
        <span class="n">req</span> <span class="o">|</span> <span class="p">{</span>
            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year1</span><span class="p">,</span> <span class="n">year2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
            <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">postprocess_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_climatologies_cmip6</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">=</span> <span class="n">request</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="w"> </span><span class="si">= }</span><span class="s2">, (</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="n">get_monthly_climatology_model</span><span class="p">(</span>
                <span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="n">experiment</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">}),</span>
                <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">])]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># some models produce extra variables so drop any that are not needed</span>
    <span class="n">vars_to_keep</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;xc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;yc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;years&#39;</span><span class="p">,</span>
        <span class="s1">&#39;month&#39;</span><span class="p">,</span>
        <span class="s1">&#39;model&#39;</span><span class="p">,</span>
        <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
        <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sea ice concentration&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vars_to_keep</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-plot-climatology-maps">
<h4>1.7 Functions to plot climatology maps<a class="headerlink" href="#functions-to-plot-climatology-maps" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_datasets_eumetsat_clim</span></code> downloads satellite data for each hemisphere for one day. These datasets will be used to add a mask to CMIP6 projection data to improve their visual appearance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_sic_maps</span></code> plots the climatology maps for each experiment (in columns) and time period (in rows).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compare_sic_maps</span></code> is a wrapper that organises the inputs to <code class="docutils literal notranslate"><span class="pre">make_sic_maps</span></code> before calling it.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_datasets_eumetsat_clim</span><span class="p">(</span><span class="n">region_name_mapper</span><span class="p">):</span>
    <span class="n">datasets_eumetsat</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">region_name</span> <span class="ow">in</span> <span class="n">region_name_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span>
        <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;EUMETSAT OSI SAF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;ssmis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
            <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
        <span class="n">datasets_eumetsat</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;ice_conc&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Sea ice concentration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">datasets_eumetsat</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_sic_maps</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">,</span> <span class="n">ds_cmip6</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">isel_dict</span><span class="p">):</span>
    <span class="n">get_sic</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ds</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">isel_dict</span><span class="p">)[</span><span class="s2">&quot;Sea ice concentration&quot;</span><span class="p">]</span>
    <span class="n">sic_eumetsat</span> <span class="o">=</span> <span class="n">get_sic</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="c1"># just want water mask</span>
    <span class="n">sic_cmip6</span> <span class="o">=</span> <span class="n">get_sic</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic_eumetsat</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">sic_cmip6</span><span class="p">,</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
        <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;years&quot;</span><span class="p">),</span>
        <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;experiment&quot;</span><span class="p">),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mf">.065</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.6</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Ice edge&quot;</span>
    <span class="n">ax_legend</span> <span class="o">=</span> <span class="n">facet_grid</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet_grid</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet_grid</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">sic_cmip6</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">yc</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">ax_legend</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ice edge&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">ax_legend</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">h</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.675</span><span class="p">,</span> <span class="mf">.95</span><span class="p">))</span>
            
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_sic_maps</span><span class="p">(</span><span class="n">datasets_eumetsat</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">sel_dict</span><span class="p">,</span> <span class="n">projections</span><span class="p">,</span> <span class="n">map_slices</span><span class="p">):</span>
    <span class="n">make_sic_maps</span><span class="p">(</span>
        <span class="n">ds_eumetsat</span><span class="o">=</span><span class="n">datasets_eumetsat</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
        <span class="n">ds_cmip6</span><span class="o">=</span><span class="n">datasets_cmip6</span><span class="p">[</span><span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">),</span>
        <span class="n">proj</span><span class="o">=</span><span class="n">projections</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
        <span class="n">isel_dict</span><span class="o">=</span><span class="n">map_slices</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-plot-the-access-to-a-given-area">
<h4>1.8 Functions to plot the access to a given area<a class="headerlink" href="#functions-to-plot-the-access-to-a-given-area" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_sea_masks</span></code> makes maps illustrating where we define the transpolar shipping route and the northern sea shipping route.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_access_table</span></code> sorts the time series of sea ice area to make a dataset with dimensions <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">month</span></code> containing the probability that a region will be clear for that year and month. The probability is calculated by considering each model in an experiment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_access_tables</span></code> loops over each CMIP6 projection experiment and calls <code class="docutils literal notranslate"><span class="pre">get_access_table</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_access_tables</span></code> then plots the probability of a region being clear for each experiment by year and month.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_access_vs_month_one_year</span></code> plots <code class="docutils literal notranslate"><span class="pre">Probability</span> <span class="pre">clear</span></code> against <code class="docutils literal notranslate"><span class="pre">month</span></code> for all the experiments and for a given year. That is, it combines vertical slices of the access tables for all the different experiments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_access_vs_month</span></code> loops over a number of years and calls <code class="docutils literal notranslate"><span class="pre">plot_access_vs_month_one_year</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_sea_masks</span><span class="p">(</span><span class="n">sic</span><span class="p">):</span>
    
    <span class="c1"># initialise mask from SIC land mask</span>
    <span class="n">da0</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">da0</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea mask&quot;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="s1">&#39;northern_sea_shipping_route&#39;</span><span class="p">,</span>
        <span class="s1">&#39;transpolar_shipping_route&#39;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># apply sea mask and zoom in on it</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">apply_sea_mask</span><span class="p">(</span><span class="n">da0</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;yc&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
            <span class="n">da</span><span class="p">,</span>
            <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">),</span>
            <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mf">.065</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.75</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="c1"># add area to title</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">25e-3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:  </span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
            <span class="n">sea_mask</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">capitalize</span><span class="p">(),</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">area</span><span class="si">:</span><span class="s2">.03f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;$\times 10^6$ km$^2$&quot;</span><span class="p">,</span>
        <span class="p">)</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_access_table</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">,</span> <span class="n">area_threshold</span><span class="p">):</span>
    <span class="c1"># Create a boolean mask where area &gt; area_threshold</span>
    <span class="n">mask_extent</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">:</span> <span class="n">sea_mask</span><span class="p">})[</span><span class="s1">&#39;Sea ice area&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">area_threshold</span>
    
    <span class="c1"># Convert boolean values to integers (True -&gt; 1, False -&gt; 0)</span>
    <span class="n">masked_data</span> <span class="o">=</span> <span class="n">mask_extent</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Calculate the fraction of models where area &gt; area_threshold along the &#39;model&#39; dimension</span>
    <span class="n">fraction_clear</span> <span class="o">=</span> <span class="n">masked_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
    <span class="n">fraction_clear_array</span> <span class="o">=</span> <span class="n">fraction_clear</span><span class="o">.</span><span class="n">values</span>
    
    <span class="c1"># Get the time values and extract year and month</span>
    <span class="n">time_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">fraction_clear</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">])</span>
    <span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">month</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_values</span><span class="p">])</span>
    
    <span class="c1"># Find unique years and months</span>
    <span class="n">unique_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
    <span class="n">unique_months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
    
    <span class="c1"># Create an empty 2D array with dimensions (&#39;month&#39;, &#39;year&#39;)</span>
    <span class="n">fraction_clear_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_months</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_years</span><span class="p">)))</span>
    
    <span class="c1"># Fill the 2D array with the corresponding probability_clear values</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_years</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_months</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">years</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">months</span> <span class="o">==</span> <span class="n">month</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fraction_clear_2d</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fraction_clear_array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">fraction_clear_2d</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Probability clear&quot;</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unique_months</span><span class="p">],</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">unique_years</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;probability_clear&quot;</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_access_tables</span><span class="p">(</span><span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">area_thresholds</span><span class="p">):</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">sea_mask</span><span class="p">,</span> <span class="n">area_threshold</span> <span class="ow">in</span> <span class="n">area_thresholds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_cmip6</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">experiment</span> <span class="o">==</span> <span class="s2">&quot;historical&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_access_table</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">sea_mask</span><span class="p">,</span> <span class="n">area_threshold</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="p">[</span><span class="n">experiment</span><span class="p">])]</span>
        <span class="n">datasets</span><span class="p">[</span><span class="n">sea_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">,</span> <span class="s1">&#39;experiment&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">datasets</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_access_tables</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;Probability clear&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;experiment&quot;</span><span class="p">,</span>
        <span class="n">aspect</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;tab20b&quot;</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mf">.065</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.6</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet_grid</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">squeeze</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="c1"># don&#39;t need a y-label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span> <span class="c1"># Capitalize the x-label</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_access_vs_month_one_year</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">add_ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;Probability clear&quot;</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span>
    <span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">experiment</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="n">experiment</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-^&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">experiment</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">add_ylabel</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability clear [%]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">)</span><span class="c1">#45)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_access_vs_month</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2040</span><span class="p">,</span> <span class="mi">2091</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">())):</span>
        <span class="n">plot_access_vs_month_one_year</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">),</span>
            <span class="n">add_ylabel</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-data">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-2"></span><h3>2. Download and transform data<a class="headerlink" href="#download-and-transform-data" title="Link to this heading">#</a></h3>
<section id="set-some-downloading-parameters">
<h4>2.1 Set some downloading parameters<a class="headerlink" href="#set-some-downloading-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">io_kwargs</span></code> are some options to speed-up the downloading.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">common_kwargs</span></code> adds the <code class="docutils literal notranslate"><span class="pre">transform_func</span></code> option to make <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> transform the data using <code class="docutils literal notranslate"><span class="pre">compute_interpolated_sea_ice_extent_and_area</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform_func_kwargs</span></code> are options to be passed to <code class="docutils literal notranslate"><span class="pre">compute_interpolated_sea_ice_extent_and_area</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_kwargs</span></code> are options for interpolation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">region_name_mapper</span></code> makes the region names more user friendly.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">io_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Parameters to speed up IO</span>
    <span class="s2">&quot;concat_dim&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;combine&quot;</span><span class="p">:</span> <span class="s2">&quot;nested&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_vars&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;compat&quot;</span><span class="p">:</span> <span class="s2">&quot;override&quot;</span><span class="p">,</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,),</span>
<span class="p">}</span>
<span class="n">common_kwargs</span> <span class="o">=</span> <span class="n">io_kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;transform_func&quot;</span><span class="p">:</span> <span class="n">compute_interpolated_sea_ice_extent_and_area</span><span class="p">}</span>
<span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sic_threshold&quot;</span><span class="p">:</span> <span class="n">sic_threshold</span><span class="p">}</span>
<span class="n">interpolation_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;nearest_s2d&quot;</span><span class="p">,</span>
    <span class="s2">&quot;periodic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;ignore_degenerate&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">region_name_mapper</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;northern_hemisphere&#39;</span> <span class="p">:</span> <span class="s1">&#39;Arctic&#39;</span><span class="p">,</span> <span class="s1">&#39;southern_hemisphere&#39;</span><span class="p">:</span> <span class="s1">&#39;Antarctic&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-satellite-data-for-time-series">
<h4>2.2 Download and transform satellite data for time series<a class="headerlink" href="#download-and-transform-satellite-data-for-time-series" title="Link to this heading">#</a></h4>
<p>Loops over the two satellites and the four masks to get time series of sea ice extent and area for the satellite sea ice concentration products. <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> downloads the data and transforms it with <code class="docutils literal notranslate"><span class="pre">compute_interpolated_sea_ice_extent_and_area</span></code> before saving it to disk. The dataset is then post-processed with <code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code>.  The time series are stored in the dictionary <code class="docutils literal notranslate"><span class="pre">datasets_satellite</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets_satellite</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">requests</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">(</span><span class="s2">&quot;ESA-CCI&quot;</span><span class="p">,</span> <span class="s2">&quot;EUMETSAT-OSI-SAF&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">request_esa</span><span class="p">,</span> <span class="n">request_eumetsat</span><span class="p">)</span>
<span class="p">):</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="n">sea_masks</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">sea_mask</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="s2">&quot;arctic&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transpolar_shipping_route&quot;</span><span class="p">,</span>
            <span class="s2">&quot;northern_sea_shipping_route&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;northern_hemisphere&quot;</span>
        <span class="k">elif</span> <span class="n">sea_mask</span> <span class="o">==</span> <span class="s2">&quot;antarctic&quot;</span><span class="p">:</span>
            <span class="n">region</span> <span class="o">=</span> <span class="s2">&quot;southern_hemisphere&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sea_mask</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span>
            <span class="p">[</span><span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">}</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="p">],</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">:</span> <span class="n">sea_mask</span><span class="p">},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="o">**</span><span class="n">common_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># Missing months are filled with 0</span>
        <span class="n">tmp_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sea_mask</span><span class="o">=</span><span class="p">[</span><span class="n">sea_mask</span><span class="p">]))</span>
    <span class="n">datasets_satellite</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">postprocess_dataset</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">,</span> <span class="s2">&quot;sea_mask&quot;</span><span class="p">))</span>

<span class="c1"># download SIC for one date to get land mask for grid to illustrate the different sea masks</span>
<span class="n">sic_sea_masks</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">request_esa</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">request_esa</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;region&#39;</span> <span class="p">:</span> <span class="s1">&#39;northern_hemisphere&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="s1">&#39;2002&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;06&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="s1">&#39;01&#39;</span><span class="p">})[</span><span class="s1">&#39;ice_conc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-cmip6-data-for-time-series">
<h4>2.3 Download and transform CMIP6 data for time series<a class="headerlink" href="#download-and-transform-cmip6-data-for-time-series" title="Link to this heading">#</a></h4>
<p>Loops over each model in each experiment, and the four masks, to get time series of sea ice extent and area for the CMIP6 models. For each combination, <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> downloads the data and transforms it with <code class="docutils literal notranslate"><span class="pre">compute_interpolated_sea_ice_extent_and_area</span></code> before saving it to disk. The dataset is then post-processed with <code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code>. The time series are stored in the dictionary <code class="docutils literal notranslate"><span class="pre">datasets_cmip6</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets_cmip6</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">experiment</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">request_cmip6_historical</span>
        <span class="k">if</span> <span class="n">experiment</span> <span class="o">==</span> <span class="s2">&quot;historical&quot;</span>
        <span class="k">else</span> <span class="n">request_cmip6_projections</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;year&quot;</span><span class="p">]:</span>
        <span class="k">continue</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">models_dict</span><span class="p">[</span><span class="n">experiment</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sea_mask</span> <span class="ow">in</span> <span class="n">sea_masks</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">experiment</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">model</span><span class="si">=}</span><span class="s2"> (</span><span class="si">{</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">sea_mask</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                <span class="n">request</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">request</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="n">experiment</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">},</span>
                <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span>
                <span class="o">|</span> <span class="n">interpolation_kwargs</span>
                <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;sea_mask&quot;</span><span class="p">:</span> <span class="n">sea_mask</span><span class="p">},</span>
                <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                <span class="o">**</span><span class="n">common_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">tmp_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">postprocess_dataset</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">sea_mask</span><span class="o">=</span><span class="p">[</span><span class="n">sea_mask</span><span class="p">]))</span>
            <span class="p">)</span>
    <span class="n">datasets_cmip6</span><span class="p">[</span><span class="n">experiment</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span>

<span class="n">datasets_access</span> <span class="o">=</span> <span class="n">get_access_tables</span><span class="p">(</span><span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">area_thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-process-climatologies-for-cmip6-projections">
<h4>2.4 Download and process climatologies for CMIP6 projections<a class="headerlink" href="#download-and-process-climatologies-for-cmip6-projections" title="Link to this heading">#</a></h4>
<p>This step loops over each hemisphere, each model in each experiment, and each time period, and calls <code class="docutils literal notranslate"><span class="pre">get_monthly_climatologies_cmip6</span></code> to get the ensemble mean (average over all models in an experiment) for each hemisphere, experiment and time period. The climatologies are stored in the dictionary <code class="docutils literal notranslate"><span class="pre">datasets_cmip6_clim</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets_cmip6_clim</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">region_name</span> <span class="ow">in</span> <span class="n">region_name_mapper</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">models</span> <span class="ow">in</span> <span class="n">models_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">experiment</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">}:</span>
            <span class="k">continue</span>
        <span class="n">cmip6_clim_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="o">**</span><span class="n">io_kwargs</span><span class="p">,</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_monthly_climatology</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">interpolation_kwargs</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">year1</span> <span class="ow">in</span> <span class="n">clim_start_years</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">experiment</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">year1</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_monthly_climatologies_cmip6</span><span class="p">(</span>
                <span class="n">experiment</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="n">request_cmip6_projections</span><span class="p">,</span>
                <span class="n">year1</span><span class="p">,</span> <span class="n">year1</span> <span class="o">+</span> <span class="n">clim_length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">clim_months</span><span class="p">,</span> <span class="o">**</span><span class="n">cmip6_clim_kwargs</span><span class="p">,</span>
            <span class="p">)]</span>
        <span class="n">datasets_cmip6_clim</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="p">[</span><span class="n">experiment</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">datasets_cmip6_clim</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_cmip6_clim</span><span class="p">[</span><span class="n">region_name</span><span class="p">],</span> <span class="s2">&quot;experiment&quot;</span><span class="p">)</span>

<span class="c1"># options for plotting climatologies</span>
<span class="n">map_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;datasets_eumetsat&quot;</span><span class="p">:</span> <span class="n">get_datasets_eumetsat_clim</span><span class="p">(</span><span class="n">region_name_mapper</span><span class="p">),</span>
    <span class="s2">&quot;datasets_cmip6&quot;</span><span class="p">:</span> <span class="n">datasets_cmip6_clim</span><span class="p">,</span>
    <span class="s2">&quot;projections&quot;</span><span class="p">:</span> <span class="n">projections</span><span class="p">,</span>
    <span class="s2">&quot;map_slices&quot;</span><span class="p">:</span> <span class="n">map_slices</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="results">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>In this section we plot yearly minima and maxima for sea ice area, for the Arctic and Antarctic. We also estimate the probability that a region is ice-free,
by taking the ensemble of models and using the percentage of models predicting it as having low enough area as the probability. We chart this by month-by-month to also see how much of the year periods with a high chance of being ice-free are happening.</p>
<section id="arctic-sea-ice-minima-and-the-projected-probabilities-of-an-ice-free-arctic">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-1"></span><h4>3.1 Arctic sea ice minima and the projected probabilities of an ice-free Arctic<a class="headerlink" href="#arctic-sea-ice-minima-and-the-projected-probabilities-of-an-ice-free-arctic" title="Link to this heading">#</a></h4>
<p>In the Arctic region, the yearly minimum in sea ice area shows a clear effect of increased warming. Before about 1990 the historical CMIP6 is relatively constant. After this time however it drops rapidly. This agrees quite well with the satellite data when they are available. As we come to the start of the projection period (2015-2100), the yearly minima continues to drop. The minimum area is highest for the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment and its median plateaus around the ice-free level, so about half the models predict the Arctic will be ice-free in the projection period under this scenario. The medians for the <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> and <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> minimum extents are similar, both reaching the ice-free level about 2050, and even dropping close to zero by the end of the century. The <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> median is consistently the lowest and reaches the ice-free level around 2040. The median drops to near zero around 2070.</p>
<p>The yearly minimum in sea ice area follows mostly the same pattern, although the time when the median and lower quartile reach zero is slightly later since there is no concentration threshold used in the calculation (a grid cell is classed as ice-free if the concentration is below 30%).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">ice_free_level</span><span class="o">=</span><span class="n">area_thresholds</span><span class="p">[</span><span class="s2">&quot;Arctic&quot;</span><span class="p">],</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/fcec5424b3de817676e016901302edaa6ae170a2f8b48dafa59f64d1648b9f2f.png" src="../../_images/fcec5424b3de817676e016901302edaa6ae170a2f8b48dafa59f64d1648b9f2f.png" />
</div>
</div>
<p>The maps below show the spatial pattern of the decrease in sea ice cover by plotting the ensemble mean of the sea ice concentration for a series of 20-year climatologies for the month of September. The magenta lines plot the ice edge (15% concentration contour). Going from left to right (increasing the amount of warming in the projection), there is quite a big difference, especially from 2035. From 2055 only the <code class="docutils literal notranslate"><span class="pre">ssp_1_2_6</span></code> experiment has a significant amount of ice.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7aa70abcee43dff0a8419a07b2ba611ec80381b89b60dd1acbab9d51f316904f.png" src="../../_images/7aa70abcee43dff0a8419a07b2ba611ec80381b89b60dd1acbab9d51f316904f.png" />
</div>
</div>
<p>The heat maps below show the proportion of models having a minimum Arctic sea ice area less than <span class="math notranslate nohighlight">\(10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span>. For the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment, the chances  of being ice-free in September reach 20% around 2040, 40% around 2050 and 50% around 2070. In August there are consistently 40-50% probabilities after 2080, while in October the chances are about 20-30% from this time. From 2090, about 15% of the models predict ice-free conditions in July under this warming scenario.</p>
<p>We can see however that the chances are being overestimated (perhaps indicating a bias of about 10%) since some years in the past (at time of writing i.e. 2015-2024) have 10% chance of the Arctic being ice-free  (1 in 10 models predict this) while it has never been observed yet. Choosing a different subset of models could also avoid this bias.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> experiment, the pattern is similar but the probabilities have increased somewhat. In September they are above 80% from about 2085, with it being 95-100% for three of the later years. In August and October the chances reach about 70% (in 2085 and 2093 respectively), and 20% of the models are predicting ice-free conditions in July and November.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> experiment, there are now 85%-90% chances of being ice-free in August-October after about 2085. The chances in July and November have also increased (above 40% after about 2083, and sometimes reaching 60%), and there is also a 20%-30% chance of it being ice-free in June and December from about 2095.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> experiment, there are now chances of the Arctic being ice-free from August to October of around 70-80% from about 2070. In September, the chances of being ice-free are consistently over 80% from around 2065. July and November have high chances (70%-85%) of an ice-free Arctic in the last decade or two under this scenario, and the chances of June and December start to become significant earlier than under <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code>. In this experiment (<code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>), even May and January have 20% probability in the last 5 years or so.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_tables</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Arctic&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/3234a13785d1d2f0a3e740bdcd0b9319e9de0a048f714dc706dbf5ca33306482.png" src="../../_images/3234a13785d1d2f0a3e740bdcd0b9319e9de0a048f714dc706dbf5ca33306482.png" />
</div>
</div>
<p>In summary, the heat maps above show that as the warming increases, we can clearly see that the overall probability of being ice-free is increasing, and the length of the season where there is high probability is also increasing from just September (<code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code>) to the 6-month period from June to December (<code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>).
This can also be seen in the plots below, where we compare the experiments more directly by plotting the monthly probabilities for a selection of years.</p>
<p>In the years before 2060, the probabilities are not ordered by warming strength, but around 2060 <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> reaches the <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> level, and after that year the probabilities‚Äô order does correspond to warming strength.
In 2040, the maximum probability ranges from about 20% to 40%; in 2050 and 2060 it ranges from about 40% to 60%; in 2070, 2080 and 2090 it ranges from about 45% to about 85%. In the latter three years the main effect is the widening of the season with the highest probabilities.</p>
<p>Comparing to other authors estimates, the <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community (2020)</span></a> found that nearly all of their selected models projected ice-free conditions by 2050, regardless of warming scenario. <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac9d4d" rel="noreferrer" target="_blank"><span style="color:blue">X. Zhao et al. (2022)</span></a> agree with this - they projected the first ice-free year to be <span class="math notranslate nohighlight">\(2049\pm 12\)</span> under <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> and <span class="math notranslate nohighlight">\(2043\pm 9\)</span> under <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>, giving a similar range to the <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community (2020)</span></a>. While our 2050 probability of just under 60% for <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> is quite high, 40% for <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> is quite a lot lower. This difference possibly reflects the effect both of using a different subset of models and of using the full ensemble set provided for each model, as <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue">SIMIP community (2020)</span></a> did (instead of just using the ensemble mean for each model).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_vs_month</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Arctic&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c8729c4ab89ae3327bd9e44253ef022e17c87c1c0c68ce957dde283ed86ce10f.png" src="../../_images/c8729c4ab89ae3327bd9e44253ef022e17c87c1c0c68ce957dde283ed86ce10f.png" />
</div>
</div>
</section>
<section id="arctic-sea-ice-maxima">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-2"></span><h4>3.2 Arctic sea ice maxima<a class="headerlink" href="#arctic-sea-ice-maxima" title="Link to this heading">#</a></h4>
<p>Like the Arctic minimum in sea ice area, the maximum sea ice area is constant until about 1990 the historical CMIP6 is relatively constant, before starting to drop rapidly. However, unlike with the minimum area, there is a clear bias in this variable, with both the ERA5 reanalysis and the CMIP6 ensembles overestimating it by about <span class="math notranslate nohighlight">\(1.5\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>. As we come to the start of the projection period (2015-2100), the yearly maxima continues to drop. Unlike with the minima, the maximum sea ice area shows a clear response to increased warming - as the warming increases the median Arctic maximum area drops. The experiment with the most warming (<code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>) also shows a very large spread in this variable by 2100.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c635f0192167d7efee0d72255454bace10513452be0e720afe549b70723f729e.png" src="../../_images/c635f0192167d7efee0d72255454bace10513452be0e720afe549b70723f729e.png" />
</div>
</div>
<p>Looking at the maps below, we can see that there is not too much difference between the maps in March before about 2055. After this however, the <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> experiment especially starts to have reduced concentration in the central Arctic, and also in the Hudson Bay. The <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> experiment also shows this pattern to some extent. The drop in maximum sea ice area with time can also be seen, e.g. in the Bering and Labrador Seas.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/3f5333910d0cf9b6130c7e3aba5815c951fe8945062cf0ff42ad7a948bdeea01.png" src="../../_images/3f5333910d0cf9b6130c7e3aba5815c951fe8945062cf0ff42ad7a948bdeea01.png" />
</div>
</div>
</section>
<section id="antarctic-sea-ice-minima-and-the-projected-probabilities-of-being-ice-free-around-antarctica">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-3"></span><h4>3.3 Antarctic sea ice minima and the projected probabilities of being ice-free around Antarctica<a class="headerlink" href="#antarctic-sea-ice-minima-and-the-projected-probabilities-of-being-ice-free-around-antarctica" title="Link to this heading">#</a></h4>
<p>The CMIP6 models show a large bias in the Antarctic minimum sea ice area compared to the satellite data, underestimating it by about 1-<span class="math notranslate nohighlight">\(2\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>. The satellites seem to show a relatively constant minimum, while there is a steady drop predicted by the CMIP6 models in this time period when observations are available (1979-2017).</p>
<p>Keeping in mind the large bias in the CMIP6 models in this area (<a class="reference external" href="https://doi.org/10.1029/2019GL086729" rel="noreferrer" target="_blank"><span style="color:blue">Roach et al., 2023</span></a>; <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html" rel="noreferrer" target="_blank"><span style="color:blue">CDS assessment of historical sea ice extent</span></a>), the modelled Antarctic minimum in sea ice area shows a clear effect of increased warming. After about 1960 the CMIP6 ensemble median starts to slowly drop, and then after 2015 the rate depends on the warming scenario. The median only reaches our ice-free limit of <span class="math notranslate nohighlight">\(0.25\times10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> under the <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> and <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> scenarios, but the <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> median is close to it. Under the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> scenario the area stays about <span class="math notranslate nohighlight">\(0.4\times 10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> from about 2040. The spread of the models is quite high.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ice_free_level</span><span class="o">=</span><span class="n">area_thresholds</span><span class="p">[</span><span class="s1">&#39;Antarctic&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7cb4abb6f6c89d5554272ce91c0bc48fbb6663b1fb3c1fd73b669643d0db0b6c.png" src="../../_images/7cb4abb6f6c89d5554272ce91c0bc48fbb6663b1fb3c1fd73b669643d0db0b6c.png" />
</div>
</div>
<p>A clear effect of climate change can be see in the maps below of the Antarctic sea ice concentration for March. Apart from the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment, there is very little ice outside the Weddell and Ross Sea, and the <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> has mostly lost its ice in the Ross Sea by 2075.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/38066d058b27a7b2f5224db9ac43bf6d5409304f70cb9d9c803c0eb4fadf58c6.png" src="../../_images/38066d058b27a7b2f5224db9ac43bf6d5409304f70cb9d9c803c0eb4fadf58c6.png" />
</div>
</div>
<p>The heat maps below show the proportion of models dropping below <span class="math notranslate nohighlight">\(0.25\times10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> for a given month and year, and below them we compare the monthly probabilities more directly for all the experiments for a selection of years.</p>
<p>As with the Arctic, increased warming increases the overall probability and also the length of the period when there is high probability. However, unlike the Arctic, the Antarctic region has lower chance of being ice-free, only getting consistently over 70% only in the warmest scenario <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>. The chances in February reach 50% around 2040 and 80% around 2088 in that experiment.
In March and January the probability also reaches 60% (in 2070 and 2095 respectively), and even 70% (from about 2080 in March).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ssp_2_4_5</span></code> and <code class="docutils literal notranslate"><span class="pre">ssp_3_7_0</span></code> experiments show similar probabilities, consistently reaching 60% in February in the last two decades or so. In March they get to 50% from about 2080 (a few years earlier under <code class="docutils literal notranslate"><span class="pre">ssp_2_4_5</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment has probabilities of being ice-free oscillating between 20%-40% in February, and between 20%-35% in March.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_tables</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ac381e28ac77f9b6c0108c61f7cce1331d7d1f0bef56c22dae077ce98e5651d9.png" src="../../_images/ac381e28ac77f9b6c0108c61f7cce1331d7d1f0bef56c22dae077ce98e5651d9.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_vs_month</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f9cf2debccc24c96d05333a2021c8beb1b4165bc6a06361c5e0136b400636edb.png" src="../../_images/f9cf2debccc24c96d05333a2021c8beb1b4165bc6a06361c5e0136b400636edb.png" />
</div>
</div>
</section>
<section id="antarctic-sea-ice-maxima">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-4"></span><h4>3.4 Antarctic sea ice maxima<a class="headerlink" href="#antarctic-sea-ice-maxima" title="Link to this heading">#</a></h4>
<p>The projected Antarctic sea ice maxima behave in a similar way to the Arctic maxima with time and warming, with a similar relative drop (30%-50%). The CMIP6 models again show a large bias in the Antarctic sea ice area compared to the satellite data, although the difference is less at the start of the start of the satellite period (1979). However, since the satellites show a slight increase in minimum area, while there is a steady drop predicted by the CMIP6 models, the difference increases with time, reaching about <span class="math notranslate nohighlight">\(2\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> by 2015.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f221b35b310823af5ab42c98e77e06c04661c3e08a724962ec74a2a203b27362.png" src="../../_images/f221b35b310823af5ab42c98e77e06c04661c3e08a724962ec74a2a203b27362.png" />
</div>
</div>
<p>Less effect can be seen in the maps below of the ensemble mean Antarctic sea ice concentration in September than in March. For the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment, there is little difference between the last time period and the first, but there small decreases in area, which are relatively even around the continent, visible for the other experiments. In the last two time periods, there is also a slight decrease in area as the warming increases.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/2b739fb42daa7137551b7b56fa1cd852fe6eb60b9484a2229d60daf04ed0bf83.png" src="../../_images/2b739fb42daa7137551b7b56fa1cd852fe6eb60b9484a2229d60daf04ed0bf83.png" />
</div>
</div>
</section>
<section id="projected-access-to-arctic-shipping-routes">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-5"></span><h4>3.5 Projected access to Arctic shipping routes<a class="headerlink" href="#projected-access-to-arctic-shipping-routes" title="Link to this heading">#</a></h4>
<p>We consider two Arctic shipping routes, the Transpolar Shipping Route (TSR) and the Northern Sea Route (NSR). We do not consider the Northwest Passage (NWP) since the climate models generally don‚Äôt have enough resolution to represent the Canadian archipelago. The figure below shows our definition of these two routes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sea_masks</span><span class="p">(</span><span class="n">sic_sea_masks</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/1fdc85ec4b1f7ff3701dc139707266e55ad5151fb7a2eb76cce84b6b6991bbf9.png" src="../../_images/1fdc85ec4b1f7ff3701dc139707266e55ad5151fb7a2eb76cce84b6b6991bbf9.png" />
<img alt="../../_images/c9f4d00dacbdfe804d27714d3535ab1eb21c506584f691a0810df31ec2e5d2f2.png" src="../../_images/c9f4d00dacbdfe804d27714d3535ab1eb21c506584f691a0810df31ec2e5d2f2.png" />
</div>
</div>
<section id="northern-sea-route">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-5-1"></span><h5>3.5.1 Northern sea route<a class="headerlink" href="#northern-sea-route" title="Link to this heading">#</a></h5>
<p>In the plots below we can see the minimum sea ice area in the NSR as stable at about <span class="math notranslate nohighlight">\(10^6 \)</span>km<span class="math notranslate nohighlight">\(^2\)</span> until about 1970 when it starts dropping. The historical area is fairly close to the observations in this area, athough they are initially a bit low and a bit high after about 2005. Most experiments‚Äô median have dropped below the ice free level by 2040.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Northern Sea Shipping Route&quot;</span><span class="p">,</span> <span class="n">ice_free_level</span><span class="o">=</span><span class="n">area_thresholds</span><span class="p">[</span><span class="s1">&#39;Northern Sea Shipping Route&#39;</span><span class="p">],</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7d6fe880789e5850572922537ba355d8ed8b003fb92edf07b9cd779bc4001403.png" src="../../_images/7d6fe880789e5850572922537ba355d8ed8b003fb92edf07b9cd779bc4001403.png" />
</div>
</div>
<p>The heat maps below show the proportion of models dropping below <span class="math notranslate nohighlight">\(0.14\times10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> for a given month and year, and below them we compare the monthly probabilities more directly for all the experiments for a selection of years.</p>
<p>We can see even in the experiment with the least warming, there is a high chance of the Northern Sea Route (NSR) being clear in September, especially after about 2040, when the probability reaches about 70%. After this the probabilty fluctuates between about 70% and 80%. August has quite high probabilities too, getting to around 70% around 2060. The probability in October reaches about 50%, while it reaches about 20% in July. The chances increase as the experiments change to produce more warming, and the chances of having the NSR clear in November and July start to increase as well. In November and July <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> has about 60-70% (sometimes higher) chance after 2082 or 2083. <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> has 80% chance in November and 70-80% chance in July, both from about 2075. In July <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> has about 60-70% chance after 2080, while <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> has 80% chance from about 2075. The experiment <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> even has 40-50% chance of it being clear in December in later years, and 80-100% of the models are projecting the NSR to be free in August, September, and October from about 2055 under this scenario.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_tables</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Northern Sea Shipping Route&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/da0c75689f59928d0ea5bc2fef02f0281689e4db665d5ad7da4a12ea0224d9e9.png" src="../../_images/da0c75689f59928d0ea5bc2fef02f0281689e4db665d5ad7da4a12ea0224d9e9.png" />
</div>
</div>
<p>The probabilities shown below for September in 2040 and 2050 are only slightly lower than the results of <a class="reference external" href="https://doi.org/10.1016/j.accre.2023.11.011" rel="noreferrer" target="_blank"><span style="color:blue">Chen et al. (2023)</span></a> (see Figures 6a and 6b), who estimated the probability (averaged over 2045-2055) of the Sannikov Strait being passable by open water vessels (without ice strengthening) of 60% under <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> and 100% under <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code>. The size of their navigability window (about July-November) is also similar to ours. This strait (along with the Dmitry Laptev Strait which had slightly lower passability than the Sannikov Strait) is key for the overall passability of the NSR overall. This consistency is reassuring given the quite different methods of calculating the probabilities and the different subsets of the climate models used.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_vs_month</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Northern Sea Shipping Route&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ad0a08d4de34b88a6562efd4b08a9fab7d26369735c764d4b6927158249a99a6.png" src="../../_images/ad0a08d4de34b88a6562efd4b08a9fab7d26369735c764d4b6927158249a99a6.png" />
</div>
</div>
</section>
<section id="transpolar-shipping-route">
<span id="climate-projections-cmip6-climate-impact-indicators-q04-section-3-5-2"></span><h5>3.5.2 Transpolar shipping route<a class="headerlink" href="#transpolar-shipping-route" title="Link to this heading">#</a></h5>
<p>In the plots below we can see the minimum sea ice area in the TSR as stable at about <span class="math notranslate nohighlight">\(1.5 \times 10^6 \)</span>km<span class="math notranslate nohighlight">\(^2\)</span> until about 1970 when it starts dropping. The area from historical experiment is fairly close to the observations in this area. Most experiments‚Äô median have dropped below the ice free level by 2050, with the exception of the <code class="docutils literal notranslate"><span class="pre">ssp1_2_6</span></code> experiment, which is not consistently beneath it until about 2070. This experiment has quite a large spread compared to the others.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_regional_reduction</span><span class="p">(</span>
    <span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">sea_mask</span><span class="o">=</span><span class="s2">&quot;Transpolar Shipping Route&quot;</span><span class="p">,</span> <span class="n">ice_free_level</span><span class="o">=</span><span class="n">area_thresholds</span><span class="p">[</span><span class="s1">&#39;Transpolar Shipping Route&#39;</span><span class="p">],</span> <span class="n">zoom_projection_period</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0d3c8d0d34d6d81b8a20ea7f325ba078b8406ef80ab6b76d2f3bd42c49bdcba4.png" src="../../_images/0d3c8d0d34d6d81b8a20ea7f325ba078b8406ef80ab6b76d2f3bd42c49bdcba4.png" />
</div>
</div>
<p>The heat maps below show the proportion of models dropping below <span class="math notranslate nohighlight">\(0.21\times10^6\)</span> km<span class="math notranslate nohighlight">\(^2\)</span> for a given month and year, and below them we compare the monthly probabilities more directly for all the experiments for a selection of years.</p>
<p>The Transpolar shipping route (TSR) has slightly lower chances of being ice-free in the months August-October than the NSR but somewhat surprisingly it is a bit higher in other months, with it having some chance of it being clear in winter months in the experiments with higher warming.
For example, under <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> there is a 35% chance of the TSR being clear from February to May after 2089 (after 2085 for February), and there is more than 60% chance of it being clear in December from about 2088, and the same chance in January from 2095.
Under <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> there is more than 20% chance of the TSR being ice-free in December, and also in January from 2090.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_tables</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Transpolar Shipping Route&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/bb96ca561508b761f9e4f58ca444bd4ced71ffa32c1185d2f1b2561340154ecb.png" src="../../_images/bb96ca561508b761f9e4f58ca444bd4ced71ffa32c1185d2f1b2561340154ecb.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_access_vs_month</span><span class="p">(</span><span class="n">datasets_access</span><span class="p">[</span><span class="s2">&quot;Transpolar Shipping Route&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f65c553ebabd7f0213068b589abef0889d758cf126c8816729a2eac84f71066d.png" src="../../_images/f65c553ebabd7f0213068b589abef0889d758cf126c8816729a2eac84f71066d.png" />
</div>
</div>
<p>The maps below plot the ensemble mean sea ice concentration for December for a series of time intervals between 2015 and 2095. In the 2075-2095 period, the <code class="docutils literal notranslate"><span class="pre">ssp5_8_5</span></code> has a distinct gap where we have defined our TSR, while there is still ice off the Russian coast blocking the NSR. The effect is also present to a lesser extent for the <code class="docutils literal notranslate"><span class="pre">ssp2_4_5</span></code> and <code class="docutils literal notranslate"><span class="pre">ssp3_7_0</span></code> xperiments, so perhaps ice-strengthened vessels could still traverse the TSR under these scenarios also. This is consistent with the results of <a class="reference external" href="https://doi.org/10.1029/2022GL099157" rel="noreferrer" target="_blank"><span style="color:blue">Min et al (2022)</span></a> (see Figure 3), who found that from 2080 to 2100, the TSR would be a more robust option than the NSR or the North-West Passage for open water vessels.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;December&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/6be378239d524d4a996d563eafc41da8b0ef721747f09de46544ba83176b4c95.png" src="../../_images/6be378239d524d4a996d563eafc41da8b0ef721747f09de46544ba83176b4c95.png" />
</div>
</div>
</section>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Introductory sea ice materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.epa.gov/sites/default/files/2016-11/documents/print_arctic-sea-ice-2016.pdf" rel="noreferrer" target="_blank"><span style="color:blue">Role of sea ice in the climate</span></a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure" rel="noreferrer" target="_blank"><span style="color:blue">Observing sea ice with satellites</span></a></p></li>
</ul>
<p>Introductory CMIP6 materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.wcrp-climate.org/wgcm-cmip/cmip-video" rel="noreferrer" target="_blank"><span style="color:blue">A short introduction to CMIP and CMIP6</span></a></p></li>
<li><p><a class="reference external" href="https://www.carbonbrief.org/cmip6-the-next-generation-of-climate-models-explained/" rel="noreferrer" target="_blank"><span style="color:blue">CMIP6: the next generation of climate models explained</span></a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank"><span style="color:blue">C3S EQC custom functions</span></a> developed by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank"><span style="color:blue">B-Open</span></a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Chen, J. L., Kang, S. C., Wu, A. D., Chen, L. H., &amp; Li, Y. W. (2023). Accessibility in key areas of the Arctic in the 21st mid-century. Advances in Climate Change Research, 14(6), 896-903, <a class="reference external" href="https://doi.org/10.1016/j.accre.2023.11.011" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1016/j.accre.2023.11.011 </span></a>.</p></li>
<li><p>Chen, J., Kang, S., You, Q., Zhang, Y., &amp; Du, W. (2022). Projected changes in sea ice and the navigability of the Arctic Passages under global warming of 2‚ÑÉ and 3‚ÑÉ. Anthropocene, 40, 100349, <a class="reference external" href="https://doi.org/10.1016/j.ancene.2022.100349" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1016/j.ancene.2022.100349 </span></a>.</p></li>
<li><p>Chen, J. L., Kang, S. C., Guo, J. M., Xu, M., &amp; Zhang, Z. M. (2021). Variation of sea ice and perspectives of the Northwest Passage in the Arctic Ocean. Advances in Climate Change Research, 12(4), 447-455, <a class="reference external" href="https://doi.org/10.1016/j.accre.2021.02.002" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1016/j.accre.2021.02.002 </span></a>.</p></li>
<li><p>Davy, R., and S. Outten (2020). The Arctic Surface Climate in CMIP6: Status and Developments since CMIP5. J. Climate, 33, 8047‚Äì8068, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1175/JCLI-D-19-0990.1 </span></a>.</p></li>
<li><p>Heuz√©, C. &amp; Jahn, A. (2024). The first ice-free day in the Arctic Ocean could occur before 2030. Nat. Commun. 15, 10101, <a class="reference external" href="https://doi.org/10.1038/s41467-024-54508-3" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1038/s41467-024-54508-3 </span></a>.</p></li>
<li><p>Jahn, A., Kay, J. E., Holland, M. M., &amp; Hall, D. M. (2016). How predictable is the timing of a summer ice‚Äêfree Arctic? Geophysical Research Letters, 43(17), 9113-9120 , <a class="reference external" href="https://doi.org/10.1002/2016GL070067" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1002/2016GL070067 </span></a>.</p></li>
<li><p>Jahn, A., Holland, M.M. &amp; Kay, J.E. (2024). Projections of an ice-free Arctic Ocean. Nat. Rev. Earth. Environ. 5, 164‚Äì176, <a class="reference external" href="https://doi.org/10.1038/s43017-023-00515-9" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1038/s43017-023-00515-9 </span></a>.</p></li>
<li><p>Li, X., Stephenson, S. R., Lynch, A. H., Goldstein, M. A., Bailey, D. A., &amp; Veland, S. (2021). Arctic shipping guidance from the CMIP6 ensemble on operational and infrastructural timescales. Climatic Change, 167, 1-19, <a class="reference external" href="https://doi.org/10.1007/s10584-021-03172-3" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1007/s10584-021-03172-3 </span></a>.</p></li>
<li><p>Melia, N., Haines, K., and Hawkins, E. (2016). Sea ice decline and 21st century trans-Arctic shipping routes, Geophys. Res. Lett., 43, 9720‚Äì9728, <a class="reference external" href="https://doi.org/10.1002/2016GL069315" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1002/2016GL069315 </span></a>.</p></li>
<li><p>Min, C., Yang, Q., Chen, D., Yang, Y., Zhou, X., Shu, Q., &amp; Liu, J. (2022). The emerging Arctic shipping corridors. Geophysical Research Letters, 49(10), e2022GL099157. <a class="reference external" href="https://doi.org/10.1029/2022GL099157" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2022GL099157 </span></a>.</p></li>
<li><p>Pan, R., Shu, Q., Wang, Q., Wang, S., Song, Z., He, Y., &amp; Qiao, F. (2023). Future Arctic climate change in CMIP6 strikingly intensified by NEMO‚Äêfamily climate models. Geophysical Research Letters, 50(4), e2022GL102077, <a class="reference external" href="https://doi.org/10.1029/2022GL102077" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2022GL102077 </span></a>.</p></li>
<li><p>Roach, L. A., J. D√∂rr, C. R. Holmes, F. Massonnet, E. W. Blockley, D. Notz, T. Rackow, M. N. Raphael, S. P. O‚ÄôFarrell, D. A. Bailey, and C. M. Bitz (2020). Antarctic sea ice area in CMIP6. Geophysical Research Letters, 47, e2019GL086729, <a class="reference external" href="https://doi.org/10.1029/2019GL086729" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2019GL086729 </span></a>.</p></li>
<li><p>SIMIP Community (2020). Arctic sea ice in CMIP6. Geophysical Research Letters, 47, e2019GL086749, <a class="reference external" href="https://doi.org/10.1029/2019GL086749" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2019GL086749 </span></a>.</p></li>
<li><p>Smith, L. C., &amp; Stephenson, S. R. (2013). New Trans-Arctic shipping routes navigable by midcentury. Proceedings of the National Academy of Sciences, 110(13), E1191-E1195, <a class="reference external" href="https://doi.org/10.1073/pnas.1214212110" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1073/pnas.1214212110 </span></a>.</p></li>
<li><p>Wei, T., Yan, Q., Qi, W., Ding, M., &amp; Wang, C. (2020). Projections of Arctic sea ice conditions and shipping routes in the twenty-first century using CMIP6 forcing scenarios. Environmental Research Letters, 15(10), 104079, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1175/JCLI-D-19-0990.1 </span></a>.</p></li>
<li><p>Wang, B., Zhou, X., Ding, Q., &amp; Liu, J. (2021). Increasing confidence in projecting the Arctic ice-free year with emergent constraints. Environmental Research Letters, 16(9), 094016, <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac0b17" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1088/1748-9326/ac0b17 </span></a>.</p></li>
<li><p>Zhao, J., He, S., Wang, H., &amp; Li, F. (2022). Constraining CMIP6 Projections of an ice‚Äêfree Arctic Using a weighting scheme. Earth‚Äôs Future, 10(10), e2022EF002708, <a class="reference external" href="https://doi.org/10.1029/2022EF002708" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1029/2022EF002708 </span></a>.</p></li>
<li><p>Zhou, X., Wang, B., &amp; Huang, F. (2022). Evaluating sea ice thickness simulation is critical for projecting a summer ice-free Arctic Ocean. Environmental Research Letters, 17(11), 114033, <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac9d4d" rel="noreferrer" target="_blank"><span style="color:blue"> https://doi.org/10.1088/1748-9326/ac9d4d </span></a>.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Climate_Projections/CMIP6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CMIP6.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.1. </span>CMIP6</p>
      </div>
    </a>
    <a class="right-next"
       href="climate_projections-cmip6_model-performance_q02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.1.2. </span>Historical accuracy of sea ice extent in the CMIP6 projections</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-projected-future-ice-free-conditions-to-inform-product-creation">üåç Use case: Scientific assessment of projected future ice-free conditions to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-compute-time-series-of-extent-and-area">1.4 Define functions to compute time series of extent and area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-post-process-and-plot-time-series">1.5 Functions to post-process and plot time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-monthly-climatologies">1.6 Functions to create the monthly climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatology-maps">1.7 Functions to plot climatology maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-the-access-to-a-given-area">1.8 Functions to plot the access to a given area</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-downloading-parameters">2.1 Set some downloading parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-satellite-data-for-time-series">2.2 Download and transform satellite data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cmip6-data-for-time-series">2.3 Download and transform CMIP6 data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-climatologies-for-cmip6-projections">2.4 Download and process climatologies for CMIP6 projections</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-sea-ice-minima-and-the-projected-probabilities-of-an-ice-free-arctic">3.1 Arctic sea ice minima and the projected probabilities of an ice-free Arctic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-sea-ice-maxima">3.2 Arctic sea ice maxima</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-sea-ice-minima-and-the-projected-probabilities-of-being-ice-free-around-antarctica">3.3 Antarctic sea ice minima and the projected probabilities of being ice-free around Antarctica</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-sea-ice-maxima">3.4 Antarctic sea ice maxima</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#projected-access-to-arctic-shipping-routes">3.5 Projected access to Arctic shipping routes</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#northern-sea-route">3.5.1 Northern sea route</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#transpolar-shipping-route">3.5.2 Transpolar shipping route</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>