
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. ERA5-Land temperature trend for climate change analysis in Spain &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_climate-monitoring_q01';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. ERA5-Land temperature trend for climate change analysis in Spain</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-era5-land-monthly-means_climate-monitoring_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_climate-monitoring_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ERA5-Land temperature trend for climate change analysis in Spain</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitor-climate-change-over-spain-with-land-reanalysis-data">üåç Use case: Monitor climate change over Spain with land reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-request-and-download">1. Set request and download</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-data-request">Set data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-and-convert-to-celsius">Download data and convert to Celsius</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-select-and-cut-spain-map">Function to select and cut Spain map</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-and-significance-with-mann-kendall-test">2. Trend and significance with Mann Kendall Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monthly-and-seasonal-error-metrics">3. Monthly and seasonal error metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-mean-bias">4. Spatial mean bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="era5-land-temperature-trend-for-climate-change-analysis-in-spain">
<h1><span class="section-number">3.1. </span>ERA5-Land temperature trend for climate change analysis in Spain<a class="headerlink" href="#era5-land-temperature-trend-for-climate-change-analysis-in-spain" title="Link to this heading">#</a></h1>
<p>Production date: 04-10-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB) &amp; Cristina Deidda (VUB)</p>
<section id="use-case-monitor-climate-change-over-spain-with-land-reanalysis-data">
<h2>üåç Use case: Monitor climate change over Spain with land reanalysis data<a class="headerlink" href="#use-case-monitor-climate-change-over-spain-with-land-reanalysis-data" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Are the monthly averaged temperature data from ERA5-Land suitable for recovering the trend of annual mean temperature increase in Spain in order to monitor climate change?</strong></p></li>
</ul>
<p>ERA5-Land contains global reanalysis data with different levels of aggregation: hourly and monthly average. One of the most analyzed variable provided is the ‚Äú2m temperature‚Äù. Temperature data are important to assess climatology and trends for climate change analysis. In this assessment, we evaluate the feasibility of using ERA5-Land monthly averaged data to compute the annual mean temperature trend at the country level, focusing on Spain. To validate the analysis, results are compared with those from Arellano et al. (2025) <a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a> and the CRU TS (Climatic Research Unit gridded Time Series) dataset <a class="reference external" href="https://doi.org/10.1038/s41597-020-0453-3" rel="noreferrer" target="_blank">[2]</a> accessed via the Climate Change Knowledge Portal <a class="reference external" href="https://climateknowledgeportal.worldbank.org/country/spain/climate-data-historical" rel="noreferrer" target="_blank">[3]</a>.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Both ERA5-Land and CRU show a significant warming trend over Spain (1971-2022), consistent with previously published results based on E-OBS data <a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a>, indicating a regional temperature increase of approximately 0.04 ¬∞C per year.</p></li>
<li><p>ERA5-Land exhibits a systematic cold bias relative to CRU, averaging -0.49 ¬∞C, with larger deviations during colder months.</p></li>
<li><p>Despite the bias, correlation between ERA5-Land and CRU is nearly perfect, and error metrics such as MAE and RMSE (~0.6-0.7 ¬∞C) remain low and stable across seasons, suggesting strong temporal agreement between datasets.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>First, the 2 m air temperature variable from ERA5-Land was downloaded for the Spanish domain, converted from Kelvin to Celsius, and clipped using a national boundary shapefile. Annual mean temperatures were calculated for the period 1971‚Äì2022, and long-term trends were analyzed using the non-parametric Mann‚ÄìKendall test to assess statistical significance. The same procedure was applied to CRU annual temperature data to enable a consistent comparison. The trend obtained were also compared agains the results form Arellano et al. (2025) <a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a>. To evaluate the agreement between datasets at higher temporal resolution, monthly means were used to compute the Mean Bias Error (MBE), Mean Absolute Error (MAE), Root Mean Square Error (RMSE), and Pearson correlation coefficient, both annually and seasonally. Finally, a spatial bias analysis was performed for the 1991‚Äì2020 climatological period by resampling ERA5-Land to match the 0.5¬∞ grid of CRU and mapping the mean difference between the two datasets. This approach allowed both temporal and spatial evaluation of temperature consistency and bias between reanalysis and observationally based products.</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-1"><span class="std std-ref">1. Set request and download</span></a></strong></p>
<ul class="simple">
<li><p>Download the 2 m air temperature variable (K) from ERA5-Land, selecting the spatial extent covering Spain.</p></li>
<li><p>Convert temperature values from Kelvin to Celsius.</p></li>
<li><p>Define a function to clip the ERA5-Land data using a shapefile of Spain.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-2"><span class="std std-ref">2. Trend and significance with Mann Kendall Test</span></a></strong></p>
<ul class="simple">
<li><p>Compute spatial and annual mean temperatures from the ERA5-Land dataset.</p></li>
<li><p>Select the 1971‚Äì2022 period to compare with temperature trends reported in the literature.</p></li>
<li><p>Analyze temperature trends and their significance using the Mann‚ÄìKendall test.</p></li>
<li><p>Download the annual mean time series from the CRU dataset for the same period.</p></li>
<li><p>Perform the Mann‚ÄìKendall trend analysis on CRU data to assess consistency between the two datasets.</p></li>
<li><p>Plot and compare the annual mean temperature time series from ERA5-Land and CRU.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-3"><span class="std std-ref">3. Monthly and seasonal error metrics</span></a></strong></p>
<ul class="simple">
<li><p>Download the monthly mean temperature time series for Spain from CRU.</p></li>
<li><p>Calculate the monthly mean for ERA5-Land (1950-2024).</p></li>
<li><p>Compute MBE, MAE, RMSE, and the Pearson correlation coefficient between ERA5-Land and CRU monthly data.</p></li>
<li><p>Group results by season (DJF, MAM, JJA, SON) and compute the same error metrics to assess seasonal performance.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-4"><span class="std std-ref">4. Spatial mean bias</span></a></strong></p>
<ul class="simple">
<li><p>Download the annual mean temperature raster for Spain (1991‚Äì2020) from CRU.</p></li>
<li><p>Extract the same 1991‚Äì2020 period from ERA5-Land and compute the mean temperature over time.</p></li>
<li><p>Resample ERA5-Land data to the 0.5¬∞ resolution of the CRU dataset.</p></li>
<li><p>Calculate the mean bias (ERA5-Land ‚àí CRU) for each grid cell.</p></li>
<li><p>Plot the spatial distribution of the mean bias across Spain.</p></li>
<li><p>Discuss spatial patterns and possible sources of bias.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="set-request-and-download">
<span id="reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-1"></span><h3>1. Set request and download<a class="headerlink" href="#set-request-and-download" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<p>Import c3s_eqc_automatic_quality_control library and packages to calculate the statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rioxarray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rasterio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rasterio.mask</span><span class="w"> </span><span class="kn">import</span> <span class="n">mask</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-data-request">
<h4>Set data request<a class="headerlink" href="#set-data-request" title="Link to this heading">#</a></h4>
<p>Select the request, specifying the type of variable (monthly averaged reanalysis), variable (2m temperature) and the latitude and longitude coordinates for Spain including islands outside mainland territory.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land-monthly-means&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2m_temperature&quot;</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1950&quot;</span><span class="p">,</span> <span class="s2">&quot;1951&quot;</span><span class="p">,</span> <span class="s2">&quot;1952&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1953&quot;</span><span class="p">,</span> <span class="s2">&quot;1954&quot;</span><span class="p">,</span> <span class="s2">&quot;1955&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1956&quot;</span><span class="p">,</span> <span class="s2">&quot;1957&quot;</span><span class="p">,</span> <span class="s2">&quot;1958&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1959&quot;</span><span class="p">,</span> <span class="s2">&quot;1960&quot;</span><span class="p">,</span> <span class="s2">&quot;1961&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1962&quot;</span><span class="p">,</span> <span class="s2">&quot;1963&quot;</span><span class="p">,</span> <span class="s2">&quot;1964&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1965&quot;</span><span class="p">,</span> <span class="s2">&quot;1966&quot;</span><span class="p">,</span> <span class="s2">&quot;1967&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1968&quot;</span><span class="p">,</span> <span class="s2">&quot;1969&quot;</span><span class="p">,</span> <span class="s2">&quot;1970&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1971&quot;</span><span class="p">,</span> <span class="s2">&quot;1972&quot;</span><span class="p">,</span> <span class="s2">&quot;1973&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1974&quot;</span><span class="p">,</span> <span class="s2">&quot;1975&quot;</span><span class="p">,</span> <span class="s2">&quot;1976&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1977&quot;</span><span class="p">,</span> <span class="s2">&quot;1978&quot;</span><span class="p">,</span> <span class="s2">&quot;1979&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1980&quot;</span><span class="p">,</span> <span class="s2">&quot;1981&quot;</span><span class="p">,</span> <span class="s2">&quot;1982&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1983&quot;</span><span class="p">,</span> <span class="s2">&quot;1984&quot;</span><span class="p">,</span> <span class="s2">&quot;1985&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1986&quot;</span><span class="p">,</span> <span class="s2">&quot;1987&quot;</span><span class="p">,</span> <span class="s2">&quot;1988&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1989&quot;</span><span class="p">,</span> <span class="s2">&quot;1990&quot;</span><span class="p">,</span> <span class="s2">&quot;1991&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1992&quot;</span><span class="p">,</span> <span class="s2">&quot;1993&quot;</span><span class="p">,</span> <span class="s2">&quot;1994&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1995&quot;</span><span class="p">,</span> <span class="s2">&quot;1996&quot;</span><span class="p">,</span> <span class="s2">&quot;1997&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1998&quot;</span><span class="p">,</span> <span class="s2">&quot;1999&quot;</span><span class="p">,</span> <span class="s2">&quot;2000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2001&quot;</span><span class="p">,</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span> <span class="s2">&quot;2003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2004&quot;</span><span class="p">,</span> <span class="s2">&quot;2005&quot;</span><span class="p">,</span> <span class="s2">&quot;2006&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2007&quot;</span><span class="p">,</span> <span class="s2">&quot;2008&quot;</span><span class="p">,</span> <span class="s2">&quot;2009&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2010&quot;</span><span class="p">,</span> <span class="s2">&quot;2011&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2013&quot;</span><span class="p">,</span> <span class="s2">&quot;2014&quot;</span><span class="p">,</span> <span class="s2">&quot;2015&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2016&quot;</span><span class="p">,</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2019&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;2021&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2022&quot;</span><span class="p">,</span> <span class="s2">&quot;2023&quot;</span><span class="p">,</span> <span class="s2">&quot;2024&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data-and-convert-to-celsius">
<h4>Download data and convert to Celsius<a class="headerlink" href="#download-data-and-convert-to-celsius" title="Link to this heading">#</a></h4>
<p>Download considering 1 year chuncks.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">-=</span> <span class="mf">273.15</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;¬∞C&quot;</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 75/75 [00:03&lt;00:00, 23.17it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="function-to-select-and-cut-spain-map">
<h4>Function to select and cut Spain map<a class="headerlink" href="#function-to-select-and-cut-spain-map" title="Link to this heading">#</a></h4>
<p>Function to read Spain shapefile and cut the map.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">clip_gadm_remote</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clip an xarray DataArray or Dataset using a GADM shapefile from a remote ZIP.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        data: xarray.DataArray or Dataset</span>
<span class="sd">        url: str, URL to the zipped GADM shapefile</span>
<span class="sd">        layer_name: str, e.g. &quot;gadm41_ESP_0&quot;, &quot;gadm41_ESP_1&quot;, etc.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Clipped xarray object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
        <span class="c1"># Download the zip</span>
        <span class="n">zip_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="s2">&quot;gadm.zip&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">zip_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

        <span class="c1"># Unzip</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
            <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span>

        <span class="c1"># Build path to the chosen layer (each is a separate .shp file)</span>
        <span class="n">shp_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">.shp&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">shp_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find </span><span class="si">{</span><span class="n">layer_name</span><span class="si">}</span><span class="s2">.shp in the extracted archive&quot;</span><span class="p">)</span>

        <span class="c1"># Load shapefile</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp_path</span><span class="p">)</span>

        <span class="c1"># Ensure CRS matches</span>
        <span class="n">shapefile_crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">shapefile_crs</span><span class="p">)</span>

        <span class="c1"># Prepare xarray for clipping</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">set_spatial_dims</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">y_dim</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="n">shapefile_crs</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Clip</span>
        <span class="n">data_clip</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
            <span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">mapping</span><span class="p">),</span> <span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">data_clip</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://geodata.ucdavis.edu/gadm/gadm4.1/shp/gadm41_ESP_shp.zip&quot;</span>
<span class="n">layer</span> <span class="o">=</span> <span class="s2">&quot;gadm41_ESP_0&quot;</span>  <span class="c1"># national boundaries for Spain</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">clip_gadm_remote</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="trend-and-significance-with-mann-kendall-test">
<span id="reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-2"></span><h3>2. Trend and significance with Mann Kendall Test<a class="headerlink" href="#trend-and-significance-with-mann-kendall-test" title="Link to this heading">#</a></h3>
<p>Calculate trend and significance with Mann Kendall Test and check for significance using ERA5-Land data. The period 1971-2022 was selected to compare with the results from Arellano et al. (2025), who quantified the warming trend in Spain during this period using the ordinary least squares (OLS) regression method <a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_spatial_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
<span class="n">da_annual_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">annual_weighted_mean</span><span class="p">(</span><span class="n">da_spatial_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_sel_71</span> <span class="o">=</span> <span class="n">da_annual_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1971&quot;</span><span class="p">,</span> <span class="s2">&quot;2022&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Mann-Kendall test</span>
<span class="n">trend</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">var_s</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">original_test</span><span class="p">(</span><span class="n">da_sel_71</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da_sel_71</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">da_sel_71</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Trend line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da_sel_71</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">da_sel_71</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trend Line&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># Legend and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Annual Mean 2-meter Temperature in Spain (ERA5-Land) for the period 1971-2022&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (¬∞C)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print results</span>
<span class="n">is_significant</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The trend is</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_significant</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39; NOT&#39;</span><span class="si">}</span><span class="s2"> significant.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend: </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ¬∞C/year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/a93b6d6bbe05328f0be9da37a98b48d6683478cff28cd0b7df8719ab7830daf0.png" src="../_images/a93b6d6bbe05328f0be9da37a98b48d6683478cff28cd0b7df8719ab7830daf0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The trend is significant.
Trend: 0.0437 ¬∞C/year
</pre></div>
</div>
</div>
</div>
<p><em>Figure 1. ERA5-Land annual 2-meter temperature trend in Spain for the period 1971-2022 using Mann Kendall test.</em></p>
<p>CRU TS (Climatic Research Unit gridded Time Series) is a global climate dataset (except Antartica) with 0.5¬∞ spatial resolution. It is produced by interpolating monthly climate anomalies from a large network of weather station observations <a class="reference external" href="https://doi.org/10.1038/s41597-020-0453-3" rel="noreferrer" target="_blank">[2]</a>. The Climate Knowledge Portal <a class="reference external" href="https://climateknowledgeportal.worldbank.org/country/spain/climate-data-historical" rel="noreferrer" target="_blank">[3]</a> provides access to downloadable datasets from different models including the CRU dataset. This data is visualized on the portal‚Äôs main page, where users can examine climate statistics for various countries. Here, we analyze the annual average surface air temperatures from the CRU model for Spain.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import CRU yearly data</span>
<span class="n">yearly_url</span> <span class="o">=</span> <span class="s2">&quot;https://cckpapi.worldbank.org/cckp/v1/cru-x0.5_timeseries_tas_timeseries_annual_1901-2024_mean_historical_cru_ts4.09_mean/ESP?_format=json&quot;</span>
<span class="n">yearly_resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">yearly_url</span><span class="p">)</span>
<span class="n">yearly_data</span> <span class="o">=</span> <span class="n">yearly_resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="c1"># Extract the ESP dict</span>
<span class="n">yearly_esp_data</span> <span class="o">=</span> <span class="n">yearly_data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;ESP&quot;</span><span class="p">]</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">yearly_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">yearly_esp_data</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;tas_mean&quot;</span><span class="p">])</span>

<span class="c1"># Convert year strings (&quot;1901-07&quot;) into datetime or just year</span>
<span class="n">yearly_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">yearly_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>
<span class="n">yearly_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_yearly_cru</span> <span class="o">=</span> <span class="n">yearly_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;1971-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2022-12-01&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract years and values</span>
<span class="n">years_cru</span> <span class="o">=</span> <span class="n">df_yearly_cru</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span>
<span class="n">temps_cru</span> <span class="o">=</span> <span class="n">df_yearly_cru</span><span class="p">[</span><span class="s2">&quot;tas_mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Run Mann-Kendall test</span>
<span class="n">trend</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">var_s</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">original_test</span><span class="p">(</span><span class="n">temps_cru</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_cru</span><span class="p">,</span> <span class="n">temps_cru</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CRU&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Trend line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_cru</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years_cru</span><span class="p">))</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> 
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trend Line&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># Legend and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Annual Mean Surface Air Temperature in Spain (CRU) for the period 1971-2022&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (¬∞C)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print results</span>
<span class="n">is_significant</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The trend is</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_significant</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39; NOT&#39;</span><span class="si">}</span><span class="s2"> significant.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend: </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ¬∞C/year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/752b6065ed4c4b57d96709342d3a7d53633691635e8d5466870166bd6ac3931e.png" src="../_images/752b6065ed4c4b57d96709342d3a7d53633691635e8d5466870166bd6ac3931e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The trend is significant.
Trend: 0.0350 ¬∞C/year
</pre></div>
</div>
</div>
</div>
<p><em>Figure 2. CRU annual surface air temperature trend in Spain for the period 1971-2022 using Mann Kendall test.</em></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract ERA5-Land data</span>
<span class="n">years_era5</span> <span class="o">=</span> <span class="n">da_sel_71</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">temps_era5</span> <span class="o">=</span> <span class="n">da_sel_71</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_cru</span><span class="p">,</span> <span class="n">temps_cru</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CRU&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
         <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_era5</span><span class="p">,</span> <span class="n">temps_era5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
         <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Labels, legend, title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (¬∞C)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Annual Mean Near-Surface Temperature in Spain&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/391dcef8a2c454cbb8fdac2f7b16f409f623af01d1b6cd8f5893926ce2b240c4.png" src="../_images/391dcef8a2c454cbb8fdac2f7b16f409f623af01d1b6cd8f5893926ce2b240c4.png" />
</div>
</div>
<p><em>Figure 3. ERA5-Land and CRU near surface temperature annual average data.</em></p>
<p>A significant warming trend is evident in both ERA5-Land and CRU usign Mann-Kendall. ERA5-Land shows an increase of 0.0437 ¬∞C/year, while CRU indicates a slightly lower trend of 0.0350 ¬∞C/year. For comparison, Arellano et al. (2025) reported an increasing trend of 0.0422 ¬∞C/year in mean temperature, using the E-OBS dataset and OLS models in their metholodogy. E-OBS is a high-resolution gridded dataset of daily temperature and precipitation for Europe, derived from station observations collected through the European Climate Assessment &amp; Dataset (ECA&amp;D) project <a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a>.</p>
<p>Additionally, the comparison of ERA5-Land and CRU in Figure 3 reveals a consistent cold bias in ERA5-Land data relative to the CRU data which is based on observed values. The bias between ERA5-Land and CRU is more pronounced during the earlier decades (1970s) and appears to decrease toward the present, likely reflecting improvements in ERA5 data assimilation and increased observational density over time, which indirectly benefits ERA5-Land.</p>
</section>
<section id="monthly-and-seasonal-error-metrics">
<span id="reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-3"></span><h3>3. Monthly and seasonal error metrics<a class="headerlink" href="#monthly-and-seasonal-error-metrics" title="Link to this heading">#</a></h3>
<p>To avoid smoothing out the largest errors, the evaluation metrics were calculated using monthly mean temperatures rather than annual averages. In addition, the metrics were computed separately for each season to assess potential seasonal differences in performance. The whole period covered by ERA5-Land was analyzed (1950-2024).</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import CRU montlhy data</span>
<span class="n">monthly_url</span> <span class="o">=</span> <span class="s2">&quot;https://cckpapi.worldbank.org/cckp/v1/cru-x0.5_timeseries_tas_timeseries_monthly_1901-2024_mean_historical_cru_ts4.09_mean/ESP?_format=json&quot;</span>
<span class="n">monthly_resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">monthly_url</span><span class="p">)</span>
<span class="n">monthly_data</span> <span class="o">=</span> <span class="n">monthly_resp</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="c1"># Extract the ESP dict</span>
<span class="n">monthly_esp_data</span> <span class="o">=</span> <span class="n">monthly_data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="s2">&quot;ESP&quot;</span><span class="p">]</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">monthly_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">monthly_esp_data</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;tas_mean&quot;</span><span class="p">])</span>

<span class="c1"># Convert year strings (&quot;1901-07&quot;) into datetime or just year</span>
<span class="n">monthly_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">monthly_df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>
<span class="n">monthly_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_monthly_cru</span> <span class="o">=</span> <span class="n">monthly_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;1950-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2024-12-01&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Restrict to the period until Dec 2024</span>
<span class="n">da_sel</span> <span class="o">=</span> <span class="n">da_spatial_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1950-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2024-12-01&quot;</span><span class="p">))</span>

<span class="c1"># 2. Resample to monthly means</span>
<span class="n">da_monthly</span> <span class="o">=</span> <span class="n">da_sel</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;1MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># 3. Convert to DataFrame</span>
<span class="n">df_monthly</span> <span class="o">=</span> <span class="n">da_monthly</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># 4. Keep only relevant columns</span>
<span class="n">df_monthly_era</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[[</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">,</span> <span class="s2">&quot;t2m&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_monthly_era</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;tas_mean&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_monthly_era</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_monthly_era</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;tas_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_monthly_era</span><span class="p">[</span><span class="s2">&quot;tas_mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_compare</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;CRU&quot;</span><span class="p">:</span> <span class="n">df_monthly_cru</span><span class="p">[</span><span class="s2">&quot;tas_mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s2">&quot;ERA5&quot;</span><span class="p">:</span> <span class="n">df_monthly_era</span><span class="p">[</span><span class="s2">&quot;tas_mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">df_monthly_cru</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;CRU&quot;</span><span class="p">]</span>

<span class="n">mean_bias</span> <span class="o">=</span> <span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>                 <span class="c1"># Mean Bias Error (MBE)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>                 <span class="c1"># Mean Absolute Error (MAE)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>        <span class="c1"># Root Mean Square Error (RMSE)</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;CRU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df_compare</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">])</span>      <span class="c1"># Pearson correlation</span>

<span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Mean Bias Error (¬∞C)&quot;</span><span class="p">:</span> <span class="n">mean_bias</span><span class="p">,</span>
    <span class="s2">&quot;Mean Absolute Error (¬∞C)&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
    <span class="s2">&quot;Root Mean Square Error (¬∞C)&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
    <span class="s2">&quot;Correlation (r)&quot;</span><span class="p">:</span> <span class="n">corr</span>
<span class="p">}</span>
<span class="c1"># Round and print nicely</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Monthly metrics:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Monthly metrics:
Mean Bias Error (¬∞C): -0.49
Mean Absolute Error (¬∞C): 0.60
Root Mean Square Error (¬∞C): 0.70
Correlation (r): 1.00
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to compute stats</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_stats</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">mean_bias</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;CRU&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">])</span> 
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
        <span class="s2">&quot;Mean Bias (¬∞C)&quot;</span><span class="p">:</span> <span class="n">mean_bias</span><span class="p">,</span>
        <span class="s2">&quot;MAE (¬∞C)&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
        <span class="s2">&quot;RMSE (¬∞C)&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s2">&quot;Correlation (r)&quot;</span><span class="p">:</span> <span class="n">corr</span>
    <span class="p">})</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resample by season and compute stats</span>
<span class="n">seasonal_stats</span> <span class="o">=</span> <span class="n">df_compare</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_compare</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;Q-DEC&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_stats</span><span class="p">)</span>

<span class="c1"># Map quarterly period to standard season names</span>
<span class="n">season_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;DJF Winter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;MAM Spring&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;JJA Summer&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;SON Autum&#39;</span><span class="p">}</span>
<span class="n">seasonal_stats</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">seasonal_stats</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">quarter</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">season_map</span><span class="p">)</span>

<span class="c1"># If you want a clean seasonal table (one row per season)</span>
<span class="n">seasonal_stats</span> <span class="o">=</span> <span class="n">seasonal_stats</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">seasonal_stats</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Round all numeric columns to 2 decimals</span>
<span class="n">seasonal_stats</span> <span class="o">=</span> <span class="n">seasonal_stats</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">seasonal_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            Mean Bias (¬∞C)  MAE (¬∞C)  RMSE (¬∞C)  Correlation (r)
date                                                            
DJF Winter           -0.79      0.81       0.85             0.98
JJA Summer           -0.22      0.44       0.50             0.96
MAM Spring           -0.33      0.50       0.56             1.00
SON Autum            -0.60      0.64       0.68             1.00
</pre></div>
</div>
</div>
</div>
<p>ERA5-Land shows a negative bias of ‚Äì0.49 ¬∞C relative to CRU, which is based on observations. This bias is more pronounced during colder months than in warmer months. The mean absolute error (MAE), which represents the average magnitude of the differences regardless of sign, is 0.6 ¬∞C. Consistent with the bias, the MAE is larger in cold months and smaller in warm months. The root mean square error (RMSE) is very close to the MAE at 0.7 ¬∞C, and the seasonal RMSE values are also similar to their corresponding MAEs. This indicates that the errors are relatively uniform and not dominated by large outliers. A perfect Pearson correlaiton (almost perfect in the case of Winter and Summer months) is observed.</p>
</section>
<section id="spatial-mean-bias">
<span id="reanalysis-reanalysis-era5-land-monthly-means-climate-monitoring-q01-section-4"></span><h3>4. Spatial mean bias<a class="headerlink" href="#spatial-mean-bias" title="Link to this heading">#</a></h3>
<p>To examine the spatial distribution of the mean bias over Spain, the CRU surface air temperature climatology raster for 1991‚Äì2020 was downloaded and clipped to the extent of Spain.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Link to raster data in the Climate Change Knowledge Portal</span>
<span class="n">url_cru</span> <span class="o">=</span> <span class="s2">&quot;https://wbg-cckp.s3-us-west-2.amazonaws.com/data/cru-x0.5/tas/cru-ts4.09-historical/climatology-tas-annual-mean_cru-x0.5_cru-ts4.09-historical_climatology_mean_1991-2020.nc&quot;</span>
<span class="n">filename_cru</span> <span class="o">=</span> <span class="s2">&quot;climatology.nc&quot;</span>

<span class="c1"># Download the file</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url_cru</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_cru</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

<span class="c1"># Open with xarray</span>
<span class="n">ds_cru</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filename_cru</span><span class="p">)</span>
<span class="n">da_cru</span> <span class="o">=</span> <span class="n">ds_cru</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
<span class="n">ds_cru_tas</span> <span class="o">=</span> <span class="n">ds_cru</span><span class="p">[</span><span class="s2">&quot;climatology-tas-annual-mean&quot;</span><span class="p">]</span>
<span class="n">ds_cru_tas</span> <span class="o">=</span> <span class="n">ds_cru_tas</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
<span class="n">ds_cru_tas_spa</span> <span class="o">=</span> <span class="n">clip_gadm_remote</span><span class="p">(</span><span class="n">ds_cru_tas</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>

<span class="c1"># Subset for Spain</span>
<span class="n">ds_cru_tas_spa</span> <span class="o">=</span> <span class="n">ds_cru_tas_spa</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="mi">44</span><span class="p">),</span>   <span class="c1"># slice(max_lat, min_lat)</span>
    <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>   <span class="c1"># slice(min_lon, max_lon)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>ERA5-Land data (originally 0.1¬∞) for the period 1991‚Äì2020 were selected and resampled to a coarser resolution (0.5¬∞) to match the spatial resolution of the CRU dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_sel</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1991-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12-31&quot;</span><span class="p">))</span>
<span class="n">da_mean</span> <span class="o">=</span> <span class="n">da_sel</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_mean_coarse</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="n">ds_cru_tas_spa</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="n">ds_cru_tas_spa</span><span class="o">.</span><span class="n">longitude</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The mean bias of the average temperature for each pixel was calculated (ERA5-Land - CRU).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_bias</span> <span class="o">=</span> <span class="n">da_mean_coarse</span> <span class="o">-</span> <span class="n">ds_cru_tas_spa</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bias_map</span> <span class="o">=</span> <span class="n">mean_bias</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1"># Define discrete levels</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="c1"># Create discrete colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Normalization</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">bias_map</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Gridlines</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Coastlines</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                    <span class="n">boundaries</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Mean Bias (ERA5 ‚àí CRU) [¬∞C]&quot;</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Bias of Average Near-Surface Temperature (ERA5 ‚àí CRU)</span><span class="se">\n</span><span class="s2">Spain, 1991‚Äì2020&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/6e7bdd7148c2a34da54bcafa9358f17a877edc8e188f270669b949119ed73350.png" src="../_images/6e7bdd7148c2a34da54bcafa9358f17a877edc8e188f270669b949119ed73350.png" />
</div>
</div>
<p><em>Figure 4. Spatial distribution of the mean bias of the near surface temperature climatology for the period 1991‚Äì2020 over Spain, substracting ERA5-Land - CRU.</em></p>
<p><img alt="ES_CS_CLC_types.jpg" src="../_images/7e6dd410-9197-4f45-ba8c-d5e338cfb464.jpg" /></p>
<p>Figure 5. Corine Land cover 2006 data for Spain. Source: European Environment Agency (2011) <a class="reference external" href="https://www.eea.europa.eu/data-and-maps/figures/land-cover-2006-and-changes/spain" rel="noreferrer" target="_blank">[6]</a></p>
<p>The 2‚ÄØm temperature parameter in ERA5 is produced by coupling the atmospheric model of the ECMWF Integrated Forecast System (IFS) with the land-surface model (HTESSEL). The IFS assimilates observations, blending the model forecast with available data to produce the best estimate of the atmospheric state <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation" rel="noreferrer" target="_blank">[4]</a>. In ERA5-Land, no assimilation is performed; instead, HTESSEL is run at higher resolution and forced by the meteorological fields from ERA5 to produce 2‚ÄØm temperature and other land variables <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation" rel="noreferrer" target="_blank">[5]</a>.</p>
<p>On the other hand, CRU is based on observed anomalies, calculated relative to a 1961‚Äì1990 baseline. These anomalies are then interpolated using the angular-distance weighting (ADW) method to produce variables such a mean temperature on a regular 0.5¬∞ √ó 0.5¬∞ grid <a class="reference external" href="https://doi.org/10.1038/s41597-020-0453-3" rel="noreferrer" target="_blank">[2]</a>. However, CRU also has limitations: its resolution is lower than that of ERA5-Land, and the interpolation process introduces uncertainties. Despite these drawbacks, we considered the comparison between the two products valuable, since CRU is more directly anchored to in-situ observations, whereas ERA5-Land derives 2 m temperature indirectly from model physics driven by assimilated atmospheric data.</p>
<p>Johannsen et al. (2019) <a class="reference external" href="https://doi.org/10.3390/rs11212570" rel="noreferrer" target="_blank">[7]</a> identified a systematic cold bias in ERA5 summertime daily maximum Land Surface Temperature (LST) over the Iberian Peninsula, which they attributed largely to the representation of vegetation cover in the HTESSEL land-surface model. Their analysis, based on comparisons with satellite-derived LST, showed that the bias was more pronounced in areas with dense vegetation, where model parameterizations of evapotranspiration and canopy processes tend to enhance surface cooling. It is important to note that LST, also known as skin temperature, differs from 2‚ÄØm air temperature, and in this assessment we used ERA5-Land rather than ERA5. Nonetheless, examining the land cover map indicates that the bias in 2‚ÄØm temperature also appears larger over forested areas than over arable land or permanent crops, particularly in northern Spain, suggesting that vegetation may be a contributing factor. However, other factors likely play a role as well: Johannsen et al. focused on summer because the LST bias was largest in that season, whereas in our analysis the cold bias is more pronounced in colder seasons, potentially linked to other processes and parameters.</p>
<p>Similar findings, regarding the cold bias, have been reported in the literature. For example, Yilmaz (2023) <a class="reference external" href="https://doi.org/10.1016/j.scitotenv.2022.159182" rel="noreferrer" target="_blank">[8]</a> analyzed temperature trends in Turkey and found a high degree of consistency between the trends in ERA5/ERA5-Land and in-situ observations, suggesting that ERA5-Land may serve as a substitute for direct observations. Like our findings, Yilmaz observed a cold bias in ERA5-Land data compared to observations. Zhao and He (2022) <a class="reference external" href="https://doi.org/10.3389/feart.2022.907730" rel="noreferrer" target="_blank">[9]</a> found similar results in their study of the Qilian Mountains in China, where surface 2 m air temperature data from 17 meteorological stations (1979‚Äì2017) were compared to the ERA5-Land product. They reported a significant warming trend of 0.488¬∞C/decade in the observed data, and ERA5-Land reanalysis captured the trend well at 0.379¬∞C/decade. Again, a bias between ERA5-Land temperature and observations was noted. They concluded that ERA5-Land reliably reproduces temperature trends and is suitable for scientific research in the region.</p>
<p>Based on our results and supporting literature, ERA5-Land is a reliable dataset for assessing climate change trends, as the estimated trends closely match those from CRU (1950‚Äì2024). However, absolute temperature values are subject to a known cold bias, which should be considered when interpreting results.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>J. Mu√±oz-Sabater, Dutra, E., Agust√≠-Panareda, A., Albergel, C., Arduini, G., Balsamo, G., Boussetta, S., Choulga, M., Harrigan, S., Hersbach, H., Martens, B., Miralles, D. G., Piles, M., Rodr√≠guez-Fern√°ndez, N. J., Zsoter, E., Buontempo, C., &amp; Th√©paut, J.-N. (2021) ERA5-Land: A state-of-the-art global reanalysis dataset for land applications, Earth Syst. Sci. Data,13, 4349‚Äì4383. <a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank"></a>.</p></li>
<li><p>Copernicus (2025) Copernicus: Third-warmest July marks slight respite from record global temperatures <a class="reference external" href="https://climate.copernicus.eu/copernicus-third-warmest-july-marks-slight-respite-record-global-temperatures" rel="noreferrer" target="_blank"></a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.3390/land14010085" rel="noreferrer" target="_blank">[1]</a> Arellano, B., Zheng, Q. &amp; Roca, J. (2025). Analysis of climate change effects on precipitation and temperature trends in Spain. Land, 14(1), 85.</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41597-020-0453-3" rel="noreferrer" target="_blank">[2]</a> Harris, I., Osborn, T.J., Jones, P. &amp; Lister, D. (2020) Version 4 of the CRU TS monthly high-resolution gridded multivariate climate dataset. Sci Data 7, 109.</p>
<p><a class="reference external" href="https://climateknowledgeportal.worldbank.org/country/spain/climate-data-historical" rel="noreferrer" target="_blank">[3]</a> Climate Knowledge Portal (2020) Observed Climatology of Average Mean Surface Air Temperature (accessed on 01/10/2025).</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation" rel="noreferrer" target="_blank">[4]</a> ECMWF (2025) ERA5: data documentation.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation" rel="noreferrer" target="_blank">[5]</a> ECMWF (2025) ERA5-Land: data documentation.</p>
<p><a class="reference external" href="https://www.eea.europa.eu/data-and-maps/figures/land-cover-2006-and-changes/spain" rel="noreferrer" target="_blank">[6]</a> European Environment Agency (2011) Land cover 2006 and changes country analysis, Spain.</p>
<p><a class="reference external" href="https://doi.org/10.3390/rs11212570" rel="noreferrer" target="_blank">[7]</a> Johannsen, F., Ermida, S., Martins, J. P. A., Trigo, I. F., Nogueira, M. &amp; Dutra, E. (2019). Cold bias of ERA5 summertime daily maximum land surface temperature over the Iberian Peninsula. Remote Sensing, 11(21), 2570.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.scitotenv.2022.159182" rel="noreferrer" target="_blank">[8]</a> Yilmaz, M. (2023). Accuracy assessment of temperature trends from ERA5 and ERA5-Land. Science of the Total Environment, 856(Pt 2), 159182.</p>
<p><a class="reference external" href="https://doi.org/10.3389/feart.2022.907730" rel="noreferrer" target="_blank">[9]</a> Zhao, Peng &amp; He, Zhibin. (2022). A First Evaluation of ERA5-Land Reanalysis Temperature Product Over the Chinese Qilian Mountains. Frontiers in Earth Science. 10. 907730. 10.3389/feart.2022.907730.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitor-climate-change-over-spain-with-land-reanalysis-data">üåç Use case: Monitor climate change over Spain with land reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-request-and-download">1. Set request and download</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-data-request">Set data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data-and-convert-to-celsius">Download data and convert to Celsius</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-select-and-cut-spain-map">Function to select and cut Spain map</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-and-significance-with-mann-kendall-test">2. Trend and significance with Mann Kendall Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monthly-and-seasonal-error-metrics">3. Monthly and seasonal error metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-mean-bias">4. Spatial mean bias</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>