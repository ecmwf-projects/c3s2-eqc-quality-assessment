
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.3.1. Comparing sea ice concentration products to ice charts &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Cryosphere/satellite_satellite-sea-ice-concentration_intercomparison_q03';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4. Land Biosphere" href="../Land_Biosphere/Land_Biosphere.html" />
    <link rel="prev" title="1.3. Cryosphere" href="Cryosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Cryosphere.html">1.3. Cryosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.3.1. Comparing sea ice concentration products to ice charts</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Cryosphere/satellite_satellite-sea-ice-concentration_intercomparison_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Cryosphere/satellite_satellite-sea-ice-concentration_intercomparison_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Comparing sea ice concentration products to ice charts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-uncertainty-of-sea-ice-concentration-products">🌍 Use case: Assessing the uncertainty of sea ice concentration products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-nic-shapefiles">1. Download NIC shapefiles</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic">1.1 Arctic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic">1.2 Antarctic</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">2. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">2.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">2.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request">2.3 Define request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-used-in-caching-of-both-time-series-and-map-data">2.4 Functions used in caching of both time series and map data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache-time-series">2.5 Functions to cache time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache-map-data">2.6 Define functions to cache map data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-post-processing-and-plotting-time-series">2.7 Functions for post-processing and plotting time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-plotting-maps">2.8 Functions for plotting maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">3. Download and transform the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#production-of-data-for-time-series">3.1 Production of data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#production-of-data-for-maps">3.2 Production of data for maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#northern-hemisphere">4.1 Northern hemisphere</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#southern-hemisphere">4.2 Southern hemisphere</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="comparing-sea-ice-concentration-products-to-ice-charts">
<h1><span class="section-number">1.3.1. </span>Comparing sea ice concentration products to ice charts<a class="headerlink" href="#comparing-sea-ice-concentration-products-to-ice-charts" title="Link to this heading">#</a></h1>
<p>Production date: 14-04-2025</p>
<p>Produced by: Timothy Williams, Nansen Environment and Remote Sensing Center</p>
<section id="use-case-assessing-the-uncertainty-of-sea-ice-concentration-products">
<h2>🌍 Use case: Assessing the uncertainty of sea ice concentration products<a class="headerlink" href="#use-case-assessing-the-uncertainty-of-sea-ice-concentration-products" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>How does the interim sea ice concentration product compare to manual ice charts?</strong>
To assess the uncertainty in the sea ice concontration products, we compare the sea ice concentration derived from passive microwave SSMIS (Special Sensor Microwave Imager/Sounder) sensors, to manual ice charts from the United States National Ice Center (NIC). These ice charts only date back to 2016, which is why we only compare them to the SSMIS products, and not the AMSR (Advanced Microwave Scanning Radiometer) product.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<p>Sea ice concentration produced by the EUMETSAT (European Organisation for the Exploitation of Meteorological Satellites) OSI SAF (Ocean and Sea Ice Satellite Application Facility), and derived from SSMIS passive microwave sensors was compared to daily ice charts for both the Arctic and Antarctic. The ice charts are the daily marginal ice zone (MIZ) charts produced by the United States National Ice Center (NIC). The differences were the largest in summer when the concentration from passive microwave sensors has the largest errors due to melt ponds for example. The maximum integrated ice edge error reached <span class="math notranslate nohighlight">\(2\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in the Arctic and <span class="math notranslate nohighlight">\(4\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in the Antarctic. The ice charts are created manually, so we might expect them to be more reliable, but they might also be more conservative (err on the side of too much ice as opposed to too little) due to their use by the shipping industry. Indeed the extent calculated from the ice charts was generally larger than the one from the SSMIS-derived concentration, which would be consistent with the latter possibility. Hence further checking of which is indeed the most reliable should be done.</p>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>From the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-ice-concentration?tab=overview"><span style="color:blue">sea ice concentration dataset</span></a> in the Climate Data Store (CDS), we use the SSMIS CDR (Climate Data Record) product, which covers the years 2016 to 2020, and the SSMIS ICDR (Interim CDR) product, which covers the years 2021 to 2024.</p>
<p>NIC ice charts can be downloaded as shapefiles from <a class="reference external" href="https://usicecenter.gov/"><span style="color:blue">https://usicecenter.gov/</span></a> and then rasterized onto the EUMETSAT OSI SAF Arctic or Antarctic grids and saved as daily netCDF files with paths depending on the date according to <code class="docutils literal notranslate"><span class="pre">nh/%Y/nic_miz_%Y%m%d_nc_pl_a.nc</span></code> for the northern hemisphere, and <code class="docutils literal notranslate"><span class="pre">sh/%Y/nic_miz_%Y%m%d_sc_pl_a.nc</span></code> for the southern hemisphere. These paths are relative to a user-defined directory <code class="docutils literal notranslate"><span class="pre">NIC_ICE_CHARTS_PATH</span></code> set below in the <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">parameters</span></code> section. The netCDF files can be obtained from the author at the email <a class="reference external" href="mailto:timothy&#46;williams&#37;&#52;&#48;nersc&#46;no"><span style="color:blue">timothy<span>&#46;</span>williams<span>&#64;</span>nersc<span>&#46;</span>no</span></a>, otherwise users can do their own rasterizing. There is bash code in the “Code” section which shows how to download shapefiles for a given date.</p>
<p>Having obtained the two datasets on the same grid, we can compare them pixel by pixel. The NIC ice charts have 3 categories depending on estimated sea ice concentration (SIC):</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(0\% \leq {\rm SIC} \leq 10\%\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(10\% &lt; {\rm SIC} \leq 80\%\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(80\% &lt;{\rm SIC} \leq 100\%\)</span></p></li>
</ol>
<p>We reduced the number of categories from 3 to 2 (open water or ice-covered) by merging categories 2 and 3. The CDS SIC product was also converted to open water or ice-covered categories by using a threshold of SIC &gt; 10%.</p>
<p>We then computed two areas <span class="math notranslate nohighlight">\(A_\pm\)</span>, where <span class="math notranslate nohighlight">\(A_+\)</span> is the total area where the CDS has ice and NIC has no ice, and <span class="math notranslate nohighlight">\(A_-\)</span> is the total area where the CDS has no ice and NIC has ice. A “bias” is then defined as <span class="math notranslate nohighlight">\(A_+ - A_-\)</span> and an IIEE (integrated ice edge error, or the total area where the classification from the SIC product disagrees with the ice chart classification (<a class="reference external" href="https://doi.org/10.1002/2015GL067232"><span style="color:blue">Goessling et al., 2016</span></a>), is defined as <span class="math notranslate nohighlight">\(A_+ + A_-\)</span>.
Time series of these metrics were then plotted.</p>
<p>To give an idea of the spatial distribution of the differences, for each pixel and month a probability of being ice-covered was calculated for the CDS and the NIC charts. The difference between these monthly probabilities was then calculated and plotted as maps.</p>
<p>The “Analysis and results” section is structured as follows:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-concentration-intercomparison-q03-section-1"><span class="std std-ref">1. Download NIC shapefiles</span></a></strong></p>
<ul class="simple">
<li><p>Instructions on how to download the NIC ice charts (as shapefiles which need to be converted to netcdf).</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-concentration-intercomparison-q03-section-2"><span class="std std-ref">2. Parameters, requests and functions definition</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-concentration-intercomparison-q03-section-3"><span class="std std-ref">3. Download and transform the data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-ice-concentration-intercomparison-q03-section-4"><span class="std std-ref">4. Results</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="download-nic-shapefiles">
<span id="satellite-satellite-sea-ice-concentration-intercomparison-q03-section-1"></span><h3>1. Download NIC shapefiles<a class="headerlink" href="#download-nic-shapefiles" title="Link to this heading">#</a></h3>
<section id="arctic">
<h4>1.1 Arctic<a class="headerlink" href="#arctic" title="Link to this heading">#</a></h4>
<p>Arctic MIZ shapefiles were downloaded from <a class="reference external" href="https://usicecenter.gov/Products/ArchiveSearch?table=DailyArctic&amp;amp;product=Arctic%20MIZ%20Chart&amp;amp;linkChange=arc-one">here</a>. They are available from 11 February 2016 to present. An Arctic shapefile for a given date can be downloaded and extracted with a bash script like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>shapefile_date=20160211
product_number=5
zipfile=DownloadArchive?prd=${product_number}$(date -d &quot;$shapefile_date&quot; &quot;+%m%d%Y&quot;)
wget https://usicecenter.gov/File/$zipfile
unzip $zipfile
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">$(date</span> <span class="pre">-d</span> <span class="pre">&quot;$shapefile_date&quot;</span> <span class="pre">&quot;+nic_miz%Y%jnc_pl_a&quot;)*</span></code> gives the following files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nic_miz2016042nc_pl_a</span><span class="o">.</span><span class="n">dbf</span>
<span class="n">nic_miz2016042nc_pl_a</span><span class="o">.</span><span class="n">prj</span>
<span class="n">nic_miz2016042nc_pl_a</span><span class="o">.</span><span class="n">shp</span>
<span class="n">nic_miz2016042nc_pl_a</span><span class="o">.</span><span class="n">shp</span><span class="o">.</span><span class="n">xml</span>
<span class="n">nic_miz2016042nc_pl_a</span><span class="o">.</span><span class="n">shx</span>
</pre></div>
</div>
</section>
<section id="antarctic">
<h4>1.2 Antarctic<a class="headerlink" href="#antarctic" title="Link to this heading">#</a></h4>
<p>Antarctic MIZ shapefiles were downloaded from <a class="reference external" href="https://usicecenter.gov/Products/ArchiveSearch?table=DailyAntarctic&amp;amp;product=Antarctic%20MIZ%20Chart&amp;amp;linkChange=ant-one">here</a>. They are available from 11 February 2016 to present. An Antarctic shapefile for a given date can be downloaded and extracted with a bash script like the one above, but with <code class="docutils literal notranslate"><span class="pre">product_number=19</span></code> instead of 5, and the “nc” in the filename changes to “sc”.</p>
</section>
</section>
<section id="parameters-requests-and-functions-definition">
<span id="satellite-satellite-sea-ice-concentration-intercomparison-q03-section-2"></span><h3>2. Parameters, requests and functions definition<a class="headerlink" href="#parameters-requests-and-functions-definition" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Define parameters and formulate requests for downloading with the EQC toolbox.</p></li>
<li><p>Define functions to be applied to process and reduce the size of the downloaded data.</p></li>
<li><p>Define functions to post-process and visualize the data.</p></li>
</ul>
<section id="import-libraries">
<h4>2.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Import the required libraries, including the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmocean</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>


<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;cf_xarray&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>2.2 Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<p>Set the time period to cover with <code class="docutils literal notranslate"><span class="pre">start_year</span></code> and <code class="docutils literal notranslate"><span class="pre">stop_year</span></code>, and set the years in which to plot maps with <code class="docutils literal notranslate"><span class="pre">map_years</span></code>.
Also specify <code class="docutils literal notranslate"><span class="pre">NIC_ICE_CHARTS_PATH</span></code>, the location of the directory with the NIC ice charts (rasterised to NetCDF).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">start_year</span> <span class="o">=</span> <span class="mi">2016</span>
<span class="n">stop_year</span> <span class="o">=</span> <span class="mi">2024</span>

<span class="c1"># Path to NIC ice charts</span>
<span class="n">NIC_ICE_CHARTS_PATH</span> <span class="o">=</span> <span class="s2">&quot;/data/wp5/williams_timothy/nic_ice_charts&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-request">
<h4>2.3 Define request<a class="headerlink" href="#define-request" title="Link to this heading">#</a></h4>
<p>Define the request for downloading using the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># allowed time range determined by availability of NIC ice charts</span>
<span class="n">year_min</span> <span class="o">=</span> <span class="mi">2016</span>
<span class="n">year_max</span> <span class="o">=</span> <span class="mi">2024</span>
<span class="c1">#  last year of CDR</span>
<span class="n">cdr_max</span> <span class="o">=</span> <span class="mi">2020</span>

<span class="n">map_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span> <span class="n">stop_year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <span class="n">map_year</span> <span class="ow">in</span> <span class="n">map_years</span><span class="p">:</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">map_year</span> <span class="o">&gt;=</span> <span class="n">year_min</span> <span class="ow">and</span> <span class="n">map_year</span> <span class="o">&lt;=</span> <span class="n">year_max</span><span class="p">)</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s1">&#39;satellite-sea-ice-concentration&#39;</span>
<span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;eumetsat_osi_saf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;ssmis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v3&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># requests for calculating time series of differences between ICDR and NIC</span>
<span class="n">requests_time_series</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CDR&quot;</span><span class="p">:</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="w"> </span><span class="n">year_min</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">stop_year</span><span class="p">,</span><span class="w"> </span><span class="n">cdr_max</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;ICDR&quot;</span><span class="p">:</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;icdr&quot;</span><span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="w"> </span><span class="n">cdr_max</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">stop_year</span><span class="p">,</span><span class="w"> </span><span class="n">year_max</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-used-in-caching-of-both-time-series-and-map-data">
<h4>2.4 Functions used in caching of both time series and map data<a class="headerlink" href="#functions-used-in-caching-of-both-time-series-and-map-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_nic_data</span></code> is used to load the NIC ice charts for the requested hemisphere and time period.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_black_adriatic</span></code> loads a mask to exclude the Black and Adriatic Seas from the analysis since they don’t typically contain sea ice.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_nic_data</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">item</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">NIC_ICE_CHARTS_PATH</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">/%Y/nic_miz_%Y%m%d_</span><span class="si">{</span><span class="n">region</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">c_pl_a.nc&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="n">files</span> <span class="o">+=</span> <span class="p">[</span><span class="n">f</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_black_adriatic</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="c1"># get Black and Adriatic Seas for masking</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">60.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">48.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-cache-time-series">
<h4>2.5 Functions to cache time series<a class="headerlink" href="#functions-to-cache-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compare_siconc_vs_nic</span></code> classifies the satellite sea ice concentration data into the same categories that are in the NIC ice charts, and then calculates the extents and some comparison statistics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_siconc_nic_time_series</span></code> loads the NIC ice chart data, matches the time data with the satellite sea ice concentration data, and runs the comparison by calling <code class="docutils literal notranslate"><span class="pre">compare_siconc_vs_nic</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compare_siconc_vs_nic</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_nic</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>

    <span class="c1"># grid cell area of sea ice edge grid</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]][:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">grid_cell_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0e-6</span>  <span class="c1"># 10^6 km2</span>

    <span class="c1"># get sea ice concentration and convert to ice/water classification</span>
    <span class="n">lonlat</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">][:]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">]}</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">lonlat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;(0 - 1)&quot;</span><span class="p">:</span>
        <span class="n">sic</span> <span class="o">*=</span> <span class="mi">100</span>
    <span class="n">sic_threshold</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">sic_class</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic</span> <span class="o">&gt;=</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">sic</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="c1"># 1 = open water, 2 = ice</span>
    <span class="n">sic_class</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">get_black_adriatic</span><span class="p">(</span><span class="n">sic</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sic_class</span><span class="p">)</span> <span class="c1"># set to open water since NIC never has ice there</span>
    <span class="n">proj_var</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">grid_mapping</span>
    <span class="n">data_arrays</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># extent from SIC</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;extent_cds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_cell_area</span> <span class="o">*</span> <span class="p">(</span><span class="n">sic_class</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;extent_cds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_extent_from_cds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice extent from CDS&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    
    <span class="c1"># get NIC classification and compare to the one from SIC</span>
    <span class="c1"># - 1 = open water, 2 = miz, 3 = pack</span>
    <span class="n">nic_class</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ds_nic</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_classification&quot;</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="n">sic</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">sic</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">nic_ice_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">nic_class</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># extent from NIC</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;extent_nic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_cell_area</span> <span class="o">*</span> <span class="n">nic_ice_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;extent_nic&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_extent_from_nic&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice extent from NIC&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    
    <span class="c1"># compare the 2 products</span>
    <span class="n">over</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_class</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nic_class</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">under</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_class</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">nic_ice_mask</span>
    <span class="n">over</span> <span class="o">=</span> <span class="n">grid_cell_area</span> <span class="o">*</span> <span class="n">over</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">under</span> <span class="o">=</span> <span class="n">grid_cell_area</span> <span class="o">*</span> <span class="n">under</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>

    <span class="c1"># add IIEE metric to output</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;iiee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">over</span> <span class="o">+</span> <span class="n">under</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;iiee&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;integrated_ice_edge_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Integrated ice edge error&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># add bias metric to output</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;siextent_bias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">over</span> <span class="o">-</span> <span class="n">under</span>
    <span class="n">data_arrays</span><span class="p">[</span><span class="s2">&quot;siextent_bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_extent_bias&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice extent bias&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">data_arrays</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_siconc_nic_time_series</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
    <span class="c1"># load NIC data</span>
    <span class="n">ds_nic</span> <span class="o">=</span> <span class="n">get_nic_data</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>

    <span class="c1"># select the common times</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">ds_nic</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_nic</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    
    <span class="c1"># Compare the sea ice concentration product with the NIC classification</span>
    <span class="k">return</span> <span class="n">compare_siconc_vs_nic</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_nic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-to-cache-map-data">
<h4>2.6 Define functions to cache map data<a class="headerlink" href="#define-functions-to-cache-map-data" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>since both products are daily datasets, <code class="docutils literal notranslate"><span class="pre">get_probabilities</span></code> calculates the probability that a grid cell is ice-covered for the month.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postproc_probabilities</span></code> does some post-processing to ensure both datasets have the same coordinates and adds a product dimension. It also masks the Black and Adriatic seas as the EUMETSAT OSI-SAF product sometimes shows ice there, while the NIC ice charts never do, which creates a systematic difference that we are not interested in.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_probabilities</span></code> calls <code class="docutils literal notranslate"><span class="pre">get_NIC_data</span></code>, and then <code class="docutils literal notranslate"><span class="pre">get_probabilities</span></code> and <code class="docutils literal notranslate"><span class="pre">postproc_probabilities</span></code> for both the NIC data and the sea ice concentration data. This gives two datasets of monthly probabilities of being ice-covered which are then merged so that the <code class="docutils literal notranslate"><span class="pre">product</span></code> dimension is either <code class="docutils literal notranslate"><span class="pre">NIC</span></code> or <code class="docutils literal notranslate"><span class="pre">ICDR</span></code> (the EUMETSAF OSI-SAF sea ice concentration product).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_probabilities</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">sic</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="mi">100</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">sic</span><span class="p">),</span> <span class="n">da</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;probability_ice_covered&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Probability of cell being ice-covered&quot;</span><span class="p">,</span>
            <span class="s2">&quot;grid_mapping&quot;</span><span class="p">:</span> <span class="s2">&quot;Lambert_Azimuthal_Grid&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">postproc_probabilities</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">product</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">get_black_adriatic</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s2">&quot;probability_ice_covered&quot;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)})</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">])</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_probabilities</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
    <span class="c1"># load NIC data and calculate the monthly climatology</span>
    <span class="n">ds_nic</span> <span class="o">=</span> <span class="n">get_nic_data</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>

    <span class="c1"># get common times</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">ds_nic</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s2">&quot;nv&quot;</span><span class="p">),</span> <span class="n">ds_nic</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
    <span class="n">proj_name</span> <span class="o">=</span> <span class="s2">&quot;Lambert_Azimuthal_Grid&quot;</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span> <span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">proj_name</span><span class="p">]}</span>

    <span class="c1"># get climatologies</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>
    <span class="n">ice_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sic&quot;</span><span class="p">:</span> <span class="n">sic</span><span class="p">,</span> <span class="s2">&quot;dims&quot;</span><span class="p">:</span> <span class="n">sic</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>  <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="n">sic</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>

    <span class="c1"># combine data arrays into one dataset</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">]}</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">postproc_probabilities</span><span class="p">(</span><span class="n">get_probabilities</span><span class="p">(</span><span class="n">ice_mask</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">),</span> <span class="n">coords</span><span class="p">,</span> <span class="s2">&quot;CDS&quot;</span><span class="p">),</span>
        <span class="n">postproc_probabilities</span><span class="p">(</span><span class="n">get_probabilities</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_nic</span><span class="p">[</span><span class="s2">&quot;ice_code&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="o">**</span><span class="n">kw</span><span class="p">),</span> <span class="n">coords</span><span class="p">,</span> <span class="s2">&quot;NIC&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">proj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">byte</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-for-post-processing-and-plotting-time-series">
<h4>2.7 Functions for post-processing and plotting time series<a class="headerlink" href="#functions-for-post-processing-and-plotting-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rearrange_year_vs_dayofyear</span></code> changes the dataset from having a single time dimension to having two: the year and the Julian day of the year.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">merge_time_series</span></code> merges the time series datasets from the CDR and ICDR products.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_against_dayofyear</span></code> calls <code class="docutils literal notranslate"><span class="pre">make_subplot</span></code> for the extents according to NIC and the sea ice concentration product, and also the extent bias and the integrated ice edge error (IIEE).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rearrange_year_vs_dayofyear</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">new_dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;dayofyear&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;noleap&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
        <span class="p">{</span><span class="n">dim</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">new_dims</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">new_dims</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">merge_time_series</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
    <span class="n">datasets_merged</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">datasets_merged</span> <span class="o">+=</span> <span class="p">[</span><span class="n">rearrange_year_vs_dayofyear</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">])]</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_merged</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_time_series_doy</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
        <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">,</span>
        <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">add_legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.506</span><span class="p">,</span><span class="mf">.5</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">vname</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">,</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span><span class="k">ds</span>[vname].attrs[&quot;units&quot;], fontsize=15)
    
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">row_labels</span><span class="p">:</span>
        <span class="n">vname</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">longname</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">vname</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">longname</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> %b&quot;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-for-plotting-maps">
<h4>2.8 Functions for plotting maps<a class="headerlink" href="#functions-for-plotting-maps" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_data_array_for_plotting</span></code> gets the <code class="docutils literal notranslate"><span class="pre">probability_ice_covered</span></code> variable, removes months without data, and changes the <code class="docutils literal notranslate"><span class="pre">month</span></code> values from integers to their short names (eg <code class="docutils literal notranslate"><span class="pre">Jan</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label_antarctic_seas</span></code> is a helper function to annotate maps of Antarctica with the names of the surrounding seas (to orient the reader).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_plot</span></code> sets the projection to plot the maps in, makes the plots and sets the labels for the individual plots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps</span></code> calls <code class="docutils literal notranslate"><span class="pre">get_data_array_for_plotting</span></code> and <code class="docutils literal notranslate"><span class="pre">make_plot</span></code>, with a suitable colormap for plotting the monthly probabilities of being ice-covered themselves.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_bias_maps</span></code> calls <code class="docutils literal notranslate"><span class="pre">get_data_array_for_plotting</span></code>, gets the difference by subtracting the monthly probability for the <code class="docutils literal notranslate"><span class="pre">NIC</span></code> product from that of the <code class="docutils literal notranslate"><span class="pre">ICDR</span></code> product (the EUMETSAT OSI-SAF ICDR product), and then calls <code class="docutils literal notranslate"><span class="pre">make_plot</span></code> with a suitable colormap for plotting the differences.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_data_array_for_plotting</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># zoom in on ice</span>
    <span class="n">isel_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;yc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)}</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">probability_ice_covered</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">isel_dict</span><span class="p">)</span>

    <span class="c1"># select a particular year and remove months without data</span>
    <span class="k">if</span> <span class="n">year</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sel_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="n">year</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2016</span><span class="p">:</span>
            <span class="n">sel_dict</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2023</span><span class="p">:</span>
            <span class="n">sel_dict</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

    <span class="c1"># rename month dimension from integer to short names</span>
    <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">label_antarctic_seas</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">seas</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;IO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Indian Ocean&quot;</span><span class="p">,</span> <span class="mf">.8</span><span class="p">,</span> <span class="mf">.7</span><span class="p">),</span>
        <span class="s2">&quot;SAO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;South Atlantic</span><span class="se">\n</span><span class="s2">   Ocean&quot;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.85</span><span class="p">),</span>
        <span class="s2">&quot;SPO&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;South Pacific</span><span class="se">\n</span><span class="s2">   Ocean&quot;</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.15</span><span class="p">),</span>
        <span class="s2">&quot;WS&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Weddell Sea&quot;</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.65</span><span class="p">),</span>
        <span class="s2">&quot;RS&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Ross Sea&quot;</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.23</span><span class="p">),</span>
        <span class="s2">&quot;BS&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Bellinghausen</span><span class="se">\n</span><span class="s2">    Sea&quot;</span><span class="p">,</span> <span class="mf">.14</span><span class="p">,</span> <span class="mf">.45</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">legend_text</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">seas</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">xmin</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">),</span>
            <span class="n">ymin</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">),</span>
            <span class="n">label</span><span class="p">,</span>
            <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">legend_text</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">.8</span><span class="p">,</span> <span class="mf">.73</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">legend_text</span><span class="p">),</span>
        <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;serif&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">},</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_plot</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">clat</span> <span class="o">=</span> <span class="mf">90.</span> <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s2">&quot;northern_hemisphere&quot;</span> <span class="k">else</span> <span class="o">-</span><span class="mf">90.</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                       <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pad&quot;</span> <span class="p">:</span> <span class="mf">.04</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.45</span><span class="p">,</span> <span class="s1">&#39;extend&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">},</span>
                       <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="n">clat</span><span class="p">))</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet_grid</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clat</span> <span class="o">==</span> <span class="o">-</span><span class="mi">90</span> <span class="ow">and</span> <span class="n">ax</span> <span class="o">==</span> <span class="n">facet_grid</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="c1"># label Antarctic seas to orient reader</span>
            <span class="n">label_antarctic_seas</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_data_array_for_plotting</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">[</span><span class="n">region</span><span class="p">],</span> <span class="n">year</span><span class="p">)</span>
    <span class="n">make_plot</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_bias_maps</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">monthly_clim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">year</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_data_array_for_plotting</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">[</span><span class="n">region</span><span class="p">],</span> <span class="n">year</span><span class="p">)</span>
    <span class="n">kw_plot</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;col_wrap&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">monthly_clim</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">year</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">kw_plot</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;year&quot;</span><span class="p">}</span>

    <span class="n">bias</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;CDS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;NIC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="n">bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bias in CDS compared to NIC ice charts&quot;</span>
    <span class="n">bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span>
    <span class="n">make_plot</span><span class="p">(</span><span class="n">bias</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_plot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-the-data">
<span id="satellite-satellite-sea-ice-concentration-intercomparison-q03-section-3"></span><h3>3. Download and transform the data<a class="headerlink" href="#download-and-transform-the-data" title="Link to this heading">#</a></h3>
<p>This is where the data is downloaded, transformed and saved to disk by the EQC toolbox. If the code is rerun the transformed data is loaded from the disk.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;raw_ice_conc_values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_standard_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smearing_standard_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;algorithm_standard_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status_flag&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="production-of-data-for-time-series">
<h4>3.1 Production of data for time series<a class="headerlink" href="#production-of-data-for-time-series" title="Link to this heading">#</a></h4>
<p>For both the Arctic and Antarctic, the data is downloaded, transformed using <code class="docutils literal notranslate"><span class="pre">compute_siconc_nic_time_series</span></code>, and saved to disk.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>

<span class="c1"># Download CDR and ICDR separately</span>
<span class="n">dataset_compare_nic</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">requests_time_series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">,</span>
        <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">requests</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span> <span class="p">[</span><span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">}</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="p">],</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_siconc_nic_time_series</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">])</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
    <span class="n">dataset_compare_nic</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># merge the CDR and ICDR time series</span>
<span class="n">dataset_compare_nic</span> <span class="o">=</span> <span class="n">merge_time_series</span><span class="p">(</span><span class="n">dataset_compare_nic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="production-of-data-for-maps">
<h4>3.2 Production of data for maps<a class="headerlink" href="#production-of-data-for-maps" title="Link to this heading">#</a></h4>
<p>For both the Arctic and Antarctic, the data is downloaded, transformed using <code class="docutils literal notranslate"><span class="pre">get_monthly_probabilities</span></code>, and saved to disk.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">datasets_maps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">,</span>
    <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">,</span>
<span class="p">]:</span>
    <span class="k">for</span> <span class="n">map_year</span> <span class="ow">in</span> <span class="n">map_years</span><span class="p">:</span>
        <span class="n">requests_maps</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
            <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span> <span class="k">if</span> <span class="n">map_year</span> <span class="o">&lt;=</span> <span class="n">cdr_max</span> <span class="k">else</span> <span class="s2">&quot;icdr&quot;</span><span class="p">},</span>
            <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">map_year</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">map_year</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
            <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">requests_maps</span><span class="p">)</span>
        <span class="n">datasets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span> <span class="n">requests_maps</span><span class="p">,</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">get_monthly_probabilities</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">},</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">map_year</span><span class="p">)])]</span>
    <span class="n">datasets_maps</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="results">
<span id="satellite-satellite-sea-ice-concentration-intercomparison-q03-section-4"></span><h3>4. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<section id="northern-hemisphere">
<h4>4.1 Northern hemisphere<a class="headerlink" href="#northern-hemisphere" title="Link to this heading">#</a></h4>
<p>Below we plot comparisons between the Arctic sea ice extents in the CDS concentration datasets and the NIC ice charts. The upper two plots show they have fairly similar intra- and inter-annual variability, although there is more variability at shorter time scales in the NIC extent. The bias (CDS - NIC) plot shows that CDS has consistently less ice than NIC, with the possible exception of September. The bias is largest in the summer months when the concentration from passive microwave sensors would be expected to have the greatest errors, at times exceeding <span class="math notranslate nohighlight">\(10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>. The IIEE is also quite high, ranging between 1 and 2.5 <span class="math notranslate nohighlight">\(\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>, with the maximum again in summer. The years 2016, 2017 and 2023 have quite high IIEEs in the summer, while 2018 (May - June), 2021 (July - August) and 2019 (August - September)  have the lowest values of IIEE.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_doy</span><span class="p">(</span><span class="n">dataset_compare_nic</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f98d1e9d45d52a98190fc2aa89ccf94728256bff562b69d632e86c3de60b16f3.png" src="../../_images/f98d1e9d45d52a98190fc2aa89ccf94728256bff562b69d632e86c3de60b16f3.png" />
</div>
</div>
<p>The maps below show monthly climatologies for the bias (CDS - NIC) in the probability of being ice-covered in the Arctic. The regions where there is disagreement - mostly ice in the ice charts, but not in the CDS - at the ice edge, which varies in location according to the time of year. In the winter months this is in the Labrador, Greenland and Barents Sea on the Atlantic side, and the Bering and Okhotsk Seas on the Pacific side. In the summer months there are also areas of disagreement off the Arctic and Siberian coasts and in the Hudson Bay. These areas are larger, possibly due to errors in the SIC from passive microwave sensors, and maybe also due to the ice edge being in more dynamic areas such as the Beaufort Sea.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">,</span> <span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/92a81305e0d5d10ad67c8163b5719fd73236211b0903ffb20c7bc8fced0ae3cb.png" src="../../_images/92a81305e0d5d10ad67c8163b5719fd73236211b0903ffb20c7bc8fced0ae3cb.png" />
</div>
</div>
</section>
<section id="southern-hemisphere">
<h4>4.2 Southern hemisphere<a class="headerlink" href="#southern-hemisphere" title="Link to this heading">#</a></h4>
<p>Below we plot comparisons between the Antarctic sea ice extents in the CDS concentration datasets and the NIC ice charts. As with the Arctic time series, the upper two plots show they have fairly similar intra- and inter-annual variability, and there is again more variability at shorter time scales in the NIC extent. However, this variability has a higher amplitude than for the Arctic. The bias plot shows that CDS nearly always has less ice than NIC. The bias is largest in the summer months when the concentration from passive microwave sensors would be expected to have the greatest errors, at times exceeding <span class="math notranslate nohighlight">\(3 \times 10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>. The IIEE is only slightly higher, reflecting the fact that there are few areas where CDS has ice when NIC does not. It ranges between 1 and 2 <span class="math notranslate nohighlight">\(\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in winter, and between 2 and 4 <span class="math notranslate nohighlight">\(\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in summer. The years with the greatest IIEE are 2016. 2023 and 2024.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_series_doy</span><span class="p">(</span><span class="n">dataset_compare_nic</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/87f678f0464cc809c231772045d29495f76bec0b35f4df70688e06fe3cc9fa5c.png" src="../../_images/87f678f0464cc809c231772045d29495f76bec0b35f4df70688e06fe3cc9fa5c.png" />
</div>
</div>
<p>The maps below show monthly climatologies for the bias (CDS - NIC) in the probability of being ice-covered around Antarctica. In the winter months, the areas where the CDS and the NIC ice charts disagree are fairly uniformly spread around the continent. In the summer months, there are very large areas of disagreement in the Weddell, Bellingshausen and Ross Seas. In the Indian Ocean sector the areas of disagreement are biggest in summer but they are much less than in the Pacific and Atlantic sectors.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">,</span> <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d763be77aa67013500f580f433b43f1511eb20afd4d25507900497d18747dccc.png" src="../../_images/d763be77aa67013500f580f433b43f1511eb20afd4d25507900497d18747dccc.png" />
</div>
</div>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Introductory sea ice materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.epa.gov/climate-indicators/climate-change-indicators-arctic-sea-ice"><span style="color:blue">Role of sea ice in the climate</span></a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure"><span style="color:blue">Observing sea ice with satellites</span></a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control"><span style="color:blue">C3S EQC custom functions</span></a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/"><span style="color:blue">B-Open</span></a></p></li>
</ul>
<p>Information on ice charts:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://usicecenter.gov/Products"><span style="color:blue">NIC ice charts</span></a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Ivanova, N., Pedersen, L. T., Tonboe, R. T., Kern, S., Heygster, G., Lavergne, T., Sørensen, A., Saldo, R., Dybkjær, G., Brucker, L., &amp; Shokr, M. (2015). Inter-comparison and evaluation of sea ice algorithms: towards further identification of challenges and optimal approach using passive microwave observations. The Cryosphere, 9(5), 1797-1817, <a class="reference external" href="https://tc.copernicus.org/articles/9/1797/2015"><span style="color:blue">https://tc.copernicus.org/articles/9/1797/2015</span></a>.</p></li>
<li><p>Comiso, J. C., Cavalieri, D. J., Parkinson, C. L., &amp; Gloersen, P. (1997). Passive microwave algorithms for sea ice concentration: A comparison of two techniques. Remote sensing of Environment, 60(3), 357-384, <a class="reference external" href="https://doi.org/10.1016/S0034-4257(96)00220-9"><span style="color:blue">https://doi.org/10.1016/S0034-4257(96)00220-9</span></a>.</p></li>
<li><p>Buckley, E. M., Horvat, C., &amp; Yoosiri, P. (2024). Sea Ice Concentration Estimates from ICESat-2 Linear Ice Fraction. Part 1: Multi-sensor Comparison of Sea Ice Concentration Products. EGUsphere, 2024, 1-19, <a class="reference external" href="https://doi.org/10.5194/egusphere-2024-3861"><span style="color:blue">https://doi.org/10.5194/egusphere-2024-3861</span></a>.</p></li>
<li><p>Goessling, H. F., Tietsche, S., Day, J. J., Hawkins, E., &amp; Jung, T. (2016). Predictability of the Arctic sea ice edge. Geophysical Research Letters, 43(4), 1642-1650, <a class="reference external" href="https://doi.org/10.1002/2015GL067232"><span style="color:blue">https://doi.org/10.1002/2015GL067232</span></a>.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Cryosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Cryosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Biosphere/Land_Biosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-uncertainty-of-sea-ice-concentration-products">🌍 Use case: Assessing the uncertainty of sea ice concentration products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-nic-shapefiles">1. Download NIC shapefiles</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic">1.1 Arctic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic">1.2 Antarctic</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">2. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">2.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">2.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request">2.3 Define request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-used-in-caching-of-both-time-series-and-map-data">2.4 Functions used in caching of both time series and map data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache-time-series">2.5 Functions to cache time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache-map-data">2.6 Define functions to cache map data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-post-processing-and-plotting-time-series">2.7 Functions for post-processing and plotting time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-for-plotting-maps">2.8 Functions for plotting maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">3. Download and transform the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#production-of-data-for-time-series">3.1 Production of data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#production-of-data-for-maps">3.2 Production of data for maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#northern-hemisphere">4.1 Northern hemisphere</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#southern-hemisphere">4.2 Southern hemisphere</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>