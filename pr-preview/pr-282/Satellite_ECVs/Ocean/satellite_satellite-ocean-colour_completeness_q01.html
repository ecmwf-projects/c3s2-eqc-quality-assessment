
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6.1. Completeness of ocean colour observations for biogeochemical models &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_completeness_q01';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Insitu Observations" href="../../In_Situ/insitu.html" />
    <link rel="prev" title="1.6. Ocean" href="Ocean.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Ocean.html">1.6. Ocean</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.6.1. Completeness of ocean colour observations for biogeochemical models</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Ocean/satellite_satellite-ocean-colour_completeness_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_completeness_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Completeness of ocean colour observations for biogeochemical models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-phytoplankton-dynamics-in-the-southern-ocean">🌍 Use case: <em>Monitoring phytoplankton dynamics in the Southern Ocean</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters-to-be-analysed-time-period-variables-regions-and-data-request">Define parameters to be analysed (time period, variables, regions) and data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-functions-and-data-retrieval">2. Transform functions and data retrieval</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-transform-functions">Define transform functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">Data retrieval</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-function-and-trends-calculation">3. Mapping function and trends calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-mapping-function">Define mapping function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-trends">Compute trends</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-and-discuss-results">4. Display and discuss results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-results">Display results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="completeness-of-ocean-colour-observations-for-biogeochemical-models">
<h1><span class="section-number">1.6.1. </span>Completeness of ocean colour observations for biogeochemical models<a class="headerlink" href="#completeness-of-ocean-colour-observations-for-biogeochemical-models" title="Link to this heading">#</a></h1>
<p>Production Date: 02-12-2024<br />
Produced by: Chiara Volta (ENEA, Italy)</p>
<section id="use-case-monitoring-phytoplankton-dynamics-in-the-southern-ocean">
<h2>🌍 Use case: <em>Monitoring phytoplankton dynamics in the Southern Ocean</em><a class="headerlink" href="#use-case-monitoring-phytoplankton-dynamics-in-the-southern-ocean" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>Is chlorophyll-a data sufficiently complete in time and space for integration into biogeochemical models?</strong></p>
<p>The Ocean Colour dataset version 6.0, as produced for the Copernicus Climate Change Service (C3S), includes the two variables: mass concentration of chlorophyll-a and remote sensing reflectance (Rrs) for six wavelengths from October 1997 to present <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[1]</a>.<br />
Chlorophyll-a concentration data, which are derived through specific algorithms using remote sensing reflectance (Rrs) <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_ATBD-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[2]</a>, are indispensable in biogeochemical modelling as they provide inputs for models initialisation and references to calibrate biogeochemical parameters and validate models results (e.g., <a class="reference external" href="https://doi.org/10.1016/j.jmarsys.2013.02.007">[3]</a> <a class="reference external" href="https://doi.org/10.3390/rs10101666">[4]</a> <a class="reference external" href="https://doi.org/10.1038/s41467-019-08457-x">[5]</a>). Moreover, chlorophyll-a data can be assimilated into models, enabling continuous updates with observed conditions and significantly improve their accuracy (e.g., <a class="reference external" href="https://doi.org/10.1029/2018JC014329">[6]</a>).
The dataset merges measurements carried out by six satellite sensors <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[1]</a>: SeaWiFS, MERIS, MODIS-Aqua, VIIRS, OLCI-3A and OLCI-3B. Each sensor has specific design characteristics and viewing geometry, and no sensor was operational over the whole temporal coverage of the datasets <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[1]</a> <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_ATBD-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[2]</a>. Currently, only OLCI-3A and OLCI-3B are operational.<br />
Here, the goal is to assess the completeness of the chlorophyll-a dataset at both spatial and temporal scales in the Southern Ocean.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<p>The Ocean Colour dataset version 6.0:</p>
<ul class="simple">
<li><p>provides a limited representation of the spatial distribution of chlorophyll-a concentrations in the oceanic region below latitude 45.5°S, based on less than 8% of valid pixels.</p></li>
<li><p>offers an acceptable representation of the spatial distribution of chlorophyll-a concentrations off the southeast coast of South America, based on more than 30% of valid pixels.</p></li>
<li><p>requires filtering based on the availability of valid pixels when analysing chlorophyll-a temporal distribution, to reduce potential bias due to limited sampling, especially during the austral winter (May-August).</p></li>
<li><p>allows for the calculation of monthly chlorophyll-a trends in the Southern Ocean, although these trends should be interpreted with caution as based on less than 15% of valid pixels.</p></li>
<li><p>can be used for calibrating, assimilating and validating biogeochemical models in the Southern Ocean from September to April, when valid observations are more abundant.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This notebook provides an assessment of the ability of the Ocean Colour dataset version 6.0 to represent the spatial distribution and temporal variability of chlorophyll-a concentrations in the Indian, Pacific, and Atlantic Ocean sectors of the Permanent Open Ocean Zone in the Southern Ocean by analysing the number of valid pixels available.</p>
<p>The analysis and results are detailed in the sections below:</p>
<p><a class="reference internal" href="#satellite-satellite-ocean-colour-completeness-q01-section-1"><span class="std std-ref">1. Choose the data to use and set up the code</span></a></p>
<ul class="simple">
<li><p>Import required packages</p></li>
<li><p>Define parameters to be analysed (time period, variables, regions) and data request</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-ocean-colour-completeness-q01-section-2"><span class="std std-ref">2. Transform functions and data retrieval</span></a></p>
<ul class="simple">
<li><p>Define transform functions</p></li>
<li><p>Retrieve data for the selected variables, time period and regions</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-ocean-colour-completeness-q01-section-3"><span class="std std-ref">3. Mapping function and trends calculation</span></a></p>
<ul class="simple">
<li><p>Define mapping function</p></li>
<li><p>Compute trends</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-ocean-colour-completeness-q01-section-4"><span class="std std-ref">4. Display and discuss results</span></a></p>
<ul class="simple">
<li><p>Display results</p></li>
<li><p>Discussion</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-ocean-colour-completeness-q01-section-1"></span><h3>1. Choose the data to use and set up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-required-packages">
<h4>Import required packages<a class="headerlink" href="#import-required-packages" title="Link to this heading">#</a></h4>
<p>Besides the standard libraries used to manage and analyse multidimensional arrays, the <a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a> <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>is imported to download data and calculate statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.path</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpath</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="kn">import</span> <span class="n">original_test</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters-to-be-analysed-time-period-variables-regions-and-data-request">
<h4>Define parameters to be analysed (time period, variables, regions) and data request<a class="headerlink" href="#define-parameters-to-be-analysed-time-period-variables-regions-and-data-request" title="Link to this heading">#</a></h4>
<p>The analysis performed in this notebook examines the spatial and temporal distribution of chlorophyll-a data, and corresponding valid pixels, over a 21-year period (January 2003 - December 2023), which accounts for previous EQC information (<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-ocean-colour?tab=quality_assurance_tab">https://cds.climate.copernicus.eu/datasets/satellite-ocean-colour?tab=quality_assurance_tab</a>) and includes only complete years. The analysis is performed over three sectors within the oceanic region in the Southern Ocean located between latitudes 47.5°S and 63.5°S (i.e., the Permanent Open Ocean Zone, POOZ) <a class="reference external" href="https://doi.org/10.1016/0967-0637%2895%2900021-W">[7]</a>. The three POOZ sectors analysed are: the Indian Ocean sector (IO_POOZ), the Pacific Ocean sector (PO_POOZ) and the Atlantic Ocean sector (AO_POOZ), which extend between longitudes 20°E and 150°E, 150°E and 70°W, and 70°W and 20°E, respectively <a class="reference external" href="https://doi.org/10.1029/2019GL083163">[8]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time period</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2003-01&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="s2">&quot;2023-12&quot;</span>

<span class="c1"># Variable</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;chlor_a&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;chlor_a&quot;</span><span class="p">}</span> <span class="o">|</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;Rrs_</span><span class="si">{</span><span class="n">wl</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">wl</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">443</span><span class="p">,</span> <span class="mi">560</span><span class="p">)}</span>

<span class="c1"># Regions</span>
<span class="n">regions_monthly</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;IO_POOZ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">47.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">63.5</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;PO_POOZ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">290</span><span class="p">),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">47.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">63.5</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;AO_POOZ&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">47.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">63.5</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">regions_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;SO&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">47.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">63.5</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Define data request</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-ocean-colour&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;regular_latitude_longitude_grid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;6_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="transform-functions-and-data-retrieval">
<span id="satellite-satellite-ocean-colour-completeness-q01-section-2"></span><h3>2. Transform functions and data retrieval<a class="headerlink" href="#transform-functions-and-data-retrieval" title="Link to this heading">#</a></h3>
<section id="define-transform-functions">
<h4>Define transform functions<a class="headerlink" href="#define-transform-functions" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">monthly_weighted_log_mean</span></code> function is defined to calculate temporal averages of chlorophyll-a concentration (mg m<sup>-3</sup>) and the percentage of corresponding valid pixels for each POOZ sector by month and year, while the <code class="docutils literal notranslate"><span class="pre">weighted_log_map</span></code> function is defined to compute spatial averages across the entire POOZ.
Both functions account for the varying surface area at different latitudes. Averages for chlorophyll-a concentration are computed using log-transformed daily data, and then back-transformed <a class="reference external" href="https://doi.org/10.1029/95JC00458">[9]</a>. Daily chlorophyll-a concentrations outside the range 0.01-100 mg m<sup>-3</sup> are excluded from the analysis <a class="reference external" href="https://doi.org/10.3390/s19194285">[10]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">monthly_weighted_log_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;chlor_a&quot;</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">da</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">da</span> <span class="o">&lt;</span> <span class="mf">1.0e2</span><span class="p">))</span>

    <span class="n">valid_pixels</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="n">diagnostics</span><span class="o">.</span><span class="n">monthly_weighted_mean</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">valid_pixels</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Valid Pixels&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">da</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>
        <span class="n">da</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="n">diagnostics</span><span class="o">.</span><span class="n">monthly_weighted_mean</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">),</span> <span class="n">valid_pixels</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">weighted_log_map</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;chlor_a&quot;</span><span class="p">:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">da</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">da</span> <span class="o">&lt;</span> <span class="mf">1.0e2</span><span class="p">))</span>

    <span class="n">valid_pixels</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">da</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">valid_pixels</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Valid Pixels&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">da</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>
        <span class="n">da</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">da</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">),</span> <span class="n">valid_pixels</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">)])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">postprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Chl-a&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;mg m-3&quot;</span><span class="p">})</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;valid pixels&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-retrieval">
<h4>Data retrieval<a class="headerlink" href="#data-retrieval" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">monthly_weighted_log_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">weighted_log_map</span></code> functions are applied to the chlorophyll-a dataset in the selected regions, and temporal and spatial averages are downloaded as two separated arrays.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">regions_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;remote_sensing_reflectance&quot;</span>
            <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Rrs&quot;</span><span class="p">)</span>
            <span class="k">else</span> <span class="s2">&quot;mass_concentration_of_chlorophyll_a&quot;</span>
        <span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="n">stop</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">weighted_log_map</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">slices</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">maps</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">postprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">regions_monthly</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;remote_sensing_reflectance&quot;</span>
            <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Rrs&quot;</span><span class="p">)</span>
            <span class="k">else</span> <span class="s2">&quot;mass_concentration_of_chlorophyll_a&quot;</span>
        <span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="n">stop</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">monthly_weighted_log_mean</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">slices</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">postprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
<span class="n">ds_monthly</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
<span class="n">ds_monthly</span> <span class="o">=</span> <span class="n">ds_monthly</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">month_abbr</span><span class="o">=</span><span class="p">(</span>
        <span class="s2">&quot;month&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="mapping-function-and-trends-calculation">
<span id="satellite-satellite-ocean-colour-completeness-q01-section-3"></span><h3>3. Mapping function and trends calculation<a class="headerlink" href="#mapping-function-and-trends-calculation" title="Link to this heading">#</a></h3>
<section id="define-mapping-function">
<h4>Define mapping function<a class="headerlink" href="#define-mapping-function" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">plot_map</span></code> function is defined to visualise the maps of average chlorophyll-a concentrations and corresponding percentages of valid pixels across the POOZ.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_map</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">lon_data</span><span class="p">,</span> <span class="n">lat_data</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">cbar_label</span><span class="p">,</span> <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                  <span class="n">add_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">title_pad</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> 

    <span class="n">pcolor</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_data</span><span class="p">,</span> <span class="n">lat_data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_cbar</span><span class="p">:</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pcolor</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>  
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span> 

    <span class="k">if</span> <span class="n">add_circle</span><span class="p">:</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="mf">0.5</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">mpath</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">verts</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">+</span> <span class="n">center</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_boundary</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">add_labels</span><span class="p">:</span>
        <span class="n">lon_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> 
        <span class="k">for</span> <span class="n">lon</span> <span class="ow">in</span> <span class="n">lon_labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lon</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;0°&#39;</span> 
            <span class="k">elif</span> <span class="n">lon</span> <span class="o">==</span> <span class="o">-</span><span class="mi">180</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;180°&#39;</span>  
            <span class="k">elif</span> <span class="n">lon</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
                <span class="k">continue</span> 
            <span class="k">elif</span> <span class="n">lon</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">lon</span><span class="p">)</span><span class="si">}</span><span class="s1">°W&#39;</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lon</span><span class="si">}</span><span class="s1">°E&#39;</span>  
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="o">-</span><span class="mi">33</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        <span class="n">sector_lines</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">]</span> 
    <span class="k">for</span> <span class="n">lon</span> <span class="ow">in</span> <span class="n">sector_lines</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">lon</span><span class="p">,</span> <span class="n">lon</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">110</span><span class="p">)</span>    
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;IO_POOZ&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;PO_POOZ&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">325</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;AO_POOZ&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>  
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-trends">
<h4>Compute trends<a class="headerlink" href="#compute-trends" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">calculate_mk_trends</span></code> function is defined to calculate chlorophyll-a trends and their statistical significance for each individual month over the 21-year period analysed here in the three POOZ sectors.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_mk_trends</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">original_test</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="n">result</span><span class="o">.</span><span class="n">p</span><span class="p">}</span>

<span class="n">slopes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">])),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">monthly_data</span> <span class="o">=</span> <span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;chl_masked&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">valid_data</span> <span class="o">=</span> <span class="n">monthly_data</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">monthly_data</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">valid_data</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">calculate_mk_trends</span><span class="p">(</span><span class="n">valid_data</span><span class="p">)</span>
            <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;slope&quot;</span><span class="p">]</span>
            <span class="n">p_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;p_value&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">p_values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">mk_trends_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">),</span> <span class="n">slopes</span><span class="p">),</span>
        <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="p">((</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">),</span> <span class="n">p_values</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">ds_monthly_filtered</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="display-and-discuss-results">
<span id="satellite-satellite-ocean-colour-completeness-q01-section-4"></span><h3>4. Display and discuss results<a class="headerlink" href="#display-and-discuss-results" title="Link to this heading">#</a></h3>
<section id="display-results">
<h4>Display results<a class="headerlink" href="#display-results" title="Link to this heading">#</a></h4>
<p>Maps showing the spatial distribution of valid pixel percentages and derived chlorophyll-a concentration in the POOZ are provided. Two sets of heatmaps are generated: one for the monthly percentage of valid chlorophyll-a pixels by POOZ sector, and another for the monthly chlorophyll-a concentrations. Here, chlorophyll-a data are displayed only when data coverage meets or exceeds the 21-year mean percentage of valid pixels across the POOZ (≈8%; see Discussion), and are referred to as filtered chlorophyll-a. Monthly climatologies of valid pixels and filtered chlorophyll-a concentrations are also shown. Trends in filtered chlorophyll-a and their statistical significance, calculated for each individual month over the 21-year period analysed, are summarised in a table, where statistically significant trends (p&gt;0.05) are highlighted in bold and na indicates not enough data for trends calculations.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display maps</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">()})</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span>
               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;Chl-a (mg/m$^3$)&#39;</span><span class="p">,</span> 
              <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">add_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> 
              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plot_map</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;valid_pixels&#39;</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> <span class="n">maps</span><span class="p">[</span><span class="s1">&#39;SO&#39;</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span>
               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;Valid pixels (%)&#39;</span><span class="p">,</span>  
              <span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">add_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title_pad</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> 
              <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">add_cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Filtering chlorophyll-a based on valid pixel coverage</span>
<span class="n">valid_mask</span> <span class="o">=</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">coverage_fraction</span> <span class="o">=</span> <span class="n">valid_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ds_monthly</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> 
<span class="n">location_mask</span> <span class="o">=</span> <span class="n">coverage_fraction</span> <span class="o">&gt;=</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;valid_pixels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mi">100</span>
<span class="n">broadcast_mask</span> <span class="o">=</span> <span class="n">location_mask</span><span class="o">.</span><span class="n">broadcast_like</span><span class="p">(</span><span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">])</span>
<span class="n">ds_monthly_masked</span> <span class="o">=</span> <span class="n">ds_monthly</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">broadcast_mask</span><span class="p">)</span>
<span class="n">ds_monthly_filtered</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span>
    <span class="s2">&quot;valid_pixels&quot;</span><span class="p">:</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s1">&#39;valid_pixels&#39;</span><span class="p">],</span>
    <span class="s2">&quot;chl_masked&quot;</span><span class="p">:</span> <span class="n">ds_monthly_masked</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>  
<span class="p">})</span>

<span class="c1"># Display heatmaps</span>
<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds_monthly_filtered</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;month_abbr&quot;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;valid_pixels&quot;</span> <span class="k">else</span> <span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">11.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Display climatologies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> 
    <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> 
    <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>  
    <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
    <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
    <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>  
<span class="p">})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly</span><span class="p">[</span><span class="s1">&#39;valid_pixels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;IO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly</span><span class="p">[</span><span class="s1">&#39;valid_pixels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;PO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly</span><span class="p">[</span><span class="s1">&#39;valid_pixels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;AO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Valid pixel climatology&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Valid pixels [%]&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly_masked</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;IO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;IO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly_masked</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;PO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_monthly_masked</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;AO_POOZ&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AO_POOZ&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtered chlorophyll-a climatology&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Chl-a [mg m-3]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Display mk results</span>
<span class="n">regions</span> <span class="o">=</span> <span class="n">mk_trends_data</span><span class="p">[</span><span class="s1">&#39;region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">mk_trends_data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">month_abbreviations</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span><span class="p">]</span>
<span class="n">formatted_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">significance_flags</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">regions</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sig_row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">months</span><span class="p">):</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">mk_trends_data</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="n">mk_trends_data</span><span class="p">[</span><span class="s1">&#39;p_value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">p_value</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;na&quot;</span><span class="p">)</span>
            <span class="n">sig_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2"> (</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">sig_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_value</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">formatted_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">significance_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig_row</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">formatted_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">month_abbreviations</span><span class="p">)</span>
<span class="n">significance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">significance_flags</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">regions</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">month_abbreviations</span><span class="p">)</span>
<span class="n">styled_table</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;Filtered Chlorophyll-a Trends (μg m⁻³ month⁻¹)&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">significance_df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;font-weight: bold;&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span>
        <span class="p">[{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th.col_heading&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;text-align&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">)]}]</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span> 
<span class="p">)</span>
<span class="n">styled_table</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/5b0f25a44eb6f15659b87a7968f2ccfb31facb38a0b372d03d41dfd9f6dda808.png" src="../../_images/5b0f25a44eb6f15659b87a7968f2ccfb31facb38a0b372d03d41dfd9f6dda808.png" />
<img alt="../../_images/b817e66aacfb7fd81819582d35c18f3f73fe922709863d1067dca176effe6222.png" src="../../_images/b817e66aacfb7fd81819582d35c18f3f73fe922709863d1067dca176effe6222.png" />
<img alt="../../_images/f23d3ff8c5936743e193393f499cca913f000e386c58eaebf510b96c1a27fd4c.png" src="../../_images/f23d3ff8c5936743e193393f499cca913f000e386c58eaebf510b96c1a27fd4c.png" />
<img alt="../../_images/181cc3dc58ac4a4b2aecf2ef6a679add0ec6e88d6901979082f27a7c4a9e6055.png" src="../../_images/181cc3dc58ac4a4b2aecf2ef6a679add0ec6e88d6901979082f27a7c4a9e6055.png" />
<div class="output text_html"><style type="text/css">
#T_8490c th.col_heading {
  text-align: center;
}
#T_8490c_row0_col0, #T_8490c_row0_col1, #T_8490c_row0_col2, #T_8490c_row0_col8, #T_8490c_row0_col9, #T_8490c_row1_col8, #T_8490c_row2_col3 {
  font-weight: bold;
  text-align: center;
}
#T_8490c_row0_col3, #T_8490c_row0_col4, #T_8490c_row0_col5, #T_8490c_row0_col6, #T_8490c_row0_col7, #T_8490c_row0_col10, #T_8490c_row0_col11, #T_8490c_row1_col0, #T_8490c_row1_col1, #T_8490c_row1_col2, #T_8490c_row1_col3, #T_8490c_row1_col4, #T_8490c_row1_col5, #T_8490c_row1_col6, #T_8490c_row1_col7, #T_8490c_row1_col9, #T_8490c_row1_col10, #T_8490c_row1_col11, #T_8490c_row2_col0, #T_8490c_row2_col1, #T_8490c_row2_col2, #T_8490c_row2_col4, #T_8490c_row2_col5, #T_8490c_row2_col6, #T_8490c_row2_col7, #T_8490c_row2_col8, #T_8490c_row2_col9, #T_8490c_row2_col10, #T_8490c_row2_col11 {
  text-align: center;
}
</style>
<table id="T_8490c">
  <caption>Filtered Chlorophyll-a Trends (μg m⁻³ month⁻¹)</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_8490c_level0_col0" class="col_heading level0 col0" >Jan</th>
      <th id="T_8490c_level0_col1" class="col_heading level0 col1" >Feb</th>
      <th id="T_8490c_level0_col2" class="col_heading level0 col2" >Mar</th>
      <th id="T_8490c_level0_col3" class="col_heading level0 col3" >Apr</th>
      <th id="T_8490c_level0_col4" class="col_heading level0 col4" >May</th>
      <th id="T_8490c_level0_col5" class="col_heading level0 col5" >Jun</th>
      <th id="T_8490c_level0_col6" class="col_heading level0 col6" >Jul</th>
      <th id="T_8490c_level0_col7" class="col_heading level0 col7" >Aug</th>
      <th id="T_8490c_level0_col8" class="col_heading level0 col8" >Sep</th>
      <th id="T_8490c_level0_col9" class="col_heading level0 col9" >Oct</th>
      <th id="T_8490c_level0_col10" class="col_heading level0 col10" >Nov</th>
      <th id="T_8490c_level0_col11" class="col_heading level0 col11" >Dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_8490c_level0_row0" class="row_heading level0 row0" >IO_POOZ</th>
      <td id="T_8490c_row0_col0" class="data row0 col0" >1.7790
 (0.0235)</td>
      <td id="T_8490c_row0_col1" class="data row0 col1" >1.3479
 (0.0003)</td>
      <td id="T_8490c_row0_col2" class="data row0 col2" >1.0629
 (0.0041)</td>
      <td id="T_8490c_row0_col3" class="data row0 col3" >na</td>
      <td id="T_8490c_row0_col4" class="data row0 col4" >na</td>
      <td id="T_8490c_row0_col5" class="data row0 col5" >na</td>
      <td id="T_8490c_row0_col6" class="data row0 col6" >na</td>
      <td id="T_8490c_row0_col7" class="data row0 col7" >na</td>
      <td id="T_8490c_row0_col8" class="data row0 col8" >0.9638
 (0.0001)</td>
      <td id="T_8490c_row0_col9" class="data row0 col9" >0.6180
 (0.0320)</td>
      <td id="T_8490c_row0_col10" class="data row0 col10" >0.4780
 (0.3812)</td>
      <td id="T_8490c_row0_col11" class="data row0 col11" >1.3382
 (0.1095)</td>
    </tr>
    <tr>
      <th id="T_8490c_level0_row1" class="row_heading level0 row1" >PO_POOZ</th>
      <td id="T_8490c_row1_col0" class="data row1 col0" >0.7043
 (0.5661)</td>
      <td id="T_8490c_row1_col1" class="data row1 col1" >-0.2822
 (0.4874)</td>
      <td id="T_8490c_row1_col2" class="data row1 col2" >0.1760
 (0.5260)</td>
      <td id="T_8490c_row1_col3" class="data row1 col3" >na</td>
      <td id="T_8490c_row1_col4" class="data row1 col4" >na</td>
      <td id="T_8490c_row1_col5" class="data row1 col5" >na</td>
      <td id="T_8490c_row1_col6" class="data row1 col6" >na</td>
      <td id="T_8490c_row1_col7" class="data row1 col7" >na</td>
      <td id="T_8490c_row1_col8" class="data row1 col8" >0.5096
 (0.0201)</td>
      <td id="T_8490c_row1_col9" class="data row1 col9" >0.2187
 (0.3812)</td>
      <td id="T_8490c_row1_col10" class="data row1 col10" >0.8796
 (0.0852)</td>
      <td id="T_8490c_row1_col11" class="data row1 col11" >0.7861
 (0.6077)</td>
    </tr>
    <tr>
      <th id="T_8490c_level0_row2" class="row_heading level0 row2" >AO_POOZ</th>
      <td id="T_8490c_row2_col0" class="data row2 col0" >-0.1337
 (1.0000)</td>
      <td id="T_8490c_row2_col1" class="data row2 col1" >1.2132
 (0.6077)</td>
      <td id="T_8490c_row2_col2" class="data row2 col2" >0.5293
 (0.4503)</td>
      <td id="T_8490c_row2_col3" class="data row2 col3" >1.3570
 (0.0372)</td>
      <td id="T_8490c_row2_col4" class="data row2 col4" >na</td>
      <td id="T_8490c_row2_col5" class="data row2 col5" >na</td>
      <td id="T_8490c_row2_col6" class="data row2 col6" >na</td>
      <td id="T_8490c_row2_col7" class="data row2 col7" >na</td>
      <td id="T_8490c_row2_col8" class="data row2 col8" >0.1215
 (0.7398)</td>
      <td id="T_8490c_row2_col9" class="data row2 col9" >-1.2910
 (0.2906)</td>
      <td id="T_8490c_row2_col10" class="data row2 col10" >1.0990
 (0.4874)</td>
      <td id="T_8490c_row2_col11" class="data row2 col11" >-0.3304
 (0.9759)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p><strong>Chlorophyll-a spatial distribution:</strong></p>
<p>The mean availability of valid chlorophyll-a  pixels over the 21-year period analysed is approximately 8% over the entire POOZ, indicating limited dataset coverage that may not fully capture the spatial variability of chlorophyll-a distribution in this region. A small difference in the number of valid pixels is observed across the three POOZ sectors: the PO_POOZ exhibits the greatest availability (9.5%), followed by the AO_POOZ (8.3%) and the IO_POOZ (7.3%). A significant number of valid pixels (above 30%) are detected off the southeastern coasts of South America. Therefore, the representation of the spatial distribution of chlorophyll-a in this area can be assumed to be more reliable than elsewhere in the POOZ.<br />
Different average chlorophyll-a concentrations are observed in the three POOZ sectors: the AO_POOZ sector is the less oligotrophic with an average value of about 0.2 mg m<sup>-3</sup>, whereas the IO_POOZ and PO_POOZ are characterised by lower averages (0.12 and 0.14 mg m<sup>-3</sup>, respectively), confirming what reported in previous studies (e.g., <a class="reference external" href="https://doi.org/10.1029/2019GL083163">[8]</a>). While the subregional variability in terms of valid pixels likely depends on differences in sea ice extent and cloud coverage across the three POOZ sectors, differences in their average chlorophyll-a concentration are due to several key factors, such as nutrient supply through Patagonian dust deposition and/or upwelling (e.g., <a class="reference external" href="https://doi.org/10.1029/2006jc004072">[11]</a> <a class="reference external" href="https://doi.org/10.5670/oceanog.2018.408">[12]</a> <a class="reference external" href="https://doi.org/10.3389/fmars.2024.1363088">[13]</a>).</p>
<p><strong>Chlorophyll-a temporal distribution:</strong></p>
<p>The monthly climatological distribution of valid chlorophyll-a pixels is in line with expectations based on their dependence on the solar zenith angle: the highest percentage (up to about 15%) is observed between November and February, when the solar zenith angle is low, then it decreases to reach its minimum (almost 0%) during the polar night months (i.e. May-July) and gradually increases again towards the end of the year. It is interesting to note that, as shown in the valid pixel heatmap, the valid percentages increased between 2017 and 2019, reaching a maximum in 2018 (up to about 24%), when the highest number of observing systems were operational (i.e., MODIS-Aqua, VIIRS, OLCI-3A, and OLCI-3B)
(<a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[1]</a>).<br />
Filtering chlorophyll-a data based on the availability of valid pixels allows to reduce the bias resulting from the lack of sampling at high latitudes, which leads to artefacts in the apparent seasonal cycle from ocean colour sensors <a class="reference external" href="https://doi.org/10.1016/j.rse.2007.03.008">[14]</a>. However, the temporal distribution for the filtered chlorophyll-a data alignes with typical observations in the Southern Ocean, where chlorophyll-a concentrations decrease during the austral winter (e.g., <a class="reference external" href="https://doi.org/10.1038/s41467-020-19157-2">[15]</a>).<br />
Linear trend analysis for all months in all three POOZ sectors yields to results summarised in the table, indicating an overall chlorophyll-a increase in the POOZ, consistent with previous studies (e.g., <a class="reference external" href="https://doi.org/10.1029/2019GL083163">[8]</a>; <a class="reference external" href="https://doi.org/10.1016/j.marenvres.2024.106856">[16]</a>). However, these trends should be interpreted with caution, as they are based on a low percentage of valid pixels (i.e., 8-15%). Including data prior to 2003 in the analysis would not change the sign of the significant chlorophyll-a trends but could affect their statistical significance.<br />
Overall, the results indicate that the dataset remains valuable for biogeochemical calibration and validation in the Southern Ocean during months with reliable observations (September to April). In contrast, using data from the local winter (May-August), when satellite-derived chlorophyll-a concentrations have been shown to be overestimated <a class="reference external" href="https://doi.org/10.1016/j.rse.2007.03.008">[14]</a>, could lead to biased model parameterisation. This in turn may result in inflated estimates of primary production and carbon fluxes, as well as a misrepresentation of the ecosystem functioning, including nutrient cycling and grazing pressure. To address these issues, chlorophyll-a data should be filtered based on the availability of valid pixels used for their retrieval and corrected using in situ measurements (e.g., Argo floats, ship-based observations), or through assimilation techniques that incorporate satellite chlorophyll-a data from reliable seasons, enabling the model to estimate missing data based on physical and biogeochemical constraints.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>CDS catalogue entry used in this notebook is the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-ocean-colour?tab=overview">Ocean colour daily data from 1997 to present derived from satellite observations</a></p></li>
<li><p>Data download is from <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-ocean-colour?tab=form">CDS</a></p></li>
<li><p>Product Documentation is available on the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-ocean-colour?tab=documentation">CDS</a> website</p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
<p>Further readings:</p>
<ul class="simple">
<li><p>Ocean Colour Monitoring Portals: <a class="reference external" href="https://marine.copernicus.eu/">CMEMS</a>, <a class="reference external" href="https://hermes.acri.fr">ESA-GlobColour Project</a>, <a class="reference external" href="https://climate.esa.int/en/projects/ocean-colour/">ESA-OC-CCI</a>, <a class="reference external" href="https://sentiwiki.copernicus.eu/web/s3-mission">ESA-Sentinel 3</a>, <a class="reference external" href="https://imos.org.au/facility/satellite-remote-sensing/ocean-colour">IMOS</a>, <a class="reference external" href="https://oceancolor.gsfc.nasa.gov/#">NASA</a>, <a class="reference external" href="https://coastwatch.noaa.gov/cwn/index.html">NOAA CoastWatch</a></p></li>
<li><p>Use cases: <a class="reference external" href="https://user.eumetsat.int/search-view?sort=startDate%20desc&amp;amp;facets=%7B%22theme%22:%5B%22Marine%7COcean%20biogeochemistry%22%5D,%22contentTypes%22:%5B%22Resources%7CCase%20studies%22%5D%7D">EUMETSAT</a>, <a class="reference external" href="https://climate.copernicus.eu/ocean">C3S</a></p></li>
<li><p>Groom, S., et al. (2019). <a class="reference external" href="https://www.frontiersin.org/journals/marine-science/articles/10.3389/fmars.2019.00485/full">Satellite Ocean Colour: Current Status and Future Perspective</a>. Frontiers in Marine Science, 6.</p></li>
<li><p><a class="reference external" href="https://ioccg.org/">International Ocean Colour Coordinating Group (ICCG)</a></p></li>
<li><p><a class="reference external" href="https://soccom.princeton.edu">Southern Ocean Carbon and Climate Observations and Modeling (SOCCOM)</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[1]</a> Jackson, T., et al. (2023). C3S Ocean Colour Version 6.0: Product User Guide and Specification. Issue 1.1. E.U. Copernicus Climate Change Service. Document ref. WP2-FDDP-2022-04_C3S2-Lot3_PUGS-of-v6.0-OceanColour-product.</p>
<p><a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-ocean-colour/v6.0/WP2-FDDP-2022-04_C3S2-Lot3_ATBD-of-v6.0-OceanColour-product_v1.1_FINAL.pdf">[2]</a> Jackson, T., et al. (2022). C3S Ocean Colour Version 6.0: Algorithm Theoretical Basis Document. Issue 1.1. E.U. Copernicus Climate Change Service. Document ref. WP2-FDDP-2022-04_C3S2-Lot3_ATBD-of-v6.0-OceanColour-product.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.jmarsys.2013.02.007">[3]</a> Doron, M., Brasseur, P., Brankart, J.-M., Losa, S.N., &amp; Melet, A. (2013). Stochastic estimation of biogeochemical parameters from Globcolour ocean colour satellite data in a North Atlantic 3D ocean coupled physical–biogeochemical model. Journal of Marine Systems, 117-118, 91-95.</p>
<p><a class="reference external" href="https://doi.org/10.3390/rs10101666">[4]</a> Sammartino, M., Marullo, S., Santoleri, R., &amp; Scardi, M. (2018). Modelling the Vertical Distribution of Phytoplankton Biomass in the Mediterranean Sea from Satellite Data: A Neural Network Approach. Remote Sensing, 10(10), 1666.</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41467-019-08457-x">[5]</a> Dutkiewicz, S., Hickman, A.E., Jahn, O., Henson, S., Beaulieu, C., &amp; Monier, E. (2019) Ocean colour signature of climate change. Nature Communications, 10, 578.</p>
<p><a class="reference external" href="https://doi.org/10.1029/2018JC014329">[6]</a> Pradhan, H.K., Völker, C., Losa, S. N., Bracher, A., &amp; Nerger, L. (2019). Assimilation of global total chlorophyll OC-CCI data and its impact on individual phytoplankton fields. Journal of Geophysical Research: Oceans, 124, 470-490.</p>
<p><a class="reference external" href="https://doi.org/10.1016/0967-0637%2895%2900021-W">[7]</a> Orsi, A.H., Whitworth, T., &amp; Nowlin, W.D. (1995). On the meridional extent and fronts of the Antarctic Circumpolar Current. Deep Sea Research Part I: Oceanographic Research Papers, 42(5), 641-673.</p>
<p><a class="reference external" href="https://doi.org/10.1029/2019GL083163">[8]</a> Del Castillo, C.E., Signorini, S.R., Karaköylü, E.M., &amp; Rivero-Calle, S. (2019). Is the Southern Ocean Getting Greener? Geophysical Research Letters, 46, 6034-6040.</p>
<p><a class="reference external" href="https://doi.org/10.1029/95JC00458">[9]</a> Campbell, J.W. (1995). The lognormal distribution as a model for bio-optical variability in the sea. Journal of Geophysical Research, 100, 13237-13254.</p>
<p><a class="reference external" href="https://doi.org/10.3390/s19194285">[10]</a> Sathyendranath, S., et al. (2019). An Ocean-Colour time series for use in climate studies: the experience of the Ocean-Colour Climate Change Initiative (OC-CCI). Sensors, 19, 4285.</p>
<p><a class="reference external" href="https://doi.org/10.1029/2006jc004072">[11]</a> Sokolov, S., &amp; Rintoul, S.R. (2007). On the relationship between fronts of the Antarctic Circumpolar Current and surface chlorophyll concentrations in the Southern Ocean, Journal of Geophysical Research, 112, C07030.</p>
<p><a class="reference external" href="https://doi.org/10.5670/oceanog.2018.408">[12]</a> Paparazzo, F.E., Crespi-Abril, A.C., Gonçalves,  R.J., Barbieri, E.S., Gracia Villalobos, L.L., Solís, M.E., &amp; Soria, G. (2018). Patagonian dust as a source of macronutrients in the Southwest Atlantic Ocean. Oceanography, 31(4), 33-39.</p>
<p><a class="reference external" href="https://doi.org/10.3389/fmars.2024.1363088">[13]</a> Demasy, C., Boye, M., Lai, B., Burckel, P., Feng, Y., Losno, R., Borensztajn, S., &amp; Besson, P. (2024). Iron dissolution from Patagonian dust in the Southern Ocean: under present and future conditions. Frontiers in Marine Science, 11, 1363088.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.rse.2007.03.008">[14]</a> Gregg, W.W., &amp; Casey, N.W. (2007). Sampling biases in MODIS and SeaWiFS ocean chlorophyll data. Remote Sensing of Environment, 111(1), 25-35.</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41467-020-19157-2">[15]</a> Arteaga, L.A., Boss, E., Behrenfeld, M.J., Westberry, T.K., &amp; Sarmiento, J.L. (2020). Seasonal modulation of phytoplankton biomass in the Southern Ocean. Nature Communications, 11, 5364.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.marenvres.2024.106856">[16]</a> Venegas, R.M., Rivas, D., &amp; Treml, E. (2025).  Global climate-driven sea surface temperature and chlorophyll dynamics. Marine Environmental Research, 204, 106856</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ocean.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
    </a>
    <a class="right-next"
       href="../../In_Situ/insitu.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Insitu Observations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-phytoplankton-dynamics-in-the-southern-ocean">🌍 Use case: <em>Monitoring phytoplankton dynamics in the Southern Ocean</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters-to-be-analysed-time-period-variables-regions-and-data-request">Define parameters to be analysed (time period, variables, regions) and data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-functions-and-data-retrieval">2. Transform functions and data retrieval</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-transform-functions">Define transform functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">Data retrieval</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-function-and-trends-calculation">3. Mapping function and trends calculation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-mapping-function">Define mapping function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-trends">Compute trends</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#display-and-discuss-results">4. Display and discuss results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-results">Display results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>