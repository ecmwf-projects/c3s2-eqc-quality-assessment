
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Assessment of the consistency of surface albedo satellite data for monitoring the Caspian Sea retreat &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_consistency-assessment_q03';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Assessment of the consistency of surface albedo satellite data for monitoring the Caspian Sea retreat</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_consistency-assessment_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_consistency-assessment_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessment of the consistency of surface albedo satellite data for monitoring the Caspian Sea retreat</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-estimating-caspian-sea-retreat-over-time">üåç Use case: Estimating Caspian Sea retreat over time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">üì¢ Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-relevant-packages">Import all the relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-temporal-and-spatial-parameters">Define temporal and spatial parameters</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval-and-processing">2. Data retrieval and processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">3. Plot and describe the results.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-study-region-map-of-selected-area">Plot Study Region (Map of Selected Area)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-albedo-and-lake-water-depression-relative-to-the-geoid">Time series of albedo and lake water depression relative to the Geoid</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-time-series-panel-plot-of-albedo-and-lake-water-height">Seasonal time series panel plot of Albedo and Lake Water Height</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-plots-of-the-summer-surface-albedo-in-different-periods">Map plots of the summer surface albedo in different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-count-analysis-of-albedo-map-plots-summer-2006-vs-2019">Pixel count analysis of albedo map plots ‚Äì Summer 2006 vs 2019</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-albedo-change-map-2019-2006">Plot albedo change map (2019 ‚àí 2006)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">4. Main takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="assessment-of-the-consistency-of-surface-albedo-satellite-data-for-monitoring-the-caspian-sea-retreat">
<h1><span class="section-number">1.2.1. </span>Assessment of the consistency of surface albedo satellite data for monitoring the Caspian Sea retreat<a class="headerlink" href="#assessment-of-the-consistency-of-surface-albedo-satellite-data-for-monitoring-the-caspian-sea-retreat" title="Link to this heading">#</a></h1>
<p>¬†</p>
<p>Production date: 30-09-2024</p>
<p>Produced by: Consiglio Nazionale delle Ricerche (<a class="reference external" href="https://www.cnr.it/en" rel="noreferrer" target="_blank">CNR</a>
)</p>
<section id="use-case-estimating-caspian-sea-retreat-over-time">
<h2>üåç Use case: Estimating Caspian Sea retreat over time<a class="headerlink" href="#use-case-estimating-caspian-sea-retreat-over-time" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>‚Ä¢ Can satellite albedo datasets be used to study the retreat of the Caspian Sea basin?</strong></p>
<p>The Caspian Sea, the world‚Äôs largest inland water body, has been experiencing a significant decline in water levels in recent decades. Projections indicate that the sea could shrink by 9 to 18 meters by the end of the century [1], posing severe risks to regional ecosystems, food security, and livelihoods, and potentially triggering socio-economic disruptions and geopolitical tensions [2, 3]. Understanding and monitoring this retreat is, therefore, a critical task. The northeastern Caspian is an area with extremely shallow bathymetry (typically less than 1‚Äâm), consisting of extensive reed beds, sandbanks, muddy shoals, and water channels [4]. In winter, ice often forms over the lake‚Äôs northernmost reaches, while the central and southern parts remain ice-free. The extreme climate of the Caspian Sea, characterized by cold winters and temperatures as low as -30¬∞C, creates challenging working conditions for marine navigation and infrastructure. The shallow waters of the northern Caspian Sea easily freeze and are potentially covered with ice more than half a meter thick from November to late March.</p>
<p>In this assessment, we evaluate the consistency and suitability of the surface albedo dataset from the CDS satellite albedo product for the monitoring of the retreat of the Caspian Sea along its northern coast: satellite-albedo (Version v2), which provides 10-daily, 1 km resolution broadband albedo derived from SPOT-VGT and PROBA-V missions. Albedo has been increasingly recognized as a valuable indicator for monitoring lake and environmental changes. For example, Motlagh and Darand (2023) applied remote sensing to detect albedo trends over Iran, linking reductions in albedo in highland areas to declining snow cover and associated hydrological risks [5].</p>
<p>The lake water surface height dataset, satellite-lake-water-level (version 4.0), is used as a supporting reference to examine whether the temporal variability in surface albedo captures physical signals and hydrological changes associated with the retreat of the Caspian Sea.</p>
<p>This study specifically investigates the hypothesis that a substantial decrease in lake water level leads to a corresponding increase in surface albedo, potentially due to the exposure of the lakebed or the emergence of vegetation in shallow areas. This relationship, initially proposed by Chen et al. (2017), who documented an approximately 1.5 m decline in lake level between 1996 and 2021, is examined here through a focused analysis of surface albedo variability in response to seasonal changes [6].</p>
<p>Results indicate that the C3S 10-daily gridded surface albedo dataset effectively captures the effects of lake level decline, reflecting inter-seasonal variability that is consistent with observed changes in water surface height. This supports its suitability for long-term monitoring of hydrological and surface condition changes in the region.</p>
</section>
<section id="quality-assessment-statements">
<h2>üì¢ Quality assessment statements<a class="headerlink" href="#quality-assessment-statements" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The CDS 10-daily surface albedo dataset (v2) successfully captures hydrological changes linked to the Caspian Sea‚Äôs retreat.</p></li>
<li><p>Seasonal patterns in surface albedo are evident and consistent. Winter and spring show a decline in peak albedo values, likely due to reduced ice depth beneath the frozen lake surface and to the early ice melt. This seasonal ice loss and summer water level decline are likely influenced by rising regional temperatures and reduced snowfall (Motlagh &amp; Darand, 2023) [5].</p></li>
<li><p>Since 2016, summer albedo values have increased, coinciding with a drop in lake levels and the exposure of brighter dry lakebeds and submerged vegetation. Autumn follows a similar pattern with smaller changes.</p></li>
<li><p>These seasonal and interannual trends in surface albedo are consistent with independent studies (Akbari et al., 2022; Lahijani et al., 2023), which also report an overall long-term decline in Caspian Sea water levels.</p></li>
<li><p>The estimated ~1.5 m drop in water level between 1996 and 2021 (approximately 7 cm/year), with accelerated retreat rates (~10 cm/year) from 2006 to 2021 (Chen et al., 2017; Samant and Prange, 2023), is in line with the observed changes in surface albedo.</p></li>
<li><p>This assessment confirms that CDS (Copernicus Data Store) surface albedo can be used to monitor lake water retreat and to quantify the extent of areas where the water becomes shallow or the lake has dried up.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This assessment has two main goals:</p>
<ul class="simple">
<li><p>To evaluate the spatial and temporal consistency of satellite-derived surface albedo values with the documented lowering and retreat of water along the northern Caspian Sea coast;</p></li>
<li><p>To explore whether seasonal and interannual changes in surface albedo correspond to lake water retreat, using satellite-derived lake water height.</p></li>
</ul>
<p>The methodology adopted for the analysis is split into the following steps:</p>
<p><a class="reference internal" href="#satellite-satellite-albedo-consistency-assessment-q03-section-1"><span class="std std-ref">1. Choose the data to use and set up the code</span></a></p>
<ul class="simple">
<li><p>Import all the relevant packages.</p></li>
<li><p>Define temporal and spatial parameters</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-albedo-consistency-assessment-q03-section-2"><span class="std std-ref">2. Data retrieval and processing</span></a></p>
<p><a class="reference internal" href="#satellite-satellite-albedo-consistency-assessment-q03-section-3"><span class="std std-ref">3. Plot and describe the results.</span></a></p>
<ul class="simple">
<li><p>Plot Study Region (Map of Selected Area)</p></li>
<li><p>Time series of albedo and lake water depression relative to the Geoid</p></li>
<li><p>Seasonal time series panel plot of Albedo and Lake Water Height</p></li>
<li><p>Map plots of the summer surface albedo in different periods</p></li>
<li><p>Pixel count analysis of albedo map plots ‚Äì Summer 2006 vs 2019</p></li>
<li><p>Plot albedo change map (2019 ‚àí 2006)</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-albedo-consistency-assessment-q03-section-4"><span class="std std-ref">4. Main takeaways</span></a></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-albedo-consistency-assessment-q03-section-1"></span><h3>1. Choose the data to use and set up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-the-relevant-packages">
<h4>Import all the relevant packages<a class="headerlink" href="#import-all-the-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages required to run the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">TwoSlopeNorm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-temporal-and-spatial-parameters">
<h4>Define temporal and spatial parameters<a class="headerlink" href="#define-temporal-and-spatial-parameters" title="Link to this heading">#</a></h4>
<p>This analysis uses surface albedo data (2006‚Äì2020) and lake water level data (v4.0) to assess whether albedo changes reflect the Caspian Sea‚Äôs retreat. The northern basin was selected due to its greater vulnerability to water level decline, as highlighted by Court et al. (2025) [4], who report that this region, with average depths of only ~5 meters, has already experienced shoreline regression exceeding 56 km and a 46% loss in surface water area between 2001 and 2024. Seasonal variations in surface albedo and water level are compared to evaluate the agreement between datasets in capturing shallow-water dynamics and lake desiccation processes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-albedo&quot;</span>
<span class="n">collection_id_lake</span> <span class="o">=</span> <span class="s2">&quot;satellite-lake-water-level&quot;</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;albb_bh&quot;</span><span class="p">,</span>
    <span class="s2">&quot;product_version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;nominal_day&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">47.5</span><span class="p">,</span> <span class="mf">48.53</span><span class="p">,</span> <span class="mf">45.04</span><span class="p">,</span> <span class="mf">53.71</span><span class="p">],</span>  <span class="c1"># [north, west, south, east]</span>
<span class="p">}</span>

<span class="n">requests</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;spot&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2014</span><span class="p">)],</span> <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span> <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">},</span>
    <span class="s2">&quot;proba&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">2021</span><span class="p">)],</span> <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span> <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">request_lake</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;water_surface_height_above_reference_datum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;version_4_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake&quot;</span><span class="p">:</span> <span class="s2">&quot;caspian&quot;</span><span class="p">,</span>
    <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="s2">&quot;southwestern_asia&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-retrieval-and-processing">
<span id="satellite-satellite-albedo-consistency-assessment-q03-section-2"></span><h3>2. Data retrieval and processing<a class="headerlink" href="#data-retrieval-and-processing" title="Link to this heading">#</a></h3>
<p>In this section, satellite-derived albedo and lake water height data were retrieved, processed, and prepared for analysis. Using predefined request parameters for multiple satellite sources (e.g., SPOT and PROBA), spatial and temporal datasets were downloaded using the download_and_transform function. Temporal processing involved calculating time-weighted means and spatially averaged time series. Concurrently, lake level data was retrieved and subset to the period 2006‚Äì2020. Both albedo and lake height time series were merged on a monthly basis and grouped by season and year to calculate seasonal averages. A function (get_season) was defined to map months to meteorological seasons (SON, DJF, MAM, JJA). Additionally, 10-day surface albedo data from 2006 and 2019 was downloaded to compare the spatial distribution of albedo across the study area in different years.</p>
<p>To ensure the reliability of the surface albedo analysis, quality control filtering was applied based on the dataset‚Äôs quality flags. Specifically, pixels flagged as having missing input data (Bit 4) or algorithm failure (Bit 7) were excluded. Bit 4 identifies cases where the input data was insufficient, such as due to cloud cover or poor observation conditions, while Bit 7 indicates that the albedo retrieval algorithm failed to produce a valid result. By removing pixels where either of these flags was set, the analysis retains only those values derived from complete and successfully processed input.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">satellite</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">maps</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">common_request</span> <span class="o">|</span> <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">,</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">],</span>
    <span class="p">)</span>

   
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">common_request</span> <span class="o">|</span> <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>

    
    <span class="n">albedo</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span>
    <span class="n">qflag</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;QFLAG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    
    <span class="c1"># Apply bitmask filters</span>
    <span class="n">input_ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">qflag</span> <span class="o">&amp;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>        <span class="c1"># bit 4 - missing input</span>
    <span class="n">processing_ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">qflag</span> <span class="o">&amp;</span> <span class="mi">128</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>  <span class="c1"># Bit 7</span>

    <span class="n">valid_mask</span> <span class="o">=</span> <span class="n">input_ok</span> <span class="o">&amp;</span> <span class="n">processing_ok</span>
    <span class="n">albedo_filtered</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">valid_mask</span><span class="p">)</span>

    <span class="c1"># Count pixels before/after filtering</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">albedo</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">albedo_filtered</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">satellite</span><span class="si">}</span><span class="s2"> ‚Äì valid before: </span><span class="si">{</span><span class="n">before</span><span class="si">}</span><span class="s2">, after: </span><span class="si">{</span><span class="n">after</span><span class="si">}</span><span class="s2">, removed: </span><span class="si">{</span><span class="n">before</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">after</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">before</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">after</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">before</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>


    
    <span class="n">albedo_mean</span> <span class="o">=</span> <span class="n">albedo_filtered</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds_filtered</span> <span class="o">=</span> <span class="n">albedo_mean</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">)</span>

    <span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_filtered</span><span class="p">)</span>

<span class="n">ds_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="n">ds_lake</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id_lake</span><span class="p">,</span> <span class="n">request_lake</span><span class="p">)</span>
<span class="n">ds_lake_subset</span> <span class="o">=</span> <span class="n">ds_lake</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2006-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-06-30&quot;</span><span class="p">))</span>


<span class="n">lake_data</span> <span class="o">=</span> <span class="n">ds_lake_subset</span><span class="p">[</span><span class="s2">&quot;water_surface_height_above_reference_datum&quot;</span><span class="p">]</span>
<span class="n">df_lake</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">lake_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">lake_data</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
<span class="n">df_lake</span><span class="p">[</span><span class="s2">&quot;month_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lake</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="n">df_lake</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_lake</span><span class="p">[</span><span class="s2">&quot;month_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>


<span class="n">albedo_filtered</span> <span class="o">=</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span>
<span class="n">df_albedo</span> <span class="o">=</span> <span class="n">albedo_filtered</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df_albedo</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_albedo</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
<span class="n">df_albedo</span><span class="p">[</span><span class="s2">&quot;month_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_albedo</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>


<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_lake</span><span class="p">,</span> <span class="n">df_albedo</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;month_time&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s2">&quot;month_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_season</span><span class="p">(</span><span class="n">month</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span> <span class="k">return</span> <span class="s2">&quot;Winter&quot;</span>
    <span class="k">elif</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span> <span class="k">return</span> <span class="s2">&quot;Spring&quot;</span>
    <span class="k">elif</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span> <span class="k">return</span> <span class="s2">&quot;Summer&quot;</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;Autumn&quot;</span>

<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_season</span><span class="p">)</span>
<span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[</span><span class="s1">&#39;month_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>


<span class="n">seasonal_avg</span> <span class="o">=</span> <span class="n">df_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;season&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;AL_BH_BB&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
<span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>



<span class="c1"># Request setup for SPOT (2006) and PROBA (2019) , only for spatial maps</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-albedo&quot;</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">spatial_common</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;albb_bh&quot;</span><span class="p">,</span>
    <span class="s2">&quot;product_version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;nominal_day&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">47.5</span><span class="p">,</span> <span class="mf">48.53</span><span class="p">,</span> <span class="mf">45.04</span><span class="p">,</span> <span class="mf">53.71</span><span class="p">],</span>  <span class="c1"># Study area</span>
<span class="p">}</span>

<span class="n">spatial_requests</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;spot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2006&quot;</span><span class="p">],</span>
        <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;spot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;proba&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2019&quot;</span><span class="p">],</span>
        <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;proba&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">spatial_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> data for spatial map...&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">spatial_common</span> <span class="o">|</span> <span class="n">req</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>satellite=&#39;spot&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 8/8 [00:00&lt;00:00, 19.72it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/readers/netcdf/fieldlist.py:202: FutureWarning: In a future version of xarray the default value for data_vars will change from data_vars=&#39;all&#39; to data_vars=None. This is likely to lead to different results when multiple datasets have matching variables with overlapping values. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set data_vars explicitly.
  return xr.open_mfdataset(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>spot ‚Äì valid before: 15335131, after: 15329088, removed: 6043 (0.0%)
satellite=&#39;proba&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 7/7 [00:00&lt;00:00, 115.63it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/readers/netcdf/fieldlist.py:202: FutureWarning: In a future version of xarray the default value for data_vars will change from data_vars=&#39;all&#39; to data_vars=None. This is likely to lead to different results when multiple datasets have matching variables with overlapping values. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set data_vars explicitly.
  return xr.open_mfdataset(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>proba ‚Äì valid before: 12485442, after: 12485222, removed: 220 (0.0%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00,  6.77it/s]
                                     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading spot data for spatial map...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00,  2.85it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading proba data for spatial map...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 99.29it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-and-describe-the-results">
<span id="satellite-satellite-albedo-consistency-assessment-q03-section-3"></span><h3>3. Plot and describe the results.<a class="headerlink" href="#plot-and-describe-the-results" title="Link to this heading">#</a></h3>
<section id="plot-study-region-map-of-selected-area">
<h4>Plot Study Region (Map of Selected Area)<a class="headerlink" href="#plot-study-region-map-of-selected-area" title="Link to this heading">#</a></h4>
<p>To provide spatial context for the analysis, the selected study region around the Caspian Sea is visualized on a geographic map. This plot illustrates the spatial extent used for both albedo and water level data extraction. The boundaries encompass part of the northern Caspian region, an area of particular concern due to its documented vulnerability to water level decline. This vulnerability, although observed at a broader scale, is exemplified by recent findings such as those reported by Court et al. (2025), which highlight the rapid decline of the Caspian Sea level and its potential consequences for ecosystem integrity, biodiversity, and human infrastructure.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BBOX</span> <span class="o">=</span> <span class="p">[</span><span class="mf">47.5</span><span class="p">,</span> <span class="mf">48.53</span><span class="p">,</span> <span class="mf">45.04</span><span class="p">,</span> <span class="mf">53.71</span><span class="p">]</span>   <span class="c1"># [N, W, S, E] in CDS order</span>
<span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">BBOX</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">box</span>
<span class="n">polygon</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>            <span class="c1"># (min_lon, min_lat, max_lon, max_lat)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="n">polygon</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                               <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="c1"># Whole Caspian context</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="mi">46</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mf">47.5</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Caspian Sea with Study Area Highlighted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Zoom to the new box</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">gdf</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Study Area near Northern Caspian Sea&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/dc41859944f9d58e3cab58ffe34477ef5c256d1eb94e249d4acbaaa1f8da470f.png" src="../../_images/dc41859944f9d58e3cab58ffe34477ef5c256d1eb94e249d4acbaaa1f8da470f.png" />
</div>
</div>
<p><em>Figure 1.</em> Maps of the Caspian Sea and the selected study region. Left: full Caspian Sea; Right: zoomed-in view of the northern section.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ds_timeseries</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Albedo&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Surface Albedo&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ds_lake_subset</span><span class="p">[</span><span class="s2">&quot;water_surface_height_above_reference_datum&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Water Height&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Water Height (m)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2005-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2012-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">]:</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/57f8c0cef823928eee938f09ee9a2ad14ac1de22c637a33672877b52cadea8ca.png" src="../../_images/57f8c0cef823928eee938f09ee9a2ad14ac1de22c637a33672877b52cadea8ca.png" />
</div>
</div>
</section>
<section id="time-series-of-albedo-and-lake-water-depression-relative-to-the-geoid">
<h4>Time series of albedo and lake water depression relative to the Geoid<a class="headerlink" href="#time-series-of-albedo-and-lake-water-depression-relative-to-the-geoid" title="Link to this heading">#</a></h4>
<p>In this section, the temporal evolution of two key environmental variables, surface albedo and lake water height, is illustrated through line plots. Monthly mean values are shown from 2006 to 2020, allowing for a direct comparison of trends and variability over time.</p>
<p><em>Figure 2.</em> Time Series of Surface Albedo and Lake Water depression to the Geoid (2006‚Äì2020).</p>
<ul class="simple">
<li><p>This plot shows the monthly time series of surface albedo and lake water height from 2006 to 2020. The continuous decrease in water height, combined with occasional step changes, is clearly identifiable, while albedo exhibits expected seasonal cycles. The albedo plot indicates that significant lake ice formation occurs in the selected region of the northern Caspian Sea during the winter months, as evidenced by the mean albedo reaching approximately 0.6. Ice extent evolution over the winter of 2006-2007 shows a smaller peak, due successive events of extensive freezing and melting throughout the season [7]. Albedo has not reached 0.6 since 2012, which suggests a less deep ice layer and less snowfall. This happens as the water‚Äôs surface height begins to decline.</p></li>
<li><p>Since 2016, the minimum albedo has increased, indicating that the lake water in the selected area has retreated and become shallow.</p></li>
</ul>
</section>
<section id="seasonal-time-series-panel-plot-of-albedo-and-lake-water-height">
<h4>Seasonal time series panel plot of Albedo and Lake Water Height<a class="headerlink" href="#seasonal-time-series-panel-plot-of-albedo-and-lake-water-height" title="Link to this heading">#</a></h4>
<p>To highlight seasonal dynamics, the time series data for both albedo and lake height are averaged by meteorological seasons‚Äî winter (DJF), spring (MAM), summer (JJA), and autumn (SON). These are presented as a panel of subplots, with each panel representing one season across multiple years. This layout facilitates the identification of consistent seasonal patterns, anomalies, and changes in behavior over time.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">season_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Winter&#39;</span><span class="p">,</span> <span class="s1">&#39;Spring&#39;</span><span class="p">,</span> <span class="s1">&#39;Summer&#39;</span><span class="p">,</span> <span class="s1">&#39;Autumn&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">season</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">season_order</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
    <span class="n">df_season</span> <span class="o">=</span> <span class="n">seasonal_avg</span><span class="p">[</span><span class="n">seasonal_avg</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">]</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">line1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_season</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">df_season</span><span class="p">[</span><span class="s1">&#39;AL_BH_BB&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Albedo&#39;</span><span class="p">)</span>
    <span class="n">line2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_season</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">df_season</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Water Height&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Albedo&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean Water Height (m)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># &lt;-- this line added</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    
   
    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        
        <span class="n">lines</span> <span class="o">=</span> <span class="n">line1</span> <span class="o">+</span> <span class="n">line2</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e0d26b683695d89414309587d11a64dba390423c9de91df2c515ab00e2d66fe2.png" src="../../_images/e0d26b683695d89414309587d11a64dba390423c9de91df2c515ab00e2d66fe2.png" />
</div>
</div>
<p><em>Figure 3.</em> Seasonal Average Albedo and Water Height per Year ‚Äì Caspian Sea Subregion.</p>
</section>
<section id="map-plots-of-the-summer-surface-albedo-in-different-periods">
<h4>Map plots of the summer surface albedo in different periods<a class="headerlink" href="#map-plots-of-the-summer-surface-albedo-in-different-periods" title="Link to this heading">#</a></h4>
<p>Summer spatial albedo maps are generated to better isolate the effects of seasonal water retreat. These targeted seasonal plots are particularly relevant, as summer represents a period of minimal snow cover, allowing for clearer detection of lakebed exposure and vegetation shifts.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only June, July, August</span>
<span class="n">spot_summer</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;spot&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;spot&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="n">proba_summer</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;proba&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;proba&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>

<span class="n">spot_summer_avg</span> <span class="o">=</span> <span class="n">spot_summer</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">proba_summer_avg</span> <span class="o">=</span> <span class="n">proba_summer</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="n">vmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">proba_summer_avg</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">proba_summer_avg</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                     <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Albedo&#39;</span><span class="p">})</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Summer Mean Albedo (SPOT - 2006)&quot;</span><span class="p">)</span>

<span class="n">proba_summer_avg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                      <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Albedo&#39;</span><span class="p">})</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Summer Mean Albedo (PROBA - 2019)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0714b3c72c6037baba8fea06c76fc9ee10ddffa25aa5340e2ab8f455c7b9a65d.png" src="../../_images/0714b3c72c6037baba8fea06c76fc9ee10ddffa25aa5340e2ab8f455c7b9a65d.png" />
</div>
</div>
<p><em>Figure 4.</em> Summer Albedo Maps ‚Äì Caspian Region (2006 vs 2019).</p>
<p>These plots provide a clearer view of the land‚Äìwater boundary during the driest part of the year, when the influence of snow and ice is minimal. The 2019 map reveals a noticeable increase in high-albedo areas compared to 2006, particularly near the northern shoreline. This change suggests exposure of dry lakebed or vegetated zones due to water level decline. By focusing on summer, these maps enhance the ability to detect and quantify the spatial extent of hydrological changes along the Caspian Sea‚Äôs northern coast.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="n">lon0</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">lat0</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span>  <span class="nb">float</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">pad</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">lon0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">+</span> <span class="n">pad</span><span class="p">]</span>

<span class="n">vmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>  <span class="n">proba_summer_avg</span><span class="o">.</span><span class="n">min</span><span class="p">()]))</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">spot_summer_avg</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">proba_summer_avg</span><span class="o">.</span><span class="n">max</span><span class="p">()]))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">proj</span><span class="p">},</span>
                         <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Figure-level title (above both panels)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Summer Mean Surface Albedo ‚Äî Left: 2006 (SPOT) | Right: 2019 (PROBA)&quot;</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.03</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">panel</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;0.25&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.14</span><span class="p">],</span>
                         <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;0.14&quot;</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="p">),</span> <span class="n">lon1</span><span class="o">-</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat1</span><span class="o">-</span><span class="n">lat0</span><span class="p">,</span>
                                   <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">))</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">im</span>

<span class="n">_</span>  <span class="o">=</span> <span class="n">panel</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">spot_summer_avg</span><span class="p">,</span>  <span class="s2">&quot;2006 (SPOT)&quot;</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">panel</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">proba_summer_avg</span><span class="p">,</span> <span class="s2">&quot;2019 (PROBA)&quot;</span><span class="p">)</span>

<span class="c1"># Shared colorbar for both panels</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Albedo&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/477b37117585455d63e71083ae7f112e4dc8af442a412e2d74637e3789ebbb74.png" src="../../_images/477b37117585455d63e71083ae7f112e4dc8af442a412e2d74637e3789ebbb74.png" />
</div>
</div>
<p><em>Figure 5.</em> Summer mean albedo over the northern Caspian (NE sector) study box (1 km):
Left: SPOT/VGT (2006); Right: PROBA-V (2019). Colors show broadband albedo (AL_BH_BB); the dashed rectangle is the data footprint used for the pixel analysis; coastlines outside the box provide shoreline context. The white contour (~0.14) marks a conservative threshold separating dark open water (&lt; 0.14) from brighter, non-water surfaces.</p>
</section>
<section id="pixel-count-analysis-of-albedo-map-plots-summer-2006-vs-2019">
<h4>Pixel count analysis of albedo map plots ‚Äì Summer 2006 vs 2019<a class="headerlink" href="#pixel-count-analysis-of-albedo-map-plots-summer-2006-vs-2019" title="Link to this heading">#</a></h4>
<p>To quantitatively assess the extent of surface changes associated with lake water retreat, a pixel-based threshold analysis was performed on the summer mean albedo maps for 2006 and 2019. Based on previous studies, such as Jia Du et al. (2023), an albedo threshold of 0.14 is a reasonable lower boundary to distinguish open water surfaces (typically &lt; 0.14) from brighter surfaces such as dry lakebeds, sediments, or emergent vegetation, which have higher reflectance [8].</p>
<p>Therefore, in our analysis, any pixel with albedo &gt; 0.14 is considered as indicating non-water surface (e.g., exposed land, shallow vegetated areas, or drying sediments).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">A</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">&quot;SPOT 2006&quot;</span><span class="p">,</span> <span class="n">spot_summer_avg</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;PROBA 2019&quot;</span><span class="p">,</span> <span class="n">proba_summer_avg</span><span class="p">)]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="s2">&quot;min/max/median:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="n">valid_spot</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">spot_summer_avg</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="p">(</span><span class="n">spot_summer_avg</span>  <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">spot_summer_avg</span>  <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">valid_proba</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">proba_summer_avg</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proba_summer_avg</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proba_summer_avg</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">spot_bright</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">((</span><span class="n">spot_summer_avg</span>  <span class="o">&gt;</span> <span class="mf">0.14</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">valid_spot</span><span class="p">)</span>
<span class="n">proba_bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">((</span><span class="n">proba_summer_avg</span> <span class="o">&gt;</span> <span class="mf">0.14</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">valid_proba</span><span class="p">)</span>

<span class="n">spot_total</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">valid_spot</span><span class="p">)</span>
<span class="n">proba_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">valid_proba</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2006 bright&gt;0.14: </span><span class="si">{</span><span class="n">spot_bright</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">spot_total</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">spot_bright</span><span class="o">/</span><span class="n">spot_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2019 bright&gt;0.14: </span><span class="si">{</span><span class="n">proba_bright</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">proba_total</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">proba_bright</span><span class="o">/</span><span class="n">proba_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SPOT 2006 min/max/median: 0.0125 0.40216663 0.066599995
PROBA 2019 min/max/median: 0.020166667 0.4499 0.1318
2006 bright&gt;0.14: 68761/160080 (42.95%)
2019 bright&gt;0.14: 79181/160079 (49.46%)
</pre></div>
</div>
</div>
</div>
<p>Applying a 0.14 albedo threshold to distinguish open water from brighter land or shallow-water surfaces, the analysis shows that in summer 2006, about 43% of the study area (68,761 out of 160,080 valid pixels) exceeded the threshold, while by 2019 this fraction had increased to nearly 49% (79,181 out of 160,079 pixels). This represents a +6.5 percentage point rise (‚âà15% relative), accompanied by a shift in the median albedo from 0.067 in 2006 to 0.132 in 2019. The results indicate a broad brightening of the surface, consistent with shoreline retreat and the progressive exposure of dry sediments or vegetation in the northern Caspian Sea.</p>
</section>
<section id="plot-albedo-change-map-2019-2006">
<h4>Plot albedo change map (2019 ‚àí 2006)<a class="headerlink" href="#plot-albedo-change-map-2019-2006" title="Link to this heading">#</a></h4>
<p>To visualize spatial changes in surface reflectance linked to lake water retreat, a difference map was generated by subtracting the 2006 summer mean albedo from that of 2019. Positive values (shown in green) represent areas where surface albedo increased over time, typically indicating newly exposed land, dry sediments, or vegetation colonization as water levels declined.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span> <span class="o">=</span> <span class="n">proba_summer_avg</span> <span class="o">-</span> <span class="n">spot_summer_avg</span>  <span class="c1"># 2019 ‚àí 2006</span>

<span class="n">norm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.10</span><span class="p">)</span>  <span class="c1"># symmetric around 0</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>


<span class="n">im</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;0.25&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat0</span><span class="p">),</span> <span class="n">lon1</span><span class="o">-</span><span class="n">lon0</span><span class="p">,</span> <span class="n">lat1</span><span class="o">-</span><span class="n">lat0</span><span class="p">,</span>
                               <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">))</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Œî Albedo (2019 ‚àí 2006) ‚Äî Summer&quot;</span><span class="p">)</span>


<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Albedo change&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c69608f670f7f03f5d4a1446755bdc8d981f034635252d0f5a680364503acc05.png" src="../../_images/c69608f670f7f03f5d4a1446755bdc8d981f034635252d0f5a680364503acc05.png" />
</div>
</div>
<p><em>Figure 6.</em> Summer albedo change (2019 ‚àí 2006) over the northern Caspian (NE sector) study box. Reds indicate brightening (higher albedo; likely exposed sediments/shallows), blues indicate darkening (lower albedo; more open water). The dashed rectangle marks the analysis footprint; coastlines provide shoreline context.</p>
<p>The summer albedo change map (2019 ‚àí 2006) highlights the spatial distribution of reflectance shifts along the southwestern Caspian shoreline. The dominant red tones along the coast mark areas of brightening, where surface albedo has increased by up to ~0.1. These zones correspond to regions where the shoreline has retreated, exposing reflective dry sediments, mudflats, or emergent vegetation. In contrast, the more limited blue patches offshore indicate localized darkening, associated with persistent open water or wetter surfaces. The strongest brightening appears in shallow nearshore zones, especially along the eastern and southeastern margins of the study area, consistent with documented lake-level decline and shoreline regression. Overall, the map provides clear spatial evidence of progressive lakebed exposure and hydrological transformation between 2006 and 2019, reinforcing the time-series and pixel-count analyses.</p>
</section>
</section>
<section id="main-takeaways">
<span id="satellite-satellite-albedo-consistency-assessment-q03-section-4"></span><h3>4. Main takeaways<a class="headerlink" href="#main-takeaways" title="Link to this heading">#</a></h3>
<p>‚Ä¢ The CDS surface albedo dataset shows temporal consistency with water level decline in the northern Caspian Sea and is suitable for monitoring long-term surface changes in this region.</p>
<p>‚Ä¢ Seasonal averages show a decline in winter and especially spring albedo, likely due to reduced ice cover.
Summer albedo rises noticeably after 2016, linked to falling water levels and exposure of dry or vegetated lakebed. Autumn shows a similar but smaller increase, reflecting shallower waters or surface changes from retreat.</p>
<p>‚Ä¢ A difference map and seasonal averages confirm that summer surface albedo increased from 2006 to 2019, especially near the shoreline, consistent with lakebed exposure due to water retreat.</p>
<p>‚Ä¢ Pixel-based analysis using an albedo threshold of 0.14 shows that the fraction of bright surfaces increased from ~43% in summer 2006 to ~49% in summer 2019 (a rise of about 6.5 percentage points, or ~15% relative). This confirms a substantial expansion of exposed or transformed surfaces consistent with shoreline retreat and lakebed exposure.</p>
<p>‚Ä¢ The combination of seasonal and spatial patterns supports the use of satellite albedo data as a complementary indicator for monitoring lake retreat processes.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key Resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>‚Ä¢ Surface albedo 10-daily gridded data from 1981 to present:</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-albedo?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-albedo?tab=overview</a></p>
<p>‚Ä¢ Lake water levels from 1992 to present derived from satellite observations</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lake-water-level?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-lake-water-level?tab=overview</a></p>
<p>Code libraries used:</p>
<p>‚Ä¢ C3S EQC custom function, c3s_eqc_automatic_quality_control, prepared by B-Open</p>
<p>A few suggestions:</p>
<p><a class="reference external" href="https://earth.gsfc.nasa.gov/gwm" rel="noreferrer" target="_blank">https://earth.gsfc.nasa.gov/gwm</a> ;</p>
<p>a good review on the impact of climate change on lakes: <a class="reference external" href="https://doi.org/10.1038/s43017-020-0067-5" rel="noreferrer" target="_blank">https://doi.org/10.1038/s43017-020-0067-5</a> ;</p>
<p>ESOTC 2024 section on Lakes <a class="reference external" href="https://climate.copernicus.eu/esotc/2024/lakes" rel="noreferrer" target="_blank">https://climate.copernicus.eu/esotc/2024/lakes</a></p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1016/j.rsma.2022.102672" rel="noreferrer" target="_blank">[1]</a> Akbari, E., Hamzeh, S., Kakroodi, A. A., &amp; Maanan, M. (2022). <em>Time series analysis of the Caspian Sea shoreline in response to sea level fluctuation using remotely sensed data</em>. <em>Regional Studies in Marine Science</em>, 56, 102672.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.earscirev.2023.104428" rel="noreferrer" target="_blank">[2]</a> Lahijani, H., Leroy, S. A. G., Arpe, K., &amp; Cretaux, J. F. (2023). <em>Caspian Sea level changes during instrumental period, its impact and forecast: A review</em>. <em>Earth-Science Reviews</em>, 241, 104428.</p>
<p><a class="reference external" href="https://doi.org/10.1038/s43247-023-01017-8" rel="noreferrer" target="_blank">[3]</a> Samant, R., &amp; Prange, M. (2023). <em>Climate-driven 21st century Caspian Sea level decline estimated from CMIP6 projections</em>. <em>Communications Earth &amp; Environment</em>, 4(1), 357.</p>
<p><a class="reference external" href="https://www.nature.com/search?q=Rapid%20decline%20of%20Caspian%20Sea%20level%20threatens%20ecosystem%20integrity%2C%20biodiversity%20protection%2C%20and%20human%20infrastructure" rel="noreferrer" target="_blank">[4]</a> Court, R., Lattuada, M., Shumeyko, N., Baimukanov, M., Eybatov, T., Kaidarova, A., Mamedov, E. V., Rustamov, E., Tasmagambetova, A., Prange, M., &amp; Wilke, T. (2025). <em>Rapid decline of Caspian Sea level threatens ecosystem integrity, biodiversity protection, and human infrastructure</em>. <em>Communications Earth &amp; Environment</em>, 6(1), 261.</p>
<p><a class="reference external" href="https://doi.org/10.2139/ssrn.4674763" rel="noreferrer" target="_blank">[5]</a> Motlagh, O. R. K., &amp; Darand, M. (2023). <em>Detection of land surface albedo changes over Iran using remote sensing data</em>. SSRN Working Paper 4674763.</p>
<p><a class="reference external" href="https://doi.org/10.1002/2017GL073958" rel="noreferrer" target="_blank">[6]</a> Chen, J. L., Pekker, T., Wilson, C. R., Tapley, B. D., Kostianoy, A. G., Cr√©taux, J.-F., &amp; Safarov, E. S. (2017). <em>Long-term Caspian Sea level change</em>. <em>Geophysical Research Letters</em>, 44(13), 6993‚Äì7001.</p>
<p><a class="reference external" href="https://doi.org/10.1002/qj.2592" rel="noreferrer" target="_blank">[7]</a> Tamura-Wicks, H., Toumi, R., &amp; Budgell, W. P. (2015). <em>Sensitivity of Caspian sea-ice to air temperature</em>. <em>Quarterly Journal of the Royal Meteorological Society</em>, 141(693), 3088‚Äì3096.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.jhydrol.2022.128904" rel="noreferrer" target="_blank">[8]</a> Du, J., Zhou, H., Jacinthe, P. A., &amp; Song, K. (2023). <em>Retrieval of lake water surface albedo from Sentinel-2 remote sensing imagery</em>. <em>Journal of Hydrology</em>, 617, 128904.</p>
<p><a class="reference external" href="https://doi.org/10.1002/ldr.2155" rel="noreferrer" target="_blank">[9]</a> Argaman, E., Keesstra, S. D., &amp; Zeiliguer, A. (2012). <em>Monitoring the impact of surface albedo on a saline lake in SW Russia</em>. <em>Land Degradation &amp; Development</em>, 23(4), 398‚Äì408.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-estimating-caspian-sea-retreat-over-time">üåç Use case: Estimating Caspian Sea retreat over time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">üì¢ Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-relevant-packages">Import all the relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-temporal-and-spatial-parameters">Define temporal and spatial parameters</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval-and-processing">2. Data retrieval and processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">3. Plot and describe the results.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-study-region-map-of-selected-area">Plot Study Region (Map of Selected Area)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-albedo-and-lake-water-depression-relative-to-the-geoid">Time series of albedo and lake water depression relative to the Geoid</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-time-series-panel-plot-of-albedo-and-lake-water-height">Seasonal time series panel plot of Albedo and Lake Water Height</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-plots-of-the-summer-surface-albedo-in-different-periods">Map plots of the summer surface albedo in different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-count-analysis-of-albedo-map-plots-summer-2006-vs-2019">Pixel count analysis of albedo map plots ‚Äì Summer 2006 vs 2019</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-albedo-change-map-2019-2006">Plot albedo change map (2019 ‚àí 2006)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">4. Main takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>