
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.1. Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Indicators/indicator_sis-agrometeorological-indicators_consistency_q01';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Derived Datasets" href="../Derived_Datasets/derived.html" />
    <link rel="prev" title="6. Indicators" href="indicator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="indicator.html">6. Quality assessments for Climate Indicators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.1. Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FIndicators/indicator_sis-agrometeorological-indicators_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Indicators/indicator_sis-agrometeorological-indicators_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data">üåç Use case: Agricultural yield estimation based on reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading">Data downloading</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-variables">Derived variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">2. Download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">General setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agera5">AgERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-land">ERA5-Land</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulated-data-from-era5-land">Accumulated data from ERA5-Land</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-statistics-from-the-post-processed-era5-land-dataset">Daily statistics from the post-processed ERA5-Land dataset</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonise-datasets">Harmonise datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-alignment">Grid alignment</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-variable-names">Units and variable names</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Derived variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-by-point-comparison">Point-by-point comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-comparison">Time series comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#geospatial-comparison">Geospatial comparison</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">4. Conclusions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="agricultural-simulations-using-agera5-regional-intercomparison-between-reanalysis-datasets">
<h1><span class="section-number">6.1. </span>Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets<a class="headerlink" href="#agricultural-simulations-using-agera5-regional-intercomparison-between-reanalysis-datasets" title="Link to this heading">#</a></h1>
<p>Production date: 2026-01-20.</p>
<p><strong>Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch.</strong></p>
<p>Dataset version: 2.0.</p>
<p>Produced by: Olivier Burggraaff (National Physical Laboratory).</p>
<section id="use-case-agricultural-yield-estimation-based-on-reanalysis-data">
<h2>üåç Use case: Agricultural yield estimation based on reanalysis data<a class="headerlink" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Is AgERA5 fit-for-purpose as an input dataset for crop models?</p></li>
<li><p>How do the AgERA5 and ERA5-Land datasets differ for agriculturally relevant variables?</p></li>
</ul>
<p>Reliable estimation of crop yields using models such as WOrld FOod STudies (<a class="reference external" href="https://github.com/ajwdewit/pcse" rel="noreferrer" target="_blank">WOFOST</a>) [<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.06.018" rel="noreferrer" target="_blank">De Wit+19</a>] depends on reliable and fit-for-purpose meteorological data.
Crop models simulate growth and yield based on daily weather variables including temperature, solar irradiation, vapour pressure, wind speed, and precipitation (snow/rain).
Local simulations may make use of local observational data,
such as individual weather stations,
but these do not always provide sufficient spatial and temporal coverage and consistency.</p>
<p>Reanalyses
like ECMWF Reanalysis v5 (ERA5) [<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>]
provide meteorological data consistently and with gap-filled spatial and temporal coverage by combining historical observations and modelling.
Thanks to these advantages,
ERA5 and its higher-resolution derivative ERA5-Land [<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>]
are now commonly used to drive crop models [<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/2024-12/Value-generated-by-ERA5-full-report.pdf" rel="noreferrer" target="_blank">Evenflow+24</a>].
However,
these datasets were not designed specifically for agriculture and therefore require considerable processing before they can be used in crop models.</p>
<p>The <a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank"><em>Agrometeorological indicators from 1979 to present derived from reanalysis</em></a> or AgERA5 dataset fills this gap by providing agriculturally relevant variables in a ready-to-use format.
Compared to ERA5,
AgERA5 is downscaled from 0.25¬∞ to 0.1¬∞ spatial resolution,
aggregated to daily resolution in local time zones,
and
bias-adjusted.
It is accessible from the CDS directly [<a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">AgERA5 dataset</a>]
or through the <a class="reference external" href="https://github.com/ajwdewit/agera5tools" rel="noreferrer" target="_blank"><code class="docutils literal notranslate"><span class="pre">agera5tools</span></code></a> Python package.
AgERA5 has become very popular for crop modelling and climate analysis, among other use cases [<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/custom-uploads/7th%20GA%20C3S/Presentations/Day%203/S1/05-s19.06.24_AgERA5UserPerspective_AllarddeWit_v1.pdf" rel="noreferrer" target="_blank">De Wit+24</a>].</p>
<p>Here, we assess
the fitness-for-purpose of AgERA5 for agricultural studies
through an intercomparison with ERA5-Land.
The assessment focuses on
the ease of use of both datasets for this particular use case
as well as
the quantitative difference between AgERA5 and ERA5-Land for agriculturally relevant variables.
Both datasets are derived from ERA5,
with differences in their aggregation and downscaling methods, bias adjustment, and provided variables.
Hence,
this intercomparison is not an independent validation of either dataset,
but rather an intercomparison between similar products.
Quality assessments for ERA5 and ERA5-Land can be found in <a class="reference internal" href="../Reanalyses/reanalysis.html"><span class="std std-doc">the relevant chapter of this website</span></a>.</p>
<p>Agricultural intercomparisons are best performed regionally
to account for local climate and meteorological conditions as well as local agricultural practices.
Accordingly,
this notebook is focused on one region in one growth season,
but it is written in such a way
that it can serve as a template for the user to pick up and apply to their own desired region or time frame.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The AgERA5 dataset (<em>Agrometeorological indicators from 1979 to present derived from reanalysis</em>) is highly fit for the purpose of agricultural simulations because it provides all the relevant variables with the appropriate temporal aggregation on a 0.1¬∞ √ó 0.1¬∞ geospatial grid.</p></li>
<li><p>Values for all variables differ slightly between AgERA5 and ERA5-Land, despite sharing a common origin, because the datasets are derived differently. However, even accumulated along an entire growth season, these differences are small compared to the relevant uncertainties and real physical variation.</p></li>
<li><p>Differences between AgERA5 and ERA5-Land show patterns in space and time. This assessment is set up to be customisable for a different region or period and can serve as a jumping-off point for further analysis.</p></li>
<li><p>Neither AgERA5 nor ERA5-Land provides uncertainties on its data.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This quality assessment tests the
ease of use
of the AgERA5 (<a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank"><em>Agrometeorological indicators from 1979 to present derived from reanalysis</em></a>) dataset
and its consistency with
ERA5-Land (<a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank"><em>ERA5-Land hourly data from 1950 to present</em></a> and <a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank"><em>ERA5-Land post-processed daily statistics from 1950 to present</em></a>).
It focuses on the following variables of interest for a crop model such as <a class="reference external" href="https://github.com/ajwdewit/pcse" rel="noreferrer" target="_blank">PCSE/WOFOST</a>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Variable name</p></th>
<th class="head"><p>Statistic (24h)</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Example assessment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Solar irradiation</p></td>
<td><p>Total</p></td>
<td><p>MJ/m¬≤/day</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.1016/j.eja.2021.126419" rel="noreferrer" target="_blank">Araghi+22</a>]</p></td>
</tr>
<tr class="row-odd"><td><p>Temperature (2 m)</p></td>
<td><p>Mean <br> Minimum <br> Maximum</p></td>
<td><p>¬∞C</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.17159/sajs.2024/16043" rel="noreferrer" target="_blank">Kruger+24</a>, <a class="reference external" href="https://doi.org/10.1016/j.asr.2023.02.006" rel="noreferrer" target="_blank">Hasan Karaman+23</a>]</p></td>
</tr>
<tr class="row-even"><td><p>Rain</p></td>
<td><p>Total</p></td>
<td><p>cm/day</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.1175/JAMC-D-23-0227.1" rel="noreferrer" target="_blank">Esquivel-Arriaga+24</a>, <a class="reference external" href="https://doi.org/10.1109/MERCon63886.2024.10689062" rel="noreferrer" target="_blank">Suraweera+24</a>]</p></td>
</tr>
<tr class="row-odd"><td><p>Wind speed (2 m)</p></td>
<td><p>Mean</p></td>
<td><p>m/s</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Snow depth</p></td>
<td><p>Mean</p></td>
<td><p>cm</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<!--
| Vapour pressure   | Mean                           | kPa      |  |
[Source](https://pcse.readthedocs.io/en/stable/code.html#pcse.base.WeatherDataContainer)
-->
<p>Evapotranspiration is another important variable for agricultural models.
AgERA5 provides reference evapotranspiration values derived from the variables described above using the FAO version of the Penman‚ÄìMonteith equation for a hypothetical reference crop in a vegetated surface [<a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">Allen+98</a>].
ERA5-Land also provides (actual and potential) evapotranspiration,
but <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation#heading-Guidelines" rel="noreferrer" target="_blank">derives these using a different method</a>
and therefore the datasets cannot easily be compared one-to-one for this variable.
For intercomparisons of evapotranspiration calculated from
AgERA5, ERA5-Land, and other datasets,
the reader is referred to e.g.
[<a class="reference external" href="https://doi.org/10.3390/hydrology12070161" rel="noreferrer" target="_blank">Garbanzo+25</a>, <a class="reference external" href="https://doi.org/10.1016/j.ejrh.2025.102531" rel="noreferrer" target="_blank">Garcia-Prats+25</a>].</p>
<p>Both AgERA5 and ERA5-Land provide wind speed at 10 m altitude,
following ERA5,
because this is the standard height for wind measurements in meteorology.
The wind speed at 2 m,
which crop models typically use for their evapotranspiration calculations,
can be estimated as 0.75√ó the wind speed at 10 m [<a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">Allen+98</a>].</p>
<p>An important quantity derived from temperature is the number of <em>growing degree-days</em> (¬∞C d) or <em>thermal time</em> (TSUM in WOFOST).
Growing degree-days are essentially the sum of the <em>effective daily temperature</em> T<sub>eff</sub> over time,
with T<sub>eff</sub> the temperature relative to
a base temperature T<sub>base</sub>, below which crop development stops,
and
capped by a temperature T<sub>cap</sub>, above which crop development does not increase [<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>, <a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.05.002" rel="noreferrer" target="_blank">Ceglar+19</a>]:</p>
<!-- \qquad used because amsmath is not active, aligning with & in $$ is tricky -->
<div class="math notranslate nohighlight">
\[\begin{split}
T_\text{eff} &amp;= 0                 &amp;\qquad\text{if}&amp;&amp;\                  T \leq T_\text{base} \\
T_\text{eff} &amp;= T - T_\text{base} &amp;\qquad\text{if}&amp;&amp;\  T_\text{base} &lt; T &lt; T_\text{cap}     \\
T_\text{eff} &amp;= T_\text{cap}      &amp;\qquad\text{if}&amp;&amp;\                  T \geq T_\text{cap}  \\
\end{split}\]</div>
<p>The cumulative thermal time or total growing degree-days, TSUM, is the sum of T<sub>eff</sub> over time:</p>
<div class="math notranslate nohighlight">
\[
\text{TSUM} = \sum_t T_\text{eff}(t)
\]</div>
<p>In many models, growing degree-days control the development stages of a crop,
with thresholds set for emergence, anthesis, and maturity.
Specific values depend on the crop, cultivar, site, model, etc.
As an example,
temperate maize has T<sub>base</sub> of 4 ¬∞C and T<sub>cap</sub> of 30 ¬∞C, and TSUM of 110 ¬∞C d for emergence, 695 ¬∞C d for emergence‚Äìanthesis, and 800 ¬∞C d for anthesis‚Äìmaturity
in the <a class="reference external" href="https://github.com/ajwdewit/WOFOST_crop_parameters" rel="noreferrer" target="_blank">WOFOST crop parameter sets</a>.
These are the values of T<sub>base</sub>, T<sub>cap</sub>, and TSUM used in this assessment;
if running the notebook yourself, these values can be customised by editing the <code class="docutils literal notranslate"><span class="pre">growing_degree_days</span></code> function in the <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"><span class="std std-ref">code setup</span></a>.</p>
<p>A full crop model run is outside the scope of this assessment,
but the effective daily temperature and cumulative growing degree-days will be included in the analysis.
There are other agriculturally relevant cumulative quantities relating to moisture, irradiation, and nutrient absorption, but these are considerably more complex and therefore also out of scope.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"><span class="std std-ref">1. Code setup</span></a></strong></p>
<ul class="simple">
<li><p>Import all required libraries.</p></li>
<li><p>Definition of helper functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-download"><span class="std std-ref">2. Download data</span></a></strong></p>
<ul class="simple">
<li><p>Download data from AgERA5.</p></li>
<li><p>Download data from ERA5-Land.</p></li>
<li><p>Pre-process data.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-results"><span class="std std-ref">3. Results</span></a></strong></p>
<ul class="simple">
<li><p>Point-by-point comparison</p></li>
<li><p>Time series comparison</p></li>
<li><p>Geospatial comparison</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-conclusions"><span class="std std-ref">4. Conclusions</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="code-setup">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"></span><h3>1. Code setup<a class="headerlink" href="#code-setup" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a> for
downloading (<a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a>)
and
visualising (<a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a>) data.
Because earthkit is in active development, some functionality may change after this notebook is published.
If any part of the code stops functioning, please raise an issue on our GitHub repository so it can be fixed.</p>
</div>
<section id="import-required-libraries">
<h4>Import required libraries<a class="headerlink" href="#import-required-libraries" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input / Output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.data</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="c1"># General data handling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">wraps</span>

<span class="c1"># Visualisation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>  <span class="c1"># Pretty-print</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.plots</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Style</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># Progress bars</span>

<span class="c1"># Visualisation in Jupyter book -- automatically ignored otherwise</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">glue</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Type hints for helper functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.geo.domains</span><span class="w"> </span><span class="kn">import</span> <span class="n">Domain</span>
<span class="n">AnyDomain</span> <span class="o">=</span> <span class="p">(</span><span class="n">Domain</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="helper-functions">
<h4>Helper functions<a class="headerlink" href="#helper-functions" title="Link to this heading">#</a></h4>
<p>This section defines some functions and variables used in the following analysis, allowing code cells in later sections to be shorter and ensuring consistency.</p>
<section id="data-downloading">
<h5>Data downloading<a class="headerlink" href="#data-downloading" title="Link to this heading">#</a></h5>
<p>The following functions help with downloading data within the desired spatial/temporal domain:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download within a spatial domain</span>
<span class="k">def</span><span class="w"> </span><span class="nf">domain_to_request</span><span class="p">(</span><span class="n">domain</span><span class="p">:</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">Domain</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; From an earthkit-plots domain, generate a request for earthkit-data / cdsapi. &quot;&quot;&quot;</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">to_latlon_bbox</span><span class="p">()</span>

    <span class="c1"># Round</span>
    <span class="n">north</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">north</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">south</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">south</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">west</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">west</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">east</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">east</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">}</span>

<span class="c1"># Pretty-print a request (dict)</span>
<span class="n">print_request</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">pprint</span><span class="o">.</span><span class="n">pp</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-pre-processing">
<h5>Data (pre-)processing<a class="headerlink" href="#data-pre-processing" title="Link to this heading">#</a></h5>
<p>The following functions handle <a class="reference external" href="https://docs.xarray.dev/en/latest/user-guide/dask.html" rel="noreferrer" target="_blank">data chunking in dask</a> for computational efficiency:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rechunking of data to speed up dask calculations</span>
<span class="c1"># and maintain grib / netcdf compatibility</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Rechunk a dataset `ds` based on pre-set memory requirements. &quot;&quot;&quot;</span>
    <span class="c1"># Assign new chunk sizes</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,}</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following cell defines the order in which data variables are shown in tables and figures, for consistency:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-defined variables to ensure consistent order</span>
<span class="c1"># These lists will be used as defaults in most functions below</span>
<span class="c1"># ALL-CAPS to signify these are constants</span>
<span class="n">VARIABLES_TEMPERATURE</span> <span class="o">=</span> <span class="p">[</span>
                         <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">,</span>
                        <span class="p">]</span>

<span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">=</span> <span class="p">[</span>
                             <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">,</span> 
                             <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">,</span>
                            <span class="p">]</span>

<span class="n">VARIABLES_DERIVED</span> <span class="o">=</span> <span class="p">[</span>
                     <span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">,</span>
                    <span class="p">]</span>

<span class="n">VARIABLES_DAY_OF</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;Day_of_emergence&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Day_of_anthesis&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Day_of_maturity&quot;</span><span class="p">,</span>
                   <span class="p">]</span>    

<span class="c1"># All variables</span>
<span class="n">VARIABLES</span> <span class="o">=</span> <span class="n">VARIABLES_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span> <span class="o">+</span> <span class="n">VARIABLES_DAY_OF</span>

<span class="c1"># Variables for which relative differences make sense (not temperature)</span>
<span class="n">VARIABLES_RELATIVE</span> <span class="o">=</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span> <span class="o">+</span> <span class="n">VARIABLES_DAY_OF</span>

<span class="c1"># Variables that change over time</span>
<span class="n">VARIABLES_TIMESERIES</span> <span class="o">=</span> <span class="n">VARIABLES_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span>
<span class="n">VARIABLES_TIMESERIES_RELATIVE</span> <span class="o">=</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span>

<span class="c1"># Shortcuts for display purposes</span>
<span class="n">nvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">VARIABLES</span><span class="p">)</span>
<span class="n">nvars_half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nvars</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle updating and propagating metadata:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Metadata handling</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjust_metadata</span><span class="p">(</span><span class="n">data_array</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="o">**</span><span class="n">updates</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Adjust metadata using a new dictionary. Returns a new object. &quot;&quot;&quot;</span>
    <span class="n">metadata_old</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">metadata_new</span> <span class="o">=</span> <span class="n">metadata_old</span> <span class="o">|</span> <span class="n">updates</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">metadata_new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_array</span>

<span class="c1"># Adjust metadata to a consistent format</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjust_names</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adjust the names and units of pre-defined variables in a dataset.</span>
<span class="sd">    Also adds the name of the dataset to its attrs for easy acces.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rename variables</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (max)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (mean)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (min)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Solar irradiation&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;MJ/m¬≤/d&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Wind speed (10 m)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">]</span>          <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Total precipitation&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;mm/d&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Snow depth&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>
    
    <span class="c1"># Assign dataset name</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">dataset_name</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">dataset</span>

<span class="c1"># Helper: Preserve CRS (decorator)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preserve_crs</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Decorator that ensures propagation of CRS: find it in the original data and apply it to the result. &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">func_with_data</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
        <span class="c1"># Capture CRS from first dataset</span>
        <span class="n">CRS_present</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CRS_present</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">crs</span>

        <span class="c1"># Apply function as normal</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Propagate CRS</span>
        <span class="k">if</span> <span class="n">CRS_present</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">func_with_data</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle unit conversions, e.g. K to ¬∞C:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unit conversion</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_unit</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert the units of dataset[key] to new_unit using a conversion function (e.g. lambda x: x*1000 for m to mm), in-place. &quot;&quot;&quot;</span>
    <span class="c1"># Metadata handling</span>
    <span class="n">metadata_old</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">metadata_new</span> <span class="o">=</span> <span class="n">metadata_old</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">new_unit</span><span class="p">}</span>

    <span class="c1"># Apply changes</span>
    <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">conversion</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">metadata_new</span><span class="p">)</span>

<span class="n">convert_m2cm</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span>    <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>  <span class="c1"># meter -&gt; centimeter</span>
<span class="n">convert_m2mm</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">1000</span><span class="p">),</span>   <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>  <span class="c1"># meter -&gt; millimeter</span>
<span class="n">convert_K2C</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">-</span><span class="mf">273.15</span><span class="p">),</span> <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>  <span class="c1"># Kelvin -&gt; Celsius</span>
<span class="n">convert_J2MJ</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="mf">1e6</span><span class="p">),</span>    <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;MJ/m¬≤/d&quot;</span><span class="p">)</span>  <span class="c1"># J/m¬≤/d -&gt; MJ/m¬≤/d</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle harmonisation of coordinates:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">round_coordinates</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Round coordinates in `data` to `d` decimals. Hard-coded for lat/lon. &quot;&quot;&quot;</span>
    <span class="c1"># Cannot be a dict-comp with coord in lat/lon because of symbol table issues</span>
    <span class="n">round_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span>
                     <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d</span><span class="p">))}</span>

    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">round_mapping</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="derived-variables">
<h5>Derived variables<a class="headerlink" href="#derived-variables" title="Link to this heading">#</a></h5>
<p>The following functions calculate derived variables such as 2 m wind speed and growing degree-days:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_2m_wind_speed</span><span class="p">(</span><span class="n">wind_10m</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate 2 m wind speed from 10 m wind speed. &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">wind_2m</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">wind_10m</span>

    <span class="c1"># Fix metadata</span>
    <span class="n">wind_2m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">wind_10m</span><span class="o">.</span><span class="n">attrs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Wind speed (2 m)&quot;</span><span class="p">}</span>
    <span class="n">wind_2m</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">wind_2m</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wind_2m</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert 10 m wind speed to 2 m wind speed. &quot;&quot;&quot;</span>
    <span class="c1"># Add new variable</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_2m_wind_speed</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">])</span>

    <span class="c1"># Remove old variable</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate growing degree days</span>
<span class="k">def</span><span class="w"> </span><span class="nf">growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                        <span class="n">T_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">T_cap</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; For a dataset `data` with temperatures, calculate the growing degree-days aggregated over the entire temporal range. &quot;&quot;&quot;</span>
    <span class="c1"># Use min/max temperatures</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
        <span class="n">T_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="n">T_mean</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognised growing_degree_days method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; -- please use &#39;minmax&#39; or &#39;mean&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate T_eff</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_mean</span> <span class="o">-</span> <span class="n">T_base</span>  <span class="c1"># General case</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span> <span class="o">&gt;</span> <span class="n">T_base</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 0 if T &lt;= T_base</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span> <span class="o">&lt;</span> <span class="n">T_cap</span><span class="p">,</span> <span class="n">T_cap</span><span class="p">)</span>  <span class="c1"># T_cap if T &gt;= T_cap</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">T_eff</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Effective temperature&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>

    <span class="c1"># Aggregate TSUM</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">TSUM</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Œ£ Growing degree-days&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C d&quot;</span><span class="p">)</span>

    <span class="c1"># Propagate NaN</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">TSUM</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">T_eff</span><span class="p">,</span> <span class="n">TSUM</span>

<span class="c1"># Convenience: Add growing degree days to dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate growing degree days (daily, aggregate) and add them to the input dataset. &quot;&quot;&quot;</span>
    <span class="n">T_eff</span><span class="p">,</span> <span class="n">TSUM</span> <span class="o">=</span> <span class="n">growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_eff</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TSUM</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># Find the first day where Growing_Degree_Days &gt;= some threshold</span>
<span class="k">def</span><span class="w"> </span><span class="nf">first_element_over_threshold</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Find the first element in `data` along axis `dim` that&#39;s over `threshold`. &quot;&quot;&quot;</span>
    <span class="c1"># Calculate value</span>
    <span class="n">over_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="n">first_element</span> <span class="o">=</span> <span class="n">over_threshold</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>

    <span class="c1"># Mask elements where threshold is never met</span>
    <span class="n">threshold_met</span> <span class="o">=</span> <span class="n">over_threshold</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">first_element</span> <span class="o">=</span> <span class="n">first_element</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">threshold_met</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="c1"># Propagate NaN</span>
    <span class="c1"># (will generally be redundant with previous mask)</span>
    <span class="n">any_valid_element_along_dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>
    <span class="n">first_element</span> <span class="o">=</span> <span class="n">first_element</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">any_valid_element_along_dim</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">first_element</span>

<span class="k">def</span><span class="w"> </span><span class="nf">first_day_over_tsum</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Find the first day in `data` that&#39;s over `threshold` (e.g. 150 ¬∞C) and `label` it accordingly. &quot;&quot;&quot;</span>
    <span class="c1"># Calculate value</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">first_element_over_threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># Adjust metadata</span>
    <span class="n">day</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">day</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Day_of_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Day of </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">day</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_days_of_tsum</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">label_and_threshold</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add any number of first-day-over-threshold variables to a dataset.</span>
<span class="sd">    label_and_threshold should be in the form</span>
<span class="sd">        emergence=100, anthesis=800, ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">label_and_threshold</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Day_of_</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_day_over_tsum</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">],</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="statistics">
<h5>Statistics<a class="headerlink" href="#statistics" title="Link to this heading">#</a></h5>
<p>The following functions calculate the difference (absolute / relative) between datasets, handling metadata etc.:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels</span>
<span class="k">def</span><span class="w"> </span><span class="nf">label_with_unit</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extract the full name with unit for a key in a dataset. &quot;&quot;&quot;</span>
    <span class="n">long_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span>  <span class="c1"># Variable name</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">unit</span>  <span class="c1"># If unit is specified -&gt; use that ; else -&gt; use metadata unit</span>
    <span class="n">spacer</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">linebreak</span> <span class="k">else</span> <span class="s2">&quot; &quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">long_name</span><span class="si">}{</span><span class="n">spacer</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants</span>
<span class="n">NONZERO_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">NONZERO_THRESHOLD_PCT</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Difference between datasets</span>
<span class="nd">@preserve_crs</span>
<span class="k">def</span><span class="w"> </span><span class="nf">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                <span class="n">diff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate the difference between two datasets, preserving CRS and updating metadata. &quot;&quot;&quot;</span>
    <span class="c1"># Subtract</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">diff_variables</span><span class="p">],</span> <span class="n">data2</span><span class="p">[</span><span class="n">diff_variables</span><span class="p">])</span>

    <span class="c1"># Adjust metadata</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">diff_variables</span><span class="p">:</span>
        <span class="n">old_metadata</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
        <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">old_metadata</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Œî &quot;</span> <span class="o">+</span> <span class="n">old_metadata</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]}</span>
        <span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="o">**</span><span class="n">updated_metadata</span><span class="p">)</span>

    <span class="c1"># Add name</span>
    <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&lt;unspecified&gt;&quot;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="n">name1</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">name2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">difference</span>

<span class="nd">@preserve_crs</span>
<span class="k">def</span><span class="w"> </span><span class="nf">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                         <span class="n">reldiff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_RELATIVE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the relative [%] difference between two datasets, preserving CRS and updating metadata.</span>
<span class="sd">    Relative difference is calculated symmetrically, i.e. divided by (data1 + data2)/2.</span>
<span class="sd">    Where data1 == 0 and data2 == 0, the relative difference is set to 0 too.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select and calculate</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="n">reldiff_variables</span><span class="p">]</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>

    <span class="n">relative_difference</span> <span class="o">=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">-</span> <span class="n">data2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">200.</span>

    <span class="c1"># Replace 0/0 with 0</span>
    <span class="n">both_zero</span> <span class="o">=</span> <span class="p">((</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">NONZERO_THRESHOLD</span><span class="p">)</span>  <span class="c1"># Threshold slightly &gt; 0 because of floating-point errors</span>
    <span class="n">relative_difference</span> <span class="o">=</span> <span class="n">relative_difference</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">both_zero</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

    <span class="c1"># Adjust metadata</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">reldiff_variables</span><span class="p">:</span>
        <span class="n">old_metadata</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
        <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">old_metadata</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;rŒî &quot;</span> <span class="o">+</span> <span class="n">old_metadata</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">],</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
        <span class="n">relative_difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">relative_difference</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="o">**</span><span class="n">updated_metadata</span><span class="p">)</span>

    <span class="c1"># Add name</span>
    <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&lt;unspecified&gt;&quot;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    <span class="n">relative_difference</span> <span class="o">=</span> <span class="n">relative_difference</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;% Difference: </span><span class="si">{</span><span class="n">name1</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">name2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">relative_difference</span>

<span class="n">_5percentile</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;5&lt;sup&gt;th&lt;/sup&gt; Perc. Œî&quot;</span><span class="p">)</span>
<span class="n">_95percentile</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;95&lt;sup&gt;th&lt;/sup&gt; Perc. Œî&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">comparison_statistics</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                          <span class="n">diff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES</span><span class="p">,</span>
                          <span class="n">reldiff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_RELATIVE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given two datasets, calculate a number of statistics for each variable and return the result in a table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate differences</span>
    <span class="n">differences</span>     <span class="o">=</span>          <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">diff_variables</span><span class="o">=</span><span class="n">diff_variables</span><span class="p">)</span>
    <span class="n">differences_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">reldiff_variables</span><span class="o">=</span><span class="n">reldiff_variables</span><span class="p">)</span>

    <span class="c1"># Convert to pandas</span>
    <span class="n">differences</span> <span class="o">=</span> <span class="n">differences</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="n">diff_variables</span><span class="p">]</span>
    <span class="n">differences_abs</span> <span class="o">=</span> <span class="n">differences</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="n">differences_rel</span> <span class="o">=</span> <span class="n">differences_rel</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="n">reldiff_variables</span><span class="p">]</span>
    <span class="n">differences_rel_abs</span> <span class="o">=</span> <span class="n">differences_rel</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="c1"># Calculate aggregate statistics</span>
    <span class="n">md</span>   <span class="o">=</span>               <span class="n">differences</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median Œî&quot;</span><span class="p">})</span>
    <span class="n">mad</span>  <span class="o">=</span>           <span class="n">differences_abs</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median |Œî|&quot;</span><span class="p">})</span>
    <span class="n">mapd</span> <span class="o">=</span>       <span class="n">differences_rel_abs</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median |Œî| [%]&quot;</span><span class="p">})</span>
    <span class="n">md</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span><span class="p">)]</span>

    <span class="c1"># Calculate percentiles</span>
    <span class="n">p5</span><span class="p">,</span> <span class="n">p95</span> <span class="o">=</span> <span class="n">_5percentile</span><span class="p">(</span><span class="n">differences</span><span class="p">),</span> <span class="n">_95percentile</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>

    <span class="c1"># Calculate correlation coefficients</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">data2</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> 
             <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">diff_variables</span><span class="p">}</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">corrs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pearson r&quot;</span><span class="p">])</span>
    
    <span class="c1"># Combine statistics into one dataframe</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p5</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">p95</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span><span class="p">,</span> <span class="n">corrs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stats</span>

<span class="k">def</span><span class="w"> </span><span class="nf">display_difference_stats</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Given two datasets, calculate a number of statistics for each variable and display the result in a table. &quot;&quot;&quot;</span>
    <span class="c1"># Helper function for displaying variables / units nicely</span>
    <span class="c1"># Uses &lt;br&gt; instead of &quot;\n&quot; for HTML output</span>
    <span class="n">display_var</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate and format statistics</span>
    <span class="n">comparison_stats</span> <span class="o">=</span> <span class="n">comparison_statistics</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">formatted</span> <span class="o">=</span> <span class="n">comparison_stats</span><span class="o">.</span><span class="n">style</span> \
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  \
                                <span class="o">.</span><span class="n">format_index</span><span class="p">(</span><span class="n">display_var</span><span class="p">)</span> \
                                <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;AgERA5 ‚Äì ERA5-Land&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">formatted</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions aid in sub-selecting data, e.g. extracting time series:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subselection of data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">select_in_multiple_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">datasets</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extract the same selection (e.g. one site, time series, ...) from any number of datasets. &quot;&quot;&quot;</span>
    <span class="n">datasets_selected</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">datasets_selected</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="visualisation">
<h5>Visualisation<a class="headerlink" href="#visualisation" title="Link to this heading">#</a></h5>
<p>The following cell defines <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/_api/plots/styles/index.html" rel="noreferrer" target="_blank">earthkit-plots styles</a> for the variables in the datasets.
These styles define the colour maps and colour bar ranges for each quantity.
Earthkit-plots styles are explained further in the <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/examples/examples/examples.html#Styles" rel="noreferrer" target="_blank">corresponding documentation</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Styles for indicators</span>
<span class="n">n_diff</span> <span class="o">=</span> <span class="mi">9</span>  <span class="c1"># Levels in difference charts</span>

<span class="c1"># Temperature</span>
<span class="n">_style_t</span>        <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrBr</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>    <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_t_diff</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_gdd</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>    <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mf">3e3</span><span class="p">,</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_gdd_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Irradiation</span>
<span class="n">_style_ssrd</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>   <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_ssrd_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Wind speed</span>
<span class="n">_style_wind</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Purples</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_wind_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">PuOr</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Precipitation</span>
<span class="n">_style_tp</span>        <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">GnBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>     <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_tp_diff</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BrBG</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_snow</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">GnBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>      <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_snow_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BrBG</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Day of emergence / anthesis / maturity</span>
<span class="n">_style_day</span>       <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Greys</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>    <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">280</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_day_diff</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdGy</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Individual styles</span>
<span class="c1"># Set up like this so they can still be edited individually</span>
<span class="n">styles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Max_24h_diff&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Mean_24h_diff&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Min_24h_diff&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">:</span>       <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Effective_diff&quot;</span><span class="p">:</span>       <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">:</span>         <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_gdd</span><span class="p">),</span>    <span class="s2">&quot;Growing_Degree_Days_diff&quot;</span><span class="p">:</span>         <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_gdd_diff</span><span class="p">),</span>
    <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">:</span>        <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_ssrd</span><span class="p">),</span>   <span class="s2">&quot;Solar_Radiation_Flux_diff&quot;</span><span class="p">:</span>        <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_ssrd_diff</span><span class="p">),</span>
    <span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind</span><span class="p">),</span>   <span class="s2">&quot;Wind_Speed_10m_Mean_24h_diff&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind_diff</span><span class="p">),</span>
    <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">:</span>      <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind</span><span class="p">),</span>   <span class="s2">&quot;Wind_Speed_2m_Mean_24h_diff&quot;</span><span class="p">:</span>      <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind_diff</span><span class="p">),</span>
    <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">:</span>          <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_tp</span><span class="p">),</span>     <span class="s2">&quot;Precipitation_Flux_diff&quot;</span><span class="p">:</span>          <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_tp_diff</span><span class="p">),</span>
    <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_snow</span><span class="p">),</span>   <span class="s2">&quot;Snow_Thickness_Mean_24h_diff&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_snow_diff</span><span class="p">),</span>
    <span class="s2">&quot;Day_of_emergence&quot;</span><span class="p">:</span>            <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day</span><span class="p">),</span>    <span class="s2">&quot;Day_of_emergence_diff&quot;</span><span class="p">:</span>            <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day_diff</span><span class="p">),</span>
    <span class="s2">&quot;Day_of_anthesis&quot;</span><span class="p">:</span>             <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day</span><span class="p">),</span>    <span class="s2">&quot;Day_of_anthesis_diff&quot;</span><span class="p">:</span>             <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day_diff</span><span class="p">),</span>
    <span class="s2">&quot;Day_of_maturity&quot;</span><span class="p">:</span>             <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day</span><span class="p">),</span>    <span class="s2">&quot;Day_of_maturity_diff&quot;</span><span class="p">:</span>             <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_day_diff</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Apply general settings</span>
<span class="k">for</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">styles</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">style</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions are helpers for displaying in Jupyter Notebook or Jupyter Book style, adding textboxes with consistent formatting, adjusting axis limits, etc.:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Helper functions, general</span>
<span class="n">RELATIVE_DIFFERENCE_LIMIT</span> <span class="o">=</span> <span class="mi">50</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If `glue` is available, glue the figure using the provided label.</span>
<span class="sd">    If not, display the figure in the notebook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">glue</span><span class="p">(</span><span class="n">glue_label</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">|</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Add a text box to each of the specified subplots. &quot;&quot;&quot;</span>
    <span class="c1"># Get the plt.Axes for each ekp.Subplot</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">subplot</span><span class="o">.</span><span class="n">ax</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">)</span> <span class="k">else</span> <span class="n">subplot</span> <span class="k">for</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>

    <span class="c1"># Set up location</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.95</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="mf">0.05</span>
    <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="s2">&quot;left&quot;</span>

    <span class="c1"># Add the text</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;boxstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span>
              <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_sharexy</span><span class="p">(</span><span class="n">axs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Force all of the axes in axs to share x and/or y with the first element. &quot;&quot;&quot;</span>
    <span class="n">main_ax</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">main_ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">main_ax</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_symmetric_lim</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Adjust the x- or y-lims for one Axes to be symmetric, based on existing values. &quot;&quot;&quot;</span>
    <span class="c1"># Pick axis</span>
    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">getter</span><span class="p">,</span> <span class="n">setter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span>
    <span class="k">elif</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">getter</span><span class="p">,</span> <span class="n">setter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_symmetric_lim needs axis &#39;x&#39; or &#39;y&#39;, was given &#39;</span><span class="si">{</span><span class="n">which</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Apply</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">getter</span><span class="p">()</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
    <span class="n">maxlim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
    <span class="n">newlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">maxlim</span><span class="p">,</span> <span class="n">maxlim</span><span class="p">)</span>
    <span class="n">setter</span><span class="p">(</span><span class="n">newlim</span><span class="p">)</span>

<span class="n">_symmetric_xlim</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_symmetric_lim</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">_symmetric_ylim</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_symmetric_lim</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Retrieve a style from the global styles dict, then use its vmin/vmax to set the x/y lim for this ax. &quot;&quot;&quot;</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span>
    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_percentile</span><span class="p">(</span><span class="o">*</span><span class="n">data_arrays</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">],</span> <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the specified percentile across all of the provided datasets.</span>
<span class="sd">    Used for making consistent colour maps and axis limits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">data_arrays</span><span class="p">])</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data_flat</span><span class="p">,</span> <span class="n">percentile</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
        <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">round</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
        <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">perc</span>

<span class="n">cmap_percentile</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">find_vmin</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">find_percentile</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">cmap_percentile</span><span class="p">)</span>
<span class="n">find_vmax</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">find_percentile</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">100</span><span class="o">-</span><span class="n">cmap_percentile</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">subplots_2byN</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a figure with 2 x (N/2) panels, with N the number of variables.</span>
<span class="sd">    Return them unravelled, turning off and removing any spares (e.g. 8th panel for 7 variables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create figure, panels</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nvars_half</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># White out last panel if odd number of variables</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="n">nvars</span><span class="p">:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[:</span><span class="n">nvars</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions are also base helper functions, but specific to geospatial plots:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Helper functions for geospatial plots</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyDomain</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot any number of datasets into new subplots in an existing earthkit figure. &quot;&quot;&quot;</span>
    <span class="c1"># Create subplots</span>
    <span class="n">subplots</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="c1"># Plot</span>
    <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subplots</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">subplots</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform geospatial comparisons between datasets, including the per-pixel difference:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Plot indicators geospatially</span>
<span class="k">def</span><span class="w"> </span><span class="nf">geospatial_comparison_with_difference</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                          <span class="n">variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_TIMESERIES</span><span class="p">,</span>
                                          <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="n">domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyDomain</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of `variables` in two datasets, geospatially.</span>
<span class="sd">    A specific date has to be specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pre-process: Select data on specified date, calculate difference</span>
    <span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">date</span><span class="p">)</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span><span class="p">,</span> <span class="n">diff_variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>

    <span class="c1"># Setup indicators</span>
    <span class="n">n_variables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
    <span class="n">loop_variables</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Plotting variables&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">n_variables</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_variables</span><span class="p">)))</span>

    <span class="c1"># Plot indicators</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">loop_variables</span><span class="p">:</span>
        <span class="c1"># Plot individual datasets</span>
        <span class="n">subplots_data</span> <span class="o">=</span> <span class="n">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> 
                                                      <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>

        <span class="c1"># Plot difference</span>
        <span class="n">subplot_diff</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">difference</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
                                                         <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">_diff&quot;</span><span class="p">])</span>
        <span class="c1"># Decorate: Text + Colour bar</span>
        <span class="n">var_label</span> <span class="o">=</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">subplots_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">var_label</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">subplot_diff</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="c1"># Titles on top</span>
    <span class="n">column_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">,</span> <span class="s2">&quot;Difference&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">column_title</span><span class="p">,</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">column_titles</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">column_title</span><span class="p">)</span>

    <span class="c1"># Decorate figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">land</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Geospatial intercomparison: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">title</span><span class="p">(</span> <span class="s2">&quot;Geospatial intercomparison on {time:</span><span class="si">%-d</span><span class="s2"> %B %Y}&quot;</span><span class="p">)</span>
    
    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform point-by-point (scatter, histogram) comparisons between datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Point-by-point comparison - Scatter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">scatter_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                       <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                       <span class="n">n_bins</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                       <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with one-to-one comparisons.</span>
<span class="sd">    Hard-coded for VARIABLES, VARIABLES_TEMPERATURE, VARIABLES_NOT_TEMPERATURE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">subplots_2byN</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="c1"># Plot individual scatter plots</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Get vmin/vmax for lims</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">data2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                  <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]),</span>
                  <span class="n">gridsize</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">mincnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>

        <span class="c1"># Set limits from style, matching colour maps</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
        
        <span class="n">var_label</span> <span class="o">=</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">var_label</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Highlight diagonal</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Point-by-point comparison across full domain&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="n">label2</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Point-by-point comparison - Histogram</span>
<span class="k">def</span><span class="w"> </span><span class="nf">histogram_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                         <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                         <span class="n">n_bins</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                         <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">difference_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nvars</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nvars</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>
    
    <span class="c1"># Share x, y for temperature plots; assume these are the first N panels</span>
    <span class="n">n_temperature_variables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">VARIABLES_TEMPERATURE</span><span class="p">)</span>
    <span class="n">axes_temperature</span>     <span class="o">=</span> <span class="n">axs</span><span class="p">[:</span><span class="n">n_temperature_variables</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">axes_not_temperature</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">n_temperature_variables</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">_sharexy</span><span class="p">(</span><span class="n">axes_temperature</span><span class="p">)</span>
    
    <span class="c1"># Share y for absolute/relative non-temperature plots (row-wise)</span>
    <span class="k">for</span> <span class="n">ax_row</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="n">n_temperature_variables</span><span class="p">:]:</span>
        <span class="n">_sharexy</span><span class="p">(</span><span class="n">ax_row</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    
    <span class="c1"># Plot differences</span>
    <span class="k">for</span> <span class="n">ax_row</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Limits based on styles</span>
        <span class="n">lim</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
    
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">)</span>
        <span class="n">bins_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">)</span>
    
        <span class="c1"># Plot differences</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">difference_rel</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_rel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Remove panel if there are no relative differences, e.g. temperature</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># If panel is active</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
        
        <span class="c1"># Axis labels</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;%&quot;</span><span class="p">))</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
    
    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
        <span class="c1"># Highlight 0</span>
        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">axison</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    
        <span class="c1"># Log scale if the histogram is extremely concentrated (usually around 0)</span>
        <span class="c1"># if ax.get_ylim()[1] &gt; 1e5:</span>
            <span class="c1"># ax.set_yscale(&quot;log&quot;)</span>
    
    <span class="c1"># Figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">difference</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (overall distribution)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>
    
    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform time series comparisons between datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time series comparisons</span>
<span class="c1"># Consistent styling</span>
<span class="n">COLOURS_DATA</span> <span class="o">=</span> <span class="s2">&quot;#0077bb&quot;</span><span class="p">,</span> <span class="s2">&quot;#ee7733&quot;</span>
<span class="n">COLOUR_DIFF</span><span class="p">,</span> <span class="n">COLOUR_DIFF_REL</span> <span class="o">=</span> <span class="s2">&quot;#004488&quot;</span><span class="p">,</span> <span class="s2">&quot;#bb5566&quot;</span>
<span class="n">ALPHA_TIMESERIES</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">LINEWIDTH_TIMESERIES</span> <span class="o">=</span> <span class="mf">2.</span>

<span class="c1"># Consistent plot setup</span>
<span class="n">nvars_timeseries</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">VARIABLES_TIMESERIES</span><span class="p">)</span>
<span class="n">_subplots_timeseries</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nvars_timeseries</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nvars_timeseries</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_loop_timeseries</span><span class="p">(</span><span class="n">axs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_TIMESERIES</span><span class="p">):</span>
    <span class="k">yield from</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_plot_line</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Dummy wrapper around ax.plot for compatibility with _plot_relative_difference. &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_plot_with_quantiles</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot the mean (line) and some percentile ranges (shaded areas) into an ax. &quot;&quot;&quot;</span>
    <span class="c1"># Calculate statistics</span>
    <span class="n">statistics</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span>

    <span class="c1"># Plot statistics</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>        <span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">statistics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">LINEWIDTH_TIMESERIES</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># Median</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">statistics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span> <span class="n">statistics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.75</span><span class="p">),</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>                 <span class="c1"># Inter-quartile range</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">statistics</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">statistics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span> <span class="n">statistics</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mf">0.95</span><span class="p">),</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>                 <span class="c1"># 5‚Äì95% CI range</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_plot_relative_difference</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">plot_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the relative difference on a new twin Axes with the provided function `plot_func`, and add decorations.</span>
<span class="sd">    plot_func must take `ax` as its first argument.</span>
<span class="sd">    The twin Axes is returned so it can be labelled etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create second y-axis</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

    <span class="c1"># Plot using provided function</span>
    <span class="n">plot_func</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Set y-axis parameters: limits, label, colour</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Difference [%]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>

    <span class="c1"># Remove unneeded visuals</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_decorate_timeseries_axes</span><span class="p">(</span><span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Visual settings for timeseries panels. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_decorate_timeseries_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span>
                             <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Time series&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Visual settings for a timeseries figure. &quot;&quot;&quot;</span>
    <span class="c1"># Decoration</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>


<span class="c1"># Time series comparison - Values - One site</span>
<span class="k">def</span><span class="w"> </span><span class="nf">timeseries_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">site</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                          <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                          <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with time series comparisons -- here showing the values of variables.</span>
<span class="sd">    Hard-coded for VARIABLES_TIMESERIES.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select site</span>
    <span class="n">timeseries</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">_subplots_timeseries</span><span class="p">()</span>

    <span class="c1"># Plot time series</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">_loop_timeseries</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="c1"># Plot individual time series</span>
        <span class="k">for</span> <span class="n">ts</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">COLOURS_DATA</span><span class="p">,</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">]):</span>
            <span class="n">_plot_line</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">LINEWIDTH_TIMESERIES</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Label variable and datasets</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="n">_decorate_timeseries_axes</span><span class="p">(</span><span class="o">*</span><span class="n">axs</span><span class="p">)</span>
    <span class="n">_decorate_timeseries_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time series comparison at (</span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞E)&quot;</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Time series comparison - Difference - General</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_timeseries_comparison_difference_general</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">plot_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                              <span class="n">site</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span><span class="o">=</span><span class="p">{},</span> <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                              <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                                              <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with time series comparisons -- here showing the difference (abs+rel).</span>
<span class="sd">    Change `plot_func` to use different plotting functions, e.g. single line vs statistics over the domain.</span>
<span class="sd">    Hard-coded for VARIABLES_TIMESERIES.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select site</span>
    <span class="n">timeseries</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>

    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span>     <span class="o">=</span>          <span class="n">difference_between_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">timeseries</span><span class="p">,</span>    <span class="n">diff_variables</span><span class="o">=</span><span class="n">VARIABLES_TIMESERIES</span><span class="p">)</span>
    <span class="n">difference_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">reldiff_variables</span><span class="o">=</span><span class="n">VARIABLES_TIMESERIES_RELATIVE</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">_subplots_timeseries</span><span class="p">()</span>

    <span class="c1"># Plot time series</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">_loop_timeseries</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="c1"># Plot absolute difference</span>
        <span class="n">plot_func</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">difference</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Plot relative difference</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">VARIABLES_TIMESERIES_RELATIVE</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">_plot_relative_difference</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_func</span><span class="p">,</span> <span class="n">difference_rel</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax2</span><span class="p">)</span>

        <span class="c1"># Label variable</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="n">_decorate_timeseries_axes</span><span class="p">(</span><span class="o">*</span><span class="n">axs</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Time series comparison at (</span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞E)&quot;</span>
    <span class="n">_decorate_timeseries_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>

<span class="c1"># Time series comparison - Difference</span>
<span class="n">timeseries_comparison_difference</span>       <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_timeseries_comparison_difference_general</span><span class="p">,</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">_plot_line</span><span class="p">,</span>
                                                 <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">LINEWIDTH_TIMESERIES</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># One site</span>
<span class="n">timeseries_comparison_difference_multi</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_timeseries_comparison_difference_general</span><span class="p">,</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">_plot_with_quantiles</span><span class="p">,</span>
                                                 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Time series comparison (overall)&quot;</span><span class="p">)</span>  <span class="c1"># All sites</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>
<section id="download-data">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-download"></span><h3>2. Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h3>
<section id="general-setup">
<h4>General setup<a class="headerlink" href="#general-setup" title="Link to this heading">#</a></h4>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a> to download files from the CDS.
If you intend to run this notebook multiple times, it is highly recommended that you <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/caching.html" rel="noreferrer" target="_blank">enable caching</a> to prevent having to download the same files multiple times.
If you prefer not to use earthkit, the following requests can also be used with the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api#linux-use-client-step" rel="noreferrer" target="_blank">cdsapi module</a>.
In either case (earthkit-data or cdsapi), it is required to set up a CDS account and API key as explained <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api" rel="noreferrer" target="_blank">on the CDS website</a>.</p>
<p>We will be downloading multiple datasets in this notebook.
CDS data requests take the form of dictionaries in Python.
When making multiple requests
(e.g. to download data from multiple catalogue entries),
it is convenient to set up a <em>template</em> request with some default parameters.
In this section, we define our template containing those parameters that are constant between datasets: the domain in time and space.
This way, these are guaranteed to be consistent between downloads
and
only need to be changed in one place if you wish to modify the notebook for your own use case.</p>
<p>In this example, we will be looking at data for the United Kingdom and Ireland every day in January‚ÄìSeptember 2023.
We will also do a time series comparison at one site within this area.
The domain, site, and period are defined in the following cell,
and can be edited when running this notebook yourself:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Space</span>
<span class="n">domain</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">,</span> <span class="s2">&quot;Ireland&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;UK &amp; Ireland&quot;</span><span class="p">)</span>
<span class="n">site</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">52.5</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>

<span class="c1"># Time</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">months</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># [start, end)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The CDS request template is then defined using the values defined above.
Additional information to download specific data variables will be mixed into this template in the following sections.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Space</span>
<span class="n">request_domain</span> <span class="o">=</span> <span class="n">domain_to_request</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>

<span class="c1"># Time</span>
<span class="n">request_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mo</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">months</span><span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>  <span class="c1"># All days</span>
<span class="p">}</span>

<span class="c1"># Template (combining space + time)</span>
<span class="n">request_default</span> <span class="o">=</span> <span class="n">request_domain</span> <span class="o">|</span> <span class="n">request_time</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request template:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_default</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template:
{&#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="agera5">
<h4>AgERA5<a class="headerlink" href="#agera5" title="Link to this heading">#</a></h4>
<p>Due to size limits on the CDS, the different variables of interest in AgERA5 (temperature, irradiation, etc.) have to be downloaded separately and then combined afterwards.
This is achieved by combining the previously defined template request with parameters specific to AgERA5, and subsequently with parameters specific to each individual variable.</p>
<p>First, the parameters specific to AgERA5 (dataset ID and version) are defined and combined with the template:</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agera5_ID</span> <span class="o">=</span> <span class="s2">&quot;sis-agrometeorological-indicators&quot;</span>

<span class="n">request_agera5_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_0&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">agera5_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_agera5_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for sis-agrometeorological-indicators:
{&#39;version&#39;: &#39;2_0&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the requests for each of the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temperature has to be split into separate requests because of size limits</span>
<span class="n">request_temperature_min</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_minimum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_max</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_maximum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_mean</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Non-temperature variables</span>
<span class="n">request_irradiation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;solar_radiation_flux&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_wind</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_wind_speed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_rain</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;precipitation_flux&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_snow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;snow_thickness&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Compile all requests into one list for easier iteration</span>
<span class="n">requests_agera5_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_temperature_min</span><span class="p">,</span> <span class="n">request_temperature_max</span><span class="p">,</span> <span class="n">request_temperature_mean</span><span class="p">,</span>
                             <span class="n">request_irradiation</span><span class="p">,</span>
                             <span class="n">request_rain</span><span class="p">,</span>
                             <span class="n">request_wind</span><span class="p">,</span>
                             <span class="n">request_snow</span><span class="p">,</span>
                            <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.
Earthkit-data downloads the dataset as a <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/data.html" rel="noreferrer" target="_blank">field list</a>.
Here, we convert this object to an <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html" rel="noreferrer" target="_blank">xarray dataset</a> for ease of use later (when comparing multiple datasets):</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_agera5</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_agera5_default</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_agera5_variables</span><span class="p">]</span>

<span class="c1"># Show one example</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Example request for one variable from </span><span class="si">{</span><span class="n">agera5_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">requests_agera5</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example request for one variable from sis-agrometeorological-indicators:
{&#39;version&#39;: &#39;2_0&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;],
 &#39;variable&#39;: &#39;2m_temperature&#39;,
 &#39;statistic&#39;: [&#39;24_hour_minimum&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data and convert to desired format</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">agera5_ID</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_agera5</span><span class="p">)</span>  <span class="c1"># Download as field list</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">data_agera5</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>  <span class="c1"># Rechunk in Dask for better performance -- not strictly necessary</span>
<span class="n">data_agera5</span>  <span class="c1"># Display in notebook</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 179MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
Data variables:
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    crs                          (time) int64 2kB dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Solar_Radiation_Flux         (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Wind_Speed_10m_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
Attributes:
    Conventions:  CF-1.7
    title:        AgERA5 daily weather variables derived from the ECMWF ERA5 ...
    institution:  Wageningen Environmental Research
    history:      Generated by `pragera5 run_daily_processing 2023-01-01` ver...
    references:   https://doi.org/10.24381/cds.6c68c9bb
    source:       ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-75868b1c-651b-40c9-8138-f512b9cf1ffb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-75868b1c-651b-40c9-8138-f512b9cf1ffb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-95ad84b1-5c04-4945-acbb-585f0e73c347' class='xr-section-summary-in' type='checkbox'  checked><label for='section-95ad84b1-5c04-4945-acbb-585f0e73c347' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-aa2d29d1-c825-4f51-acec-4000c7c17928' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa2d29d1-c825-4f51-acec-4000c7c17928' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86fc6a8e-1ef4-4a5b-b93c-a96a2941691c' class='xr-var-data-in' type='checkbox'><label for='data-86fc6a8e-1ef4-4a5b-b93c-a96a2941691c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-1.290000e+01, -1.280000e+01, -1.270000e+01, -1.260000e+01,
       -1.250000e+01, -1.240000e+01, -1.230000e+01, -1.220000e+01,
       -1.210000e+01, -1.200000e+01, -1.190000e+01, -1.180000e+01,
       -1.170000e+01, -1.160000e+01, -1.150000e+01, -1.140000e+01,
       -1.130000e+01, -1.120000e+01, -1.110000e+01, -1.100000e+01,
       -1.090000e+01, -1.080000e+01, -1.070000e+01, -1.060000e+01,
       -1.050000e+01, -1.040000e+01, -1.030000e+01, -1.020000e+01,
       -1.010000e+01, -1.000000e+01, -9.900000e+00, -9.800000e+00,
       -9.700000e+00, -9.600000e+00, -9.500000e+00, -9.400000e+00,
       -9.300000e+00, -9.200000e+00, -9.100000e+00, -9.000000e+00,
       -8.900000e+00, -8.800000e+00, -8.700000e+00, -8.600000e+00,
       -8.500000e+00, -8.400000e+00, -8.300000e+00, -8.200000e+00,
       -8.100000e+00, -8.000000e+00, -7.900000e+00, -7.800000e+00,
       -7.700000e+00, -7.600000e+00, -7.500000e+00, -7.400000e+00,
       -7.300000e+00, -7.200000e+00, -7.100000e+00, -7.000000e+00,
       -6.900000e+00, -6.800000e+00, -6.700000e+00, -6.600000e+00,
       -6.500000e+00, -6.400000e+00, -6.300000e+00, -6.200000e+00,
       -6.100000e+00, -6.000000e+00, -5.900000e+00, -5.800000e+00,
       -5.700000e+00, -5.600000e+00, -5.500000e+00, -5.400000e+00,
       -5.300000e+00, -5.200000e+00, -5.100000e+00, -5.000000e+00,
       -4.900000e+00, -4.800000e+00, -4.700000e+00, -4.600000e+00,
       -4.500000e+00, -4.400000e+00, -4.300000e+00, -4.200000e+00,
       -4.100000e+00, -4.000000e+00, -3.900000e+00, -3.800000e+00,
       -3.700000e+00, -3.600000e+00, -3.500000e+00, -3.400000e+00,
       -3.300000e+00, -3.200000e+00, -3.100000e+00, -3.000000e+00,
       -2.900000e+00, -2.800000e+00, -2.700000e+00, -2.600000e+00,
       -2.500000e+00, -2.400000e+00, -2.300000e+00, -2.200000e+00,
       -2.100000e+00, -2.000000e+00, -1.900000e+00, -1.800000e+00,
       -1.700000e+00, -1.600000e+00, -1.500000e+00, -1.400000e+00,
       -1.300000e+00, -1.200000e+00, -1.100000e+00, -1.000000e+00,
       -9.000000e-01, -8.000000e-01, -7.000000e-01, -6.000000e-01,
       -5.000000e-01, -4.000000e-01, -3.000000e-01, -2.000000e-01,
       -1.000000e-01, -1.023182e-11,  1.000000e-01,  2.000000e-01,
        3.000000e-01,  4.000000e-01,  5.000000e-01,  6.000000e-01,
        7.000000e-01,  8.000000e-01,  9.000000e-01,  1.000000e+00,
        1.100000e+00,  1.200000e+00,  1.300000e+00,  1.400000e+00,
        1.500000e+00,  1.600000e+00,  1.700000e+00,  1.800000e+00,
        1.900000e+00,  2.000000e+00,  2.100000e+00,  2.200000e+00,
        2.300000e+00,  2.400000e+00,  2.500000e+00,  2.600000e+00,
        2.700000e+00,  2.800000e+00,  2.900000e+00,  3.000000e+00,
        3.100000e+00,  3.200000e+00,  3.300000e+00,  3.400000e+00,
        3.500000e+00,  3.600000e+00,  3.700000e+00,  3.800000e+00,
        3.900000e+00,  4.000000e+00,  4.100000e+00,  4.200000e+00,
        4.300000e+00,  4.400000e+00,  4.500000e+00,  4.600000e+00,
        4.700000e+00,  4.800000e+00,  4.900000e+00,  5.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-5f170e53-31bf-430d-aeff-aec111069412' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f170e53-31bf-430d-aeff-aec111069412' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-572e0d0e-5552-4c22-ace7-926d56562702' class='xr-var-data-in' type='checkbox'><label for='data-572e0d0e-5552-4c22-ace7-926d56562702' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-70277f46-99ad-476a-800b-4ba0922b42f4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70277f46-99ad-476a-800b-4ba0922b42f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-374e7098-ed89-4eb7-b5a4-e61e94df6af1' class='xr-var-data-in' type='checkbox'><label for='data-374e7098-ed89-4eb7-b5a4-e61e94df6af1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5cb6dcab-9800-4a91-aba8-a35776cff243' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5cb6dcab-9800-4a91-aba8-a35776cff243' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-9dd6427c-18f0-472f-9d6b-4d7a94cd5a7b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9dd6427c-18f0-472f-9d6b-4d7a94cd5a7b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fcb78b3-643d-466d-b193-f7e3f0d2390d' class='xr-var-data-in' type='checkbox'><label for='data-5fcb78b3-643d-466d-b193-f7e3f0d2390d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Minimum air temperature at 2 meter (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Min 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;</div><input id='attrs-2ca57382-b965-469f-9fb2-95b7b6105ab2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2ca57382-b965-469f-9fb2-95b7b6105ab2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e53dd4ea-a9d6-4fe3-b562-c824e260048e' class='xr-var-data-in' type='checkbox'><label for='data-e53dd4ea-a9d6-4fe3-b562-c824e260048e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>long_name :</span></dt><dd>Coordinate reference system</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.13 kiB </td>
                        <td> 2.13 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273,) </td>
                        <td> (273,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >273</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-5bcff1d9-1bea-45bf-8c9d-714a534e9839' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5bcff1d9-1bea-45bf-8c9d-714a534e9839' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1772f14-97e7-43b5-b163-7c7f06e197a2' class='xr-var-data-in' type='checkbox'><label for='data-e1772f14-97e7-43b5-b163-7c7f06e197a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Maximum air temperature at 2 meter (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Max 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-c31b7d09-6822-4601-9e7b-cc2864f4484d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c31b7d09-6822-4601-9e7b-cc2864f4484d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3f26261-21bd-4e8f-ac4d-7ba694b40bd5' class='xr-var-data-in' type='checkbox'><label for='data-a3f26261-21bd-4e8f-ac4d-7ba694b40bd5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>2 meter air temperature (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-2ee57d4d-2299-4411-888b-119446d63a71' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2ee57d4d-2299-4411-888b-119446d63a71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-397a175e-96e1-4889-be80-e78caed77fc7' class='xr-var-data-in' type='checkbox'><label for='data-397a175e-96e1-4889-be80-e78caed77fc7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>J m-2 d-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Surface solar radiation downwards (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-bdfa05f3-7555-4bc7-83d8-354bcce0cfd3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdfa05f3-7555-4bc7-83d8-354bcce0cfd3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-631a9bc2-3708-41a7-bf0c-468af5c069be' class='xr-var-data-in' type='checkbox'><label for='data-631a9bc2-3708-41a7-bf0c-468af5c069be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm d-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Total precipitation (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_10m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-a6d5a3db-71ad-4806-9c2e-e521705e8986' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a6d5a3db-71ad-4806-9c2e-e521705e8986' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8ff8e42-af92-4fb7-b5d3-1e09bbf3a381' class='xr-var-data-in' type='checkbox'><label for='data-e8ff8e42-af92-4fb7-b5d3-1e09bbf3a381' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>10 metre wind component (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-2d4937b4-5b83-408b-9265-10526a6b084f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d4937b4-5b83-408b-9265-10526a6b084f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4776f20-89a8-44c1-9201-cf48caadb1ff' class='xr-var-data-in' type='checkbox'><label for='data-b4776f20-89a8-44c1-9201-cf48caadb1ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>cm</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Snow depth (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-efffc0ae-74f9-4c2e-89d9-9e459795006e' class='xr-section-summary-in' type='checkbox'  ><label for='section-efffc0ae-74f9-4c2e-89d9-9e459795006e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-950a4d39-68e7-41c8-9fec-f25ca8f46265' class='xr-index-data-in' type='checkbox'/><label for='index-950a4d39-68e7-41c8-9fec-f25ca8f46265' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.900000000009499, -12.800000000009504,  -12.70000000000951,
       -12.600000000009516, -12.500000000009521, -12.400000000009527,
       -12.300000000009533, -12.200000000009538, -12.100000000009544,
        -12.00000000000955,
       ...
         4.099999999989535,   4.199999999989529,   4.299999999989524,
         4.399999999989518,   4.499999999989512,   4.599999999989507,
         4.699999999989501,   4.799999999989495,    4.89999999998949,
         4.999999999989484],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2fb6202e-7bc8-4b4a-8bdf-97ed46700b8f' class='xr-index-data-in' type='checkbox'/><label for='index-2fb6202e-7bc8-4b4a-8bdf-97ed46700b8f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.900000000001654,  60.80000000000166, 60.700000000001666,
        60.60000000000167,  60.50000000000168,  60.40000000000168,
        60.30000000000169, 60.200000000001694,   60.1000000000017,
       60.000000000001705,
       ...
       48.900000000002336,  48.80000000000234,  48.70000000000235,
        48.60000000000235,  48.50000000000236, 48.400000000002365,
        48.30000000000237, 48.200000000002376,  48.10000000000238,
        48.00000000000239],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8d4df0c1-df72-43d0-b116-c15cdc8f3ec2' class='xr-index-data-in' type='checkbox'/><label for='index-8d4df0c1-df72-43d0-b116-c15cdc8f3ec2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e9036074-3541-4627-a7fd-d7c372a6f278' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e9036074-3541-4627-a7fd-d7c372a6f278' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>title :</span></dt><dd>AgERA5 daily weather variables derived from the ECMWF ERA5 reanalysis.</dd><dt><span>institution :</span></dt><dd>Wageningen Environmental Research</dd><dt><span>history :</span></dt><dd>Generated by `pragera5 run_daily_processing 2023-01-01` version 1.2.0, executed on 2025-03-07 12:00:44.087250</dd><dt><span>references :</span></dt><dd>https://doi.org/10.24381/cds.6c68c9bb</dd><dt><span>source :</span></dt><dd>ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="era5-land">
<h4>ERA5-Land<a class="headerlink" href="#era5-land" title="Link to this heading">#</a></h4>
<p>The process to download data from ERA5-Land is similar to that for AgERA5 above:
defining a template and variable-specific requests.
A difference is that data will be downloaded from two CDS datasets.
The <a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank"><em>ERA5-Land hourly data from 1950 to present</em></a> dataset contains hourly data for variables like 2 m temperature as well as accumulated data for variables like solar irradiation.
For the use case in this assessment, we are only interested in the daily accumulated data.
<a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank"><em>ERA5-Land post-processed daily statistics from 1950 to present</em></a> provides daily minimum/maximum/mean statistics for the hourly variables, saving us the effort of aggregating these ourselves.
In the following subsections, the data (accumulated and daily statistics) are downloaded and harmonised to the same format as AgERA5.</p>
<section id="accumulated-data-from-era5-land">
<h5>Accumulated data from ERA5-Land<a class="headerlink" href="#accumulated-data-from-era5-land" title="Link to this heading">#</a></h5>
<p>The <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation#heading-Accumulations" rel="noreferrer" target="_blank">documentation for ERA5-Land</a> explains:</p>
<blockquote>
<div><p>The accumulations in the short forecasts of ERA5-Land (with hourly steps from 01 to 24) are treated the same as those in ERA-Interim or ERA-Interim/Land, i.e., they are accumulated from the beginning of the forecast to the end of the forecast step. For example, runoff at day=D, step=12 will provide runoff accumulated from day=D, time=0 to day=D, time=12. The maximum accumulation is over 24 hours, i.e., from day=D, time=0 to day=D+1,time=0 (step=24). For the CDS time, or validity time, of 00 UTC, the accumulations are over the 24 hours ending at 00 UTC i.e. the accumulation is during the previous day.</p>
</div></blockquote>
<p>In practice, this means that one needs to download data for <em>day+1</em> (e.g. 2 January 2023) to get the total accumulated value for <em>day</em> (1 January 2023).
Hence, for this specific dataset, our existing <code class="docutils literal notranslate"><span class="pre">request_time</span></code> will download data for 2022-12-31 ‚Äì 2023-09-29, so we need to add one extra day.
This is achieved by adding a second request for just the extra day to the earthkit-data download.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era5land_ID</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land&quot;</span>

<span class="c1"># Default parameters</span>
<span class="n">request_era5land_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>  <span class="c1"># Downloading in NetCDF changes the time format, causing a 1-day offset</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;unarchived&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default</span><span class="p">)</span>

<span class="c1"># Additional day (accounting for accumulated format)</span>
<span class="n">request_extraday</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">months</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>  <span class="c1"># If months was range(1, 10), it downloaded 1,2,3,4,5,6,7,8,9 and this adds 10</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request_era5land_default_extraday</span> <span class="o">=</span> <span class="n">request_era5land_default</span> <span class="o">|</span> <span class="n">request_extraday</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Extra-day request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default_extraday</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for reanalysis-era5-land:
{&#39;time&#39;: [&#39;00:00&#39;],
 &#39;data_format&#39;: &#39;grib&#39;,
 &#39;download_format&#39;: &#39;unarchived&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}

Extra-day request template for reanalysis-era5-land:
{&#39;time&#39;: [&#39;00:00&#39;],
 &#39;data_format&#39;: &#39;grib&#39;,
 &#39;download_format&#39;: &#39;unarchived&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: &#39;10&#39;,
 &#39;day&#39;: &#39;01&#39;}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the requests for each of the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_irradation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;surface_solar_radiation_downwards&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_rain</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;total_precipitation&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests_era5land_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_irradation</span><span class="p">,</span>
                               <span class="n">request_rain</span><span class="p">,</span>
                              <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_era5land</span>          <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default</span>          <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>
<span class="n">requests_era5land_extraday</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default_extraday</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>

<span class="c1"># Download data and convert to desired format</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">era5land_ID</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_era5land</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_era5land_extraday</span><span class="p">)</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Inspecting the resulting dataset
(in xarray format)
shows that the <code class="docutils literal notranslate"><span class="pre">forecast_reference_time</span></code> coordinate conveniently matches the variable to the day of accumulation.
It is important to note that this is not true if the data are downloaded in NetCDF format,
in which case there is a 1-day offset;
beware of this difference if modifying this notebook yourself.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_era5land_accumulated</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 104MB
Dimensions:                  (forecast_reference_time: 274, latitude: 131,
                              longitude: 181)
Coordinates:
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 2kB 202...
  * latitude                 (latitude) float64 1kB 61.0 60.9 60.8 ... 48.1 48.0
  * longitude                (longitude) float64 1kB -13.0 -12.9 ... 4.9 5.0
Data variables:
    ssrd                     (forecast_reference_time, latitude, longitude) float64 52MB ...
    tp                       (forecast_reference_time, latitude, longitude) float64 52MB ...
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-213a1437-9cc5-48da-aac0-075900e8da82' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-213a1437-9cc5-48da-aac0-075900e8da82' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>forecast_reference_time</span>: 274</li><li><span class='xr-has-index'>latitude</span>: 131</li><li><span class='xr-has-index'>longitude</span>: 181</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-895e4b0e-2517-4e4b-879f-90efe1bc2248' class='xr-section-summary-in' type='checkbox'  checked><label for='section-895e4b0e-2517-4e4b-879f-90efe1bc2248' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_reference_time</span></div><div class='xr-var-dims'>(forecast_reference_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-12-31 ... 2023-09-30</div><input id='attrs-50f6df73-efd2-459d-bdb5-4c761e4f4513' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-50f6df73-efd2-459d-bdb5-4c761e4f4513' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd252c5d-ecb2-4e1e-b296-d1f19cb380f8' class='xr-var-data-in' type='checkbox'><label for='data-dd252c5d-ecb2-4e1e-b296-d1f19cb380f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-12-31T00:00:00.000000000&#x27;, &#x27;2023-01-01T00:00:00.000000000&#x27;,
       &#x27;2023-01-02T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(274,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>61.0 60.9 60.8 ... 48.2 48.1 48.0</div><input id='attrs-d4ed24f5-4128-45f0-bc9f-6e77ade719de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4ed24f5-4128-45f0-bc9f-6e77ade719de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98179c0c-2905-4aed-9fc1-3afa4607b21a' class='xr-var-data-in' type='checkbox'><label for='data-98179c0c-2905-4aed-9fc1-3afa4607b21a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([61. , 60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9,
       59.8, 59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7,
       58.6, 58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5,
       57.4, 57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3,
       56.2, 56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1,
       55. , 54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9,
       53.8, 53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7,
       52.6, 52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5,
       51.4, 51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3,
       50.2, 50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1,
       49. , 48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-13.0 -12.9 -12.8 ... 4.8 4.9 5.0</div><input id='attrs-d5319165-4af8-4be8-b320-eaca82a9b394' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d5319165-4af8-4be8-b320-eaca82a9b394' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abec07de-2cc4-4054-a708-39f28802c1b6' class='xr-var-data-in' type='checkbox'><label for='data-abec07de-2cc4-4054-a708-39f28802c1b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-1.300000e+01, -1.290000e+01, -1.280000e+01, -1.270000e+01,
       -1.260000e+01, -1.250000e+01, -1.240000e+01, -1.230000e+01,
       -1.220000e+01, -1.210000e+01, -1.200000e+01, -1.190000e+01,
       -1.180000e+01, -1.170000e+01, -1.160000e+01, -1.150000e+01,
       -1.140000e+01, -1.130000e+01, -1.120000e+01, -1.110000e+01,
       -1.100000e+01, -1.090000e+01, -1.080000e+01, -1.070000e+01,
       -1.060000e+01, -1.050000e+01, -1.040000e+01, -1.030000e+01,
       -1.020000e+01, -1.010000e+01, -1.000000e+01, -9.900000e+00,
       -9.800000e+00, -9.700000e+00, -9.600000e+00, -9.500000e+00,
       -9.400000e+00, -9.300000e+00, -9.200000e+00, -9.100000e+00,
       -9.000000e+00, -8.900000e+00, -8.800000e+00, -8.700000e+00,
       -8.600000e+00, -8.500000e+00, -8.400000e+00, -8.300000e+00,
       -8.200000e+00, -8.100000e+00, -8.000000e+00, -7.900000e+00,
       -7.800000e+00, -7.700000e+00, -7.600000e+00, -7.500000e+00,
       -7.400000e+00, -7.300000e+00, -7.200000e+00, -7.100000e+00,
       -7.000000e+00, -6.900000e+00, -6.800000e+00, -6.700000e+00,
       -6.600000e+00, -6.500000e+00, -6.400000e+00, -6.300000e+00,
       -6.200000e+00, -6.100000e+00, -6.000000e+00, -5.900000e+00,
       -5.800000e+00, -5.700000e+00, -5.600000e+00, -5.500000e+00,
       -5.400000e+00, -5.300000e+00, -5.200000e+00, -5.100000e+00,
       -5.000000e+00, -4.900000e+00, -4.800000e+00, -4.700000e+00,
       -4.600000e+00, -4.500000e+00, -4.400000e+00, -4.300000e+00,
       -4.200000e+00, -4.100000e+00, -4.000000e+00, -3.900000e+00,
       -3.800000e+00, -3.700000e+00, -3.600000e+00, -3.500000e+00,
       -3.400000e+00, -3.300000e+00, -3.200000e+00, -3.100000e+00,
       -3.000000e+00, -2.900000e+00, -2.800000e+00, -2.700000e+00,
       -2.600000e+00, -2.500000e+00, -2.400000e+00, -2.300000e+00,
       -2.200000e+00, -2.100000e+00, -2.000000e+00, -1.900000e+00,
       -1.800000e+00, -1.700000e+00, -1.600000e+00, -1.500000e+00,
       -1.400000e+00, -1.300000e+00, -1.200000e+00, -1.100000e+00,
       -1.000000e+00, -9.000000e-01, -8.000000e-01, -7.000000e-01,
       -6.000000e-01, -5.000000e-01, -4.000000e-01, -3.000000e-01,
       -2.000000e-01, -1.000000e-01, -2.944867e-14,  1.000000e-01,
        2.000000e-01,  3.000000e-01,  4.000000e-01,  5.000000e-01,
        6.000000e-01,  7.000000e-01,  8.000000e-01,  9.000000e-01,
        1.000000e+00,  1.100000e+00,  1.200000e+00,  1.300000e+00,
        1.400000e+00,  1.500000e+00,  1.600000e+00,  1.700000e+00,
        1.800000e+00,  1.900000e+00,  2.000000e+00,  2.100000e+00,
        2.200000e+00,  2.300000e+00,  2.400000e+00,  2.500000e+00,
        2.600000e+00,  2.700000e+00,  2.800000e+00,  2.900000e+00,
        3.000000e+00,  3.100000e+00,  3.200000e+00,  3.300000e+00,
        3.400000e+00,  3.500000e+00,  3.600000e+00,  3.700000e+00,
        3.800000e+00,  3.900000e+00,  4.000000e+00,  4.100000e+00,
        4.200000e+00,  4.300000e+00,  4.400000e+00,  4.500000e+00,
        4.600000e+00,  4.700000e+00,  4.800000e+00,  4.900000e+00,
        5.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c9a7c922-becd-41c9-bad7-13cfeba2b0fa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c9a7c922-becd-41c9-bad7-13cfeba2b0fa' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ssrd</span></div><div class='xr-var-dims'>(forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2b880a95-1649-4da9-a47a-e27d66386e4d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b880a95-1649-4da9-a47a-e27d66386e4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e9ceeaa-de5a-4289-aaea-18c01b02815f' class='xr-var-data-in' type='checkbox'><label for='data-3e9ceeaa-de5a-4289-aaea-18c01b02815f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface short-wave (solar) radiation downwards</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>J m**-2</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><pre>[6496814 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5cecbbb7-a1c7-48f2-a789-1490d53b897f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5cecbbb7-a1c7-48f2-a789-1490d53b897f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9697c8d9-c4e3-48ab-b7dd-21ad94d46cbe' class='xr-var-data-in' type='checkbox'><label for='data-9697c8d9-c4e3-48ab-b7dd-21ad94d46cbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><pre>[6496814 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6cd75b7e-6520-4481-b649-44cd67d65629' class='xr-section-summary-in' type='checkbox'  ><label for='section-6cd75b7e-6520-4481-b649-44cd67d65629' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>forecast_reference_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-010f6b2a-6290-4cc2-9f76-a5c6628785d9' class='xr-index-data-in' type='checkbox'/><label for='index-010f6b2a-6290-4cc2-9f76-a5c6628785d9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-12-31&#x27;, &#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;,
               &#x27;2023-01-04&#x27;, &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;,
               &#x27;2023-01-08&#x27;, &#x27;2023-01-09&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;forecast_reference_time&#x27;, length=274, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8bef9fcd-144b-4142-b4da-ce6105a7e4c7' class='xr-index-data-in' type='checkbox'/><label for='index-8bef9fcd-144b-4142-b4da-ce6105a7e4c7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              61.0,               60.9,               60.8,
       60.699999999999996, 60.599999999999994,  60.49999999999999,
        60.39999999999999,  60.29999999999999,  60.19999999999999,
        60.09999999999999,
       ...
        48.89999999999983,  48.79999999999983, 48.699999999999825,
       48.599999999999824,  48.49999999999982,  48.39999999999982,
        48.29999999999982,  48.19999999999982,  48.09999999999982,
                     48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=131))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-75ac8869-63d7-4933-a24a-9ba0556180c6' class='xr-index-data-in' type='checkbox'/><label for='index-75ac8869-63d7-4933-a24a-9ba0556180c6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -13.0,               -12.9,               -12.8,
       -12.700000000000001, -12.600000000000001, -12.500000000000002,
       -12.400000000000002, -12.300000000000002, -12.200000000000003,
       -12.100000000000003,
       ...
         4.099999999999973,   4.199999999999973,   4.299999999999972,
         4.399999999999972,   4.499999999999972,   4.599999999999971,
         4.699999999999971,  4.7999999999999705,    4.89999999999997,
                       5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=181))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7a1f0ffe-38e2-42fd-b299-2e46338e1430' class='xr-section-summary-in' type='checkbox'  ><label for='section-7a1f0ffe-38e2-42fd-b299-2e46338e1430' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="daily-statistics-from-the-post-processed-era5-land-dataset">
<h5>Daily statistics from the post-processed ERA5-Land dataset<a class="headerlink" href="#daily-statistics-from-the-post-processed-era5-land-dataset" title="Link to this heading">#</a></h5>
<p>The daily statistics are indexed according to the day they apply to,
like AgERA5,
meaning we do not need to worry about adding extra days here.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era5land_ID</span> <span class="o">=</span> <span class="s2">&quot;derived-era5-land-daily-statistics&quot;</span>

<span class="n">request_era5land_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;utc+00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="s2">&quot;1_hourly&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for derived-era5-land-daily-statistics:
{&#39;time_zone&#39;: &#39;utc+00:00&#39;,
 &#39;frequency&#39;: &#39;1_hourly&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the requests for each of the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temperature has to be split into separate requests because of size limits</span>
<span class="n">request_temperature_min</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_minimum&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_temperature_max</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_maximum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_mean</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Wind is downloaded as two separate components</span>
<span class="n">request_wind_u</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_u_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_wind_v</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_v_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_snow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;snow_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests_era5land_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_temperature_min</span><span class="p">,</span> <span class="n">request_temperature_max</span><span class="p">,</span> <span class="n">request_temperature_mean</span><span class="p">,</span>
                               <span class="n">request_wind_u</span><span class="p">,</span> <span class="n">request_wind_v</span><span class="p">,</span>
                               <span class="n">request_snow</span><span class="p">,</span>
                              <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.
Here, we download the different variables separately in anticipation of the harmonisation step in the next subsection.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>

<span class="c1"># Download data and convert to desired format</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">era5land_ID</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests_era5land</span><span class="p">]</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">data_era5land</span><span class="p">]</span>
<span class="n">data_era5land_temperature_min</span><span class="p">,</span> <span class="n">data_era5land_temperature_max</span><span class="p">,</span> <span class="n">data_era5land_temperature_mean</span><span class="p">,</span> <span class="n">data_era5land_wind_u</span><span class="p">,</span> <span class="n">data_era5land_wind_v</span><span class="p">,</span> <span class="n">data_era5land_snow</span> <span class="o">=</span> <span class="n">data_era5land</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="pre-processing">
<h5>Pre-processing<a class="headerlink" href="#pre-processing" title="Link to this heading">#</a></h5>
<p>The ERA5-Land dataset is set up differently from AgERA5 and requires some pre-processing before the two can be intercompared.
This involves renaming coordinates and variables, and adjusting units.</p>
<p>For the accumulated data, the following steps are necessary:</p>
<ul class="simple">
<li><p>Rename the variables and coordinates to match those in AgERA5.</p></li>
<li><p>Select data within the desired time window only.</p></li>
<li><p>Convert the units for precipitation to mm.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename variables and coordinates</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ssrd&quot;</span><span class="p">:</span> <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">,</span>
                                                              <span class="s2">&quot;tp&quot;</span><span class="p">:</span> <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">,</span>
                                                              <span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> 
                                                              <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">})</span>
<span class="c1"># Select only relevant dates</span>
<span class="n">time_window</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">months</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">months</span><span class="o">.</span><span class="n">stop</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">)</span>  <span class="c1"># [2023-01-01, 2023-10-01) == [2023-01-01, 2023-09-30]</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_window</span><span class="p">)</span>

<span class="c1"># Unit conversions</span>
<span class="n">convert_m2mm</span><span class="p">(</span><span class="n">data_era5land_accumulated</span><span class="p">,</span> <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For the daily statistics, the steps are as follows:</p>
<ul class="simple">
<li><p>Rename the temperature variables from just <code class="docutils literal notranslate"><span class="pre">t2m</span></code> to maximum, mean, minimum.</p></li>
<li><p>Calculate 10 m wind speed from its U (east‚Äìwest) and V (north‚Äìsouth) components.</p></li>
<li><p>Rename the snow variable and convert its units to cm.</p></li>
<li><p>Combine the pre-processed variables into one dataset.</p></li>
<li><p>Rename coordinates to match AgERA5‚Äôs.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename and combine temperature variables</span>
<span class="n">data_era5land_temperature_max</span>  <span class="o">=</span> <span class="n">data_era5land_temperature_max</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="p">{</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature_mean</span> <span class="o">=</span> <span class="n">data_era5land_temperature_mean</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature_min</span>  <span class="o">=</span> <span class="n">data_era5land_temperature_min</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="p">{</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_temperature_min</span><span class="p">,</span> <span class="n">data_era5land_temperature_max</span><span class="p">,</span> <span class="n">data_era5land_temperature_mean</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>

<span class="c1"># Calculate 10 m wind speed</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_wind_u</span><span class="p">,</span> <span class="n">data_era5land_wind_v</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">data_era5land_wind</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data_era5land_wind</span><span class="p">[</span><span class="s2">&quot;u10&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">data_era5land_wind</span><span class="p">[</span><span class="s2">&quot;v10&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)}</span>
<span class="p">)</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">data_era5land_wind</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;u10&quot;</span><span class="p">,</span> <span class="s2">&quot;v10&quot;</span><span class="p">])</span>

<span class="c1"># Rename snow and convert its units</span>
<span class="n">data_era5land_snow</span> <span class="o">=</span> <span class="n">data_era5land_snow</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;sde&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">})</span>
<span class="n">convert_m2cm</span><span class="p">(</span><span class="n">data_era5land_snow</span><span class="p">,</span> <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">)</span>

<span class="c1"># Combine into one dataset</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_temperature</span><span class="p">,</span> <span class="n">data_era5land_wind</span><span class="p">,</span> <span class="n">data_era5land_snow</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>

<span class="c1"># Rename coordinates</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">data_era5land</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;valid_time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">})</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">data_era5land</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>  <span class="c1"># Remove unneeded dimension</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Lastly, the accumulated data and daily statistics are combined into one xarray object:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert both to (same) Dask</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_era5land_accumulated</span><span class="p">)</span>
<span class="n">data_era5land</span>             <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>

<span class="c1"># Combine and display</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_accumulated</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>
<span class="n">data_era5land</span>  <span class="c1"># Display in notebook</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 233MB
Dimensions:                      (time: 273, lat: 131, lon: 181)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 61.0 60.9 60.8 ... 48.1 48.0
  * lon                          (lon) float64 1kB -13.0 -12.9 -12.8 ... 4.9 5.0
Data variables:
    Solar_Radiation_Flux         (time, lat, lon) float64 52MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float64 52MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Wind_Speed_10m_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-aa99aff4-a834-4dbe-9298-385c3cad0f47' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-aa99aff4-a834-4dbe-9298-385c3cad0f47' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 131</li><li><span class='xr-has-index'>lon</span>: 181</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fb856fe5-5d49-4bfc-b509-ac11906a1bf6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fb856fe5-5d49-4bfc-b509-ac11906a1bf6' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-5abaaa2b-8a71-479f-8920-cd155fe454d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5abaaa2b-8a71-479f-8920-cd155fe454d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35af4cbc-b0b7-4428-9566-6a1b5a262c8b' class='xr-var-data-in' type='checkbox'><label for='data-35af4cbc-b0b7-4428-9566-6a1b5a262c8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>61.0 60.9 60.8 ... 48.2 48.1 48.0</div><input id='attrs-e48f955a-ff40-4296-9e1c-abf271322c05' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e48f955a-ff40-4296-9e1c-abf271322c05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d8481f8-7693-46f0-92c8-99ffce30b2f3' class='xr-var-data-in' type='checkbox'><label for='data-5d8481f8-7693-46f0-92c8-99ffce30b2f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([61. , 60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9,
       59.8, 59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7,
       58.6, 58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5,
       57.4, 57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3,
       56.2, 56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1,
       55. , 54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9,
       53.8, 53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7,
       52.6, 52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5,
       51.4, 51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3,
       50.2, 50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1,
       49. , 48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-13.0 -12.9 -12.8 ... 4.8 4.9 5.0</div><input id='attrs-7aa6a9f1-644d-4361-8e54-86939c0a94a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7aa6a9f1-644d-4361-8e54-86939c0a94a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4388d066-1521-4d92-8c89-20eaf6241bae' class='xr-var-data-in' type='checkbox'><label for='data-4388d066-1521-4d92-8c89-20eaf6241bae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-1.300000e+01, -1.290000e+01, -1.280000e+01, -1.270000e+01,
       -1.260000e+01, -1.250000e+01, -1.240000e+01, -1.230000e+01,
       -1.220000e+01, -1.210000e+01, -1.200000e+01, -1.190000e+01,
       -1.180000e+01, -1.170000e+01, -1.160000e+01, -1.150000e+01,
       -1.140000e+01, -1.130000e+01, -1.120000e+01, -1.110000e+01,
       -1.100000e+01, -1.090000e+01, -1.080000e+01, -1.070000e+01,
       -1.060000e+01, -1.050000e+01, -1.040000e+01, -1.030000e+01,
       -1.020000e+01, -1.010000e+01, -1.000000e+01, -9.900000e+00,
       -9.800000e+00, -9.700000e+00, -9.600000e+00, -9.500000e+00,
       -9.400000e+00, -9.300000e+00, -9.200000e+00, -9.100000e+00,
       -9.000000e+00, -8.900000e+00, -8.800000e+00, -8.700000e+00,
       -8.600000e+00, -8.500000e+00, -8.400000e+00, -8.300000e+00,
       -8.200000e+00, -8.100000e+00, -8.000000e+00, -7.900000e+00,
       -7.800000e+00, -7.700000e+00, -7.600000e+00, -7.500000e+00,
       -7.400000e+00, -7.300000e+00, -7.200000e+00, -7.100000e+00,
       -7.000000e+00, -6.900000e+00, -6.800000e+00, -6.700000e+00,
       -6.600000e+00, -6.500000e+00, -6.400000e+00, -6.300000e+00,
       -6.200000e+00, -6.100000e+00, -6.000000e+00, -5.900000e+00,
       -5.800000e+00, -5.700000e+00, -5.600000e+00, -5.500000e+00,
       -5.400000e+00, -5.300000e+00, -5.200000e+00, -5.100000e+00,
       -5.000000e+00, -4.900000e+00, -4.800000e+00, -4.700000e+00,
       -4.600000e+00, -4.500000e+00, -4.400000e+00, -4.300000e+00,
       -4.200000e+00, -4.100000e+00, -4.000000e+00, -3.900000e+00,
       -3.800000e+00, -3.700000e+00, -3.600000e+00, -3.500000e+00,
       -3.400000e+00, -3.300000e+00, -3.200000e+00, -3.100000e+00,
       -3.000000e+00, -2.900000e+00, -2.800000e+00, -2.700000e+00,
       -2.600000e+00, -2.500000e+00, -2.400000e+00, -2.300000e+00,
       -2.200000e+00, -2.100000e+00, -2.000000e+00, -1.900000e+00,
       -1.800000e+00, -1.700000e+00, -1.600000e+00, -1.500000e+00,
       -1.400000e+00, -1.300000e+00, -1.200000e+00, -1.100000e+00,
       -1.000000e+00, -9.000000e-01, -8.000000e-01, -7.000000e-01,
       -6.000000e-01, -5.000000e-01, -4.000000e-01, -3.000000e-01,
       -2.000000e-01, -1.000000e-01, -2.944867e-14,  1.000000e-01,
        2.000000e-01,  3.000000e-01,  4.000000e-01,  5.000000e-01,
        6.000000e-01,  7.000000e-01,  8.000000e-01,  9.000000e-01,
        1.000000e+00,  1.100000e+00,  1.200000e+00,  1.300000e+00,
        1.400000e+00,  1.500000e+00,  1.600000e+00,  1.700000e+00,
        1.800000e+00,  1.900000e+00,  2.000000e+00,  2.100000e+00,
        2.200000e+00,  2.300000e+00,  2.400000e+00,  2.500000e+00,
        2.600000e+00,  2.700000e+00,  2.800000e+00,  2.900000e+00,
        3.000000e+00,  3.100000e+00,  3.200000e+00,  3.300000e+00,
        3.400000e+00,  3.500000e+00,  3.600000e+00,  3.700000e+00,
        3.800000e+00,  3.900000e+00,  4.000000e+00,  4.100000e+00,
        4.200000e+00,  4.300000e+00,  4.400000e+00,  4.500000e+00,
        4.600000e+00,  4.700000e+00,  4.800000e+00,  4.900000e+00,
        5.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f78419d2-89ba-46be-8bde-b158b3dc8391' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f78419d2-89ba-46be-8bde-b158b3dc8391' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-e3f8b58c-7ab6-4b72-a34d-ee16f17b2b90' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e3f8b58c-7ab6-4b72-a34d-ee16f17b2b90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2684b91-5bde-410b-96a1-79778c003c3a' class='xr-var-data-in' type='checkbox'><label for='data-e2684b91-5bde-410b-96a1-79778c003c3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface short-wave (solar) radiation downwards</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>J m**-2</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 49.39 MiB </td>
                        <td> 49.39 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-0b5c05be-3aac-48e7-a9fd-f3111dbe1d5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0b5c05be-3aac-48e7-a9fd-f3111dbe1d5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0caa8db7-b238-4c29-80eb-ad2998bd67a1' class='xr-var-data-in' type='checkbox'><label for='data-0caa8db7-b238-4c29-80eb-ad2998bd67a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 49.39 MiB </td>
                        <td> 49.39 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-4a2b1c4e-e547-4d02-874d-64c9dc109cc5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a2b1c4e-e547-4d02-874d-64c9dc109cc5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b68b1353-daa3-4138-9307-ba6f37ebbc60' class='xr-var-data-in' type='checkbox'><label for='data-b68b1353-daa3-4138-9307-ba6f37ebbc60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-e6820c3e-3a00-4d0d-aad6-25584523b912' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e6820c3e-3a00-4d0d-aad6-25584523b912' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7293dcf9-10fe-40f6-a0ec-81b87a561248' class='xr-var-data-in' type='checkbox'><label for='data-7293dcf9-10fe-40f6-a0ec-81b87a561248' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-63812e78-a547-4330-bc97-210cb400c362' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-63812e78-a547-4330-bc97-210cb400c362' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-59dacda6-2baa-4449-92c7-3a424df211ef' class='xr-var-data-in' type='checkbox'><label for='data-59dacda6-2baa-4449-92c7-3a424df211ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_10m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-0040123c-bfd1-48d7-a13b-3c3cfcf16266' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0040123c-bfd1-48d7-a13b-3c3cfcf16266' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-385396da-d255-4857-9bb8-a3bbc40d4dbe' class='xr-var-data-in' type='checkbox'><label for='data-385396da-d255-4857-9bb8-a3bbc40d4dbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 9 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-d4fc2525-82a2-4a46-8ca6-633024fd8f4d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4fc2525-82a2-4a46-8ca6-633024fd8f4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87da8cce-d02c-4ca2-a8d4-669f842f0f9f' class='xr-var-data-in' type='checkbox'><label for='data-87da8cce-d02c-4ca2-a8d4-669f842f0f9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>3066</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sde</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>347.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Snow depth</dd><dt><span>GRIB_shortName :</span></dt><dd>sde</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 4 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ff690a4-406b-4e34-a6d9-7ad41249a79f' class='xr-section-summary-in' type='checkbox'  ><label for='section-8ff690a4-406b-4e34-a6d9-7ad41249a79f' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ec8bf5f7-5b13-4e24-91b3-ee6539e39ae9' class='xr-index-data-in' type='checkbox'/><label for='index-ec8bf5f7-5b13-4e24-91b3-ee6539e39ae9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-41c688ff-f18c-47f8-af9a-f4c16ddd9f0c' class='xr-index-data-in' type='checkbox'/><label for='index-41c688ff-f18c-47f8-af9a-f4c16ddd9f0c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              61.0,               60.9,               60.8,
       60.699999999999996, 60.599999999999994,  60.49999999999999,
        60.39999999999999,  60.29999999999999,  60.19999999999999,
        60.09999999999999,
       ...
        48.89999999999983,  48.79999999999983, 48.699999999999825,
       48.599999999999824,  48.49999999999982,  48.39999999999982,
        48.29999999999982,  48.19999999999982,  48.09999999999982,
                     48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=131))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fea33c93-211e-4c80-b67e-6ebf2c638afc' class='xr-index-data-in' type='checkbox'/><label for='index-fea33c93-211e-4c80-b67e-6ebf2c638afc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -13.0,               -12.9,               -12.8,
       -12.700000000000001, -12.600000000000001, -12.500000000000002,
       -12.400000000000002, -12.300000000000002, -12.200000000000003,
       -12.100000000000003,
       ...
         4.099999999999973,   4.199999999999973,   4.299999999999972,
         4.399999999999972,   4.499999999999972,   4.599999999999971,
         4.699999999999971,  4.7999999999999705,    4.89999999999997,
                       5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=181))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-24060bc7-1184-45a3-b226-ee468e031d71' class='xr-section-summary-in' type='checkbox'  ><label for='section-24060bc7-1184-45a3-b226-ee468e031d71' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="harmonise-datasets">
<h4>Harmonise datasets<a class="headerlink" href="#harmonise-datasets" title="Link to this heading">#</a></h4>
<p>Before the data can be analysed, the two datasets (AgERA5 and ERA5-Land) must be aligned in terms of coordinates and variable names.</p>
<section id="grid-alignment">
<h5>Grid alignment<a class="headerlink" href="#grid-alignment" title="Link to this heading">#</a></h5>
<p>Both datasets are provided on a regular 0.1¬∞ by 0.1¬∞ grid, so no regridding is necessary.
However, two steps need to be taken before the data can be compared directly:</p>
<ul class="simple">
<li><p>Their representation as floating-point numbers can cause very small differences to appear, which do not reflect any real differences in the data but are difficult for software (in this case xarray) to work with. Knowing that the data are on a regular 0.1¬∞ by 0.1¬∞ grid, we can simply round all of the coordinates to 2 digits to force them to be the same.</p></li>
<li><p>The bounds of the datasets (in space and in time) are slightly different and need to be aligned.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Round coordinates before alignment to avoid floating-point errors</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">round_coordinates</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">round_coordinates</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>

<span class="c1"># Align data using an inner join</span>
<span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="units-and-variable-names">
<h5>Units and variable names<a class="headerlink" href="#units-and-variable-names" title="Link to this heading">#</a></h5>
<p>Temperatures are provided in K in both datasets ‚Äì here, we convert these to ¬∞C which is more commonly used in agricultural studies.
Solar irradiation is converted from J/m¬≤/d to MJ/m¬≤/d which is more intuitive, with 2.45 MJ/m¬≤ approximately equivalent to 1 mm of potential water evaporation [<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>].
The ‚Äúlong‚Äù names of variables and units, as stored in xarray metadata, are also harmonised between the two datasets to simplify the analysis steps and figures later on.
This is not strictly necessary, but it is convenient when intercomparing two datasets.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert temperatures to ¬∞C</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">VARIABLES_TEMPERATURE</span><span class="p">:</span>
    <span class="n">convert_K2C</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="n">var</span><span class="p">)</span>
    <span class="n">convert_K2C</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>

<span class="c1"># Convert irradiation to MJ/m¬≤/d</span>
<span class="n">convert_J2MJ</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">)</span>
<span class="n">convert_J2MJ</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">)</span>

<span class="c1"># Harmonise variable/unit names</span>
<span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">adjust_names</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="s2">&quot;AgERA5&quot;</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">adjust_names</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="s2">&quot;ERA5-Land&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="id1">
<h4>Derived variables<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Lastly, the derived variables of 2 m wind speed, effective temperature, and cumulative growing degree-days are calculated and added to both datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add 2 m wind speed (from 10 m wind speed)</span>
<span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add effective temperature and cumulative growing degree-days</span>
<span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">add_growing_degree_days</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">add_growing_degree_days</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find day of emergence / anthesis / maturiy</span>
<span class="c1"># Values for temperate maize from https://github.com/ajwdewit/WOFOST_crop_parameters</span>
<span class="c1"># converted from per-stage (110, 695, 800) to totals (110, 110+695, 110+695+800)</span>
<span class="n">tsum_thresholds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;emergence&quot;</span><span class="p">:</span> <span class="mi">110</span><span class="p">,</span> <span class="s2">&quot;anthesis&quot;</span><span class="p">:</span> <span class="mi">805</span><span class="p">,</span> <span class="s2">&quot;maturity&quot;</span><span class="p">:</span> <span class="mi">1605</span><span class="p">}</span>
<span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">add_days_of_tsum</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="o">**</span><span class="n">tsum_thresholds</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">add_days_of_tsum</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="o">**</span><span class="n">tsum_thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_agera5</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 230MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
Data variables: (12/13)
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    crs                          (time) int64 2kB dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Solar_Radiation_Flux         (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    ...                           ...
    Wind_Speed_2m_Mean_24h       (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Effective        (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Growing_Degree_Days          (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Day_of_emergence             (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
    Day_of_anthesis              (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
    Day_of_maturity              (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
Attributes:
    Conventions:  CF-1.7
    title:        AgERA5 daily weather variables derived from the ECMWF ERA5 ...
    institution:  Wageningen Environmental Research
    history:      Generated by `pragera5 run_daily_processing 2023-01-01` ver...
    references:   https://doi.org/10.24381/cds.6c68c9bb
    source:       ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf
    name:         AgERA5</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0ed6c25b-b0ea-4cce-8aba-2fc2707144a5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0ed6c25b-b0ea-4cce-8aba-2fc2707144a5' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-bd31d209-394d-4fc4-9d06-29d78ceb331a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bd31d209-394d-4fc4-9d06-29d78ceb331a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-de235b13-e3b8-47b6-9f48-8d1596d8120b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de235b13-e3b8-47b6-9f48-8d1596d8120b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-984ef1a6-3755-4c27-b304-2a80bb4e9597' class='xr-var-data-in' type='checkbox'><label for='data-984ef1a6-3755-4c27-b304-2a80bb4e9597' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-2f763556-124b-45b6-9bbc-13c0bf9e7c1e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f763556-124b-45b6-9bbc-13c0bf9e7c1e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c82eb49e-f8c9-46fa-92fe-dfb131c40b83' class='xr-var-data-in' type='checkbox'><label for='data-c82eb49e-f8c9-46fa-92fe-dfb131c40b83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-6980de57-9f4d-4081-8604-b66bf2968df4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6980de57-9f4d-4081-8604-b66bf2968df4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08201c57-c5ab-4858-aa81-9c969102abb1' class='xr-var-data-in' type='checkbox'><label for='data-08201c57-c5ab-4858-aa81-9c969102abb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12. ,
       -11.9, -11.8, -11.7, -11.6, -11.5, -11.4, -11.3, -11.2, -11.1, -11. ,
       -10.9, -10.8, -10.7, -10.6, -10.5, -10.4, -10.3, -10.2, -10.1, -10. ,
        -9.9,  -9.8,  -9.7,  -9.6,  -9.5,  -9.4,  -9.3,  -9.2,  -9.1,  -9. ,
        -8.9,  -8.8,  -8.7,  -8.6,  -8.5,  -8.4,  -8.3,  -8.2,  -8.1,  -8. ,
        -7.9,  -7.8,  -7.7,  -7.6,  -7.5,  -7.4,  -7.3,  -7.2,  -7.1,  -7. ,
        -6.9,  -6.8,  -6.7,  -6.6,  -6.5,  -6.4,  -6.3,  -6.2,  -6.1,  -6. ,
        -5.9,  -5.8,  -5.7,  -5.6,  -5.5,  -5.4,  -5.3,  -5.2,  -5.1,  -5. ,
        -4.9,  -4.8,  -4.7,  -4.6,  -4.5,  -4.4,  -4.3,  -4.2,  -4.1,  -4. ,
        -3.9,  -3.8,  -3.7,  -3.6,  -3.5,  -3.4,  -3.3,  -3.2,  -3.1,  -3. ,
        -2.9,  -2.8,  -2.7,  -2.6,  -2.5,  -2.4,  -2.3,  -2.2,  -2.1,  -2. ,
        -1.9,  -1.8,  -1.7,  -1.6,  -1.5,  -1.4,  -1.3,  -1.2,  -1.1,  -1. ,
        -0.9,  -0.8,  -0.7,  -0.6,  -0.5,  -0.4,  -0.3,  -0.2,  -0.1,  -0. ,
         0.1,   0.2,   0.3,   0.4,   0.5,   0.6,   0.7,   0.8,   0.9,   1. ,
         1.1,   1.2,   1.3,   1.4,   1.5,   1.6,   1.7,   1.8,   1.9,   2. ,
         2.1,   2.2,   2.3,   2.4,   2.5,   2.6,   2.7,   2.8,   2.9,   3. ,
         3.1,   3.2,   3.3,   3.4,   3.5,   3.6,   3.7,   3.8,   3.9,   4. ,
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5. ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7f65f07b-5684-4eb3-ab66-50bd25cf5240' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7f65f07b-5684-4eb3-ab66-50bd25cf5240' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-aae439ee-61eb-42b6-ac72-f2c1d95e1655' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aae439ee-61eb-42b6-ac72-f2c1d95e1655' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0f5edf78-4278-4b6f-aafb-decbe0e9adf5' class='xr-var-data-in' type='checkbox'><label for='data-0f5edf78-4278-4b6f-aafb-decbe0e9adf5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (min)</dd><dt><span>temporal_aggregation :</span></dt><dd>Min 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;</div><input id='attrs-730ea923-13fb-4c8d-aee2-997ce54684ad' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-730ea923-13fb-4c8d-aee2-997ce54684ad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1858047b-d9b1-47ae-ab65-08a1732227f3' class='xr-var-data-in' type='checkbox'><label for='data-1858047b-d9b1-47ae-ab65-08a1732227f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>long_name :</span></dt><dd>Coordinate reference system</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.13 kiB </td>
                        <td> 2.13 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273,) </td>
                        <td> (273,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >273</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-cc580b84-5903-4b6c-8761-2eecc55393d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc580b84-5903-4b6c-8761-2eecc55393d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed5d5b16-9822-4fee-831a-2d5ec40640a6' class='xr-var-data-in' type='checkbox'><label for='data-ed5d5b16-9822-4fee-831a-2d5ec40640a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (max)</dd><dt><span>temporal_aggregation :</span></dt><dd>Max 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-aa8df403-a4a6-462c-b728-7865758b8fcd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa8df403-a4a6-462c-b728-7865758b8fcd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05b75a5c-c94e-468d-8037-eb3d1d71d539' class='xr-var-data-in' type='checkbox'><label for='data-05b75a5c-c94e-468d-8037-eb3d1d71d539' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (mean)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-cad9f80f-ce65-4a00-ba31-e53f90b05c8e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cad9f80f-ce65-4a00-ba31-e53f90b05c8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff002904-5ec3-4e53-9963-8516dece4935' class='xr-var-data-in' type='checkbox'><label for='data-ff002904-5ec3-4e53-9963-8516dece4935' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>MJ/m¬≤/d</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Solar irradiation</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-a05bbfde-ba93-4cf5-b6d2-cd476ad8c9c5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a05bbfde-ba93-4cf5-b6d2-cd476ad8c9c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf8ababd-f902-42de-ad35-4cc4a4407958' class='xr-var-data-in' type='checkbox'><label for='data-cf8ababd-f902-42de-ad35-4cc4a4407958' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm/d</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-28199515-2e94-4f10-b7df-b24ab44fee55' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-28199515-2e94-4f10-b7df-b24ab44fee55' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f591b8d9-9533-43ee-a406-27bd49ca0926' class='xr-var-data-in' type='checkbox'><label for='data-f591b8d9-9533-43ee-a406-27bd49ca0926' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>cm</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-2113a657-fb4e-408d-baaa-789fe154ddee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2113a657-fb4e-408d-baaa-789fe154ddee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2203e8be-67c7-4a8d-8efd-cc8e90a341e8' class='xr-var-data-in' type='checkbox'><label for='data-2203e8be-67c7-4a8d-8efd-cc8e90a341e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m/s</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Wind speed (2 m)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Effective</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-92ee4147-0b68-4d3a-b3e5-bf0ab4733242' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92ee4147-0b68-4d3a-b3e5-bf0ab4733242' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14a34c39-f20e-471d-baea-7e6e5dabcf7c' class='xr-var-data-in' type='checkbox'><label for='data-14a34c39-f20e-471d-baea-7e6e5dabcf7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Effective temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 557 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Growing_Degree_Days</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-1a410d0a-17f2-45c2-b88b-0afe0c8b807a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a410d0a-17f2-45c2-b88b-0afe0c8b807a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cef16d6-4bdc-4da8-8788-62a302c5cac7' class='xr-var-data-in' type='checkbox'><label for='data-7cef16d6-4bdc-4da8-8788-62a302c5cac7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Œ£ Growing degree-days</dd><dt><span>units :</span></dt><dd>¬∞C d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 559 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_emergence</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-23798b89-91e4-4297-8939-d502600cea5f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-23798b89-91e4-4297-8939-d502600cea5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ec35741-5479-43d8-87f0-6796867b109e' class='xr-var-data-in' type='checkbox'><label for='data-9ec35741-5479-43d8-87f0-6796867b109e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_emergence</dd><dt><span>long_name :</span></dt><dd>Day of emergence</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 572 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_anthesis</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-3c6d2f43-df87-4b8c-bdce-079b526c3d93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3c6d2f43-df87-4b8c-bdce-079b526c3d93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3bf5c888-ce98-4268-b0f4-07de0eeddc72' class='xr-var-data-in' type='checkbox'><label for='data-3bf5c888-ce98-4268-b0f4-07de0eeddc72' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_anthesis</dd><dt><span>long_name :</span></dt><dd>Day of anthesis</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 572 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_maturity</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-8895d8c6-b394-49dd-aa19-ea365c2f659c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8895d8c6-b394-49dd-aa19-ea365c2f659c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55b9e77b-59ec-45fe-90a0-c90911abfcae' class='xr-var-data-in' type='checkbox'><label for='data-55b9e77b-59ec-45fe-90a0-c90911abfcae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_maturity</dd><dt><span>long_name :</span></dt><dd>Day of maturity</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 572 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-06b18465-d85b-4cc7-a8ef-e2d4517fb14d' class='xr-section-summary-in' type='checkbox'  ><label for='section-06b18465-d85b-4cc7-a8ef-e2d4517fb14d' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-17e8d5a0-0871-42c0-8964-f438e4cb12f3' class='xr-index-data-in' type='checkbox'/><label for='index-17e8d5a0-0871-42c0-8964-f438e4cb12f3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-20bc8bc4-40ee-4564-8f19-d284ecf9b351' class='xr-index-data-in' type='checkbox'/><label for='index-20bc8bc4-40ee-4564-8f19-d284ecf9b351' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60.0,
       ...
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-06683b89-56bf-478c-9f91-3a0575365a55' class='xr-index-data-in' type='checkbox'/><label for='index-06683b89-56bf-478c-9f91-3a0575365a55' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12.0,
       ...
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-79a52a24-0afa-45cb-8471-982f8b0c46fd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-79a52a24-0afa-45cb-8471-982f8b0c46fd' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>title :</span></dt><dd>AgERA5 daily weather variables derived from the ECMWF ERA5 reanalysis.</dd><dt><span>institution :</span></dt><dd>Wageningen Environmental Research</dd><dt><span>history :</span></dt><dd>Generated by `pragera5 run_daily_processing 2023-01-01` version 1.2.0, executed on 2025-03-07 12:00:44.087250</dd><dt><span>references :</span></dt><dd>https://doi.org/10.24381/cds.6c68c9bb</dd><dt><span>source :</span></dt><dd>ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</dd><dt><span>name :</span></dt><dd>AgERA5</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_era5land</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 281MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
Data variables:
    Solar_Radiation_Flux         (time, lat, lon) float64 51MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float64 51MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Wind_Speed_2m_Mean_24h       (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Effective        (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Growing_Degree_Days          (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Day_of_emergence             (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
    Day_of_anthesis              (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
    Day_of_maturity              (lat, lon) float32 94kB dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF
    name:         ERA5-Land</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d865bd80-1c28-403a-8cf8-5ae3f74e5a3a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d865bd80-1c28-403a-8cf8-5ae3f74e5a3a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0f207bf7-6a2e-4d2a-af08-ad6c46d2d618' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0f207bf7-6a2e-4d2a-af08-ad6c46d2d618' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-276fe1b4-8b03-4dac-af6c-71d7a37f1308' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-276fe1b4-8b03-4dac-af6c-71d7a37f1308' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3690ea03-afaf-4b74-b410-4832c1aa4ff0' class='xr-var-data-in' type='checkbox'><label for='data-3690ea03-afaf-4b74-b410-4832c1aa4ff0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-4e3cfc71-b1c0-4688-91b7-1c7ecffc7485' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4e3cfc71-b1c0-4688-91b7-1c7ecffc7485' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-077f6acc-4bed-4424-a05c-f5e372242f06' class='xr-var-data-in' type='checkbox'><label for='data-077f6acc-4bed-4424-a05c-f5e372242f06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-a1317926-2cae-4c15-9ac5-7e586a18ce5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1317926-2cae-4c15-9ac5-7e586a18ce5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ba06d8f-4483-4bf8-9409-e9f8d9858e87' class='xr-var-data-in' type='checkbox'><label for='data-3ba06d8f-4483-4bf8-9409-e9f8d9858e87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12. ,
       -11.9, -11.8, -11.7, -11.6, -11.5, -11.4, -11.3, -11.2, -11.1, -11. ,
       -10.9, -10.8, -10.7, -10.6, -10.5, -10.4, -10.3, -10.2, -10.1, -10. ,
        -9.9,  -9.8,  -9.7,  -9.6,  -9.5,  -9.4,  -9.3,  -9.2,  -9.1,  -9. ,
        -8.9,  -8.8,  -8.7,  -8.6,  -8.5,  -8.4,  -8.3,  -8.2,  -8.1,  -8. ,
        -7.9,  -7.8,  -7.7,  -7.6,  -7.5,  -7.4,  -7.3,  -7.2,  -7.1,  -7. ,
        -6.9,  -6.8,  -6.7,  -6.6,  -6.5,  -6.4,  -6.3,  -6.2,  -6.1,  -6. ,
        -5.9,  -5.8,  -5.7,  -5.6,  -5.5,  -5.4,  -5.3,  -5.2,  -5.1,  -5. ,
        -4.9,  -4.8,  -4.7,  -4.6,  -4.5,  -4.4,  -4.3,  -4.2,  -4.1,  -4. ,
        -3.9,  -3.8,  -3.7,  -3.6,  -3.5,  -3.4,  -3.3,  -3.2,  -3.1,  -3. ,
        -2.9,  -2.8,  -2.7,  -2.6,  -2.5,  -2.4,  -2.3,  -2.2,  -2.1,  -2. ,
        -1.9,  -1.8,  -1.7,  -1.6,  -1.5,  -1.4,  -1.3,  -1.2,  -1.1,  -1. ,
        -0.9,  -0.8,  -0.7,  -0.6,  -0.5,  -0.4,  -0.3,  -0.2,  -0.1,  -0. ,
         0.1,   0.2,   0.3,   0.4,   0.5,   0.6,   0.7,   0.8,   0.9,   1. ,
         1.1,   1.2,   1.3,   1.4,   1.5,   1.6,   1.7,   1.8,   1.9,   2. ,
         2.1,   2.2,   2.3,   2.4,   2.5,   2.6,   2.7,   2.8,   2.9,   3. ,
         3.1,   3.2,   3.3,   3.4,   3.5,   3.6,   3.7,   3.8,   3.9,   4. ,
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5. ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6e1b6f3c-4ffb-433a-be37-0d242c7dae9e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6e1b6f3c-4ffb-433a-be37-0d242c7dae9e' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-18e20c9b-c30e-4412-8159-e78fc4a01f33' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18e20c9b-c30e-4412-8159-e78fc4a01f33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03c1f2a7-4cd5-471a-9011-5c435f72f3e0' class='xr-var-data-in' type='checkbox'><label for='data-03c1f2a7-4cd5-471a-9011-5c435f72f3e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Solar irradiation</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>MJ/m¬≤/d</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 48.74 MiB </td>
                        <td> 48.74 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-f90ed844-b840-4590-b68f-bbc412d936bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f90ed844-b840-4590-b68f-bbc412d936bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3499f68f-f267-43c4-9e3f-add639148fba' class='xr-var-data-in' type='checkbox'><label for='data-3499f68f-f267-43c4-9e3f-add639148fba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>mm/d</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 48.74 MiB </td>
                        <td> 48.74 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-ba150eaf-a079-42ac-a46b-5b4a3361904b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ba150eaf-a079-42ac-a46b-5b4a3361904b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb803f37-0456-41ac-a3d4-14b7d28b8508' class='xr-var-data-in' type='checkbox'><label for='data-cb803f37-0456-41ac-a3d4-14b7d28b8508' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (min)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-0f61558a-c845-4f19-beae-de8586056018' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0f61558a-c845-4f19-beae-de8586056018' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9cc9adeb-8dab-4690-be97-ecfb56fcbceb' class='xr-var-data-in' type='checkbox'><label for='data-9cc9adeb-8dab-4690-be97-ecfb56fcbceb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (max)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-ab681996-7fb5-4f85-8bc7-221c3ceed382' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ab681996-7fb5-4f85-8bc7-221c3ceed382' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-07062734-75cb-4bb9-b4bb-b9ec0e3b79f0' class='xr-var-data-in' type='checkbox'><label for='data-07062734-75cb-4bb9-b4bb-b9ec0e3b79f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (mean)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-ccad7cd5-4eaa-43b0-8067-498906081690' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ccad7cd5-4eaa-43b0-8067-498906081690' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a9970e5-2d11-4e25-bb7d-789e852cec5d' class='xr-var-data-in' type='checkbox'><label for='data-4a9970e5-2d11-4e25-bb7d-789e852cec5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>3066</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sde</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>347.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Snow depth</dd><dt><span>GRIB_shortName :</span></dt><dd>sde</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d900cb65-e3ee-4a3b-8765-c6f37524de82' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d900cb65-e3ee-4a3b-8765-c6f37524de82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c2636155-064f-4f49-a60b-1a7bdf517b6f' class='xr-var-data-in' type='checkbox'><label for='data-c2636155-064f-4f49-a60b-1a7bdf517b6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Wind speed (2 m)</dd><dt><span>units :</span></dt><dd>m/s</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 12 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Effective</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-c38edf5c-28cb-4980-8bff-598440f6affc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c38edf5c-28cb-4980-8bff-598440f6affc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-661b713d-4457-407a-9704-6128912c1ff8' class='xr-var-data-in' type='checkbox'><label for='data-661b713d-4457-407a-9704-6128912c1ff8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Effective temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 14 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Growing_Degree_Days</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-aee5e043-a805-4a7a-89c5-6cc2d0696d8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aee5e043-a805-4a7a-89c5-6cc2d0696d8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1d9c079-58fd-4cdb-9f01-a3fdeb3fd98c' class='xr-var-data-in' type='checkbox'><label for='data-c1d9c079-58fd-4cdb-9f01-a3fdeb3fd98c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Œ£ Growing degree-days</dd><dt><span>units :</span></dt><dd>¬∞C d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 16 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_emergence</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-fbd38541-ecb7-4857-9a06-e987a204701f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fbd38541-ecb7-4857-9a06-e987a204701f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-676ead07-4d08-4565-8dc2-8f466db49b04' class='xr-var-data-in' type='checkbox'><label for='data-676ead07-4d08-4565-8dc2-8f466db49b04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_emergence</dd><dt><span>long_name :</span></dt><dd>Day of emergence</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 29 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_anthesis</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-8b348b4f-6400-407f-ab28-a9cdecd6abcb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b348b4f-6400-407f-ab28-a9cdecd6abcb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a44ab6e-7e4a-4393-a65c-e34caa74d3e4' class='xr-var-data-in' type='checkbox'><label for='data-5a44ab6e-7e4a-4393-a65c-e34caa74d3e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_anthesis</dd><dt><span>long_name :</span></dt><dd>Day of anthesis</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 29 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Day_of_maturity</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(130, 180), meta=np.ndarray&gt;</div><input id='attrs-efe569c9-3fe7-4e37-ba0b-e9ea867cd24f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-efe569c9-3fe7-4e37-ba0b-e9ea867cd24f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c074d21a-c7c4-44eb-8b8d-545ba5e45ec1' class='xr-var-data-in' type='checkbox'><label for='data-c074d21a-c7c4-44eb-8b8d-545ba5e45ec1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>Day_of_maturity</dd><dt><span>long_name :</span></dt><dd>Day of maturity</dd><dt><span>units :</span></dt><dd>d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 91.41 kiB </td>
                        <td> 91.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (130, 180) </td>
                        <td> (130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 29 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="136" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="86" x2="120" y2="86" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="86" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="86" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,86.66666666666667 0.0,86.66666666666667" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="106.666667" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="140.000000" y="43.333333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.333333)">130</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-cd5e27f3-c08d-4cbc-b37e-8c8e5082e595' class='xr-section-summary-in' type='checkbox'  ><label for='section-cd5e27f3-c08d-4cbc-b37e-8c8e5082e595' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-649cf1d8-bf3f-4dd1-affa-c6e6e7e28f06' class='xr-index-data-in' type='checkbox'/><label for='index-649cf1d8-bf3f-4dd1-affa-c6e6e7e28f06' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-868dec39-7bf2-4067-bb90-6c1146f88b21' class='xr-index-data-in' type='checkbox'/><label for='index-868dec39-7bf2-4067-bb90-6c1146f88b21' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60.0,
       ...
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7489a052-dae4-4761-a80a-ff8ec04a8cd9' class='xr-index-data-in' type='checkbox'/><label for='index-7489a052-dae4-4761-a80a-ff8ec04a8cd9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12.0,
       ...
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0d5520f2-034f-4673-9cdd-231a562a5a57' class='xr-section-summary-in' type='checkbox'  ><label for='section-0d5520f2-034f-4673-9cdd-231a562a5a57' class='xr-section-summary' >Attributes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd><dt><span>name :</span></dt><dd>ERA5-Land</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="results">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-results"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>This section contains the comparison between values retrieved from AgERA5 vs ERA5-Land.
The datasets are compared in three ways:</p>
<ul class="simple">
<li><p>Point-by-point: Comparison between individual data points with matching coordinates (in time and space). Provides a quantitative estimate of the agreement between the datasets over the entire domain.</p></li>
<li><p>Time series: Agreement between the datasets over time for one site or a range of sites. Relevant for crop yield modelling, which is based on values at specific times and/or aggregated over the entire time series for one site.</p></li>
<li><p>Geospatial: Distribution across the spatial domain. Displays spatial patterns and highlights specific areas or types of terrain (e.g. coastal, mountain) with better or worse agreement.</p></li>
</ul>
<section id="point-by-point-comparison">
<h4>Point-by-point comparison<a class="headerlink" href="#point-by-point-comparison" title="Link to this heading">#</a></h4>
<p>In this section,
the differences between one-to-one match-ups (same latitude, longitude, and time) between the two datasets are analysed.</p>
<p>We first examine some metrics that describe the difference Œî between corresponding (in time and space) pixels.
The 5<sup>th</sup> and 95<sup>th</sup> percentiles provide a confidence interval (CI) around the median difference.
This is not an uncertainty but rather a description of the variation across the domain.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_difference_stats</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_18abd">
  <caption>AgERA5 ‚Äì ERA5-Land</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_18abd_level0_col0" class="col_heading level0 col0" >5<sup>th</sup> Perc. Œî</th>
      <th id="T_18abd_level0_col1" class="col_heading level0 col1" >Median Œî</th>
      <th id="T_18abd_level0_col2" class="col_heading level0 col2" >95<sup>th</sup> Perc. Œî</th>
      <th id="T_18abd_level0_col3" class="col_heading level0 col3" >Median |Œî|</th>
      <th id="T_18abd_level0_col4" class="col_heading level0 col4" >Median |Œî| [%]</th>
      <th id="T_18abd_level0_col5" class="col_heading level0 col5" >Pearson r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_18abd_level0_row0" class="row_heading level0 row0" >Temperature (max)<br>[¬∞C]</th>
      <td id="T_18abd_row0_col0" class="data row0 col0" >-0.8445</td>
      <td id="T_18abd_row0_col1" class="data row0 col1" >0.2401</td>
      <td id="T_18abd_row0_col2" class="data row0 col2" >1.2775</td>
      <td id="T_18abd_row0_col3" class="data row0 col3" >0.4402</td>
      <td id="T_18abd_row0_col4" class="data row0 col4" >nan</td>
      <td id="T_18abd_row0_col5" class="data row0 col5" >0.9942</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row1" class="row_heading level0 row1" >Temperature (mean)<br>[¬∞C]</th>
      <td id="T_18abd_row1_col0" class="data row1 col0" >-0.9870</td>
      <td id="T_18abd_row1_col1" class="data row1 col1" >-0.1044</td>
      <td id="T_18abd_row1_col2" class="data row1 col2" >0.7162</td>
      <td id="T_18abd_row1_col3" class="data row1 col3" >0.3325</td>
      <td id="T_18abd_row1_col4" class="data row1 col4" >nan</td>
      <td id="T_18abd_row1_col5" class="data row1 col5" >0.9957</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row2" class="row_heading level0 row2" >Temperature (min)<br>[¬∞C]</th>
      <td id="T_18abd_row2_col0" class="data row2 col0" >-1.7796</td>
      <td id="T_18abd_row2_col1" class="data row2 col1" >-0.4838</td>
      <td id="T_18abd_row2_col2" class="data row2 col2" >0.6784</td>
      <td id="T_18abd_row2_col3" class="data row2 col3" >0.5900</td>
      <td id="T_18abd_row2_col4" class="data row2 col4" >nan</td>
      <td id="T_18abd_row2_col5" class="data row2 col5" >0.9895</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row3" class="row_heading level0 row3" >Solar irradiation<br>[MJ/m¬≤/d]</th>
      <td id="T_18abd_row3_col0" class="data row3 col0" >-1.2962</td>
      <td id="T_18abd_row3_col1" class="data row3 col1" >-0.2269</td>
      <td id="T_18abd_row3_col2" class="data row3 col2" >0.4361</td>
      <td id="T_18abd_row3_col3" class="data row3 col3" >0.3099</td>
      <td id="T_18abd_row3_col4" class="data row3 col4" >2.9868</td>
      <td id="T_18abd_row3_col5" class="data row3 col5" >0.9978</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row4" class="row_heading level0 row4" >Wind speed (2 m)<br>[m/s]</th>
      <td id="T_18abd_row4_col0" class="data row4 col0" >-0.3973</td>
      <td id="T_18abd_row4_col1" class="data row4 col1" >0.4702</td>
      <td id="T_18abd_row4_col2" class="data row4 col2" >1.3496</td>
      <td id="T_18abd_row4_col3" class="data row4 col3" >0.5099</td>
      <td id="T_18abd_row4_col4" class="data row4 col4" >19.2494</td>
      <td id="T_18abd_row4_col5" class="data row4 col5" >0.9088</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row5" class="row_heading level0 row5" >Total precipitation<br>[mm/d]</th>
      <td id="T_18abd_row5_col0" class="data row5 col0" >-0.7413</td>
      <td id="T_18abd_row5_col1" class="data row5 col1" >-0.0013</td>
      <td id="T_18abd_row5_col2" class="data row5 col2" >0.7580</td>
      <td id="T_18abd_row5_col3" class="data row5 col3" >0.0680</td>
      <td id="T_18abd_row5_col4" class="data row5 col4" >12.8833</td>
      <td id="T_18abd_row5_col5" class="data row5 col5" >0.9910</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row6" class="row_heading level0 row6" >Snow depth<br>[cm]</th>
      <td id="T_18abd_row6_col0" class="data row6 col0" >-0.0448</td>
      <td id="T_18abd_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_18abd_row6_col2" class="data row6 col2" >0.0000</td>
      <td id="T_18abd_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_18abd_row6_col4" class="data row6 col4" >0.0000</td>
      <td id="T_18abd_row6_col5" class="data row6 col5" >0.6730</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row7" class="row_heading level0 row7" >Effective temperature<br>[¬∞C]</th>
      <td id="T_18abd_row7_col0" class="data row7 col0" >-0.9332</td>
      <td id="T_18abd_row7_col1" class="data row7 col1" >-0.0449</td>
      <td id="T_18abd_row7_col2" class="data row7 col2" >0.6549</td>
      <td id="T_18abd_row7_col3" class="data row7 col3" >0.2845</td>
      <td id="T_18abd_row7_col4" class="data row7 col4" >3.5690</td>
      <td id="T_18abd_row7_col5" class="data row7 col5" >0.9958</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row8" class="row_heading level0 row8" >Œ£ Growing degree-days<br>[¬∞C d]</th>
      <td id="T_18abd_row8_col0" class="data row8 col0" >-53.1651</td>
      <td id="T_18abd_row8_col1" class="data row8 col1" >-8.3359</td>
      <td id="T_18abd_row8_col2" class="data row8 col2" >18.3758</td>
      <td id="T_18abd_row8_col3" class="data row8 col3" >11.6122</td>
      <td id="T_18abd_row8_col4" class="data row8 col4" >2.8305</td>
      <td id="T_18abd_row8_col5" class="data row8 col5" >0.9995</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row9" class="row_heading level0 row9" >Day of emergence<br>[d]</th>
      <td id="T_18abd_row9_col0" class="data row9 col0" >-4.0000</td>
      <td id="T_18abd_row9_col1" class="data row9 col1" >1.0000</td>
      <td id="T_18abd_row9_col2" class="data row9 col2" >11.0000</td>
      <td id="T_18abd_row9_col3" class="data row9 col3" >1.0000</td>
      <td id="T_18abd_row9_col4" class="data row9 col4" >2.2472</td>
      <td id="T_18abd_row9_col5" class="data row9 col5" >0.9784</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row10" class="row_heading level0 row10" >Day of anthesis<br>[d]</th>
      <td id="T_18abd_row10_col0" class="data row10 col0" >-2.0000</td>
      <td id="T_18abd_row10_col1" class="data row10 col1" >1.0000</td>
      <td id="T_18abd_row10_col2" class="data row10 col2" >6.0000</td>
      <td id="T_18abd_row10_col3" class="data row10 col3" >1.0000</td>
      <td id="T_18abd_row10_col4" class="data row10 col4" >0.6431</td>
      <td id="T_18abd_row10_col5" class="data row10 col5" >0.9913</td>
    </tr>
    <tr>
      <th id="T_18abd_level0_row11" class="row_heading level0 row11" >Day of maturity<br>[d]</th>
      <td id="T_18abd_row11_col0" class="data row11 col0" >-3.0000</td>
      <td id="T_18abd_row11_col1" class="data row11 col1" >2.0000</td>
      <td id="T_18abd_row11_col2" class="data row11 col2" >6.0000</td>
      <td id="T_18abd_row11_col3" class="data row11 col3" >2.0000</td>
      <td id="T_18abd_row11_col4" class="data row11 col4" >0.8969</td>
      <td id="T_18abd_row11_col5" class="data row11 col5" >0.9861</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It is immediately clear from the table above that AgERA5 and ERA5-Land generally provide very similar, and highly correlated, values for these agriculturally relevant variables.</p>
<p>AgERA5 has a wider temperature range,
with generally but not exclusively
warmer maximum (median +0.24 ¬∞C; CI ‚Äì0.85 to +1.28 ¬∞C)
and
colder minimum (median ‚Äì0.48 ¬∞C; CI ‚Äì1.78 to +0.68 ¬∞C)
daily temperatures.
The difference is larger for minimum temperatures than maximum,
which is reflected in the daily mean temperature difference (median ‚Äì0.10 ¬∞C; CI ‚Äì0.99 to +0.72 ¬∞C)
and the effective temperature (median ‚Äì0.05 ¬∞C; CI ‚Äì0.93 to +0.65 ¬∞C).
These differences are comparable to typical uncertainties in 2 m temperature estimates from ERA5 [<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>].
Differences in temperature follow a smooth random distribution
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist"><span class="std std-numref">6.1.1</span></a>)
without apparent features at specific values
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter"><span class="std std-numref">6.1.2</span></a>).
Effective temperature has a sharp peak at 0 ¬∞C difference corresponding to days where the temperature in both datasets is capped at the base or top.</p>
<p>For crop models,
the temperature on individual days is less important than the cumulative number of growing degree-days and the resulting development thresholds (day of emergence, anthesis, maturity).
The small tendency towards colder temperatures in AgERA5 compared to ERA5-Land generally results in fewer growing degree-days
(median ‚Äì8.3 ¬∞C d; CI ‚Äì53.2 to +18.4 ¬∞C d; Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist"><span class="std std-numref">6.1.1</span></a>),
with a spread (median absolute percentage difference) of 2.8%.
However,
since this is a cumulative variable,
the difference may be skewed by the early months when differences have not had time to accumulate yet.
The dates at which development thresholds are met are very similar between both datasets,
with a spread of 2.2% in day of emergence and &lt;1% in anthesis and maturity.
For all three,
the slight decrease in growing degree-days results in a slight delay in development in AgERA5 compared to ERA5-Land,
but this difference is on the order of ~1 day and therefore negligible compared to
the effects of
uncertainty in the data,
real physical variation across the domain
(including between plots within one pixel),
and the uncertainty inherent to crop modelling.</p>
<p>As for the non-temperature variables,
the difference in solar irradiation
(median ‚Äì0.27 MJ/m¬≤/d; CI ‚Äì1.30 to +0.44 MJ/m¬≤/d)
is small both relative to its values
(median |Œî| of 3%)
and in practice
(equivalent to ~0.1 mm water evaporation per day).
The differences in precipitation are also small,
&lt;1 mm per day in the vast majority of match-ups,
although there are a few outliers
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter"><span class="std std-numref">6.1.2</span></a>)
that increase the median absolute percentage difference.
Wind speed appears to have a systematic offset between the two datasets
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist"><span class="std std-numref">6.1.1</span></a>),
although this offset is relatively small
(median +0.47 m/s; CI ‚Äì0.40 m/s to +1.35 m/s)
and unlikely to significantly impact crop model runs.
Lastly,
snow depth is difficult to compare overall because it is 0 in most pixels at most times in this comparison;
it will be discussed in more detail in the following sections.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scatter_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                   <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-scatter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">histogram_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                     <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-hist&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="histogram" for="sd-tab-item-0">
Histogram</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist" style="width: 700px">
<img alt="../_images/428e0f9090a8e9ceb188289c5e71b3008210b436e73bc9fed82c1ac637a42ddd.png" src="../_images/428e0f9090a8e9ceb188289c5e71b3008210b436e73bc9fed82c1ac637a42ddd.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.1 </span><span class="caption-text">Overall distributions of point-by-point differences between AgERA5 and ERA5-Land for each variable.
Note that some variables (e.g. snow depth) are highly concentrated at 0 difference.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="scatter" for="sd-tab-item-1">
Scatter plot</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter" style="width: 700px">
<img alt="../_images/e1869928e00d583f6b17171dcf7de3cea18225cbc10e00f1d799b02f56726897.png" src="../_images/e1869928e00d583f6b17171dcf7de3cea18225cbc10e00f1d799b02f56726897.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.2 </span><span class="caption-text">Point-by-point comparison (density scatter) between AgERA5 and ERA5-Land for each variable.
Yellow means high density, blue means low density, white means zero points in that bin.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="time-series-comparison">
<h4>Time series comparison<a class="headerlink" href="#time-series-comparison" title="Link to this heading">#</a></h4>
<p>Crop yield estimates make use of the time series of the relevant variables at a given site.
In this section,
the differences between match-ups between the two datasets along a time series at one site (same latitude, longitude) are analysed,
as well as the statistics of all time series in the entire spatial domain.</p>
<p>We first examine the same metrics for Œî as in the point-by-point comparison,
this time looking only at values at one site
(one latitude, one longitude; specified at the start of the notebook)
along its entire time series.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select from each dataset</span>
<span class="c1"># **site unpacks `site` (defined at the start) into lat=..., lon=...</span>
<span class="n">timeseries_agera5</span><span class="p">,</span> <span class="n">timeseries_era5land</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>
<span class="n">display_difference_stats</span><span class="p">(</span><span class="n">timeseries_agera5</span><span class="p">,</span> <span class="n">timeseries_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_d5eed">
  <caption>AgERA5 ‚Äì ERA5-Land</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_d5eed_level0_col0" class="col_heading level0 col0" >5<sup>th</sup> Perc. Œî</th>
      <th id="T_d5eed_level0_col1" class="col_heading level0 col1" >Median Œî</th>
      <th id="T_d5eed_level0_col2" class="col_heading level0 col2" >95<sup>th</sup> Perc. Œî</th>
      <th id="T_d5eed_level0_col3" class="col_heading level0 col3" >Median |Œî|</th>
      <th id="T_d5eed_level0_col4" class="col_heading level0 col4" >Median |Œî| [%]</th>
      <th id="T_d5eed_level0_col5" class="col_heading level0 col5" >Pearson r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d5eed_level0_row0" class="row_heading level0 row0" >Temperature (max)<br>[¬∞C]</th>
      <td id="T_d5eed_row0_col0" class="data row0 col0" >-0.7634</td>
      <td id="T_d5eed_row0_col1" class="data row0 col1" >0.2174</td>
      <td id="T_d5eed_row0_col2" class="data row0 col2" >1.1301</td>
      <td id="T_d5eed_row0_col3" class="data row0 col3" >0.4139</td>
      <td id="T_d5eed_row0_col4" class="data row0 col4" >nan</td>
      <td id="T_d5eed_row0_col5" class="data row0 col5" >0.9954</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row1" class="row_heading level0 row1" >Temperature (mean)<br>[¬∞C]</th>
      <td id="T_d5eed_row1_col0" class="data row1 col0" >-0.8621</td>
      <td id="T_d5eed_row1_col1" class="data row1 col1" >0.0203</td>
      <td id="T_d5eed_row1_col2" class="data row1 col2" >0.8366</td>
      <td id="T_d5eed_row1_col3" class="data row1 col3" >0.3290</td>
      <td id="T_d5eed_row1_col4" class="data row1 col4" >nan</td>
      <td id="T_d5eed_row1_col5" class="data row1 col5" >0.9962</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row2" class="row_heading level0 row2" >Temperature (min)<br>[¬∞C]</th>
      <td id="T_d5eed_row2_col0" class="data row2 col0" >-1.5128</td>
      <td id="T_d5eed_row2_col1" class="data row2 col1" >-0.1600</td>
      <td id="T_d5eed_row2_col2" class="data row2 col2" >0.8645</td>
      <td id="T_d5eed_row2_col3" class="data row2 col3" >0.4570</td>
      <td id="T_d5eed_row2_col4" class="data row2 col4" >nan</td>
      <td id="T_d5eed_row2_col5" class="data row2 col5" >0.9911</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row3" class="row_heading level0 row3" >Solar irradiation<br>[MJ/m¬≤/d]</th>
      <td id="T_d5eed_row3_col0" class="data row3 col0" >-0.6963</td>
      <td id="T_d5eed_row3_col1" class="data row3 col1" >-0.0420</td>
      <td id="T_d5eed_row3_col2" class="data row3 col2" >0.5744</td>
      <td id="T_d5eed_row3_col3" class="data row3 col3" >0.2173</td>
      <td id="T_d5eed_row3_col4" class="data row3 col4" >1.9353</td>
      <td id="T_d5eed_row3_col5" class="data row3 col5" >0.9989</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row4" class="row_heading level0 row4" >Wind speed (2 m)<br>[m/s]</th>
      <td id="T_d5eed_row4_col0" class="data row4 col0" >0.0681</td>
      <td id="T_d5eed_row4_col1" class="data row4 col1" >0.4769</td>
      <td id="T_d5eed_row4_col2" class="data row4 col2" >1.2659</td>
      <td id="T_d5eed_row4_col3" class="data row4 col3" >0.4769</td>
      <td id="T_d5eed_row4_col4" class="data row4 col4" >16.0054</td>
      <td id="T_d5eed_row4_col5" class="data row4 col5" >0.9375</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row5" class="row_heading level0 row5" >Total precipitation<br>[mm/d]</th>
      <td id="T_d5eed_row5_col0" class="data row5 col0" >-0.3727</td>
      <td id="T_d5eed_row5_col1" class="data row5 col1" >-0.0015</td>
      <td id="T_d5eed_row5_col2" class="data row5 col2" >0.7335</td>
      <td id="T_d5eed_row5_col3" class="data row5 col3" >0.0444</td>
      <td id="T_d5eed_row5_col4" class="data row5 col4" >16.2491</td>
      <td id="T_d5eed_row5_col5" class="data row5 col5" >0.9934</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row6" class="row_heading level0 row6" >Snow depth<br>[cm]</th>
      <td id="T_d5eed_row6_col0" class="data row6 col0" >0.0000</td>
      <td id="T_d5eed_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_d5eed_row6_col2" class="data row6 col2" >0.0000</td>
      <td id="T_d5eed_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_d5eed_row6_col4" class="data row6 col4" >0.0000</td>
      <td id="T_d5eed_row6_col5" class="data row6 col5" >0.3361</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row7" class="row_heading level0 row7" >Effective temperature<br>[¬∞C]</th>
      <td id="T_d5eed_row7_col0" class="data row7 col0" >-0.8018</td>
      <td id="T_d5eed_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_d5eed_row7_col2" class="data row7 col2" >0.6160</td>
      <td id="T_d5eed_row7_col3" class="data row7 col3" >0.2772</td>
      <td id="T_d5eed_row7_col4" class="data row7 col4" >3.2895</td>
      <td id="T_d5eed_row7_col5" class="data row7 col5" >0.9965</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row8" class="row_heading level0 row8" >Œ£ Growing degree-days<br>[¬∞C d]</th>
      <td id="T_d5eed_row8_col0" class="data row8 col0" >-8.4769</td>
      <td id="T_d5eed_row8_col1" class="data row8 col1" >-5.4141</td>
      <td id="T_d5eed_row8_col2" class="data row8 col2" >-1.8699</td>
      <td id="T_d5eed_row8_col3" class="data row8 col3" >5.4141</td>
      <td id="T_d5eed_row8_col4" class="data row8 col4" >1.1388</td>
      <td id="T_d5eed_row8_col5" class="data row8 col5" >1.0000</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row9" class="row_heading level0 row9" >Day of emergence<br>[d]</th>
      <td id="T_d5eed_row9_col0" class="data row9 col0" >0.0000</td>
      <td id="T_d5eed_row9_col1" class="data row9 col1" >0.0000</td>
      <td id="T_d5eed_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_d5eed_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_d5eed_row9_col4" class="data row9 col4" >0.0000</td>
      <td id="T_d5eed_row9_col5" class="data row9 col5" >nan</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row10" class="row_heading level0 row10" >Day of anthesis<br>[d]</th>
      <td id="T_d5eed_row10_col0" class="data row10 col0" >1.0000</td>
      <td id="T_d5eed_row10_col1" class="data row10 col1" >1.0000</td>
      <td id="T_d5eed_row10_col2" class="data row10 col2" >1.0000</td>
      <td id="T_d5eed_row10_col3" class="data row10 col3" >1.0000</td>
      <td id="T_d5eed_row10_col4" class="data row10 col4" >0.6116</td>
      <td id="T_d5eed_row10_col5" class="data row10 col5" >nan</td>
    </tr>
    <tr>
      <th id="T_d5eed_level0_row11" class="row_heading level0 row11" >Day of maturity<br>[d]</th>
      <td id="T_d5eed_row11_col0" class="data row11 col0" >0.0000</td>
      <td id="T_d5eed_row11_col1" class="data row11 col1" >0.0000</td>
      <td id="T_d5eed_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_d5eed_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_d5eed_row11_col4" class="data row11 col4" >0.0000</td>
      <td id="T_d5eed_row11_col5" class="data row11 col5" >nan</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The example site
(52.5 ¬∞N, 0 ¬∞E; chosen arbitrarily)
mirrors the results seen in the overall point-by-point comparison,
primarily that differences between AgERA5 and ERA5-Land tend to be small.
The aforementioned differences in temperature are visible when comparing the time series graphically
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs"><span class="std std-numref">6.1.3</span></a>)
and appear at individual days,
rather than an overall offset.
A difference in cumulative growing degree-days builds up over time
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel"><span class="std std-numref">6.1.4</span></a>),
but remains too small to affect the resulting development stages significantly.</p>
<p>The systematic offset in wind speed seen in the point-by-point comparison is also visible in the time series
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel"><span class="std std-numref">6.1.4</span></a>)
with AgERA5 consistently providing estimates that are 0.07‚Äì1.26 m/s faster than those in ERA5-Land.
This is true across most of the spatial domain
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi"><span class="std std-numref">6.1.5</span></a>).
Comparing the values
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs"><span class="std std-numref">6.1.3</span></a>)
and differences
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel"><span class="std std-numref">6.1.4</span></a>)
for total precipitation indicates that its relatively large median percentage difference is caused by outliers,
particularly on days with low precipitation.</p>
<p>Only snow depth and solar irradiation show notable patterns over time.
While snow depth is 0 cm across most of the time series
‚Äì as one would expect at this site in the south of the UK ‚Äì
the datasets differ in <em>when</em> they estimate &gt;0 snow depth
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs"><span class="std std-numref">6.1.3</span></a>).
While negligible here,
this difference may be more impactful at other sites where snow is more common;
this will be discussed in the next section.
Lastly,
differences in solar irradiation increase in late spring and summer (May‚ÄìAugust) in this domain,
but stay small percentage-wise
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi"><span class="std std-numref">6.1.5</span></a>)
and in terms of the equivalent evaporation (&lt;0.2 mm/d).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeseries_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-abs&quot;</span><span class="p">)</span>

<span class="n">timeseries_comparison_difference</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="n">site</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-rel&quot;</span><span class="p">)</span>

<span class="n">timeseries_comparison_difference_multi</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-multi&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="abs1" for="sd-tab-item-2">
Values, one site</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs" style="width: 700px">
<img alt="../_images/28b6e3b581d56476a75d893f40f4ba2a58f19848837d9b7ae9059264c08f9fb6.png" src="../_images/28b6e3b581d56476a75d893f40f4ba2a58f19848837d9b7ae9059264c08f9fb6.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.3 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, at one site.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="rel1" for="sd-tab-item-3">
Difference, one site</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel" style="width: 700px">
<img alt="../_images/c127e31cd986886bd387e4d5797f767d769c2c6fad385d64c9b73a85d2bdb0be.png" src="../_images/c127e31cd986886bd387e4d5797f767d769c2c6fad385d64c9b73a85d2bdb0be.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.4 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, at one site.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="reldom" for="sd-tab-item-4">
Difference, full domain</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi" style="width: 700px">
<img alt="../_images/fafd8cf1c221dde8853edf9d1a48c5c42e52483f7f848648b8ab8dcfca7217fe.png" src="../_images/fafd8cf1c221dde8853edf9d1a48c5c42e52483f7f848648b8ab8dcfca7217fe.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.5 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, over all sites in the domain.
The thick line indicates the median,
the dark shaded area the inter-quartile range (25‚Äì75%),
the light shaded area the 5‚Äì95% range.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="geospatial-comparison">
<h4>Geospatial comparison<a class="headerlink" href="#geospatial-comparison" title="Link to this heading">#</a></h4>
<p>In this section,
the geospatial distribution of differences between the two datasets are analysed.
This analysis is performed both in terms of development stage thresholds
(day of emergence, anthesis, maturity)
and in several single-day snapshots along the time domain.
The dates for these snapshots are defined in the cell below and can be customised when running this notebook yourself.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Date(s) for geospatial comparison plot, in {year}-mm-dd format</span>
<span class="c1"># Examples were chosen arbitrarily</span>
<span class="n">comparison_dates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;january&quot;</span><span class="p">:</span>   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span>  <span class="c1">#  1 January</span>
    <span class="s2">&quot;april&quot;</span><span class="p">:</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-04-13&quot;</span><span class="p">,</span>  <span class="c1"># 13 April</span>
    <span class="s2">&quot;june&quot;</span><span class="p">:</span>      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-06-14&quot;</span><span class="p">,</span>  <span class="c1"># 14 June</span>
    <span class="s2">&quot;september&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-09-24&quot;</span><span class="p">,</span>  <span class="c1"># 24 September</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>As before,
the two datasets match well,
with the overall distributions of values for each variable being similar across the domain
and differences being small
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january"><span class="std std-numref">6.1.6</span></a>‚Äì<a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-dayof"><span class="std std-numref">6.1.10</span></a>).</p>
<p>The most striking difference is in the apparent spatial resolution of total precipitation, snow depth, and solar irradiation,
with AgERA5 appearing blockier and ERA5-Land smoother
(e.g. Ireland in Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-september"><span class="std std-numref">6.1.9</span></a>).
Since both datasets are derived from ERA5 and downscaled to the same 0.1¬∞ √ó 0.1¬∞ grid,
this effect is caused by differences in their derivation methods.
AgERA5 is downscaled from the native ERA5 grid through a nearest-neighbour interpolation
‚Äì which preserves the ERA5 grid cell size in the data ‚Äì
followed by an empirical bias adjustment
based on ECMWF‚Äôs HRES operational model
for all variables <em>except</em> precipitation and snow depth [<a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278550984" rel="noreferrer" target="_blank">Boogaard+25</a>].
ERA5-Land,
in contrast,
is generated by integrating ECMWF‚Äôs CHTESSEL land surface model with a downscaled version of ERA5 meteorology [<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>].
These methods are fundamentally different and hence produce slightly different results.
The spatial structure of differences in these three variables,
which looks like noise on a rectangular grid
(e.g. total precipitation in Wales in Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january"><span class="std std-numref">6.1.6</span></a>),
results from this misalignment between downscaling methods.
Another visual difference is that AgERA5 uses a coarser land/sea mask, but this does not impact its usage in any way.</p>
<p>Snow depth shows large differences between the datasets,
particularly in the Scottish Highlands
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january"><span class="std std-numref">6.1.6</span></a>),
likely also resulting from the different downscaling methods.
For snow depth, ERA5-Land is more likely to represent the `ground truth‚Äô since it integrates a land surface model.
In this example domain (UK and Ireland), the difference has little real-life impact because it is concentrated in mountainous areas that are less relevant to crop modelling.
However, it may be impactful in parts of the world where snow is more common in agricultural areas.
This is why, as noted in the introduction, intercomparisons such as this quality assessment should be conducted over limited domains rather than globally.
Lastly, it is important to note that ERA5 itself has known biases in its estimates of snow depth [<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>],
which propagate into derived datasets.</p>
<p>The previous sections showed that wind speeds in AgERA5 are generally faster across the domain.
The geospatial comparison highlights Ireland and Scotland as having particularly large differences,
while ERA5-Land wind speeds tend to be faster than AgERA5‚Äôs near coastlines
(e.g. Figures
<a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january"><span class="std std-numref">6.1.6</span></a>
and
<a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-september"><span class="std std-numref">6.1.9</span></a>).</p>
<p>There are no clear spatial patterns in the cumulative growing degree-days nor in the derived development stage thresholds
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-dayof"><span class="std std-numref">6.1.10</span></a>).
The spatial differences seen in other variables will impact actual crop models,
but these thresholds provide a first-order estimate of the consistency between AgERA5 and ERA5-Land.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot day of emergence, anthesis, maturity</span>
<span class="c1"># Note that the comparison date doesn&#39;t matter because these variables do not have a time dimension</span>
<span class="n">geospatial_comparison_with_difference</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">comparison_dates</span><span class="p">[</span><span class="s2">&quot;january&quot;</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
                                      <span class="n">variables</span><span class="o">=</span><span class="n">VARIABLES_DAY_OF</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Development stages&quot;</span><span class="p">,</span>
                                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-geo-dayof&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop over dates and plot each -- Note this may take several minutes</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">comparison_dates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Label for Jupyter-book</span>
    <span class="n">glue_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-geo-</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Plot</span>
    <span class="n">geospatial_comparison_with_difference</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
                                          <span class="n">glue_label</span><span class="o">=</span><span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="january" for="sd-tab-item-5">
January</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january" style="width: 700px">
<img alt="../_images/006a2bebf512b0f344b4a740713168173b7c611e4faac4a24a97127740ed928d.png" src="../_images/006a2bebf512b0f344b4a740713168173b7c611e4faac4a24a97127740ed928d.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.6 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-january" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="april" for="sd-tab-item-6">
April</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-april" style="width: 700px">
<img alt="../_images/d7c908bb15e50545f60a4d3cd34c07e8f593766376d727dbbf55ae0544f085a8.png" src="../_images/d7c908bb15e50545f60a4d3cd34c07e8f593766376d727dbbf55ae0544f085a8.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.7 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-april" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="june" for="sd-tab-item-7">
June</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-june" style="width: 700px">
<img alt="../_images/452dea2b31a68020dd387f41530375435152b72a3215c3c49c030eeb64e6ae90.png" src="../_images/452dea2b31a68020dd387f41530375435152b72a3215c3c49c030eeb64e6ae90.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.8 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-june" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-8" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="september" for="sd-tab-item-8">
September</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-september" style="width: 700px">
<img alt="../_images/45347ad8e8388a130e0afc48b557d717d4f64bf8e8d50231a242fe6f0f44801d.png" src="../_images/45347ad8e8388a130e0afc48b557d717d4f64bf8e8d50231a242fe6f0f44801d.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.9 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-september" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-9" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="dayof" for="sd-tab-item-9">
Development stages</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-dayof" style="width: 700px">
<img alt="../_images/0cbb75f348cd0c35e9cd1b8ac99b975d5e927a52d8a27bda678399a3d3d65e01.png" src="../_images/0cbb75f348cd0c35e9cd1b8ac99b975d5e927a52d8a27bda678399a3d3d65e01.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.10 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.
Pixels where the condition is never met
(e.g. the cumulative degree-days never reach the threshold for maturity within the provided time range)
have been masked.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-dayof" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="conclusions">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-conclusions"></span><h3>4. Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h3>
<p>In this assessment,
the AgERA5 and ERA5-Land datasets were compared to assess their ease of use and consistency between variables relevant to agricultural simulations.
The datasets are both derived from ERA5 and thus share many similarities.
The two main differences are in the ease of use
‚Äì or rather, tailoredness to agricultural simulations ‚Äì
and in the specific values provided.</p>
<p>AgERA5 is highly fit for the purpose of agricultural simulations because it provides all the relevant variables with the appropriate temporal aggregation on a 0.1¬∞ √ó 0.1¬∞ geospatial grid, ready to be used.
ERA5-Land is also suitable, but requires more pre-processing to obtain the required data in the desired format.
It should be noted that AgERA5, as provided on the CDS, is not fully optimised for acquisition of time series at a specific site.
While the code used in this quality assessment can be copied and adapted at will, users may find it more convenient to use the <a class="reference external" href="https://github.com/ajwdewit/agera5tools" rel="noreferrer" target="_blank">AgERA5tools package</a> developed by the data provider.</p>
<p>Values for all variables differ slightly between AgERA5 and ERA5-Land,
despite sharing a common origin,
because the datasets are derived differently.
AgERA5 applies nearest-neighbour interpolation and an empirical bias adjustment based on ERA5 and HRES.
ERA5-Land combines the CHTESSEL land surface model with downscaled ERA5 meteorology.
The datasets also differ in their temporal aggregation method.
Combined,
this results in differences in the values provided.
However, even accumulated along an entire growth season,
these differences are small compared to
the effects of uncertainty in the underpinning data,
real physical variation across the domain
(including between plots within one pixel),
and the uncertainty inherent to crop modelling.</p>
<p>Because neither dataset provides its own uncertainty estimates,
a deeper quantitative comparison between individual values is not possible.
Uncertainties could be estimated by propagating the ERA5-EDA ensemble through the respective processing chains,
but this is not trivial due to the additional uncertainty introduced within those chains [<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>].
There is a wealth of literature comparing either or both of these datasets to other reanalyses and observations,
with some references provided in the introduction and below.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Agrometeorological indicators from 1979 to present derived from reanalysis (AgERA5): <a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">sis-agrometeorological-indicators</a></p></li>
<li><p>ERA5-Land hourly data from 1950 to present: <a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank">reanalysis-era5-land</a></p></li>
<li><p>ERA5-Land post-processed daily statistics from 1950 to present: <a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank">derived-era5-land-daily-statistics</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a></p>
<ul>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a></p></li>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a></p></li>
</ul>
</li>
</ul>
<p>More about crop yield estimation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.wur.nl/en/research/products-services/wofost-world-food-studies" rel="noreferrer" target="_blank">WOFOST ‚Äì WOrld FOod STudies</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1007/s00704-024-05046-x" rel="noreferrer" target="_blank">Crop yield prediction based on reanalysis and crop phenology data in the agroclimatic zones</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.agrformet.2025.110637" rel="noreferrer" target="_blank">Historical trends and future projections of compound cloudy-rainy events during the global winter wheat harvest phase</a></p></li>
</ul>
<p>More about reanalysis data:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">The ERA5 global reanalysis</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">ERA5-Land: a state-of-the-art global reanalysis dataset for land applications</a></p></li>
<li><p>AgERA5</p>
<ul>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278550984" rel="noreferrer" target="_blank">Algorithm Theoretical Basis (ATBD)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278551004" rel="noreferrer" target="_blank">Product User Guide and Specification (PUGS)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Global+Agriculture+Downscaling+and+bias+correction" rel="noreferrer" target="_blank">Global Agriculture Downscaling and bias correction</a></p></li>
<li><p><a class="reference external" href="https://github.com/ajwdewit/agera5tools" rel="noreferrer" target="_blank">AgERA5tools Python package</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.06.018" rel="noreferrer" target="_blank">De Wit+19</a>] A. de Wit et al., ‚Äò25 years of the WOFOST cropping systems model‚Äô, Agricultural Systems, vol. 168, pp. 154‚Äì167, Oct. 2019, doi: 10.1016/j.agsy.2018.06.018.</p>
<p>[<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>] H. Hersbach et al., ‚ÄòThe ERA5 global reanalysis‚Äô, Quarterly Journal of the Royal Meteorological Society, vol. 146, no. 730, pp. 1999‚Äì2049, May 2020, doi: 10.1002/qj.3803.</p>
<p>[<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>] J. Mu√±oz-Sabater et al., ‚ÄòERA5-Land: a state-of-the-art global reanalysis dataset for land applications‚Äô, Earth System Science Data, vol. 13, no. 9, pp. 4349‚Äì4383, Sept. 2021, doi: 10.5194/essd-13-4349-2021.</p>
<p>[<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/2024-12/Value-generated-by-ERA5-full-report.pdf" rel="noreferrer" target="_blank">Evenflow+24</a>] Evenflow, ‚ÄòThe value generated by ERA5‚Äô, Copernicus Climate Change Service (C3S), Bonn, Germany, Dec. 2024.</p>
<p>[<a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">AgERA5 dataset</a>] H. Boogaard, J. Schubert, A. de Wit, J. Lazebnik, R. Hutjes, and G. van der Grijn, ‚ÄòAgrometeorological indicators from 1979 to present derived from reanalysis‚Äô. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), Jan. 30, 2020. doi: 10.24381/cds.6c68c9bb.</p>
<p>[<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/custom-uploads/7th%20GA%20C3S/Presentations/Day%203/S1/05-s19.06.24_AgERA5UserPerspective_AllarddeWit_v1.pdf" rel="noreferrer" target="_blank">De Wit+24</a>] A. de Wit, H. Boogaard, S. Hoek, and E. M√ºller, ‚ÄòClimate Services for Agriculture ‚Äì A user perspective on AgERA5‚Äô, presented at the 7th C3S General Assembly, Brussels, Belgium, June 19, 2024.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.eja.2021.126419" rel="noreferrer" target="_blank">Araghi+22</a>] A. Araghi, C. J. Martinez, and J. E. Olesen, ‚ÄòEvaluation of multiple gridded solar radiation data for crop modeling‚Äô, European Journal of Agronomy, vol. 133, p. 126419, Feb. 2022, doi: 10.1016/j.eja.2021.126419.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.asr.2023.02.006" rel="noreferrer" target="_blank">Hasan Karaman+23</a>] √á. Hasan Karaman and Z. Aky√ºrek, ‚ÄòEvaluation of near-surface air temperature reanalysis datasets and downscaling with machine learning based Random Forest method for complex terrain of Turkey‚Äô, Advances in Space Research, vol. 71, no. 12, pp. 5256‚Äì5281, June 2023, doi: 10.1016/j.asr.2023.02.006.</p>
<p>[<a class="reference external" href="https://doi.org/10.17159/sajs.2024/16043" rel="noreferrer" target="_blank">Kruger+24</a>] J. A. Kruger, S. J. Roffe, and A. J. van der Walt, ‚ÄòAgERA5 representation of seasonal mean and extreme temperatures in the Northern Cape, South Africa‚Äô, South African Journal of Science, vol. 120, no. 3‚Äì4, pp. 1‚Äì13, Mar. 2024, doi: 10.17159/sajs.2024/16043.</p>
<p>[<a class="reference external" href="https://doi.org/10.1175/JAMC-D-23-0227.1" rel="noreferrer" target="_blank">Esquivel-Arriaga+24</a>] G. Esquivel-Arriaga et al., ‚ÄòPerformance Evaluation of Global Precipitation Datasets in Northern Mexico Drylands‚Äô, Journal of Applied Meteorology and Climatology, vol. 63, no. 12, pp. 1545‚Äì1558, Dec. 2024, doi: 10.1175/JAMC-D-23-0227.1.</p>
<p>[<a class="reference external" href="https://doi.org/10.1109/MERCon63886.2024.10689062" rel="noreferrer" target="_blank">Suraweera+24</a>] B. Suraweera, K. De Silva, L. Gunawardhana, and L. Rajapakse, ‚ÄòEvaluation of Satellite Rainfall Estimates for Surface Runoff Modelling in the Maha Oya Basin, Sri Lanka‚Äô, in 2024 Moratuwa Engineering Research Conference (MERCon), Aug. 2024, pp. 67‚Äì72. doi: 10.1109/MERCon63886.2024.10689062.</p>
<p>[<a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">Allen+98</a>] R. G. Allen, L. S. Pereira, D. Raes, and M. Smith, Crop evapotranspiration ‚Äì Guidelines for computing crop water requirements. in FAO Irrigation and drainage papers, no. 56. Rome, Italy: FAO ‚Äì Food and Agriculture Organization of the United Nations, 1998. Accessed: Nov. 24, 2025. [Online].</p>
<p>[<a class="reference external" href="https://doi.org/10.3390/hydrology12070161" rel="noreferrer" target="_blank">Garbanzo+25</a>] G. Garbanzo et al., ‚ÄòAddressing Weather Data Gaps in Reference Crop Evapotranspiration Estimation: A Case Study in Guinea-Bissau, West Africa‚Äô, Hydrology, vol. 12, no. 7, p. 161, June 2025, doi: 10.3390/hydrology12070161.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.ejrh.2025.102531" rel="noreferrer" target="_blank">Garcia-Prats+25</a>] A. Garcia-Prats et al., ‚ÄòHigh-resolution spatially interpolated FAO Penman-Monteith crop reference evapotranspiration maps of Sicily Island (Italy) and Jucar River system (Spain) using AgERA5 and ERA5-Land reanalysis datasets‚Äô, Journal of Hydrology: Regional Studies, vol. 60, p. 102531, Aug. 2025, doi: 10.1016/j.ejrh.2025.102531.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.05.002" rel="noreferrer" target="_blank">Ceglar+19</a>] A. Ceglar et al., ‚ÄòImproving WOFOST model to simulate winter wheat phenology in Europe: Evaluation and effects on yield‚Äô, Agricultural Systems, vol. 168, pp. 168‚Äì180, Jan. 2019, doi: 10.1016/j.agsy.2018.05.002.</p>
<p>[<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>] A. J. W. de Wit, H. L. Boogaard, I. Supit, and M. van den Berg, ‚ÄòSystem description of the WOFOST 7.2 cropping systems model‚Äô, Wageningen Environmental Research, May 2020. [Online].</p>
<p>[<a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278550984" rel="noreferrer" target="_blank">Boogaard+25</a>] H. Boogaard, A. de Wit, J. Lazebnik, J. Schubert, and G. van der Grijn, ‚ÄòData Stream 2: AgERA5 historic and near real time forcing data: Algorithm Theoretical Basis (ATBD)‚Äô, Copernicus Knowledge Base. Accessed: May 20, 2025. [Online].</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Indicators"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="indicator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Indicators</p>
      </div>
    </a>
    <a class="right-next"
       href="../Derived_Datasets/derived.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Derived Datasets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data">üåç Use case: Agricultural yield estimation based on reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading">Data downloading</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-variables">Derived variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">2. Download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">General setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agera5">AgERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-land">ERA5-Land</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulated-data-from-era5-land">Accumulated data from ERA5-Land</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-statistics-from-the-post-processed-era5-land-dataset">Daily statistics from the post-processed ERA5-Land dataset</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonise-datasets">Harmonise datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-alignment">Grid alignment</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-variable-names">Units and variable names</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Derived variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-by-point-comparison">Point-by-point comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-comparison">Time series comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#geospatial-comparison">Geospatial comparison</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">4. Conclusions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>