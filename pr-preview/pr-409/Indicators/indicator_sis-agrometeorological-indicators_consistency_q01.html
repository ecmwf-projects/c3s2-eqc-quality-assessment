
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.1. Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Indicators/indicator_sis-agrometeorological-indicators_consistency_q01';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Derived Datasets" href="../Derived_Datasets/derived.html" />
    <link rel="prev" title="6. Indicators" href="indicator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="indicator.html">6. Quality assessments for Climate Indicators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.1. Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FIndicators/indicator_sis-agrometeorological-indicators_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Indicators/indicator_sis-agrometeorological-indicators_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data">üåç Use case: Agricultural yield estimation based on reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading">Data downloading</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-variables">Derived variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">2. Download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">General setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agera5">AgERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-land">ERA5-Land</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulated-data-from-era5-land">Accumulated data from ERA5-Land</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-statistics-from-the-post-processed-era5-land-dataset">Daily statistics from the post-processed ERA5-Land dataset</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonise-datasets">Harmonise datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-alignment">Grid alignment</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-variable-names">Units and variable names</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Derived variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-by-point-comparison">Point-by-point comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-comparison">Time series comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#geospatial-comparison">Geospatial comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-conclusions">Discussion and Conclusions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="agricultural-simulations-using-agera5-regional-intercomparison-between-reanalysis-datasets">
<h1><span class="section-number">6.1. </span>Agricultural simulations using AgERA5: Regional intercomparison between reanalysis datasets<a class="headerlink" href="#agricultural-simulations-using-agera5-regional-intercomparison-between-reanalysis-datasets" title="Link to this heading">#</a></h1>
<p>Production date: 2025-MM-DD</p>
<p><strong>Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch.</strong></p>
<p>Dataset version: 2.0.</p>
<p>Produced by: Olivier Burggraaff (National Physical Laboratory).</p>
<section id="use-case-agricultural-yield-estimation-based-on-reanalysis-data">
<h2>üåç Use case: Agricultural yield estimation based on reanalysis data<a class="headerlink" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Which reanalysis dataset should I use for simulations of crop yields?</p></li>
<li><p>Is AgERA5 fit-for-purpose as an input dataset for crop models?</p></li>
</ul>
<p>Reliable estimation of crop yields using models such as WOrld FOod STudies (<a class="reference external" href="https://github.com/ajwdewit/pcse" rel="noreferrer" target="_blank">WOFOST</a>) [<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.06.018" rel="noreferrer" target="_blank">De Wit+19</a>] depends on reliable and fit-for-purpose meteorological data.
Crop models simulate growth and yield based on daily weather variables including temperature, solar irradiation, vapour pressure, wind speed, and precipitation (snow/rain).
Local simulations may make use of local observational data,
such as individual weather stations,
but these do not always provide sufficient spatial and temporal coverage and consistency.</p>
<p>Reanalyses
like ECMWF Reanalysis v5 (ERA5) [<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>]
provide meteorological data consistently and with gap-filled spatial and temporal coverage by combining historical observations and modelling.
Thanks to these advantages,
ERA5 and its higher-resolution derivative ERA5-Land [<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>]
are now commonly used to drive crop models [<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/2024-12/Value-generated-by-ERA5-full-report.pdf" rel="noreferrer" target="_blank">Evenflow+24</a>].
However,
these datasets were not designed specifically for agriculture and therefore require considerable processing before they can be used in crop models.</p>
<p>The <a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank"><em>Agrometeorological indicators from 1979 to present derived from reanalysis</em></a> or AgERA5 dataset fills this gap by providing agriculturally relevant variables in a ready-to-use format.
Compared to ERA5,
AgERA5 is downscaled from 0.25¬∞ to 0.1¬∞ spatial resolution,
aggregated to daily resolution in local time zones,
and
bias-adjusted.
It is accessible from the CDS directly [<a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">AgERA5 dataset</a>]
or through the <a class="reference external" href="https://github.com/ajwdewit/agera5tools" rel="noreferrer" target="_blank"><code class="docutils literal notranslate"><span class="pre">agera5tools</span></code></a> Python package.
AgERA5 has become very popular for crop modelling and climate analysis, among other use cases [<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/custom-uploads/7th%20GA%20C3S/Presentations/Day%203/S1/05-s19.06.24_AgERA5UserPerspective_AllarddeWit_v1.pdf" rel="noreferrer" target="_blank">De Wit+24</a>].</p>
<p>Here, we assess
the fitness-for-purpose of AgERA5 for agricultural studies
through an intercomparison with ERA5-Land.
The assessment focuses on
the ease of use of both datasets for this particular use case
as well as
the quantitative difference between AgERA5 and ERA5-Land for agriculturally relevant variables.
Both datasets are derived from ERA5,
with differences in their aggregation and downscaling methods as well as in the variables provided.
Hence,
this intercomparison is not an independent validation of either dataset,
but rather an intercomparison between similar products.
Quality assessments for ERA5 and ERA5-Land can be found in <a class="reference internal" href="../Reanalyses/reanalysis.html"><span class="std std-doc">the relevant chapter of this website</span></a>.</p>
<p>Agricultural intercomparisons are best performed regionally
to avoid confusing differences between datasets with physical differences between regions.
Accordingly,
this notebook is focused on one region in one growth season,
but it is written in such a way
that it can serve as a template for the user to pick up and apply to their own desired region or time frame.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The AgERA5 dataset (‚ÄúAgrometeorological indicators from 1979 to present derived from reanalysis‚Äù) is well-suited to agricultural studies because it provides daily aggregates and statistics of important parameters such as irradiation, temperature, vapour pressure, precipitation, wind speed, and snow depth.</p></li>
<li><p>The resolution of AgERA5 (daily, 0.1¬∞) is comparable to other data sources and is sufficient for simulations at similar spatial scales. Comparisons can be made at scales larger than the cell size, i.e. 0.1¬∞ or ~11 km.</p></li>
<li><p>The AgERA5 and ERA5-Land datasets, both derived from ERA5, provide different values due to their different methods for downscaling and bias adjustment. While these differences are (in some cases) statistically significant, they are small compared to the typical uncertainty in ERA5 and compared to the uncertainties in agricultural models. Differences may be larger in specific areas, e.g. at higher elevation.</p></li>
<li><p>etc</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This quality assessment tests the
ease of use
of the <a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank"><em>Agrometeorological indicators from 1979 to present derived from reanalysis</em></a> (AgERA5) dataset
and its consistency with
ERA5-Land (<a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank"><em>ERA5-Land hourly data from 1950 to present</em></a> and <a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank"><em>ERA5-Land post-processed daily statistics from 1950 to present</em></a>).
It focuses on the following variables of interest for a crop model such as <a class="reference external" href="https://github.com/ajwdewit/pcse" rel="noreferrer" target="_blank">PCSE/WOFOST</a>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Variable name</p></th>
<th class="head"><p>Statistic (24h)</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Example assessment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Solar irradiation</p></td>
<td><p>Total</p></td>
<td><p>MJ/m¬≤/day</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.1016/j.eja.2021.126419" rel="noreferrer" target="_blank">Araghi+22</a>]</p></td>
</tr>
<tr class="row-odd"><td><p>Temperature (2m)</p></td>
<td><p>Mean <br> Minimum <br> Maximum</p></td>
<td><p>¬∞C</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.17159/sajs.2024/16043" rel="noreferrer" target="_blank">Kruger+24</a>, <a class="reference external" href="https://doi.org/10.1016/j.asr.2023.02.006" rel="noreferrer" target="_blank">Hasan Karaman+23</a>]</p></td>
</tr>
<tr class="row-even"><td><p>Rain</p></td>
<td><p>Total</p></td>
<td><p>cm/day</p></td>
<td><p>[<a class="reference external" href="https://doi.org/10.1175/JAMC-D-23-0227.1" rel="noreferrer" target="_blank">Esquivel-Arriaga+24</a>, <a class="reference external" href="https://doi.org/10.1109/MERCon63886.2024.10689062" rel="noreferrer" target="_blank">Suraweera+24</a>]</p></td>
</tr>
<tr class="row-odd"><td><p>Wind speed (2m)</p></td>
<td><p>Mean</p></td>
<td><p>m/s</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Snow depth</p></td>
<td><p>Mean</p></td>
<td><p>cm</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<!--
| Vapour pressure   | Mean                           | kPa      |  |
[Source](https://pcse.readthedocs.io/en/stable/code.html#pcse.base.WeatherDataContainer)
-->
<p>AgERA5 also provides reference evapotranspiration values derived from the variables described above.
Example assessments comparing evapotranspiration between AgERA5 and other datasets include [<a class="reference external" href="https://doi.org/10.3390/hydrology12070161" rel="noreferrer" target="_blank">Garbanzo+25</a>, <a class="reference external" href="https://doi.org/10.1016/j.ejrh.2025.102531" rel="noreferrer" target="_blank">Garcia-Prats+25</a>].</p>
<p>Both AgERA5 and ERA5-Land provide wind speed at 10 m altitude,
following ERA5,
because this is the standard height for wind measurements in meteorology.
The wind speed at 2 m,
which crop models typically use for their evapotranspiration calculations,
can be estimated as 0.75 times the wind speed at 10 m [<a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">Allen+98</a>].</p>
<p>An important quantity derived from temperature is the number of <em>growing degree-days</em> (¬∞C d) or <em>thermal time</em> (TSUM in WOFOST).
Growing degree-days are essentially the sum of the <em>effective daily temperature</em> T<sub>eff</sub> over time,
with T<sub>eff</sub> the temperature relative to
a base temperature T<sub>base</sub>, below which crop development stops,
and
capped by a temperature T<sub>cap</sub>, above which crop development does not increase [<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>, <a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.05.002" rel="noreferrer" target="_blank">Ceglar+19</a>]:</p>
<!-- \qquad used because amsmath is not active, aligning with & in $$ is tricky -->
<div class="math notranslate nohighlight">
\[\begin{split}
T_\text{eff} &amp;= 0                 &amp;\qquad\text{if}&amp;&amp;\                  T \leq T_\text{base} \\
T_\text{eff} &amp;= T - T_\text{base} &amp;\qquad\text{if}&amp;&amp;\  T_\text{base} &lt; T &lt; T_\text{cap}     \\
T_\text{eff} &amp;= T_\text{cap}      &amp;\qquad\text{if}&amp;&amp;\                  T \geq T_\text{cap}  \\
\end{split}\]</div>
<p>The cumulative thermal time or total growing degree-days, TSUM, is the sum of T<sub>eff</sub> over time:</p>
<div class="math notranslate nohighlight">
\[
\text{TSUM} = \sum_t T_\text{eff}(t)
\]</div>
<p>In many crop models, growing degree-days control the development stages of a crop,
with thresholds set for emergence, anthesis, and maturity.
Specific values depend on the crop, cultivar, site, model, etc.
As an example,
temperate maize has T<sub>base</sub> of 4 ¬∞C and T<sub>cap</sub> of 30 ¬∞C, and TSUM of 110 ¬∞C d for emergence, 695 ¬∞C d for emergence‚Äìanthesis, and 800 ¬∞C d for anthesis‚Äìmaturity
in the <a class="reference external" href="https://github.com/ajwdewit/WOFOST_crop_parameters" rel="noreferrer" target="_blank">WOFOST crop parameter sets</a>.
These are the values of T<sub>base</sub> and T<sub>cap</sub> used in this assessment;
if running the notebook yourself, these values can be customised by editing the <code class="docutils literal notranslate"><span class="pre">growing_degree_days</span></code> function in the <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"><span class="std std-ref">code setup</span></a>.</p>
<p>A full crop model run is outside the scope of this assessment,
but the effective daily temperature and cumulative growing degree-days will be included in the analysis.
There are other agriculturally relevant cumulative quantities relating to moisture, irradiation, and nutrient absorption, but these are considerably more complex and therefore also out of scope here.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"><span class="std std-ref">1. Code setup</span></a></strong></p>
<ul class="simple">
<li><p>Import all required libraries.</p></li>
<li><p>Definition of helper functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-download"><span class="std std-ref">2. Download data</span></a></strong></p>
<ul class="simple">
<li><p>Download data from AgERA5.</p></li>
<li><p>Download data from ERA5-Land.</p></li>
<li><p>Pre-process data.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-section-results"><span class="std std-ref">3. Results</span></a></strong></p>
<ul class="simple">
<li><p>Geospatial comparison</p></li>
<li><p>Point-by-point comparison</p></li>
<li><p>Time series comparison</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="code-setup">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-setup"></span><h3>1. Code setup<a class="headerlink" href="#code-setup" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a> for
downloading (<a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a>)
and
visualising (<a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a>) data.
Because earthkit is in active development, some functionality may change after this notebook is published.
If any part of the code stops functioning, please raise an issue on our GitHub repository so it can be fixed.</p>
</div>
<section id="import-required-libraries">
<h4>Import required libraries<a class="headerlink" href="#import-required-libraries" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input / Output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.data</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="c1"># General data handling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span><span class="p">,</span> <span class="n">wraps</span>

<span class="c1"># Visualisation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>  <span class="c1"># Pretty-print</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.plots</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Style</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># Progress bars</span>

<span class="c1"># Visualisation in Jupyter book -- automatically ignored otherwise</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">glue</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Type hints for helper functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.geo.domains</span><span class="w"> </span><span class="kn">import</span> <span class="n">Domain</span>
<span class="n">AnyDomain</span> <span class="o">=</span> <span class="p">(</span><span class="n">Domain</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="helper-functions">
<h4>Helper functions<a class="headerlink" href="#helper-functions" title="Link to this heading">#</a></h4>
<p>This section defines some functions and variables used in the following analysis, allowing code cells in later sections to be shorter and ensuring consistency.</p>
<section id="data-downloading">
<h5>Data downloading<a class="headerlink" href="#data-downloading" title="Link to this heading">#</a></h5>
<p>The following functions help with downloading data within the desired spatial/temporal domain:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download within a spatial domain</span>
<span class="k">def</span><span class="w"> </span><span class="nf">domain_to_request</span><span class="p">(</span><span class="n">domain</span><span class="p">:</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">Domain</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; From an earthkit-plots domain, generate a request for earthkit-data / cdsapi. &quot;&quot;&quot;</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">to_latlon_bbox</span><span class="p">()</span>

    <span class="c1"># Round</span>
    <span class="n">north</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">north</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">south</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">south</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">west</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">west</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">east</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">east</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">}</span>

<span class="c1"># Pretty-print a request (dict)</span>
<span class="n">print_request</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">pprint</span><span class="o">.</span><span class="n">pp</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-pre-processing">
<h5>Data (pre-)processing<a class="headerlink" href="#data-pre-processing" title="Link to this heading">#</a></h5>
<p>The following functions handle <a class="reference external" href="https://docs.xarray.dev/en/latest/user-guide/dask.html" rel="noreferrer" target="_blank">data chunking in dask</a> for computational efficiency:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rechunking of data to speed up dask calculations</span>
<span class="c1"># and maintain grib / netcdf compatibility</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rechunk</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Rechunk a dataset `ds` based on pre-set memory requirements. &quot;&quot;&quot;</span>
    <span class="c1"># Assign new chunk sizes</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,}</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following cell defines the order in which data variables are shown in tables and figures, for consistency:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-defined variables to ensure consistent order</span>
<span class="c1"># These lists will be used as defaults in most functions below</span>
<span class="c1"># ALL-CAPS to signify these are constants</span>
<span class="n">VARIABLES_TEMPERATURE</span> <span class="o">=</span> <span class="p">[</span>
                         <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">,</span>
                        <span class="p">]</span>

<span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">=</span> <span class="p">[</span>
                             <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">,</span> 
                             <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">,</span>
                            <span class="p">]</span>

<span class="n">VARIABLES_DERIVED</span> <span class="o">=</span> <span class="p">[</span>
                     <span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">,</span>
                    <span class="p">]</span>


<span class="n">VARIABLES</span> <span class="o">=</span> <span class="n">VARIABLES_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span>
<span class="n">VARIABLES_RELATIVE</span> <span class="o">=</span> <span class="n">VARIABLES_NOT_TEMPERATURE</span> <span class="o">+</span> <span class="n">VARIABLES_DERIVED</span>  <span class="c1"># Variables for which relative differences make sense (not temperature)</span>

<span class="c1"># Shortcuts for display purposes</span>
<span class="n">nvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">VARIABLES</span><span class="p">)</span>
<span class="n">nvars_half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nvars</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle updating and propagating metadata:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Metadata handling</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjust_metadata</span><span class="p">(</span><span class="n">data_array</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="o">**</span><span class="n">updates</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Adjust metadata using a new dictionary. Returns a new object. &quot;&quot;&quot;</span>
    <span class="n">metadata_old</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">metadata_new</span> <span class="o">=</span> <span class="n">metadata_old</span> <span class="o">|</span> <span class="n">updates</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">metadata_new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_array</span>

<span class="c1"># Adjust metadata to a consistent format</span>
<span class="k">def</span><span class="w"> </span><span class="nf">adjust_names</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adjust the names and units of pre-defined variables in a dataset.</span>
<span class="sd">    Also adds the name of the dataset to its attrs for easy acces.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rename variables</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (max)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (mean)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Temperature (min)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Solar irradiation&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;MJ/m¬≤/d&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Wind speed (10 m)&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;m/s&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">]</span>          <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Total precipitation&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;mm/d&quot;</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">],</span> 
                                                             <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Snow depth&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>
    
    <span class="c1"># Assign dataset name</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">dataset_name</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">dataset</span>

<span class="c1"># Helper: Preserve CRS (decorator)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">preserve_crs</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Decorator that ensures propagation of CRS: find it in the original data and apply it to the result. &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">func_with_data</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
        <span class="c1"># Capture CRS from first dataset</span>
        <span class="n">CRS_present</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CRS_present</span><span class="p">:</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">crs</span>

        <span class="c1"># Apply function as normal</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Propagate CRS</span>
        <span class="k">if</span> <span class="n">CRS_present</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">func_with_data</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle unit conversions, e.g. K to ¬∞C:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unit conversion</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_unit</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert the units of dataset[key] to new_unit using a conversion function (e.g. lambda x: x*1000 for m to mm), in-place. &quot;&quot;&quot;</span>
    <span class="c1"># Metadata handling</span>
    <span class="n">metadata_old</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">metadata_new</span> <span class="o">=</span> <span class="n">metadata_old</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">new_unit</span><span class="p">}</span>

    <span class="c1"># Apply changes</span>
    <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">conversion</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">metadata_new</span><span class="p">)</span>

<span class="n">convert_m2cm</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span>    <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>  <span class="c1"># meter -&gt; centimeter</span>
<span class="n">convert_m2mm</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">1000</span><span class="p">),</span>   <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;cm&quot;</span><span class="p">)</span>  <span class="c1"># meter -&gt; millimeter</span>
<span class="n">convert_K2C</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">-</span><span class="mf">273.15</span><span class="p">),</span> <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>  <span class="c1"># Kelvin -&gt; Celsius</span>
<span class="n">convert_J2MJ</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="mf">1e6</span><span class="p">),</span>    <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;MJ/m¬≤/d&quot;</span><span class="p">)</span>  <span class="c1"># J/m¬≤/d -&gt; MJ/m¬≤/d</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle harmonisation of coordinates:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">round_coordinates</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Round coordinates in `data` to `d` decimals. Hard-coded for lat/lon. &quot;&quot;&quot;</span>
    <span class="c1"># Cannot be a dict-comp with coord in lat/lon because of symbol table issues</span>
    <span class="n">round_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span>
                     <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">d</span><span class="p">))}</span>

    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">round_mapping</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="derived-variables">
<h5>Derived variables<a class="headerlink" href="#derived-variables" title="Link to this heading">#</a></h5>
<p>The following functions calculate derived variables such as 2 m wind speed and growing degree-days:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_2m_wind_speed</span><span class="p">(</span><span class="n">wind_10m</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate 2 m wind speed from 10 m wind speed. &quot;&quot;&quot;</span>
    <span class="c1"># Calculate</span>
    <span class="n">wind_2m</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">wind_10m</span>

    <span class="c1"># Fix metadata</span>
    <span class="n">wind_2m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">wind_10m</span><span class="o">.</span><span class="n">attrs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Wind speed (2 m)&quot;</span><span class="p">}</span>
    <span class="n">wind_2m</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">wind_2m</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wind_2m</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert 10 m wind speed to 2 m wind speed. &quot;&quot;&quot;</span>
    <span class="c1"># Add new variable</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_2m_wind_speed</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">])</span>

    <span class="c1"># Remove old variable</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate growing degree days</span>
<span class="k">def</span><span class="w"> </span><span class="nf">growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                        <span class="n">T_base</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">T_cap</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; For a dataset `data` with temperatures, calculate the growing degree-days aggregated over the entire temporal range. &quot;&quot;&quot;</span>
    <span class="c1"># Use min/max temperatures</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;minmax&quot;</span><span class="p">:</span>
        <span class="n">T_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
        <span class="n">T_mean</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognised growing_degree_days method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; -- please use &#39;minmax&#39; or &#39;mean&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate T_eff</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_mean</span> <span class="o">-</span> <span class="n">T_base</span>  <span class="c1"># General case</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span> <span class="o">&gt;</span> <span class="n">T_base</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 0 if T &lt;= T_base</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span> <span class="o">&lt;</span> <span class="n">T_cap</span><span class="p">,</span> <span class="n">T_cap</span><span class="p">)</span>  <span class="c1"># T_cap if T &gt;= T_cap</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">T_eff</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Effective temperature&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C&quot;</span><span class="p">)</span>

    <span class="c1"># Aggregate TSUM</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">TSUM</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;Œ£ Growing degree-days&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;¬∞C d&quot;</span><span class="p">)</span>

    <span class="c1"># Propagate NaN</span>
    <span class="n">T_eff</span> <span class="o">=</span> <span class="n">T_eff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">TSUM</span> <span class="o">=</span> <span class="n">TSUM</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">T_mean</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">T_eff</span><span class="p">,</span> <span class="n">TSUM</span>

<span class="c1"># Convenience: Add growing degree days to dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate growing degree days (daily, aggregate) and add them to the input dataset. &quot;&quot;&quot;</span>
    <span class="n">T_eff</span><span class="p">,</span> <span class="n">TSUM</span> <span class="o">=</span> <span class="n">growing_degree_days</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">T_eff</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TSUM</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="statistics">
<h5>Statistics<a class="headerlink" href="#statistics" title="Link to this heading">#</a></h5>
<p>The following functions calculate the difference (absolute / relative) between datasets, handling metadata etc.:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labels</span>
<span class="k">def</span><span class="w"> </span><span class="nf">label_with_unit</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extract the full name with unit for a key in a dataset. &quot;&quot;&quot;</span>
    <span class="n">long_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span>  <span class="c1"># Variable name</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">units</span> <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">unit</span>  <span class="c1"># If unit is specified -&gt; use that ; else -&gt; use metadata unit</span>
    <span class="n">spacer</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">linebreak</span> <span class="k">else</span> <span class="s2">&quot; &quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">long_name</span><span class="si">}{</span><span class="n">spacer</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants</span>
<span class="n">NONZERO_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">NONZERO_THRESHOLD_PCT</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Difference between datasets</span>
<span class="nd">@preserve_crs</span>
<span class="k">def</span><span class="w"> </span><span class="nf">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                <span class="n">diff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate the difference between two datasets, preserving CRS and updating metadata. &quot;&quot;&quot;</span>
    <span class="c1"># Subtract</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">diff_variables</span><span class="p">],</span> <span class="n">data2</span><span class="p">[</span><span class="n">diff_variables</span><span class="p">])</span>

    <span class="c1"># Adjust metadata</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">diff_variables</span><span class="p">:</span>
        <span class="n">old_metadata</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
        <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">old_metadata</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Œî &quot;</span> <span class="o">+</span> <span class="n">old_metadata</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]}</span>
        <span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="o">**</span><span class="n">updated_metadata</span><span class="p">)</span>

    <span class="c1"># Add name</span>
    <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&lt;unspecified&gt;&quot;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Difference: </span><span class="si">{</span><span class="n">name1</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">name2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
        
    <span class="k">return</span> <span class="n">difference</span>

<span class="nd">@preserve_crs</span>
<span class="k">def</span><span class="w"> </span><span class="nf">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                         <span class="n">reldiff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_RELATIVE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the relative [%] difference between two datasets, preserving CRS and updating metadata.</span>
<span class="sd">    Relative difference is calculated symmetrically, i.e. divided by (data1 + data2)/2.</span>
<span class="sd">    Where data1 == 0 and data2 == 0, the relative difference is set to 0 too.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select and calculate</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="n">reldiff_variables</span><span class="p">]</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    
    <span class="n">relative_difference</span> <span class="o">=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">-</span> <span class="n">data2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">200.</span>

    <span class="c1"># Replace 0/0 with 0</span>
    <span class="n">both_zero</span> <span class="o">=</span> <span class="p">((</span><span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">NONZERO_THRESHOLD</span><span class="p">)</span>  <span class="c1"># Threshold slightly &gt; 0 because of floating-point errors</span>
    <span class="n">relative_difference</span> <span class="o">=</span> <span class="n">relative_difference</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">both_zero</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

    <span class="c1"># Adjust metadata</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">reldiff_variables</span><span class="p">:</span>
        <span class="n">old_metadata</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
        <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">old_metadata</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;rŒî &quot;</span> <span class="o">+</span> <span class="n">old_metadata</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">],</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
        <span class="n">relative_difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_metadata</span><span class="p">(</span><span class="n">relative_difference</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="o">**</span><span class="n">updated_metadata</span><span class="p">)</span>

    <span class="c1"># Add name</span>
    <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&lt;unspecified&gt;&quot;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    <span class="n">relative_difference</span> <span class="o">=</span> <span class="n">relative_difference</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;% Difference: </span><span class="si">{</span><span class="n">name1</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">name2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">relative_difference</span>

<span class="k">def</span><span class="w"> </span><span class="nf">comparison_statistics</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                          <span class="n">diff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES</span><span class="p">,</span>
                          <span class="n">reldiff_variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES_RELATIVE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given two datasets, calculate a number of statistics for each variable and return the result in a table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate differences</span>
    <span class="n">differences</span>     <span class="o">=</span>          <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">diff_variables</span><span class="o">=</span><span class="n">diff_variables</span><span class="p">)</span>
    <span class="n">differences_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">reldiff_variables</span><span class="o">=</span><span class="n">reldiff_variables</span><span class="p">)</span>

    <span class="c1"># Convert to pandas</span>
    <span class="n">differences</span> <span class="o">=</span> <span class="n">differences</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="n">diff_variables</span><span class="p">]</span>
    <span class="n">differences_abs</span> <span class="o">=</span> <span class="n">differences</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="n">differences_rel</span> <span class="o">=</span> <span class="n">differences_rel</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()[</span><span class="n">reldiff_variables</span><span class="p">]</span>
    <span class="n">differences_rel_abs</span> <span class="o">=</span> <span class="n">differences_rel</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>

    <span class="c1"># Calculate aggregate statistics</span>
    <span class="n">md</span>   <span class="o">=</span>               <span class="n">differences</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median Œî&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="s2">&quot;Mean Œî&quot;</span><span class="p">})</span>
    <span class="n">mad</span>  <span class="o">=</span>           <span class="n">differences_abs</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median |Œî|&quot;</span><span class="p">})</span>
    <span class="n">mapd</span> <span class="o">=</span>       <span class="n">differences_rel_abs</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;median&quot;</span><span class="p">])</span>  \
                                    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;median&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Median |Œî| [%]&quot;</span><span class="p">})</span>
    <span class="n">md</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span><span class="p">)]</span>

    <span class="c1"># Calculate correlation coefficients</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">data2</span><span class="p">[</span><span class="n">var</span><span class="p">])</span><span class="o">.</span><span class="n">values</span> 
             <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">diff_variables</span><span class="p">}</span>
    <span class="n">corrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">corrs</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pearson r&quot;</span><span class="p">])</span>
    
    <span class="c1"># Combine statistics into one dataframe</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">md</span><span class="p">,</span> <span class="n">mad</span><span class="p">,</span> <span class="n">mapd</span><span class="p">,</span> <span class="n">corrs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">stats</span>

<span class="k">def</span><span class="w"> </span><span class="nf">display_difference_stats</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Given two datasets, calculate a number of statistics for each variable and display the result in a table. &quot;&quot;&quot;</span>
    <span class="c1"># Helper function for displaying variables / units nicely</span>
    <span class="c1"># Uses &lt;br&gt; instead of &quot;\n&quot; for HTML output</span>
    <span class="n">display_var</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">var</span><span class="p">:</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br&gt;&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate and format statistics</span>
    <span class="n">comparison_stats</span> <span class="o">=</span> <span class="n">comparison_statistics</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">formatted</span> <span class="o">=</span> <span class="n">comparison_stats</span><span class="o">.</span><span class="n">style</span> \
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  \
                                <span class="o">.</span><span class="n">format_index</span><span class="p">(</span><span class="n">display_var</span><span class="p">)</span> \
                                <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s2">&quot;AgERA5 ‚Äì ERA5-Land&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">formatted</span>

<span class="k">def</span><span class="w"> </span><span class="nf">timeseries_statistics</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; For a given dataset, provide statistics (mean, standard deviation) averaged spatially. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">coords</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions aid in sub-selecting data, e.g. extracting time series:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subselection of data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">select_in_multiple_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">datasets</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Extract the same selection (e.g. one site, time series, ...) from any number of datasets. &quot;&quot;&quot;</span>
    <span class="n">datasets_selected</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">datasets_selected</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="visualisation">
<h5>Visualisation<a class="headerlink" href="#visualisation" title="Link to this heading">#</a></h5>
<p>The following cell defines <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/_api/plots/styles/index.html" rel="noreferrer" target="_blank">earthkit-plots styles</a> for the variables in the datasets.
These styles define the colour maps and colour bar ranges for each quantity.
Earthkit-plots styles are explained further in the <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/examples/examples/examples.html#Styles" rel="noreferrer" target="_blank">corresponding documentation</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Styles for indicators</span>
<span class="n">n_diff</span> <span class="o">=</span> <span class="mi">9</span>  <span class="c1"># Levels in difference charts</span>

<span class="c1"># Temperature</span>
<span class="n">_style_t</span>        <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrBr</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>    <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_t_diff</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_gdd</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>    <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mf">3e3</span><span class="p">,</span><span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_gdd_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Irradiation</span>
<span class="n">_style_ssrd</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">YlOrRd</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>   <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_ssrd_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Wind speed</span>
<span class="n">_style_wind</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Purples</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>  <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_wind_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">PuOr</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Precipitation</span>
<span class="n">_style_tp</span>        <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">GnBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>     <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_tp_diff</span>   <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BrBG</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_snow</span>      <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">GnBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>      <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">}</span>
<span class="n">_style_snow_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">BrBG</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="n">n_diff</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>

<span class="c1"># Individual styles</span>
<span class="c1"># Set up like this so they can still be edited individually</span>
<span class="n">styles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Max_24h_diff&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Mean_24h_diff&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Air_2m_Min_24h_diff&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Temperature_Effective&quot;</span><span class="p">:</span>       <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t</span><span class="p">),</span>      <span class="s2">&quot;Temperature_Effective_diff&quot;</span><span class="p">:</span>       <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_t_diff</span><span class="p">),</span>
    <span class="s2">&quot;Growing_Degree_Days&quot;</span><span class="p">:</span>         <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_gdd</span><span class="p">),</span>    <span class="s2">&quot;Growing_Degree_Days_diff&quot;</span><span class="p">:</span>         <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_gdd_diff</span><span class="p">),</span>
    <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">:</span>        <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_ssrd</span><span class="p">),</span>   <span class="s2">&quot;Solar_Radiation_Flux_diff&quot;</span><span class="p">:</span>        <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_ssrd_diff</span><span class="p">),</span>
    <span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind</span><span class="p">),</span>   <span class="s2">&quot;Wind_Speed_10m_Mean_24h_diff&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind_diff</span><span class="p">),</span>
    <span class="s2">&quot;Wind_Speed_2m_Mean_24h&quot;</span><span class="p">:</span>      <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind</span><span class="p">),</span>   <span class="s2">&quot;Wind_Speed_2m_Mean_24h_diff&quot;</span><span class="p">:</span>      <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_wind_diff</span><span class="p">),</span>
    <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">:</span>          <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_tp</span><span class="p">),</span>     <span class="s2">&quot;Precipitation_Flux_diff&quot;</span><span class="p">:</span>          <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_tp_diff</span><span class="p">),</span>
    <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_snow</span><span class="p">),</span>   <span class="s2">&quot;Snow_Thickness_Mean_24h_diff&quot;</span><span class="p">:</span>     <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_snow_diff</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Apply general settings</span>
<span class="k">for</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">styles</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">style</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions are helpers for displaying in Jupyter Notebook or Jupyter Book style, adding textboxes with consistent formatting, adjusting axis limits, etc.:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Helper functions, general</span>
<span class="n">RELATIVE_DIFFERENCE_LIMIT</span> <span class="o">=</span> <span class="mi">50</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If `glue` is available, glue the figure using the provided label.</span>
<span class="sd">    If not, display the figure in the notebook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">glue</span><span class="p">(</span><span class="n">glue_label</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">|</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Add a text box to each of the specified subplots. &quot;&quot;&quot;</span>
    <span class="c1"># Get the plt.Axes for each ekp.Subplot</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">subplot</span><span class="o">.</span><span class="n">ax</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">)</span> <span class="k">else</span> <span class="n">subplot</span> <span class="k">for</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>

    <span class="c1"># Set up location</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.95</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="mf">0.05</span>
    <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="s2">&quot;left&quot;</span>

    <span class="c1"># Add the text</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;boxstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span>
              <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_sharexy</span><span class="p">(</span><span class="n">axs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Force all of the axes in axs to share x and/or y with the first element. &quot;&quot;&quot;</span>
    <span class="n">main_ax</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">main_ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">main_ax</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_symmetric_lim</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Adjust the x- or y-lims for one Axes to be symmetric, based on existing values. &quot;&quot;&quot;</span>
    <span class="c1"># Pick axis</span>
    <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">getter</span><span class="p">,</span> <span class="n">setter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span>
    <span class="k">elif</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
        <span class="n">getter</span><span class="p">,</span> <span class="n">setter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_symmetric_lim needs axis &#39;x&#39; or &#39;y&#39;, was given &#39;</span><span class="si">{</span><span class="n">which</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Apply</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">getter</span><span class="p">()</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
    <span class="n">maxlim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
    <span class="n">newlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">maxlim</span><span class="p">,</span> <span class="n">maxlim</span><span class="p">)</span>
    <span class="n">setter</span><span class="p">(</span><span class="n">newlim</span><span class="p">)</span>

<span class="n">_symmetric_xlim</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_symmetric_lim</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">_symmetric_ylim</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_symmetric_lim</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Retrieve a style from the global styles dict, then use its vmin/vmax to set the x/y lim for this ax. &quot;&quot;&quot;</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span>
    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_percentile</span><span class="p">(</span><span class="o">*</span><span class="n">data_arrays</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">],</span> <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">round</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the specified percentile across all of the provided datasets.</span>
<span class="sd">    Used for making consistent colour maps and axis limits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">data_arrays</span><span class="p">])</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanpercentile</span><span class="p">(</span><span class="n">data_flat</span><span class="p">,</span> <span class="n">percentile</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">round</span> <span class="o">==</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span>
        <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">round</span> <span class="o">==</span> <span class="s2">&quot;down&quot;</span><span class="p">:</span>
        <span class="n">perc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">perc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">perc</span>

<span class="n">cmap_percentile</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">find_vmin</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">find_percentile</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">cmap_percentile</span><span class="p">)</span>
<span class="n">find_vmax</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">find_percentile</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">100</span><span class="o">-</span><span class="n">cmap_percentile</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">subplots_2byN</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a figure with 2 x (N/2) panels, with N the number of variables.</span>
<span class="sd">    Return them unravelled, turning off and removing any spares (e.g. 8th panel for 7 variables).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create figure, panels</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nvars_half</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

    <span class="c1"># White out last panel if odd number of variables</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="n">nvars</span><span class="p">:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[:</span><span class="n">nvars</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions are also base helper functions, but specific to geospatial plots:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Helper functions for geospatial plots</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyDomain</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot any number of datasets into new subplots in an existing earthkit figure. &quot;&quot;&quot;</span>
    <span class="c1"># Create subplots</span>
    <span class="n">subplots</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>

    <span class="c1"># Plot</span>
    <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subplots</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">subplots</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform geospatial comparisons between datasets, including the per-pixel difference:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Plot indicators geospatially</span>
<span class="k">def</span><span class="w"> </span><span class="nf">geospatial_comparison_with_difference</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                          <span class="n">variables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="n">VARIABLES</span><span class="p">,</span>
                                          <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                                          <span class="n">domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AnyDomain</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of `variables` in two datasets, geospatially.</span>
<span class="sd">    A specific date has to be specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pre-process: Select data on specified date, calculate difference</span>
    <span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">date</span><span class="p">)</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span><span class="p">,</span> <span class="n">diff_variables</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>

    <span class="c1"># Setup indicators</span>
    <span class="n">n_variables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>
    <span class="n">loop_variables</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Plotting variables&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">n_variables</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n_variables</span><span class="p">)))</span>

    <span class="c1"># Plot indicators</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">loop_variables</span><span class="p">:</span>
        <span class="c1"># Plot individual datasets</span>
        <span class="n">subplots_data</span> <span class="o">=</span> <span class="n">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">data1_date</span><span class="p">,</span> <span class="n">data2_date</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> 
                                                      <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>

        <span class="c1"># Plot difference</span>
        <span class="n">subplot_diff</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">_spatial_plot_append_subplots</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">difference</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
                                                         <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">_diff&quot;</span><span class="p">])</span>
        <span class="c1"># Decorate: Text + Colour bar</span>
        <span class="n">var_label</span> <span class="o">=</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">subplots_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">var_label</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">subplot_diff</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="c1"># Titles on top</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">,</span> <span class="s2">&quot;Difference&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">titles</span><span class="p">,</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Decorate figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">land</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Geospatial intercomparison: {time:</span><span class="si">%-d</span><span class="s2"> %B %Y}&quot;</span><span class="p">)</span>
    
    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform point-by-point (scatter, histogram) comparisons between datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Point-by-point comparison - Scatter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">scatter_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                       <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                       <span class="n">n_bins</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                       <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with one-to-one comparisons.</span>
<span class="sd">    Hard-coded for VARIABLES, VARIABLES_TEMPERATURE, VARIABLES_NOT_TEMPERATURE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">subplots_2byN</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="c1"># Plot individual scatter plots</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Get vmin/vmax for lims</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">data2</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                  <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">],</span> <span class="n">style</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]),</span>
                  <span class="n">gridsize</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">mincnt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>

        <span class="c1"># Set limits from style, matching colour maps</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
        
        <span class="n">var_label</span> <span class="o">=</span> <span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">var_label</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># Highlight diagonal</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">slope</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Point-by-point comparison across full domain&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="n">label2</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Point-by-point comparison - Histogram</span>
<span class="k">def</span><span class="w"> </span><span class="nf">histogram_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                         <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                         <span class="n">n_bins</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">51</span><span class="p">,</span>
                         <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">difference_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nvars</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nvars</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>
    
    <span class="c1"># Share x, y for temperature plots; assume these are the first N panels</span>
    <span class="n">n_temperature_variables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">VARIABLES_TEMPERATURE</span><span class="p">)</span>
    <span class="n">axes_temperature</span>     <span class="o">=</span> <span class="n">axs</span><span class="p">[:</span><span class="n">n_temperature_variables</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">axes_not_temperature</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">n_temperature_variables</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">_sharexy</span><span class="p">(</span><span class="n">axes_temperature</span><span class="p">)</span>
    
    <span class="c1"># Share y for absolute/relative non-temperature plots (row-wise)</span>
    <span class="k">for</span> <span class="n">ax_row</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="n">n_temperature_variables</span><span class="p">:]:</span>
        <span class="n">_sharexy</span><span class="p">(</span><span class="n">ax_row</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    
    <span class="c1"># Plot differences</span>
    <span class="k">for</span> <span class="n">ax_row</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Limits based on styles</span>
        <span class="n">lim</span> <span class="o">=</span> <span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
    
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">)</span>
        <span class="n">bins_rel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">lim</span><span class="p">,</span> <span class="n">lim</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">)</span>
    
        <span class="c1"># Plot differences</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">difference_rel</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins_rel</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Remove panel if there are no relative differences, e.g. temperature</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># If panel is active</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
            <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
        
        <span class="c1"># Axis labels</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;%&quot;</span><span class="p">))</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
    
    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
        <span class="c1"># Highlight 0</span>
        <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">axison</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    
        <span class="c1"># Log scale if the histogram is extremely concentrated (usually around 0)</span>
        <span class="c1"># if ax.get_ylim()[1] &gt; 1e5:</span>
            <span class="c1"># ax.set_yscale(&quot;log&quot;)</span>
    
    <span class="c1"># Figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">difference</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (overall distribution)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>
    
    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions perform time series comparisons between datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time series comparisons</span>
<span class="c1"># Consistent styling</span>
<span class="n">COLOURS_DATA</span> <span class="o">=</span> <span class="s2">&quot;#4477aa&quot;</span><span class="p">,</span> <span class="s2">&quot;#ee6677&quot;</span>
<span class="n">COLOUR_DIFF</span><span class="p">,</span> <span class="n">COLOUR_DIFF_REL</span> <span class="o">=</span> <span class="s2">&quot;#004488&quot;</span><span class="p">,</span> <span class="s2">&quot;#ddaa33&quot;</span>
<span class="n">ALPHA_TIMESERIES</span> <span class="o">=</span> <span class="mf">0.6</span>

<span class="c1"># Consistent plot setup</span>
<span class="n">_subplots_timeseries</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nvars</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nvars</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_plot_mean_and_std</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot the mean (line) and std (shaded area) into an ax. &quot;&quot;&quot;</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">mean</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">std</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>  <span class="c1"># Short-hand</span>
    <span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># Mean</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">m</span> <span class="o">-</span> <span class="n">s</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">s</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># Spread</span>


<span class="c1"># Time series comparison - Values - One site</span>
<span class="k">def</span><span class="w"> </span><span class="nf">timeseries_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">site</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                          <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                          <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with time series comparisons -- here showing the values of variables.</span>
<span class="sd">    Hard-coded for VARIABLES, VARIABLES_TEMPERATURE, VARIABLES_NOT_TEMPERATURE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select site</span>
    <span class="n">timeseries</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">_subplots_timeseries</span><span class="p">()</span>

    <span class="c1"># Plot time series</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Plot individual time series</span>
        <span class="k">for</span> <span class="n">ts</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">COLOURS_DATA</span><span class="p">,</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">]):</span>
            <span class="n">ts</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Set vertical limits from style, matching colour maps</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

        <span class="c1"># Label variable</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">linebreak</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>

    <span class="c1"># Decoration</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series comparison at (</span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞E)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Time series comparison - Difference - One site</span>
<span class="k">def</span><span class="w"> </span><span class="nf">timeseries_comparison_difference</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">site</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                     <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                                     <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with time series comparisons -- here showing the difference (abs+rel).</span>
<span class="sd">    Hard-coded for VARIABLES, VARIABLES_TEMPERATURE, VARIABLES_NOT_TEMPERATURE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select site</span>
    <span class="n">timeseries</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>

    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">timeseries</span><span class="p">)</span>
    <span class="n">difference_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="o">*</span><span class="n">timeseries</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">_subplots_timeseries</span><span class="p">()</span>

    <span class="c1"># Plot time series</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Plot absolute difference</span>
        <span class="n">difference</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>
    
        <span class="c1"># Set vertical limits from style, matching colour maps</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    
        <span class="c1"># Label variable</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>
    
        <span class="c1"># Make ytick colour match line + ylabel</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>
    
        <span class="c1"># Plot relative difference</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">VARIABLES_RELATIVE</span><span class="p">:</span>
            <span class="c1"># Create second y-axis</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    
            <span class="c1"># Plot relative difference</span>
            <span class="n">difference_rel</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>
    
            <span class="c1"># Set vertical limits</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">)</span>
    
            <span class="c1"># Label variable</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Difference [%]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>
    
            <span class="c1"># Make ytick colour match line + ylabel</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>
    
            <span class="c1"># Remove unneeded visuals</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    
    <span class="c1"># Decoration</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series comparison at (</span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞E)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>
    
    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Time series comparison - Difference - All sites</span>
<span class="k">def</span><span class="w"> </span><span class="nf">timeseries_comparison_difference_multi</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                           <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;AgERA5&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5-Land&quot;</span><span class="p">,</span>
                                           <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a list of variables in two datasets, with time series comparisons -- here showing the difference (abs+rel).</span>
<span class="sd">    Hard-coded for VARIABLES, VARIABLES_TEMPERATURE, VARIABLES_NOT_TEMPERATURE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">difference_rel</span> <span class="o">=</span> <span class="n">relative_difference_between_datasets</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>

    <span class="c1"># Calculate statistics</span>
    <span class="n">difference_stats</span> <span class="o">=</span> <span class="n">timeseries_statistics</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>
    <span class="n">difference_rel_stats</span> <span class="o">=</span> <span class="n">timeseries_statistics</span><span class="p">(</span><span class="n">difference_rel</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">_subplots_timeseries</span><span class="p">()</span>

    <span class="c1"># Plot time series</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">VARIABLES</span><span class="p">):</span>
        <span class="c1"># Plot absolute difference</span>
        <span class="n">_plot_mean_and_std</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">difference_stats</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>

        <span class="c1"># Set vertical limits from style, matching colour maps</span>
        <span class="n">_set_lim_from_style</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    
        <span class="c1"># Label variable</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">label_with_unit</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">var</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span>

        <span class="c1"># Make ytick colour match line + ylabel</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF</span><span class="p">)</span>

        <span class="c1"># Plot relative difference</span>
        <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">VARIABLES_RELATIVE</span><span class="p">:</span>
            <span class="c1"># Create second y-axis</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

            <span class="c1"># Plot relative difference</span>
            <span class="n">_plot_mean_and_std</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="o">*</span><span class="n">difference_rel_stats</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">ALPHA_TIMESERIES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>

            <span class="c1"># Set vertical limits</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">,</span> <span class="n">RELATIVE_DIFFERENCE_LIMIT</span><span class="p">)</span>

            <span class="c1"># Label variable</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Difference [%]&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>

            <span class="c1"># Make ytick colour match line + ylabel</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">COLOUR_DIFF_REL</span><span class="p">)</span>

            <span class="c1"># Remove unneeded visuals</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># Visual settings</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.color&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

    <span class="c1"># Decoration</span>
    <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Time series comparison (overall)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>
<section id="download-data">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-download"></span><h3>2. Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h3>
<section id="general-setup">
<h4>General setup<a class="headerlink" href="#general-setup" title="Link to this heading">#</a></h4>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a> to download files from the CDS.
If you intend to run this notebook multiple times, it is highly recommended that you <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/caching.html" rel="noreferrer" target="_blank">enable caching</a> to prevent having to download the same files multiple times.
If you prefer not to use earthkit, the following requests can also be used with the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api#linux-use-client-step" rel="noreferrer" target="_blank">cdsapi module</a>.
In either case (earthkit-data or cdsapi), it is required to set up a CDS account and API key as explained <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api" rel="noreferrer" target="_blank">on the CDS website</a>.</p>
<p>We will be downloading multiple datasets in this notebook.
CDS data requests take the form of dictionaries in Python.
When making multiple requests
(e.g. to download data from multiple catalogue entries),
it is convenient to set up a <em>template</em> request with some default parameters.
In this section, we define our template containing those parameters that are constant between datasets: the domain in time and space.
This way, these are guaranteed to be consistent between downloads
and
only need to be changed in one place if you wish to modify the notebook for your own use case.</p>
<p>In this example, we will be looking at data for the United Kingdom and Ireland every day in January‚ÄìSeptember 2023.
We will also do a time series comparison at one site within this area.
To customise the domain, site, and period,
edit the variables in the following cell:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Space</span>
<span class="n">domain</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">,</span> <span class="s2">&quot;Ireland&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;UK &amp; Ireland&quot;</span><span class="p">)</span>
<span class="n">site</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">52.5</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>

<span class="c1"># Time</span>
<span class="n">year</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">months</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># [start, end)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The CDS request template is then defined using the values defined above.
Additional information to download specific data variables will be mixed into this template in the next sections.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Space</span>
<span class="n">request_domain</span> <span class="o">=</span> <span class="n">domain_to_request</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>

<span class="c1"># Time</span>
<span class="n">request_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mo</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">months</span><span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>  <span class="c1"># All days</span>
<span class="p">}</span>

<span class="c1"># Template (combining space + time)</span>
<span class="n">request_default</span> <span class="o">=</span> <span class="n">request_domain</span> <span class="o">|</span> <span class="n">request_time</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request template:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_default</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template:
{&#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="agera5">
<h4>AgERA5<a class="headerlink" href="#agera5" title="Link to this heading">#</a></h4>
<p>Due to size limits on the CDS, the different variables of interest in AgERA5 (temperature, irradiation, etc.) have to be downloaded separately and then combined afterwards.
This is achieved by combining the previously defined template request with parameters specific to AgERA5, and subsequently with parameters specific to each individual variable.</p>
<p>First, the parameters specific to AgERA5 (dataset ID and version) are defined and combined with the template:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agera5_ID</span> <span class="o">=</span> <span class="s2">&quot;sis-agrometeorological-indicators&quot;</span>

<span class="n">request_agera5_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_0&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">agera5_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_agera5_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for sis-agrometeorological-indicators:
{&#39;version&#39;: &#39;2_0&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temperature has to be split into separate requests because of size limits</span>
<span class="n">request_temperature_min</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_minimum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_max</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_maximum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_mean</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Non-temperature variables</span>
<span class="n">request_irradiation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;solar_radiation_flux&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_wind</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_wind_speed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_rain</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;precipitation_flux&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_snow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;snow_thickness&quot;</span><span class="p">,</span>
    <span class="s2">&quot;statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;24_hour_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Compile all requests into one list for easier iteration</span>
<span class="n">requests_agera5_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_temperature_min</span><span class="p">,</span> <span class="n">request_temperature_max</span><span class="p">,</span> <span class="n">request_temperature_mean</span><span class="p">,</span>
                             <span class="n">request_irradiation</span><span class="p">,</span>
                             <span class="n">request_rain</span><span class="p">,</span>
                             <span class="n">request_wind</span><span class="p">,</span>
                             <span class="n">request_snow</span><span class="p">,</span>
                            <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.
Earthkit-data downloads the dataset as a <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/data.html" rel="noreferrer" target="_blank">field list</a>, which can be manipulated directly.
Here, we convert it to an <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html" rel="noreferrer" target="_blank">xarray object</a> for ease of use later (when comparing multiple datasets):</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_agera5</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_agera5_default</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_agera5_variables</span><span class="p">]</span>

<span class="c1"># Show one example</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Example request for one variable from </span><span class="si">{</span><span class="n">agera5_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">requests_agera5</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Example request for one variable from sis-agrometeorological-indicators:
{&#39;version&#39;: &#39;2_0&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;],
 &#39;variable&#39;: &#39;2m_temperature&#39;,
 &#39;statistic&#39;: [&#39;24_hour_minimum&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data and convert to desired format</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">agera5_ID</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_agera5</span><span class="p">)</span>  <span class="c1"># Download as field list</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">data_agera5</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>  <span class="c1"># Rechunk in Dask for better performance -- not strictly necessary</span>
<span class="n">data_agera5</span>  <span class="c1"># Display in notebook</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 7/7 [00:00&lt;00:00, 118.37it/s]
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 179MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
Data variables:
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    crs                          (time) int64 2kB dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Solar_Radiation_Flux         (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Wind_Speed_10m_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
Attributes:
    Conventions:  CF-1.7
    title:        AgERA5 daily weather variables derived from the ECMWF ERA5 ...
    institution:  Wageningen Environmental Research
    history:      Generated by `pragera5 run_daily_processing 2023-01-01` ver...
    references:   https://doi.org/10.24381/cds.6c68c9bb
    source:       ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-75433ddd-30dc-4295-be5f-84cef21542a0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-75433ddd-30dc-4295-be5f-84cef21542a0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c8fb8685-575a-46e1-b3a2-2190eb3d96bc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c8fb8685-575a-46e1-b3a2-2190eb3d96bc' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-257b816f-a3dd-4636-810e-4e459972b091' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-257b816f-a3dd-4636-810e-4e459972b091' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80703358-cfb8-49d3-8d0a-8034236cfecd' class='xr-var-data-in' type='checkbox'><label for='data-80703358-cfb8-49d3-8d0a-8034236cfecd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-1.290000e+01, -1.280000e+01, -1.270000e+01, -1.260000e+01,
       -1.250000e+01, -1.240000e+01, -1.230000e+01, -1.220000e+01,
       -1.210000e+01, -1.200000e+01, -1.190000e+01, -1.180000e+01,
       -1.170000e+01, -1.160000e+01, -1.150000e+01, -1.140000e+01,
       -1.130000e+01, -1.120000e+01, -1.110000e+01, -1.100000e+01,
       -1.090000e+01, -1.080000e+01, -1.070000e+01, -1.060000e+01,
       -1.050000e+01, -1.040000e+01, -1.030000e+01, -1.020000e+01,
       -1.010000e+01, -1.000000e+01, -9.900000e+00, -9.800000e+00,
       -9.700000e+00, -9.600000e+00, -9.500000e+00, -9.400000e+00,
       -9.300000e+00, -9.200000e+00, -9.100000e+00, -9.000000e+00,
       -8.900000e+00, -8.800000e+00, -8.700000e+00, -8.600000e+00,
       -8.500000e+00, -8.400000e+00, -8.300000e+00, -8.200000e+00,
       -8.100000e+00, -8.000000e+00, -7.900000e+00, -7.800000e+00,
       -7.700000e+00, -7.600000e+00, -7.500000e+00, -7.400000e+00,
       -7.300000e+00, -7.200000e+00, -7.100000e+00, -7.000000e+00,
       -6.900000e+00, -6.800000e+00, -6.700000e+00, -6.600000e+00,
       -6.500000e+00, -6.400000e+00, -6.300000e+00, -6.200000e+00,
       -6.100000e+00, -6.000000e+00, -5.900000e+00, -5.800000e+00,
       -5.700000e+00, -5.600000e+00, -5.500000e+00, -5.400000e+00,
       -5.300000e+00, -5.200000e+00, -5.100000e+00, -5.000000e+00,
       -4.900000e+00, -4.800000e+00, -4.700000e+00, -4.600000e+00,
       -4.500000e+00, -4.400000e+00, -4.300000e+00, -4.200000e+00,
       -4.100000e+00, -4.000000e+00, -3.900000e+00, -3.800000e+00,
       -3.700000e+00, -3.600000e+00, -3.500000e+00, -3.400000e+00,
       -3.300000e+00, -3.200000e+00, -3.100000e+00, -3.000000e+00,
       -2.900000e+00, -2.800000e+00, -2.700000e+00, -2.600000e+00,
       -2.500000e+00, -2.400000e+00, -2.300000e+00, -2.200000e+00,
       -2.100000e+00, -2.000000e+00, -1.900000e+00, -1.800000e+00,
       -1.700000e+00, -1.600000e+00, -1.500000e+00, -1.400000e+00,
       -1.300000e+00, -1.200000e+00, -1.100000e+00, -1.000000e+00,
       -9.000000e-01, -8.000000e-01, -7.000000e-01, -6.000000e-01,
       -5.000000e-01, -4.000000e-01, -3.000000e-01, -2.000000e-01,
       -1.000000e-01, -1.023182e-11,  1.000000e-01,  2.000000e-01,
        3.000000e-01,  4.000000e-01,  5.000000e-01,  6.000000e-01,
        7.000000e-01,  8.000000e-01,  9.000000e-01,  1.000000e+00,
        1.100000e+00,  1.200000e+00,  1.300000e+00,  1.400000e+00,
        1.500000e+00,  1.600000e+00,  1.700000e+00,  1.800000e+00,
        1.900000e+00,  2.000000e+00,  2.100000e+00,  2.200000e+00,
        2.300000e+00,  2.400000e+00,  2.500000e+00,  2.600000e+00,
        2.700000e+00,  2.800000e+00,  2.900000e+00,  3.000000e+00,
        3.100000e+00,  3.200000e+00,  3.300000e+00,  3.400000e+00,
        3.500000e+00,  3.600000e+00,  3.700000e+00,  3.800000e+00,
        3.900000e+00,  4.000000e+00,  4.100000e+00,  4.200000e+00,
        4.300000e+00,  4.400000e+00,  4.500000e+00,  4.600000e+00,
        4.700000e+00,  4.800000e+00,  4.900000e+00,  5.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-d3f5a40e-69f4-4420-91a3-1987f118feb2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d3f5a40e-69f4-4420-91a3-1987f118feb2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94d45c66-16f4-4e07-bcfd-9839fcf40a8f' class='xr-var-data-in' type='checkbox'><label for='data-94d45c66-16f4-4e07-bcfd-9839fcf40a8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-9c38e822-f55e-4afe-a2b2-0186a276c318' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c38e822-f55e-4afe-a2b2-0186a276c318' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-278df9b6-daa2-476d-b1ef-5fac81e59eb6' class='xr-var-data-in' type='checkbox'><label for='data-278df9b6-daa2-476d-b1ef-5fac81e59eb6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ea755329-265f-4d4e-9c39-24ec9dc6cb5a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ea755329-265f-4d4e-9c39-24ec9dc6cb5a' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-f8922d6a-acfe-45f1-a6e0-1b22a441d402' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f8922d6a-acfe-45f1-a6e0-1b22a441d402' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1d5dbd9-40e5-423f-9a4d-16e3c412a6fb' class='xr-var-data-in' type='checkbox'><label for='data-c1d5dbd9-40e5-423f-9a4d-16e3c412a6fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Minimum air temperature at 2 meter (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Min 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;</div><input id='attrs-0e62997a-bb9f-4854-998b-94173c591090' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e62997a-bb9f-4854-998b-94173c591090' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0dddb6f1-0158-4714-a4ff-be7bbefdc7e2' class='xr-var-data-in' type='checkbox'><label for='data-0dddb6f1-0158-4714-a4ff-be7bbefdc7e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>long_name :</span></dt><dd>Coordinate reference system</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.13 kiB </td>
                        <td> 2.13 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273,) </td>
                        <td> (273,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >273</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-66a19746-240f-4f62-a4b3-5495b54a57c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-66a19746-240f-4f62-a4b3-5495b54a57c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b41804c2-e686-4fe9-a953-3839813a51b0' class='xr-var-data-in' type='checkbox'><label for='data-b41804c2-e686-4fe9-a953-3839813a51b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Maximum air temperature at 2 meter (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Max 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-326300f7-85f9-4c52-b5da-195f94a34a29' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-326300f7-85f9-4c52-b5da-195f94a34a29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aab0e4ac-7394-4112-983d-2c823ee56b99' class='xr-var-data-in' type='checkbox'><label for='data-aab0e4ac-7394-4112-983d-2c823ee56b99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>2 meter air temperature (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-5132795a-65f4-45fd-85e8-1a3d526fe228' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5132795a-65f4-45fd-85e8-1a3d526fe228' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88390a3b-53be-4228-98e0-35887d6ea4ea' class='xr-var-data-in' type='checkbox'><label for='data-88390a3b-53be-4228-98e0-35887d6ea4ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>J m-2 d-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Surface solar radiation downwards (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-c139ec57-8751-4596-bbf3-3da627b95fcc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c139ec57-8751-4596-bbf3-3da627b95fcc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba7977d1-5529-4c43-b675-43b8b70aee19' class='xr-var-data-in' type='checkbox'><label for='data-ba7977d1-5529-4c43-b675-43b8b70aee19' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm d-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Total precipitation (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_10m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d0058717-f6c8-45f1-a5bc-626962cf9cdc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d0058717-f6c8-45f1-a5bc-626962cf9cdc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae7ce8cb-1c8f-4cd5-a3d5-62335eb5a32a' class='xr-var-data-in' type='checkbox'><label for='data-ae7ce8cb-1c8f-4cd5-a3d5-62335eb5a32a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>10 metre wind component (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-33a820a1-03ff-4346-8b91-c789dd41b228' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33a820a1-03ff-4346-8b91-c789dd41b228' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9105a938-af83-4718-a289-dbbc4416eaee' class='xr-var-data-in' type='checkbox'><label for='data-9105a938-af83-4718-a289-dbbc4416eaee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>cm</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Snow depth (00-00LT)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-836e39a1-c1d0-4185-addc-30bb826f978c' class='xr-section-summary-in' type='checkbox'  ><label for='section-836e39a1-c1d0-4185-addc-30bb826f978c' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7aca9f3c-80df-4c0c-82c5-a343db9c2db7' class='xr-index-data-in' type='checkbox'/><label for='index-7aca9f3c-80df-4c0c-82c5-a343db9c2db7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.900000000009499, -12.800000000009504,  -12.70000000000951,
       -12.600000000009516, -12.500000000009521, -12.400000000009527,
       -12.300000000009533, -12.200000000009538, -12.100000000009544,
        -12.00000000000955,
       ...
         4.099999999989535,   4.199999999989529,   4.299999999989524,
         4.399999999989518,   4.499999999989512,   4.599999999989507,
         4.699999999989501,   4.799999999989495,    4.89999999998949,
         4.999999999989484],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e0a44ba0-7b49-402c-9319-d7428a67447f' class='xr-index-data-in' type='checkbox'/><label for='index-e0a44ba0-7b49-402c-9319-d7428a67447f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.900000000001654,  60.80000000000166, 60.700000000001666,
        60.60000000000167,  60.50000000000168,  60.40000000000168,
        60.30000000000169, 60.200000000001694,   60.1000000000017,
       60.000000000001705,
       ...
       48.900000000002336,  48.80000000000234,  48.70000000000235,
        48.60000000000235,  48.50000000000236, 48.400000000002365,
        48.30000000000237, 48.200000000002376,  48.10000000000238,
        48.00000000000239],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ed90d209-416e-49b9-ade9-3a1009c91f99' class='xr-index-data-in' type='checkbox'/><label for='index-ed90d209-416e-49b9-ade9-3a1009c91f99' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-135a308e-5d41-49be-b726-e81b3583ea32' class='xr-section-summary-in' type='checkbox'  checked><label for='section-135a308e-5d41-49be-b726-e81b3583ea32' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>title :</span></dt><dd>AgERA5 daily weather variables derived from the ECMWF ERA5 reanalysis.</dd><dt><span>institution :</span></dt><dd>Wageningen Environmental Research</dd><dt><span>history :</span></dt><dd>Generated by `pragera5 run_daily_processing 2023-01-01` version 1.2.0, executed on 2025-03-07 12:00:44.087250</dd><dt><span>references :</span></dt><dd>https://doi.org/10.24381/cds.6c68c9bb</dd><dt><span>source :</span></dt><dd>ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</dd></dl></div></li></ul></div></div></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
/home/o/git/c3s2-eqc-quality-assessment/.venv/lib/python3.12/site-packages/dask/_task_spec.py:759: RuntimeWarning: invalid value encountered in divide
  return self.func(*new_argspec)
</pre></div>
</div>
</div>
</div>
</section>
<section id="era5-land">
<h4>ERA5-Land<a class="headerlink" href="#era5-land" title="Link to this heading">#</a></h4>
<p>The process to download data from ERA5-Land is similar to that for AgERA5 above:
defining a template and variable-specific requests.
A difference is that data will be downloaded from two CDS datasets.
The <a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank"><em>ERA5-Land hourly data from 1950 to present</em></a> dataset contains hourly data for variables like 2m temperature as well as accumulated data for variables like solar irradiation.
For the use case in this assessment, we are only interested in the daily accumulated data.
<a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank"><em>ERA5-Land post-processed daily statistics from 1950 to present</em></a> provides daily minimum/maximum/mean statistics for the hourly variables, saving us the effort of aggregating these ourselves.
In the following subsections, the data (accumulated and daily statistics) are downloaded and harmonised to the same format as AgERA5.</p>
<section id="accumulated-data-from-era5-land">
<h5>Accumulated data from ERA5-Land<a class="headerlink" href="#accumulated-data-from-era5-land" title="Link to this heading">#</a></h5>
<p>The <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5-Land%3A+data+documentation#heading-Accumulations" rel="noreferrer" target="_blank">documentation for ERA5-Land</a> explains:</p>
<blockquote>
<div><p>The accumulations in the short forecasts of ERA5-Land (with hourly steps from 01 to 24) are treated the same as those in ERA-Interim or ERA-Interim/Land, i.e., they are accumulated from the beginning of the forecast to the end of the forecast step. For example, runoff at day=D, step=12 will provide runoff accumulated from day=D, time=0 to day=D, time=12. The maximum accumulation is over 24 hours, i.e., from day=D, time=0 to day=D+1,time=0 (step=24). For the CDS time, or validity time, of 00 UTC, the accumulations are over the 24 hours ending at 00 UTC i.e. the accumulation is during the previous day.</p>
</div></blockquote>
<p>In practice, this means that one needs to download data for <em>day+1</em> (e.g. 2 January 2023) to get the total accumulated value for <em>day</em> (1 January 2023).
Hence, for this specific dataset, our existing <code class="docutils literal notranslate"><span class="pre">request_time</span></code> will download data for 2022-12-31 ‚Äì 2023-09-29, so we need to add one extra day.
This is achieved by adding a second request for just the extra day to the earthkit-data download.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era5land_ID</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land&quot;</span>

<span class="c1"># Default parameters</span>
<span class="n">request_era5land_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>  <span class="c1"># Downloading in NetCDF changes the time format, causing a 1-day offset</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;unarchived&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default</span><span class="p">)</span>

<span class="c1"># Additional day (accounting for accumulated format)</span>
<span class="n">request_extraday</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">months</span><span class="o">.</span><span class="n">stop</span><span class="p">),</span>  <span class="c1"># If months was range(1, 10), it downloaded 1,2,3,4,5,6,7,8,9 and this adds 10</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request_era5land_default_extraday</span> <span class="o">=</span> <span class="n">request_era5land_default</span> <span class="o">|</span> <span class="n">request_extraday</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Extra-day request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default_extraday</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for reanalysis-era5-land:
{&#39;time&#39;: [&#39;00:00&#39;],
 &#39;data_format&#39;: &#39;grib&#39;,
 &#39;download_format&#39;: &#39;unarchived&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}

Extra-day request template for reanalysis-era5-land:
{&#39;time&#39;: [&#39;00:00&#39;],
 &#39;data_format&#39;: &#39;grib&#39;,
 &#39;download_format&#39;: &#39;unarchived&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: &#39;10&#39;,
 &#39;day&#39;: &#39;01&#39;}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_irradation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;surface_solar_radiation_downwards&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_rain</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;total_precipitation&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests_era5land_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_irradation</span><span class="p">,</span>
                               <span class="n">request_rain</span><span class="p">,</span>
                              <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_era5land</span>          <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default</span>          <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>
<span class="n">requests_era5land_extraday</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default_extraday</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>

<span class="c1"># Download data and convert to desired format</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">era5land_ID</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_era5land</span><span class="p">,</span> <span class="o">*</span><span class="n">requests_era5land_extraday</span><span class="p">)</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00&lt;00:00, 141.05it/s]
</pre></div>
</div>
</div>
</div>
<p>Inspecting the resulting dataset
(in Xarray format)
shows that the <code class="docutils literal notranslate"><span class="pre">forecast_reference_time</span></code> coordinate conveniently matches the variable to the day of accumulation.
It is important to note that this is <em>not</em> true if the data are downloaded in NetCDF format,
in which case there is a 1-day offset;
beware of this difference if modifying this notebook yourself.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_era5land_accumulated</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 104MB
Dimensions:                  (forecast_reference_time: 274, latitude: 131,
                              longitude: 181)
Coordinates:
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 2kB 202...
  * latitude                 (latitude) float64 1kB 61.0 60.9 60.8 ... 48.1 48.0
  * longitude                (longitude) float64 1kB -13.0 -12.9 ... 4.9 5.0
Data variables:
    ssrd                     (forecast_reference_time, latitude, longitude) float64 52MB ...
    tp                       (forecast_reference_time, latitude, longitude) float64 52MB ...
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ad84b05b-fb61-4b01-a16f-c415926a0d5b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ad84b05b-fb61-4b01-a16f-c415926a0d5b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>forecast_reference_time</span>: 274</li><li><span class='xr-has-index'>latitude</span>: 131</li><li><span class='xr-has-index'>longitude</span>: 181</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-56392edf-9d1d-4f95-ac9b-20810ee47227' class='xr-section-summary-in' type='checkbox'  checked><label for='section-56392edf-9d1d-4f95-ac9b-20810ee47227' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>forecast_reference_time</span></div><div class='xr-var-dims'>(forecast_reference_time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-12-31 ... 2023-09-30</div><input id='attrs-5e196f11-817d-451c-8088-4789fdc8317e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e196f11-817d-451c-8088-4789fdc8317e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb8cf803-5989-44c9-a629-e2fcc0a8e609' class='xr-var-data-in' type='checkbox'><label for='data-eb8cf803-5989-44c9-a629-e2fcc0a8e609' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-12-31T00:00:00.000000000&#x27;, &#x27;2023-01-01T00:00:00.000000000&#x27;,
       &#x27;2023-01-02T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(274,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>61.0 60.9 60.8 ... 48.2 48.1 48.0</div><input id='attrs-e5a72ae7-0d7a-435e-8439-a9dfe26ac2d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5a72ae7-0d7a-435e-8439-a9dfe26ac2d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d19dbb0d-ca5c-4113-abac-a1c90588545e' class='xr-var-data-in' type='checkbox'><label for='data-d19dbb0d-ca5c-4113-abac-a1c90588545e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([61. , 60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9,
       59.8, 59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7,
       58.6, 58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5,
       57.4, 57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3,
       56.2, 56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1,
       55. , 54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9,
       53.8, 53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7,
       52.6, 52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5,
       51.4, 51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3,
       50.2, 50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1,
       49. , 48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-13.0 -12.9 -12.8 ... 4.8 4.9 5.0</div><input id='attrs-4f8bb628-f4c2-4913-83c6-470e2ad86680' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f8bb628-f4c2-4913-83c6-470e2ad86680' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7081b17-28ea-40be-864b-b0ea7d6662b3' class='xr-var-data-in' type='checkbox'><label for='data-a7081b17-28ea-40be-864b-b0ea7d6662b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-1.300000e+01, -1.290000e+01, -1.280000e+01, -1.270000e+01,
       -1.260000e+01, -1.250000e+01, -1.240000e+01, -1.230000e+01,
       -1.220000e+01, -1.210000e+01, -1.200000e+01, -1.190000e+01,
       -1.180000e+01, -1.170000e+01, -1.160000e+01, -1.150000e+01,
       -1.140000e+01, -1.130000e+01, -1.120000e+01, -1.110000e+01,
       -1.100000e+01, -1.090000e+01, -1.080000e+01, -1.070000e+01,
       -1.060000e+01, -1.050000e+01, -1.040000e+01, -1.030000e+01,
       -1.020000e+01, -1.010000e+01, -1.000000e+01, -9.900000e+00,
       -9.800000e+00, -9.700000e+00, -9.600000e+00, -9.500000e+00,
       -9.400000e+00, -9.300000e+00, -9.200000e+00, -9.100000e+00,
       -9.000000e+00, -8.900000e+00, -8.800000e+00, -8.700000e+00,
       -8.600000e+00, -8.500000e+00, -8.400000e+00, -8.300000e+00,
       -8.200000e+00, -8.100000e+00, -8.000000e+00, -7.900000e+00,
       -7.800000e+00, -7.700000e+00, -7.600000e+00, -7.500000e+00,
       -7.400000e+00, -7.300000e+00, -7.200000e+00, -7.100000e+00,
       -7.000000e+00, -6.900000e+00, -6.800000e+00, -6.700000e+00,
       -6.600000e+00, -6.500000e+00, -6.400000e+00, -6.300000e+00,
       -6.200000e+00, -6.100000e+00, -6.000000e+00, -5.900000e+00,
       -5.800000e+00, -5.700000e+00, -5.600000e+00, -5.500000e+00,
       -5.400000e+00, -5.300000e+00, -5.200000e+00, -5.100000e+00,
       -5.000000e+00, -4.900000e+00, -4.800000e+00, -4.700000e+00,
       -4.600000e+00, -4.500000e+00, -4.400000e+00, -4.300000e+00,
       -4.200000e+00, -4.100000e+00, -4.000000e+00, -3.900000e+00,
       -3.800000e+00, -3.700000e+00, -3.600000e+00, -3.500000e+00,
       -3.400000e+00, -3.300000e+00, -3.200000e+00, -3.100000e+00,
       -3.000000e+00, -2.900000e+00, -2.800000e+00, -2.700000e+00,
       -2.600000e+00, -2.500000e+00, -2.400000e+00, -2.300000e+00,
       -2.200000e+00, -2.100000e+00, -2.000000e+00, -1.900000e+00,
       -1.800000e+00, -1.700000e+00, -1.600000e+00, -1.500000e+00,
       -1.400000e+00, -1.300000e+00, -1.200000e+00, -1.100000e+00,
       -1.000000e+00, -9.000000e-01, -8.000000e-01, -7.000000e-01,
       -6.000000e-01, -5.000000e-01, -4.000000e-01, -3.000000e-01,
       -2.000000e-01, -1.000000e-01, -2.944867e-14,  1.000000e-01,
        2.000000e-01,  3.000000e-01,  4.000000e-01,  5.000000e-01,
        6.000000e-01,  7.000000e-01,  8.000000e-01,  9.000000e-01,
        1.000000e+00,  1.100000e+00,  1.200000e+00,  1.300000e+00,
        1.400000e+00,  1.500000e+00,  1.600000e+00,  1.700000e+00,
        1.800000e+00,  1.900000e+00,  2.000000e+00,  2.100000e+00,
        2.200000e+00,  2.300000e+00,  2.400000e+00,  2.500000e+00,
        2.600000e+00,  2.700000e+00,  2.800000e+00,  2.900000e+00,
        3.000000e+00,  3.100000e+00,  3.200000e+00,  3.300000e+00,
        3.400000e+00,  3.500000e+00,  3.600000e+00,  3.700000e+00,
        3.800000e+00,  3.900000e+00,  4.000000e+00,  4.100000e+00,
        4.200000e+00,  4.300000e+00,  4.400000e+00,  4.500000e+00,
        4.600000e+00,  4.700000e+00,  4.800000e+00,  4.900000e+00,
        5.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af669d86-3eb5-48dd-8a33-d36f6bd7941d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-af669d86-3eb5-48dd-8a33-d36f6bd7941d' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ssrd</span></div><div class='xr-var-dims'>(forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-14bcd4f3-161f-4dc5-a677-544d55cd8522' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-14bcd4f3-161f-4dc5-a677-544d55cd8522' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c756435-30d7-49a0-85bd-2840ac2d61c8' class='xr-var-data-in' type='checkbox'><label for='data-0c756435-30d7-49a0-85bd-2840ac2d61c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface short-wave (solar) radiation downwards</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>J m**-2</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><pre>[6496814 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(forecast_reference_time, latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cae0cca5-d0bc-43e6-8357-34defd653013' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cae0cca5-d0bc-43e6-8357-34defd653013' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7eef21be-6931-4ea7-8e21-bea5ac0129ab' class='xr-var-data-in' type='checkbox'><label for='data-7eef21be-6931-4ea7-8e21-bea5ac0129ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><pre>[6496814 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f91b7118-15e3-4df3-8da3-1e524ae3e59e' class='xr-section-summary-in' type='checkbox'  ><label for='section-f91b7118-15e3-4df3-8da3-1e524ae3e59e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>forecast_reference_time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-968a1aed-3c37-424e-9401-4e9c8ff76d72' class='xr-index-data-in' type='checkbox'/><label for='index-968a1aed-3c37-424e-9401-4e9c8ff76d72' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-12-31&#x27;, &#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;,
               &#x27;2023-01-04&#x27;, &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;,
               &#x27;2023-01-08&#x27;, &#x27;2023-01-09&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;forecast_reference_time&#x27;, length=274, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-331b770d-606e-4dec-a6ef-e7d45b98215b' class='xr-index-data-in' type='checkbox'/><label for='index-331b770d-606e-4dec-a6ef-e7d45b98215b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              61.0,               60.9,               60.8,
       60.699999999999996, 60.599999999999994,  60.49999999999999,
        60.39999999999999,  60.29999999999999,  60.19999999999999,
        60.09999999999999,
       ...
        48.89999999999983,  48.79999999999983, 48.699999999999825,
       48.599999999999824,  48.49999999999982,  48.39999999999982,
        48.29999999999982,  48.19999999999982,  48.09999999999982,
                     48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=131))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5e3e6520-3d82-4da3-8042-319ad82d00df' class='xr-index-data-in' type='checkbox'/><label for='index-5e3e6520-3d82-4da3-8042-319ad82d00df' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -13.0,               -12.9,               -12.8,
       -12.700000000000001, -12.600000000000001, -12.500000000000002,
       -12.400000000000002, -12.300000000000002, -12.200000000000003,
       -12.100000000000003,
       ...
         4.099999999999973,   4.199999999999973,   4.299999999999972,
         4.399999999999972,   4.499999999999972,   4.599999999999971,
         4.699999999999971,  4.7999999999999705,    4.89999999999997,
                       5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=181))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fd0bcf3c-7661-45d6-b5fe-d4e37adc24ea' class='xr-section-summary-in' type='checkbox'  ><label for='section-fd0bcf3c-7661-45d6-b5fe-d4e37adc24ea' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="daily-statistics-from-the-post-processed-era5-land-dataset">
<h5>Daily statistics from the post-processed ERA5-Land dataset<a class="headerlink" href="#daily-statistics-from-the-post-processed-era5-land-dataset" title="Link to this heading">#</a></h5>
<p>The daily statistics are indexed according to the day they apply to, meaning we do not need to worry about adding extra days here.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era5land_ID</span> <span class="o">=</span> <span class="s2">&quot;derived-era5-land-daily-statistics&quot;</span>

<span class="n">request_era5land_default</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;utc+00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="s2">&quot;1_hourly&quot;</span><span class="p">,</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_default</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Request template for </span><span class="si">{</span><span class="n">era5land_ID</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="n">print_request</span><span class="p">(</span><span class="n">request_era5land_default</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Request template for derived-era5-land-daily-statistics:
{&#39;time_zone&#39;: &#39;utc+00:00&#39;,
 &#39;frequency&#39;: &#39;1_hourly&#39;,
 &#39;area&#39;: [61, -13, 48, 5],
 &#39;year&#39;: 2023,
 &#39;month&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;],
 &#39;day&#39;: [&#39;01&#39;, &#39;02&#39;, &#39;03&#39;, &#39;04&#39;, &#39;05&#39;, &#39;06&#39;, &#39;07&#39;, &#39;08&#39;, &#39;09&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;,
         &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;,
         &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;]}
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, the individual data variables are defined:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temperature has to be split into separate requests because of size limits</span>
<span class="n">request_temperature_min</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_minimum&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">request_temperature_max</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_maximum&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_temperature_mean</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Wind is downloaded as two separate components</span>
<span class="n">request_wind_u</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_u_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_wind_v</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;10m_v_component_of_wind&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">request_snow</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;snow_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;daily_mean&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests_era5land_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_temperature_min</span><span class="p">,</span> <span class="n">request_temperature_max</span><span class="p">,</span> <span class="n">request_temperature_mean</span><span class="p">,</span>
                               <span class="n">request_wind_u</span><span class="p">,</span> <span class="n">request_wind_v</span><span class="p">,</span>
                               <span class="n">request_snow</span><span class="p">,</span>
                              <span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The requests for specific variables are combined with the template and passed to earthkit for download from the CDS.
Here, we download the different variables separately in anticipation of the harmonisation step in the next subsection.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final setup for requests: mix template and variable-specific parameters</span>
<span class="n">requests_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">request_era5land_default</span> <span class="o">|</span> <span class="n">request</span> <span class="k">for</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests_era5land_variables</span><span class="p">]</span>

<span class="c1"># Download data and convert to desired format</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">era5land_ID</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span> <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests_era5land</span><span class="p">]</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">data_era5land</span><span class="p">]</span>
<span class="n">data_era5land_temperature_min</span><span class="p">,</span> <span class="n">data_era5land_temperature_max</span><span class="p">,</span> <span class="n">data_era5land_temperature_mean</span><span class="p">,</span> <span class="n">data_era5land_wind_u</span><span class="p">,</span> <span class="n">data_era5land_wind_v</span><span class="p">,</span> <span class="n">data_era5land_snow</span> <span class="o">=</span> <span class="n">data_era5land</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="pre-processing">
<h5>Pre-processing<a class="headerlink" href="#pre-processing" title="Link to this heading">#</a></h5>
<p>The ERA5-Land dataset is set up differently from AgERA5 and requires some pre-processing before the two can be intercompared.
This involves renaming coordinates and variables, and adjusting units.</p>
<p>For the accumulated data, the following steps are necessary:</p>
<ul class="simple">
<li><p>Rename the variables and coordinates to match those in AgERA5.</p></li>
<li><p>Select data within the desired time window only.</p></li>
<li><p>Convert the units for precipitation to mm.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename variables and coordinates</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ssrd&quot;</span><span class="p">:</span> <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">,</span>
                                                              <span class="s2">&quot;tp&quot;</span><span class="p">:</span> <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">,</span>
                                                              <span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> 
                                                              <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">})</span>
<span class="c1"># Select only relevant dates</span>
<span class="n">time_window</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">months</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">months</span><span class="o">.</span><span class="n">stop</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">)</span>  <span class="c1"># [2023-01-01, 2023-10-01) == [2023-01-01, 2023-09-30]</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">data_era5land_accumulated</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_window</span><span class="p">)</span>

<span class="c1"># Unit conversions</span>
<span class="n">convert_m2mm</span><span class="p">(</span><span class="n">data_era5land_accumulated</span><span class="p">,</span> <span class="s2">&quot;Precipitation_Flux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For the daily statistics, the steps are as follows:</p>
<ul class="simple">
<li><p>Rename the temperature variables from just <code class="docutils literal notranslate"><span class="pre">t2m</span></code> to maximum, mean, minimum.</p></li>
<li><p>Calculate 10 m wind speed from its U (east‚Äìwest) and V (north‚Äìsouth) components.</p></li>
<li><p>Rename the snow variable and convert its units to cm.</p></li>
<li><p>Combine the pre-processed variables into one dataset.</p></li>
<li><p>Rename coordinates to match AgERA5‚Äôs.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename and combine temperature variables</span>
<span class="n">data_era5land_temperature_max</span>  <span class="o">=</span> <span class="n">data_era5land_temperature_max</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="p">{</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Max_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature_mean</span> <span class="o">=</span> <span class="n">data_era5land_temperature_mean</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Mean_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature_min</span>  <span class="o">=</span> <span class="n">data_era5land_temperature_min</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span> <span class="p">{</span><span class="s2">&quot;t2m&quot;</span><span class="p">:</span> <span class="s2">&quot;Temperature_Air_2m_Min_24h&quot;</span><span class="p">})</span>
<span class="n">data_era5land_temperature</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_temperature_min</span><span class="p">,</span> <span class="n">data_era5land_temperature_max</span><span class="p">,</span> <span class="n">data_era5land_temperature_mean</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>

<span class="c1"># Calculate 10 m wind speed</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_wind_u</span><span class="p">,</span> <span class="n">data_era5land_wind_v</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">data_era5land_wind</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;Wind_Speed_10m_Mean_24h&quot;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data_era5land_wind</span><span class="p">[</span><span class="s2">&quot;u10&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">data_era5land_wind</span><span class="p">[</span><span class="s2">&quot;v10&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)}</span>
<span class="p">)</span>
<span class="n">data_era5land_wind</span> <span class="o">=</span> <span class="n">data_era5land_wind</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;u10&quot;</span><span class="p">,</span> <span class="s2">&quot;v10&quot;</span><span class="p">])</span>

<span class="c1"># Rename snow and convert its units</span>
<span class="n">data_era5land_snow</span> <span class="o">=</span> <span class="n">data_era5land_snow</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;sde&quot;</span><span class="p">:</span> <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">})</span>
<span class="n">convert_m2cm</span><span class="p">(</span><span class="n">data_era5land_snow</span><span class="p">,</span> <span class="s2">&quot;Snow_Thickness_Mean_24h&quot;</span><span class="p">)</span>

<span class="c1"># Combine into one dataset</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_temperature</span><span class="p">,</span> <span class="n">data_era5land_wind</span><span class="p">,</span> <span class="n">data_era5land_snow</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>

<span class="c1"># Rename coordinates</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">data_era5land</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;valid_time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">})</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">data_era5land</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>  <span class="c1"># Remove unneeded dimension</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Lastly, the accumulated data and daily statistics are combined into one xarray object:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert both to (same) Dask</span>
<span class="n">data_era5land_accumulated</span> <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_era5land_accumulated</span><span class="p">)</span>
<span class="n">data_era5land</span>             <span class="o">=</span> <span class="n">rechunk</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>

<span class="c1"># Combine and display</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">data_era5land_accumulated</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>
<span class="n">data_era5land</span>  <span class="c1"># Display in notebook</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 233MB
Dimensions:                      (time: 273, lat: 131, lon: 181)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 61.0 60.9 60.8 ... 48.1 48.0
  * lon                          (lon) float64 1kB -13.0 -12.9 -12.8 ... 4.9 5.0
Data variables:
    Solar_Radiation_Flux         (time, lat, lon) float64 52MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float64 52MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Wind_Speed_10m_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d87052c3-5e83-4aad-8490-e1aa99eb956a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d87052c3-5e83-4aad-8490-e1aa99eb956a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 131</li><li><span class='xr-has-index'>lon</span>: 181</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e98890c9-880e-4c26-ae9f-3479547c17ce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e98890c9-880e-4c26-ae9f-3479547c17ce' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-d9416ba3-3ba0-461f-8d65-41d39e58172b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9416ba3-3ba0-461f-8d65-41d39e58172b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd4d03ea-c8cd-43a4-a344-52cede8e8886' class='xr-var-data-in' type='checkbox'><label for='data-cd4d03ea-c8cd-43a4-a344-52cede8e8886' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>61.0 60.9 60.8 ... 48.2 48.1 48.0</div><input id='attrs-6c51c467-c57e-45d6-ab37-643cd9458d44' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c51c467-c57e-45d6-ab37-643cd9458d44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10ba88d8-11b1-4f73-b9d0-9c1e259f0de9' class='xr-var-data-in' type='checkbox'><label for='data-10ba88d8-11b1-4f73-b9d0-9c1e259f0de9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([61. , 60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9,
       59.8, 59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7,
       58.6, 58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5,
       57.4, 57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3,
       56.2, 56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1,
       55. , 54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9,
       53.8, 53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7,
       52.6, 52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5,
       51.4, 51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3,
       50.2, 50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1,
       49. , 48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-13.0 -12.9 -12.8 ... 4.8 4.9 5.0</div><input id='attrs-2bc4dae9-c55b-41aa-bbc1-9d1d531761fd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2bc4dae9-c55b-41aa-bbc1-9d1d531761fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dffc5c16-d12a-4599-89fd-db950c660ee9' class='xr-var-data-in' type='checkbox'><label for='data-dffc5c16-d12a-4599-89fd-db950c660ee9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-1.300000e+01, -1.290000e+01, -1.280000e+01, -1.270000e+01,
       -1.260000e+01, -1.250000e+01, -1.240000e+01, -1.230000e+01,
       -1.220000e+01, -1.210000e+01, -1.200000e+01, -1.190000e+01,
       -1.180000e+01, -1.170000e+01, -1.160000e+01, -1.150000e+01,
       -1.140000e+01, -1.130000e+01, -1.120000e+01, -1.110000e+01,
       -1.100000e+01, -1.090000e+01, -1.080000e+01, -1.070000e+01,
       -1.060000e+01, -1.050000e+01, -1.040000e+01, -1.030000e+01,
       -1.020000e+01, -1.010000e+01, -1.000000e+01, -9.900000e+00,
       -9.800000e+00, -9.700000e+00, -9.600000e+00, -9.500000e+00,
       -9.400000e+00, -9.300000e+00, -9.200000e+00, -9.100000e+00,
       -9.000000e+00, -8.900000e+00, -8.800000e+00, -8.700000e+00,
       -8.600000e+00, -8.500000e+00, -8.400000e+00, -8.300000e+00,
       -8.200000e+00, -8.100000e+00, -8.000000e+00, -7.900000e+00,
       -7.800000e+00, -7.700000e+00, -7.600000e+00, -7.500000e+00,
       -7.400000e+00, -7.300000e+00, -7.200000e+00, -7.100000e+00,
       -7.000000e+00, -6.900000e+00, -6.800000e+00, -6.700000e+00,
       -6.600000e+00, -6.500000e+00, -6.400000e+00, -6.300000e+00,
       -6.200000e+00, -6.100000e+00, -6.000000e+00, -5.900000e+00,
       -5.800000e+00, -5.700000e+00, -5.600000e+00, -5.500000e+00,
       -5.400000e+00, -5.300000e+00, -5.200000e+00, -5.100000e+00,
       -5.000000e+00, -4.900000e+00, -4.800000e+00, -4.700000e+00,
       -4.600000e+00, -4.500000e+00, -4.400000e+00, -4.300000e+00,
       -4.200000e+00, -4.100000e+00, -4.000000e+00, -3.900000e+00,
       -3.800000e+00, -3.700000e+00, -3.600000e+00, -3.500000e+00,
       -3.400000e+00, -3.300000e+00, -3.200000e+00, -3.100000e+00,
       -3.000000e+00, -2.900000e+00, -2.800000e+00, -2.700000e+00,
       -2.600000e+00, -2.500000e+00, -2.400000e+00, -2.300000e+00,
       -2.200000e+00, -2.100000e+00, -2.000000e+00, -1.900000e+00,
       -1.800000e+00, -1.700000e+00, -1.600000e+00, -1.500000e+00,
       -1.400000e+00, -1.300000e+00, -1.200000e+00, -1.100000e+00,
       -1.000000e+00, -9.000000e-01, -8.000000e-01, -7.000000e-01,
       -6.000000e-01, -5.000000e-01, -4.000000e-01, -3.000000e-01,
       -2.000000e-01, -1.000000e-01, -2.944867e-14,  1.000000e-01,
        2.000000e-01,  3.000000e-01,  4.000000e-01,  5.000000e-01,
        6.000000e-01,  7.000000e-01,  8.000000e-01,  9.000000e-01,
        1.000000e+00,  1.100000e+00,  1.200000e+00,  1.300000e+00,
        1.400000e+00,  1.500000e+00,  1.600000e+00,  1.700000e+00,
        1.800000e+00,  1.900000e+00,  2.000000e+00,  2.100000e+00,
        2.200000e+00,  2.300000e+00,  2.400000e+00,  2.500000e+00,
        2.600000e+00,  2.700000e+00,  2.800000e+00,  2.900000e+00,
        3.000000e+00,  3.100000e+00,  3.200000e+00,  3.300000e+00,
        3.400000e+00,  3.500000e+00,  3.600000e+00,  3.700000e+00,
        3.800000e+00,  3.900000e+00,  4.000000e+00,  4.100000e+00,
        4.200000e+00,  4.300000e+00,  4.400000e+00,  4.500000e+00,
        4.600000e+00,  4.700000e+00,  4.800000e+00,  4.900000e+00,
        5.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eb428cc5-a1df-4f75-9a96-873ba0d504f7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-eb428cc5-a1df-4f75-9a96-873ba0d504f7' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-ec2cc0db-10d4-4a19-87a1-beed23458314' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec2cc0db-10d4-4a19-87a1-beed23458314' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a64643ac-ffd1-4880-8efa-776827b633ba' class='xr-var-data-in' type='checkbox'><label for='data-a64643ac-ffd1-4880-8efa-776827b633ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Surface short-wave (solar) radiation downwards</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>J m**-2</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 49.39 MiB </td>
                        <td> 49.39 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-b7c2e0de-317e-4a1b-b612-6666167e8405' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b7c2e0de-317e-4a1b-b612-6666167e8405' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-674a8056-f412-480b-a875-f990b724a0a5' class='xr-var-data-in' type='checkbox'><label for='data-674a8056-f412-480b-a875-f990b724a0a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 49.39 MiB </td>
                        <td> 49.39 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-af9951a7-a1c6-47f3-9401-2ec9c4e34cac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-af9951a7-a1c6-47f3-9401-2ec9c4e34cac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aab0f458-1362-4305-b1ad-406cb6ef4553' class='xr-var-data-in' type='checkbox'><label for='data-aab0f458-1362-4305-b1ad-406cb6ef4553' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-de56a770-04e0-43fc-9a83-141ff33ce8be' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de56a770-04e0-43fc-9a83-141ff33ce8be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47da6ec1-6fc9-4814-bb39-5c44270d4ee7' class='xr-var-data-in' type='checkbox'><label for='data-47da6ec1-6fc9-4814-bb39-5c44270d4ee7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-b4ced482-7314-48dd-a887-dbc9ce821aae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b4ced482-7314-48dd-a887-dbc9ce821aae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6f6f69f-01d7-487b-9d1d-142c0e7af0bc' class='xr-var-data-in' type='checkbox'><label for='data-c6f6f69f-01d7-487b-9d1d-142c0e7af0bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>2 metre temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_10m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-62bca8e1-5ff3-4f80-9d33-b015d57cb16e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62bca8e1-5ff3-4f80-9d33-b015d57cb16e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-462a11fb-e4fe-4d1d-b4a0-9aab0b5edb5b' class='xr-var-data-in' type='checkbox'><label for='data-462a11fb-e4fe-4d1d-b4a0-9aab0b5edb5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 9 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 131, 181), meta=np.ndarray&gt;</div><input id='attrs-bfde8138-81e8-4c87-988c-a13766ee753d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bfde8138-81e8-4c87-988c-a13766ee753d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80b6fe07-4075-429b-9259-dcee1a2e92a7' class='xr-var-data-in' type='checkbox'><label for='data-80b6fe07-4075-429b-9259-dcee1a2e92a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>3066</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sde</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>347.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Snow depth</dd><dt><span>GRIB_shortName :</span></dt><dd>sde</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.69 MiB </td>
                        <td> 24.69 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 131, 181) </td>
                        <td> (273, 131, 181) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 4 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="210" height="178" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,128.17065287653526 10.0,57.58241758241759" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="160" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.56043956043956,0.0 160.1486748545572,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="160" y2="70" style="stroke-width:2" />
  <line x1="80" y1="128" x2="160" y2="128" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="128" style="stroke-width:2" />
  <line x1="160" y1="70" x2="160" y2="128" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 160.1486748545572,70.58823529411765 160.1486748545572,128.17065287653526 80.58823529411765,128.17065287653526" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.368455" y="148.170653" font-size="1.0rem" font-weight="100" text-anchor="middle" >181</text>
  <text x="180.148675" y="99.379444" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,180.148675,99.379444)">131</text>
  <text x="35.294118" y="112.876535" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.876535)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-c91d7798-c40b-49d1-95e3-bda6dc28c591' class='xr-section-summary-in' type='checkbox'  ><label for='section-c91d7798-c40b-49d1-95e3-bda6dc28c591' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f9697344-c021-4ce7-9739-48384c1387d7' class='xr-index-data-in' type='checkbox'/><label for='index-f9697344-c021-4ce7-9739-48384c1387d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5c2926ad-4526-4197-ab14-fe34569d41d5' class='xr-index-data-in' type='checkbox'/><label for='index-5c2926ad-4526-4197-ab14-fe34569d41d5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              61.0,               60.9,               60.8,
       60.699999999999996, 60.599999999999994,  60.49999999999999,
        60.39999999999999,  60.29999999999999,  60.19999999999999,
        60.09999999999999,
       ...
        48.89999999999983,  48.79999999999983, 48.699999999999825,
       48.599999999999824,  48.49999999999982,  48.39999999999982,
        48.29999999999982,  48.19999999999982,  48.09999999999982,
                     48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=131))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6bf03008-05e6-49d5-aeec-cf80fff549a4' class='xr-index-data-in' type='checkbox'/><label for='index-6bf03008-05e6-49d5-aeec-cf80fff549a4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -13.0,               -12.9,               -12.8,
       -12.700000000000001, -12.600000000000001, -12.500000000000002,
       -12.400000000000002, -12.300000000000002, -12.200000000000003,
       -12.100000000000003,
       ...
         4.099999999999973,   4.199999999999973,   4.299999999999972,
         4.399999999999972,   4.499999999999972,   4.599999999999971,
         4.699999999999971,  4.7999999999999705,    4.89999999999997,
                       5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=181))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8e2457d9-5e75-4095-a4b3-813e5420615b' class='xr-section-summary-in' type='checkbox'  ><label for='section-8e2457d9-5e75-4095-a4b3-813e5420615b' class='xr-section-summary' >Attributes: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="harmonise-datasets">
<h4>Harmonise datasets<a class="headerlink" href="#harmonise-datasets" title="Link to this heading">#</a></h4>
<p>Before the data can be analysed, the two datasets (AgERA5 and ERA5-Land) must be aligned in terms of coordinates and variable names.</p>
<section id="grid-alignment">
<h5>Grid alignment<a class="headerlink" href="#grid-alignment" title="Link to this heading">#</a></h5>
<p>Both datasets are provided on a regular 0.1¬∞ by 0.1¬∞ grid, so no regridding is necessary.
However, two steps need to be taken before the data can be compared directly:</p>
<ul class="simple">
<li><p>Their representation as floating-point numbers can cause very small differences to appear, which do not reflect any real differences in the data but are difficult for software (in this case xarray) to work with. Knowing that the data are on a regular 0.1¬∞ by 0.1¬∞ grid, we can simply round all of the coordinates to 2 digits to force them to be the same.</p></li>
<li><p>The bounds of the datasets (in space and in time) are slightly different and need to be aligned.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Round coordinates before alignment to avoid floating-point errors</span>
<span class="n">data_agera5</span> <span class="o">=</span> <span class="n">round_coordinates</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">round_coordinates</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>

<span class="c1"># Align data using an inner join</span>
<span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="units-and-variable-names">
<h5>Units and variable names<a class="headerlink" href="#units-and-variable-names" title="Link to this heading">#</a></h5>
<p>Temperatures are provided in K in both datasets ‚Äì here, we convert these to ¬∞C which is more commonly used in agricultural studies.
Solar irradiation is converted from J/m¬≤/d to MJ/m¬≤/d which is more intuitive, with 2.45 MJ/m¬≤ approximately equivalent to 1 mm of potential water evaporation [<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>].
The ‚Äúlong‚Äù names of variables and units, as stored in xarray metadata, are also harmonised between the two datasets to simplify the analysis steps and figures later on.
This is not strictly necessary, but it is convenient.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert temperatures to ¬∞C</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">VARIABLES_TEMPERATURE</span><span class="p">:</span>
    <span class="n">convert_K2C</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="n">var</span><span class="p">)</span>
    <span class="n">convert_K2C</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>

<span class="c1"># Convert irradiation to MJ/m¬≤/d</span>
<span class="n">convert_J2MJ</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">)</span>
<span class="n">convert_J2MJ</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="s2">&quot;Solar_Radiation_Flux&quot;</span><span class="p">)</span>

<span class="c1"># Harmonise variable/unit names</span>
<span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">adjust_names</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span>   <span class="s2">&quot;AgERA5&quot;</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">adjust_names</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">,</span> <span class="s2">&quot;ERA5-Land&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="id1">
<h4>Derived variables<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Lastly, the derived variables of 2 m wind speed, effective temperature, and cumulative growing degree-days are calculated and added to both datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">convert_to_2m_wind_speed</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_agera5</span>   <span class="o">=</span> <span class="n">add_growing_degree_days</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">)</span>
<span class="n">data_era5land</span> <span class="o">=</span> <span class="n">add_growing_degree_days</span><span class="p">(</span><span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_agera5</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 230MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
Data variables:
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    crs                          (time) int64 2kB dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Solar_Radiation_Flux         (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Wind_Speed_2m_Mean_24h       (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Effective        (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Growing_Degree_Days          (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
Attributes:
    Conventions:  CF-1.7
    title:        AgERA5 daily weather variables derived from the ECMWF ERA5 ...
    institution:  Wageningen Environmental Research
    history:      Generated by `pragera5 run_daily_processing 2023-01-01` ver...
    references:   https://doi.org/10.24381/cds.6c68c9bb
    source:       ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf
    name:         AgERA5</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5cc87f01-00c2-4e8f-85d6-ab940c6ec520' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5cc87f01-00c2-4e8f-85d6-ab940c6ec520' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-428d53a0-0323-4d2f-a97a-40955feb6feb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-428d53a0-0323-4d2f-a97a-40955feb6feb' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-076b5184-5d93-4245-8a8e-6ce063ebe64f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-076b5184-5d93-4245-8a8e-6ce063ebe64f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cbb1d2f-d3c2-4896-91d0-170b9027cd6b' class='xr-var-data-in' type='checkbox'><label for='data-8cbb1d2f-d3c2-4896-91d0-170b9027cd6b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-34099ad9-282b-4972-8073-b83e69048bd7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34099ad9-282b-4972-8073-b83e69048bd7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a5262b7-a587-4bc7-9a2c-006f1d5b5652' class='xr-var-data-in' type='checkbox'><label for='data-1a5262b7-a587-4bc7-9a2c-006f1d5b5652' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-2405b52b-386a-4a8b-ac14-9831770eb290' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2405b52b-386a-4a8b-ac14-9831770eb290' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ee5ab38-8157-4b02-96d0-54b74280b17a' class='xr-var-data-in' type='checkbox'><label for='data-4ee5ab38-8157-4b02-96d0-54b74280b17a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12. ,
       -11.9, -11.8, -11.7, -11.6, -11.5, -11.4, -11.3, -11.2, -11.1, -11. ,
       -10.9, -10.8, -10.7, -10.6, -10.5, -10.4, -10.3, -10.2, -10.1, -10. ,
        -9.9,  -9.8,  -9.7,  -9.6,  -9.5,  -9.4,  -9.3,  -9.2,  -9.1,  -9. ,
        -8.9,  -8.8,  -8.7,  -8.6,  -8.5,  -8.4,  -8.3,  -8.2,  -8.1,  -8. ,
        -7.9,  -7.8,  -7.7,  -7.6,  -7.5,  -7.4,  -7.3,  -7.2,  -7.1,  -7. ,
        -6.9,  -6.8,  -6.7,  -6.6,  -6.5,  -6.4,  -6.3,  -6.2,  -6.1,  -6. ,
        -5.9,  -5.8,  -5.7,  -5.6,  -5.5,  -5.4,  -5.3,  -5.2,  -5.1,  -5. ,
        -4.9,  -4.8,  -4.7,  -4.6,  -4.5,  -4.4,  -4.3,  -4.2,  -4.1,  -4. ,
        -3.9,  -3.8,  -3.7,  -3.6,  -3.5,  -3.4,  -3.3,  -3.2,  -3.1,  -3. ,
        -2.9,  -2.8,  -2.7,  -2.6,  -2.5,  -2.4,  -2.3,  -2.2,  -2.1,  -2. ,
        -1.9,  -1.8,  -1.7,  -1.6,  -1.5,  -1.4,  -1.3,  -1.2,  -1.1,  -1. ,
        -0.9,  -0.8,  -0.7,  -0.6,  -0.5,  -0.4,  -0.3,  -0.2,  -0.1,  -0. ,
         0.1,   0.2,   0.3,   0.4,   0.5,   0.6,   0.7,   0.8,   0.9,   1. ,
         1.1,   1.2,   1.3,   1.4,   1.5,   1.6,   1.7,   1.8,   1.9,   2. ,
         2.1,   2.2,   2.3,   2.4,   2.5,   2.6,   2.7,   2.8,   2.9,   3. ,
         3.1,   3.2,   3.3,   3.4,   3.5,   3.6,   3.7,   3.8,   3.9,   4. ,
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5. ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f9a036f5-06a1-43e7-8e62-3f70cabe6fc2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f9a036f5-06a1-43e7-8e62-3f70cabe6fc2' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-04ccc777-62af-460d-9a5c-2e24faf66ead' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04ccc777-62af-460d-9a5c-2e24faf66ead' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-308cdad8-1385-4326-8c48-d430e2a125ab' class='xr-var-data-in' type='checkbox'><label for='data-308cdad8-1385-4326-8c48-d430e2a125ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (min)</dd><dt><span>temporal_aggregation :</span></dt><dd>Min 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273,), meta=np.ndarray&gt;</div><input id='attrs-764b9d76-4bbf-4615-bdba-4db7bfc4020f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-764b9d76-4bbf-4615-bdba-4db7bfc4020f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96e3ed13-5875-4384-9407-da56356df224' class='xr-var-data-in' type='checkbox'><label for='data-96e3ed13-5875-4384-9407-da56356df224' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>long_name :</span></dt><dd>Coordinate reference system</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.13 kiB </td>
                        <td> 2.13 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273,) </td>
                        <td> (273,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >273</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-5c9b2f97-3897-423a-815e-6773a4720fae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5c9b2f97-3897-423a-815e-6773a4720fae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92934b8c-1604-44ad-b7ae-32b9103cc29d' class='xr-var-data-in' type='checkbox'><label for='data-92934b8c-1604-44ad-b7ae-32b9103cc29d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (max)</dd><dt><span>temporal_aggregation :</span></dt><dd>Max 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d6fb7d1a-d01f-465e-add4-3feba0dbe7c4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d6fb7d1a-d01f-465e-add4-3feba0dbe7c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98a0d145-5ca5-422b-a838-9a889a65eacb' class='xr-var-data-in' type='checkbox'><label for='data-98a0d145-5ca5-422b-a838-9a889a65eacb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Temperature (mean)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d5f55bdb-43f4-4110-905e-3fcd7aa9710a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d5f55bdb-43f4-4110-905e-3fcd7aa9710a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92fbcd50-aebd-4f32-b6d7-0e32a1c32926' class='xr-var-data-in' type='checkbox'><label for='data-92fbcd50-aebd-4f32-b6d7-0e32a1c32926' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>MJ/m¬≤/d</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Solar irradiation</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-e48ca6e6-adbc-4bd6-b623-130618a29e05' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e48ca6e6-adbc-4bd6-b623-130618a29e05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-58db0e90-8cb0-46d2-a41f-9cd4c021d04d' class='xr-var-data-in' type='checkbox'><label for='data-58db0e90-8cb0-46d2-a41f-9cd4c021d04d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm/d</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>temporal_aggregation :</span></dt><dd>Sum 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-86457aae-ac77-477e-b43c-18673b231c98' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86457aae-ac77-477e-b43c-18673b231c98' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27aba429-6e24-4a55-9119-f1a972d34928' class='xr-var-data-in' type='checkbox'><label for='data-27aba429-6e24-4a55-9119-f1a972d34928' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>cm</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 548 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d6f05587-ee89-43b0-9a75-cbad53a92903' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d6f05587-ee89-43b0-9a75-cbad53a92903' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7444b487-eb07-4fc9-90fb-ce02e950f659' class='xr-var-data-in' type='checkbox'><label for='data-7444b487-eb07-4fc9-90fb-ce02e950f659' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m/s</dd><dt><span>grid_mapping :</span></dt><dd>crs</dd><dt><span>long_name :</span></dt><dd>Wind speed (2 m)</dd><dt><span>temporal_aggregation :</span></dt><dd>Mean 00-00LT</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 549 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Effective</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-f53eb7d7-a99b-49f8-901b-4e3403c8e95b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f53eb7d7-a99b-49f8-901b-4e3403c8e95b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00688376-2d02-4e8b-8415-4823509a7f3e' class='xr-var-data-in' type='checkbox'><label for='data-00688376-2d02-4e8b-8415-4823509a7f3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Effective temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 557 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Growing_Degree_Days</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-69be3f0d-6153-471c-a979-cc45ba9563e4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-69be3f0d-6153-471c-a979-cc45ba9563e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4398473-08e1-4942-9253-87ffae376df1' class='xr-var-data-in' type='checkbox'><label for='data-a4398473-08e1-4942-9253-87ffae376df1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Œ£ Growing degree-days</dd><dt><span>units :</span></dt><dd>¬∞C d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 559 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-9aa8c711-85b2-4761-aca7-6191f9e3e5bc' class='xr-section-summary-in' type='checkbox'  ><label for='section-9aa8c711-85b2-4761-aca7-6191f9e3e5bc' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ecbb4f09-ec3f-4790-9dd1-6ab62e397eb2' class='xr-index-data-in' type='checkbox'/><label for='index-ecbb4f09-ec3f-4790-9dd1-6ab62e397eb2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0959e93e-6378-40bb-9b1a-0d80e1fc5237' class='xr-index-data-in' type='checkbox'/><label for='index-0959e93e-6378-40bb-9b1a-0d80e1fc5237' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60.0,
       ...
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1de54d26-840c-4e8f-b720-3262c538ac45' class='xr-index-data-in' type='checkbox'/><label for='index-1de54d26-840c-4e8f-b720-3262c538ac45' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12.0,
       ...
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b8a97bd-18ff-4009-ade1-ecedd2a767bb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6b8a97bd-18ff-4009-ade1-ecedd2a767bb' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>title :</span></dt><dd>AgERA5 daily weather variables derived from the ECMWF ERA5 reanalysis.</dd><dt><span>institution :</span></dt><dd>Wageningen Environmental Research</dd><dt><span>history :</span></dt><dd>Generated by `pragera5 run_daily_processing 2023-01-01` version 1.2.0, executed on 2025-03-07 12:00:44.087250</dd><dt><span>references :</span></dt><dd>https://doi.org/10.24381/cds.6c68c9bb</dd><dt><span>source :</span></dt><dd>ECWMF ERA5 reanalysis, https://doi.org/10.24381/cds.143582cf</dd><dt><span>name :</span></dt><dd>AgERA5</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_era5land</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 281MB
Dimensions:                      (time: 273, lat: 130, lon: 180)
Coordinates:
  * time                         (time) datetime64[ns] 2kB 2023-01-01 ... 202...
  * lat                          (lat) float64 1kB 60.9 60.8 60.7 ... 48.1 48.0
  * lon                          (lon) float64 1kB -12.9 -12.8 -12.7 ... 4.9 5.0
Data variables:
    Solar_Radiation_Flux         (time, lat, lon) float64 51MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Precipitation_Flux           (time, lat, lon) float64 51MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Min_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Max_24h   (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Air_2m_Mean_24h  (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Snow_Thickness_Mean_24h      (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Wind_Speed_2m_Mean_24h       (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Temperature_Effective        (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
    Growing_Degree_Days          (time, lat, lon) float32 26MB dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;
Attributes:
    class:        l5
    stream:       oper
    levtype:      sfc
    type:         fc
    expver:       0001
    date:         20221231
    time:         0
    domain:       g
    number:       0
    Conventions:  CF-1.8
    institution:  ECMWF
    name:         ERA5-Land</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7100e82f-8e69-43f8-9435-b3597aabd701' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7100e82f-8e69-43f8-9435-b3597aabd701' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 273</li><li><span class='xr-has-index'>lat</span>: 130</li><li><span class='xr-has-index'>lon</span>: 180</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e2803266-bd9a-4c84-b55f-049044543844' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e2803266-bd9a-4c84-b55f-049044543844' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2023-01-01 ... 2023-09-30</div><input id='attrs-2e3cc73e-a1e9-4535-bf47-399fae509d1f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e3cc73e-a1e9-4535-bf47-399fae509d1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51d4b6a7-c154-4aa8-971e-1b1bac025a2b' class='xr-var-data-in' type='checkbox'><label for='data-51d4b6a7-c154-4aa8-971e-1b1bac025a2b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>forecast_reference_time</dd><dt><span>long_name :</span></dt><dd>initial time of forecast</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2023-01-01T00:00:00.000000000&#x27;, &#x27;2023-01-02T00:00:00.000000000&#x27;,
       &#x27;2023-01-03T00:00:00.000000000&#x27;, ..., &#x27;2023-09-28T00:00:00.000000000&#x27;,
       &#x27;2023-09-29T00:00:00.000000000&#x27;, &#x27;2023-09-30T00:00:00.000000000&#x27;],
      shape=(273,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>60.9 60.8 60.7 ... 48.2 48.1 48.0</div><input id='attrs-87b6aa8c-dcd5-40a1-ad64-a32fac966cae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-87b6aa8c-dcd5-40a1-ad64-a32fac966cae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5db573e2-feb6-407f-8773-ba40fe0a846e' class='xr-var-data-in' type='checkbox'><label for='data-5db573e2-feb6-407f-8773-ba40fe0a846e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60. , 59.9, 59.8,
       59.7, 59.6, 59.5, 59.4, 59.3, 59.2, 59.1, 59. , 58.9, 58.8, 58.7, 58.6,
       58.5, 58.4, 58.3, 58.2, 58.1, 58. , 57.9, 57.8, 57.7, 57.6, 57.5, 57.4,
       57.3, 57.2, 57.1, 57. , 56.9, 56.8, 56.7, 56.6, 56.5, 56.4, 56.3, 56.2,
       56.1, 56. , 55.9, 55.8, 55.7, 55.6, 55.5, 55.4, 55.3, 55.2, 55.1, 55. ,
       54.9, 54.8, 54.7, 54.6, 54.5, 54.4, 54.3, 54.2, 54.1, 54. , 53.9, 53.8,
       53.7, 53.6, 53.5, 53.4, 53.3, 53.2, 53.1, 53. , 52.9, 52.8, 52.7, 52.6,
       52.5, 52.4, 52.3, 52.2, 52.1, 52. , 51.9, 51.8, 51.7, 51.6, 51.5, 51.4,
       51.3, 51.2, 51.1, 51. , 50.9, 50.8, 50.7, 50.6, 50.5, 50.4, 50.3, 50.2,
       50.1, 50. , 49.9, 49.8, 49.7, 49.6, 49.5, 49.4, 49.3, 49.2, 49.1, 49. ,
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48. ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-12.9 -12.8 -12.7 ... 4.8 4.9 5.0</div><input id='attrs-6b376db5-fb30-46bd-89ea-b7959d5ca656' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6b376db5-fb30-46bd-89ea-b7959d5ca656' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e74c0252-8231-4792-9085-5823e0645c5a' class='xr-var-data-in' type='checkbox'><label for='data-e74c0252-8231-4792-9085-5823e0645c5a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12. ,
       -11.9, -11.8, -11.7, -11.6, -11.5, -11.4, -11.3, -11.2, -11.1, -11. ,
       -10.9, -10.8, -10.7, -10.6, -10.5, -10.4, -10.3, -10.2, -10.1, -10. ,
        -9.9,  -9.8,  -9.7,  -9.6,  -9.5,  -9.4,  -9.3,  -9.2,  -9.1,  -9. ,
        -8.9,  -8.8,  -8.7,  -8.6,  -8.5,  -8.4,  -8.3,  -8.2,  -8.1,  -8. ,
        -7.9,  -7.8,  -7.7,  -7.6,  -7.5,  -7.4,  -7.3,  -7.2,  -7.1,  -7. ,
        -6.9,  -6.8,  -6.7,  -6.6,  -6.5,  -6.4,  -6.3,  -6.2,  -6.1,  -6. ,
        -5.9,  -5.8,  -5.7,  -5.6,  -5.5,  -5.4,  -5.3,  -5.2,  -5.1,  -5. ,
        -4.9,  -4.8,  -4.7,  -4.6,  -4.5,  -4.4,  -4.3,  -4.2,  -4.1,  -4. ,
        -3.9,  -3.8,  -3.7,  -3.6,  -3.5,  -3.4,  -3.3,  -3.2,  -3.1,  -3. ,
        -2.9,  -2.8,  -2.7,  -2.6,  -2.5,  -2.4,  -2.3,  -2.2,  -2.1,  -2. ,
        -1.9,  -1.8,  -1.7,  -1.6,  -1.5,  -1.4,  -1.3,  -1.2,  -1.1,  -1. ,
        -0.9,  -0.8,  -0.7,  -0.6,  -0.5,  -0.4,  -0.3,  -0.2,  -0.1,  -0. ,
         0.1,   0.2,   0.3,   0.4,   0.5,   0.6,   0.7,   0.8,   0.9,   1. ,
         1.1,   1.2,   1.3,   1.4,   1.5,   1.6,   1.7,   1.8,   1.9,   2. ,
         2.1,   2.2,   2.3,   2.4,   2.5,   2.6,   2.7,   2.8,   2.9,   3. ,
         3.1,   3.2,   3.3,   3.4,   3.5,   3.6,   3.7,   3.8,   3.9,   4. ,
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5. ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3a300f6a-4a4e-48ef-b185-23411bd43a67' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3a300f6a-4a4e-48ef-b185-23411bd43a67' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Solar_Radiation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-86e62fe8-1cc5-465d-97b2-f27fedfb1ea6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86e62fe8-1cc5-465d-97b2-f27fedfb1ea6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0cd3098-51c2-4509-a388-41afe5d51617' class='xr-var-data-in' type='checkbox'><label for='data-d0cd3098-51c2-4509-a388-41afe5d51617' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>ssrd</dd><dt><span>standard_name :</span></dt><dd>surface_downwelling_shortwave_flux_in_air</dd><dt><span>long_name :</span></dt><dd>Solar irradiation</dd><dt><span>paramId :</span></dt><dd>169</dd><dt><span>units :</span></dt><dd>MJ/m¬≤/d</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xa9\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 48.74 MiB </td>
                        <td> 48.74 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Precipitation_Flux</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-29d1dd8d-fb85-4f4d-b9af-7e4ae3c1eb75' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29d1dd8d-fb85-4f4d-b9af-7e4ae3c1eb75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d634aa8-1713-414b-afa0-c29f227e8e89' class='xr-var-data-in' type='checkbox'><label for='data-2d634aa8-1713-414b-afa0-c29f227e8e89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>param :</span></dt><dd>tp</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>paramId :</span></dt><dd>228</dd><dt><span>units :</span></dt><dd>mm/d</dd><dt><span>_earthkit :</span></dt><dd>{&#x27;message&#x27;: b&#x27;GRIB\x00\x00l\x01\x00\x004\x80b\xff\xff\x80\xe4\x01\x00\x00\x16\x0c\x1f\x00\x00\x01\x17\x18\x04\x00\x00\x00\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01!\t\x04\x010001\x00\x00\x00\x00\x00 \x00\xff\x00\x00\xb5\x00\x83\x00\xeeH\x802\xc8\x80\x00\xbb\x80\x00\x13\x88\x00d\x00d\x00\x00\x00\x00\x00\x00\x00\x0c\x00\x80\x02D\xb9}n\x00\x007777&#x27;, &#x27;bitsPerValue&#x27;: 24}</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 48.74 MiB </td>
                        <td> 48.74 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 3 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Min_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-7c739d8d-d401-432a-bbb6-2c5ca9922a32' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c739d8d-d401-432a-bbb6-2c5ca9922a32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a281a7fb-706b-48ce-965c-9aa20170d63b' class='xr-var-data-in' type='checkbox'><label for='data-a281a7fb-706b-48ce-965c-9aa20170d63b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (min)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Max_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-d293b7ae-8ec9-468b-ad84-c51479f7a118' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d293b7ae-8ec9-468b-ad84-c51479f7a118' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1d7a02b-0195-466c-a443-f2f1cefe5452' class='xr-var-data-in' type='checkbox'><label for='data-f1d7a02b-0195-466c-a443-f2f1cefe5452' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (max)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Air_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-9b544d35-692d-46c1-8401-3558ca818e1f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b544d35-692d-46c1-8401-3558ca818e1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b5b02d2-e8bd-47c7-82d1-fc33ebbb973a' class='xr-var-data-in' type='checkbox'><label for='data-2b5b02d2-e8bd-47c7-82d1-fc33ebbb973a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>167</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>t2m</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>-13.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>2 metre temperature</dd><dt><span>GRIB_shortName :</span></dt><dd>2t</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature (mean)</dd><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Snow_Thickness_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-9de22389-164e-44ea-9bc1-1e367813345b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9de22389-164e-44ea-9bc1-1e367813345b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02b7bf9f-b0cc-4787-b116-2ad9b396598e' class='xr-var-data-in' type='checkbox'><label for='data-02b7bf9f-b0cc-4787-b116-2ad9b396598e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>3066</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>23711</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>181</dd><dt><span>GRIB_Ny :</span></dt><dd>131</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sde</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/longitude</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.1</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>61.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>48.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>347.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>5.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Snow depth</dd><dt><span>GRIB_shortName :</span></dt><dd>sde</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Snow depth</dd><dt><span>units :</span></dt><dd>cm</dd><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_surface_snow_amount</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 6 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wind_Speed_2m_Mean_24h</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-33f1bb55-84ef-4b74-b565-75641808fe2a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33f1bb55-84ef-4b74-b565-75641808fe2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2809f1c-42a3-4ce5-8b04-c201ccba5541' class='xr-var-data-in' type='checkbox'><label for='data-f2809f1c-42a3-4ce5-8b04-c201ccba5541' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Wind speed (2 m)</dd><dt><span>units :</span></dt><dd>m/s</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 12 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Temperature_Effective</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-f3b93b4e-9374-405b-8954-79c95966db49' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3b93b4e-9374-405b-8954-79c95966db49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f648ea35-4b01-408b-b2ee-f41df00fecb9' class='xr-var-data-in' type='checkbox'><label for='data-f648ea35-4b01-408b-b2ee-f41df00fecb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Effective temperature</dd><dt><span>units :</span></dt><dd>¬∞C</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 14 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Growing_Degree_Days</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(273, 130, 180), meta=np.ndarray&gt;</div><input id='attrs-9b4eefd1-4fa3-4ef4-a9e0-86cd8a3e0fb7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b4eefd1-4fa3-4ef4-a9e0-86cd8a3e0fb7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1186801a-fcb7-49e4-b174-bb1b5fca4afe' class='xr-var-data-in' type='checkbox'><label for='data-1186801a-fcb7-49e4-b174-bb1b5fca4afe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Œ£ Growing degree-days</dd><dt><span>units :</span></dt><dd>¬∞C d</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 24.37 MiB </td>
                        <td> 24.37 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (273, 130, 180) </td>
                        <td> (273, 130, 180) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 16 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="209" height="177" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="57" x2="80" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="57" style="stroke-width:2" />
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,127.73109243697479 10.0,57.14285714285714" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="89" y2="0" style="stroke-width:2" />
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="89" y1="0" x2="159" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 89.12087912087912,0.0 159.70911441499678,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="159" y2="70" style="stroke-width:2" />
  <line x1="80" y1="127" x2="159" y2="127" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="127" style="stroke-width:2" />
  <line x1="159" y1="70" x2="159" y2="127" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 159.70911441499678,70.58823529411765 159.70911441499678,127.73109243697479 80.58823529411765,127.73109243697479" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.148675" y="147.731092" font-size="1.0rem" font-weight="100" text-anchor="middle" >180</text>
  <text x="179.709114" y="99.159664" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,179.709114,99.159664)">130</text>
  <text x="35.294118" y="112.436975" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,112.436975)">273</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b63824df-7b35-4d9f-9414-94d96467ad05' class='xr-section-summary-in' type='checkbox'  ><label for='section-b63824df-7b35-4d9f-9414-94d96467ad05' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-750a6990-39a9-4a47-b40b-8d844cb71726' class='xr-index-data-in' type='checkbox'/><label for='index-750a6990-39a9-4a47-b40b-8d844cb71726' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2023-01-01&#x27;, &#x27;2023-01-02&#x27;, &#x27;2023-01-03&#x27;, &#x27;2023-01-04&#x27;,
               &#x27;2023-01-05&#x27;, &#x27;2023-01-06&#x27;, &#x27;2023-01-07&#x27;, &#x27;2023-01-08&#x27;,
               &#x27;2023-01-09&#x27;, &#x27;2023-01-10&#x27;,
               ...
               &#x27;2023-09-21&#x27;, &#x27;2023-09-22&#x27;, &#x27;2023-09-23&#x27;, &#x27;2023-09-24&#x27;,
               &#x27;2023-09-25&#x27;, &#x27;2023-09-26&#x27;, &#x27;2023-09-27&#x27;, &#x27;2023-09-28&#x27;,
               &#x27;2023-09-29&#x27;, &#x27;2023-09-30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=273, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b9969272-df16-49b4-8178-af713a6cfc7b' class='xr-index-data-in' type='checkbox'/><label for='index-b9969272-df16-49b4-8178-af713a6cfc7b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([60.9, 60.8, 60.7, 60.6, 60.5, 60.4, 60.3, 60.2, 60.1, 60.0,
       ...
       48.9, 48.8, 48.7, 48.6, 48.5, 48.4, 48.3, 48.2, 48.1, 48.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=130))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-109555d9-3c26-43d6-984e-06b7e43bec62' class='xr-index-data-in' type='checkbox'/><label for='index-109555d9-3c26-43d6-984e-06b7e43bec62' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-12.9, -12.8, -12.7, -12.6, -12.5, -12.4, -12.3, -12.2, -12.1, -12.0,
       ...
         4.1,   4.2,   4.3,   4.4,   4.5,   4.6,   4.7,   4.8,   4.9,   5.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=180))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-123dfc5d-9c34-4c72-904a-c7ea9cb66124' class='xr-section-summary-in' type='checkbox'  ><label for='section-123dfc5d-9c34-4c72-904a-c7ea9cb66124' class='xr-section-summary' >Attributes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>class :</span></dt><dd>l5</dd><dt><span>stream :</span></dt><dd>oper</dd><dt><span>levtype :</span></dt><dd>sfc</dd><dt><span>type :</span></dt><dd>fc</dd><dt><span>expver :</span></dt><dd>0001</dd><dt><span>date :</span></dt><dd>20221231</dd><dt><span>time :</span></dt><dd>0</dd><dt><span>domain :</span></dt><dd>g</dd><dt><span>number :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>institution :</span></dt><dd>ECMWF</dd><dt><span>name :</span></dt><dd>ERA5-Land</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<section id="results">
<span id="indicator-sis-agrometeorological-indicators-consistency-q01-section-results"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>This section contains the comparison between values retrieved from AgERA5 vs ERA5-Land.
The datasets are compared in three ways:</p>
<ul class="simple">
<li><p>Point-by-point: Comparison between individual data points with matching coordinates (in time and space). Provides a quantitative estimate of the agreement between the datasets averaged over the entire domain.</p></li>
<li><p>Time series: Agreement between the datasets over time for one site or an ensemble. Most practically relevant for crop yield modelling, which is based on values at specific times and/or aggregated over the entire time series.</p></li>
<li><p>Geospatial: Distribution across the spatial domain. Displays spatial patterns and highlights specific areas or types of terrain (e.g. coastal, mountain) with better or worse agreement.</p></li>
</ul>
<p>These comparisons are followed by a general discussion and conclusions.</p>
<section id="point-by-point-comparison">
<h4>Point-by-point comparison<a class="headerlink" href="#point-by-point-comparison" title="Link to this heading">#</a></h4>
<p>In this section, the overall distributions of values in the two datasets, and their differences, are compared.</p>
<p>We first examine some metrics that describe the difference Œî between corresponding (in time and space) pixels:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_difference_stats</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_d9155">
  <caption>AgERA5 ‚Äì ERA5-Land</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_d9155_level0_col0" class="col_heading level0 col0" >Mean Œî</th>
      <th id="T_d9155_level0_col1" class="col_heading level0 col1" >Median Œî</th>
      <th id="T_d9155_level0_col2" class="col_heading level0 col2" >Median |Œî|</th>
      <th id="T_d9155_level0_col3" class="col_heading level0 col3" >Median |Œî| [%]</th>
      <th id="T_d9155_level0_col4" class="col_heading level0 col4" >Pearson r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d9155_level0_row0" class="row_heading level0 row0" >Temperature (max)<br>[¬∞C]</th>
      <td id="T_d9155_row0_col0" class="data row0 col0" >0.2329</td>
      <td id="T_d9155_row0_col1" class="data row0 col1" >0.2401</td>
      <td id="T_d9155_row0_col2" class="data row0 col2" >0.4402</td>
      <td id="T_d9155_row0_col3" class="data row0 col3" >nan</td>
      <td id="T_d9155_row0_col4" class="data row0 col4" >0.9942</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row1" class="row_heading level0 row1" >Temperature (mean)<br>[¬∞C]</th>
      <td id="T_d9155_row1_col0" class="data row1 col0" >-0.1145</td>
      <td id="T_d9155_row1_col1" class="data row1 col1" >-0.1044</td>
      <td id="T_d9155_row1_col2" class="data row1 col2" >0.3325</td>
      <td id="T_d9155_row1_col3" class="data row1 col3" >nan</td>
      <td id="T_d9155_row1_col4" class="data row1 col4" >0.9957</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row2" class="row_heading level0 row2" >Temperature (min)<br>[¬∞C]</th>
      <td id="T_d9155_row2_col0" class="data row2 col0" >-0.5084</td>
      <td id="T_d9155_row2_col1" class="data row2 col1" >-0.4838</td>
      <td id="T_d9155_row2_col2" class="data row2 col2" >0.5900</td>
      <td id="T_d9155_row2_col3" class="data row2 col3" >nan</td>
      <td id="T_d9155_row2_col4" class="data row2 col4" >0.9895</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row3" class="row_heading level0 row3" >Solar irradiation<br>[MJ/m¬≤/d]</th>
      <td id="T_d9155_row3_col0" class="data row3 col0" >-0.3077</td>
      <td id="T_d9155_row3_col1" class="data row3 col1" >-0.2269</td>
      <td id="T_d9155_row3_col2" class="data row3 col2" >0.3099</td>
      <td id="T_d9155_row3_col3" class="data row3 col3" >2.9868</td>
      <td id="T_d9155_row3_col4" class="data row3 col4" >0.9978</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row4" class="row_heading level0 row4" >Wind speed (2 m)<br>[m/s]</th>
      <td id="T_d9155_row4_col0" class="data row4 col0" >0.4809</td>
      <td id="T_d9155_row4_col1" class="data row4 col1" >0.4702</td>
      <td id="T_d9155_row4_col2" class="data row4 col2" >0.5099</td>
      <td id="T_d9155_row4_col3" class="data row4 col3" >19.2494</td>
      <td id="T_d9155_row4_col4" class="data row4 col4" >0.9088</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row5" class="row_heading level0 row5" >Total precipitation<br>[mm/d]</th>
      <td id="T_d9155_row5_col0" class="data row5 col0" >-0.0002</td>
      <td id="T_d9155_row5_col1" class="data row5 col1" >-0.0013</td>
      <td id="T_d9155_row5_col2" class="data row5 col2" >0.0680</td>
      <td id="T_d9155_row5_col3" class="data row5 col3" >12.8833</td>
      <td id="T_d9155_row5_col4" class="data row5 col4" >0.9910</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row6" class="row_heading level0 row6" >Snow depth<br>[cm]</th>
      <td id="T_d9155_row6_col0" class="data row6 col0" >-0.0454</td>
      <td id="T_d9155_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_d9155_row6_col2" class="data row6 col2" >0.0000</td>
      <td id="T_d9155_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_d9155_row6_col4" class="data row6 col4" >0.6730</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row7" class="row_heading level0 row7" >Effective temperature<br>[¬∞C]</th>
      <td id="T_d9155_row7_col0" class="data row7 col0" >-0.1066</td>
      <td id="T_d9155_row7_col1" class="data row7 col1" >-0.0449</td>
      <td id="T_d9155_row7_col2" class="data row7 col2" >0.2845</td>
      <td id="T_d9155_row7_col3" class="data row7 col3" >3.5690</td>
      <td id="T_d9155_row7_col4" class="data row7 col4" >0.9958</td>
    </tr>
    <tr>
      <th id="T_d9155_level0_row8" class="row_heading level0 row8" >Œ£ Growing degree-days<br>[¬∞C d]</th>
      <td id="T_d9155_row8_col0" class="data row8 col0" >-12.2380</td>
      <td id="T_d9155_row8_col1" class="data row8 col1" >-8.3359</td>
      <td id="T_d9155_row8_col2" class="data row8 col2" >11.6122</td>
      <td id="T_d9155_row8_col3" class="data row8 col3" >2.8305</td>
      <td id="T_d9155_row8_col4" class="data row8 col4" >0.9995</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Next, we display the point-by-point comparison in two ways:
a scatter plot showing the relationship between values in the two datasets
and
a histogram showing the overall distribution of differences between values.</p>
<p>Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter"><span class="std std-numref">6.1.1</span></a>
Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist"><span class="std std-numref">6.1.2</span></a></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scatter_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                   <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-scatter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">histogram_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                     <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-hist&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="scatter" for="sd-tab-item-0">
Scatter plot</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter" style="width: 700px">
<img alt="../_images/4ac9419a644a6584085b227f84646f0f5bf64e08ca81e50f815670444599622d.png" src="../_images/4ac9419a644a6584085b227f84646f0f5bf64e08ca81e50f815670444599622d.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.1 </span><span class="caption-text">Point-by-point comparison (density scatter) between AgERA5 and ERA5-Land for each variable.
Yellow means high density, blue means low density, white means zero points in that bin.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-scatter" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="histogram" for="sd-tab-item-1">
Histogram</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist" style="width: 700px">
<img alt="../_images/ff48ac718752821407dea6035af058d30a4647624e022f8b36913eb0d840dc67.png" src="../_images/ff48ac718752821407dea6035af058d30a4647624e022f8b36913eb0d840dc67.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.2 </span><span class="caption-text">Overall distributions of point-by-point differences between AgERA5 and ERA5-Land for each variable.
Note that some variables (e.g. snow depth) are highly concentrated at 0 difference.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-hist" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="time-series-comparison">
<h4>Time series comparison<a class="headerlink" href="#time-series-comparison" title="Link to this heading">#</a></h4>
<p>Crop yield estimates make use of the time series of the relevant variables in a given site.
Therefore, a comparison between time series from the different datasets should provide a better estimate of the differences downstream than an overall point-by-point comparison.</p>
<p>First, we examine the metrics that describe the difference Œî between corresponding (in time and space) pixels at our test site (defined at the top of this notebook):</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select from each dataset</span>
<span class="c1"># **site unpacks `site` (defined at the start) into lat=..., lon=...</span>
<span class="n">timeseries_agera5</span><span class="p">,</span> <span class="n">timeseries_era5land</span> <span class="o">=</span> <span class="n">select_in_multiple_datasets</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="o">**</span><span class="n">site</span><span class="p">)</span>
<span class="n">display_difference_stats</span><span class="p">(</span><span class="n">timeseries_agera5</span><span class="p">,</span> <span class="n">timeseries_era5land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_ba47f">
  <caption>AgERA5 ‚Äì ERA5-Land</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_ba47f_level0_col0" class="col_heading level0 col0" >Mean Œî</th>
      <th id="T_ba47f_level0_col1" class="col_heading level0 col1" >Median Œî</th>
      <th id="T_ba47f_level0_col2" class="col_heading level0 col2" >Median |Œî|</th>
      <th id="T_ba47f_level0_col3" class="col_heading level0 col3" >Median |Œî| [%]</th>
      <th id="T_ba47f_level0_col4" class="col_heading level0 col4" >Pearson r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ba47f_level0_row0" class="row_heading level0 row0" >Temperature (max)<br>[¬∞C]</th>
      <td id="T_ba47f_row0_col0" class="data row0 col0" >0.2198</td>
      <td id="T_ba47f_row0_col1" class="data row0 col1" >0.2174</td>
      <td id="T_ba47f_row0_col2" class="data row0 col2" >0.4139</td>
      <td id="T_ba47f_row0_col3" class="data row0 col3" >nan</td>
      <td id="T_ba47f_row0_col4" class="data row0 col4" >0.9954</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row1" class="row_heading level0 row1" >Temperature (mean)<br>[¬∞C]</th>
      <td id="T_ba47f_row1_col0" class="data row1 col0" >-0.0071</td>
      <td id="T_ba47f_row1_col1" class="data row1 col1" >0.0203</td>
      <td id="T_ba47f_row1_col2" class="data row1 col2" >0.3290</td>
      <td id="T_ba47f_row1_col3" class="data row1 col3" >nan</td>
      <td id="T_ba47f_row1_col4" class="data row1 col4" >0.9962</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row2" class="row_heading level0 row2" >Temperature (min)<br>[¬∞C]</th>
      <td id="T_ba47f_row2_col0" class="data row2 col0" >-0.1923</td>
      <td id="T_ba47f_row2_col1" class="data row2 col1" >-0.1600</td>
      <td id="T_ba47f_row2_col2" class="data row2 col2" >0.4570</td>
      <td id="T_ba47f_row2_col3" class="data row2 col3" >nan</td>
      <td id="T_ba47f_row2_col4" class="data row2 col4" >0.9911</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row3" class="row_heading level0 row3" >Solar irradiation<br>[MJ/m¬≤/d]</th>
      <td id="T_ba47f_row3_col0" class="data row3 col0" >-0.0380</td>
      <td id="T_ba47f_row3_col1" class="data row3 col1" >-0.0420</td>
      <td id="T_ba47f_row3_col2" class="data row3 col2" >0.2173</td>
      <td id="T_ba47f_row3_col3" class="data row3 col3" >1.9353</td>
      <td id="T_ba47f_row3_col4" class="data row3 col4" >0.9989</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row4" class="row_heading level0 row4" >Wind speed (2 m)<br>[m/s]</th>
      <td id="T_ba47f_row4_col0" class="data row4 col0" >0.5495</td>
      <td id="T_ba47f_row4_col1" class="data row4 col1" >0.4769</td>
      <td id="T_ba47f_row4_col2" class="data row4 col2" >0.4769</td>
      <td id="T_ba47f_row4_col3" class="data row4 col3" >16.0054</td>
      <td id="T_ba47f_row4_col4" class="data row4 col4" >0.9375</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row5" class="row_heading level0 row5" >Total precipitation<br>[mm/d]</th>
      <td id="T_ba47f_row5_col0" class="data row5 col0" >0.0596</td>
      <td id="T_ba47f_row5_col1" class="data row5 col1" >-0.0015</td>
      <td id="T_ba47f_row5_col2" class="data row5 col2" >0.0444</td>
      <td id="T_ba47f_row5_col3" class="data row5 col3" >16.2491</td>
      <td id="T_ba47f_row5_col4" class="data row5 col4" >0.9934</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row6" class="row_heading level0 row6" >Snow depth<br>[cm]</th>
      <td id="T_ba47f_row6_col0" class="data row6 col0" >-0.0008</td>
      <td id="T_ba47f_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_ba47f_row6_col2" class="data row6 col2" >0.0000</td>
      <td id="T_ba47f_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_ba47f_row6_col4" class="data row6 col4" >0.3361</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row7" class="row_heading level0 row7" >Effective temperature<br>[¬∞C]</th>
      <td id="T_ba47f_row7_col0" class="data row7 col0" >-0.0366</td>
      <td id="T_ba47f_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_ba47f_row7_col2" class="data row7 col2" >0.2772</td>
      <td id="T_ba47f_row7_col3" class="data row7 col3" >3.2895</td>
      <td id="T_ba47f_row7_col4" class="data row7 col4" >0.9965</td>
    </tr>
    <tr>
      <th id="T_ba47f_level0_row8" class="row_heading level0 row8" >Œ£ Growing degree-days<br>[¬∞C d]</th>
      <td id="T_ba47f_row8_col0" class="data row8 col0" >-5.2544</td>
      <td id="T_ba47f_row8_col1" class="data row8 col1" >-5.4141</td>
      <td id="T_ba47f_row8_col2" class="data row8 col2" >5.4141</td>
      <td id="T_ba47f_row8_col3" class="data row8 col3" >1.1388</td>
      <td id="T_ba47f_row8_col4" class="data row8 col4" >1.0000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We now create a plot showing all variables:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeseries_comparison</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-abs&quot;</span><span class="p">)</span>

<span class="n">timeseries_comparison_difference</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-rel&quot;</span><span class="p">)</span>

<span class="n">timeseries_comparison_difference_multi</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span>
                      <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-timeseries-multi&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="abs1" for="sd-tab-item-2">
Values, one site</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs" style="width: 700px">
<img alt="../_images/85c016434f1ff40d5a8ee2c97cfb2e36b27f336b533917f1ef2f33050e15bb38.png" src="../_images/85c016434f1ff40d5a8ee2c97cfb2e36b27f336b533917f1ef2f33050e15bb38.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.3 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, in one site.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-abs" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="rel1" for="sd-tab-item-3">
Difference, one site</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel" style="width: 700px">
<img alt="../_images/072738b3eff0e0548a463272ca2ba740f8a91f9d14e0e3776254fb56c31c6309.png" src="../_images/072738b3eff0e0548a463272ca2ba740f8a91f9d14e0e3776254fb56c31c6309.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.4 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, in one site.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-rel" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="reldom" for="sd-tab-item-4">
Difference, full domain</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi" style="width: 700px">
<img alt="../_images/ff3ac3a2ec6722fcbbe9f3ec05c1e68eccbef0656d5f4e23554710ee852e9837.png" src="../_images/ff3ac3a2ec6722fcbbe9f3ec05c1e68eccbef0656d5f4e23554710ee852e9837.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.5 </span><span class="caption-text">Time series comparison between AgERA5 and ERA5-Land for each variable, in one site.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-timeseries-multi" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="geospatial-comparison">
<h4>Geospatial comparison<a class="headerlink" href="#geospatial-comparison" title="Link to this heading">#</a></h4>
<p>In this section, the spatial distributions of values in the two datasets, and their differences, are compared visually using earthkit-plots.
For a fair comparison, this is done across multiple dates, which can be specified in the following cell:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Date(s) for geospatial comparison plot, in {year}-mm-dd format</span>
<span class="c1"># Examples were chosen arbitrarily</span>
<span class="n">comparison_dates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;winter&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span>  <span class="c1">#  1 January</span>
    <span class="s2">&quot;spring&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-04-15&quot;</span><span class="p">,</span>  <span class="c1"># 15 April</span>
    <span class="s2">&quot;summer&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-06-20&quot;</span><span class="p">,</span>  <span class="c1"># 20 June</span>
    <span class="s2">&quot;autumn&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-09-24&quot;</span><span class="p">,</span>  <span class="c1"># 24 September</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Results here
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-winter"><span class="std std-numref">6.1.6</span></a>)
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-spring"><span class="std std-numref">6.1.7</span></a>)
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-summer"><span class="std std-numref">6.1.8</span></a>)
(Figure <a class="reference internal" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-autumn"><span class="std std-numref">6.1.9</span></a>)</p>
<!--
Note that differences in snow thickness are highest in areas where you wouldn't generally have crops anyway
--><div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop over dates and plot each -- Note this take several minutes</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">comparison_dates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Label for Jupyter-book</span>
    <span class="n">glue_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;indicator_sis-agrometeorological-indicators_consistency_q01_fig-geo-</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Plot</span>
    <span class="n">geospatial_comparison_with_difference</span><span class="p">(</span><span class="n">data_agera5</span><span class="p">,</span> <span class="n">data_era5land</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
                                          <span class="n">glue_label</span><span class="o">=</span><span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                                                                                                                 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                                                                                                                 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                                                                                                                 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                                                                                                                 
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="winter" for="sd-tab-item-5">
Winter</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-winter" style="width: 700px">
<img alt="../_images/92d637a4bf9057eec63af8fe4a03857b44863e865c7fb762581aa51f077f4696.png" src="../_images/92d637a4bf9057eec63af8fe4a03857b44863e865c7fb762581aa51f077f4696.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.6 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-winter" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="spring" for="sd-tab-item-6">
Spring</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-spring" style="width: 700px">
<img alt="../_images/71114bcc3897118234803f349cba8caceb0d4b456aab966dc5a027d3f0e2c26e.png" src="../_images/71114bcc3897118234803f349cba8caceb0d4b456aab966dc5a027d3f0e2c26e.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.7 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-spring" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="summer" for="sd-tab-item-7">
Summer</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-summer" style="width: 700px">
<img alt="../_images/8280ba27a6f0a5bc8c224defe7ac4e12bc2943d15a9f42f8d56913619f724839.png" src="../_images/8280ba27a6f0a5bc8c224defe7ac4e12bc2943d15a9f42f8d56913619f724839.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.8 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-summer" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-8" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="autumn" for="sd-tab-item-8">
Autumn</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-autumn" style="width: 700px">
<img alt="../_images/b03adf645d1d81f0ec1fa14f8a8da6d19f943d8b1331eee7f59e8bc5c3fe393e.png" src="../_images/b03adf645d1d81f0ec1fa14f8a8da6d19f943d8b1331eee7f59e8bc5c3fe393e.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.9 </span><span class="caption-text">Geospatial comparison between AgERA5 and ERA5-Land.</span><a class="headerlink" href="#indicator-sis-agrometeorological-indicators-consistency-q01-fig-geo-autumn" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="discussion-and-conclusions">
<h4>Discussion and Conclusions<a class="headerlink" href="#discussion-and-conclusions" title="Link to this heading">#</a></h4>
<p>Text.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Agrometeorological indicators from 1979 to present derived from reanalysis (AgERA5): <a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">sis-agrometeorological-indicators</a></p></li>
<li><p>ERA5-Land hourly data from 1950 to present: <a class="reference external" href="https://doi.org/10.24381/cds.e2161bac" rel="noreferrer" target="_blank">reanalysis-era5-land</a></p></li>
<li><p>ERA5-Land post-processed daily statistics from 1950 to present: <a class="reference external" href="https://doi.org/10.24381/cds.e9c9c792" rel="noreferrer" target="_blank">derived-era5-land-daily-statistics</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a></p>
<ul>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a></p></li>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a></p></li>
</ul>
</li>
</ul>
<p>More about crop yield estimation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.wur.nl/en/show/a-gentle-introduction-to-wofost.htm" rel="noreferrer" target="_blank">A gentle introduction to WOFOST</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1007/s00704-024-05046-x" rel="noreferrer" target="_blank">Crop yield prediction based on reanalysis and crop phenology data in the agroclimatic zones</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.agrformet.2025.110637" rel="noreferrer" target="_blank">Historical trends and future projections of compound cloudy-rainy events during the global winter wheat harvest phase</a></p></li>
</ul>
<p>More about reanalysis data:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">The ERA5 global reanalysis</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">ERA5-Land: a state-of-the-art global reanalysis dataset for land applications</a></p></li>
<li><p>AgERA5</p>
<ul>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278550984" rel="noreferrer" target="_blank">Algorithm Theoretical Basis (ATBD)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278551004" rel="noreferrer" target="_blank">Product User Guide and Specification (PUGS)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Global+Agriculture+Downscaling+and+bias+correction" rel="noreferrer" target="_blank">Global Agriculture Downscaling and bias correction</a></p></li>
<li><p><a class="reference external" href="https://github.com/ajwdewit/agera5tools" rel="noreferrer" target="_blank">AgERA5tools Python package</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.06.018" rel="noreferrer" target="_blank">De Wit+19</a>] A. de Wit et al., ‚Äò25 years of the WOFOST cropping systems model‚Äô, Agricultural Systems, vol. 168, pp. 154‚Äì167, Oct. 2019, doi: 10.1016/j.agsy.2018.06.018.</p>
<p>[<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>] H. Hersbach et al., ‚ÄòThe ERA5 global reanalysis‚Äô, Quarterly Journal of the Royal Meteorological Society, vol. 146, no. 730, pp. 1999‚Äì2049, May 2020, doi: 10.1002/qj.3803.</p>
<p>[<a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank">Mu√±oz-Sabater+21</a>] J. Mu√±oz-Sabater et al., ‚ÄòERA5-Land: a state-of-the-art global reanalysis dataset for land applications‚Äô, Earth System Science Data, vol. 13, no. 9, pp. 4349‚Äì4383, Sept. 2021, doi: 10.5194/essd-13-4349-2021.</p>
<p>[<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/2024-12/Value-generated-by-ERA5-full-report.pdf" rel="noreferrer" target="_blank">Evenflow+24</a>] Evenflow, ‚ÄòThe value generated by ERA5‚Äô, Copernicus Climate Change Service (C3S), Bonn, Germany, Dec. 2024.</p>
<p>[<a class="reference external" href="https://doi.org/10.24381/cds.6c68c9bb" rel="noreferrer" target="_blank">AgERA5 dataset</a>] H. Boogaard, J. Schubert, A. de Wit, J. Lazebnik, R. Hutjes, and G. van der Grijn, ‚ÄòAgrometeorological indicators from 1979 to present derived from reanalysis‚Äô. Copernicus Climate Change Service (C3S) Climate Data Store (CDS), Jan. 30, 2020. doi: 10.24381/cds.6c68c9bb.</p>
<p>[<a class="reference external" href="https://climate.copernicus.eu/sites/default/files/custom-uploads/7th%20GA%20C3S/Presentations/Day%203/S1/05-s19.06.24_AgERA5UserPerspective_AllarddeWit_v1.pdf" rel="noreferrer" target="_blank">De Wit+24</a>] A. de Wit, H. Boogaard, S. Hoek, and E. M√ºller, ‚ÄòClimate Services for Agriculture ‚Äì A user perspective on AgERA5‚Äô, presented at the 7th C3S General Assembly, Brussels, Belgium, June 19, 2024.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.eja.2021.126419" rel="noreferrer" target="_blank">Araghi+22</a>] A. Araghi, C. J. Martinez, and J. E. Olesen, ‚ÄòEvaluation of multiple gridded solar radiation data for crop modeling‚Äô, European Journal of Agronomy, vol. 133, p. 126419, Feb. 2022, doi: 10.1016/j.eja.2021.126419.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.asr.2023.02.006" rel="noreferrer" target="_blank">Hasan Karaman+23</a>] √á. Hasan Karaman and Z. Aky√ºrek, ‚ÄòEvaluation of near-surface air temperature reanalysis datasets and downscaling with machine learning based Random Forest method for complex terrain of Turkey‚Äô, Advances in Space Research, vol. 71, no. 12, pp. 5256‚Äì5281, June 2023, doi: 10.1016/j.asr.2023.02.006.</p>
<p>[<a class="reference external" href="https://doi.org/10.17159/sajs.2024/16043" rel="noreferrer" target="_blank">Kruger+24</a>] J. A. Kruger, S. J. Roffe, and A. J. van der Walt, ‚ÄòAgERA5 representation of seasonal mean and extreme temperatures in the Northern Cape, South Africa‚Äô, South African Journal of Science, vol. 120, no. 3‚Äì4, pp. 1‚Äì13, Mar. 2024, doi: 10.17159/sajs.2024/16043.</p>
<p>[<a class="reference external" href="https://doi.org/10.1175/JAMC-D-23-0227.1" rel="noreferrer" target="_blank">Esquivel-Arriaga+24</a>] G. Esquivel-Arriaga et al., ‚ÄòPerformance Evaluation of Global Precipitation Datasets in Northern Mexico Drylands‚Äô, Journal of Applied Meteorology and Climatology, vol. 63, no. 12, pp. 1545‚Äì1558, Dec. 2024, doi: 10.1175/JAMC-D-23-0227.1.</p>
<p>[<a class="reference external" href="https://doi.org/10.1109/MERCon63886.2024.10689062" rel="noreferrer" target="_blank">Suraweera+24</a>] B. Suraweera, K. De Silva, L. Gunawardhana, and L. Rajapakse, ‚ÄòEvaluation of Satellite Rainfall Estimates for Surface Runoff Modelling in the Maha Oya Basin, Sri Lanka‚Äô, in 2024 Moratuwa Engineering Research Conference (MERCon), Aug. 2024, pp. 67‚Äì72. doi: 10.1109/MERCon63886.2024.10689062.</p>
<p>[<a class="reference external" href="https://doi.org/10.3390/hydrology12070161" rel="noreferrer" target="_blank">Garbanzo+25</a>] G. Garbanzo et al., ‚ÄòAddressing Weather Data Gaps in Reference Crop Evapotranspiration Estimation: A Case Study in Guinea-Bissau, West Africa‚Äô, Hydrology, vol. 12, no. 7, p. 161, June 2025, doi: 10.3390/hydrology12070161.</p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.ejrh.2025.102531" rel="noreferrer" target="_blank">Garcia-Prats+25</a>] A. Garcia-Prats et al., ‚ÄòHigh-resolution spatially interpolated FAO Penman-Monteith crop reference evapotranspiration maps of Sicily Island (Italy) and Jucar River system (Spain) using AgERA5 and ERA5-Land reanalysis datasets‚Äô, Journal of Hydrology: Regional Studies, vol. 60, p. 102531, Aug. 2025, doi: 10.1016/j.ejrh.2025.102531.</p>
<p>[<a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">Allen+98</a>] R. G. Allen, L. S. Pereira, D. Raes, and M. Smith, Crop evapotranspiration ‚Äì Guidelines for computing crop water requirements. in FAO Irrigation and drainage papers, no. 56. Rome, Italy: FAO ‚Äì Food and Agriculture Organization of the United Nations, 1998. Accessed: Nov. 24, 2025. [Online]. Available: <a class="reference external" href="https://www.fao.org/4/x0490e/x0490e00.htm" rel="noreferrer" target="_blank">https://www.fao.org/4/x0490e/x0490e00.htm</a></p>
<p>[<a class="reference external" href="https://doi.org/10.1016/j.agsy.2018.05.002" rel="noreferrer" target="_blank">Ceglar+19</a>] A. Ceglar et al., ‚ÄòImproving WOFOST model to simulate winter wheat phenology in Europe: Evaluation and effects on yield‚Äô, Agricultural Systems, vol. 168, pp. 168‚Äì180, Jan. 2019, doi: 10.1016/j.agsy.2018.05.002.</p>
<p>[<a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">De Wit+20</a>] A. J. W. de Wit, H. L. Boogaard, I. Supit, and M. van den Berg, ‚ÄòSystem description of the WOFOST 7.2 cropping systems model‚Äô, Wageningen Environmental Research, May 2020. [Online]. Available: <a class="reference external" href="https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model" rel="noreferrer" target="_blank">https://research.wur.nl/en/publications/system-description-of-the-wofost-72-cropping-systems-model</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Indicators"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="indicator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Indicators</p>
      </div>
    </a>
    <a class="right-next"
       href="../Derived_Datasets/derived.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Derived Datasets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-agricultural-yield-estimation-based-on-reanalysis-data">üåç Use case: Agricultural yield estimation based on reanalysis data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading">Data downloading</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-pre-processing">Data (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-variables">Derived variables</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">2. Download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">General setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#agera5">AgERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5-land">ERA5-Land</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulated-data-from-era5-land">Accumulated data from ERA5-Land</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-statistics-from-the-post-processed-era5-land-dataset">Daily statistics from the post-processed ERA5-Land dataset</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonise-datasets">Harmonise datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-alignment">Grid alignment</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-variable-names">Units and variable names</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Derived variables</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#point-by-point-comparison">Point-by-point comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-comparison">Time series comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#geospatial-comparison">Geospatial comparison</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-conclusions">Discussion and Conclusions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>