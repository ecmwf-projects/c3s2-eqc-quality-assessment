
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Assessment of the resolution of surface albedo satellite data for monitoring the Sahara desert &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_resolution_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Assessment of the resolution of surface albedo satellite data for monitoring the Sahara desert</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_resolution_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-albedo_resolution_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessment of the resolution of surface albedo satellite data for monitoring the Sahara desert</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-estimating-desertification-using-surface-albedo-data">üåç Use case: Estimating desertification using surface albedo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-relevant-packages">Import all the relevant packages</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-and-preparation">2. Data loading and preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-monthly-albedo-data">Load monthly albedo data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-inspection-and-sahara-albedo-extraction">Dataset inspection and Sahara albedo extraction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qflag-filtering-plot-helpers">QFLAG filtering + Plot helpers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">3. Plot and describe the results.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sahara-study-area-maps-with-country-names">Sahara study area maps with country names</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-and-visualizing-sahara-desert-expansion-from-albedo-ndjf-20062019">Detecting and Visualizing Sahara Desert Expansion from Albedo (NDJF, 2006‚Üí2019)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-desertification-by-country-within-the-sahara-study-domain">Quantifying desertification by country within the Sahara study domain</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-new-desert-pixels-and-inspect-their-values">Validate ‚Äúnew-desert‚Äù pixels and inspect their values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="assessment-of-the-resolution-of-surface-albedo-satellite-data-for-monitoring-the-sahara-desert">
<h1><span class="section-number">1.2.1. </span>Assessment of the resolution of surface albedo satellite data for monitoring the Sahara desert<a class="headerlink" href="#assessment-of-the-resolution-of-surface-albedo-satellite-data-for-monitoring-the-sahara-desert" title="Link to this heading">#</a></h1>
<p>¬†</p>
<p>Production date: 30-09-2024</p>
<p>Produced by: Consiglio Nazionale delle Ricerche (<a class="reference external" href="https://www.cnr.it/en" rel="noreferrer" target="_blank">CNR</a>
)</p>
<section id="use-case-estimating-desertification-using-surface-albedo-data">
<h2>üåç Use case: Estimating desertification using surface albedo data<a class="headerlink" href="#use-case-estimating-desertification-using-surface-albedo-data" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>‚Ä¢ Can satellite albedo datasets be used to estimate the expansion of the Sahara desert?</strong></p>
<p>The Sahara, Earth‚Äôs largest hot desert, has expanded in recent decades. Existing studies indicates a sustained enlargement of the dry zone on both annual and seasonal timescales [1]. This implies risks to ecosystems, pastoral livelihoods, food and water security, and infrastructure across North and West Africa. Multiple regional studies document intensified desertification pressures in precisely the areas our analysis targets: sand‚Äêdune encroachment around Nouakchott in Mauritania [2]; degradation and desertification sensitivity along the Algerian steppe, Sahara margin, where large‚Äêscale countermeasures such as the ‚ÄúGreen Dam‚Äù have been evaluated [3]; dune reactivation and wind‚Äêerosion impacts in Niger [4]; active dune migration in the Libyan UbƒÅrƒ´ Sand Sea [5]; and increased mobile dunes around Lake Chad and northern Chad since the 1970s [6].
In this assessment, we test whether satellite‚Äêderived surface albedo from the Copernicus CDS (10-daily, 1-km; SPOT-VGT/PROBA-V, v2) can monitor desert expansion signals by mapping spatial albedo patterns and their changes comparing the data for two year, the winter season 2006-2007 and 2019-2020 (November to February, NDJF). Evaluating desertification during the NDJF[FM1.1] (November-January-February) period is crucial because this is often the dry season in many regions, making it the most vulnerable time for desertification to worsen. Albedo is a suitable proxy for surface state in arid lands because brightening often accompanies exposure or stabilization of bare sands and crusts, while darkening may reflect seasonal greening or increased surface moisture. Using seasonally consistent composites and quality screening, we quantify ‚Äúdesert-like‚Äù area via albedo masks and compute area changes on the native grid. The results reveal a small net increase in very bright desert‚Äêlike area across the Sahara, with the largest gains concentrated in the western‚Äìcentral Sahara (notably Mali and Mauritania), [FM2.1]aligning with the independent evidence cited above [1‚Äì6]. This supports the use of CDS surface albedo data as a powerful tool for monitoring desertification dynamics and regional hotspots of change.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The seasonal albedo maps provide a clear, side-by-side view of surface reflectance in two benchmark years, making spatial changes in bright, desert-like areas easy to spot.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The methodology adopted for the analysis is split into the following steps:</p>
<p><a class="reference internal" href="#satellite-satellite-albedo-resolution-q04-section-1"><span class="std std-ref">1. Choose the data to use and set up the code</span></a></p>
<ul class="simple">
<li><p>Import all the relevant packages.</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-albedo-resolution-q04-section-2"><span class="std std-ref">2. Data loading and preparation</span></a></p>
<ul class="simple">
<li><p>Load monthly albedo data</p></li>
<li><p>Dataset inspection and Sahara albedo extraction</p></li>
<li><p>QFLAG filtering + Plot helpers
<a class="reference internal" href="#satellite-satellite-albedo-resolution-q04-section-3"><span class="std std-ref">3. Plot and describe the results.</span></a></p></li>
<li><p>Sahara study area maps with country names</p></li>
<li><p>Detecting and Visualizing Sahara Desert Expansion from Albedo (NDJF, 2006‚Üí2019)</p></li>
<li><p>Quantifying Desertification by Country within the Sahara Study Domain</p></li>
<li><p>Validate ‚Äúnew-desert‚Äù pixels and inspect their values</p></li>
<li><p>Pixel count analysis of albedo map plots ‚Äì Summer 2006 vs 2019</p></li>
<li><p>Plot albedo change map (2019 ‚àí 2006)</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-albedo-resolution-q04-section-4"><span class="std std-ref">Take-home messages</span></a></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-albedo-resolution-q04-section-1"></span><h3>1. Choose the data to use and set up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-the-relevant-packages">
<h4>Import all the relevant packages<a class="headerlink" href="#import-all-the-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages required to run the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">diagnostics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">TwoSlopeNorm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">LineString</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapereader</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-loading-and-preparation">
<span id="satellite-satellite-albedo-resolution-q04-section-2"></span><h3>2. Data loading and preparation<a class="headerlink" href="#data-loading-and-preparation" title="Link to this heading">#</a></h3>
<section id="load-monthly-albedo-data">
<h4>Load monthly albedo data<a class="headerlink" href="#load-monthly-albedo-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-albedo&quot;</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;albb_bh&quot;</span><span class="p">,</span>          
    <span class="s2">&quot;product_version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;nominal_day&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
    <span class="c1"># Sahara (central belt): [north, west, south, east]</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">requests</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;spot&quot;</span><span class="p">:</span>  <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2014</span><span class="p">)],</span> <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span> <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">},</span>
    <span class="s2">&quot;proba&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">2021</span><span class="p">)],</span> <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;1km&quot;</span><span class="p">,</span> <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;vgt&quot;</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">maps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">series</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">annual_maps</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">satellite</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">request</span> <span class="o">=</span> <span class="n">common_request</span> <span class="o">|</span> <span class="n">req</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">}</span>
    <span class="n">series</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[],</span>
    <span class="p">)</span>

    <span class="n">maps</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">,</span>  <span class="c1"># monthly‚Üíperiod mean</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">annual_maps</span><span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">annual_weighted_mean</span><span class="p">,</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>satellite=&#39;spot&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 8/8 [00:00&lt;00:00,  9.86it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/readers/netcdf/fieldlist.py:202: FutureWarning: In a future version of xarray the default value for data_vars will change from data_vars=&#39;all&#39; to data_vars=None. This is likely to lead to different results when multiple datasets have matching variables with overlapping values. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set data_vars explicitly.
  return xr.open_mfdataset(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>satellite=&#39;proba&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 7/7 [00:00&lt;00:00, 41.57it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/readers/netcdf/fieldlist.py:202: FutureWarning: In a future version of xarray the default value for data_vars will change from data_vars=&#39;all&#39; to data_vars=None. This is likely to lead to different results when multiple datasets have matching variables with overlapping values. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set data_vars explicitly.
  return xr.open_mfdataset(
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset-inspection-and-sahara-albedo-extraction">
<h4>Dataset inspection and Sahara albedo extraction<a class="headerlink" href="#dataset-inspection-and-sahara-albedo-extraction" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== </span><span class="si">{</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>                 <span class="c1"># dims, coords, data_vars</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="s2">&quot;spot&quot;</span><span class="p">][</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;2006-06-10&quot;</span><span class="p">)</span>
<span class="n">df_map</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== SPOT ===
&lt;xarray.Dataset&gt; Size: 20GB
Dimensions:       (time: 96, latitude: 1456, longitude: 3920)
Coordinates:
  * time          (time) datetime64[ns] 768B 2006-01-10 ... 2013-12-10
  * latitude      (latitude) float64 12kB 28.0 27.99 27.98 ... 15.03 15.02 15.01
  * longitude     (longitude) float64 31kB -10.0 -9.991 -9.982 ... 24.98 24.99
Data variables:
    crs           (time) |S1 96B b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; ... b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39;
    AL_BH_BB      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_BB_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_NI      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_NI_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_VI      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_VI_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AGE           (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    NMOD          (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    QFLAG         (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
Attributes: (12/23)
    time_coverage_end:    2006-01-10T23:59:59Z
    time_coverage_start:  2005-12-21T00:00:00Z
    platform:             SPOT-5
    sensor:               VEGETATION-2
    Conventions:          CF-1.6
    archive_facility:     VITO
    ...                   ...
    source:               Derived from EO satellite imagery
    title:                10 daily broadband hemispherical surface albedo der...
    creator_name:         Iskander Benhadj
    creator_email:        iskander.benhadj@vito.be
    project:              C3S_312b_Lot5
    date_created:         2021-03-24

=== PROBA ===
&lt;xarray.Dataset&gt; Size: 16GB
Dimensions:       (time: 78, latitude: 1456, longitude: 3920)
Coordinates:
  * time          (time) datetime64[ns] 624B 2014-01-10 ... 2020-06-10
  * latitude      (latitude) float64 12kB 28.0 27.99 27.98 ... 15.03 15.02 15.01
  * longitude     (longitude) float64 31kB -10.0 -9.991 -9.982 ... 24.98 24.99
Data variables:
    crs           (time) |S1 78B b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; ... b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39; b&#39;&#39;
    AL_BH_BB      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_BB_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_NI      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_NI_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_VI      (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AL_BH_VI_ERR  (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    AGE           (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    NMOD          (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
    QFLAG         (time, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1456, 3920), meta=np.ndarray&gt;
Attributes: (12/23)
    time_coverage_end:    2014-01-10T23:59:59Z
    time_coverage_start:  2013-12-21T00:00:00Z
    platform:             PROBA-V
    sensor:               VEGETATION
    Conventions:          CF-1.6
    archive_facility:     VITO
    ...                   ...
    source:               Derived from EO satellite imagery
    title:                10 daily broadband hemispherical surface albedo der...
    creator_name:         Iskander Benhadj
    creator_email:        iskander.benhadj@vito.be
    project:              C3S_312b_Lot5
    date_created:         2021-03-31
</pre></div>
</div>
</div>
</div>
</section>
<section id="qflag-filtering-plot-helpers">
<h4>QFLAG filtering + Plot helpers<a class="headerlink" href="#qflag-filtering-plot-helpers" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">qc_bits47</span><span class="p">(</span><span class="n">da_albedo</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">qflag</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Keep pixels where:</span>
<span class="sd">      Bit 4 == 0  (no missing/invalid input)</span>
<span class="sd">      Bit 7 == 0  (albedo processing OK)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">qflag</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="n">bit4_ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="o">&amp;</span> <span class="mi">16</span><span class="p">)</span>  <span class="o">==</span> <span class="mi">0</span>     <span class="c1"># 2**4</span>
    <span class="n">bit7_ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="o">&amp;</span> <span class="mi">128</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>     <span class="c1"># 2**7</span>
    <span class="k">return</span> <span class="n">da_albedo</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bit4_ok</span> <span class="o">&amp;</span> <span class="n">bit7_ok</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">seasonal_mean_bits47</span><span class="p">(</span><span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">also_require_bb_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;QC (bits 4 &amp; 7 [+ optional bit 9]) ‚Üí select months in `year` ‚Üí mean over time.&quot;&quot;&quot;</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;AL_BH_BB&quot;</span><span class="p">]</span>
    <span class="n">q</span>  <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;QFLAG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
    <span class="c1"># base QC</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="p">((</span><span class="n">q</span> <span class="o">&amp;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">q</span> <span class="o">&amp;</span> <span class="mi">128</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>        <span class="c1"># bits 4 and 7 clear</span>
    <span class="k">if</span> <span class="n">also_require_bb_ok</span><span class="p">:</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="n">ok</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">q</span> <span class="o">&amp;</span> <span class="mi">256</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>                 <span class="c1"># bit 9 clear</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">months</span><span class="p">),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sel</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_extent</span><span class="p">(</span><span class="n">da</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
    <span class="n">lon0</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">lat0</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span>  <span class="nb">float</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">lon0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lon1</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">lat1</span> <span class="o">+</span> <span class="n">pad</span><span class="p">]</span>
<span class="k">def</span><span class="w"> </span><span class="nf">panel_map</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">thr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valid_mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">thr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="n">thr</span><span class="p">],</span>
                             <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">thr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="c1"># labels on left &amp; bottom only (since colorbar is on the right)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                      <span class="n">x_inline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y_inline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span>  <span class="o">=</span> <span class="kc">True</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">bottom_labels</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">im</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gridcell_areas_km2</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">6371.0088</span>
    <span class="n">latr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">);</span> <span class="n">lonr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">lat_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">latr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">latr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">latr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                            <span class="p">(</span><span class="n">latr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">latr</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">latr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">latr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">latr</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">lon_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">lonr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">lonr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lonr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                            <span class="p">(</span><span class="n">lonr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lonr</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                                <span class="p">[</span><span class="n">lonr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">lonr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lonr</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">lat1</span><span class="p">,</span> <span class="n">lat2</span> <span class="o">=</span> <span class="n">lat_e</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][:,</span><span class="kc">None</span><span class="p">],</span> <span class="n">lat_e</span><span class="p">[</span><span class="mi">1</span><span class="p">:][:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">lon1</span><span class="p">,</span> <span class="n">lon2</span> <span class="o">=</span> <span class="n">lon_e</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="kc">None</span><span class="p">,:],</span> <span class="n">lon_e</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="kc">None</span><span class="p">,:]</span>
    <span class="k">return</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lon2</span><span class="o">-</span><span class="n">lon1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="plot-and-describe-the-results">
<span id="satellite-satellite-albedo-resolution-q04-section-3"></span><h3>3. Plot and describe the results.<a class="headerlink" href="#plot-and-describe-the-results" title="Link to this heading">#</a></h3>
<section id="sahara-study-area-maps-with-country-names">
<h4>Sahara study area maps with country names<a class="headerlink" href="#sahara-study-area-maps-with-country-names" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BBOX</span> <span class="o">=</span> <span class="p">[</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">BBOX</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">study_poly</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">study_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span><span class="p">[</span><span class="n">study_poly</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>

<span class="n">shp</span> <span class="o">=</span> <span class="n">shapereader</span><span class="o">.</span><span class="n">natural_earth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cultural&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;admin_0_countries&quot;</span><span class="p">)</span>
<span class="n">countries</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">name_col</span> <span class="o">=</span> <span class="s2">&quot;NAME_EN&quot;</span> <span class="k">if</span> <span class="s2">&quot;NAME_EN&quot;</span> <span class="ow">in</span> <span class="n">countries</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s2">&quot;NAME&quot;</span>

<span class="n">target_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Mali&quot;</span><span class="p">,</span> <span class="s2">&quot;Mauritania&quot;</span><span class="p">,</span> <span class="s2">&quot;Algeria&quot;</span><span class="p">,</span> <span class="s2">&quot;Niger&quot;</span><span class="p">,</span> <span class="s2">&quot;Libya&quot;</span><span class="p">,</span> <span class="s2">&quot;Chad&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Western Sahara&quot;</span><span class="p">,</span> <span class="s2">&quot;Morocco&quot;</span><span class="p">,</span> <span class="s2">&quot;Burkina Faso&quot;</span><span class="p">,</span> <span class="s2">&quot;Sudan&quot;</span><span class="p">,</span> <span class="s2">&quot;Egypt&quot;</span>
<span class="p">}</span>

<span class="n">countries</span> <span class="o">=</span> <span class="n">countries</span><span class="p">[</span><span class="n">countries</span><span class="p">[</span><span class="n">name_col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">target_names</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">countries</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">study_poly</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">countries</span><span class="p">[</span><span class="s2">&quot;geom_clip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">countries</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">study_poly</span><span class="p">)</span>
<span class="n">countries</span> <span class="o">=</span> <span class="n">countries</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;geom_clip&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">countries</span><span class="p">[</span><span class="s2">&quot;rep_pt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">countries</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">representative_point</span><span class="p">()</span>
<span class="n">countries</span><span class="p">[</span><span class="s2">&quot;NAME_USE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">countries</span><span class="p">[</span><span class="n">name_col</span><span class="p">]</span>
<span class="n">manual_pos</span> <span class="o">=</span> <span class="p">{</span>
   
    <span class="s2">&quot;Western Sahara&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">9.6</span><span class="p">,</span> <span class="mf">24.9</span><span class="p">),</span>  
    <span class="s2">&quot;Morocco&quot;</span><span class="p">:</span>        <span class="p">(</span><span class="o">-</span><span class="mf">9.8</span><span class="p">,</span> <span class="mf">27.3</span><span class="p">),</span>  
    <span class="s2">&quot;Egypt&quot;</span><span class="p">:</span>          <span class="p">(</span><span class="mf">24.4</span><span class="p">,</span> <span class="mf">26.0</span><span class="p">),</span>  
    <span class="s2">&quot;Sudan&quot;</span><span class="p">:</span>          <span class="p">(</span><span class="mf">24.3</span><span class="p">,</span> <span class="mf">16.6</span><span class="p">),</span>  
<span class="p">}</span>

<span class="n">nudges</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Burkina Faso&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">),</span>
    <span class="s2">&quot;Mauritania&quot;</span><span class="p">:</span>   <span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">outside_labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">proj</span><span class="p">},</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">35</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>  <span class="c1"># [W, E, S, N]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">study_gdf</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Sahara Context with Study Area&quot;</span><span class="p">)</span>
<span class="n">gl1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">gl1</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl1</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># --- Right: zoomed study area with country names</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">study_gdf</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">countries</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dimgray&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>


<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">countries</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;NAME_USE&quot;</span><span class="p">]</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;rep_pt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;rep_pt&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">y</span>

   
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">manual_pos</span><span class="p">:</span>
        <span class="n">x_lab</span><span class="p">,</span> <span class="n">y_lab</span> <span class="o">=</span> <span class="n">manual_pos</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">nudges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
        <span class="n">x_lab</span><span class="p">,</span> <span class="n">y_lab</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dy</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">outside_labels</span><span class="p">:</span>
        <span class="n">x_out</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="mf">0.6</span>  <span class="c1"># outside right margin</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x_out</span> <span class="o">-</span> <span class="mf">0.15</span><span class="p">],</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y_lab</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">x_lab</span> <span class="o">=</span> <span class="n">x_out</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">x_lab</span><span class="p">,</span> <span class="n">y_lab</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round,pad=0.2&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">),</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Study Area with Country Names&quot;</span><span class="p">)</span>
<span class="n">gl2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">gl2</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl2</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/993be6b54652f096c3a21e5a8b9f30932eecc02cd6ede8a7810ed0b459838c81.png" src="../../_images/993be6b54652f096c3a21e5a8b9f30932eecc02cd6ede8a7810ed0b459838c81.png" />
</div>
</div>
<p><em>Figure 1.</em> Study domain for the Sahara analysis. Left: West Africa context with the red rectangle showing the bounding box used for data extraction (28¬∞N‚Äì15¬∞N, 10¬∞W‚Äì25¬∞E; Plate Carr√©e). Right: Zoomed view of the box with national borders and labels (Morocco, Western Sahara, Mauritania, Mali, Algeria, Niger, Libya, Chad, Sudan, Egypt, and Burkina Faso) to indicate where changes are assessed.</p>
</section>
<section id="detecting-and-visualizing-sahara-desert-expansion-from-albedo-ndjf-20062019">
<h4>Detecting and Visualizing Sahara Desert Expansion from Albedo (NDJF, 2006‚Üí2019)<a class="headerlink" href="#detecting-and-visualizing-sahara-desert-expansion-from-albedo-ndjf-20062019" title="Link to this heading">#</a></h4>
<p>We build NDJF (Nov‚ÄìFeb) albedo composites for two epochs‚Äî2006 from SPOT and 2019 from PROBA‚Äîusing the same QC mask (Bits 4 &amp; 7) via seasonal_mean_bits47. If 2019 NDJF is incomplete, we fall back to the latest available PROBA year. We then restrict all comparisons to the common valid footprint (valid_both). Pixel-wise change is computed as Œî = PROBA ‚àí SPOT. A pixel is flagged as ‚Äúnew desert‚Äù when (i) it was not desert in 2006, (ii) it is desert in 2019, and (iii) it brightened by at least min_delta = 0.02. ‚ÄúDesert‚Äù here means broadband hemispherical albedo &gt; thr = 0.35. For context, we also mark pixels that brightened by &gt;0.02 but remained below the threshold. Finally, the figure shows: (top left/right) the two NDJF albedo maps on a shared color scale with the threshold contour; and (bottom) a change map where red pixels are ‚Äúnew desert‚Äù (crossed the threshold), and pale yellow pixels brightened but stayed sub-threshold. Grid labels are placed on the left of the SPOT map and the right of the PROBA map for readability, and a single colorbar applies to both top panels.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">gs</span>  <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span>
    <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>      <span class="c1"># narrow right column for colorbar</span>
    <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span>
    <span class="n">hspace</span><span class="o">=</span><span class="mf">0.28</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Sahara ‚Äî NDJF Albedo (QC: Bits 4 &amp; 7) ‚Äî Left: </span><span class="si">{</span><span class="n">year_spot</span><span class="si">}</span><span class="s2"> (SPOT) | Right: </span><span class="si">{</span><span class="n">year_proba</span><span class="si">}</span><span class="s2"> (PROBA)&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span>
<span class="p">)</span>


<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">_</span>   <span class="o">=</span> <span class="n">panel_map</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">spot_map</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_spot</span><span class="si">}</span><span class="s2"> (SPOT)&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">thr</span><span class="o">=</span><span class="n">thr</span><span class="p">,</span> <span class="n">valid_mask</span><span class="o">=</span><span class="n">valid_both</span><span class="p">)</span>


<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">panel_map</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">proba_map</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_proba</span><span class="si">}</span><span class="s2"> (PROBA)&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">thr</span><span class="o">=</span><span class="n">thr</span><span class="p">,</span> <span class="n">valid_mask</span><span class="o">=</span><span class="n">valid_both</span><span class="p">)</span>

<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Albedo&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">binary_dilation</span>


<span class="n">YELLOW_GROW_ITERS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">yellow_big</span> <span class="o">=</span> <span class="n">binary_dilation</span><span class="p">(</span><span class="n">brightened_below_thr</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">YELLOW_GROW_ITERS</span><span class="p">)</span>


<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:],</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s2">&quot;10m&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New desert (NDJF): crossed </span><span class="si">{</span><span class="n">thr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> and brightened by &gt; </span><span class="si">{</span><span class="n">min_delta</span><span class="si">:</span><span class="s2">.02f</span><span class="si">}</span><span class="s2">   ‚Äî   </span><span class="si">{</span><span class="n">year_spot</span><span class="si">}</span><span class="s2"> ‚Üí </span><span class="si">{</span><span class="n">year_proba</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spot_map</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">spot_map</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
               <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">valid_both</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
               <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>


<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nd_lon</span><span class="p">,</span> <span class="n">nd_lat</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#d73027&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;New desert: crossed &gt; threshold&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">br_lon</span><span class="p">,</span> <span class="n">br_lat</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#ffd27f&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Brightened (&lt; threshold)&quot;</span><span class="p">)</span>

<span class="n">gl3</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">x_inline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y_inline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">gl3</span><span class="o">.</span><span class="n">top_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="n">gl3</span><span class="o">.</span><span class="n">left_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">;</span> <span class="n">gl3</span><span class="o">.</span><span class="n">right_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">;</span> <span class="n">gl3</span><span class="o">.</span><span class="n">bottom_labels</span><span class="o">=</span><span class="kc">True</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/2c454ffe47c92ab6523b80920633a9188e14321122594a875ec24ceae0991037.png" src="../../_images/2c454ffe47c92ab6523b80920633a9188e14321122594a875ec24ceae0991037.png" />
</div>
</div>
<p><em>Figure 2.</em> NDJF (Nov‚ÄìFeb) broadband albedo over the Sahara in 2006 (SPOT, left) and 2019 (PROBA-V, right) after quality control (QFLAG bits 4 &amp; 7: valid inputs and algorithm success). The lower panel highlights change between the two epochs: red pixels brightened by &gt;0.02 and crossed above the 0.35 threshold (‚Äúnew desert‚Äù), while yellow pixels brightened by &gt;0.02 but remained below the threshold. Only the footprint valid in both years is considered.</p>
</section>
<section id="quantifying-desertification-by-country-within-the-sahara-study-domain">
<h4>Quantifying desertification by country within the Sahara study domain<a class="headerlink" href="#quantifying-desertification-by-country-within-the-sahara-study-domain" title="Link to this heading">#</a></h4>
<p>To quantify desertification in each country inside the Sahara study domain, we (i) mapped pixels that became newly ‚Äúdesert-like‚Äù between 2006 and 2019 (crossing an albedo threshold in 2019 but not in 2006) after quality control, (ii) summed those pixels to km¬≤ using an equal-area projection, and (iii) normalized by each country‚Äôs own area within the study box to report an interpretable percentage of its in-box territory affected. To avoid distorted ratios from tiny border slivers, we filtered out countries with &lt;10,000 km¬≤ inside the box. The resulting km¬≤ and % values reflect intensity of change within each country across the analyzed portion of the desert.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BBOX</span> <span class="o">=</span> <span class="p">[</span><span class="mf">28.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">BBOX</span>
<span class="n">study_poly</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>


<span class="n">df_cty</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mali&quot;</span><span class="p">,</span><span class="s2">&quot;Mauritania&quot;</span><span class="p">,</span><span class="s2">&quot;Algeria&quot;</span><span class="p">,</span><span class="s2">&quot;Niger&quot;</span><span class="p">,</span><span class="s2">&quot;Libya&quot;</span><span class="p">,</span><span class="s2">&quot;Chad&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Western Sahara&quot;</span><span class="p">,</span><span class="s2">&quot;Morocco&quot;</span><span class="p">,</span><span class="s2">&quot;Burkina Faso&quot;</span><span class="p">,</span><span class="s2">&quot;Sudan&quot;</span><span class="p">,</span><span class="s2">&quot;Egypt&quot;</span><span class="p">],</span>
    <span class="s2">&quot;new_bright_km2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">37448</span><span class="p">,</span><span class="mi">20062</span><span class="p">,</span><span class="mi">18596</span><span class="p">,</span><span class="mi">7164</span><span class="p">,</span><span class="mi">3986</span><span class="p">,</span><span class="mi">3826</span><span class="p">,</span><span class="mi">364</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">13</span><span class="p">]</span>
<span class="p">})</span>


<span class="n">MIN_AREA_IN_BBOX</span> <span class="o">=</span> <span class="mi">10_000</span>


<span class="n">EQUAL_AREA</span> <span class="o">=</span> <span class="s2">&quot;EPSG:6933&quot;</span>

<span class="n">shp</span> <span class="o">=</span> <span class="n">shapereader</span><span class="o">.</span><span class="n">natural_earth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;50m&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;cultural&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;admin_0_countries&quot;</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">name_col</span> <span class="o">=</span> <span class="s2">&quot;NAME_EN&quot;</span> <span class="k">if</span> <span class="s2">&quot;NAME_EN&quot;</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="s2">&quot;NAME&quot;</span>

<span class="n">targets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_cty</span><span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">])</span>


<span class="n">gdf_targets</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="n">name_col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">targets</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">gdf_targets_eq</span> <span class="o">=</span> <span class="n">gdf_targets</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">EQUAL_AREA</span><span class="p">)</span>
<span class="n">gdf_targets_eq</span><span class="p">[</span><span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf_targets_eq</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mf">1e6</span>
<span class="n">areas_total</span> <span class="o">=</span> <span class="n">gdf_targets_eq</span><span class="p">[[</span><span class="n">name_col</span><span class="p">,</span> <span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">name_col</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">})</span>


<span class="n">gdf_clip</span> <span class="o">=</span> <span class="n">gdf_targets</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">gdf_clip</span><span class="p">[</span><span class="s2">&quot;geom_clip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf_clip</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">study_poly</span><span class="p">)</span>
<span class="n">gdf_clip</span> <span class="o">=</span> <span class="n">gdf_clip</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&quot;geom_clip&quot;</span><span class="p">)</span>


<span class="n">gdf_clip</span> <span class="o">=</span> <span class="n">gdf_clip</span><span class="p">[</span><span class="o">~</span><span class="n">gdf_clip</span><span class="o">.</span><span class="n">is_empty</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">gdf_clip_eq</span> <span class="o">=</span> <span class="n">gdf_clip</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">EQUAL_AREA</span><span class="p">)</span>
<span class="n">gdf_clip_eq</span><span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf_clip_eq</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mf">1e6</span>
<span class="n">areas_bbox</span> <span class="o">=</span> <span class="n">gdf_clip_eq</span><span class="p">[[</span><span class="n">name_col</span><span class="p">,</span> <span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">name_col</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">})</span>


<span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_cty</span>
       <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">areas_bbox</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
       <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">areas_total</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">))</span>


<span class="n">out</span><span class="p">[</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">out</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">out</span><span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">]</span>


<span class="n">out</span><span class="p">[</span><span class="s2">&quot;pct_of_whole_country&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">out</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">out</span><span class="p">[</span><span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]</span>

<span class="n">full_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;new_bright_km2&quot;</span><span class="p">,</span> <span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">,</span> <span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span>
             <span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">,</span> <span class="s2">&quot;pct_of_whole_country&quot;</span><span class="p">]</span>
<span class="n">full_table</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">full_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">full_table</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_table</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">,</span> <span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]:</span>
    <span class="n">full_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span> <span class="s2">&quot;pct_of_whole_country&quot;</span><span class="p">]:</span>
    <span class="n">full_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FULL TABLE ‚Äî includes countries with tiny slices inside the box (may inflate %):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">full_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="n">stable</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">out</span><span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">MIN_AREA_IN_BBOX</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">stable</span><span class="p">[</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">stable</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">stable</span><span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">]</span>
<span class="n">stable</span><span class="p">[</span><span class="s2">&quot;pct_of_whole_country&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">stable</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">stable</span><span class="p">[</span><span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]</span>

<span class="n">stable_table</span> <span class="o">=</span> <span class="p">(</span><span class="n">stable</span><span class="p">[</span><span class="n">full_cols</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="n">stable_table</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stable_table</span><span class="p">[</span><span class="s2">&quot;new_bright_km2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;area_km2_in_bbox&quot;</span><span class="p">,</span> <span class="s2">&quot;area_km2_country_total&quot;</span><span class="p">]:</span>
    <span class="n">stable_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">stable_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span> <span class="s2">&quot;pct_of_whole_country&quot;</span><span class="p">]:</span>
    <span class="n">stable_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">stable_table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">STABLE REPORT ‚Äî filtered to countries with ‚â• </span><span class="si">{</span><span class="n">MIN_AREA_IN_BBOX</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> km¬≤ inside the study box:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stable_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="k">if</span> <span class="ow">not</span> <span class="n">stable_table</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">stable_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;pct_of_country_in_bbox&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">bullets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">top</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">bullets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;pct_of_country_in_bbox&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% of its study-area footprint &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;new_bright_km2&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> km¬≤ of </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;area_km2_in_bbox&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> km¬≤)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Summary (stable percentages):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bullets</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Note: percentages are relative to EACH COUNTRY‚ÄôS AREA within the study box; &quot;</span>
          <span class="s2">&quot;tiny-slice countries were excluded to avoid misleading high ratios.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FULL TABLE ‚Äî includes countries with tiny slices inside the box (may inflate %):
       country  new_bright_km2  area_km2_in_bbox  pct_of_country_in_bbox  area_km2_country_total  pct_of_whole_country
  Burkina Faso             181               424                   42.65                  272627                  0.07
          Mali           37448            880150                    4.25                 1254111                  2.99
    Mauritania           20062            500134                    4.01                 1035382                  1.94
       Morocco             323             13461                    2.40                  581713                  0.06
Western Sahara             364             15575                    2.34                   90593                  0.40
       Algeria           18596           1198624                    1.55                 2319300                  0.80
         Egypt              13              1324                    0.98                 1001772                  0.00
         Niger            7164            887120                    0.81                 1181186                  0.61
          Chad            3826            664675                    0.58                 1266547                  0.30
         Libya            3986            978683                    0.41                 1623739                  0.25
         Sudan              99             69086                    0.14                 1856671                  0.01

STABLE REPORT ‚Äî filtered to countries with ‚â• 10,000 km¬≤ inside the study box:
       country  new_bright_km2  area_km2_in_bbox  pct_of_country_in_bbox  area_km2_country_total  pct_of_whole_country
          Mali           37448            880150                    4.25                 1254111                  2.99
    Mauritania           20062            500134                    4.01                 1035382                  1.94
       Morocco             323             13461                    2.40                  581713                  0.06
Western Sahara             364             15575                    2.34                   90593                  0.40
       Algeria           18596           1198624                    1.55                 2319300                  0.80
         Niger            7164            887120                    0.81                 1181186                  0.61
          Chad            3826            664675                    0.58                 1266547                  0.30
         Libya            3986            978683                    0.41                 1623739                  0.25
         Sudan              99             69086                    0.14                 1856671                  0.01

Summary (stable percentages):
- Mali: 4.25% of its study-area footprint (37,448 km¬≤ of 880,150 km¬≤)
- Mauritania: 4.01% of its study-area footprint (20,062 km¬≤ of 500,134 km¬≤)
- Morocco: 2.40% of its study-area footprint (323 km¬≤ of 13,461 km¬≤)

Note: percentages are relative to EACH COUNTRY‚ÄôS AREA within the study box; tiny-slice countries were excluded to avoid misleading high ratios.
</pre></div>
</div>
</div>
</div>
</section>
<section id="validate-new-desert-pixels-and-inspect-their-values">
<h4>Validate ‚Äúnew-desert‚Äù pixels and inspect their values<a class="headerlink" href="#validate-new-desert-pixels-and-inspect-their-values" title="Link to this heading">#</a></h4>
<p>This cell turns the NDJF albedo maps for 2006 and 2019 into one table, keeps only pixels that are valid in both years, and then selects the ones that became desert by our rule (2019 albedo &gt; thr, 2006 albedo ‚â§ thr, and increase ‚â• min_delta). It then (a) counts how many pixels meet all three conditions, (b) summarizes their values with min/median/max and percentiles for 2006 albedo, 2019 albedo, and the change (Œî), and (c) prints a small random sample showing latitude, longitude, 2006 albedo, 2019 albedo, and Œî for quick spot-checks.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">to_df</span><span class="p">(</span><span class="n">da</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="n">a06</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">spot_map</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">spot_map</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">spot_map</span><span class="o">.</span><span class="n">longitude</span><span class="p">],</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">a19</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">proba_map</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">proba_map</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">proba_map</span><span class="o">.</span><span class="n">longitude</span><span class="p">],</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">dlt</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">a19</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">a06</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="n">msk</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">new_desert</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="n">vld</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">valid_both</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">a06</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">to_df</span><span class="p">(</span><span class="n">a06</span><span class="p">,</span> <span class="s2">&quot;albedo_2006&quot;</span><span class="p">),</span>
        <span class="n">to_df</span><span class="p">(</span><span class="n">a19</span><span class="p">,</span> <span class="s2">&quot;albedo_2019&quot;</span><span class="p">)[</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">],</span>
        <span class="n">to_df</span><span class="p">(</span><span class="n">dlt</span><span class="p">,</span> <span class="s2">&quot;delta&quot;</span><span class="p">)[</span><span class="s2">&quot;delta&quot;</span><span class="p">],</span>
        <span class="n">to_df</span><span class="p">(</span><span class="n">msk</span><span class="p">,</span> <span class="s2">&quot;new_desert&quot;</span><span class="p">)[</span><span class="s2">&quot;new_desert&quot;</span><span class="p">],</span>
        <span class="n">to_df</span><span class="p">(</span><span class="n">vld</span><span class="p">,</span> <span class="s2">&quot;valid_both&quot;</span><span class="p">)[</span><span class="s2">&quot;valid_both&quot;</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;valid_both and new_desert&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;new_desert&quot;</span><span class="p">,</span> <span class="s2">&quot;valid_both&quot;</span><span class="p">])</span>


<span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_2019_gt_thr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thr</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_2006_le_thr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2006&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">thr</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_delta_gt_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_delta</span>


<span class="n">cols_num</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;albedo_2006&quot;</span><span class="p">,</span> <span class="s2">&quot;albedo_2019&quot;</span><span class="p">,</span> <span class="s2">&quot;delta&quot;</span><span class="p">]</span>
<span class="n">df_display</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_display</span><span class="p">[</span><span class="n">cols_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_display</span><span class="p">[</span><span class="n">cols_num</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>


<span class="n">df_display</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latitude</th>
      <th>longitude</th>
      <th>albedo_2006</th>
      <th>albedo_2019</th>
      <th>delta</th>
      <th>check_2019_gt_thr</th>
      <th>check_2006_le_thr</th>
      <th>check_delta_gt_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>209</th>
      <td>28.0</td>
      <td>-8.13</td>
      <td>0.35</td>
      <td>0.37</td>
      <td>0.02</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>210</th>
      <td>28.0</td>
      <td>-8.12</td>
      <td>0.34</td>
      <td>0.36</td>
      <td>0.02</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>211</th>
      <td>28.0</td>
      <td>-8.12</td>
      <td>0.35</td>
      <td>0.37</td>
      <td>0.02</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1154</th>
      <td>28.0</td>
      <td>0.30</td>
      <td>0.32</td>
      <td>0.36</td>
      <td>0.04</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1155</th>
      <td>28.0</td>
      <td>0.31</td>
      <td>0.31</td>
      <td>0.35</td>
      <td>0.04</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1159</th>
      <td>28.0</td>
      <td>0.35</td>
      <td>0.32</td>
      <td>0.35</td>
      <td>0.03</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1160</th>
      <td>28.0</td>
      <td>0.36</td>
      <td>0.32</td>
      <td>0.36</td>
      <td>0.04</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1161</th>
      <td>28.0</td>
      <td>0.37</td>
      <td>0.32</td>
      <td>0.37</td>
      <td>0.05</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1162</th>
      <td>28.0</td>
      <td>0.38</td>
      <td>0.32</td>
      <td>0.37</td>
      <td>0.04</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1163</th>
      <td>28.0</td>
      <td>0.38</td>
      <td>0.32</td>
      <td>0.36</td>
      <td>0.04</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># All rows should pass these:</span>
<span class="n">n_all</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">n_good</span>  <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_2019_gt_thr&quot;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_2006_le_thr&quot;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;check_delta_gt_min&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New-desert rows: </span><span class="si">{</span><span class="n">n_all</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">  |  Fully consistent with rules: </span><span class="si">{</span><span class="n">n_good</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Albedo (2006) ‚Äî min/median/max:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2006&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2006&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2006&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Albedo (2019) ‚Äî min/median/max:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Delta         ‚Äî min/median/max:&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">95</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2"> 2006/2019/delta:&quot;</span><span class="p">,</span>
          <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;albedo_2006&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">100</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span>
          <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;albedo_2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">100</span><span class="p">),</span> <span class="mi">3</span><span class="p">),</span>
          <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">100</span><span class="p">),</span>       <span class="mi">3</span><span class="p">))</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span><span class="s2">&quot;albedo_2006&quot;</span><span class="p">,</span><span class="s2">&quot;albedo_2019&quot;</span><span class="p">,</span><span class="s2">&quot;delta&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>New-desert rows: 55,644  |  Fully consistent with rules: 55,644

Albedo (2006) ‚Äî min/median/max: 0.03830000013113022 0.335099995136261 0.3499999940395355
Albedo (2019) ‚Äî min/median/max: 0.3500000238418579 0.3654000163078308 0.5915249586105347
Delta         ‚Äî min/median/max: 0.02000001072883606 0.030000001192092896 0.47872495651245117
p05 2006/2019/delta: 0.308 0.352 0.021
p25 2006/2019/delta: 0.327 0.358 0.024
p50 2006/2019/delta: 0.335 0.365 0.03
p75 2006/2019/delta: 0.343 0.373 0.04
p95 2006/2019/delta: 0.348 0.39 0.061
         latitude  longitude  albedo_2006  albedo_2019  delta
5155039    16.259     -7.866        0.327        0.378  0.051
1259821    25.134      3.402        0.323        0.360  0.038
5557984    15.348     19.857        0.329        0.401  0.072
1910388    23.652      2.036        0.348        0.374  0.025
5037371    16.527     -8.473        0.329        0.368  0.039
5589356    15.277     19.964        0.315        0.352  0.037
5301462    15.929      4.482        0.330        0.383  0.053
5450363    15.589      3.955        0.333        0.357  0.024
1633875    24.286     18.170        0.342        0.420  0.078
5461716    15.562      0.321        0.318        0.358  0.039
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="take-home-messages">
<span id="satellite-satellite-albedo-resolution-q04-section-4"></span><h3>Take-home messages<a class="headerlink" href="#take-home-messages" title="Link to this heading">#</a></h3>
<p>‚Ä¢ Using threshold of surface albedo of 0.35 to separate desert from non-desert areas combined with a increase of surface brightening Œî= surface albedo2019 - surface albedo2006 &gt; 0.02, the year 2019 shows a small expansions of the desert compared to the year 2006, which occurs in different countries in the region and it is larger in Mali and Mauritania.
‚Ä¢ Pixel-level verification confirms that the flagged locations satisfying the selection rules (surface albedo2019 &gt; 0.35, surface albedo2006 ‚â§ 0.35, and Œî &gt; 0.02) show values of Œî in the 0.02‚Äì0.08 range.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-17-0187.1" rel="noreferrer" target="_blank">[1]</a>  Thomas, N., &amp; Nigam, S. (2018). <em>Twentieth-Century Climate Change over Africa: Seasonal Hydroclimate Trends and Sahara Desert Expansion</em>. <strong>Journal of Climate</strong>, 31(9), 3349‚Äì3370.</p>
<p><a class="reference external" href="https://doi.org/10.3390/rs10101541" rel="noreferrer" target="_blank">[2]</a>  G√≥mez, D., Salvador, P., Sanz, J., &amp; Casanova, J. L. (2018). <em>Detecting Areas Vulnerable to Sand Encroachment Using Remote Sensing and GIS Techniques in Nouakchott (Mauritania)</em>. <strong>Remote Sensing</strong>, 10(10), 1541.</p>
<p><a class="reference external" href="https://doi.org/10.3390/su13147953" rel="noreferrer" target="_blank">[3]</a>  Benhizia, R., Akermi, S., &amp; Bouguerra, H. (2021). <em>Monitoring the Spatiotemporal Evolution of the Green Dam in Djelfa Province, Algeria (1972‚Äì2019)</em>. <strong>Sustainability</strong>, 13(14), 7953.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.catena.2019.104094" rel="noreferrer" target="_blank">[4]</a>  Tour√©, A. A., Bilal, B., Tidjani, A. D., &amp; Karimoune, S. (2019). <em>Dynamics of wind erosion and impact of vegetation cover and land use in the Sahel: A case study on sandy dunes in southeastern Niger</em>. <strong>Catena</strong>, 181, 104094.</p>
<p><a class="reference external" href="https://doi.org/10.5194/isprsarchives-XL-7-W3-1375-2015" rel="noreferrer" target="_blank">[5]</a>  Els, A., Mayer, P., &amp; Cooksley, G. (2015). <em>Comparison of Two Satellite Imaging Platforms for Evaluating Sand Dune Migration in the Ubari Sand Sea (Libya)</em>. <strong>The International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences</strong>, XL-7/W3, 1375‚Äì1382.</p>
<p><a class="reference external" href="https://doi.org/10.5897/AJEST2015.1958" rel="noreferrer" target="_blank">[6]</a>  Abdoulkader, M. I., Tidjani, A. D., &amp; Aboubakar, I. (2016). <em>Spatial dynamics of mobile dunes, soil crusting and Yobe‚Äôs bank retreat in the Niger‚Äôs Lake Chad basin (cases of Issari and Bagara)</em>. <strong>African Journal of Environmental Science and Technology</strong>, 10(6), 151‚Äì161.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-estimating-desertification-using-surface-albedo-data">üåç Use case: Estimating desertification using surface albedo data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-relevant-packages">Import all the relevant packages</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-and-preparation">2. Data loading and preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-monthly-albedo-data">Load monthly albedo data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-inspection-and-sahara-albedo-extraction">Dataset inspection and Sahara albedo extraction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qflag-filtering-plot-helpers">QFLAG filtering + Plot helpers</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">3. Plot and describe the results.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sahara-study-area-maps-with-country-names">Sahara study area maps with country names</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-and-visualizing-sahara-desert-expansion-from-albedo-ndjf-20062019">Detecting and Visualizing Sahara Desert Expansion from Albedo (NDJF, 2006‚Üí2019)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quantifying-desertification-by-country-within-the-sahara-study-domain">Quantifying desertification by country within the Sahara study domain</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-new-desert-pixels-and-inspect-their-values">Validate ‚Äúnew-desert‚Äù pixels and inspect their values</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>