
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.1. Assessing the impact of scale and temporal trends for seasonal forecast quality &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Climate projections" href="../Climate_Projections/climate.html" />
    <link rel="prev" title="4. Seasonal forecasts" href="seasonal.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.1. Assessing the impact of scale and temporal trends for seasonal forecast quality</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSeasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessing the impact of scale and temporal trends for seasonal forecast quality</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-how-effectively-can-seasonal-forecasts-predict-the-development-of-key-global-climate-variables-across-varying-spatial-scales">🌍 Use case: How effectively can seasonal forecasts predict the development of key global climate variables across varying spatial scales?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-data-to-use-and-setup-code">1. Choose data to use and setup code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-global-correlation">2. Comparing global correlation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-after-detrending">Plot after detrending</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-correlation-for-detrended-data">3. Map of correlation for detrended data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-regions">Selecting regions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">4. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-libraries-used">Code libraries used:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="assessing-the-impact-of-scale-and-temporal-trends-for-seasonal-forecast-quality">
<h1><span class="section-number">4.1. </span>Assessing the impact of scale and temporal trends for seasonal forecast quality<a class="headerlink" href="#assessing-the-impact-of-scale-and-temporal-trends-for-seasonal-forecast-quality" title="Link to this heading">#</a></h1>
<p>Production date: 30.04.2025</p>
<p>Produced by: Johannes Langvatn (METNorway), Johanna Tjernström (METNorway)</p>
<section id="use-case-how-effectively-can-seasonal-forecasts-predict-the-development-of-key-global-climate-variables-across-varying-spatial-scales">
<h2>🌍 Use case: How effectively can seasonal forecasts predict the development of key global climate variables across varying spatial scales?<a class="headerlink" href="#use-case-how-effectively-can-seasonal-forecasts-predict-the-development-of-key-global-climate-variables-across-varying-spatial-scales" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>How does the quality of seasonal forecasts change when looking at different sized areas? What are the associated limitations?</p></li>
<li><p>How do long term temporal trends impact the quality of seasonal forecasts?</p></li>
</ul>
<p>The effectiveness of seasonal forecasts in predicting the development of key climate variables—such as temperature, precipitation and sea surface temperatures (SSTs)—varies considerably by variable, region, season, lead time and the state of large-scale climate drivers like ENSO (El Niño–Southern Oscillation). This notebook investigates how a potential trend in the data (e.g. as discussed in <a class="reference external" href="https://doi.org/10.5194/hess-23-371-2019" rel="noreferrer" target="_blank">Greuell et al. (2019) [1]</a>) along with selection of regions at various spatial scales (e.g. as discussed in <a class="reference external" href="https://doi.org/10.1007/s00382-021-05828-3" rel="noreferrer" target="_blank">Prodhomme et al. (2021) [2]</a>, <a class="reference external" href="https://doi.org/10.1175/WAF-D-19-0106.1" rel="noreferrer" target="_blank">Gubler et al. (2020) [3]</a> <a class="reference external" href="https://doi.org/10.1007/s00382-021-05895-6" rel="noreferrer" target="_blank">Quaglia et al. (2021) [4]</a>) affect forecasting quality</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The forecast quality (ensemble mean correlation) of t2m varies depending on the selected spatial scale and the choice of the regions or locations.</p>
<ul>
<li><p>There is a clear drop in forecast quality when moving from the global scale to continental scale (Europe), to a national scale (Germany), and finally to a city scale (Bonn).</p></li>
<li><p>This is not the case when comparing the global scale, to the Pacific and NINO region, where the forecast quality remains largely constant, or even better, the smaller the selected region.</p></li>
<li><p>The regional mean for NINO3.4 is better correlated to the reanalysis than the global regional mean</p></li>
<li><p>The nearest grid cell to Bonn (an example city in Germany) has low correlation and most of the quality can be attributed to the underlying trend in the dataset</p></li>
<li><p>In contrast, the nearest grid cell to Addis Ababa (an example city in Eastern Africa) has some correlation which is retained even after detrending</p></li>
</ul>
</li>
<li><p>For regions and locations which have a visible trend in t2m, the trend inflates the correlation of t2m compared to reanalysis.</p>
<ul>
<li><p>For Europe, most of the visible correlation can be attributed to the underlying trend</p></li>
<li><p>This contrasts with the region of greater horn of Africa, where less of the visible correlation can be attributed to the underlying trend</p></li>
</ul>
</li>
<li><p>Users are generally advised to avoid selecting small regions or single grid cells when using seasonal forecasts as they are only expected to be skillful in predicting large scale variations in monthly or seasonal deviations. Selecting larger regions based on a common climatology generally results in increased robustness and signal to noise</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This notebook provides an assessment of the quality of seasonal monthly forecast temperature anomalies derived from the monthly means (<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/seasonal-monthly-single-levels" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/seasonal-monthly-single-levels</a>) through comparison with the ERA5 reanalysis (<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means</a>). The hindcast anomalies are calculated from the monthly means as the anomalies catalogue entry only provides the real time forecasts. Data were accessed from the CDS.</p>
<p>Using this data the anomaly was calculated for the two meter temperature (t2m), against the period 1993-2024, and was detrended assuming a linear trend. A dataset was then generated containing both the original anomaly and the detrended. The analysis was then carried out globally and for three regions chosen based on effects of trend on the correlation.</p>
<p>First, the global case was considered both including and excluding trend, plotting anomaly for the ensemble members, ensemble mean, and ERA5. The correlation was also calculated.</p>
<p>To further consider the correlation, maps were generated to more clearly view the spatial variations of correlation in anomaly (as can seen on the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/C3S+seasonal+forecasts+verification+plots" rel="noreferrer" target="_blank">C3S verification page</a>) between the seasonal forecast and ERA5. Based on these maps, a set of regions were selected for further study, based on the magnitude of the correlation.
Plots were then generated for nested domains. Three spatial scales were considered, a larger, continental scale, a smaller country scale and a much smaller city scale. Data were selected for each domain based on a lat/lon box.</p>
<p>The resulting plots, displaying the ensemble members, ensemble mean, and ERA5, aim to visualise the variation in quality based on the selected regions of interest. This was also done for the detrended anomaly, and correlation was also calculated for each of the domains.</p>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-resolution-q06-section-1"><span class="std std-ref">1. Choose data to use and setup code</span></a></strong></p>
<ul class="simple">
<li><p>Choose a selection of forecast systems and model versions, hindcast period (normally 1993-2016 to align with the C3S common hindcast period), forecast and leadtime months</p></li>
<li><p>Compute the anomaly of the forecast and reanalysis data</p></li>
<li><p>The data is detrended assuming a linear trend in the data from start year to end year</p></li>
<li><p>Both the original and detrended data is saved for the following analysis</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-resolution-q06-section-2"><span class="std std-ref">2. Comparing global correlation</span></a></strong></p>
<ul class="simple">
<li><p>Compute the ensemble mean of the forecasted anomaly</p></li>
<li><p>Plot the correlation of forecast and reanalysis data, before and after performing the detrending</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-resolution-q06-section-3"><span class="std std-ref">3. Map of correlation for detrended data</span></a></strong></p>
<ul class="simple">
<li><p>Correlation is plotted for each grid point on a map</p></li>
<li><p>Based on this, regions are selected to investigate further; Addis Ababa, Bonn, NINO3.4.</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-resolution-q06-section-4"><span class="std std-ref">4. Plot and describe results</span></a></strong></p>
<ul class="simple">
<li><p>Plots are generated for the regions chosen in the previous section</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-data-to-use-and-setup-code">
<span id="seasonal-seasonal-monthly-single-levels-resolution-q06-section-1"></span><h3>1. Choose data to use and setup code<a class="headerlink" href="#choose-data-to-use-and-setup-code" title="Link to this heading">#</a></h3>
<p>This section contains the setup and data processing needed for performing the analysis</p>
<p>Import external code libraries needed</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># collapsable code cells - note that the code cell will be collapsed by the addition of a &#39;hide-input&#39; tag when the Jupyter Book page is built</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Define functions to be used throughout the notebook</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_anomaly</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">climatology</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s2">&quot;realization&quot;</span><span class="p">}</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">dims</span><span class="p">))</span>
    <span class="n">climatology</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">(</span><span class="n">climatology</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span> <span class="o">-</span> <span class="n">climatology</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detrend</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">obj</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polyfit_coefficients</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span> <span class="o">-</span> <span class="n">trend</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_monthly_anomaly</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">compute_anomaly</span><span class="p">)</span>
        <span class="n">da_detrend</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">detrend</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span><span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">]),</span> <span class="n">da_detrend</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">])],</span>
        <span class="s2">&quot;detrend&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">da</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;chunksizes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="mi">1</span> <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">,</span> <span class="s2">&quot;detrend&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">size</span>
        <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">sizes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_func</span><span class="p">(</span><span class="n">dict_with_leadtime_keys</span><span class="p">,</span> <span class="n">list_of_region_keys</span><span class="p">,</span> <span class="n">fignums</span><span class="p">,</span> <span class="n">plot_scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">time_range</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">time_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_range</span> <span class="o">=</span> <span class="n">dict_with_leadtime_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">detrend</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">leadtime</span> <span class="ow">in</span> <span class="n">time_range</span><span class="p">:</span>
            <span class="n">region_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="n">master_dict</span><span class="p">[</span><span class="n">leadtime</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">list_of_region_keys</span><span class="p">}</span>
            
            <span class="n">num_plots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_of_region_keys</span><span class="p">)</span>
            <span class="n">num_cols</span> <span class="o">=</span> <span class="mi">4</span><span class="c1">#int(np.ceil(num_plots/plot_scale))</span>
            <span class="n">num_rows</span> <span class="o">=</span> <span class="n">num_plots</span> <span class="o">//</span> <span class="n">num_cols</span> 
            <span class="k">if</span> <span class="n">num_plots</span> <span class="o">%</span> <span class="n">num_cols</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">num_rows</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span><span class="n">num_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
            <span class="n">dtrnd</span> <span class="o">=</span> <span class="s2">&quot;(Detrended)&quot;</span> <span class="k">if</span> <span class="n">detrend</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">: Different regions - t2m &quot;</span><span class="o">+</span> <span class="n">dtrnd</span> <span class="o">+</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">fignums</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">count_row</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">count_col</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">region_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                <span class="n">data</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;data_sf&quot;</span><span class="p">]</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span>
                <span class="n">lon</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span>
                <span class="n">da_reanalysis_mean</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;data_era5&quot;</span><span class="p">]</span>
                <span class="n">mean_ens</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s2">&quot;mean_ens&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">num_cols</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">num_rows</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">count_row</span><span class="p">,</span><span class="n">count_col</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">num_plots</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">count_col</span><span class="p">]</span>
                
                <span class="n">corr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="n">detrend</span><span class="p">),</span> <span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="n">detrend</span><span class="p">)))</span>
                <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="n">detrend</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="n">hue_style</span><span class="o">=</span><span class="s2">&quot;bo&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span><span class="s2">&quot;Realization&quot;</span><span class="p">)</span>
                <span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="n">detrend</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Realization Mean&quot;</span><span class="p">)</span>
                <span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="n">detrend</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ERA5&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">region_name</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; Corr = </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s2">.3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;legend.fontsize&quot;</span><span class="p">:</span> <span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="s2">&quot;legend.framealpha&quot;</span> <span class="p">:</span> <span class="mf">0.3</span><span class="p">}):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="n">count_col</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">count_col</span> <span class="o">&gt;=</span> <span class="n">num_cols</span><span class="p">:</span>
                    <span class="n">count_row</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">count_col</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_regions</span><span class="p">(</span><span class="n">region_dict</span><span class="p">,</span><span class="n">regions</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">central</span> <span class="o">=</span> <span class="p">(</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">central</span><span class="p">))</span>
    
    <span class="c1"># make the map global rather than have it zoom in to</span>
    <span class="c1"># the extents of any plotted data</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span>
    <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">])</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">],</span>
                                    <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
                                    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">region_dict</span><span class="p">[</span><span class="n">regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shows </span><span class="si">{</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> [box] and </span><span class="si">{</span><span class="n">regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> [blue circle] in the </span><span class="si">{</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> region&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variable</span>
<span class="n">var_api</span> <span class="o">=</span> <span class="s2">&quot;2m_temperature&quot;</span>

<span class="c1"># Time range</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1993</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2024</span>
<span class="n">collection_id_reanalysis</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-single-levels-monthly-means&quot;</span>
<span class="n">collection_id_seasonal</span> <span class="o">=</span> <span class="s2">&quot;seasonal-monthly-single-levels&quot;</span>


<span class="n">months</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;June&quot;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;July&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;August&quot;</span>
<span class="p">}</span>

<span class="n">month_string</span> <span class="o">=</span> <span class="s2">&quot;Start month: MAY - Valid month: JUNE&quot;</span>
<span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">89.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.5</span><span class="p">,</span> <span class="mf">179.5</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">var_api</span><span class="p">,</span>
    <span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="s2">&quot;1/1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">request_reanalysis</span> <span class="o">=</span> <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">request_seasonal</span> <span class="o">=</span> <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
    <span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
    <span class="s2">&quot;originating_centre&quot;</span><span class="p">:</span> <span class="s2">&quot;ecmwf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span>
<span class="p">}</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;backend_kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;time_dims&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;valid_time&quot;</span><span class="p">]},</span>
    <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span> <span class="n">compute_monthly_anomaly</span><span class="p">,</span>
    <span class="s2">&quot;transform_chunks&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Reanalysis</span>
<span class="p">(</span><span class="n">da_reanalysis</span><span class="p">,)</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id_reanalysis</span><span class="p">,</span>
    <span class="n">request_reanalysis</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="c1"># Seasonal forecast</span>
<span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">leadtime_month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id_seasonal</span><span class="p">,</span>
        <span class="n">request_seasonal</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;leadtime_month&quot;</span><span class="p">:</span> <span class="n">leadtime_month</span><span class="p">},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">leadtime_month</span><span class="o">=</span><span class="p">[</span><span class="n">leadtime_month</span><span class="p">]))</span>
<span class="c1"># Use dataarrays directly... for now</span>
<span class="c1">#da_seasonal = xr.concat(dataarrays, &quot;leadtime_month&quot;)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="comparing-global-correlation">
<span id="seasonal-seasonal-monthly-single-levels-resolution-q06-section-2"></span><h3>2. Comparing global correlation<a class="headerlink" href="#comparing-global-correlation" title="Link to this heading">#</a></h3>
<p>Compute the ensemble mean of the seasonal forecast anomaly data</p>
<p>Plot the original anomaly data for each ensemble member, the ensemble mean, and the reanalysis anomaly.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_reanalysis_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="p">)</span>

<span class="c1"># leadtime here maps to index of leadtime_month: 0 is 2, here 0 is forecast for june from may., 2 is forecast for august from may (leadtime_month = 4)</span>
<span class="n">leadtime</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">[</span><span class="n">leadtime</span><span class="p">])</span>
<span class="n">mean_ens</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Plot the detrended anomaly data for each ensemble member, the ensemble mean, and the reanalysis anomaly.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">leadtime_month</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;realization&quot;</span><span class="p">,</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensemble member&quot;</span><span class="p">})</span>
<span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ERA5 monthly mean&quot;</span><span class="p">)</span>
<span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Ensemble mean&quot;</span><span class="p">)</span>
<span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;2.1&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Global seasonal forecast t2m anomaly. Corr </span><span class="si">{</span><span class="n">correlation</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/ce6f4a61794d7711067fc75d1e06c237980a04284029cfdc207152bdbcd4402f.png" src="../_images/ce6f4a61794d7711067fc75d1e06c237980a04284029cfdc207152bdbcd4402f.png" />
</div>
</div>
<section id="plot-after-detrending">
<h4>Plot after detrending<a class="headerlink" href="#plot-after-detrending" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">leadtime_month</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;realization&quot;</span><span class="p">,</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Ensemble member&quot;</span><span class="p">})</span>
<span class="n">da_reanalysis_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;ERA5 monthly mean&quot;</span><span class="p">)</span>
<span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Ensemble mean&quot;</span><span class="p">)</span>
<span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;2.2&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Global seasonal forecast t2m anomaly. Corr </span><span class="si">{</span><span class="n">correlation</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">. (Detrended) </span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/a51e833df29aae2d5529c95d005df26e42e706ec95c220c6791ab2cd5930561d.png" src="../_images/a51e833df29aae2d5529c95d005df26e42e706ec95c220c6791ab2cd5930561d.png" />
</div>
</div>
</section>
</section>
<section id="map-of-correlation-for-detrended-data">
<span id="seasonal-seasonal-monthly-single-levels-resolution-q06-section-3"></span><h3>3. Map of correlation for detrended data<a class="headerlink" href="#map-of-correlation-for-detrended-data" title="Link to this heading">#</a></h3>
<p>The correlation of the detrended data is plotted compared to reanalysis data for each grid cell on a map</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">leadtime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">mean_ens</span> <span class="o">=</span> <span class="n">dataarrays</span><span class="p">[</span><span class="n">leadtime</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">leadtime_month</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">corr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Correlation&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;110m&quot;</span><span class="p">)</span>
    <span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;3.1&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Correlation of t2m anomaly </span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>
    <span class="n">corr_detrend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">mean_ens</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">leadtime_month</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">detrend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">corr_detrend</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;Correlation&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;110m&quot;</span><span class="p">)</span>
    <span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;3.2&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Correlation of t2m anomaly (Detrended) </span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>
    <span class="p">(</span><span class="n">corr</span><span class="o">-</span><span class="n">corr_detrend</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\Delta$ Correlation&quot;</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;110m&quot;</span><span class="p">)</span>
    <span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;3.3&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Difference in correlation of t2m anomaly (Trended - Detrended) </span><span class="se">\n</span><span class="si">{</span><span class="n">month_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/3040a534cfecc68a5620cfc99576c97fac7ec41e9b01d6302481fe3ac4d0e37f.png" src="../_images/3040a534cfecc68a5620cfc99576c97fac7ec41e9b01d6302481fe3ac4d0e37f.png" />
<img alt="../_images/24f2c4cc601ec8f0ec2aaebd7294cc51848b9a7fcc177faad1832a44789f0e37.png" src="../_images/24f2c4cc601ec8f0ec2aaebd7294cc51848b9a7fcc177faad1832a44789f0e37.png" />
<img alt="../_images/9abf98b9c112adf7664606196448618710ae3b1cc51d48bcf41aefb742da9986.png" src="../_images/9abf98b9c112adf7664606196448618710ae3b1cc51d48bcf41aefb742da9986.png" />
</div>
</div>
<section id="selecting-regions">
<h4>Selecting regions<a class="headerlink" href="#selecting-regions" title="Link to this heading">#</a></h4>
<p>Based on the correlation maps, regions are selected to investigate further; Addis Ababa, Bonn, NINO3.4.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Global&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">},</span>
    <span class="s2">&quot;Europe&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">40</span><span class="p">)},</span>
    <span class="s2">&quot;Germany&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)},</span>
    <span class="s2">&quot;Bonn&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">49</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)},</span>
    <span class="s2">&quot;Pacific&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">61</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">241</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">)},</span>
    <span class="s2">&quot;NINO3.4&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">170.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">120.3</span><span class="p">)},</span>
    <span class="s2">&quot;NINO3.4 point&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">146</span><span class="p">,</span> <span class="o">-</span><span class="mi">144</span><span class="p">)},</span>
    <span class="s2">&quot;Africa&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="o">-</span><span class="mi">37</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">60</span><span class="p">)},</span>
    <span class="s2">&quot;Greater Horn of Africa&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">19.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.7</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">23.9</span><span class="p">,</span> <span class="mf">56.8</span><span class="p">)},</span>
    <span class="s2">&quot;Addis Ababa&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
        <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span><span class="mi">40</span><span class="p">)},</span>
<span class="p">}</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">central</span><span class="o">=</span><span class="mi">130</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">central</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>

<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span> <span class="s2">&quot;Pacific&quot;</span><span class="p">,</span> <span class="s2">&quot;Africa&quot;</span><span class="p">]:</span>
    <span class="n">region_data</span> <span class="o">=</span>  <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">-</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
    <span class="n">mean_lon</span> <span class="o">=</span>  <span class="p">(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">+</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">mean_lat</span> <span class="o">=</span>  <span class="p">(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span> <span class="o">+</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mean_lon</span><span class="p">,</span> <span class="n">mean_lat</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">fignum</span><span class="o">=</span><span class="s2">&quot;3.4&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure </span><span class="si">{</span><span class="n">fignum</span><span class="si">}</span><span class="s2">: Shows the outer extent around the regions studied. Pacific ocean for NINO3.4, the </span><span class="se">\n</span><span class="s2">African continent for Addis Ababa, and Europe for Bonn&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/6f820ce14bbdabec4014ebd1f5c1eee11e1ec773687a39c436661e6927d6e6b0.png" src="../_images/6f820ce14bbdabec4014ebd1f5c1eee11e1ec773687a39c436661e6927d6e6b0.png" />
</div>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="seasonal-seasonal-monthly-single-levels-resolution-q06-section-4"></span><h3>4. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<p>In this section the regional means are computed and plots generated to illustrate scale variations for the selected regions</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">master_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">leadtime</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">era5_new</span> <span class="o">=</span> <span class="n">da_reanalysis</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">96</span><span class="o">+</span><span class="n">leadtime</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">sf_ds_new</span> <span class="o">=</span> <span class="n">dataarrays</span><span class="p">[</span><span class="n">leadtime</span><span class="p">]</span>
    <span class="n">out_regions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">out_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">reg_dict</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">region</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sliced_sf</span> <span class="o">=</span> <span class="n">sf_ds_new</span>
            <span class="n">sliced_era5</span> <span class="o">=</span> <span class="n">era5_new</span>
        <span class="k">elif</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sliced_sf</span> <span class="o">=</span> <span class="n">sf_ds_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
            <span class="n">sliced_era5</span> <span class="o">=</span> <span class="n">era5_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sliced_sf</span> <span class="o">=</span> <span class="n">sf_ds_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">])</span>
            <span class="n">sliced_era5</span> <span class="o">=</span> <span class="n">era5_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sliced_sf</span> <span class="o">=</span> <span class="n">sf_ds_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span><span class="n">longitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
            <span class="n">sliced_era5</span> <span class="o">=</span> <span class="n">era5_new</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span><span class="n">longitude</span><span class="o">=</span><span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
            
        <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span> <span class="k">if</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span>
        <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span> <span class="k">if</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">reg_dict</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span>
        <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;data_sf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">sliced_sf</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span> 
        <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;data_era5&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">sliced_era5</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;mean_ens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_dict</span><span class="p">[</span><span class="s2">&quot;data_sf&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
        <span class="n">out_regions</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_dict</span>
    <span class="n">master_dict</span><span class="p">[</span><span class="n">leadtime</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_regions</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regions</span><span class="p">(</span><span class="n">regions</span><span class="p">,[</span><span class="s2">&quot;Europe&quot;</span><span class="p">,</span><span class="s2">&quot;Germany&quot;</span><span class="p">,</span><span class="s2">&quot;Bonn&quot;</span><span class="p">])</span>
<span class="n">plot_func</span><span class="p">(</span><span class="n">master_dict</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="s2">&quot;Europe&quot;</span><span class="p">,</span> <span class="s2">&quot;Germany&quot;</span><span class="p">,</span> <span class="s2">&quot;Bonn&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;4.1&quot;</span><span class="p">,</span><span class="s2">&quot;4.2&quot;</span><span class="p">],</span><span class="n">time_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/2a49ac9b4ef48654e8f55fef1849ffbe767aeec7e4bf7255d2bce713c0b365fb.png" src="../_images/2a49ac9b4ef48654e8f55fef1849ffbe767aeec7e4bf7255d2bce713c0b365fb.png" />
<img alt="../_images/f87b4f0be2f7e7b7376e5aea24eb60da9dd5c0564e1cc3855c08406e4a13d1c0.png" src="../_images/f87b4f0be2f7e7b7376e5aea24eb60da9dd5c0564e1cc3855c08406e4a13d1c0.png" />
<img alt="../_images/94feec1571b3794767b86b3ded7f8c53bce5806f49fbb8432df4d89dae6d5369.png" src="../_images/94feec1571b3794767b86b3ded7f8c53bce5806f49fbb8432df4d89dae6d5369.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regions</span><span class="p">(</span><span class="n">regions</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Pacific&quot;</span><span class="p">,</span> <span class="s2">&quot;NINO3.4&quot;</span><span class="p">,</span> <span class="s2">&quot;NINO3.4 point&quot;</span><span class="p">])</span>
<span class="n">plot_func</span><span class="p">(</span><span class="n">master_dict</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="s2">&quot;Pacific&quot;</span><span class="p">,</span> <span class="s2">&quot;NINO3.4&quot;</span><span class="p">,</span> <span class="s2">&quot;NINO3.4 point&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;4.3&quot;</span><span class="p">,</span><span class="s2">&quot;4.4&quot;</span><span class="p">],</span> <span class="n">time_range</span><span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/b1003247cc6aa96c41e1528357bad14be490d9287ef3b519d6b31cf27ecff286.png" src="../_images/b1003247cc6aa96c41e1528357bad14be490d9287ef3b519d6b31cf27ecff286.png" />
<img alt="../_images/e26bef2fe6e9cc9dede7895c6ef8f92352a77c3be9bbac7b78cceac7abb9afd5.png" src="../_images/e26bef2fe6e9cc9dede7895c6ef8f92352a77c3be9bbac7b78cceac7abb9afd5.png" />
<img alt="../_images/af6b80b5a398575b7bd83b7d7b4c230a883218729dc2474e2b2446c599cbeace.png" src="../_images/af6b80b5a398575b7bd83b7d7b4c230a883218729dc2474e2b2446c599cbeace.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_regions</span><span class="p">(</span><span class="n">regions</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Africa&quot;</span><span class="p">,</span> <span class="s2">&quot;Greater Horn of Africa&quot;</span><span class="p">,</span> <span class="s2">&quot;Addis Ababa&quot;</span><span class="p">])</span>
<span class="n">plot_func</span><span class="p">(</span><span class="n">master_dict</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="s2">&quot;Africa&quot;</span><span class="p">,</span> <span class="s2">&quot;Greater Horn of Africa&quot;</span><span class="p">,</span> <span class="s2">&quot;Addis Ababa&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;4.5&quot;</span><span class="p">,</span><span class="s2">&quot;4.6&quot;</span><span class="p">],</span> <span class="n">time_range</span><span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/d45005f0bbfde0bb333eefad9eb779b576f11c05fdafe0918dcfd0e9227939b8.png" src="../_images/d45005f0bbfde0bb333eefad9eb779b576f11c05fdafe0918dcfd0e9227939b8.png" />
<img alt="../_images/5242e3fab81557aa41d7076130ea49e1d5e985ba66090b066ca4721a1f5333d3.png" src="../_images/5242e3fab81557aa41d7076130ea49e1d5e985ba66090b066ca4721a1f5333d3.png" />
<img alt="../_images/40fb2f71286949dbc8454684b68cf2e54f47985f127811f9195e423a87c41bd6.png" src="../_images/40fb2f71286949dbc8454684b68cf2e54f47985f127811f9195e423a87c41bd6.png" />
</div>
</div>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p>Looking at the comparison of different regions at different scales a few conclusions can be drawn. Firstly, for regions with a visible trend, that trend inflates the correlation for t2m compared against analysis. This can be seen for Europe, where comparing the detrended and trended plots, the correlation is greater for the data with trend in Europe. Hence, for Europe, most of the visible correlation can be attributed to the underlying trend.</p>
<p>This can be compared with the region of greater horn of Africa. Where comparing the trended and detrended case indicates that less of the visible correlation can be attributed to the underlying trend.</p>
<p>For the selected regions, forecast quality depending on scale varies. Looking at the Europe, Germany, Bonn case, there is a drop in forecast quality as the scale decreases. This cannot be observed in the NINO3.4 where the quality remains more or less constant, despite the decrease in region. The Greater Horn of Africa, where the drop off in quality with scale can be seen somewhat in the case of Addis Ababa, but not on the same scale as can be seen in the Europe case.</p>
<p>Considering this, and the anomalies for the different regions at different scales, it can be seen that the region of NINO3.4 has a better correlation with the reanalysis than the global regional mean, while Bonn has a low correlation where most of the quality can be attributed to the underlying trend. Addis Ababa has some correlation, which is retained even after detrending. However, the high correlations for the NINO3.4 region are partially dependent on the start date and forecast length, which can be seen in the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/C3S+seasonal+forecasts+verification+plots" rel="noreferrer" target="_blank">SST indices plots on the C3S verification page</a>), though it should be noted that these plots use sea surface temperature and not t2m.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Seasonal forecast monthly statistics on single levels: <a class="reference external" href="https://doi.org/10.24381/cds.68dd14c3" rel="noreferrer" target="_blank">10.24381/cds.68dd14c3</a></p></li>
<li><p>ERA5 monthly averaged data on single levels from 1940 to present:  <a class="reference external" href="https://doi.org/10.24381/cds.f17050d7" rel="noreferrer" target="_blank">10.24381/cds.f17050d7</a></p></li>
</ul>
</section>
<section id="code-libraries-used">
<h3>Code libraries used:<a class="headerlink" href="#code-libraries-used" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
<li><p>xarray</p></li>
<li><p>numpy</p></li>
<li><p>matplotlib</p></li>
<li><p>cartopy</p></li>
<li><p>linear_model from sklearn</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>[1] Greuell, W., Franssen, W. H. P., and Hutjes, R. W. A.: Seasonal streamflow forecasts for Europe – Part 2: Sources of skill, Hydrol. Earth Syst. Sci., 23, 371–391, <a class="reference external" href="https://doi.org/10.5194/hess-23-371-2019" rel="noreferrer" target="_blank">https://doi.org/10.5194/hess-23-371-2019</a>, 2019.</p>
<p>[2] Prodhomme, C., Materia, S., Ardilouze, C. et al. Seasonal prediction of European summer heatwaves. Clim Dyn 58, 2149–2166 (2022). <a class="reference external" href="https://doi.org/10.1007/s00382-021-05828-3" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00382-021-05828-3</a></p>
<p>[3] Gubler, S., and Coauthors, 2020: Assessment of ECMWF SEAS5 Seasonal Forecast Performance over South America. Wea. Forecasting, 35, 561–584, <a class="reference external" href="https://doi.org/10.1175/WAF-D-19-0106.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/WAF-D-19-0106.1</a></p>
<p>[4] Calì Quaglia, F., Terzago, S. &amp; von Hardenberg, J. Temperature and precipitation seasonal forecasts over the Mediterranean region: added value compared to simple forecasting methods. Clim Dyn 58, 2167–2191 (2022). <a class="reference external" href="https://doi.org/10.1007/s00382-021-05895-6" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00382-021-05895-6</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Seasonal_Forecasts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="seasonal.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
    </a>
    <a class="right-next"
       href="../Climate_Projections/climate.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Climate projections</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-how-effectively-can-seasonal-forecasts-predict-the-development-of-key-global-climate-variables-across-varying-spatial-scales">🌍 Use case: How effectively can seasonal forecasts predict the development of key global climate variables across varying spatial scales?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-data-to-use-and-setup-code">1. Choose data to use and setup code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-global-correlation">2. Comparing global correlation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-after-detrending">Plot after detrending</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-correlation-for-detrended-data">3. Map of correlation for detrended data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-regions">Selecting regions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">4. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-libraries-used">Code libraries used:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>