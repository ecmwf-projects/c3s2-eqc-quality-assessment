
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1.1. Cloud Type Determination by Altitude and Opacity for Climate Studies &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmosphere_Physics/satellite_satellite-cloud-properties_consistency_q03';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2. Atmospheric Composition" href="../Atmospheric_Composition/Atmospheric_Composition.html" />
    <link rel="prev" title="1.1. Atmosphere Physics" href="Atmosphere_Physics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.1.1. Cloud Type Determination by Altitude and Opacity for Climate Studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmosphere_Physics/satellite_satellite-cloud-properties_consistency_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmosphere_Physics/satellite_satellite-cloud-properties_consistency_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cloud Type Determination by Altitude and Opacity for Climate Studies</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-cloud-amount-and-relative-occurrence-of-specific-cloud-types">üåç Use case: Monitoring Cloud Amount and Relative Occurrence of Specific Cloud Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-how-did-high-level-clouds-change-during-the-last-decades-and-how-did-their-geographical-patterns-change-with-respect-to-surface-temperature-anomalies">‚ùì Quality assessment question: How did high-level clouds change during the last decades and how did their geographical patterns change with respect to surface temperature anomalies?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request">Define request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">Define functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">Download and transform</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-occurrence-of-specific-cloud-types">Relative Occurrence of Specific Cloud Types</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interannual-variability">Interannual variability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#anomaly-patterns-link-to-the-global-surface-temperature">Anomaly Patterns link to the Global Surface Temperature</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-useful-material">Reference/Useful material</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="cloud-type-determination-by-altitude-and-opacity-for-climate-studies">
<h1><span class="section-number">1.1.1. </span>Cloud Type Determination by Altitude and Opacity for Climate Studies<a class="headerlink" href="#cloud-type-determination-by-altitude-and-opacity-for-climate-studies" title="Link to this heading">#</a></h1>
<p>Production date: 07-01-2026</p>
<p>Produced by: CNRS</p>
<section id="use-case-monitoring-cloud-amount-and-relative-occurrence-of-specific-cloud-types">
<h2>üåç Use case: Monitoring Cloud Amount and Relative Occurrence of Specific Cloud Types<a class="headerlink" href="#use-case-monitoring-cloud-amount-and-relative-occurrence-of-specific-cloud-types" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-how-did-high-level-clouds-change-during-the-last-decades-and-how-did-their-geographical-patterns-change-with-respect-to-surface-temperature-anomalies">
<h2>‚ùì Quality assessment question: How did high-level clouds change during the last decades and how did their geographical patterns change with respect to surface temperature anomalies?<a class="headerlink" href="#quality-assessment-question-how-did-high-level-clouds-change-during-the-last-decades-and-how-did-their-geographical-patterns-change-with-respect-to-surface-temperature-anomalies" title="Link to this heading">#</a></h2>
<p>Clouds are fundamental regulators of the Earth‚Äôs climate system, significantly influencing the hydrological cycle, the atmospheric circulation and the Earth‚Äôs heat balance. These factors, in turn, play a crucial role in shaping ecosystems, agriculture, water resources, and weather patterns. The overall impact of clouds on Earth‚Äôs climate is determined by their physical properties, including their amount, their height, and their opacity (how much the cloud blocks sunlight and traps heat).
The following notebook essentially focuses on the occurrence of high-level clouds, easiest observed from space, and which have important atmospheric radiative effects : They strongly trap outgoing longwave radiation from the Earth‚Äôs surface. While high opaque clouds strongly reflect solar radiation, thin cirrus allow most solar radiation to pass. The net radiative effect of high-level clouds therefore depends on their opacity, given by the optical thickness. Furthermore, a change in the geographical patterns of their relative occurrence leads to changes in the atmospheric circulation and thus in precipitation patterns.</p>
<p>This analysis uses cloud observations from the dataset <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview" rel="noreferrer" target="_blank"><strong>Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations</strong></a>, available in the Climate Data Store (CDS). Two complementary Thematic Climate Data Records of cloud properties are provided by two product families: CLARA-A3 (CMSAF cLoud, Albedo and surface Radiation) based on measurements by the Advanced Very High Resolution Radiometers (AVHRR), and CCI (Climate Change Initiative), based on measurements by the (Advanced) Along-Track Scanning Radiometers ((A)ATSR). These data differ in temporal sampling, horizontal resolution and use different methods to retrieve cloud properties.</p>
<p>This notebook gives examples how these JCHs can be used to study the occurrence of specific cloud types. We first compare the geographical cloud type distributions of CLARA-A3 with those obtained from other cloud retrievals. Then, the interannual variability of the relative occurrence of three different high-level cloud types (high opaque, cirrus and thin cirrus) is shown in the tropics, and finally we explore their geographical anomaly patterns with respect to global surface temperature changes.</p>
<p>In order to define cloud types according to height and opacity, this notebook uses Joint Cloud Histograms (JCH). These provide monthly cloud occurrence statistics within 13 x 15 two-dimensional intervals in cloud optical thickness (COT) and cloud-top pressure (CTP), averaged over grid cells of 1¬∞ latitude x 1¬∞ longitude. At present, the CDS only provides the JCHs for CLARA-A3.</p>
<p>In this notebook, we define high-level clouds as clouds with a cloud-top pressure &lt; 310 hPa. This corresponds to a height of about 10 km in the tropics and 8.5 - 9 km in the midlatitudes. They are then further distinguished as thin cirrus, cirrus and high opaque clouds, using COT thresholds of 1.3 and 9.4, respectively. This cloud type identification corresponds to the one applied in the updated Global Energy and Water Exchanges (GEWEX) cloud assessment <a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">[3]</a>, which has recently inter-compared 11 publicly available global cloud data records derived from measurements of multi-spectral imagers, IR sounders, and lidar.</p>
<p>The <a class="reference external" href="https://www.nwcsaf.org/Downloads/PPS/v2021/Documents/NWC-CDOP3-PPS-SMHI-SCI-ATBD-CloudProbability_v2_0.pdf" rel="noreferrer" target="_blank"><strong>CLARA-A3 cloud detection</strong></a> relies on a Bayesian approach, by linking measurements from all AVHRR channels to the cloud detection from the Cloud-Aerosol Lidar and Infrared Pathfinder Satellite Observation mission (CALIPSO)<a class="reference external" href="https://doi.org/10.1175/2010BAMS3009.1" rel="noreferrer" target="_blank">[1]</a> as a reliable reference.
CTP is retrieved based on a neural network approach, trained on CALIPSO cloud-top height observations. In a second step, it is then transformed to cloud-top height and temperature by applying atmospheric profiles from meteorological reanalyses.
Ice clouds are distinguished from liquid clouds by considering spectral infrared brightness temperature differences.
Only during daytime, COT is retrieved using look-up tables (LUTs) based on visible and near-infrared reflectances and radiative transfer <a class="reference external" href="https://doi.org/10.5194/essd-9-415-2017" rel="noreferrer" target="_blank">[2]</a>.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<p>It is important to note that passive remote sensing has limitations: it provides a top-down perspective, which does not account for hidden cloud layers, and classical retrievals, based on radiative transfer, estimate a ‚Äòradiative‚Äô cloud height. This radiative height can be several kilometers below the actual cloud top, especially in cases where clouds have diffuse tops, with optical depth gradually increasing from the top down over a significant vertical range. This phenomenon is relevant for approximately 70% of high clouds in the tropics and 30-40% of high clouds in the midlatitudes <a class="reference external" href="https://doi.org/10.1029/94JD02430" rel="noreferrer" target="_blank">[4]</a>.</p>
<p>Recent retrievals, such as the one developed for CLARA-A3, obtain the cloud-top height by using neural networks which have been trained on the cloud-top height derived by active lidar (CALIOP).</p>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The CLARA-A3 high-level cloud amount, relative to all clouds, is about 55% over tropical ocean and 65% over tropical land,  and these values are close to the ones derived from CALIOP by the CALIPSO Science Team (CALIPSO-ST). A further distinction into cloud types according to opacity shows that the relative amount of high opaque clouds and cirrus is about 10% larger over tropical land than over tropical ocean, while it is the opposite for thin cirrus. This may be due to the fact that the detection of thin cirrus is more difficult over land than over ocean. The time series of their annual means are stable only for high opaque clouds over tropical ocean, and only for the period 2003-2015 for all other high-level cloud types. During this period, two observation times are used homogeneously at around 10AM and 1:30PM local time. Before that period, only afternoon observations were used, which have been less stable in time, and afterwards only morning observations, as the afternoon observations strongly drifted in time. For monitoring cloud properties it may be better to build a data record of JCHs that use only one observation time within a certain time window, like 1:30PM +-1h.</p></li>
<li><p>Geographical patterns of changes in relative cloud type amounts with respect to global surface temperature anomalies reveal an increase per ¬∞C of warming near the equator in the tropical Pacific and a decrease over Indonesia, very similar to the pattern caused by the El Ni√±o‚ÄìSouthern Oscillation. The relative amount of thin cirrus increases around the equator, close to the increase of high opaque clouds. This can be reconciled with the findings that tropical mesoscale convective systems get higher and the area of surrounding thin cirrus gets larger with their height.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis comprises the following steps:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-cloud-properties-consistency-q03-section-parameters"><span class="std std-ref">Choose the parameters to use and setup code</span></a></strong></p>
<ul class="simple">
<li><p>Import the relevant libraries.</p></li>
<li><p>Define the parameters of the analysis and set the dataset requests.</p></li>
<li><p>Prepare the datasets for the analysis, first aggregating statistics of liquid and ice clouds, then grouping the initial CTP and COT intervals of the JCHs into three each. This leads to nine cloud types based on the cloud optical thickness (COT) and cloud Top Pressure (CTP).</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-cloud-properties-consistency-q03-section-download"><span class="std std-ref">Download and transform</span></a></strong></p>
<ul class="simple">
<li><p>Download the CLARA-A3 monthly mean JCHs and the reanalysis ERA5 land sea mask available on CDS.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-cloud-properties-consistency-q03-section-results"><span class="std std-ref">Results</span></a></strong></p>
<ul class="simple">
<li><p>Plot geographical maps (60¬∞N-60¬∞S) of the normalized occurrence frequency of these nine cloud types, averaged over the period 2008-2015.</p></li>
<li><p>Split sea and ocean data using a land sea mask.</p></li>
<li><p>Plot time series of tropical cloud amount, relative proportion of high-level clouds (CTP &gt; 310 hPa) and of thin cirrus, cirrus and high opaque clouds, separately over ocean and land.</p></li>
<li><p>Compute, per 1¬∞ grid cell, linear regression slopes of deseasonalized monthly mean anomalies in relative amount of thin cirrus, cirrus and high opaque clouds with respect to deseasonalized global mean surface temperature anomalies, for the period 2003-2015 over 40¬∞N-40¬∞S. The surface temperature anomalies are given by <a class="reference external" href="https://data.giss.nasa.gov/gistemp/" rel="noreferrer" target="_blank"><strong>GISTEMP Team 2023</strong></a> <a class="reference external" href="https://doi.org/10.1029/2018JD029522" rel="noreferrer" target="_blank">[5]</a>.</p></li>
<li><p>Plot their geographical distributions.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-parameters-to-use-and-setup-code">
<span id="satellite-satellite-cloud-properties-consistency-q03-section-parameters"></span><h3>Choose the parameters to use and setup code<a class="headerlink" href="#choose-the-parameters-to-use-and-setup-code" title="Link to this heading">#</a></h3>
<p>This section includes the library imports and the parameter settings for the analysis.</p>
<section id="import-libraries">
<h4>Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_cyclic_point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1980</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2020</span>

<span class="c1"># Region</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># Bins</span>
<span class="n">cot_slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">9.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">ctp_slices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">310</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="mi">680</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">680</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>

<span class="c1"># GISS URL</span>
<span class="n">giss_url</span> <span class="o">=</span> <span class="s2">&quot;https://data.giss.nasa.gov/gistemp/tabledata_v4/GLB.Ts+dSST.txt&quot;</span>

<span class="c1"># Setup figure</span>
<span class="n">key_figure</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ocean&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">]</span>
<span class="n">Clouds</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Thin Ci&#39;</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="s1">&#39;High opaque&#39;</span><span class="p">]</span>
<span class="n">bound_colorbar</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.44</span><span class="p">,</span><span class="mf">0.67</span><span class="p">,</span><span class="mf">0.48</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-request">
<h4>Define request<a class="headerlink" href="#define-request" title="Link to this heading">#</a></h4>
<p>two datasets are requested :</p>
<ul class="simple">
<li><p>Joint Cloud Histogram (JCH)</p></li>
<li><p>Land Sea Mask (LSM)</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">requests</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;satellite-cloud-properties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;clara_a3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;eumetsat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;joint_cloud_property_histogram&quot;</span><span class="p">,</span>
    <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<span class="p">}</span>


<span class="n">requests</span><span class="p">[</span><span class="s1">&#39;reanalysis-era5-single-levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;land_sea_mask&#39;</span><span class="p">,</span>
        <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;reanalysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="s1">&#39;2020&#39;</span><span class="p">,</span>
        <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;01&#39;</span><span class="p">,</span>
        <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="s1">&#39;01&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
         <span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-to-cache">
<h4>Define functions to cache<a class="headerlink" href="#define-functions-to-cache" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">infer_label</span><span class="p">(</span><span class="n">sel_slice</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">units</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">units</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">sel_slice</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="n">sel_slice</span><span class="o">.</span><span class="n">stop</span><span class="si">}{</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">sel_slice</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> ‚â• </span><span class="si">{</span><span class="n">sel_slice</span><span class="o">.</span><span class="n">start</span><span class="si">}{</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sel_slice</span><span class="o">.</span><span class="n">start</span><span class="si">}{</span><span class="n">units</span><span class="si">}</span><span class="s2"> ‚â§ </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="n">sel_slice</span><span class="o">.</span><span class="n">stop</span><span class="si">}{</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">reindex</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">cot_slices</span><span class="p">,</span> <span class="n">ctp_slices</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">)</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cot_index</span><span class="p">,</span> <span class="n">cot_slice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cot_slices</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ctp_index</span><span class="p">,</span> <span class="n">ctp_slice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ctp_slices</span><span class="p">):</span>
            <span class="n">ds_limit</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
                <span class="n">hist2d_cot_bin_centre</span><span class="o">=</span><span class="n">cot_slice</span><span class="p">,</span>
                <span class="n">hist2d_ctp_bin_centre</span><span class="o">=</span><span class="n">ctp_slice</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ds_limit</span> <span class="o">=</span> <span class="n">ds_limit</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;hist_phase&quot;</span><span class="p">,</span> <span class="s2">&quot;hist2d_ctp_bin_centre&quot;</span><span class="p">,</span> <span class="s2">&quot;hist2d_cot_bin_centre&quot;</span><span class="p">],</span>
                <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ds_limit</span> <span class="o">=</span> <span class="n">ds_limit</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
                <span class="n">COT</span><span class="o">=</span><span class="p">[</span><span class="n">infer_label</span><span class="p">(</span><span class="n">cot_slice</span><span class="p">,</span> <span class="s2">&quot;COT&quot;</span><span class="p">)],</span>
                <span class="n">CTP</span><span class="o">=</span><span class="p">[</span><span class="n">infer_label</span><span class="p">(</span><span class="n">ctp_slice</span><span class="p">,</span> <span class="s2">&quot;CTP&quot;</span><span class="p">,</span> <span class="s2">&quot;hPa&quot;</span><span class="p">)],</span>
            <span class="p">)</span>
            <span class="n">ds_limit</span> <span class="o">=</span> <span class="n">ds_limit</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
                <span class="n">cot_index</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;COT&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">cot_index</span><span class="p">]),</span> <span class="n">ctp_index</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;CTP&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">ctp_index</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_limit</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">combine_by_coords</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;cot_index&quot;</span><span class="p">,</span> <span class="s2">&quot;ctp_index&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="s2">&quot;cot_index&quot;</span><span class="p">,</span> <span class="s2">&quot;ctp_index&quot;</span><span class="p">])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">([</span><span class="s2">&quot;hist2d_cot_bin_border&quot;</span><span class="p">,</span> <span class="s2">&quot;hist2d_ctp_bin_border&quot;</span><span class="p">])</span>

    <span class="c1"># Time reindex</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
        <span class="n">year</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="n">month</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform">
<span id="satellite-satellite-cloud-properties-consistency-q03-section-download"></span><h3>Download and transform<a class="headerlink" href="#download-and-transform" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;satellite-cloud-properties&quot;</span> <span class="p">:</span>
        <span class="n">datasets</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">reindex</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span>
            <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">,</span>
            <span class="s2">&quot;cot_slices&quot;</span><span class="p">:</span> <span class="n">cot_slices</span><span class="p">,</span>
            <span class="s2">&quot;ctp_slices&quot;</span><span class="p">:</span> <span class="n">ctp_slices</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">drop_variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lat_bnds&quot;</span><span class="p">,</span> <span class="s2">&quot;lon_bnds&quot;</span><span class="p">,</span> <span class="s2">&quot;time_bnds&quot;</span><span class="p">],)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">datasets</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>collection_id=&#39;satellite-cloud-properties&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 41/41 [00:12&lt;00:00,  3.24it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>collection_id=&#39;reanalysis-era5-single-levels&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 11.43it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="results">
<span id="satellite-satellite-cloud-properties-consistency-q03-section-results"></span><h3>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<section id="relative-occurrence-of-specific-cloud-types">
<h4>Relative Occurrence of Specific Cloud Types<a class="headerlink" href="#relative-occurrence-of-specific-cloud-types" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;satellite-cloud-properties&#39;</span><span class="p">][</span><span class="s1">&#39;hist2d_cot_ctp&#39;</span><span class="p">]</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="s1">&#39;2008-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-01&#39;</span><span class="p">))</span> <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="s1">&#39;2008-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-01&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="s2">&quot;COT&quot;</span><span class="p">,</span> <span class="s2">&quot;CTP&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">])</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">ticks</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">12</span><span class="p">]])</span>
<span class="n">ticks_round</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;COT&quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="o">=</span><span class="s2">&quot;CTP&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;ocean_r&quot;</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">),</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">facet</span><span class="o">.</span><span class="n">cbar</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ticks_round</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CLARA A3</span><span class="se">\n</span><span class="s2"> 2008-01-01 - 2015-12-01&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a093c185ce9c7c22e0c0a0e3c566fb0fb193d502d91897ec3386456dde94bae1.png" src="../../_images/a093c185ce9c7c22e0c0a0e3c566fb0fb193d502d91897ec3386456dde94bae1.png" />
</div>
</div>
<p><em>Figure 1: Geographical distributions (60¬∞N-60¬∞S) of normalized occurrence frequency of nine cloud types from CLARA-A3, distinguished by Cloud Optical Thickness (COT), with thresholds at 1.3 and 9.4, and Cloud Top Pressure (CTP), with thresholds at 310 and 680 hPa. Statistics averaged over day-time from 2008 to 2015.</em></p>
<p>The normalized occurrence frequencies of the nine cloud types presented in Figure 1 have been obtained by dividing the statistics of the grouped JCHs by the statistics summed over all JCH intervals, for each 1¬∞ grid cell. These maps allow to quickly visualise specific geographical patterns such as tropical thin cirrus, tropical cirrus anvils or Stratocumulus regions off the Western coasts, respectively in the grouped COT-CTP intervals (1,1), (2,1) and (2,3).
The comparison with the maps of the updated GEWEX cloud assessment, presented in Fig. 10 of <a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">[3]</a> for eight different data sets, leads to the following assessment of CLARA-A3:</p>
<p>Compared to CLARA-A2 (V2.0), CLARA-A3 provides more high-level and less mid-level clouds. This can be easily explained by the fact that the CLARA-A3 neural network retrieval, trained on lidar data, estimates the cloud top, while the classical CLARA-A2 retrieval estimates the lower ‚Äòradiative‚Äô cloud height.
Another difference can be noticed for the Stratocumulus clouds off the Western coasts, which seem to have a more structured occurrence, again due to the new neural network approach linked to lidar height.</p>
<p>The geographical patterns of the normalized occurrence of tropical thin cirrus given by CLARA-A3 are very similar to the ones given by AIRS-CIRS <a class="reference external" href="https://acp.copernicus.org/articles/17/13625/2017/acp-17-13625-2017-discussion.html" rel="noreferrer" target="_blank">[6]</a>. This indeed shows an improvement compared to CLARA-A2, as IR sounders such as AIRS identify thin cirrus reliably.</p>
<p>The geographical patterns of cirrus are similar to those of PATMOS-x <a class="reference external" href="https://journals.ametsoc.org/view/journals/apme/51/6/jamc-d-11-02.1.xml" rel="noreferrer" target="_blank">[7]</a>, MODIS-CLDPROP <a class="reference external" href="https://doi.org/10.3390/rs13010002" rel="noreferrer" target="_blank">[8]</a> and AIRS-CIRS<a class="reference external" href="https://acp.copernicus.org/articles/17/13625/2017/acp-17-13625-2017-discussion.html" rel="noreferrer" target="_blank">[6]</a>, with maxima of cirrus anvils above the most convective regions, above Indonesia, South America and Africa. However, CLARA-A3 presents more of these higher thicker clouds in the midlatitudes. This can be explained again by the fact that the neural network retrieval places the high-level clouds close to the tropopause (see also the notebook ‚ÄòIntercomparison of Cloud-Top Pressure Distributions derived from Satellite Observations‚Äô).</p>
</section>
<section id="interannual-variability">
<h4>Interannual variability<a class="headerlink" href="#interannual-variability" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;reanalysis-era5-single-levels&#39;</span><span class="p">][</span><span class="s2">&quot;lsm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mask</span><span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="p">((</span><span class="n">mask</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span><span class="o">%</span> <span class="mi">360</span><span class="p">)</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span>

<span class="n">ds_cfc</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s1">&#39;satellite-cloud-properties&#39;</span><span class="p">][</span><span class="s1">&#39;cfc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">COT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CTP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> 
<span class="n">CA</span> <span class="o">=</span> <span class="n">ds_cfc</span> <span class="o">*</span> <span class="mf">0.01</span>
<span class="n">mask_interp</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">CA</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="n">CA</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
<span class="n">weights_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds_cfc</span><span class="o">.</span><span class="n">latitude</span><span class="p">)))</span>
<span class="n">weights_lat</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">weights_lat</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">ds_cfc</span><span class="o">.</span><span class="n">latitude</span><span class="p">})</span>

<span class="n">CA_land_mean</span> <span class="o">=</span> <span class="n">CA</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_lat</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">CA_ocean_mean</span> <span class="o">=</span> <span class="n">CA</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights_lat</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>

<span class="n">N_cloud_land</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;CTP&quot;</span><span class="p">,</span> <span class="s2">&quot;COT&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
<span class="n">N_cloud_ocean</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;CTP&quot;</span><span class="p">,</span> <span class="s2">&quot;COT&quot;</span><span class="p">,</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>

<span class="n">N_type_tot_land</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">CTP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;COT&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
<span class="n">N_type_tot_ocean</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">CTP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;COT&quot;</span><span class="p">,</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>


<span class="n">CAR_land</span> <span class="o">=</span> <span class="p">((</span><span class="n">N_type_tot_land</span><span class="o">/</span> <span class="n">N_cloud_land</span><span class="p">)</span> <span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">CAR_ocean</span> <span class="o">=</span> <span class="p">((</span><span class="n">N_type_tot_ocean</span> <span class="o">/</span> <span class="n">N_cloud_ocean</span><span class="p">)</span> <span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figure_CAR</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;land&#39;</span> <span class="p">:{</span><span class="s1">&#39;N_type&#39;</span> <span class="p">:</span> <span class="p">{}},</span><span class="s1">&#39;ocean&#39;</span> <span class="p">:{</span><span class="s1">&#39;N_type&#39;</span> <span class="p">:</span> <span class="p">{}</span> <span class="p">}}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Clouds</span><span class="p">))</span> <span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">N_type_land</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">CTP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">COT</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
    <span class="n">N_type_ocean</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">CTP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">COT</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_interp</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
    
    <span class="n">figure_CAR</span><span class="p">[</span><span class="s1">&#39;land&#39;</span><span class="p">][</span><span class="s1">&#39;N_type&#39;</span><span class="p">][</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">((</span><span class="n">N_type_land</span><span class="o">/</span><span class="n">N_cloud_land</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="n">figure_CAR</span><span class="p">[</span><span class="s1">&#39;ocean&#39;</span><span class="p">][</span><span class="s1">&#39;N_type&#39;</span><span class="p">][</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">((</span><span class="n">N_type_ocean</span><span class="o">/</span><span class="n">N_cloud_ocean</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">key_figure</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CA_land_mean</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CA_land_mean</span> <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CA_land_mean</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CA_land_mean</span> <span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CA_ocean_mean</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CA_ocean_mean</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CA_ocean_mean</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CA_ocean_mean</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.3</span> <span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.72</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Land&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ocean&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>




<span class="n">fig</span> <span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">key_figure</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">CAR_land</span> <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CAR_land</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;All high clouds&#39;</span> <span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CAR_ocean</span> <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">CAR_ocean</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;All high clouds&#39;</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Clouds</span><span class="p">))</span> <span class="p">:</span> 
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">figure_CAR</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;N_type&#39;</span><span class="p">][</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">CAR_land</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">figure_CAR</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;N_type&#39;</span><span class="p">][</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> &#39;</span> <span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span> <span class="p">,</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>


<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;Years&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;CAR (%)&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/72066ab8736cb111362dc7dd5109da0df5423f94574cdd5897642827c05cf53f.png" src="../../_images/72066ab8736cb111362dc7dd5109da0df5423f94574cdd5897642827c05cf53f.png" />
<img alt="../../_images/5ea2c47ce64d3a1d822363bcbfde74bfa4813821464ceeb543ff997150235357.png" src="../../_images/5ea2c47ce64d3a1d822363bcbfde74bfa4813821464ceeb543ff997150235357.png" />
</div>
</div>
<p><em>Figure 2: Time series of annual means of (top) tropical cloud amount (blue) and (bottom) relative proportion of all high-level clouds (CTP &gt; 310 hPa, blue), thin cirrus (Thin Ci, orange), cirrus (Ci, green) and high opaque clouds (red), separately over ocean (left) and over land (right). Statistics averaged over 25N ‚Äì 25S, for 1980 - 2020, during daytime. Only during the period 2003-2015, two observation times are used homogeneously at around 10AM and 1:30PM local time. Before that period, only afternoon observations are used, which have been less stable in time, and afterwards only morning observations, as the afternoon observations strongly drifted in time.</em></p>
<p>The JCHs also include the cloud area fraction for each 1¬∞ grid cell. Since the JCHs include only cloudy statistics, this variable can be used as a weight in order to transform relative occurrences into absolute occurrences.</p>
<p>The upper panels of Figure 2 present time series of the annual mean cloud amount (CA). It is calculated as the latitudinal average of the annual mean fractional cloud cover. The blue curves can be compared to the results presented in Fig. 12 of the updated GEWEX cloud assessment <a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">[3]</a>. The time series of CA is relatively more stable over tropical land than over tropical ocean, the latter showing two significant increases in the early 1990‚Äôs and in 2002. These increases over ocean also appear in the CA of PATMOS-x, while other data records, including CLARA-A2, do not show this behaviour. This can be explained by the fact that PATMOS-x uses a similar cloud detection method.
The CA of CLARA-A3 over tropical ocean is about 0.1 higher than over tropical land, in agreement with AIRS-CIRS, CALIPSO-ST and MODIS-CE. However, while the fractional cloud cover of CLARA-A3 and CLARA-A2 (V2.1) are similar in the tropical latitude bands in the notebook ‚ÄòSatellite cloud cover validation for Climate modelling, ‚Äôthe CA of CLARA-A3 over tropical land only lies by about 0.4, compared to about 0.5 of CLARA-A2 (V2.0) and of the other retrievals using AVHRR measurements. The CA of CLARA-A3 over tropical land is close to the one of CALIPSO-ST_passive, which simulates the one retrieved by passive imagers by limiting the detection of clouds to those with COT &gt; 0.3, but which is lower than what provide most of the other cloud data records.</p>
<p>The lower panels of Figure 2 present time series of the annual mean relative amount of all high-level clouds (blue), as well as of thin cirrus (orange), cirrus (green) and high opaque clouds (red), separately over tropical ocean and over tropical land. The threshold of 310 hPa corresponds in the tropics to a height of about 10 km. The relative amount of high-level clouds from CLARA-A3 is relatively large and compares well with the one obtained by CALIOP by the CALIPSO Science Team (CALIPSO-ST), with about 60% and 70% respectively. However, the interannual variability has not the same behaviour.
It was already pointed out in <a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">[3]</a> that it is very difficult to observe latitudinal trends with the cloud data records currently available, and the AVHRR cloud products, which exist over a 40-year period, are more stable after 2003. However, global warming increased during the last 20 years. The CLARA-A3 cloud data records also show differences in behaviour between the periods before and after 2003. This can be explained by the observation times which have been used to create the CLARA-A3 JCHs: Only during the period 2003-2015, two observation times are used homogeneously at around 10AM and 1:30PM local time. Before that period, only afternoon observations are used, which have been less stable in time, and afterwards only morning observations, as the afternoon observations strongly drifted in time.</p>
<p>For a comparison of the time series of the three high-level cloud type occurrences, we have analysed the JCHs of the <a class="reference external" href="https://gewexca.aeris-data.fr/" rel="noreferrer" target="_blank"><strong>updated GEWEX cloud assessment database</strong></a>, by applying the same CTP and COT thresholds.</p>
<p>The most stable CLARA-A3 relative amount is the one of high opaque clouds over tropical ocean, of about 11%. This amount is nearly twice as large (about 18%) and less stable over tropical land. The largest amount is the one of cirrus, with 25% over tropical ocean and 35% over tropical land. The relative amount of thin cirrus shows an opposite behaviour, with 20% over tropical ocean and 10% over tropical land. These results are similar to the ones of MODIS-CLDPROP, though with larger absolute values, as the high-level cloud amount is about 15% larger for CLARA-A3. However, PATMOS-x, also based on AVHRR measurements, does not show any difference between tropical ocean and land for thin cirrus and high opaque clouds.<br />
According to CLARA-A3, the relative amount of all three high-level cloud types seems to slightly increase since the 2000‚Äôs. However, this behaviour is not observed in the other datasets (PATMOS-x, MODIS-CLDPROP and AIRS-CIRS).</p>
</section>
<section id="anomaly-patterns-link-to-the-global-surface-temperature">
<h4>Anomaly Patterns link to the Global Surface Temperature<a class="headerlink" href="#anomaly-patterns-link-to-the-global-surface-temperature" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">giss_url</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span>
    <span class="n">skiprows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">skipfooter</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;***&quot;</span><span class="p">,</span> <span class="s2">&quot;****&quot;</span><span class="p">],</span>
    <span class="n">index_col</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">da_temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-01&#39;</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-01&#39;</span><span class="p">))</span> <span class="p">},</span>
<span class="p">)</span>
<span class="n">da_temp_anomaly</span> <span class="o">=</span> <span class="n">da_temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da_temp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2015-12-01&#39;</span><span class="p">))</span>
<span class="n">dn</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="s2">&quot;COT&quot;</span><span class="p">,</span> <span class="s2">&quot;CTP&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="n">da</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">dn</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">da_temp_anomaly</span><span class="p">)</span>
<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">da</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;polyfit_coefficients&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                        <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">)})</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    
    <span class="n">lmax</span> <span class="o">=</span> <span class="n">bound_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">lmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">lmax</span>

    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lmin</span><span class="p">,</span><span class="n">lmax</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ticks</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">levels</span><span class="p">[</span><span class="mi">11</span><span class="p">]])</span>

    
    <span class="n">da_sel</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">CTP</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">COT</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="n">data_cyclic</span><span class="p">,</span> <span class="n">lon_cyclic</span> <span class="o">=</span> <span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">da_sel</span><span class="p">,</span> <span class="n">da_sel</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">])</span>

    <span class="n">im</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon_cyclic</span><span class="p">,</span><span class="n">da_sel</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span><span class="n">data_cyclic</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Clouds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
        <span class="n">im</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
        <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
        <span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
        <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span>
    <span class="p">)</span> 

    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="n">ticks_round</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ticks_round</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ea27379d2609f2e928c723a2fa8f2f2e2ba0f8481cf777d522501436482a0bf2.png" src="../../_images/ea27379d2609f2e928c723a2fa8f2f2e2ba0f8481cf777d522501436482a0bf2.png" />
</div>
</div>
<p><em>Figure 3: Geographical maps of linear regression slopes between monthly mean anomalies in amount of thin cirrus (left), cirrus (middle) and high opaque clouds (right), relative to all clouds, and global mean surface temperature anomalies, during the period 2003-2015, over 40¬∞N-40¬∞S. Units are in fractional change per ¬∞C warming. The global mean surface temperatures are given by the <a class="reference external" href="https://data.giss.nasa.gov/gistemp/" rel="noreferrer" target="_blank"><strong>GISS Surface Temperature Analysis</strong></a> <a class="reference external" href="https://doi.org/10.1029/2023JD040179" rel="noreferrer" target="_blank">[9]</a>.</em></p>
<p>Since it is difficult to observe latitudinal trends, an alternative approach is to analyse regional cloud type variability with respect to inter-annual global mean surface temperature anomalies.</p>
<p>The monthly deseasonalized 1¬∞ x 1¬∞ relative cloud type amount anomalies and global surface temperature anomalies are obtained by subtracting the monthly mean (at 1¬∞ resolution and global, respectively) over the whole period, 2003 ‚Äì 2015. Then, we determine geographical change patterns in amount of these cloud types, relative to all clouds, with respect to global surface temperature change by calculating the linear regression slopes of the ratio between relative cloud type amount anomaly and global surface temperature anomaly, per grid cell.
CLARA-A3 shows a relative increase per ¬∞C of warming of all these three cloud types near the equator in the tropical Pacific and a decrease over Indonesia, similar to the cloud datasets in the updated GEWEX cloud assessment and similar the pattern caused by the El Ni√±o‚ÄìSouthern Oscillation (ENSO [10] (<a class="reference external" href="https://doi.org/full/10.1029/2018GL077598" rel="noreferrer" target="_blank">https://doi.org/full/10.1029/2018GL077598</a>)).</p>
<p>We also observe an increase in cirrus and thin cirrus in the subtropics. This may be in relation to a hypothesized widening of the Hadley cell with global warming <a class="reference external" href="https://doi.org/10.1038/s41558-018-0246-2" rel="noreferrer" target="_blank">[11]</a>.</p>
<p>The relative amount of thin cirrus also increases around the equator, close to the increase of high opaque clouds. This can be reconciled with the findings that tropical mesoscale convective systems get higher <a class="reference external" href="https://acp.copernicus.org/articles/21/1015/2021/" rel="noreferrer" target="_blank">[12]</a> and the area of surrounding thin cirrus gets larger with their height <a class="reference external" href="https://acp.copernicus.org/articles/17/3845/2017/" rel="noreferrer" target="_blank">[13]</a>.</p>
<p>The different geographical change patterns of high opaque clouds and thin cirrus lead to variations in atmospheric heating and cooling gradients which then influence the large scale circulation, as has already been investigated <a class="reference external" href="https://doi.org/abs/10.1002/qj.49711749805" rel="noreferrer" target="_blank">[14]</a>.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entry for the data used is:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview" rel="noreferrer" target="_blank"><strong>Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations</strong></a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="reference-useful-material">
<h3>Reference/Useful material<a class="headerlink" href="#reference-useful-material" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1175/2010BAMS3009.1" rel="noreferrer" target="_blank">[1]</a> Winker DM, Pelon J, Coakley JA Jr et al (2010) The CALIPSO mission: a global 3D view of aerosols and clouds. Bull Am Meteorol Soc 91:1211‚Äì1229. <a class="reference external" href="https://doi.org/10.1175/2010BAMS3009.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/2010BAMS3009.1</a></p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-9-415-2017" rel="noreferrer" target="_blank">[2]</a> Benas, N., Finkensieper, S., Stengel, M., van Zadelhoff, G.-J., Hanschmann, T., Hollmann, R., and Meirink, J. F., 2017: The MSG-SEVIRI-based cloud property data record CLAAS-2, Earth System Science Data, 9, 415‚Äì434, doi:10.5194/essd-9-415-2017</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">[3]</a> Stubenrauch, C.J., Kinne, S., Mandorli, G. et al. Lessons Learned from the Updated GEWEX Cloud Assessment Database. Surv Geophys 45, 1999‚Äì2048 (2024). <a class="reference external" href="https://doi.org/10.1007/s10712-024-09824-0" rel="noreferrer" target="_blank">https://doi.org/10.1007/s10712-024-09824-0</a></p>
<p><a class="reference external" href="https://doi.org/10.1029/94JD02430" rel="noreferrer" target="_blank">[4]</a> Liao, X., W. B. Rossow, and D. Rind (1995), Comparison between SAGE II and ISCCP high-level clouds: 2. Locating cloud tops, J. Geophys. Res., 100(D1), 1137‚Äì1147, doi:10.1029/94JD02430</p>
<p><a class="reference external" href="https://doi.org/10.1029/2018JD029522" rel="noreferrer" target="_blank">[5]</a> Lenssen, N., G. Schmidt, J. Hansen, M. Menne, A. Persin, R. Ruedy, and D. Zyss, 2019: Improvements in the GISTEMP uncertainty model. J. Geophys. Res. Atmos., 124, no. 12, 6307-6326, doi:10.1029/2018JD029522.</p>
<p><a class="reference external" href="https://acp.copernicus.org/articles/17/13625/2017/acp-17-13625-2017-discussion.html" rel="noreferrer" target="_blank">[6]</a> Stubenrauch CJ, Feofilov AG, Protopapadaki SE, Armante R (2017) Cloud climatologies from the infrared sounders AIRS and IASI: strengths and applications. Atmos Chem Phys 17:13625‚Äì13644. <a class="reference external" href="https://doi.org/10.5194/acp-17-13625-2017" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-17-13625-2017</a></p>
<p><a class="reference external" href="https://journals.ametsoc.org/view/journals/apme/51/6/jamc-d-11-02.1.xml" rel="noreferrer" target="_blank">[7]</a> Heidinger AK, Evan AT, Foster MJ, Walther A (2012) A naive Bayesian cloud detection scheme derived from CALIPSO and applied within PATMOS-x. J Appl Meteorol Climatol 51:1129‚Äì1144. <a class="reference external" href="https://doi.org/10.1175/JAMC-D-11-02.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JAMC-D-11-02.1</a></p>
<p><a class="reference external" href="https://doi.org/10.3390/rs13010002" rel="noreferrer" target="_blank">[8]</a> Platnick S, Meyer K, Wind G, Holz RE, Amarasinghe N, Hubanks PA, Marchant B, Dutcher S, Veglio P (2021) The NASA MODIS-VIIRS continuity cloud optical properties products. Remote Sens 13:2. <a class="reference external" href="https://doi.org/10.3390/rs13010002" rel="noreferrer" target="_blank">https://doi.org/10.3390/rs13010002</a></p>
<p><a class="reference external" href="https://doi.org/10.1029/2023JD040179" rel="noreferrer" target="_blank">[9]</a> Lenssen, N., G.A. Schmidt, M. Hendrickson, P. Jacobs, M. Menne, and R. Ruedy, 2024: A GISTEMPv4 observational uncertainty ensemble. J. Geophys. Res. Atmos., 129, no. 17, e2023JD040179, doi:10.1029/2023JD040179.</p>
<p><a class="reference external" href="https://doi.org/full/10.1029/2018GL077598" rel="noreferrer" target="_blank">[10]</a> Stephens, G. L., Hakuba, M. Z., Webb, M. J., Lebsock, M., Yue, Q., Kahn, B. H., et al. (2018). Regional intensification of the tropical hydrological cycle during ENSO. Geophysical Research Letters, 45, 4361‚Äì4370. <a class="reference external" href="https://doi.org/10.1029/2018GL077598" rel="noreferrer" target="_blank">https://doi.org/10.1029/2018GL077598</a></p>
<p><a class="reference external" href="https://doi.org/10.1038/s41558-018-0246-2" rel="noreferrer" target="_blank">[11]</a> Staten, P.W., Lu, J., Grise, K.M. et al. Re-examining tropical expansion. Nature Clim Change 8, 768‚Äì775 (2018). <a class="reference external" href="https://doi.org/10.1038/s41558-018-0246-2" rel="noreferrer" target="_blank">https://doi.org/10.1038/s41558-018-0246-2</a></p>
<p><a class="reference external" href="https://acp.copernicus.org/articles/21/1015/2021/" rel="noreferrer" target="_blank">[12]</a> Stubenrauch, C. J., Caria, G., Protopapadaki, S. E., and Hemmer, F.: 3D radiative heating of tropical upper tropospheric cloud systems derived from synergistic A-Train observations and machine learning, Atmos. Chem. Phys., 21, 1015‚Äì1034, <a class="reference external" href="https://doi.org/10.5194/acp-21-1015-2021" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-21-1015-2021</a>, 2021.</p>
<p><a class="reference external" href="https://acp.copernicus.org/articles/17/3845/2017/" rel="noreferrer" target="_blank">[13]</a> Protopapadaki, S. E., Stubenrauch, C. J., and Feofilov, A. G.: Upper tropospheric cloud systems derived from IR sounders: properties of cirrus anvils in the tropics, Atmos. Chem. Phys., 17, 3845‚Äì3859, <a class="reference external" href="https://doi.org/10.5194/acp-17-3845-2017" rel="noreferrer" target="_blank">https://doi.org/10.5194/acp-17-3845-2017</a>, 2017.</p>
<p><a class="reference external" href="https://doi.org/abs/10.1002/qj.49711749805" rel="noreferrer" target="_blank">[14]</a> Slingo, J.M. and Slingo, A. (1991), The response of a general circulation model to cloud longwave radiative forcing. II: Further studies. Q.J.R. Meteorol. Soc., 117: 333-364. <a class="reference external" href="https://doi.org/10.1002/qj.49711749805" rel="noreferrer" target="_blank">https://doi.org/10.1002/qj.49711749805</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmosphere_Physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmosphere_Physics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.1. </span>Atmosphere Physics</p>
      </div>
    </a>
    <a class="right-next"
       href="../Atmospheric_Composition/Atmospheric_Composition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-cloud-amount-and-relative-occurrence-of-specific-cloud-types">üåç Use case: Monitoring Cloud Amount and Relative Occurrence of Specific Cloud Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-how-did-high-level-clouds-change-during-the-last-decades-and-how-did-their-geographical-patterns-change-with-respect-to-surface-temperature-anomalies">‚ùì Quality assessment question: How did high-level clouds change during the last decades and how did their geographical patterns change with respect to surface temperature anomalies?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request">Define request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-cache">Define functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">Download and transform</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-occurrence-of-specific-cloud-types">Relative Occurrence of Specific Cloud Types</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interannual-variability">Interannual variability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#anomaly-patterns-link-to-the-global-surface-temperature">Anomaly Patterns link to the Global Surface Temperature</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-useful-material">Reference/Useful material</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>