
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Monitoring the impact of climate change on rainfall-related hazards in Svalbard with a global and a regional reanalysis dataset [Reanalysis]-[Intercomparison]-[Climate monitoring] &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-carra-single-levels_climate-monitoring_q01';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Monitoring the impact of climate change on rainfall-related hazards in Svalbard with a global and a regional reanalysis dataset [Reanalysis]-[Intercomparison]-[Climate monitoring]</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-carra-single-levels_climate-monitoring_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-carra-single-levels_climate-monitoring_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Monitoring the impact of climate change on rainfall-related hazards in Svalbard with a global and a regional reanalysis dataset [Reanalysis]-[Intercomparison]-[Climate monitoring]</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard">üåç Use case: Monitoring the impact of climate change on rainfall-related hazards in Svalbard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-datasets">Description of the datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5">ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#carra">CARRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weather-stations">Weather stations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-datasets">Download datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Weather stations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses">Reanalyses</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-of-2m-temperature-and-total-precipitation">Preparation of 2m temperature and total precipitation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-temperature-and-precipitation-from-era5-and-carra">Prepare temperature and precipitation from ERA5 and CARRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-temperature-and-precipitation-from-the-weather-stations">Prepare temperature and precipitation from the weather stations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observational-gaps">Observational gaps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-2m-temperature">Reanalyses vs observations: 2m temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-total-precipitation">Reanalyses vs observations: total precipitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-rain-on-snow-events">Reanalyses vs observations: rain-on-snow events</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard-with-a-global-and-a-regional-reanalysis-dataset-reanalysis-intercomparison-climate-monitoring">
<h1><span class="section-number">3.1. </span>Monitoring the impact of climate change on rainfall-related hazards in Svalbard with a global and a regional reanalysis dataset [Reanalysis]-[Intercomparison]-[Climate monitoring]<a class="headerlink" href="#monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard-with-a-global-and-a-regional-reanalysis-dataset-reanalysis-intercomparison-climate-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 05-11-2025</p>
<p>Produced by: Fabio Mangini, Nansen Environmental and Remote Sensing Center (NERSC)</p>
<section id="use-case-monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard">
<h2>üåç Use case: Monitoring the impact of climate change on rainfall-related hazards in Svalbard<a class="headerlink" href="#use-case-monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How well do CARRA and ERA5 reproduce variations in temperature, precipitation, and frequency of rain-on-snow events across Svalbard?</strong></p></li>
<li><p><strong>Can CARRA be used to assess whether the frequency of rain-on-snow events has changed across Svalbard over the last three decades?</strong></p></li>
</ul>
<p>Rain-on-snow (ROS) events occur when rain falls over pre-existing snowpacks and freezes. As it freezes, rain forms a layer of ice that can potentially threaten wildlife and human communities (e.g., Peeters et al., 2019). The relevance of ROS events is particularly pronounced over Svalbard due to the intense warming that has affected the region in the last decades (Hanssen-Bauer et al., 2019). To illustrate, the annual-mean temperature averaged over Svalbard increased by 0.87¬∞C/decade between 1971 and 2017, while the global-averaged temperature raised by slightly more than one fifth over the same period (Wickstr√∂m et al., 2020). This change, which is the local manifestation of a larger-scale phenomenon known as Arctic Amplification (Rantanen et al., 2022), might have modified the frequency of occurrence of ROS events in the region (Hansen et al., 2014) and might continue to do so in the future. Therefore, studying ROS events in Svalbard is important to develop efficient and timely solutions to the challenges caused by ROS events.</p>
<p>The present assessment aims to analyse the ability of the Copernicus Arctic Regional Reanalysis (CARRA) dataset to study ROS events over Svalbard. CARRA is a regional reanalysis dataset that covers the European sector of the Arctic. It is of interest because it can potentially benefit Arctic climate studies by partly overcoming the limitations of the current observing and modelling systems. For example, CARRA could supplement in-situ observations in the Arctic by compensating for their temporal gaps and limited spatial coverage. Additionally, thanks to its spatial resolution of 2.5km, CARRA could complement the ERA5 global reanalysis dataset (Hersbach et al., 2020) which might not capture small-spatial scale features due to its spatial resolution of 0.25¬∞x0.25¬∞. Despite its potential, though, the quality of CARRA first needs to be checked. In this respect, the choice of Svalbard is convenient because the CARRA dataset includes two domains that, respectively, cover the western and eastern sectors of the European Arctic. Svalbard lies within both domains. So, the choice of Svalbard helps assess and compare the performance of CARRA‚Äôs two domains.</p>
<p>Several recent papers assess the quality of the CARRA reanalysis dataset. For example, Box et al. (2023) address the ability of CARRA to reproduce and explain rainfall events over Greenland, while Batrak et al. (2024) highlight both strengths and limitations of CARRA in representing sea-ice cover. For a thorough list of scientific studies that employ CARRA in their analysis, the interested reader is referred to the following webpage on the C3S Knowledge Base website: <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+Arctic+Regional+Reanalysis+%28CARRA%29%3A+list+of+references" rel="noreferrer" target="_blank">Copernicus Arctic Regional Reanalysis (CARRA): list of references</a>.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Overall, CARRA reproduces the winter-time number of rain-on-snow events over Svalbard more accurately than ERA5, as evidenced by observational data. Particularly CARRA-East is performing better than CARRA-West. This result agrees with the CARRA documentation, which recommends to use CARRA-East for the Svalbard archipelago, as Svalbard is located farther away from the boundaries of the CARRA-East domain than of the CARRA-West domain.</p></li>
<li><p>Overall, CARRA-West and CARRA-East provide more accurate values of 2m temperature and total precipitation than ERA5 over the Svalbard archipelago when compared to observations.</p></li>
<li><p>ERA5 tends to agree less with observations when compared to CARRA, but still returns results that are physically meaningful.</p></li>
<li><p>The 2m temperature from ERA5, CARRA-West, and CARRA-East poorly agrees with observations at the Verlegenhuken weather station in February 1998. Further analysis is needed to determine where the problem lies.</p></li>
<li><p>Both the observational and the reanalysis datasets suggest that timeseries longer than those used in this assessment (December 1990 - February 2022) would help determine whether the frequency of occurrence of rain-on-snow events over Svalbard has increased.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This assessment investigates the potential of ERA5 and CARRA to capture ROS events over Svalbard. The assessment begins with a comparison of the 2m temperature and total precipitation provided by the reanalysis datasets and five weather stations in the region (Fig. 1). Even though the temperature provided by some of these weather stations has been assimilated into the reanalysis datasets, as indicated by Fig. 2.2.7.1 in the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+Arctic+Regional+Reanalysis+%28CARRA%29%3A+Full+system+documentation" rel="noreferrer" target="_blank">C3S Arctic regional reanalysis ‚Äì Full system documentation</a> (last access on 27/12/2024), this preliminary quality assessment can help understand the overall performance of the datasets.</p>
<p>This initial evaluation is followed by a comparison and a description of the number of ROS events over Svalbard as provided by the observations and the reanalysis datasets, and by a brief assessment of whether the number of ROS events in the region has increased between December 1990 and February 2022.</p>
<p>The analysis and results are organized as follows:</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-1"><span class="std std-ref">Import required packages</span></a></strong></p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-2"><span class="std std-ref">Description of the datasets</span></a></strong></p>
<ul class="simple">
<li><p>ERA5</p></li>
<li><p>CARRA</p></li>
<li><p>Weather stations</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-3"><span class="std std-ref">Download datasets</span></a></strong></p>
<ul class="simple">
<li><p>Weather stations</p></li>
<li><p>Reanalyses</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-3"><span class="std std-ref">Download datasets</span></a></strong></p>
<ul class="simple">
<li><p>Prepare temperature and precipitation from ERA5 and CARRA</p></li>
<li><p>Prepare temperature and precipitation from the weather stations</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-4"><span class="std std-ref">Preparation of 2m temperature and total precipitation</span></a></strong></p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-5"><span class="std std-ref">Observational gaps</span></a></strong></p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-6"><span class="std std-ref">Reanalyses vs observations: 2m temperature</span></a></strong></p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-7"><span class="std std-ref">Reanalyses vs observations: total precipitation</span></a></strong></p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-8"><span class="std std-ref">Reanalyses vs observations: rain-on-snow events</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="import-required-packages">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-1"></span><h3>Import required packages<a class="headerlink" href="#import-required-packages" title="Link to this heading">#</a></h3>
<p>The assessment is based on a set of python packages that are widely used by the climate community, with the addition of the ‚Äòc3s_eqc_automatic_quality_control‚Äô package, which is needed to include the ‚ÄúC3S EQC custom functions‚Äù prepared by B-Open.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mticker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.gridliner</span><span class="w"> </span><span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">plot</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="description-of-the-datasets">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-2"></span><h3>Description of the datasets<a class="headerlink" href="#description-of-the-datasets" title="Link to this heading">#</a></h3>
<section id="era5">
<h4>ERA5<a class="headerlink" href="#era5" title="Link to this heading">#</a></h4>
<p>This assessment uses 2m temperature and total precipitation from the ERA5 global reanalysis dataset (Hersbach et al., 2020).</p>
<p>The dataset has a spatial resolution of 0.25¬∞x0.25¬∞. The 2m temperature has a temporal resolution of 1 hour. The total precipitation is accumulated over a 1-hour period ending at the validity date and time.</p>
</section>
<section id="carra">
<h4>CARRA<a class="headerlink" href="#carra" title="Link to this heading">#</a></h4>
<p>This assessment uses 2m temperature and total precipitation from the CARRA regional reanalysis dataset.</p>
<p>The data have a spatial resolution of 2.5km. The 2m temperature is provided with a temporal resolution of 3 hours. The total precipitation is an accumulated variable based on forecasts which are started from the CARRA reanalysis. Daily precipitation are computed using the start times 00:00 and 12:00 and leadtime hours of 6 and 18 hours to allow a comparison with the weather stations (see below). Information on how to compute daily aggregated precipitation from CARRA can be found at: <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=338485814" rel="noreferrer" target="_blank">The use of precipitation information from the Copernicus Arctic Regional Reanalysis (CARRA)</a>.</p>
</section>
<section id="weather-stations">
<h4>Weather stations<a class="headerlink" href="#weather-stations" title="Link to this heading">#</a></h4>
<p>Following Wickstr√∂m et al. (2020), this assessment considers 5 weather stations in Svalbard, namely:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>- Verlegenhuken
- Edge√∏ya - Kapp Heuglin
- S√∏rkapp√∏ya 
- Svalbard Lufthavn
- Ny-√Ölesund 
</pre></div>
</div>
<p>which are shown in Fig. 1.</p>
<p>Daily values of temperature and precipitation at each weather station were downloaded from <a class="reference external" href="https://seklima.met.no/" rel="noreferrer" target="_blank">https://seklima.met.no/</a> We should note that the daily values of precipitation provided by the weather stations are accumulated between time 06:00
of given day and time 06:00 of the following day. Moreover, the timestamp associated with the downloaded daily accumulated
precipitation refers to the day when the recording ends. Both pieces of information need to be taken into account when
one compares the weather stations and the reanalysis datasets.</p>
<p>The temperature values provided by some of the weather stations have been assimilated into ERA5 and CARRA. For instance, for the recent period, CARRA assimilated temperature values at Verlegenhuken, Edge√∏ya - Kapp Heuglin, Ny-√Ölesund, S√∏rkapp√∏ya, and Svalbard Lufthavn (Dr. Xiaohua Yang, personal communication), while ERA5 assimilated temperature values at Verlegenhuken, Edge√∏ya - Kapp Heuglin, Ny-√Ölesund, and Svalbard Lufthavn (Dr. Cornel Soci, personal communication). We should note, however, that these weather stations have not been assimilated over the entire period considered. For example, CARRA started assimilating Verlegenhuken in 2003 (Dr. Xiaohua Yang, personal communication).</p>
</section>
</section>
<section id="download-datasets">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-3"></span><h3>Download datasets<a class="headerlink" href="#download-datasets" title="Link to this heading">#</a></h3>
<section id="id1">
<h4>Weather stations<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>As previously explained, this work first aims to assess the ability of CARRA and ERA5 to reproduce temperature, total precipitation, and frequency of ROS events over Svalbard. Then, its focus shifts towards determining whether the frequency of ROS events in the region has increased over the past few decades. For these reasons, here we download the daily-averaged temperature and the daily-accumulated precipitation provided by five weather stations in Svalbard.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">load_weather_stations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function loads daily-averaged temperature and daily-accumulated precipitation data from the Svalbard weather stations </span>
<span class="sd">    included in this study, and stores them in a pandas DataFrame. </span>
<span class="sd">    It also returns the name and geographic coordinates of each weather station. </span>
<span class="sd">    </span>
<span class="sd">    Results</span>
<span class="sd">    -------</span>
<span class="sd">    df_sts : pd.DataFrame</span>
<span class="sd">        Each row contains values of daily-averaged temperature and daily-accumulated precipitation recorded by one</span>
<span class="sd">        of the weather stations included in this study. Additionally, each row provides the station&#39;s </span>
<span class="sd">        name, ID, and the date of the observation.</span>
<span class="sd">        </span>
<span class="sd">    names_sts : list</span>
<span class="sd">        Name of the Svalbard weather stations included in this study. </span>

<span class="sd">    lons_sts, lats_sts : list, list </span>
<span class="sd">        Coordinates of the weather stations (found at https://seklima.met.no/stations/)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load weather stations</span>
    <span class="c1"># Missing values, indicated with &#39;-&#39;, are replaced with NaNs</span>
    <span class="n">df_sts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../T_Precip_at_5_Svalbard_weather_stations.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> 

    <span class="c1"># Rename some columns </span>
    <span class="n">df_sts</span> <span class="o">=</span> <span class="n">df_sts</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Station&#39;</span><span class="p">:</span><span class="s1">&#39;Station_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Time(norwegian mean time)&#39;</span><span class="p">:</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean air temperature (24 h)&#39;</span><span class="p">:</span><span class="s1">&#39;Daily_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Precipitation (24 h)&#39;</span><span class="p">:</span><span class="s1">&#39;Daily_precipitation&#39;</span><span class="p">})</span>

    <span class="c1"># Rename station: from &#39;Ny-√•lesund&#39; into &#39;Ny-√Ölesund&#39; </span>
    <span class="n">df_sts</span> <span class="o">=</span> <span class="n">df_sts</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Ny-√•lesund&#39;</span><span class="p">,</span> <span class="s1">&#39;Ny-√Ölesund&#39;</span><span class="p">))</span>
    
    <span class="c1"># Name of the weather stations</span>
    <span class="c1"># With [:-1], we exclude the following string that is in the data: </span>
    <span class="c1">#    &#39;Data er gyldig per 30.12.2023 (CC BY 4.0), Meteorologisk institutt (MET)&#39;</span>
    <span class="n">names_sts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df_sts</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">])[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># We manually insert the coordinates of the weather stations (found at https://seklima.met.no/stations/)</span>
    <span class="n">lons_sts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">22.8225</span><span class="p">,</span> <span class="mf">16.2433</span><span class="p">,</span> <span class="mf">16.5428</span><span class="p">,</span> <span class="mf">11.9325</span><span class="p">,</span> <span class="mf">15.5015</span><span class="p">]</span>
    <span class="n">lats_sts</span> <span class="o">=</span> <span class="p">[</span><span class="mf">78.2508</span><span class="p">,</span> <span class="mf">80.0555</span><span class="p">,</span> <span class="mf">76.4733</span><span class="p">,</span> <span class="mf">78.9218</span><span class="p">,</span> <span class="mf">78.2453</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span>

<span class="k">def</span><span class="w"> </span><span class="nf">map_svalbard_weather_stations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a map of Svalbard displaying the location of the weather stations included in this study. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load name and coordinates of each weather station </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 
    
    <span class="c1"># Draw figure </span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span> <span class="n">central_longitude</span><span class="o">=</span><span class="mi">20</span><span class="p">)})</span>

    <span class="c1"># Draw the coastline of Svalbard and highlight the location of the weather stations </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mf">75.5</span><span class="p">,</span><span class="mi">81</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="c1"># Write down the name of the weather stations</span>
    <span class="n">d_lon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
    <span class="n">d_lat</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">]</span>
    <span class="n">has</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]</span> 
    <span class="k">for</span> <span class="n">i_st</span><span class="p">,</span> <span class="n">name_st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names_sts</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">lons_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">]</span><span class="o">+</span><span class="n">d_lon</span><span class="p">[</span><span class="n">i_st</span><span class="p">],</span> <span class="n">lats_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">]</span><span class="o">+</span><span class="n">d_lat</span><span class="p">[</span><span class="n">i_st</span><span class="p">],</span> <span class="n">name_st</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="n">has</span><span class="p">[</span><span class="n">i_st</span><span class="p">],</span>
                <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;regular&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="c1"># Draw coordinates </span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">([</span><span class="mf">77.5</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Location of the weather stations </span>
<span class="n">map_svalbard_weather_stations</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/75bcbb8b78900a35117cc805e2c34bf5b9e5d5a26b1e853f2f9005e7f6f89758.png" src="../_images/75bcbb8b78900a35117cc805e2c34bf5b9e5d5a26b1e853f2f9005e7f6f89758.png" />
</div>
</div>
<p><em>Fig. 1: Map of the Svalbard archipelago with the locations and names of the weather stations included in the study.</em></p>
</section>
<section id="reanalyses">
<h4>Reanalyses<a class="headerlink" href="#reanalyses" title="Link to this heading">#</a></h4>
<p>Here, we download 2m temperature and total precipitation from ERA5 and CARRA between 8¬∞E and 30¬∞E and between 76¬∞N and 81¬∞N during the winter days (December-January-February) between December 1990 and February 2022.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1990</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2022</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">81</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

<span class="c1"># Request</span>
<span class="n">request_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CARRA_analysis&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;reanalysis-carra-single-levels&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;level_type&quot;</span><span class="p">:</span> <span class="s2">&quot;surface_or_atmosphere&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hour</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span>
        <span class="p">},</span>
    <span class="p">),</span>
    <span class="s2">&quot;CARRA_forecast&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;reanalysis-carra-single-levels&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;level_type&quot;</span><span class="p">:</span> <span class="s2">&quot;surface_or_atmosphere&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;total_precipitation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;forecast&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;12:00&quot;</span><span class="p">],</span>
            <span class="s2">&quot;leadtime_hour&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">),</span>
    <span class="s2">&quot;ERA5_t2m&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hour</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)],</span>
            <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">),</span>
    <span class="s2">&quot;ERA5_precip&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;total_precipitation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hour</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)],</span>
            <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">),</span>
<span class="p">}</span>

<span class="n">time_requests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)],</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">],</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="p">},</span>
<span class="p">]</span>

<span class="c1"># Download and transform</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span> <span class="ow">in</span> <span class="n">request_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">product</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;CARRA&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">domain</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;east&quot;</span><span class="p">,</span> <span class="s2">&quot;west&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">datasets</span><span class="p">[</span><span class="n">product</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                <span class="n">collection_id</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain</span><span class="si">}</span><span class="s2">_domain&quot;</span><span class="p">}</span> <span class="o">|</span> <span class="n">time_request</span>
                    <span class="k">for</span> <span class="n">time_request</span> <span class="ow">in</span> <span class="n">time_requests</span>
                <span class="p">],</span>
                <span class="n">transform_func</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">,</span>
                <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                    <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="p">},</span>
                <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">product</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ERA5&quot;</span><span class="p">):</span>
        <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span>
            <span class="p">[</span><span class="n">request</span> <span class="o">|</span> <span class="n">time_request</span> <span class="k">for</span> <span class="n">time_request</span> <span class="ow">in</span> <span class="n">time_requests</span><span class="p">],</span>
            <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;CARRA_analysis&#39;
domain=&#39;east&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:15&lt;00:00,  4.06it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>domain=&#39;west&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:18&lt;00:00,  3.38it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;CARRA_forecast&#39;
domain=&#39;east&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:25&lt;00:00,  2.50it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>domain=&#39;west&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:21&lt;00:00,  2.97it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/c3s_eqc_automatic_quality_control/download.py:625: FutureWarning: In a future version, xarray will not decode the variable &#39;leadtime&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  ds = xr.open_mfdataset(sources, **cached_open_mfdataset_kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;ERA5_t2m&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:05&lt;00:00, 12.04it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/utils/kwargs.py:59: UserWarning: In xarray_open_dataset_kwargs backend_kwargs, overriding the default value (squeeze=False) with squeeze=True is not recommended.
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product=&#39;ERA5_precip&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 64/64 [00:06&lt;00:00,  9.51it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/utils/kwargs.py:59: UserWarning: In xarray_open_dataset_kwargs backend_kwargs, overriding the default value (squeeze=False) with squeeze=True is not recommended.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="preparation-of-2m-temperature-and-total-precipitation">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-4"></span><h3>Preparation of 2m temperature and total precipitation<a class="headerlink" href="#preparation-of-2m-temperature-and-total-precipitation" title="Link to this heading">#</a></h3>
<section id="prepare-temperature-and-precipitation-from-era5-and-carra">
<h4>Prepare temperature and precipitation from ERA5 and CARRA<a class="headerlink" href="#prepare-temperature-and-precipitation-from-era5-and-carra" title="Link to this heading">#</a></h4>
<p>The winter-time 2m temperature and total precipitation from ERA5 and CARRA need to be reprocessed to allow for a comparison with observations. This requires the 2m temperature provided by the reanalysis datasets to be daily averaged and converted from K to ¬∞C. Furthermore, for simplicity, the 29th of February is also removed from the analysis.</p>
<p>The total precipitation provided by ERA5 and CARRA is reprocessed to obtain the winter-time daily-aggregated values of precipitation. More precisely, for the reanalysis datasets to be comparable with observations, we compute the total precipitation that accumulated between the time 06:00 of the day under consideration and the time 06:00 of the following day. Furthermore, as with the 2m temperature, we exclude from the analysis the total precipitation corresponding to the 29th of February.</p>
<p>The reprocessing procedure to compute daily-aggregated values of total precipitation differs from ERA5 and CARRA. This is because ERA5 returns values of total precipitation accumulated over a 1-hour period ending at the validity date and time. So, daily-accumulated values are computed by adding up the total precipitation accumulated between the time 06:00 of one day and the time 06:00 of the day after. Instead, CARRA returns total precipitation accumulated since the start time of the forecast, and this is provided for different leadtime hours. For this assessment, we compute daily precipitation with the start times 00:00 and 12:00 and leadtime hours of 6 and 18 hours.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_temperature_single_reanalysis</span><span class="p">(</span><span class="n">da_t2m</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the 2m-temperature from CARRA or ERA5, this function:</span>
<span class="sd">        - daily averages the 2m temperature</span>
<span class="sd">        - selects the winter days (December-January-February) and excludes the 29th of February </span>
<span class="sd">        - converts the temperature from K to ¬∞C</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da_t2m : xr.DataArray</span>
<span class="sd">        DataArray with either ERA5&#39;s or CARRA&#39;s 2m temperature over Svalbard. </span>
<span class="sd">        Data have a temporal resolution of 1 hour for ERA5, and 3 hours for CARRA. </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">          </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    da_daily_djf_t2m : xr.DataArray</span>
<span class="sd">        Either ERA5&#39;s or CARRA&#39;s daily-averaged 2m temperature over Svalbard in winter. </span>
<span class="sd">        See the function description for information on the reprocessing. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Daily average the 2m temperature </span>
    <span class="n">da_daily_t2m</span> <span class="o">=</span> <span class="n">da_t2m</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># Only select the winter days (December-January-February) and exclude the 29th of February </span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>

    <span class="n">dates_no_2902</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">))]</span>

    <span class="n">da_daily_djf_t2m</span> <span class="o">=</span> <span class="n">da_daily_t2m</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="n">dates_no_2902</span><span class="p">)</span>
    
    <span class="c1"># Conversion from K to ¬∞C</span>
    <span class="n">da_daily_djf_t2m</span> <span class="o">=</span> <span class="n">da_daily_djf_t2m</span> <span class="o">-</span> <span class="mf">273.15</span>

    <span class="k">return</span> <span class="n">da_daily_djf_t2m</span> 
    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_temperature_reanalyses</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the 2m-temperature from CARRA and ERA5, this function:</span>
<span class="sd">        - daily averages the 2m temperature</span>
<span class="sd">        - only selects the winter days (December-January-February) and excludes the 29th of February </span>
<span class="sd">        - converts the temperature from K to ¬∞C </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dc : dict</span>
<span class="sd">        Dictionary with ERA5&#39;s and CARRA&#39;s 2m temperature and accumulated precipitation over Svalbard.  </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">          </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    da_era5_t2m, da_carra_west_t2m, da_carra_east_t2m : xr.DataArray</span>
<span class="sd">        ERA5&#39;s and CARRA&#39;s daily-averaged 2m temperature over Svalbard in winter. </span>
<span class="sd">        See the function description for information on the reprocessing.       </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ERA5</span>
    <span class="n">da_era5_t2m</span> <span class="o">=</span>  <span class="n">daily_temperature_single_reanalysis</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;ERA5_t2m&#39;</span><span class="p">][</span><span class="s1">&#39;t2m&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> 
    
    <span class="c1"># CARRA</span>
    <span class="n">da_carra_west_t2m</span> <span class="o">=</span> <span class="n">daily_temperature_single_reanalysis</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;CARRA_analysis_west&#39;</span><span class="p">][</span><span class="s1">&#39;t2m&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">da_carra_east_t2m</span> <span class="o">=</span> <span class="n">daily_temperature_single_reanalysis</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;CARRA_analysis_east&#39;</span><span class="p">][</span><span class="s1">&#39;t2m&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>

    <span class="c1"># Load datasets</span>
    <span class="n">da_era5_t2m</span> <span class="o">=</span> <span class="n">da_era5_t2m</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">da_carra_west_t2m</span> <span class="o">=</span> <span class="n">da_carra_west_t2m</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">da_carra_east_t2m</span> <span class="o">=</span> <span class="n">da_carra_east_t2m</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">da_era5_t2m</span><span class="p">,</span> <span class="n">da_carra_west_t2m</span><span class="p">,</span> <span class="n">da_carra_east_t2m</span>
    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_precipitation_era5</span><span class="p">(</span><span class="n">da_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes the daily accumulated precipitation for winter (December-January-February) from ERA5.  </span>
<span class="sd">    To compute the daily accumulated precipitation, it follows this procedure:</span>
<span class="sd">        1) it removes duplicated dates </span>
<span class="sd">           (the timestamp &quot;31/12 at 18:00&quot; appears twice each year in the dataset)</span>
<span class="sd">        2) it removes the 30th of Nov of each year </span>
<span class="sd">        3) for each day and at each grid point, it computes the total precipitation that accumulated between the time 06:00 of the </span>
<span class="sd">           day under consideration and the time 06:00 of the following day. This is needed because the weather stations provide</span>
<span class="sd">           the precipitation accumulated between time 06:00 of one day and time 06:00 of the following day. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da_tp : xr.DataArray</span>
<span class="sd">        DataArray with accumulated precipitation data over Svalbard as provided by ERA5. </span>
<span class="sd">        Leadtime hours are referenced to time 06:00 and 18:00 of each day. </span>
<span class="sd">        Accumulations are over the hour (the processing period) ending at the forecast step. </span>
<span class="sd">        Units are m. </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    da_daily_djf_tp : xr.DataArray</span>
<span class="sd">        ERA5&#39;s daily-accumulated precipitation over Svalbard in winter. </span>
<span class="sd">        See the function description for information on the reprocessing. </span>
<span class="sd">        Units are mm. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Remove duplicated dates (needed because the timestamp &quot;31/12 at 18:00&quot; appears twice each year in the dataset)</span>
    <span class="n">da_tp</span> <span class="o">=</span> <span class="n">da_tp</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">)</span>

    <span class="c1"># Remove 30th of Nov</span>
    <span class="n">nov30_all_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)]</span>
    <span class="n">da_tp</span> <span class="o">=</span> <span class="n">da_tp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">nov30_all_years</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">)</span>

    <span class="c1"># Compute daily aggregated precipitation: </span>
    <span class="c1">#     - for each day </span>
    <span class="c1">#     - at each grid point </span>
    <span class="n">da_daily_tp</span> <span class="o">=</span> <span class="n">da_tp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;leadtime&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> 

    <span class="c1"># Conversion from m to mm</span>
    <span class="n">da_daily_tp</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="o">*</span> <span class="n">da_daily_tp</span> 

    <span class="c1"># Only select the winter days (December-January-February) and exclude the 29th of February </span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>
    
    <span class="n">dates_no_2902</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">))]</span>    
    
    <span class="n">da_daily_djf_tp</span> <span class="o">=</span> <span class="n">da_daily_tp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="n">dates_no_2902</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">da_daily_djf_tp</span> 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_precipitation_carra</span><span class="p">(</span><span class="n">da_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes the winter-time daily precipitation accumulated between 06 UTC and 06 UTC the next day as provided </span>
<span class="sd">    by CARRA-West or CARRA-East. </span>
<span class="sd">    More precisely, this function: </span>
<span class="sd">        - subtracts values with leadtime 18 and 6</span>
<span class="sd">        - separates starting times at midnight and noon </span>
<span class="sd">        - sums the results</span>

<span class="sd">    For information on how to compute daily accumulated precipitation, please check the following webpage:  </span>

<span class="sd">        - https://confluence.ecmwf.int/pages/viewpage.action?pageId=338485814</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da_tp : xr.DataArray</span>
<span class="sd">        DataArray with accumulated precipitation data over Svalbard from CARRA. </span>
<span class="sd">        Leadtime hours are referenced to time 00:00 and 12:00 of each day. </span>
<span class="sd">        Accumulations are between the reference time and the ending of each forecast step. </span>
<span class="sd">        Units are mm. </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">            </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    da_daily_djf_tp : xr.DataArray</span>
<span class="sd">        Either CARRA-West or CARRA-East&#39;s daily-accumulated precipitation over Svalbard in winter. </span>
<span class="sd">        See the function description for information on the reprocessing. </span>
<span class="sd">        Units are mm. </span>
<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="c1"># Subtract values with leadtime 18 and 6    </span>
    <span class="n">da_tp_12h</span> <span class="o">=</span> <span class="n">da_tp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">leadtime</span><span class="o">=</span><span class="s1">&#39;18h&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da_tp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">leadtime</span><span class="o">=</span><span class="s1">&#39;6h&#39;</span><span class="p">)</span>

    <span class="c1"># Separates starting times at midnight and noon </span>
    <span class="n">da_tp_first_12h</span> <span class="o">=</span> <span class="n">da_tp_12h</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da_tp_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">da_tp_last_12h</span> <span class="o">=</span> <span class="n">da_tp_12h</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da_tp_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">12</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">da_tp_first_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">da_tp_first_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">da_tp_last_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">da_tp_last_12h</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    
    <span class="c1"># Sum the results </span>
    <span class="n">da_daily_tp</span> <span class="o">=</span> <span class="n">da_tp_first_12h</span> <span class="o">+</span> <span class="n">da_tp_last_12h</span>

    <span class="c1"># Only select the winter days (December-January-February) and exclude the 29th of February </span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>
    
    <span class="n">dates_no_2902</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">))]</span>    
    
    <span class="n">da_daily_djf_tp</span> <span class="o">=</span> <span class="n">da_daily_tp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="n">dates_no_2902</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">da_daily_djf_tp</span>
    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">daily_precipitation_reanalyses</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given the total precipitation from ERA5 and CARRA, this function computes the winter-time daily precipitation accumulated between </span>
<span class="sd">    06 UTC and 06 UTC the next day as provided by ERA5, CARRA-West, and CARRA-East. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dc : dict</span>
<span class="sd">        Dictionary with ERA5&#39;s and CARRA&#39;s 2m temperature and accumulated precipitation over Svalbard.  </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    da_era5_tp, da_carra_west_tp, da_carra_east_tp : xr.DataArray</span>
<span class="sd">        ERA5&#39;s and CARRA&#39;s daily-accumulated precipitation over Svalbard in winter. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ERA5</span>
    <span class="n">da_era5_tp</span> <span class="o">=</span>  <span class="n">daily_precipitation_era5</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;ERA5_precip&#39;</span><span class="p">][</span><span class="s1">&#39;tp&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> 
    
    <span class="c1"># CARRA</span>
    <span class="n">da_carra_west_tp</span> <span class="o">=</span> <span class="n">daily_precipitation_carra</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;CARRA_forecast_west&#39;</span><span class="p">][</span><span class="s1">&#39;tp&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">da_carra_east_tp</span> <span class="o">=</span> <span class="n">daily_precipitation_carra</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;CARRA_forecast_east&#39;</span><span class="p">][</span><span class="s1">&#39;tp&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>

    <span class="c1"># Load datasets</span>
    <span class="n">da_era5_tp</span> <span class="o">=</span> <span class="n">da_era5_tp</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">da_carra_west_tp</span> <span class="o">=</span> <span class="n">da_carra_west_tp</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
    <span class="n">da_carra_east_tp</span> <span class="o">=</span> <span class="n">da_carra_east_tp</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">da_era5_tp</span><span class="p">,</span> <span class="n">da_carra_west_tp</span><span class="p">,</span> <span class="n">da_carra_east_tp</span>
    
</pre></div>
</div>
</div>
</details>
</div>
<p>Daily-averaged temperatures</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_era5_t2m</span><span class="p">,</span> <span class="n">da_carra_west_t2m</span><span class="p">,</span> <span class="n">da_carra_east_t2m</span> <span class="o">=</span> <span class="n">daily_temperature_reanalyses</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Daily-aggregated precipitation</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_era5_tp</span><span class="p">,</span> <span class="n">da_carra_west_tp</span><span class="p">,</span> <span class="n">da_carra_east_tp</span> <span class="o">=</span> <span class="n">daily_precipitation_reanalyses</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="prepare-temperature-and-precipitation-from-the-weather-stations">
<h4>Prepare temperature and precipitation from the weather stations<a class="headerlink" href="#prepare-temperature-and-precipitation-from-the-weather-stations" title="Link to this heading">#</a></h4>
<p>We now store into two pandas dataframes the temperature and total precipitation provided by the weather stations.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">name_single_st</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function returns daily values of temperature and precipitation, along with the </span>
<span class="sd">    corresponding dates, at a single weather station in Svalbard.</span>
<span class="sd">    Use the parameter name_single_st to specify the station of interest.</span>

<span class="sd">    This function further filters observations to only consider:</span>
<span class="sd">        - the months of December, January, and February, with the exclusion of the 29th of February.  </span>
<span class="sd">        - the period over which we downloaded the ERA5&#39;s and CARRA&#39;s datasets. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_sts : pd.DataFrame</span>
<span class="sd">        It contains name, station ID, time, and daily temperature and precipitation</span>
<span class="sd">        for the selected weather stations in Svalbard. </span>
<span class="sd">    </span>
<span class="sd">    name_single_st : str</span>
<span class="sd">        Name of the weather station to extract.  </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        Select observations between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;. </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sr_single_st_t2m_djf : pd.Series</span>
<span class="sd">        Daily temperature values for the selected station, indexed by time.</span>
<span class="sd">        NB: It only includes winter months (Dec, Jan, Feb) with the exclusion of the 29th of February. </span>

<span class="sd">   sr_single_st_tp_djf : pd.Series</span>
<span class="sd">       Same as sr_single_st_t2m_djf, but for daily precipitation.     </span>
<span class="sd">   &quot;&quot;&quot;</span>

    <span class="c1"># Select weather station </span>
    <span class="n">df_single_st</span> <span class="o">=</span> <span class="n">df_sts</span><span class="p">[</span><span class="n">df_sts</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name_single_st</span><span class="p">]</span>
    <span class="n">df_single_st</span> <span class="o">=</span> <span class="n">df_single_st</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Station_ID&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_single_st</span> <span class="o">=</span> <span class="n">df_single_st</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">df_single_st</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Convert index from string to datetime using day-month-year format</span>
    <span class="n">df_single_st</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_single_st</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%Y&quot;</span><span class="p">)</span>


    <span class="c1"># Ensure dates are sorted because .loc requires a monotonic index.</span>
    <span class="c1"># The Ny-√Ölesund data are not in chronological order.</span>
    <span class="c1"># We use .resample(&#39;D&#39;).asfreq() instead of .sort_index() because the former</span>
    <span class="c1"># fills missing dates with NaNs. This is important since the station datasets</span>
    <span class="c1"># omit days with no temperature or precipitation records.</span>
    <span class="n">df_single_st</span> <span class="o">=</span> <span class="n">df_single_st</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">asfreq</span><span class="p">()</span>

    <span class="c1"># Extract temperature and precipitation, as the two variables are dealt with differently </span>
    <span class="n">sr_single_st_t2m</span> <span class="o">=</span> <span class="n">df_single_st</span><span class="p">[</span><span class="s1">&#39;Daily_temperature&#39;</span><span class="p">]</span>
    <span class="n">sr_single_st_tp</span> <span class="o">=</span> <span class="n">df_single_st</span><span class="p">[</span><span class="s1">&#39;Daily_precipitation&#39;</span><span class="p">]</span>

    <span class="c1"># The daily values of precipitation provided by the weather stations are accumulated between 06:00 </span>
    <span class="c1"># of given day and 06:00 of the following day. The timestamp associated with the downloaded daily accumulated </span>
    <span class="c1"># precipitation refers to the day when the recording ends.    </span>
    <span class="c1"># Here, we modify the timestamps associated to the daily-accumulated precipitation for them to refer to the day </span>
    <span class="c1"># when the recording starts. </span>
    <span class="n">sr_single_st_tp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">sr_single_st_tp</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span>
    
    <span class="c1"># Extend the pd.Series for it to cover all the winter months between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;. </span>
    <span class="c1"># The extension is needed because some of the weather stations do not go as back in time as to &#39;year_start-12-01&#39;. </span>
    <span class="c1"># NaN are placed in locations having no values in the previous index.   </span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">dates_djf</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">sr_single_st_t2m_djf</span> <span class="o">=</span> <span class="n">sr_single_st_t2m</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dates_djf</span><span class="p">)</span>
    <span class="n">sr_single_st_tp_djf</span> <span class="o">=</span> <span class="n">sr_single_st_tp</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dates_djf</span><span class="p">)</span>
    
    <span class="c1"># Remove 29th of Feburay</span>
    <span class="n">dates_djf_no_2902</span> <span class="o">=</span> <span class="n">dates_djf</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">dates_djf</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dates_djf</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">))]</span>
    <span class="n">sr_single_st_t2m_djf</span> <span class="o">=</span> <span class="n">sr_single_st_t2m_djf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates_djf_no_2902</span><span class="p">]</span>
    <span class="n">sr_single_st_tp_djf</span> <span class="o">=</span> <span class="n">sr_single_st_tp_djf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dates_djf_no_2902</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">sr_single_st_t2m_djf</span><span class="p">,</span> <span class="n">sr_single_st_tp_djf</span>


<span class="k">def</span><span class="w"> </span><span class="nf">group_weather_stations</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function groups into two pd.DataFrames the daily 2m temperature and total precipitation </span>
<span class="sd">    provided by the Svalbard&#39;s weather stations in winter between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        Needed to only select the observations between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_stations_t2m : pd.DataFrame</span>
<span class="sd">        Daily-averaged 2m temperature provided by each weather station between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;. </span>

<span class="sd">    df_stations_tp : pd.DataFrame</span>
<span class="sd">        Same as df_stations_t2m, but for total precipitation. </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the observations and the name of each weather station considered </span>
    <span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 

    <span class="n">sr_edgeoya_t2m</span><span class="p">,</span> <span class="n">sr_edgeoya_tp</span> <span class="o">=</span> <span class="n">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">sr_verlegenhuken_t2m</span><span class="p">,</span> <span class="n">sr_verlegenhuken_tp</span> <span class="o">=</span> <span class="n">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">sr_sorkappoya_t2m</span><span class="p">,</span> <span class="n">sr_sorkappoya_tp</span> <span class="o">=</span> <span class="n">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">sr_ny_alesund_t2m</span><span class="p">,</span> <span class="n">sr_ny_alesund_tp</span> <span class="o">=</span> <span class="n">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">sr_svalbard_lufthavn_t2m</span><span class="p">,</span> <span class="n">sr_svalbard_lufthavn_tp</span> <span class="o">=</span> <span class="n">reformat_weather_station_dataframe</span><span class="p">(</span><span class="n">df_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>

    <span class="c1"># pd.DataFrames where to store the weather stations </span>
    <span class="n">df_stations_t2m</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">names_sts</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">sr_edgeoya_t2m</span><span class="p">,</span> 
                                    <span class="n">names_sts</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">sr_verlegenhuken_t2m</span><span class="p">,</span> 
                                    <span class="n">names_sts</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sr_sorkappoya_t2m</span><span class="p">,</span> 
                                    <span class="n">names_sts</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">sr_ny_alesund_t2m</span><span class="p">,</span> 
                                    <span class="n">names_sts</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">sr_svalbard_lufthavn_t2m</span><span class="p">})</span>

    <span class="n">df_stations_tp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">names_sts</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">sr_edgeoya_tp</span><span class="p">,</span> 
                                   <span class="n">names_sts</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">sr_verlegenhuken_tp</span><span class="p">,</span> 
                                   <span class="n">names_sts</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sr_sorkappoya_tp</span><span class="p">,</span> 
                                   <span class="n">names_sts</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">sr_ny_alesund_tp</span><span class="p">,</span> 
                                   <span class="n">names_sts</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">sr_svalbard_lufthavn_tp</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_stations_tp</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two pd.DataFrames, one for temperature and the other for total precipitation </span>
<span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_stations_tp</span> <span class="o">=</span> <span class="n">group_weather_stations</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="observational-gaps">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-5"></span><h3>Observational gaps<a class="headerlink" href="#observational-gaps" title="Link to this heading">#</a></h3>
<p>To analyse temperature, precipitation, and ROS events over Svalbard, we first need to assess the number of missing values in the observations provided by the weather stations (Fig. 2). This evaluation helps determine the period covered by each weather station, and provides a qualitative understanding of whether the gaps in the observations could potentially influence the conclusions of the study.</p>
<p>Two weather stations, Svalbard Lufthavn and Ny-√Ölesund, offer a good coverage of temperature and precipitation over the selected period. The percentage of observations at these two stations surpasses 75% for the majority of the winter seasons, even reaching 100% in numerous occasions. The only exception is at Ny-√Ölesund during the 2004/2005 winter season, when the percentage of temperature observations ranges between 25 and 50%. The limited number of observational gaps makes us believe that the missing values might only little affect the estimates of ROS events.</p>
<p>The other three weather stations do not provide measurements for the total precipitation, but only for the 2m temperature. This means that ROS events can only be studied at Svalbard Lufthavn and Ny-√Ölesund.
However, the temperature observations at these three locations are valuable as they can be used to further evaluate the performace of ERA5 and CARRA. We also note that the remaining weather stations cover a subset of the selected period. The stations at S√∏rkapp√∏ya and Edge√∏ya - Kapp Heuglin provide, respectively, the shortest and the longest time series. The former starts in the 2010/2011 winter season, while the latter in the 1992/1993 winter season. Furthermore, we note significant gaps in the data collected by these three weather stations. For example, the station at Verlegenhuken has a three-winter gaps between December 2007 and February 2010.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">obs_percentage_per_djf_in_sts</span><span class="p">(</span><span class="n">df_sts_t2m</span><span class="p">,</span> <span class="n">df_sts_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates two subplots (one column, two rows).  </span>
<span class="sd">    The upper subplot shows the percentage of temperature observations recorded by each weather station </span>
<span class="sd">    for each winter (December-January-February) between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;. </span>
<span class="sd">    The lower subplot shows the same, but for precipitation. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_sts_t2m, df_sts_tp : pd.DataFrame </span>
<span class="sd">        Daily-averaged 2m temperature and daily-accumulated total precipitation at each of the selected </span>
<span class="sd">        weather stations for each winter day between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39;.  </span>
<span class="sd">    </span>
<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered.      </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the name of each weather station considered </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 

    <span class="n">n_sts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">names_sts</span><span class="p">)</span>
    <span class="n">n_winters</span> <span class="o">=</span> <span class="n">year_stop</span> <span class="o">-</span> <span class="n">year_start</span>

    <span class="c1"># Prepare the ticklabels for the x-axis.</span>
    <span class="n">set_xticks_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">year_start</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">set_xticks_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">year_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="n">year_stop</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">set_xticks_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">set_xticks_1</span><span class="p">]</span> 
    <span class="n">set_xticks_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">set_xticks_2</span><span class="p">]</span> 
    <span class="n">set_xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">set_xticks_1</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">set_xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">set_xticks</span><span class="p">,</span> <span class="n">set_xticks_2</span><span class="p">)</span>


    <span class="c1"># The variable `first_day_decembers` is used to exclude observations from spring (MAM), </span>
    <span class="c1"># summer (JJA), and autumn (SON). This adjustment is necessary because of how we </span>
    <span class="c1"># count observations within each winter season (see later in the function). </span>
    <span class="c1"># Without this, the process would also return counts for other seasons </span>
    <span class="c1"># (which happen to be zero in our case). </span>
    <span class="c1"># Example of `first_day_decembers`:</span>
    <span class="c1"># DatetimeIndex([&#39;1990-12-01&#39;, &#39;1991-12-01&#39;, &#39;1992-12-01&#39;, ...])</span>
    <span class="n">first_day_seasons</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;3MS&#39;</span><span class="p">)</span>
    <span class="n">first_day_decembers</span> <span class="o">=</span> <span class="n">first_day_seasons</span><span class="p">[</span><span class="n">first_day_seasons</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>

    <span class="c1"># Plot </span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mf">7.5</span><span class="p">))</span>

    <span class="c1"># colormap temperature</span>
    <span class="n">cmap_t2m</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span>
    <span class="n">norm_t2m</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">25</span><span class="p">],</span> <span class="mi">210</span><span class="p">)</span>

    <span class="c1"># colormap precipitation </span>
    <span class="n">cmap_tp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span>
    <span class="n">norm_tp</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">101</span><span class="p">:</span><span class="mi">25</span><span class="p">],</span> <span class="mi">210</span><span class="p">)</span>

    <span class="c1"># Run through all the stations </span>
    <span class="k">for</span> <span class="n">i_st</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sts</span><span class="p">):</span>

        <span class="n">name_st</span> <span class="o">=</span> <span class="n">names_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">]</span>
        
        <span class="c1"># Temperature subplot</span>
        <span class="n">sr_t2m</span> <span class="o">=</span> <span class="n">df_sts_t2m</span><span class="p">[</span><span class="n">name_st</span><span class="p">]</span>

        <span class="c1"># Count the number of observations within each 3-month period (starting from Dec of year_start)</span>
        <span class="c1"># Pick only the counts for DJFs </span>
        <span class="n">n_t2m</span> <span class="o">=</span> <span class="n">sr_t2m</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;3MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="n">first_day_decembers</span><span class="p">]</span>    
        <span class="n">pct_t2m</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">n_t2m</span> <span class="o">/</span> <span class="mi">90</span>    <span class="c1"># Percentage of observations over each winter</span>
        <span class="c1"># Winters with some observational gaps </span>
        <span class="n">p_t2m</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> 
                               <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="n">pct_t2m</span><span class="p">[(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_t2m</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> 
                               <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_t2m</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_t2m</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,)</span>
        <span class="c1"># In black, winters without observational gaps  </span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][</span><span class="n">pct_t2m</span><span class="o">==</span><span class="mi">100</span><span class="p">],</span> <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[</span><span class="n">pct_t2m</span><span class="o">==</span><span class="mi">100</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>    
        <span class="c1"># In white, winters when no observations were recorded </span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][</span><span class="n">pct_t2m</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[</span><span class="n">pct_t2m</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>    

        <span class="c1"># Precipitation subplot (same structure as for temperature)</span>
        <span class="n">sr_tp</span> <span class="o">=</span> <span class="n">df_sts_tp</span><span class="p">[</span><span class="n">name_st</span><span class="p">]</span>
        <span class="n">n_tp</span> <span class="o">=</span> <span class="n">sr_tp</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;3MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="n">first_day_decembers</span><span class="p">]</span>
        <span class="n">pct_tp</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">n_tp</span> <span class="o">/</span> <span class="mi">90</span>
        <span class="n">p_tp</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> 
                              <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> <span class="n">c</span><span class="o">=</span><span class="n">pct_tp</span><span class="p">[(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">pct_tp</span><span class="o">!=</span><span class="mi">100</span><span class="p">)],</span> 
                              <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_tp</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_tp</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,)</span>
        <span class="n">p_100</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][</span><span class="n">pct_tp</span><span class="o">==</span><span class="mi">100</span><span class="p">],</span> <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[</span><span class="n">pct_tp</span><span class="o">==</span><span class="mi">100</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">p_0</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">][</span><span class="n">pct_tp</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">i_st</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_winters</span><span class="p">)[</span><span class="n">pct_tp</span><span class="o">==</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        
    <span class="c1"># Set up x- and y-axes </span>
    <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_t2m</span><span class="p">,</span> <span class="n">p_tp</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_winters</span><span class="p">])</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">set_xticks</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">n_sts</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">names_sts</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">iax</span><span class="p">,</span> <span class="n">drawedges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Percentage of observations [%]&#39;</span><span class="p">)</span> 
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_percentage_per_djf_in_sts</span><span class="p">(</span><span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_stations_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/262f49a5d24dea42d29253ea73b96450e5ec2bbf8f5dceb7ab2f02d826c3467d.png" src="../_images/262f49a5d24dea42d29253ea73b96450e5ec2bbf8f5dceb7ab2f02d826c3467d.png" />
</div>
</div>
<p><em>Fig. 2: Percentage of daily observations recorded by each weather station in each winter season (December-January-February, with the exclusion of the 29th of February) between December 1990 and February 2022. The upper plot shows the results for temperature, whereas the lower plot for total precipitation. Empty circles highlight the winter seasons when no observations were recorded, whereas black circles the winter seasons without observational gaps.</em></p>
</section>
<section id="reanalyses-vs-observations-2m-temperature">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-6"></span><h3>Reanalyses vs observations: 2m temperature<a class="headerlink" href="#reanalyses-vs-observations-2m-temperature" title="Link to this heading">#</a></h3>
<p>Fig. 3 reveals a strong linear relationship between the daily-averaged 2m temperature from the weather stations and the reanalysis datasets, therefore suggesting good agreement overall. A closer examination, using both visual inspection and the standard deviation of the differences (STD_diff), indicates that CARRA-West and CARRA-East reproduce the day-to-day variability of 2m temperature better than ERA5 in the region. However, it should be noted, that the biases do not clearly help discriminate among the reanalysis datasets. For instance, ERA5 returns the smallest biases at two stations, Edge√∏ya - Kapp Heuglin and Verlegenhuken.</p>
<p>Despite the overall good agreement, the Verlegenhuken weather station stands out as an outlier, as it shows the largest discrepancy between observations and reanalyses. This discrepancy will be discussed below in more detail.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">dist_from_weather_station</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="p">,</span> <span class="n">lon_st</span><span class="p">,</span> <span class="n">lat_st</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the distance (in km) between a given weather station and each grid point </span>
<span class="sd">    of a reanalysis dataset.</span>

<span class="sd">    This computation is vectorized (not performed with a for-loop) for efficiency. </span>
<span class="sd">    To achieve this:</span>
<span class="sd">        - For ERA5: longitude and latitude (originally 1D arrays) are converted into </span>
<span class="sd">          two 2D NumPy arrays matching the shape of the ERA5 grid.</span>
<span class="sd">        - For CARRA-West and CARRA-East: longitude and latitude remain unchanged </span>
<span class="sd">          because they are already 2D.</span>
<span class="sd">        - For the weather station: longitude and latitude (two floats) remain unchanged.</span>
<span class="sd">  </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da_reanalysis : xr.DataArray</span>
<span class="sd">        The selected reanalysis dataset (ERA5, CARRA-West, or CARRA-East). </span>
<span class="sd">  </span>
<span class="sd">    lon_st, lat_st : float, float</span>
<span class="sd">        Longitude and latitude of the weather station. </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    d : np.array </span>
<span class="sd">        A 2D array (same shape as `da_reanalysis` spatial grid) containing the </span>
<span class="sd">        distance in kilometers between each grid point and the weather station.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="mf">6378.137</span>    <span class="c1"># Radius of the Earth (in km) </span>

    <span class="c1"># np.arrays containing the longitude and latitude of the reanalysis data. </span>
    <span class="c1"># These are 1D for ERA5, and 2D for CARRA-West and CARRA-East </span>
    <span class="n">lons_reanalysis</span> <span class="o">=</span> <span class="n">da_reanalysis</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span>
    <span class="n">lats_reanalysis</span> <span class="o">=</span> <span class="n">da_reanalysis</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># The &#39;if&#39; statement checks whether the reanalyis considered is ERA5. </span>
    <span class="c1"># If so, lons_reanalysis and lats_reanalysis are turned into 2D array</span>
    <span class="c1"># for them to have the shape of the ERA5&#39;s grid </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons_reanalysis</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lons_reanalysis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">lats_reanalysis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="o">.</span><span class="n">longitude</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Conversion: degrees to radians </span>
    <span class="n">lons_reanalysis_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lons_reanalysis</span><span class="p">)</span> 
    <span class="n">lats_reanalysis_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lats_reanalysis</span><span class="p">)</span> 
    <span class="n">lon_st_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lon_st</span><span class="p">)</span> 
    <span class="n">lat_st_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat_st</span><span class="p">)</span> 

    <span class="n">d</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lats_reanalysis_r</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat_st_r</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lats_reanalysis_r</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_st_r</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lons_reanalysis_r</span><span class="o">-</span><span class="n">lon_st_r</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">d</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select daily-averaged 2m temperature or daily-accumulated total precipitation </span>
<span class="sd">    from one of the following reanalysis datasets: ERA5, CARRA-West, or CARRA-East.</span>
<span class="sd">    </span>
<span class="sd">    The function retrieves the value of temperature or precipitation at the grid </span>
<span class="sd">    point closest to each weather station.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    da_reanalysis : xr.DataArray</span>
<span class="sd">        3D array </span>
<span class="sd">        Daily-averaged 2m-temperature or daily-accumulated total precipitation from ERA5, CARRA-West, or CARRA-East.  </span>
<span class="sd">        </span>
<span class="sd">    lons_sts, lats_sts : list, list</span>
<span class="sd">        Longitude and latitude of the weather stations.  </span>

<span class="sd">    names_sts : np.array</span>
<span class="sd">        Names of the selected weather stations. </span>

<span class="sd">    dates : pandas.core.indexes.datetimes.DatetimeIndex</span>
<span class="sd">        Dates considered -&gt; Dec, Jan, Feb months between year_start+&#39;-12-01&#39; and year_stop+&#39;-02-28&#39;, without the 29th of February </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_reanalysis_at_sts : pd.DataFrame</span>
<span class="sd">        Values of da_reanalysis at the grid points closest to the weather stations.  </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_sts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons_sts</span><span class="p">)</span>

    <span class="c1"># Arrays where to store the indices of the grid points closest to the weather stations. </span>
    <span class="n">ind_row_sts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_sts</span><span class="p">)</span>
    <span class="n">ind_col_sts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_sts</span><span class="p">)</span>

    <span class="c1"># Run through the weather stations </span>
    <span class="k">for</span> <span class="n">i_st</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sts</span><span class="p">):</span>

        <span class="c1"># Distance (in km) between the selected weather station and each grid point of the reanalysis dataset </span>
        <span class="n">d_from_st</span> <span class="o">=</span> <span class="n">dist_from_weather_station</span><span class="p">(</span><span class="n">da_reanalysis</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">],</span> <span class="n">lats_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">])</span>

        <span class="c1"># Row and column indices of the grid point closest to the weather station  </span>
        <span class="n">ind_row_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d_from_st</span><span class="p">)</span><span class="o">//</span><span class="n">d_from_st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ind_col_sts</span><span class="p">[</span><span class="n">i_st</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">d_from_st</span><span class="p">)</span><span class="o">%</span><span class="k">d_from_st</span>.shape[1]

    <span class="c1"># Select the values of da_reanalysis at each specific par (ind_row_sts[i_st], ind_col_sts[i_st]) location </span>
    <span class="c1"># with i_st ranging from 0 to n_sts (excluded) </span>
    <span class="n">da_ind_row_sts</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ind_row_sts</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Weather stations&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">da_ind_col_sts</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ind_col_sts</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Weather stations&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">da_reanalysis_at_sts</span> <span class="o">=</span> <span class="n">da_reanalysis</span><span class="p">[:,</span> <span class="n">da_ind_row_sts</span><span class="p">,</span> <span class="n">da_ind_col_sts</span><span class="p">]</span>

    <span class="n">df_reanalysis_at_sts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">da_reanalysis_at_sts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">names_sts</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_reanalysis_at_sts</span> 


<span class="k">def</span><span class="w"> </span><span class="nf">values_at_single_station</span><span class="p">(</span><span class="n">df_stations</span><span class="p">,</span> <span class="n">df_era5_at_sts</span><span class="p">,</span> <span class="n">df_carra_west_at_sts</span><span class="p">,</span> <span class="n">df_carra_east_at_sts</span><span class="p">,</span> <span class="n">name_st</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Select either the 2m temperature or total precipitation for a given weather station, </span>
<span class="sd">    then create two pandas DataFrames:</span>
<span class="sd">    </span>
<span class="sd">    1. The first DataFrame stores the values from the weather station alongside the</span>
<span class="sd">       corresponding values from ERA5, CARRA-West, and CARRA-East.</span>
<span class="sd">    2. The second DataFrame stores the differences between the values provided by each </span>
<span class="sd">       reanalysis dataset and by the weather station.  </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_stations : pd.DataFrame</span>
<span class="sd">        Timeseries of either the 2m temperature or the total precipitation provided by a weather station. </span>

<span class="sd">    df_era5_at_sts : pd.DataFrame</span>
<span class="sd">        Timeseries of either the 2m temperature or the total precipitation provided by ERA5 at the grid point closest to each weather station. </span>

<span class="sd">    df_carra_west_at_sts : pd.DataFrame</span>
<span class="sd">        Same as df_era5_at_sts, but for CARRA-West. </span>
<span class="sd">        </span>
<span class="sd">    df_carra_east_at_sts : pd.DataFrame</span>
<span class="sd">        Same as df_era5_at_sts, but for CARRA-East. </span>

<span class="sd">    name_st : str</span>
<span class="sd">        Name of the selected weather station.  </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_st : pd.DataFrame </span>
<span class="sd">        Time series, for the selected weather station, of either 2m temperature </span>
<span class="sd">        or total precipitation from the station itself and from the reanalysis datasets </span>
<span class="sd">        (ERA5, CARRA-West, and CARRA-East) at the nearest grid point.  </span>

<span class="sd">    df_diff_st : pd.DataFrame</span>
<span class="sd">        Time series of differences between each reanalysis dataset and the weather station&#39;s observations. </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># We select one weather station. We store into an individual pd.DataFrame either the 2m temperature or the </span>
    <span class="c1"># total precipitation provided by the weather station and by the reanalysis datasets at the grid point </span>
    <span class="c1"># closest to the station. </span>
    <span class="n">df_st</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Weather station&#39;</span><span class="p">:</span> <span class="n">df_stations</span><span class="p">[</span><span class="n">name_st</span><span class="p">],</span> 
                          <span class="s1">&#39;ERA5&#39;</span><span class="p">:</span> <span class="n">df_era5_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">],</span> 
                          <span class="s1">&#39;CARRA-West&#39;</span><span class="p">:</span> <span class="n">df_carra_west_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">],</span> 
                          <span class="s1">&#39;CARRA-East&#39;</span><span class="p">:</span> <span class="n">df_carra_east_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">]})</span>


    <span class="c1"># Compute the difference between each reanalysis dataset (ERA5, CARRA-West, CARRA-East) </span>
    <span class="c1"># and the weather station observations: (reanalysis ‚àí station).</span>
    <span class="n">df_diff_st</span> <span class="o">=</span> <span class="n">df_st</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="n">df_st</span><span class="p">[[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df_st</span><span class="p">[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">df_st</span><span class="p">,</span> <span class="n">df_diff_st</span> 


<span class="k">def</span><span class="w"> </span><span class="nf">values_at_all_stations</span><span class="p">(</span><span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_stations_tp</span><span class="p">,</span> <span class="n">da_era5_t2m</span><span class="p">,</span> <span class="n">da_era5_tp</span><span class="p">,</span> <span class="n">da_carra_west_t2m</span><span class="p">,</span> <span class="n">da_carra_west_tp</span><span class="p">,</span> <span class="n">da_carra_east_t2m</span><span class="p">,</span> <span class="n">da_carra_east_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extend the functionality of &quot;values_at_single_station&quot; to all weather stations. </span>
<span class="sd">    Furthermore, this function processes both the 2m tempetature and the total precipitation, storing </span>
<span class="sd">    the results into individual python dictionaries: </span>
<span class="sd">        - One dictionary contains pandas DataFrames for 2m temperature.</span>
<span class="sd">        - The other contains pandas DataFrames for total precipitation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_stations_t2m : pd.DataFrame</span>
<span class="sd">        Daily-averaged 2m temperature provided by the weather stations. </span>
<span class="sd">    </span>
<span class="sd">    df_stations_t2p : pd.DataFrame</span>
<span class="sd">        Daily-accumulated total precipitation provided by the weather stations. </span>

<span class="sd">    da_era5_t2m, da_era5_tp : xr.DataArray</span>
<span class="sd">        3D array </span>
<span class="sd">        2m-temperature and daily precipitation from ERA5. </span>

<span class="sd">    da_carra_west_t2m, da_carra_west_tp : xr.DataArray</span>
<span class="sd">        Same as da_era5_t2m and da_era5_tp, but for CARRA-West. </span>

<span class="sd">    da_carra_east_t2m, da_carra_east_tp : xr.DataArray</span>
<span class="sd">        Same as da_era5_t2m and da_era5_tp, but for CARRA-East. </span>

<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dc_t2m_at_sts : dict</span>
<span class="sd">        For each weather station, we store into a pd.DataFrame the timeseries of 2m temperature provided by the weather station and </span>
<span class="sd">        by the reanalysis datasets at the grid point closest to the station. Then, we store the pd.DataFrame for each weather</span>
<span class="sd">        station into a python dictonary. </span>

<span class="sd">    dc_diff_t2m_at_sts : dict</span>
<span class="sd">        For each weather station, we also store into a pd.DataFrame the difference between the 2m temperature provided by each </span>
<span class="sd">        reanalysis dataset and the weather station. Then, we store the pd.DataFrame for each weather station into a python dictonary. </span>
<span class="sd">    </span>
<span class="sd">    dc_tp_at_sts : dict</span>
<span class="sd">        Same as dc_t2m_at_sts, but for total precipitation. </span>
<span class="sd">    </span>
<span class="sd">    dc_diff_tp_at_sts : dict</span>
<span class="sd">        Same as dc_diff_t2m_at_sts, but for total precipitation. </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load names and coordindates of the selected weather stations   </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 

    <span class="c1"># Only select winter days (December-January-February) between &#39;year_start-12-01&#39; and &#39;year_stop-02-28&#39; (without the 29th of February)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">dates_no_2902</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">dates</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dates</span><span class="o">.</span><span class="n">day</span><span class="o">==</span><span class="mi">29</span><span class="p">))]</span> 
    
    <span class="c1"># For each reanalysis dataset, extract the 2m temperature and total precipitation at the grid point closest to each weather station </span>
    <span class="c1"># - ERA5</span>
    <span class="n">df_era5_t2m_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_era5_t2m</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>
    <span class="n">df_era5_tp_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_era5_tp</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>

    <span class="c1"># - CARRA-West</span>
    <span class="n">df_carra_west_t2m_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_carra_west_t2m</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>
    <span class="n">df_carra_west_tp_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_carra_west_tp</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>

    <span class="c1"># - CARRA-East </span>
    <span class="n">df_carra_east_t2m_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_carra_east_t2m</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>
    <span class="n">df_carra_east_tp_at_sts</span> <span class="o">=</span> <span class="n">reanalysis_data_at_weather_stations</span><span class="p">(</span><span class="n">da_carra_east_tp</span><span class="p">,</span> <span class="n">lons_sts</span><span class="p">,</span> <span class="n">lats_sts</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">dates_no_2902</span><span class="p">)</span>


    <span class="c1"># For each weather station:</span>
    <span class="c1">#   1. Create a pandas DataFrame with the time series of 2m temperature from the weather station </span>
    <span class="c1">#      and from the reanalysis datasets (ERA5, CARRA-West, CARRA-East) at the nearest grid point.</span>
    <span class="c1">#      Store each DataFrame in a Python dictionary.</span>
    <span class="c1">#   2. Create another DataFrame with the differences between each reanalysis dataset and the weather </span>
    <span class="c1">#      station observations.  </span>
    <span class="c1">#      Store these in a separate dictionary.</span>
    <span class="c1"># Repeat the same procedure for total precipitation.</span>
    <span class="n">dc_t2m_at_sts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">dc_tp_at_sts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">dc_diff_t2m_at_sts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">dc_diff_tp_at_sts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">name_st</span> <span class="ow">in</span> <span class="n">names_sts</span><span class="p">:</span>
        <span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">],</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_at_single_station</span><span class="p">(</span><span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_era5_t2m_at_sts</span><span class="p">,</span> <span class="n">df_carra_west_t2m_at_sts</span><span class="p">,</span> <span class="n">df_carra_east_t2m_at_sts</span><span class="p">,</span> <span class="n">name_st</span><span class="p">)</span>
        <span class="n">dc_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">],</span> <span class="n">dc_diff_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_at_single_station</span><span class="p">(</span><span class="n">df_stations_tp</span><span class="p">,</span> <span class="n">df_era5_tp_at_sts</span><span class="p">,</span> <span class="n">df_carra_west_tp_at_sts</span><span class="p">,</span> <span class="n">df_carra_east_tp_at_sts</span><span class="p">,</span> <span class="n">name_st</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_tp_at_sts</span><span class="p">,</span> <span class="n">dc_diff_tp_at_sts</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plots_t2m</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a figure with five rows (one per weather station) and three columns (ERA5, CARRA-West, and CARRA-East).</span>
<span class="sd">    </span>
<span class="sd">    Each row contains three scatter plots:</span>
<span class="sd">        - Left: compares daily-averaged 2m temperature from the weather station (x-axis) with ERA5 (y-axis).</span>
<span class="sd">        - Middle: compares the weather station with CARRA-West.</span>
<span class="sd">        - Right: compares the weather station with CARRA-East.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dc_t2m_at_sts : dict</span>
<span class="sd">        A dictionary where each key corresponds to a weather station and each value </span>
<span class="sd">        is a pandas DataFrame containing 2m temperature time series from the weather </span>
<span class="sd">        station and from ERA5, CARRA-West, and CARRA-East at the nearest grid point</span>
<span class="sd">    </span>
<span class="sd">    dc_diff_t2m_at_sts : dict</span>
<span class="sd">        A dictionary where each key corresponds to a weather station and each value </span>
<span class="sd">        is a pandas DataFrame containing the difference between the 2m temperature from </span>
<span class="sd">        each reanalysis dataset and the weather station.   </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="c1"># Load the names of each weather station considered </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span> 

    <span class="c1"># Run through all the weather stations</span>
    <span class="k">for</span> <span class="n">i_st</span><span class="p">,</span> <span class="n">name_st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names_sts</span><span class="p">):</span>
    
        <span class="n">names_reanalysis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]</span>
        <span class="n">color_col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i_col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="s1">&#39;Weather station&#39;</span><span class="p">],</span> <span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_col</span><span class="p">[</span><span class="n">i_col</span><span class="p">])</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

            <span class="c1"># Compute the bias and the standard deviation of the difference. Show them in a box at the bottom right of each subplot. </span>
            <span class="n">bias</span> <span class="o">=</span>  <span class="n">dc_diff_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">std_diff</span> <span class="o">=</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;bias=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">bias</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;,   &#39;</span> <span class="o">+</span> <span class="s1">&#39;STD_diff=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std_diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> 
                                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color_col</span><span class="p">[</span><span class="n">i_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name_st</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Set x- and y-labels. </span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">3</span>==0:
            <span class="n">iax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;reanalysis [¬∞C]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;=</span><span class="mi">12</span><span class="p">:</span>
            <span class="n">iax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;weather station [¬∞C]&#39;</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_tp_at_sts</span><span class="p">,</span> <span class="n">dc_diff_tp_at_sts</span> <span class="o">=</span> \
    <span class="n">values_at_all_stations</span><span class="p">(</span><span class="n">df_stations_t2m</span><span class="p">,</span> <span class="n">df_stations_tp</span><span class="p">,</span> <span class="n">da_era5_t2m</span><span class="p">,</span> <span class="n">da_era5_tp</span><span class="p">,</span> <span class="n">da_carra_west_t2m</span><span class="p">,</span> <span class="n">da_carra_west_tp</span><span class="p">,</span> <span class="n">da_carra_east_t2m</span><span class="p">,</span> <span class="n">da_carra_east_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots_t2m</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/c5202454d1deb809408f4fe7bd8aecf6c4b9bc8e41617e70037199f30312df5f.png" src="../_images/c5202454d1deb809408f4fe7bd8aecf6c4b9bc8e41617e70037199f30312df5f.png" />
</div>
</div>
<p><em>Fig. 3: Comparison between the 2m-temperature from each weather station and the reanalysis datasets. The figure is organized in fifteen scatter plots, arranged in five rows and three columns. The left column compares the 2m temperature data from each weather station (x-axis) and ERA5 (y-axis). The middle and right columns show the comparisons with CARRA-West and CARRA-East, respectively. Each plot also reports the corresponding bias and standard deviation of the difference.</em></p>
<p>Fig. 4 provides information on the differences between the 2m temperature from reanalyses and observations at the Verlegenhuken weather station. The upper subplot in Fig. 4 shows that the 2m temperature observed by the Verlegenhuken weather station diverges the most from CARRA-East during the 1997/1998 winter season. The magnitude of the differences, of almost 20¬∞C, lets us suppose this winter season to be mostly responsible for the outliers shown in Fig. 3.</p>
<p>The lower subplots, which focus on the 1997/1998 winter season, clearly show the discrepancy occurring during the first twenty days of February 1998. It‚Äôs worth noting that such a discrepancy occurs irrespective of the reanalysis datases, which are able to reproduce the local maximum in temperature, but with a lag of approximately 10 days. A more comprehensive analysis would be needed to understand the reasons behind this discrepancy. However, such analysis falls outside the scope of this work.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">show_t2m_difference_at_verlegenhuken</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function shows the anomalously high temperature difference between the Verlegenhuken weather </span>
<span class="sd">    station and the reanalysis datasets in February 1998. </span>
<span class="sd">    The function creates 4 subplots. One subplot fills the entire upper row, while the lower row is equally </span>
<span class="sd">    split among the remaining three subplots. The upper subplot shows results for the entire period when the </span>
<span class="sd">    Verlegenhuken weather station observed the 2m temperature, and shows the difference between the 2m </span>
<span class="sd">    temperature from CARRA-East and the Verlegenhuken weather station. The plot shows results from CARRA-East, </span>
<span class="sd">    but it could as well have shown results from ERA5 or CARRA-West. </span>
<span class="sd">    The lower subplots show the 2m temperature at Verlegenhuken as provided by the weather station and by</span>
<span class="sd">    each reanalysis dataset (a subplot per reanalysis) between December 1997 and February 1998. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dc_t2m_at_sts : dict</span>
<span class="sd">        A dictionary where each key corresponds to a weather station and each value </span>
<span class="sd">        is a pandas DataFrame containing 2m temperature time series from the weather </span>
<span class="sd">        station and from ERA5, CARRA-West, and CARRA-East at the nearest grid point. </span>
<span class="sd">    </span>
<span class="sd">    dc_diff_t2m_at_sts : dict</span>
<span class="sd">        A dictionary where each key corresponds to a weather station and each value </span>
<span class="sd">        is a pandas DataFrame containing the difference between the 2m temperature from </span>
<span class="sd">        each reanalysis dataset and a weather station.    </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 

    <span class="c1"># Create 4 subplots over two rows.</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax0</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>    <span class="c1"># create upper subplot (it occupies the entire row)</span>
    <span class="n">ax10</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>   <span class="c1"># create the lower subplots</span>
    <span class="n">ax11</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ax12</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax10</span><span class="p">,</span> <span class="n">ax11</span><span class="p">,</span> <span class="n">ax12</span><span class="p">]</span>

    <span class="c1"># Upper subplot</span>
    <span class="n">dc_diff_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Verlegenhuken&#39;</span><span class="p">][</span><span class="s1">&#39;CARRA-East&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2m temperature difference between CARRA-East and the weather station&#39;</span><span class="p">)</span>

    <span class="c1"># Lower subplots </span>
    <span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Verlegenhuken&#39;</span><span class="p">][[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">,</span> <span class="s1">&#39;ERA5&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1997-12-01&#39;</span><span class="p">:</span><span class="s1">&#39;1998-02-28&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax10</span><span class="p">)</span>
    <span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Verlegenhuken&#39;</span><span class="p">][[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1997-12-01&#39;</span><span class="p">:</span><span class="s1">&#39;1998-02-28&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax11</span><span class="p">)</span>
    <span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Verlegenhuken&#39;</span><span class="p">][[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1997-12-01&#39;</span><span class="p">:</span><span class="s1">&#39;1998-02-28&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax12</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">iax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span> 
        <span class="n">iax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> 
        <span class="n">iax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;[¬∞C]&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_t2m_difference_at_verlegenhuken</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">,</span> <span class="n">dc_diff_t2m_at_sts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/0490728641f7463324533d48439b2e9982d63a07b416222fc136e1d019f2252f.png" src="../_images/0490728641f7463324533d48439b2e9982d63a07b416222fc136e1d019f2252f.png" />
</div>
</div>
<p><em>Fig. 4: Comparison between the 2m temperature at the Verlegenhuken weather station and the reanalysis datasets. The upper subplot shows results for the entire period when the Verlegenhuken weather station observed 2m temperature, while the lower subplots focus on the 1997/1998 winter season. The upper subplot shows the difference between the 2m temperature from CARRA-East at the grid point closest to the weather station and from the Verlegenhuken weather station. The lower subplots show the 2m temperature observed by the weather station (in blue) and provided by the reanalysis datasets at the grid point closest to the weather station (in orange). The subplot on the left shows the results for ERA5, the one in the middle for CARRA-West, and the one on the right for CARRA-East.</em></p>
</section>
<section id="reanalyses-vs-observations-total-precipitation">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-7"></span><h3>Reanalyses vs observations: total precipitation<a class="headerlink" href="#reanalyses-vs-observations-total-precipitation" title="Link to this heading">#</a></h3>
<p>As with the 2m temperature, we note a linear relationship between the daily-accumulated precipitation from the weather stations and from ERA5, CARRA-West and CARRA-East (Fig. 5). The analysis of the bias and the standard deviation of the differences indicates that CARRA-West and CARRA-East better agree with the observations when compared to ERA5. However, this same analysis does not discrimintate between CARRA-West and CARRA-East which, instead, return comparable results.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plots_tp</span><span class="p">(</span><span class="n">dc_tp_at_sts</span><span class="p">,</span> <span class="n">dc_diff_tp_at_sts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a figure with two rows and three columns. It only has two rows because the total precipitation </span>
<span class="sd">    is only provided by two of the selected weather stations over Svalbard (Ny-√Ölesund and Svalbard Lufthavn).  </span>
<span class="sd">    Each row is made of three scatter plots. The scatter plot on the left is used to </span>
<span class="sd">    compare the total precipitation from the weather station (x-axis) and from ERA5 (y-axis). </span>
<span class="sd">    The plots in the middle and on the right follow the same structure, but show the </span>
<span class="sd">    comparison with CARRA-West and CARRA-East respectively. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dc_tp_at_sts : dict</span>
<span class="sd">        Each element of the dict consists of a pd.DataFrame and refers to a weather station.  </span>
<span class="sd">        This contains the total precipitation from the weather station, ERA5, CARRA-West, and CARRA-East.  </span>
<span class="sd">    </span>
<span class="sd">    dc_diff_tp_at_sts : dict</span>
<span class="sd">        Each element of the dict consists of a pd.DataFrame and refers to a weather station.  </span>
<span class="sd">        The pd.DataFrame contains the difference between the total precipitation from </span>
<span class="sd">        each reanalysis dataset and the weather station.   </span>
<span class="sd">       </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the names of each weather station considered </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 
    
    <span class="c1"># Run through the two weather stations for which total precipitation is provided.  </span>
    <span class="k">for</span> <span class="n">i_st</span><span class="p">,</span> <span class="n">name_st</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names_sts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]):</span>
    
        <span class="n">names_reanalysis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]</span>
        <span class="n">color_col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i_col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dc_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="s1">&#39;Weather station&#39;</span><span class="p">],</span> <span class="n">dc_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_col</span><span class="p">[</span><span class="n">i_col</span><span class="p">])</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            
            <span class="c1"># Compute the bias and the standard deviation of the difference. Show them in a box at the bottom right of each subplot. </span>
            <span class="n">bias</span> <span class="o">=</span>  <span class="n">dc_diff_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">std_diff</span> <span class="o">=</span> <span class="n">dc_diff_tp_at_sts</span><span class="p">[</span><span class="n">name_st</span><span class="p">][</span><span class="n">names_reanalysis</span><span class="p">[</span><span class="n">i_col</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;bias=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">bias</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;,   &#39;</span> <span class="o">+</span> <span class="s1">&#39;STD_diff=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">std_diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="n">i_col</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> 
                                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">color_col</span><span class="p">[</span><span class="n">i_col</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
         
        <span class="n">axs</span><span class="p">[</span><span class="n">i_st</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name_st</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
        
    <span class="c1"># Set x- and y-labels. </span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">3</span>==0:
            <span class="n">iax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;reanalysis [mm]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">iax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;weather station [mm]&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots_tp</span><span class="p">(</span><span class="n">dc_tp_at_sts</span><span class="p">,</span> <span class="n">dc_diff_tp_at_sts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/4b46ebf8a99eadaec73e834cfaf9d3e7541d28d6106883cf14929a25eb5fbd65.png" src="../_images/4b46ebf8a99eadaec73e834cfaf9d3e7541d28d6106883cf14929a25eb5fbd65.png" />
</div>
</div>
<p><em>Fig. 5: Comparison between the daily-accumulated total precipitation from the weather stations and the reanalysis datasets at the grid points closest to the weather stations. This figure follows the same structure as Fig. 4, but only presents the results for Ny-√Ölesund and Svalbard Lufthavn because the total precipitation is not provided at the other three locations.</em></p>
</section>
<section id="reanalyses-vs-observations-rain-on-snow-events">
<span id="reanalysis-reanalysis-carra-single-levels-climate-monitoring-q01-template-section-8"></span><h3>Reanalyses vs observations: rain-on-snow events<a class="headerlink" href="#reanalyses-vs-observations-rain-on-snow-events" title="Link to this heading">#</a></h3>
<p>The differences between the reanalysis datasets become more evident when we compare the winter-time number of ROS events identified by the reanalysis datasets and by the weather stations. This comparison is based on visual inspection (Fig. 6), and on the absolute difference between the winter-time number of ROS events between observations and each reanalysis dataset (Table 1). Before describing the results, though, it is important to note that, to allow a comparison with the observations, the reanalysis datasets are artificially masked for them to match the gaps in the observations.</p>
<p>The comparison with the observational data indicates that CARRA reproduces the winter-time number of ROS events over Svalbard more accurately than ERA5, with CARRA-East performing better than CARRA-West. This result is in line with the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Copernicus+Arctic+Regional+Reanalysis+%28CARRA%29%3A+Data+User+Guide" rel="noreferrer" target="_blank">CARRA User Guide</a>, which recommends CARRA-East for Svalbard as the archipelago is located at a short distance from the boundary of CARRA-West. However, we also note that the performance of ERA5, CARRA-West, and CARRA-East depends on the weather station.</p>
<p>At Ny-√Ölesund, simple visual inspection indicates that CARRA-East better reproduces the winter-to-winter variations in the number of ROS events. Instead, CARRA-West and ERA5 tend to overestimate and underestimate this number, respectively. The issue with ERA5 might be due to the reanalysis data providing lower values of 2m temperature at Ny-√Ölesund when compared to observations, as shown in Fig. 3.</p>
<p>Fig. 6 and Table 1 also seem to indicate that CARRA-West and CARRA-East better reproduce the winter-to-winter variations of ROS events at Svalbard Lufthavn. Indeed, while CARRA-West and CARRA-East return comparable results, they both show an overall smaller discrepancy with the observations when compared to ERA5. For instance, the averaged absolute difference of the number of ROS events from observations and ERA5 is approximately 1.8, whereas it is 1.2 for CARRA-West, and 1.0 for CARRA-East (Table 1). It is worth noting, however, that this conclusion is not as clear as for Ny-√Ölesund, as both CARRA-West and CARRA-East tend to overestimate the number the ROS events at Svalbard Lufthavn, while ERA5 tends to underestimate it.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">monthly_ros_events_at_single_station</span><span class="p">(</span><span class="n">df_t2m</span><span class="p">,</span> <span class="n">df_tp</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function counts the number of rain-on-snow (ROS) events per winter at the location of one </span>
<span class="sd">    weather station using the daily-averaged 2m temperature and the daily-accumulated total precipitation </span>
<span class="sd">    provided by:</span>
<span class="sd">        - the weather station </span>
<span class="sd">        - ERA5</span>
<span class="sd">        - CARRA-West</span>
<span class="sd">        - CARRA-East </span>

<span class="sd">    Rain-on-snow events defined as: </span>
<span class="sd">        - daily-averaged temperature &gt; 0 ¬∞C</span>
<span class="sd">        - daily-accumulated total precipitation &gt; 1 mm</span>

<span class="sd">    To allow for a comparison with the weather stations, we artificially fill the reanalysis data with the same </span>
<span class="sd">    gaps as in the observations. </span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_t2m : pd.DataFrame</span>
<span class="sd">        Daily-averaged 2m-temperature provided by the selected weather station and each reanalysis dataset in winter.  </span>

<span class="sd">    df_tp : pd.DataFrame</span>
<span class="sd">        Daily-accumulated total precipitation provided by the selected weather station and each reanalysis dataset in winter.   </span>
<span class="sd"> </span>
<span class="sd">    year_start, year_stop : int, int </span>
<span class="sd">        First and last year considered. </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_n_ros : pd.DataFrame</span>
<span class="sd">        Total number of ROS events for each winter season.  </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df_t2m</span> <span class="o">=</span> <span class="n">df_t2m</span><span class="p">[[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">,</span> <span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]]</span>
    <span class="n">df_tp</span> <span class="o">=</span> <span class="n">df_tp</span><span class="p">[[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">,</span> <span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-West&#39;</span><span class="p">,</span> <span class="s1">&#39;CARRA-East&#39;</span><span class="p">]]</span>

    <span class="c1"># Artificially fill the reanalysis data with the same gaps as in the observations</span>
    <span class="n">df_t2m</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_t2m</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">df_tp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_tp</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="c1"># Rain-on-snow events</span>
    <span class="n">df_ros</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_t2m</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">df_tp</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># The variable `first_day_decembers` is used to exclude observations from spring (MAM), </span>
    <span class="c1"># summer (JJA), and autumn (SON). This adjustment is necessary because of how we </span>
    <span class="c1"># count observations within each winter season (see later in the function). </span>
    <span class="c1"># Without this, the process would also return counts for other seasons </span>
    <span class="c1"># (which happen to be zero in our case). </span>
    <span class="c1"># Example of `first_day_decembers`:</span>
    <span class="c1"># DatetimeIndex([&#39;1990-12-01&#39;, &#39;1991-12-01&#39;, &#39;1992-12-01&#39;, ...])   </span>
    <span class="n">first_day_seasons</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-12-01&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-02-28&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;3MS&#39;</span><span class="p">)</span>
    <span class="n">first_day_decembers</span> <span class="o">=</span> <span class="n">first_day_seasons</span><span class="p">[</span><span class="n">first_day_seasons</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
    
    <span class="n">df_n_ros</span> <span class="o">=</span> <span class="n">df_ros</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;3MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">df_n_ros</span>  <span class="o">=</span> <span class="n">df_n_ros</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">first_day_decembers</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">df_n_ros</span> 


<span class="k">def</span><span class="w"> </span><span class="nf">plot_ros_events</span><span class="p">(</span><span class="n">df_n_ros_ny_alesund</span><span class="p">,</span> <span class="n">df_n_ros_svalbard_lufthavn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function generates a figure showing the number of ROS events per winter season based on observations </span>
<span class="sd">    and reanalysis datasets (ERA5, CARRA-West, and CARRA-East) for Ny-√Ölesund and Svalbard Lufthavn. </span>
<span class="sd">    The function also computes and shows the corresponding linear regression lines. </span>
<span class="sd">    </span>
<span class="sd">    The figure consists of two stacked subplots:</span>
<span class="sd">        - Top subplot -&gt; results for Ny-√Ölesund.</span>
<span class="sd">        - Bottom subplot -&gt; results for Svalbard Lufthavn.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_n_ros_ny_alesund : pd.DataFrame</span>
<span class="sd">        Total number of ROS events for each winter season at Ny-√Ölesund as provided by the </span>
<span class="sd">        weather station and each reanalysis dataset.   </span>

<span class="sd">    df_n_ros_svalbard_lufthavn : pd.DataFrame</span>
<span class="sd">        Total number of ROS events for each winter season at Svalbard Lufthavn as provided by the </span>
<span class="sd">        weather station and each reanalysis dataset.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the names of each weather station considered </span>
    <span class="n">_</span><span class="p">,</span> <span class="n">names_sts</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_weather_stations</span><span class="p">()</span> 

    <span class="c1"># Compute linear regression line (the function is defined in the cell below) </span>
    <span class="n">df_n_ros_reg_lines_ny_alesund</span> <span class="o">=</span> <span class="n">linear_regression_lines_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros_ny_alesund</span><span class="p">)</span>    
    <span class="n">df_n_ros_reg_lines_svalbard_lufthavn</span> <span class="o">=</span> <span class="n">linear_regression_lines_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros_svalbard_lufthavn</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="n">df_n_ros_ny_alesund</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">])</span>
    <span class="n">df_n_ros_svalbard_lufthavn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">])</span>

    <span class="n">df_n_ros_reg_lines_ny_alesund</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df_n_ros_reg_lines_svalbard_lufthavn</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;N¬∞ ROS events&#39;</span><span class="p">)</span>
        <span class="n">iax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">names_sts</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:][</span><span class="n">i</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    
<span class="k">def</span><span class="w"> </span><span class="nf">abs_diff_n_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros</span><span class="p">,</span> <span class="n">name_st</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates the average absolute difference in the number of ROS events between observations and reanalysis datasets </span>
<span class="sd">    at the selected weather station over the entire period.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_n_ros : pd.DataFrame </span>
<span class="sd">        Total number of ROS events for each winter season.  </span>

<span class="sd">    name_st : str </span>
<span class="sd">        Name of the weather station of interest</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_abs_diff_n_ros : pd.DataFrame </span>
<span class="sd">        Average absolute difference in the number of ROS events between observations and reanalysis datasets </span>
<span class="sd">        at the selected weather station over the entire period. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dc_abs_diff_n_ros</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="n">dc_abs_diff_n_ros</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">])),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dc_abs_diff_n_ros</span><span class="p">[</span><span class="s1">&#39;CARRA-West&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;CARRA-West&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">])),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">dc_abs_diff_n_ros</span><span class="p">[</span><span class="s1">&#39;CARRA-East&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;CARRA-East&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_n_ros</span><span class="p">[</span><span class="s1">&#39;Weather station&#39;</span><span class="p">])),</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">df_abs_diff_n_ros</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dc_abs_diff_n_ros</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">name_st</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">df_abs_diff_n_ros</span>
    
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">linear_trend_and_uncertainty_timeseries</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes the linear least-squares regression and uncertainty of a timeseries. </span>
<span class="sd">    Script to compute the 95% confidence interval on slope found at: </span>
<span class="sd">        - https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    timeseries : np.array</span>
<span class="sd">        Time series data for which you want to compute the intercept, the slope of the linear regression </span>
<span class="sd">        line and the corresponding 95% confidence interval.</span>
<span class="sd">        There must be no gaps in the time series data. </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    intercept, slope : float, float</span>
<span class="sd">        Intercept and slope of the regression line. </span>
<span class="sd">        </span>
<span class="sd">    slope_95_ci : float</span>
<span class="sd">        95% confidence interval of the regression line. </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_months</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
    
    <span class="c1"># linear least-squares regression</span>
    <span class="n">linear_regression</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_months</span><span class="p">),</span> <span class="n">timeseries</span><span class="p">)</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="o">.</span><span class="n">intercept</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="o">.</span><span class="n">slope</span>
    
    <span class="c1"># Two-sided inverse Students t-distribution </span>
    <span class="c1"># p - probability </span>
    <span class="c1"># df - degrees of freedom</span>
    <span class="n">tinv</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">tinv</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">n_months</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>    <span class="c1"># for the 95% confidence interval </span>
    <span class="n">slope_95_ci</span> <span class="o">=</span> <span class="n">ts</span> <span class="o">*</span> <span class="n">linear_regression</span><span class="o">.</span><span class="n">stderr</span>

    <span class="k">return</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">slope_95_ci</span>


<span class="k">def</span><span class="w"> </span><span class="nf">linear_regression_lines_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros_single_station</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the line of best fit for the number of ROS events reported by the weather stations </span>
<span class="sd">    and the reanalysis datasets (ERA5, CARRA-West, or CARRA-East) at either Ny-√Ölesund </span>
<span class="sd">    or Svalbard Lufthavn.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_n_ros_single_station : pd.DataFrame</span>
<span class="sd">        Number of ROS events per winter month at a single weather station, computed </span>
<span class="sd">        using the 2m temperature and total precipitation provided by the weather station itself, ERA5, </span>
<span class="sd">        CARRA-West, and CARRA-East. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df_linear_regression_lines : pd.DataFrame</span>
<span class="sd">        Line of best fit for the number of ROS events from the weather station </span>
<span class="sd">        and each reanalysis dataset at the selected location.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_times</span><span class="p">,</span> <span class="n">n_datasets</span> <span class="o">=</span> <span class="n">df_n_ros_single_station</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">names_datasets</span> <span class="o">=</span> <span class="n">df_n_ros_single_station</span><span class="o">.</span><span class="n">columns</span>

    <span class="n">df_linear_regression_lines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">df_n_ros_single_station</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">name_dataset</span> <span class="ow">in</span> <span class="n">names_datasets</span><span class="p">:</span>
        <span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linear_trend_and_uncertainty_timeseries</span><span class="p">(</span><span class="n">df_n_ros_single_station</span><span class="p">[</span><span class="n">name_dataset</span><span class="p">])</span>
        <span class="n">df_linear_regression_lines</span><span class="p">[</span><span class="n">name_dataset</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_times</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df_linear_regression_lines</span>


<span class="k">def</span><span class="w"> </span><span class="nf">linear_trend_and_uncertainty_ros_at_single_station</span><span class="p">(</span><span class="n">df_ros_all_datasets</span><span class="p">,</span> <span class="n">name_st</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function computes the slope and the corresponding 95% confidence interval of the number of ROS events </span>
<span class="sd">    provided by the weather stations and the reanalysis datasets (ERA5, CARRA-West, or CARRA-East) at Ny-√Ölesund </span>
<span class="sd">    or at Svalbard Lufthavn. It then prints the results. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_ros_all_datasets : pd.DataFrame </span>
<span class="sd">        Number of ROS events at a weather station per each winter month computed using the 2m temperature </span>
<span class="sd">        and total precipitation provided by the weather station itself, ERA5, CARRA-West, and CARRA-East.   </span>

<span class="sd">    name_st : str</span>
<span class="sd">        Name of the weather station considered (either Ny-√Ölesund or Svalbard Lufthavn) </span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">names_datasets</span> <span class="o">=</span> <span class="n">df_ros_all_datasets</span><span class="o">.</span><span class="n">columns</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;slope +/- 95</span><span class="si">% c</span><span class="s1">onfidence interval at &#39;</span> <span class="o">+</span> <span class="n">name_st</span> <span class="o">+</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">name_dataset</span> <span class="ow">in</span> <span class="n">names_datasets</span><span class="p">:</span>
        <span class="n">n_ros_dataset</span> <span class="o">=</span> <span class="n">df_ros_all_datasets</span><span class="p">[</span><span class="n">name_dataset</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> 
        <span class="n">_</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">slope_95_ci</span> <span class="o">=</span> <span class="n">linear_trend_and_uncertainty_timeseries</span><span class="p">(</span><span class="n">n_ros_dataset</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">slope_95_ci</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">  (</span><span class="si">{</span><span class="n">name_dataset</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count number of ROS events for each winter at Ny-√Ölesund according to weather station, ERA5, CARRA-West, and CARRA-East</span>
<span class="c1"># (we artifically fill the reanalysis data with the same gaps as in the observations)</span>
<span class="n">df_n_ros_ny_alesund_samegaps</span> <span class="o">=</span> <span class="n">monthly_ros_events_at_single_station</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Ny-√Ölesund&#39;</span><span class="p">],</span> <span class="n">dc_tp_at_sts</span><span class="p">[</span><span class="s1">&#39;Ny-√Ölesund&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>    

<span class="c1"># Same as above, but for the weather station at Svalbard Lufthavn </span>
<span class="n">df_n_ros_svalbard_lufthavn_samegaps</span> <span class="o">=</span> <span class="n">monthly_ros_events_at_single_station</span><span class="p">(</span><span class="n">dc_t2m_at_sts</span><span class="p">[</span><span class="s1">&#39;Svalbard Lufthavn&#39;</span><span class="p">],</span> <span class="n">dc_tp_at_sts</span><span class="p">[</span><span class="s1">&#39;Svalbard Lufthavn&#39;</span><span class="p">],</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ros_events</span><span class="p">(</span><span class="n">df_n_ros_ny_alesund_samegaps</span><span class="p">,</span> <span class="n">df_n_ros_svalbard_lufthavn_samegaps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/68770e9eec51ecf70b9b70a97e77233be716860ec318573e1875edaee0332794.png" src="../_images/68770e9eec51ecf70b9b70a97e77233be716860ec318573e1875edaee0332794.png" />
</div>
</div>
<p><em>Fig. 6: Number of ROS events for each winter season between December 1990 and February 2022, and corresponding linear regression lines. The upper subplot shows the results for Ny-√Ölesund, whereas the lower subplot for Svalbard Lufthavn. Note that the intercept of the linear regression lines is set to zero to allow for a better comparison.</em></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_abs_diff_n_ros_svalbard_lufthavn</span> <span class="o">=</span> <span class="n">abs_diff_n_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros_svalbard_lufthavn_samegaps</span><span class="p">,</span> <span class="s1">&#39;Svalbard Lufthavn&#39;</span><span class="p">)</span>
<span class="n">df_abs_diff_n_ros_ny_alesund</span> <span class="o">=</span> <span class="n">abs_diff_n_ros_single_station</span><span class="p">(</span><span class="n">df_n_ros_ny_alesund_samegaps</span><span class="p">,</span> <span class="s1">&#39;Ny-√Ölesund&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_abs_diff_n_ros_ny_alesund</span><span class="p">,</span> <span class="n">df_abs_diff_n_ros_svalbard_lufthavn</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ny-√Ölesund</th>
      <th>Svalbard Lufthavn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ERA5</th>
      <td>2.2</td>
      <td>1.8</td>
    </tr>
    <tr>
      <th>CARRA-West</th>
      <td>1.5</td>
      <td>1.2</td>
    </tr>
    <tr>
      <th>CARRA-East</th>
      <td>0.7</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em>Table 1: Average over the entire period of the absolute difference between the winter-time number of ROS events from observations and the reanalysis datasets. The first row shows the result for ERA5, the second for CARRA-West, and the third for CARRA-East. The column on the left shows the results for the weather station at Ny-√Ölesund, while that on the right for the weather station at Svalbard Lufthavn.</em></p>
<p>We conclude with a brief discussion on the linear trends of the number of ROS events at Ny-√Ölesund and at Svalbard Lufthavn. The analysis of the linear trends serves a dual purpose. At first, it helps evaluate the quality of the reanalysis datasets. Secondly, it helps quantify the potential impact of climate change on the occurrence of ROS events over Svalbard. The results from the linear trend analysis is shown in the cells below and in Fig. 6.</p>
<p>The linear trends suggest an increase in the number of ROS events at both Ny-√Ölesund and Svalbard Lufthavn since 1990. The linear trend provided by CARRA-East aligns most closely with observations at Ny-√Ölesund. At Svalbard Lufthavn, the results are more ambiguous, with both CARRA-East and ERA5 best resembling the observations. We should note, however, that the width of the confidence intervals questions the statistical significance of the results. Therefore, both the observations and the reanalysis datasets suggest that longer timeseries are needed to obtain statistically significant results and to determine whether climate change has affected the occurrence of ROS events over the Svalbard Archipelago.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_trend_and_uncertainty_ros_at_single_station</span><span class="p">(</span><span class="n">df_n_ros_ny_alesund_samegaps</span><span class="p">,</span> <span class="s1">&#39;Ny-√Ölesund&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>slope +/- 95% confidence interval at Ny-√Ölesund:

    0.08 +/- 0.13  (Weather station)
    0.04 +/- 0.06  (ERA5)
    0.12 +/- 0.15  (CARRA-West)
    0.09 +/- 0.12  (CARRA-East)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_trend_and_uncertainty_ros_at_single_station</span><span class="p">(</span><span class="n">df_n_ros_svalbard_lufthavn_samegaps</span><span class="p">,</span> <span class="s1">&#39;Svalbard Lufthavn&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>slope +/- 95% confidence interval at Svalbard Lufthavn:

    0.05 +/- 0.10  (Weather station)
    0.05 +/- 0.06  (ERA5)
    0.12 +/- 0.13  (CARRA-West)
    0.06 +/- 0.12  (CARRA-East)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>CDS dataset used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-carra-single-levels?tab=overview" rel="noreferrer" target="_blank">Arctic regional reanalysis on single levels from 1991 to present</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/datetime.html" rel="noreferrer" target="_blank">datetime</a></p></li>
<li><p><a class="reference external" href="https://numpy.org/" rel="noreferrer" target="_blank">numpy</a></p></li>
<li><p><a class="reference external" href="https://scipy.org/" rel="noreferrer" target="_blank">scipy</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/" rel="noreferrer" target="_blank">pandas</a></p></li>
<li><p><a class="reference external" href="https://docs.xarray.dev/en/stable/" rel="noreferrer" target="_blank">xarray</a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/" rel="noreferrer" target="_blank">matplotlib</a></p></li>
<li><p><a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/" rel="noreferrer" target="_blank">cartopy</a></p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
<p>Additional resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1175/BAMS-D-24-0101.1" rel="noreferrer" target="_blank">State of the Climate in 2023: the Arctic</a></p></li>
<li><p><a class="reference external" href="https://www.miljodirektoratet.no/globalassets/publikasjoner/m1242/m1242.pdf" rel="noreferrer" target="_blank">‚ÄúClimate in Svalbard 2100‚Äù report by the Norwegian Environmental Agency</a></p></li>
<li><p><a class="reference external" href="https://nsidc.org/rain-on-snow#:~:text=Rain%20on%20Snow%20(ROS)%20events,wildlife%2C%20infrastructure%2C%20and%20communities." rel="noreferrer" target="_blank">AROSS: a Knowledge &amp; Data Hub to explore the causes and impacts of Arctic Rain on Snow events</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Batrak, Y., Cheng, B., Kallio-Myers, V. 2024 Sea ice cover in the Copernicus Arctic Regional Reanalysis. Cryosphere 18, 1157-1183. <a class="reference external" href="https://doi.org/10.5194/tc-18-1157-2024" rel="noreferrer" target="_blank">https://doi.org/10.5194/tc-18-1157-2024</a></p></li>
<li><p>Box, J. E., Nielsen, K. P., Yang, X., Niwano, M., Wehrl√©, A., et al. 2023 Greenland ice sheet rainfall climatology, extremes and atmospheric river rapids. Meteorol. Appl. 30, 4, e2134, <a class="reference external" href="https://doi.org/10.1002/met.2134" rel="noreferrer" target="_blank">https://doi.org/10.1002/met.2134</a></p></li>
<li><p>Hansen, B. B., Isaksen, K., Benestad, R. E., Kohler, J., Pedersen, √Ö. √ò., et al. 2014 Warmer and wetter winters: characteristics and implications of an extreme weather event in the High Arctic. Environ. Res. Lett., 9, 114021. <a class="reference external" href="https://doi.org/10.1088/1748-9326/9/11/114021" rel="noreferrer" target="_blank">https://doi.org/10.1088/1748-9326/9/11/114021</a></p></li>
<li><p>Hanssen-Bauer, I., F√∏rland, E. J., Hisdal, H., Mayer, S., Sand√∏, A. B., et al. 2019 Climate in Svalbard 2100 ‚Äì a knowledge base for climate adaptation. NCCS Report no. 1/2019 (<a class="reference external" href="http://www.klimaservicesenter.no" rel="noreferrer" target="_blank">www.klimaservicesenter.no</a>).</p></li>
<li><p>Hersbach, H., Bell, B., Berrisford, P., Hirahara, S., Hor√°nyi, A., et al. 2020 The ERA5 global reanalysis. Q.J.R. Meteorol. Soc. 146, 1990‚Äì2049. <a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">https://doi.org/10.1002/qj.3803</a></p></li>
<li><p>Peeters, B., Pedersen, √Ö. √ò., Loe, L. E., Isaksen, K., Veiberg, V., et al. 2019 Spatiotemporal patterns of rain-on-snow and basal ice in high Arctic Svalbard: detection of a climate-cryosphere regime shift. Environ. Res. Lett., 14, 015002. doi:10.1088/1748-9326/aaefb3.</p></li>
<li><p>Rantanen, M., Karpechko, A. Y., Lipponen, A., Nordling, K., Hyv√§rinen, O., et al. 2022 The Arctic has warmed nearly four times faster than the globe since 1979. Commun. Earth Environ. 3, 168. doi:10.1038/s43247-022-00498-3.</p></li>
<li><p>Wickstr√∂m, S., Jonassen, M. O., Cassano, J. J., Vihma, T. 2020 Present Temperature, Precipitation, and Rain‚Äêon‚ÄêSnow Climate in Svalbard. J. Geophys. Res. Atmos. 5, e2019JD032155. <a class="reference external" href="https://doi.org/10.1029/2019JD032155" rel="noreferrer" target="_blank">https://doi.org/10.1029/2019JD032155</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-monitoring-the-impact-of-climate-change-on-rainfall-related-hazards-in-svalbard">üåç Use case: Monitoring the impact of climate change on rainfall-related hazards in Svalbard</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-datasets">Description of the datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#era5">ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#carra">CARRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#weather-stations">Weather stations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-datasets">Download datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Weather stations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses">Reanalyses</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparation-of-2m-temperature-and-total-precipitation">Preparation of 2m temperature and total precipitation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-temperature-and-precipitation-from-era5-and-carra">Prepare temperature and precipitation from ERA5 and CARRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-temperature-and-precipitation-from-the-weather-stations">Prepare temperature and precipitation from the weather stations</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observational-gaps">Observational gaps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-2m-temperature">Reanalyses vs observations: 2m temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-total-precipitation">Reanalyses vs observations: total precipitation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyses-vs-observations-rain-on-snow-events">Reanalyses vs observations: rain-on-snow events</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>