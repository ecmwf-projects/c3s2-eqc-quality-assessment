
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4.1. Satellite Land Cover trend assessment for Spatial Planning and Land Management &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_trend-assessment_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5. Land Hydrology" href="../Land_Hydrology/Land_Hydrology.html" />
    <link rel="prev" title="1.4. Land Biosphere" href="Land_Biosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Biosphere.html">1.4. Land Biosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.4.1. Satellite Land Cover trend assessment for Spatial Planning and Land Management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_trend-assessment_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_trend-assessment_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite Land Cover trend assessment for Spatial Planning and Land Management</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-quantify-urbanisation-trends">🌍 Use case: Using land cover products to quantify urbanisation trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data"><strong>1. Define the AoI, search and download LC data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#install-cds-api">Install CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula"><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-urban-area-for-each-nuts-2-region">Compute urban area for each NUTS 2 region</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-urban-classes-and-prepare-dataset">Select Urban Classes and Prepare Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-urban-area-per-region-and-year">Compute urban area per region and year</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-urban-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">Map urban percentage coverage over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-urban-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">Map urban percentage coverage change over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-analysis">Map Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-drivers-and-methodological-considerations-in-urbanisation-trends-in-the-iberian-peninsula-19922022"><strong>Potential Drivers and Methodological Considerations in Urbanisation Trends in the Iberian Peninsula (1992–2022)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-detection"><strong>3. Breakpoint Detection</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-analysis">Breakpoint Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table">📊 <strong>Summary Table</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-assessment"><strong>4.Trend Assessment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis">Trend Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion"><strong>5. Discussion</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-land-cover-trend-assessment-for-spatial-planning-and-land-management">
<h1><span class="section-number">1.4.1. </span>Satellite Land Cover trend assessment for Spatial Planning and Land Management<a class="headerlink" href="#satellite-land-cover-trend-assessment-for-spatial-planning-and-land-management" title="Link to this heading">#</a></h1>
<p>Production date: 01-07-2024</p>
<p>Produced by: Inês Girão (+ATLANTIC)</p>
<section id="use-case-using-land-cover-products-to-quantify-urbanisation-trends">
<h2>🌍 Use case: Using land cover products to quantify urbanisation trends<a class="headerlink" href="#use-case-using-land-cover-products-to-quantify-urbanisation-trends" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the dataset accurate and consistent for the analysis of urbanisation trends in the Iberian Peninsula?</strong></p></li>
</ul>
<p>Land Cover data is an invaluable resource for a wide range of fields, from climate change research to urban planning. Land Cover products that provide historical timelines enable scientists, policymakers, and planners to understand and analyse the transformation of land cover over recent decades (<a class="reference external" href="https://doi.org/10.1016/j.jenvman.2012.10.007">Vargo et al, 2013</a>; <a class="reference external" href="https://doi.org/10.1088/1755-1315/113/1/012087">Chang et al., 2018</a>).</p>
<p>This notebook will access the <em><strong>Land cover classification gridded maps from 1992 to present derived from satellite observations</strong></em> (henceforth, LC) data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S), and analyse the spatial patterns of the LC over a given Area of Interest (AoI) and time.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<p>The dataset maintains strong temporal continuity, with annual updates ensuring a smooth and reliable representation of land cover changes over time. While breakpoints were identified, they generally did not indicate major disruptions, reinforcing the dataset’s stability for long-term trend analysis.</p>
<p>The presence of breakpoints does not necessarily indicate abrupt landscape shifts but rather highlights the sensitivity of detection methods to gradual changes. This suggests that while breakpoints can help refine analysis, their impact on overall trends remains limited, emphasising the dataset’s resilience to minor variations.</p>
<p>For the specific land cover type analysed, the dataset exhibits a consistent ability to capture underlying trends. The similarity in results across segmented and total trends suggests that the data structure is well-calibrated, minimising distortions that could arise from classification inconsistencies or methodological biases.</p>
</div>
<p><img alt="Urbanization_Map_Series.png" src="../../_images/Urbanization_Map_Series.png" /></p>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p><strong>This Use Case comprises the following steps:</strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-trend-assessment-q02-code-section-1"><span class="std std-ref">1. Define the AoI, search and download LC data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-trend-assessment-q02-code-section-2"><span class="std std-ref">2. Inspect and view data for the defined AoI (Iberian Peninsula)</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-trend-assessment-q02-code-section-3"><span class="std std-ref">3. Breakpoint Detection</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-trend-assessment-q02-code-section-4"><span class="std std-ref">4.Trend Assessment</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-trend-assessment-q02-code-section-5"><span class="std std-ref">5. Discussion</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="define-the-aoi-search-and-download-lc-data">
<span id="satellite-satellite-land-cover-trend-assessment-q02-code-section-1"></span><h3><strong>1. Define the AoI, search and download LC data</strong><a class="headerlink" href="#define-the-aoi-search-and-download-lc-data" title="Link to this heading">#</a></h3>
<p>Before we begin we must prepare our environment. This includes installing the Application Programming Interface (API) of the CDS, and importing the various python libraries that we will need.</p>
<section id="install-cds-api">
<h4>Install CDS API<a class="headerlink" href="#install-cds-api" title="Link to this heading">#</a></h4>
<p>To install the CDS API, run the following command. We use an exclamation mark to pass the command to the shell (not to the Python interpreter).
If you already have the CDS API installed, you can skip or comment this step.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>cdsapi
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: cdsapi in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (0.7.5)
Requirement already satisfied: datapi in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (0.1.1)
Requirement already satisfied: requests&gt;=2.5.0 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (2.32.3)
Requirement already satisfied: tqdm in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (4.67.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (3.4.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2024.8.30)
Requirement already satisfied: attrs in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (24.3.0)
Requirement already satisfied: multiurl&gt;=0.3.2 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (0.3.3)
Requirement already satisfied: typing-extensions in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (4.12.2)
Requirement already satisfied: pytz in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (2024.2)
Requirement already satisfied: python-dateutil in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (2.9.0.post0)
Requirement already satisfied: six&gt;=1.5 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from python-dateutil-&gt;multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (1.17.0)
</pre></div>
</div>
</div>
</div>
<section id="import-all-the-libraries-packages">
<h5>Import all the libraries/packages<a class="headerlink" href="#import-all-the-libraries-packages" title="Link to this heading">#</a></h5>
<p>We will be working with data in NetCDF format. To best handle this type of data we will use libraries for working with multidimensional arrays, in particular Xarray.
We will also need libraries for plotting and viewing data.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Import Standard Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1">#  Import Numerical &amp; Statistical Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">kendalltau</span><span class="p">,</span> <span class="n">theilslopes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">OLS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.polynomial.polynomial</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polynomial</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ruptures</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rpt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">savgol_filter</span>

<span class="c1">#  Import Geospatial Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>  <span class="c1"># Import vector geospatial data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span>  <span class="c1"># Transform attributes and geometries into specific regions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">Polygon</span>


<span class="c1">#  Import Visualization Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">colors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">TwoSlopeNorm</span><span class="p">,</span> <span class="n">Normalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Patch</span>


<span class="c1">#  Import External Tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>


<span class="c1">#  Set Matplotlib Style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>  <span class="c1"># Predefined style for all graphical outputs</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-overview">
<h5>Data Overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h5>
<p>To search for data, visit the CDS website: <a class="reference external" href="http://cds.climate.copernicus.eu">http://cds.climate.copernicus.eu</a>. Here you can search for ‘Satellite observations’ using the search bar. The data we need for this tutorial is the <em><strong>Land cover classification gridded maps from 1992 to present derived from satellite observations</strong></em>. This catalogue entry provides global Land Cover Classification (LCC) maps with a very high spatial resolution, with a L4 processing level, on an annual basis with a one-year delay, following the <a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245">Global Climate Observing System (GCOS) convention requirements</a>. LULC maps correspond to a global classification scheme, encompassing 22 classes.</p>
<p>The dataset consists of 2 versions (v2.0.7 produced by the European Space Agency (ESA) Climate Change Initiative (CCI) and v2.1.1 produced by Copernicus Climate Change Service (C3S)).</p>
<p>Data specifications for this use case:</p>
<ul class="simple">
<li><p><strong>Years:</strong> 1992 to 2022</p></li>
<li><p><strong>Version:</strong> v2.0.7 before 1992 and v2.1.1 after 2016</p></li>
<li><p><strong>Format:</strong> Zip files</p></li>
</ul>
<p>At the end of the download form, select “<strong>Show API request</strong>”. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook. Having copied the API request, running it will retrieve and download the data you requested into your local directory. However, before you run it, the <strong>terms and conditions</strong> of this particular dataset need to have been accepted directly at the CDS website. The option to view and accept these conditions is given at the end of the download form, just above the “<strong>Show API request</strong>” option. In addition, it is also useful to define the time period and AoI parameters and edit the request accordingly, as exemplified in the cells below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Years to download</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1992</span><span class="p">,</span> <span class="mi">1993</span><span class="p">,</span> <span class="mi">1994</span><span class="p">,</span>
        <span class="mi">1995</span><span class="p">,</span> <span class="mi">1996</span><span class="p">,</span> <span class="mi">1997</span><span class="p">,</span>
        <span class="mi">1998</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span>
        <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span>
        <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span>
        <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span>
        <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span>
        <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span>
        <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span>
        <span class="mi">2022</span><span class="p">,</span> <span class="mi">2022</span><span class="p">]</span>


<span class="c1"># List of requests to retrieve data</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-land-cover&quot;</span>
<span class="n">requests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2_0_7cds&quot;</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2016</span> <span class="k">else</span> <span class="s2">&quot;v2_1_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Region of interest (Iberian Peninsula)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and regionalize by AoI</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
 
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/32 [00:00&lt;?, ?it/s]2025-04-30 11:46:38,909 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 11:46:38,911 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 11:46:38,912 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 11:46:39,194 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 11:46:39,196 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 11:46:39,197 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 11:46:39,580 INFO Request ID is a524c218-b9cb-4e4d-9530-aff1bed008a5
2025-04-30 11:46:39,672 INFO status has been updated to accepted
Recovering from connection error [(&#39;Connection aborted.&#39;, RemoteDisconnected(&#39;Remote end closed connection without response&#39;))], attemps 1 of 500
Retrying in 120 seconds
2025-04-30 12:23:04,955 INFO status has been updated to running
2025-04-30 12:31:06,134 INFO status has been updated to successful
  3%|▎         | 1/32 [44:29&lt;22:59:23, 2669.81s/it]2025-04-30 12:31:08,530 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:31:08,530 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:31:08,531 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:31:08,802 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:31:08,802 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:31:08,803 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:31:09,456 INFO Request ID is 8078eca7-2c6b-4d16-b15b-2e40308ff96e
2025-04-30 12:31:09,649 INFO status has been updated to accepted
2025-04-30 12:31:42,974 INFO status has been updated to running
2025-04-30 12:37:29,636 INFO status has been updated to successful
  6%|▋         | 2/32 [50:53&lt;11:02:34, 1325.16s/it]2025-04-30 12:37:32,410 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:37:32,412 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:37:32,414 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:37:32,664 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:37:32,666 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:37:32,669 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:37:33,179 INFO Request ID is 8a0ca309-d10f-4625-881a-86abfeddeff9
2025-04-30 12:37:33,272 INFO status has been updated to accepted
2025-04-30 12:38:06,155 INFO status has been updated to running
2025-04-30 12:43:52,790 INFO status has been updated to successful
  9%|▉         | 3/32 [57:16&lt;7:12:29, 894.83s/it]  2025-04-30 12:43:55,140 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:43:55,143 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:43:55,145 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:43:55,378 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:43:55,380 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:43:55,382 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:43:55,637 INFO Request ID is 4c07d2e3-6805-42d9-a9c2-bff7c60ddf15
2025-04-30 12:43:56,035 INFO status has been updated to accepted
2025-04-30 12:44:01,087 INFO status has been updated to running
2025-04-30 12:50:15,716 INFO status has been updated to successful
 12%|█▎        | 4/32 [1:03:39&lt;5:23:21, 692.92s/it]2025-04-30 12:50:18,510 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:50:18,512 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:50:18,513 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:50:23,725 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:50:23,727 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:50:23,728 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:50:23,990 INFO Request ID is ad76e930-0d0e-430c-8db9-6ea1e6b90301
2025-04-30 12:50:24,066 INFO status has been updated to accepted
2025-04-30 12:50:57,097 INFO status has been updated to running
2025-04-30 12:54:43,841 INFO status has been updated to successful
 16%|█▌        | 5/32 [1:08:09&lt;4:03:07, 540.29s/it]2025-04-30 12:54:48,174 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:54:48,175 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:54:48,176 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:54:48,403 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:54:48,404 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:54:48,407 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:54:48,879 INFO Request ID is 22db6947-fdc2-4ad4-bd98-d5eb17c364bb
2025-04-30 12:54:48,987 INFO status has been updated to accepted
2025-04-30 12:54:57,895 INFO status has been updated to running
2025-04-30 12:59:09,188 INFO status has been updated to successful
 19%|█▉        | 6/32 [1:12:32&lt;3:13:18, 446.08s/it]2025-04-30 12:59:11,372 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:59:11,374 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:59:11,376 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:59:11,605 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 12:59:11,607 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 12:59:11,609 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 12:59:11,920 INFO Request ID is 279e5617-d480-48a3-a4e4-c6e43e9896ea
2025-04-30 12:59:12,019 INFO status has been updated to accepted
2025-04-30 12:59:33,835 INFO status has been updated to running
2025-04-30 13:05:31,994 INFO status has been updated to successful
 22%|██▏       | 7/32 [1:18:56&lt;2:57:19, 425.57s/it]2025-04-30 13:05:34,760 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:05:34,760 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:05:34,761 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:05:34,968 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:05:34,970 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:05:34,973 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:05:35,259 INFO Request ID is 0c259d58-91c7-42fb-a75e-e9138905ad12
2025-04-30 13:05:35,370 INFO status has been updated to accepted
2025-04-30 13:05:56,771 INFO status has been updated to running
2025-04-30 13:09:54,361 INFO status has been updated to successful
 25%|██▌       | 8/32 [1:23:18&lt;2:29:28, 373.69s/it]2025-04-30 13:09:57,363 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:09:57,364 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:09:57,364 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:09:57,604 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:09:57,605 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:09:57,606 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:09:58,091 INFO Request ID is 22449691-87a5-4291-b647-c8f9ec42617d
2025-04-30 13:09:58,187 INFO status has been updated to accepted
2025-04-30 13:10:19,476 INFO status has been updated to running
2025-04-30 13:18:17,922 INFO status has been updated to successful
 28%|██▊       | 9/32 [1:31:41&lt;2:38:43, 414.06s/it]2025-04-30 13:18:20,177 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:18:20,179 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:18:20,184 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:18:25,400 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:18:25,402 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:18:25,404 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:18:25,625 INFO Request ID is 632b4d1b-6109-4362-bf9f-f5346d6f8a8f
2025-04-30 13:18:25,708 INFO status has been updated to accepted
2025-04-30 13:18:39,419 INFO status has been updated to running
2025-04-30 13:24:45,690 INFO status has been updated to successful
 31%|███▏      | 10/32 [1:38:10&lt;2:28:57, 406.23s/it]2025-04-30 13:24:48,860 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:24:48,862 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:24:48,865 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:24:49,145 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:24:49,148 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:24:49,150 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:24:49,393 INFO Request ID is 75482b66-5bc9-48ea-881a-c478f0ead525
2025-04-30 13:24:49,504 INFO status has been updated to accepted
2025-04-30 13:25:10,848 INFO status has been updated to running
2025-04-30 13:33:09,311 INFO status has been updated to successful
 34%|███▍      | 11/32 [1:46:33&lt;2:32:32, 435.82s/it]2025-04-30 13:33:11,764 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:33:11,765 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:33:11,766 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:33:11,989 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:33:11,990 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:33:11,990 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:33:12,224 INFO Request ID is a6e8e6dd-2122-4a39-89ff-9f9f45006e72
2025-04-30 13:33:12,300 INFO status has been updated to accepted
2025-04-30 13:33:35,479 INFO status has been updated to running
2025-04-30 13:33:46,976 INFO status has been updated to accepted
2025-04-30 13:34:04,148 INFO status has been updated to running
2025-04-30 13:37:34,007 INFO status has been updated to successful
 38%|███▊      | 12/32 [1:50:58&lt;2:07:57, 383.88s/it]2025-04-30 13:37:36,890 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:37:36,890 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:37:36,891 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:37:37,093 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:37:37,094 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:37:37,094 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:37:37,464 INFO Request ID is bc7f075e-b879-472a-970d-e5f5218cd0a7
2025-04-30 13:37:37,554 INFO status has been updated to accepted
2025-04-30 13:38:55,835 INFO status has been updated to running
2025-04-30 13:48:00,404 INFO status has been updated to successful
 41%|████      | 13/32 [2:01:24&lt;2:24:47, 457.26s/it]2025-04-30 13:48:02,970 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:48:02,971 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:48:02,972 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:48:03,202 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:48:03,203 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:48:03,204 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:48:03,609 INFO Request ID is 417ae11a-1b10-47ba-a6ef-69159d17bbea
2025-04-30 13:48:03,811 INFO status has been updated to accepted
2025-04-30 13:48:36,684 INFO status has been updated to running
2025-04-30 13:52:22,863 INFO status has been updated to successful
 44%|████▍     | 14/32 [2:05:46&lt;1:59:30, 398.34s/it]2025-04-30 13:52:25,152 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:52:25,153 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:52:25,153 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:52:25,356 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:52:25,358 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:52:25,360 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:52:25,637 INFO Request ID is c7c79949-b9c3-45b6-a6dc-54e4cb62757b
2025-04-30 13:52:25,733 INFO status has been updated to accepted
2025-04-30 13:52:47,120 INFO status has been updated to running
2025-04-30 13:58:50,239 INFO status has been updated to successful
 47%|████▋     | 15/32 [2:12:14&lt;1:51:57, 395.16s/it]2025-04-30 13:58:52,971 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:58:52,972 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:58:52,972 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:58:53,342 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 13:58:53,343 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 13:58:53,344 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 13:58:53,940 INFO Request ID is 7fca961e-7886-40a2-b753-3b838ad9c414
2025-04-30 13:58:54,039 INFO status has been updated to accepted
2025-04-30 13:59:02,796 INFO status has been updated to running
2025-04-30 14:05:14,782 INFO status has been updated to successful
 50%|█████     | 16/32 [2:18:38&lt;1:44:28, 391.77s/it]2025-04-30 14:05:16,842 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:05:16,843 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:05:16,843 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:05:17,049 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:05:17,050 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:05:17,050 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:05:17,509 INFO Request ID is ae6acdfa-09f8-4663-ab7c-0323d5d32ca9
2025-04-30 14:05:17,618 INFO status has been updated to accepted
2025-04-30 14:05:31,466 INFO status has been updated to running
2025-04-30 14:09:37,205 INFO status has been updated to successful
 53%|█████▎    | 17/32 [2:23:00&lt;1:28:14, 352.97s/it]2025-04-30 14:09:44,781 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:09:44,783 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:09:44,784 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:09:44,988 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:09:44,989 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:09:44,989 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:09:45,365 INFO Request ID is 7cc524f4-cbd8-4a88-989b-917845f2c8a0
2025-04-30 14:09:45,473 INFO status has been updated to accepted
2025-04-30 14:10:18,672 INFO status has been updated to running
2025-04-30 14:14:04,948 INFO status has been updated to successful
 59%|█████▉    | 19/32 [2:27:28&lt;54:33, 251.77s/it]  2025-04-30 14:14:07,547 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:14:07,548 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:14:07,549 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:14:07,783 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:14:07,784 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:14:07,784 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:14:08,091 INFO Request ID is f729b216-8693-4349-8fff-f0268c2e8659
2025-04-30 14:14:08,198 INFO status has been updated to accepted
2025-04-30 14:14:21,898 INFO status has been updated to running
2025-04-30 14:17:00,629 INFO status has been updated to successful
 62%|██████▎   | 20/32 [2:30:24&lt;46:33, 232.81s/it]2025-04-30 14:17:02,940 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:17:02,941 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:17:02,942 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:17:03,184 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:17:03,184 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:17:03,185 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:17:03,709 INFO Request ID is 51b737f9-29b8-4ba5-af4d-63a4ee2a2185
2025-04-30 14:17:03,829 INFO status has been updated to accepted
2025-04-30 14:17:18,181 INFO status has been updated to running
2025-04-30 14:21:23,684 INFO status has been updated to successful
 69%|██████▉   | 22/32 [2:34:47&lt;31:48, 190.82s/it]2025-04-30 14:21:26,129 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:21:26,130 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:21:26,131 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:21:26,371 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:21:26,372 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:21:26,372 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:21:27,120 INFO Request ID is bd5b29b4-56c4-4180-81f4-7876fb3e9beb
2025-04-30 14:21:27,217 INFO status has been updated to accepted
2025-04-30 14:22:17,541 INFO status has been updated to running
2025-04-30 14:25:46,543 INFO status has been updated to successful
 72%|███████▏  | 23/32 [2:39:10&lt;31:06, 207.36s/it]2025-04-30 14:25:49,319 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:25:49,320 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:25:49,321 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:25:49,559 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:25:49,560 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:25:49,560 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:25:50,002 INFO Request ID is 61f75da6-5d05-40bc-9a08-33794c8294b4
2025-04-30 14:25:50,074 INFO status has been updated to accepted
2025-04-30 14:26:11,375 INFO status has been updated to running
2025-04-30 14:34:15,579 INFO status has been updated to successful
 78%|███████▊  | 25/32 [2:47:40&lt;26:22, 226.12s/it]2025-04-30 14:34:18,949 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:34:18,953 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:34:18,955 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:34:24,187 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:34:24,189 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:34:24,192 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:34:24,438 INFO Request ID is f6fcdae9-83ab-4a94-a2ad-9311ca12b93e
2025-04-30 14:34:24,578 INFO status has been updated to accepted
2025-04-30 14:34:45,965 INFO status has been updated to running
2025-04-30 14:37:17,124 INFO status has been updated to successful
 81%|████████▏ | 26/32 [2:50:43&lt;21:40, 216.67s/it]2025-04-30 14:37:22,180 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:37:22,181 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:37:22,181 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:37:22,403 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:37:22,404 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:37:22,405 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:37:22,690 INFO Request ID is 093a3890-e1f6-431e-aeee-c468a050a0cd
2025-04-30 14:37:22,790 INFO status has been updated to accepted
2025-04-30 14:37:31,341 INFO status has been updated to running
2025-04-30 14:41:42,069 INFO status has been updated to successful
 88%|████████▊ | 28/32 [2:55:05&lt;12:14, 183.63s/it]2025-04-30 14:41:44,322 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:41:44,325 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:41:44,327 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:41:44,692 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:41:44,694 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:41:44,697 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:41:45,252 INFO Request ID is 5ac6dc3f-7719-4c0d-a53e-fce226dfc749
2025-04-30 14:41:45,336 INFO status has been updated to accepted
2025-04-30 14:42:06,830 INFO status has been updated to running
2025-04-30 14:50:05,252 INFO status has been updated to successful
 91%|█████████ | 29/32 [3:03:29&lt;12:38, 252.88s/it]2025-04-30 14:50:08,415 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:50:08,417 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:50:08,419 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:50:08,652 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 14:50:08,654 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 14:50:08,656 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 14:50:08,894 INFO Request ID is c5ca726d-402f-4d23-b446-f289e3f7cb58
2025-04-30 14:50:09,006 INFO status has been updated to accepted
2025-04-30 14:50:17,661 INFO status has been updated to running
2025-04-30 15:00:29,648 INFO status has been updated to successful
 94%|█████████▍| 30/32 [3:13:53&lt;11:20, 340.47s/it]2025-04-30 15:00:32,466 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 15:00:32,467 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 15:00:32,468 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 15:00:32,725 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-30 15:00:32,726 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-30 15:00:32,727 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-30 15:00:33,007 INFO Request ID is c2efb96d-0cca-40a6-abf3-b210164652ff
2025-04-30 15:00:33,081 INFO status has been updated to accepted
2025-04-30 15:01:05,881 INFO status has been updated to running
2025-04-30 15:06:52,510 INFO status has been updated to successful
100%|██████████| 32/32 [3:20:18&lt;00:00, 375.56s/it]
/tmp/ipykernel_551452/1081004638.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  ds = ds.assign_coords(year=ds[&quot;time&quot;].dt.year).swap_dims(time=&quot;year&quot;).drop(&quot;time&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Inspect the database</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 7GB
Dimensions:              (year: 31, latitude: 3600, longitude: 5040, bounds: 2)
Coordinates:
    lat_bounds           (latitude, bounds) float64 58kB dask.array&lt;chunksize=(3600, 2), meta=np.ndarray&gt;
    lon_bounds           (longitude, bounds) float64 81kB dask.array&lt;chunksize=(5040, 2), meta=np.ndarray&gt;
    time_bounds          (year, bounds) datetime64[ns] 496B dask.array&lt;chunksize=(1, 2), meta=np.ndarray&gt;
  * latitude             (latitude) float64 29kB 45.0 45.0 44.99 ... 35.0 35.0
  * longitude            (longitude) float64 40kB -9.999 -9.996 ... 3.996 3.999
  * year                 (year) int64 248B 1992 1993 1994 ... 2020 2021 2022
Dimensions without coordinates: bounds
Data variables:
    lccs_class           (year, latitude, longitude) uint8 562MB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    processed_flag       (year, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    current_pixel_state  (year, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    observation_count    (year, latitude, longitude) uint16 1GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    change_count         (year, latitude, longitude) uint8 562MB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    crs                  (year) int32 124B -2147483647 ... -2147483647
Attributes: (12/38)
    id:                         ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-v2.0.7cds
    title:                      Land Cover Map of ESA CCI brokered by CDS
    summary:                    This dataset characterizes the land cover of ...
    type:                       ESACCI-LC-L4-LCCS-Map-300m-P1Y
    project:                    Climate Change Initiative - European Space Ag...
    references:                 http://www.esa-landcover-cci.org/
    ...                         ...
    geospatial_lon_max:         180
    spatial_resolution:         300m
    geospatial_lat_units:       degrees_north
    geospatial_lat_resolution:  0.002778
    geospatial_lon_units:       degrees_east
    geospatial_lon_resolution:  0.002778</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1d25da7e-6ba9-4903-8cf8-2ce936aa37ad' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1d25da7e-6ba9-4903-8cf8-2ce936aa37ad' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 31</li><li><span class='xr-has-index'>latitude</span>: 3600</li><li><span class='xr-has-index'>longitude</span>: 5040</li><li><span>bounds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0660df8d-152e-4fbc-8dea-f01683a59bbf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0660df8d-152e-4fbc-8dea-f01683a59bbf' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lat_bounds</span></div><div class='xr-var-dims'>(latitude, bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3600, 2), meta=np.ndarray&gt;</div><input id='attrs-8bc87dd0-9e39-46bd-bb02-321c88a7c3cc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8bc87dd0-9e39-46bd-bb02-321c88a7c3cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3df4adfc-0c5a-4b9d-aafa-08ba3c8830d4' class='xr-var-data-in' type='checkbox'><label for='data-3df4adfc-0c5a-4b9d-aafa-08ba3c8830d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 56.25 kiB </td>
                        <td> 56.25 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3600, 2) </td>
                        <td> (3600, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 150 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">3600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bounds</span></div><div class='xr-var-dims'>(longitude, bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(5040, 2), meta=np.ndarray&gt;</div><input id='attrs-9ec00335-4cb4-4d9e-b4ba-57ec7e1fbcc8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9ec00335-4cb4-4d9e-b4ba-57ec7e1fbcc8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a692d852-4413-4a9f-a59b-4ab54c138126' class='xr-var-data-in' type='checkbox'><label for='data-a692d852-4413-4a9f-a59b-4ab54c138126' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 78.75 kiB </td>
                        <td> 78.75 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (5040, 2) </td>
                        <td> (5040, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 150 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">5040</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bounds</span></div><div class='xr-var-dims'>(year, bounds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 2), meta=np.ndarray&gt;</div><input id='attrs-2fcccbab-d25c-43d9-afbc-50ea5d6cd7db' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2fcccbab-d25c-43d9-afbc-50ea5d6cd7db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d17130f7-f15c-422c-93b8-782a430e7320' class='xr-var-data-in' type='checkbox'><label for='data-d17130f7-f15c-422c-93b8-782a430e7320' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 496 B </td>
                        <td> 16 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 2) </td>
                        <td> (1, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 31 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> datetime64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="86" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="36" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="36" y2="3" />
  <line x1="0" y1="11" x2="36" y2="11" />
  <line x1="0" y1="15" x2="36" y2="15" />
  <line x1="0" y1="23" x2="36" y2="23" />
  <line x1="0" y1="30" x2="36" y2="30" />
  <line x1="0" y1="34" x2="36" y2="34" />
  <line x1="0" y1="42" x2="36" y2="42" />
  <line x1="0" y1="50" x2="36" y2="50" />
  <line x1="0" y1="54" x2="36" y2="54" />
  <line x1="0" y1="61" x2="36" y2="61" />
  <line x1="0" y1="65" x2="36" y2="65" />
  <line x1="0" y1="73" x2="36" y2="73" />
  <line x1="0" y1="81" x2="36" y2="81" />
  <line x1="0" y1="85" x2="36" y2="85" />
  <line x1="0" y1="92" x2="36" y2="92" />
  <line x1="0" y1="100" x2="36" y2="100" />
  <line x1="0" y1="104" x2="36" y2="104" />
  <line x1="0" y1="112" x2="36" y2="112" />
  <line x1="0" y1="120" x2="36" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="36" y1="0" x2="36" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 36.05090363626093,0.0 36.05090363626093,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.025452" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="56.050904" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,56.050904,60.000000)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.0 45.0 44.99 ... 35.01 35.0 35.0</div><input id='attrs-38ab49b8-3123-4381-b983-d102a0cb205d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38ab49b8-3123-4381-b983-d102a0cb205d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ffcaeee-0bd9-4646-aacf-f3a348b36ae1' class='xr-var-data-in' type='checkbox'><label for='data-5ffcaeee-0bd9-4646-aacf-f3a348b36ae1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>bounds :</span></dt><dd>lat_bounds</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>positive :</span></dt><dd>North</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>out_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([44.998611, 44.995833, 44.993056, ..., 35.006944, 35.004167, 35.001389])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.999 -9.996 ... 3.996 3.999</div><input id='attrs-249f8ac5-7b72-43e3-83b8-0d338fca73b7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-249f8ac5-7b72-43e3-83b8-0d338fca73b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6c3c055-64ac-4c91-9248-deacdec81edc' class='xr-var-data-in' type='checkbox'><label for='data-c6c3c055-64ac-4c91-9248-deacdec81edc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>valid_max :</span></dt><dd>180.0</dd><dt><span>bounds :</span></dt><dd>lon_bounds</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>positive :</span></dt><dd>East</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>out_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-9.998611, -9.995833, -9.993056, ...,  3.993056,  3.995833,  3.998611])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1992 1993 1994 ... 2020 2021 2022</div><input id='attrs-35fa3ed5-8a5e-4510-8106-8b3cd9cdccc3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35fa3ed5-8a5e-4510-8106-8b3cd9cdccc3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e19a1e6-536f-40fb-b0ec-59a9546bc575' class='xr-var-data-in' type='checkbox'><label for='data-7e19a1e6-536f-40fb-b0ec-59a9546bc575' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bounds</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>stored_direction :</span></dt><dd>increasing</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd></dd><dt><span>valid_min :</span></dt><dd></dd><dt><span>value :</span></dt><dd></dd><dt><span>z_bounds_factors :</span></dt><dd></dd><dt><span>z_factors :</span></dt><dd></dd><dt><span>bounds_values :</span></dt><dd></dd><dt><span>out_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019, 2020, 2021, 2022])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5a28cddf-1ad6-44e0-a440-18b6eb3e3c1d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5a28cddf-1ad6-44e0-a440-18b6eb3e3c1d' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lccs_class</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-24c03ba1-11a7-4231-ae1c-8efa7ddb650e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-24c03ba1-11a7-4231-ae1c-8efa7ddb650e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec4ba1f8-dcb4-4642-81f3-9a912be4dff8' class='xr-var-data-in' type='checkbox'><label for='data-ec4ba1f8-dcb4-4642-81f3-9a912be4dff8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>land_cover_lccs</dd><dt><span>flag_colors :</span></dt><dd>#ffff64 #ffff64 #ffff00 #aaf0f0 #dcf064 #c8c864 #006400 #00a000 #00a000 #aac800 #003c00 #003c00 #005000 #285000 #285000 #286400 #788200 #8ca000 #be9600 #966400 #966400 #966400 #ffb432 #ffdcd2 #ffebaf #ffc864 #ffd278 #ffebaf #00785a #009678 #00dc82 #c31400 #fff5d7 #dcdcdc #fff5d7 #0046c8 #ffffff</dd><dt><span>long_name :</span></dt><dd>Land cover class defined in LCCS</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>220</dd><dt><span>ancillary_variables :</span></dt><dd>processed_flag current_pixel_state observation_count change_count</dd><dt><span>flag_meanings :</span></dt><dd>no_data cropland_rainfed cropland_rainfed_herbaceous_cover cropland_rainfed_tree_or_shrub_cover cropland_irrigated mosaic_cropland mosaic_natural_vegetation tree_broadleaved_evergreen_closed_to_open tree_broadleaved_deciduous_closed_to_open tree_broadleaved_deciduous_closed tree_broadleaved_deciduous_open tree_needleleaved_evergreen_closed_to_open tree_needleleaved_evergreen_closed tree_needleleaved_evergreen_open tree_needleleaved_deciduous_closed_to_open tree_needleleaved_deciduous_closed tree_needleleaved_deciduous_open tree_mixed mosaic_tree_and_shrub mosaic_herbaceous shrubland shrubland_evergreen shrubland_deciduous grassland lichens_and_mosses sparse_vegetation sparse_tree sparse_shrub sparse_herbaceous tree_cover_flooded_fresh_or_brakish_water tree_cover_flooded_saline_water shrub_or_herbaceous_cover_flooded urban bare_areas bare_areas_consolidated bare_areas_unconsolidated water snow_and_ice</dd><dt><span>flag_values :</span></dt><dd>[  0  10  11  12  20  30  40  50  60  61  62  70  71  72  80  81  82  90
 100 110 120 121 122 130 140 150 151 152 153 160 170 180 190 200 201 202
 210 220]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 536.41 MiB </td>
                        <td> 4.33 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>processed_flag</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-72325a0f-2184-487c-91d5-ba168e7efaea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-72325a0f-2184-487c-91d5-ba168e7efaea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41939fee-122c-405a-8aa1-f4751ab27faa' class='xr-var-data-in' type='checkbox'><label for='data-41939fee-122c-405a-8aa1-f4751ab27faa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>LC map processed area flag</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs status_flag</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>1</dd><dt><span>flag_meanings :</span></dt><dd>not_processed processed</dd><dt><span>flag_values :</span></dt><dd>[0 1]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.10 GiB </td>
                        <td> 17.30 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>current_pixel_state</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-e88b95ec-1904-4b96-a04d-bbdb2c510c19' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e88b95ec-1904-4b96-a04d-bbdb2c510c19' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d6f9059-961f-4c18-8632-2580591008fe' class='xr-var-data-in' type='checkbox'><label for='data-4d6f9059-961f-4c18-8632-2580591008fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>LC pixel type mask</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs status_flag</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>5</dd><dt><span>flag_meanings :</span></dt><dd>invalid clear_land clear_water clear_snow_ice cloud cloud_shadow</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.10 GiB </td>
                        <td> 17.30 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observation_count</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-73ed690c-5570-42ad-a91e-fc7715d7c5aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73ed690c-5570-42ad-a91e-fc7715d7c5aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20a59f73-3895-4312-b6ab-18bd0b629872' class='xr-var-data-in' type='checkbox'><label for='data-20a59f73-3895-4312-b6ab-18bd0b629872' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>number of valid observations</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs number_of_observations</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>32767</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.05 GiB </td>
                        <td> 8.65 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>change_count</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-f223a054-fdb1-4fd3-9329-40d7b8d932f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f223a054-fdb1-4fd3-9329-40d7b8d932f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2af4dc2a-43f2-47a5-b05f-69fb97e9fce5' class='xr-var-data-in' type='checkbox'><label for='data-2af4dc2a-43f2-47a5-b05f-69fb97e9fce5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>number of class changes</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>100</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 536.41 MiB </td>
                        <td> 4.33 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>-2147483647 ... -2147483647</div><input id='attrs-fa695736-b9fa-4ea5-baec-9d646848ea36' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fa695736-b9fa-4ea5-baec-9d646848ea36' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-120260f2-0180-46eb-b5d7-a17a3a4dfa11' class='xr-var-data-in' type='checkbox'><label for='data-120260f2-0180-46eb-b5d7-a17a3a4dfa11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;, 
  DATUM[&quot;World Geodetic System 1984&quot;, 
    SPHEROID[&quot;WGS 84&quot;, 6378137.0, 298.257223563, AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]], 
    AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]], 
  PRIMEM[&quot;Greenwich&quot;, 0.0, AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]], 
  UNIT[&quot;degree&quot;, 0.017453292519943295], 
  AXIS[&quot;Geodetic longitude&quot;, EAST], 
  AXIS[&quot;Geodetic latitude&quot;, NORTH], 
  AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>i2m :</span></dt><dd>0.002777777777778,0.0,0.0,-0.002777777777778,-180.0,90.0</dd></dl></div><div class='xr-var-data'><pre>array([-2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-20a817c1-a603-46b2-801a-3a8bf750e6db' class='xr-section-summary-in' type='checkbox'  ><label for='section-20a817c1-a603-46b2-801a-3a8bf750e6db' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8148a304-1b2b-4a5c-9179-02162ce944af' class='xr-index-data-in' type='checkbox'/><label for='index-8148a304-1b2b-4a5c-9179-02162ce944af' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  44.9986111111111,  44.99583333333334,  44.99305555555557,
        44.99027777777778,  44.98750000000001,  44.98472222222222,
        44.98194444444445, 44.979166666666686,  44.97638888888889,
       44.973611111111126,
       ...
        35.02638888888889,  35.02361111111112,  35.02083333333334,
        35.01805555555556,  35.01527777777778,            35.0125,
        35.00972222222222,  35.00694444444444,  35.00416666666668,
         35.0013888888889],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=3600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-100863df-9bfd-454b-8ec9-584160e09f13' class='xr-index-data-in' type='checkbox'/><label for='index-100863df-9bfd-454b-8ec9-584160e09f13' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-9.998611111111103, -9.995833333333337, -9.993055555555543,
       -9.990277777777777, -9.987499999999983, -9.984722222222217,
       -9.981944444444451, -9.979166666666657, -9.976388888888891,
       -9.973611111111097,
       ...
       3.9736111111111256, 3.9763888888888914, 3.9791666666666856,
       3.9819444444444514,  3.984722222222217, 3.9875000000000114,
        3.990277777777777, 3.9930555555555713,  3.995833333333337,
       3.9986111111111313],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=5040))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-49b981d1-15a7-4931-9c81-fcb6fc6bbbd1' class='xr-index-data-in' type='checkbox'/><label for='index-49b981d1-15a7-4931-9c81-fcb6fc6bbbd1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019, 2020, 2021, 2022],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1a3bcbbf-5f1e-4de2-98be-f142b7e71acc' class='xr-section-summary-in' type='checkbox'  ><label for='section-1a3bcbbf-5f1e-4de2-98be-f142b7e71acc' class='xr-section-summary' >Attributes: <span>(38)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>id :</span></dt><dd>ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-v2.0.7cds</dd><dt><span>title :</span></dt><dd>Land Cover Map of ESA CCI brokered by CDS</dd><dt><span>summary :</span></dt><dd>This dataset characterizes the land cover of a particular year (see time_coverage). The land cover was derived from the analysis of satellite data time series of the full period.</dd><dt><span>type :</span></dt><dd>ESACCI-LC-L4-LCCS-Map-300m-P1Y</dd><dt><span>project :</span></dt><dd>Climate Change Initiative - European Space Agency</dd><dt><span>references :</span></dt><dd>http://www.esa-landcover-cci.org/</dd><dt><span>institution :</span></dt><dd>UCLouvain</dd><dt><span>contact :</span></dt><dd>https://www.ecmwf.int/en/about/contact-us/get-support</dd><dt><span>comment :</span></dt><dd></dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>standard_name_vocabulary :</span></dt><dd>NetCDF Climate and Forecast (CF) Standard Names version 21</dd><dt><span>keywords :</span></dt><dd>land cover classification,satellite,observation</dd><dt><span>keywords_vocabulary :</span></dt><dd>NASA Global Change Master Directory (GCMD) Science Keywords</dd><dt><span>license :</span></dt><dd>ESA CCI Data Policy: free and open access</dd><dt><span>naming_authority :</span></dt><dd>org.esa-cci</dd><dt><span>cdm_data_type :</span></dt><dd>grid</dd><dt><span>TileSize :</span></dt><dd>2025:2025</dd><dt><span>tracking_id :</span></dt><dd>61b96fd7-42c3-4374-9de1-0dc3b0bcae2a</dd><dt><span>product_version :</span></dt><dd>2.0.7cds</dd><dt><span>creation_date :</span></dt><dd>20181130T095451Z</dd><dt><span>creator_name :</span></dt><dd>UCLouvain</dd><dt><span>creator_url :</span></dt><dd>http://www.uclouvain.be/</dd><dt><span>creator_email :</span></dt><dd>landcover-cci@uclouvain.be</dd><dt><span>source :</span></dt><dd>MERIS FR L1B version 5.05, MERIS RR L1B version 8.0, SPOT VGT P</dd><dt><span>history :</span></dt><dd>amorgos-4,0, lc-sdr-1.0, lc-sr-1.0, lc-classification-1.0,lc-user-tools-3.13,lc-user-tools-4.3</dd><dt><span>time_coverage_start :</span></dt><dd>19920101</dd><dt><span>time_coverage_end :</span></dt><dd>19921231</dd><dt><span>time_coverage_duration :</span></dt><dd>P1Y</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1Y</dd><dt><span>geospatial_lat_min :</span></dt><dd>-90.0</dd><dt><span>geospatial_lat_max :</span></dt><dd>90.0</dd><dt><span>geospatial_lon_min :</span></dt><dd>-180</dd><dt><span>geospatial_lon_max :</span></dt><dd>180</dd><dt><span>spatial_resolution :</span></dt><dd>300m</dd><dt><span>geospatial_lat_units :</span></dt><dd>degrees_north</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>0.002778</dd><dt><span>geospatial_lon_units :</span></dt><dd>degrees_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.002778</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
</section>
<section id="inspect-and-view-data-for-the-defined-aoi-iberian-peninsula">
<span id="satellite-satellite-land-cover-trend-assessment-q02-code-section-2"></span><h3><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong><a class="headerlink" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula" title="Link to this heading">#</a></h3>
<section id="compute-urban-area-for-each-nuts-2-region">
<h4>Compute urban area for each NUTS 2 region<a class="headerlink" href="#compute-urban-area-for-each-nuts-2-region" title="Link to this heading">#</a></h4>
<p>To identify changes in LC patterns, in this user question, NUTS 2 will be used, providing the information regarding the main regions of the Iberian Peninsula.</p>
<p>The <a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts">NUTS</a> are a hierarchical system divided into 3 levels. NUTS 1 correspond to major socio-economic regions, NUTS 2 correspond to basic regions for the application of regional policies, and NUTS 3 correspond to small regions for specific diagnoses. Additionally a NUTS 0 level, usually co-incident with national boundaries is also available. The NUTS legislation is periodically amended; therefore multiple years are available for download.</p>
<p>The step below masks the Land Cover data according to the NUTS 2 boundaries and calculate the area of each pixel (weighted by the cosine of Latitude). For each NUTS 2, we proceed with the analysis and visual inspection of Land Cover areas per class and corresponding percentages during the elected period.</p>
</section>
<section id="mask-regions">
<h4>Mask regions<a class="headerlink" href="#mask-regions" title="Link to this heading">#</a></h4>
<p>First, we need to establish the geometry of the NUTS region (level 2) in order to make the corresponding statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure Dask</span>
<span class="n">dask</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;threads&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;array.slicing.split_large_chunks&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Define CRS and bounding box for Iberian Peninsula</span>
<span class="n">crs_wgs84</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="n">iberian_bbox</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>

<span class="c1"># Load and filter GeoDataFrame</span>
<span class="n">shapefile_url</span> <span class="o">=</span> <span class="s2">&quot;https://gisco-services.ec.europa.eu/distribution/v2/nuts/shp/NUTS_RG_20M_2021_4326.shp.zip&quot;</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shapefile_url</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;LEVL_CODE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;NUTS_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span> <span class="s2">&quot;PT&quot;</span><span class="p">))]</span>  <span class="c1"># Spain (ES) and Portugal (PT)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs_wgs84</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">iberian_bbox</span><span class="p">)]</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">is_empty</span><span class="p">]</span>

<span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid geometries found after filtering.&quot;</span><span class="p">)</span>

<span class="c1"># Ensure dataset CRS is set</span>
<span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ensure dataset coordinates overlap with the filtered regions</span>
<span class="n">filtered_lon_min</span><span class="p">,</span> <span class="n">filtered_lat_min</span><span class="p">,</span> <span class="n">filtered_lon_max</span><span class="p">,</span> <span class="n">filtered_lat_max</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
<span class="k">if</span> <span class="p">(</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">filtered_lon_max</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">filtered_lon_min</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">filtered_lat_max</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">filtered_lat_min</span>
<span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="s2">&quot;Dataset coordinates do not overlap with the filtered regions. Check dataset and region alignment.&quot;</span>
    <span class="p">)</span>

<span class="c1"># Subset dataset to valid ranges</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">filtered_lon_min</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">filtered_lon_max</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">filtered_lat_max</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">filtered_lat_min</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Check subsetted dataset dimensions</span>
<span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Subsetting resulted in an empty dataset. Check the bounds and ensure overlap.&quot;</span><span class="p">)</span>

<span class="c1"># Create the regionmask</span>
<span class="n">regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">)</span>

<span class="c1"># Create a 2D mask</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span>

<span class="n">ds</span><span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-cell-area">
<h4>Compute cell area<a class="headerlink" href="#compute-cell-area" title="Link to this heading">#</a></h4>
<p>Then, we can calculate the area of each pixel taking into consideration the curvature of the earth (i.e., weighted by the cosine of Latitude).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scaling factor for conversion (constant longitude resolution)</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">0.002778</span>  <span class="c1"># Degrees</span>
<span class="n">resolution_lon_km</span> <span class="o">=</span> <span class="n">scaling_factor</span> <span class="o">*</span> <span class="mf">111.195</span>  <span class="c1"># Longitude resolution in kilometers</span>

<span class="c1"># Use the latitude values directly from the dataset</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span>

<span class="c1"># Calculate the difference between consecutive latitude values</span>
<span class="n">lat_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lats</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>  <span class="c1"># Absolute differences</span>
<span class="n">lat_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lat_diff</span><span class="p">,</span> <span class="n">lat_diff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Assume the last cell has the same size as the one before</span>

<span class="c1"># Convert latitude differences to kilometers</span>
<span class="n">resolution_lat_km</span> <span class="o">=</span> <span class="n">lat_diff</span> <span class="o">*</span> <span class="mf">111.195</span>  <span class="c1"># Latitude-dependent resolution</span>

<span class="c1"># Compute the grid cell area for each latitude</span>
<span class="n">grid_cell_area</span> <span class="o">=</span> <span class="n">resolution_lon_km</span> <span class="o">*</span> <span class="n">resolution_lat_km</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span>

<span class="c1"># Assign attributes to the grid cell area</span>
<span class="n">grid_cell_area</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cell_area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid cell area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km²&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Add the grid cell area as a coordinate to the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">cell_area</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># Use `.data` to extract the array</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="select-urban-classes-and-prepare-dataset">
<h4>Select Urban Classes and Prepare Dataset<a class="headerlink" href="#select-urban-classes-and-prepare-dataset" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define urban classes</span>
<span class="n">urban_classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">190</span><span class="p">]</span>

<span class="c1"># Create a mask for urban areas</span>
<span class="n">urban_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lccs_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">urban_classes</span><span class="p">)</span>

<span class="c1"># Masked urban area using cell area</span>
<span class="n">ds_urban_area</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;cell_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">urban_mask</span><span class="p">)</span>

<span class="c1"># Stack latitude and longitude into a single dimension</span>
<span class="n">ds_urban_area</span> <span class="o">=</span> <span class="n">ds_urban_area</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stacked_lat_lon</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>

<span class="c1"># Create a stacked mask and align dimensions</span>
<span class="n">stacked_mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stacked_lat_lon</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
<span class="n">stacked_mask</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;stacked_mask&quot;</span>

<span class="c1"># Attach the stacked mask to the dataset</span>
<span class="n">ds_urban_area</span> <span class="o">=</span> <span class="n">ds_urban_area</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">stacked_mask</span><span class="o">=</span><span class="n">stacked_mask</span><span class="p">)</span>

<span class="c1"># Group by regions and compute urban area for each year</span>
<span class="n">urban_area_by_region</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ds_urban_area</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;stacked_mask&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;stacked_lat_lon&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-urban-area-per-region-and-year">
<h4>Compute urban area per region and year<a class="headerlink" href="#compute-urban-area-per-region-and-year" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">growth</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">reg</span><span class="p">,</span> <span class="n">reg_area</span> <span class="ow">in</span> <span class="n">urban_area_by_region</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;stacked_mask&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>  <span class="c1"># Skip NaN regions</span>
        <span class="k">continue</span>

    <span class="c1"># Ensure valid region indexing and naming</span>
    <span class="n">region_name</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">reg</span><span class="p">)]</span><span class="o">.</span><span class="n">name</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">ds_urban_area</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">reg_area</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten in case of higher-dimensional arrays</span>

    <span class="c1"># Save growth data by year</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">growth</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">values</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">growth</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Handle regions with no data</span>

    <span class="c1"># Add results to the list</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region_name</span><span class="p">,</span>
            <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
            <span class="s2">&quot;Urban_Area&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="p">})</span>

<span class="c1"># Convert results to a DataFrame</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Add geometry to results_df</span>
<span class="k">if</span> <span class="s1">&#39;NUTS_NAME&#39;</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;NUTS_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: NUTS_NAME column not found in gdf.&quot;</span><span class="p">)</span>

<span class="c1"># Ensure results_df is a GeoDataFrame</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]),</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="map-urban-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">
<h4>Map urban percentage coverage over-time by NUTS regions in the AoI<a class="headerlink" href="#map-urban-percentage-coverage-over-time-by-nuts-regions-in-the-aoi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reproject the GeoDataFrame to a projected CRS (EPSG:3035 is a good choice for Europe)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:3035&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the total area of each region (in square kilometres)</span>
<span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region_Total_Area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>  <span class="c1"># Convert from m² to km²</span>

<span class="c1"># Ensure &#39;Year&#39; is converted to string if needed</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1">#Calculate Urban Percentage</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Area&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Region_Total_Area&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Pivot the data to have years as columns</span>
<span class="n">Urban_pivot</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Urban_Percentage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Extract years for plotting</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">Urban_pivot</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>

<span class="c1"># Normalize color scale across all maps based on percentage coverage</span>
<span class="n">norm_percentage</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Percentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Plot settings</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot each year in a separate subplot</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">results_df_year</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">results_df_year</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Urban_Percentage&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_percentage</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Urban Coverage (%) in </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Hide unused subplots</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">),</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Step 8: Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Allocate space for the color bar</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Create a new axes for color bar</span>

<span class="c1"># Create a single ScalarMappable object for the common colorbar</span>
<span class="n">sm_common</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Oranges&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_percentage</span><span class="p">)</span>
<span class="n">sm_common</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Dummy array for the scalar mappable</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm_common</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Urban Coverage (%)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b14dfa072a0f339e9778af8ed941064f75738f044172bf91c15eb736a5913d14.png" src="../../_images/b14dfa072a0f339e9778af8ed941064f75738f044172bf91c15eb736a5913d14.png" />
</div>
</div>
</section>
<section id="map-urban-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">
<h4>Map urban percentage coverage change over-time by NUTS regions in the AoI<a class="headerlink" href="#map-urban-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the year-over-year percentage differences for each region</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Percentage_Diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)[</span><span class="s1">&#39;Urban_Percentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="c1"># Automatically exclude the first year</span>
<span class="n">first_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>  <span class="c1"># Ensure the first year is an integer</span>
<span class="n">filtered_years</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>  <span class="c1"># Ensure years are integers</span>
<span class="n">filtered_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">filtered_years</span> <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">first_year</span><span class="p">]</span>  <span class="c1"># Exclude the first year</span>

<span class="c1"># Normalize color scale around zero (e.g., -6 to +6 with 0 as neutral)</span>
<span class="n">norm_diff</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Percentage_Diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Urban_Percentage_Diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Plot settings</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Improved color scale: Diverging with neutral at zero</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;Oranges&quot;</span>

<span class="c1"># Plot each year in a separate subplot</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">results_df_year</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">previous_year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Ensure year is treated as an integer</span>
    <span class="n">results_df_year</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Urban_Percentage_Diff&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_diff</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Change in Urban Coverage: </span><span class="si">{</span><span class="n">previous_year</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Hide unused subplots</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">),</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Allocate space for the color bar</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Create a new axes for the color bar</span>

<span class="c1"># Create a single ScalarMappable object for the common colorbar</span>
<span class="n">sm_common</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_diff</span><span class="p">)</span>
<span class="n">sm_common</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Dummy array for the scalar mappable</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm_common</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Urban Coverage Diff (%)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/09e1718a6358889b901201f608af191d385d6da1a26754e3a187ee1b70d98205.png" src="../../_images/09e1718a6358889b901201f608af191d385d6da1a26754e3a187ee1b70d98205.png" />
</div>
</div>
</section>
<section id="map-analysis">
<h4>Map Analysis<a class="headerlink" href="#map-analysis" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Over the 28-year period, all regions maintain a consistent pattern of growth.</p></li>
<li><p>Regions such as Comunidad Madrid and Área Metropolitana de Lisboa consistently exhibit the highest levels of urban percentage coverage.</p></li>
<li><p>No negative fluctuations were observed</p></li>
<li><p>The biggest changes are observed between 2016-2017.</p></li>
</ul>
</section>
<section id="potential-drivers-and-methodological-considerations-in-urbanisation-trends-in-the-iberian-peninsula-19922022">
<h4><strong>Potential Drivers and Methodological Considerations in Urbanisation Trends in the Iberian Peninsula (1992–2022)</strong><a class="headerlink" href="#potential-drivers-and-methodological-considerations-in-urbanisation-trends-in-the-iberian-peninsula-19922022" title="Link to this heading">#</a></h4>
<p>Urbanisation in the Iberian Peninsula over the last three decades has been influenced by a combination of <strong>economic shifts</strong>, <strong>demographic changes</strong>, and <strong>policy decisions</strong>. Before analysing trends, it is essential to account for abrupt shifts that may distort trend estimates. These shifts, often referred to as breakpoints, can result from:</p>
<p><strong>Economic Drivers</strong></p>
<ul class="simple">
<li><p>Economic Growth and Real Estate Booms:  The rapid expansion of urban areas in <strong>Madrid, Barcelona, and Lisbon</strong> was driven by economic growth and increased investment in housing and infrastructure, particularly during the <strong>1996–2007 real estate boom</strong> <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2018.05.023">(González &amp; Leal, 2018)</a>. The expansion of suburban areas led to the rise of peri-urban developments in regions like <strong>Valencia and Porto</strong> <a class="reference external" href="https://doi.org/10.1016/j.cities.2017.04.002">(Silva et al., 2017)</a>.</p></li>
<li><p>Economic Crisis (2008–2013): The 2008 financial crisis led to a slowdown in urban expansion, particularly in southern Spain, where unfinished developments and ghost towns became a common sight <a class="reference external" href="https://doi.org/10.1016/j.habitatint.2015.01.010">(Martínez &amp; García, 2015)</a>. However, in some areas, reduced construction pressure allowed for the recovery of natural land cover <a class="reference external" href="https://api.semanticscholar.org/CorpusID:238829360">(Palmero-Iniesta et al., 2021)</a>.</p></li>
</ul>
<p><strong>Demographic and Social Changes</strong></p>
<ul class="simple">
<li><p>Rural Depopulation:  Migration from rural areas to urban centers, particularly among younger populations, has led to declining populations in <strong>Extremadura, Castilla y León, and Alentejo</strong>, accelerating the abandonment of agricultural lands and increasing the expansion of urban areas <a class="reference external" href="https://doi.org/10.1016/j.geoforum.2019.06.015">(Sánchez et al., 2019)</a>.</p></li>
<li><p>Tourism and Second-Home Development:  The rise of tourism-driven urbanisation has significantly reshaped coastal regions like <strong>the Costa del Sol, Algarve, and the Balearic Islands</strong>, where seasonal housing developments have expanded rapidly <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2014.02.009">(Rullan, 2014)</a>.</p></li>
<li><p>Aging Population:  Aging populations in rural regions have led to increased urban migration, further depopulating countryside areas and concentrating populations in cities like <strong>Seville, Valencia, and Bilbao</strong> <a class="reference external" href="https://doi.org/10.1016/j.jrurstud.2016.03.008">(Gutiérrez et al., 2016)</a>.</p></li>
</ul>
<p><strong>Infrastructure and Policy Influences</strong></p>
<ul class="simple">
<li><p>EU-Funded Infrastructure Projects:  Investments in transport networks, such as the expansion of <strong>high-speed rail (AVE) in Spain and Alfa Pendular in Portugal</strong>, have facilitated suburbanisation and commuting from secondary urban centers <a class="reference external" href="https://doi.org/10.1016/j.jtrangeo.2017.02.005">(López et al., 2017)</a>.</p></li>
<li><p>Urban Planning Policies:  The implementation of urban growth controls and greenbelt policies in cities like <strong>Barcelona and Porto</strong> has influenced spatial expansion patterns, sometimes leading to increased land prices and informal settlements <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2019.04.012">(Silva &amp; Fernandes, 2019)</a>.</p></li>
<li><p>Smart Cities and Sustainability Initiatives: Recent efforts to create more sustainable urban environments, such as Madrid’s <strong>Madrid Central low-emission zone</strong>, have shaped urbanisation patterns, promoting compact city models <a class="reference external" href="https://doi.org/10.1016/j.cities.2021.103120">(Delgado &amp; Romero, 2021)</a>.</p></li>
</ul>
<p><strong>Methodology</strong></p>
<ul class="simple">
<li><p>Certain shifts in urban land cover may be related to data collection and processing rather than actual urban expansion. For instance, transitions between different satellite sensors—<strong>Landsat (1992–2013), Sentinel-2 (2015–2022), and urban-focused AI models (post-2020)</strong>—can introduce artificial breaks in the time series <a class="reference external" href="https://doi.org/10.1109/JURSE.2019.8808967">(Chelali et al., 2019)</a>.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Global SR Composite Time Series</p></th>
<th class="head"><p>Reference Period</p></th>
<th class="head"><p>Satellite Data Source</p></th>
<th class="head"><p>Technical Specifications</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AVHRR global SR composite time series</p></td>
<td><p>1992-1999</p></td>
<td><p>AVHRR-2 on NOAA-11 and NOAA-14</p></td>
<td><p>1 km spatial resolution, 5 spectral bands in visible and infrared, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>SPOT-VGT global SR composites</p></td>
<td><p>1999-2013</p></td>
<td><p>SPOT 4, 5 Vegetation sensor</p></td>
<td><p>1 km spatial resolution, 4 spectral bands in visible, near-infrared (NIR), and shortwave infrared (SWIR), Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>MERIS global SR composite time series</p></td>
<td><p>2003-2012</p></td>
<td><p>Envisat MERIS FR &amp; RR</p></td>
<td><p>300 m or 1,000 m resolution full swath, 15 spectral bands in visible and NIR, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>PROBA-V global SR composite time series</p></td>
<td><p>2013-2019</p></td>
<td><p>PROBA-V</p></td>
<td><p>300 m spatial resolution, 4 spectral bands in visible, near-infrared, and SWIR, Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel-3 OLCI global SR composite time series</p></td>
<td><p>2020</p></td>
<td><p>S3 OLCI</p></td>
<td><p>300 m resolution full swath, 15 spectral bands in visible and NIR, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel-3 global SR composite time series</p></td>
<td><p>2021-2022</p></td>
<td><p>S3 OLCI &amp; S3 SLSTR</p></td>
<td><p>300 m resolution full swath, 21 spectral bands in visible, NIR, and SWIR, Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>Advanced Synthetic Aperture Radar - Wide Swath Mode (ASAR WSM) time series</p></td>
<td><p>2005-2012</p></td>
<td><p>Envisat ASAR WSM</p></td>
<td><p>150 m spatial resolution, Microwave band, Global coverage</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="breakpoint-detection">
<span id="satellite-satellite-land-cover-trend-assessment-q02-code-section-3"></span><h3><strong>3. Breakpoint Detection</strong><a class="headerlink" href="#breakpoint-detection" title="Link to this heading">#</a></h3>
<p>A good first step in assessing potential  impacts on land cover (LC) trends is to apply simple exploratory methods, such as analysing the rate of change (time series derivative). This will help identify sudden shifts in the data.</p>
<p>However, while these approaches highlight points of interest, they do not confirm whether the observed changes are truly structural. Percentage differences can be sensitive to random fluctuations, and derivative-based analyses may exaggerate year-to-year variations that do not necessarily indicate a breakpoint. To formally assess structural changes we apply a statistical breakpoint detection method.</p>
<p><strong>Rate of Change Calculation</strong></p>
<ul class="simple">
<li><p>The <strong>first derivative</strong> of the urban area time series is computed to identify <strong>years with significant year-to-year changes</strong>.</p></li>
<li><p>This highlights <strong>periods where the rate of change deviates substantially</strong> from surrounding years, signaling potential anomalies.</p></li>
</ul>
<p><strong>Statistical Thresholding of Derivative Spikes</strong></p>
<ul class="simple">
<li><p>A threshold is <strong>calculated dynamically</strong> as the <strong>mean absolute derivative plus 1.5 times the standard deviation (1.5σ)</strong>.</p></li>
<li><p>Years where the <strong>absolute rate of change</strong> exceeds this threshold are <strong>flagged as potential breakpoint candidates</strong>.</p></li>
<li><p>This <strong>reduces false positives</strong> by filtering out <strong>minor fluctuations</strong> and focusing on <strong>significant deviations</strong>.</p></li>
</ul>
<p><strong>Breakpoint Detection Using PELT Algorithm</strong></p>
<ul class="simple">
<li><p>The <strong>Pruned Exact Linear Time (PELT)</strong> algorithm is applied to <strong>detect structural changes</strong> in the urban area dataset.</p></li>
<li><p>The algorithm is run using the <strong>L2 cost function</strong> (<code class="docutils literal notranslate"><span class="pre">model=&quot;l2&quot;</span></code>) to minimize segmentation errors.</p></li>
<li><p>The <strong>penalty parameter (<code class="docutils literal notranslate"><span class="pre">pen</span></code>) is dynamically set</strong> as <code class="docutils literal notranslate"><span class="pre">np.std(Urban_area)</span> <span class="pre">*</span> <span class="pre">2.5</span></code> to balance <strong>false positives and meaningful breakpoints</strong>.</p></li>
<li><p>A <strong>minimum segment length (<code class="docutils literal notranslate"><span class="pre">min_size=2</span></code>)</strong> is used to prevent excessive segmentation.</p></li>
</ul>
<p><strong>Filtering Breakpoints Based on Derivative Spikes</strong></p>
<ul class="simple">
<li><p><strong>Only breakpoints that align closely (within ±2 years) with derivative spikes are retained.</strong></p></li>
<li><p>This <strong>ensures detected breakpoints correspond to actual shifts</strong> rather than <strong>random segmentation artifacts</strong>.</p></li>
<li><p>The breakpoints are then <strong>stored for further regional clustering analysis</strong>.</p></li>
</ul>
<p><strong>Application of Savitzky-Golay Filtering for Smoothing</strong></p>
<ul class="simple">
<li><p>To <strong>better visualize trends</strong>, the first derivative is <strong>smoothed</strong> using a <strong>Savitzky-Golay filter</strong> with <code class="docutils literal notranslate"><span class="pre">window_length=5</span></code> and <code class="docutils literal notranslate"><span class="pre">polyorder=2</span></code>.</p></li>
<li><p>This helps <strong>reduce noise while preserving significant trend changes</strong>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># **Store breakpoints across all regions for clustering analysis**</span>
<span class="n">breakpoint_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">breakpoint_storage</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to store breakpoints</span>

<span class="c1"># **Unique regions from dataset**</span>
<span class="n">unique_regions</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">n_regions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_regions</span><span class="p">)</span>

<span class="c1"># **Determine global y-axis limits for Urban Area**</span>
<span class="n">global_y_min</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">global_y_max</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># **Determine global y-axis limits for Rate of Change**</span>
<span class="n">global_derivative_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<span class="n">global_derivative_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>

<span class="c1"># **First Pass: Calculate global min/max for first derivative**</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">unique_regions</span><span class="p">:</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Urban_area</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Ensure there are at least two years for differentiation</span>
        <span class="n">delta_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="n">delta_Urban_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Urban_area</span><span class="p">)</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">delta_Urban_area</span> <span class="o">/</span> <span class="n">delta_years</span>  

        <span class="n">global_derivative_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">global_derivative_min</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span>
        <span class="n">global_derivative_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">global_derivative_max</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span>

<span class="c1"># **Dynamically set up subplot grid**</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Fixed columns for better visualization</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_regions</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>  <span class="c1"># Dynamically determine rows</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten to access easily</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_regions</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Urban_area</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># **Calculate the first derivative (rate of change)**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">delta_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="n">delta_Urban_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Urban_area</span><span class="p">)</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">delta_Urban_area</span> <span class="o">/</span> <span class="n">delta_years</span>  
        <span class="n">derivative_years</span> <span class="o">=</span> <span class="p">(</span><span class="n">years</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">years</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">derivative_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="c1"># **Detect potential anomaly years from derivative spikes (Threshold: 1.5σ)**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">derivative_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span>
        <span class="n">spike_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">derivative_threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">spike_years</span> <span class="o">=</span> <span class="n">years</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="n">spike_years</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># **Apply PELT for breakpoint detection**</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="n">rpt</span><span class="o">.</span><span class="n">Pelt</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Urban_area</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">pen_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Urban_area</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.5</span>
    <span class="n">detected_breakpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">pen_value</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>  

    <span class="c1"># **Filter breakpoints to keep only those close to derivative spikes**</span>
    <span class="n">confirmed_breakpoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">detected_breakpoints</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">bp</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spike_indices</span><span class="p">):</span>
            <span class="n">confirmed_breakpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span>
            <span class="n">breakpoint_counts</span><span class="p">[</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>  
            <span class="n">breakpoint_storage</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">])})</span>

    <span class="c1"># **Apply Savitzky-Golay filter for smoothing**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>  
        <span class="n">first_derivative_smoothed</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_derivative_smoothed</span> <span class="o">=</span> <span class="n">first_derivative</span>  

    <span class="c1"># **Plot Urban area in grey**</span>
    <span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">Urban_area</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Urban Area&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Urban Area (km²)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">global_y_min</span><span class="p">,</span> <span class="n">global_y_max</span><span class="p">)</span>

    <span class="c1"># **Overlay Detected Breakpoints in Red**</span>
    <span class="n">lines_bp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">confirmed_breakpoints</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confirmed Breakpoint&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">lines_bp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># **Mark Derivative-Based Potential Change Years in Yellow**</span>
    <span class="n">lines_spike</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spike_years</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">dy</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Derivative Spike&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">lines_spike</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># **Create a secondary y-axis for the first derivative**</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">line2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivative_years</span><span class="p">,</span> <span class="n">first_derivative_smoothed</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rate of Change&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Rate of Change (Δ Urban Area / Δ Year)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">global_derivative_min</span><span class="p">,</span> <span class="n">global_derivative_max</span><span class="p">)</span>

    <span class="c1"># **Customize subplot**</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">years</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> (Ruptures-Based Breakpoints)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="c1"># **Combine legend entries from both y-axes**</span>
    <span class="n">handles1</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">handles2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles1</span> <span class="o">+</span> <span class="n">handles2</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># **Analyze Breakpoint Clusters Across Regions**</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">### Breakpoint Clusters Across Regions ###&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">breakpoint_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Year </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> regions detected a breakpoint&quot;</span><span class="p">)</span>

<span class="c1"># **Hide any unused subplot axes**</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_regions</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

<span class="c1"># **Adjust layout and display**</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>### Breakpoint Clusters Across Regions ###
Year 2001.0: 6 regions detected a breakpoint
Year 2006.0: 4 regions detected a breakpoint
Year 2011.0: 9 regions detected a breakpoint
Year 2016.0: 12 regions detected a breakpoint
</pre></div>
</div>
<img alt="../../_images/044162da0b833f6c0ca033aa38ffe316c9ad8e983a9d7ae0e7ecc56532a9ac34.png" src="../../_images/044162da0b833f6c0ca033aa38ffe316c9ad8e983a9d7ae0e7ecc56532a9ac34.png" />
</div>
</div>
<section id="breakpoint-analysis">
<h4>Breakpoint Analysis<a class="headerlink" href="#breakpoint-analysis" title="Link to this heading">#</a></h4>
<p><strong>🛑 Breakpoint [2001]</strong></p>
<ul class="simple">
<li><p>The 2001 breakpoint coincides with the operational transition from AVHRR to SPOT-VGT (1999–2000), which introduced improved spectral bands and more refined vegetation monitoring capabilities. These sensor upgrades likely affected the classification of urban land cover, particularly in mixed-use or peri-urban environments where classification boundaries were less distinct under AVHRR.</p></li>
<li><p>Breakpoints were identified in multiple regions, including Madrid, Lisbon, Valencia, and Porto—areas undergoing real urban growth in the late 1990s and early 2000s. However, the widespread nature of the shift, combined with a relatively short lag from the sensor transition, suggests a methodological contribution.</p></li>
<li><p>Infrastructure expansion linked to EXPO 98 in Lisbon and the pre-Olympic urban works in Spain (especially Barcelona) may have also accelerated real urban change. This context complicates attribution but does not fully explain the magnitude or synchronicity of breakpoints across the Iberian Peninsula.</p></li>
</ul>
<p><em>Interpretation</em></p>
<ul class="simple">
<li><p><strong>Partially methodological</strong> → Classification refinements under SPOT-VGT likely introduced artificial shifts in detected urban areas.</p></li>
<li><p><strong>Partially real</strong> → Real urban expansion due to infrastructure development and the early stages of the housing boom may have contributed to localised increases.</p></li>
</ul>
<hr class="docutils" />
<p><strong>🛑 Breakpoint [2006]</strong></p>
<ul class="simple">
<li><p>The year 2006 aligns with the peak of Spain’s housing boom (1996–2007), which drove extensive urban expansion across major cities such as Madrid, Barcelona, and Málaga. In Portugal, peripheral areas around Lisbon (e.g., Sintra, Cascais) also saw rapid residential development.</p></li>
<li><p>Several NUTS 2 regions showed notable increases in urban coverage, consistent with this real-estate-driven growth. Concurrently, EU-funded infrastructure (e.g., AVE rail in Spain, Alfa Pendular in Portugal) promoted urban sprawl and intensified land-use change.</p></li>
<li><p>While no major satellite sensor change occurred in 2006, minor classification adjustments within the dataset processing chain cannot be ruled out. Nevertheless, the urbanisation signal is consistent with known socioeconomic trends, reinforcing a primarily real interpretation.</p></li>
</ul>
<p><em>Interpretation</em></p>
<ul class="simple">
<li><p><strong>Mostly real</strong> → The breakpoint reflects rapid real-world urban growth at the peak of the housing boom.</p></li>
<li><p><strong>Possible minor methodological influence</strong> → Classification refinements may have modestly contributed to area shifts.</p></li>
</ul>
<hr class="docutils" />
<p><strong>🛑 Breakpoint [2011]</strong></p>
<ul class="simple">
<li><p>The 2011 breakpoint follows the aftermath of the 2008 financial crisis, which caused a sharp decline in construction activity across the Iberian Peninsula. In Spain, many urban development projects were halted or abandoned, particularly in southern and coastal regions (e.g., Andalusia, Murcia, Alicante). Portugal also experienced a contraction in housing and infrastructure investments.</p></li>
<li><p>Land cover reclassification of incomplete or abandoned developments may have led to decreases in detected urban areas. These effects were likely compounded by the transition from MERIS to PROBA-V (2010–2011), which improved spatial resolution (300 m) and introduced changes in classification sensitivity.</p></li>
<li><p>The combined economic and methodological shifts increase the likelihood of structural artifacts in the dataset around this period.</p></li>
</ul>
<p><em>Interpretation</em></p>
<ul class="simple">
<li><p><strong>Partially methodological</strong> → The MERIS to PROBA-V transition likely introduced reclassification effects.</p></li>
<li><p><strong>Partially real</strong> → Reduced construction and land-use abandonment post-crisis support a real contraction in urban growth in some regions.</p></li>
</ul>
<hr class="docutils" />
<p><strong>🛑 Breakpoint [2016]</strong></p>
<ul class="simple">
<li><p>The 2016 breakpoint coincides with the implementation of Sentinel-3 OLCI and the adoption of AI-based land cover classification algorithms. These advances substantially enhanced the resolution and accuracy of urban detection, leading to systematic shifts in urban classification.</p></li>
<li><p>The spatial pattern of breakpoint detection is consistent with methodological changes rather than specific policy events. While real urban expansion resumed in certain regions post-crisis—especially in tourism-intensive areas like the Algarve, Balearic Islands, and Costa del Sol—the magnitude and synchronicity of breakpoints suggest data processing refinements as the primary driver.</p></li>
<li><p>Additionally, new sustainability policies in cities like Madrid (e.g., Madrid Central) may have introduced local changes in land use but are unlikely to explain broad, regional trends.</p></li>
</ul>
<p><em>Interpretation</em></p>
<ul class="simple">
<li><p><strong>Mostly methodological</strong> → The introduction of Sentinel-3 and AI-based classification is the dominant explanation for this breakpoint.</p></li>
<li><p><strong>Partially real</strong> → Localised urban expansion in touristic or recovering regions may have contributed to the observed shifts.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="summary-table">
<h4>📊 <strong>Summary Table</strong><a class="headerlink" href="#summary-table" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Breakpoint Year</strong></p></th>
<th class="head"><p><strong>Main Cause</strong></p></th>
<th class="head"><p><strong>Possible reason</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>2001</strong></p></td>
<td><p>SPOT-VGT transition, pre-Olympic urban works, EXPO 98</p></td>
<td><p><strong>Partially methodological, partially real</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>2006</strong></p></td>
<td><p>Housing boom peak, peri-urban expansion, rail infrastructure</p></td>
<td><p><strong>Mostly real</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>2011</strong></p></td>
<td><p>Post-crisis urban slowdown, MERIS to PROBA-V transition</p></td>
<td><p><strong>Partially real, partially methodological</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>2016</strong></p></td>
<td><p>Sentinel-3 &amp; AI classification updates, post-crisis urban rebound</p></td>
<td><p><strong>Mostly methodological, some real effects</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="trend-assessment">
<span id="satellite-satellite-land-cover-trend-assessment-q02-code-section-4"></span><h3><strong>4.Trend Assessment</strong><a class="headerlink" href="#trend-assessment" title="Link to this heading">#</a></h3>
<p>The next and final step is to determine whether the trend should be computed for the entire period (total trend) or divided into segments based on detected breakpoints.</p>
<p>The decision between using the total trend or segmented trends is based on Sen’s Slope (Trend Magnitude) and Mann-Kendall p-values (Trend Significance). Sen’s Slope is a non-parametric estimator that calculates the median rate of change over time, making it robust to outliers and suitable for detecting monotonic trends. First, Sen’s Slope is computed for the total trend, capturing the overall rate of urban change. Then, Sen’s Slope is calculated for each segmented trend to assess whether breakpoints introduce significant shifts in trend magnitude. The Mann-Kendall test is a non-parametric statistical test used to assess the presence of a monotonic upward or downward trend in a time series without requiring the data to follow any particular distribution. In parallel, the Mann-Kendall p-value is evaluated for both the total and segmented trends to measure trend significance—lower p-values indicate stronger evidence of a significant trend.</p>
<p>The final decision is based on the following approach:</p>
<ul class="simple">
<li><p>If segmented trends show substantially different Sen’s Slopes compared to the total trend and exhibit stronger statistical significance (lower p-values), segmentation is preferred.</p></li>
<li><p>If segmented trends closely resemble the total trend or do not provide a clear statistical advantage, the total trend is used to maintain a simpler and more robust interpretation.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define breakpoints_df to store breakpoints across all regions</span>
<span class="n">breakpoints_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">breakpoint_storage</span><span class="p">)</span>

<span class="c1"># Ensure &quot;Year&quot; columns are numeric</span>
<span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add Sen&#39;s slope, rate of change, and significance to trends storage</span>
<span class="n">trends</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate through each region</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>

    <span class="n">X_total</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_total</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y_total</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">continue</span>  

    <span class="c1"># Compute Sen’s Slope for Total Series</span>
    <span class="n">total_sen_slope</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">total_p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">theilslopes</span><span class="p">(</span><span class="n">y_total</span><span class="p">,</span> <span class="n">X_total</span><span class="p">)</span>
    
    <span class="c1"># Compute Rate of Change (Total)</span>
    <span class="n">mean_Urban_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_total</span><span class="p">)</span>
    <span class="n">total_rate_of_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_sen_slope</span> <span class="o">/</span> <span class="n">mean_Urban_area</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">mean_Urban_area</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Store total trend</span>
    <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;Start_Year&quot;</span><span class="p">:</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="s2">&quot;End_Year&quot;</span><span class="p">:</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="s2">&quot;Sen_Slope&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_sen_slope</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_rate_of_change</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Total&quot;</span><span class="p">,</span>
        <span class="s2">&quot;P_Value&quot;</span><span class="p">:</span> <span class="n">total_p_value</span><span class="p">,</span>
        <span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">:</span> <span class="n">total_p_value</span>  <span class="c1"># Assuming no correction here, but could be added if needed</span>
    <span class="p">})</span>

    <span class="c1"># Extract breakpoints for segmented trends</span>
    <span class="n">region_breakpoints</span> <span class="o">=</span> <span class="n">breakpoints_df</span><span class="p">[</span><span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">][</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">all_breakpoints</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">region_breakpoints</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]))</span>

    <span class="c1"># Calculate Sen&#39;s Slope for each segment</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_breakpoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="o">=</span> <span class="n">all_breakpoints</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">all_breakpoints</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">segment_data</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_year</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_year</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">X_segment</span> <span class="o">=</span> <span class="n">segment_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y_segment</span> <span class="o">=</span> <span class="n">segment_data</span><span class="p">[</span><span class="s2">&quot;Urban_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Compute Sen’s Slope for Segmented Series</span>
        <span class="n">segment_sen_slope</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">segment_p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">theilslopes</span><span class="p">(</span><span class="n">y_segment</span><span class="p">,</span> <span class="n">X_segment</span><span class="p">)</span>
        
        <span class="c1"># Compute Rate of Change (Segment)</span>
        <span class="n">mean_segment_Urban_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_segment</span><span class="p">)</span>
        <span class="n">segment_rate_of_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">segment_sen_slope</span> <span class="o">/</span> <span class="n">mean_segment_Urban_area</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">mean_segment_Urban_area</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># Store segmented trend</span>
        <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="s2">&quot;Start_Year&quot;</span><span class="p">:</span> <span class="n">start_year</span><span class="p">,</span>
            <span class="s2">&quot;End_Year&quot;</span><span class="p">:</span> <span class="n">end_year</span><span class="p">,</span>
            <span class="s2">&quot;Sen_Slope&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">segment_sen_slope</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">segment_rate_of_change</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Segmented&quot;</span><span class="p">,</span>
            <span class="s2">&quot;P_Value&quot;</span><span class="p">:</span> <span class="n">segment_p_value</span><span class="p">,</span>
            <span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">:</span> <span class="n">segment_p_value</span>  <span class="c1"># Assuming no correction here, but could be added if needed</span>
        <span class="p">})</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">trends_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trends</span><span class="p">)</span>

<span class="c1"># Function to decide which trend to recommend (based on slope and rate of change)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">recommend_trend</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">total_row</span><span class="p">):</span>
    <span class="c1"># If the segmented trend is not significant, prefer the total trend</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Total&quot;</span>
    
    <span class="c1"># If both are significant, compare the rate of change</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_row</span><span class="p">[</span><span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s2">&quot;Segmented&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Total&quot;</span>

<span class="c1"># Creating the new column &#39;Recommended_Trend&#39;</span>
<span class="n">recommended_trends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">trends_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span>
    
    <span class="c1"># Find the corresponding total trend row for comparison</span>
    <span class="n">total_row</span> <span class="o">=</span> <span class="n">trends_df</span><span class="p">[(</span><span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Total&quot;</span><span class="p">)]</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">total_row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">total_row</span> <span class="o">=</span> <span class="n">total_row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Since there should be one Total row per region</span>
        
        <span class="c1"># Apply recommendation logic</span>
        <span class="n">recommended_trend</span> <span class="o">=</span> <span class="n">recommend_trend</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">total_row</span><span class="p">)</span>
        <span class="n">recommended_trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recommended_trend</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">recommended_trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Add the &#39;Recommended_Trend&#39; to the DataFrame</span>
<span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Recommended_Trend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">recommended_trends</span>

<span class="c1"># Display the final DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Show all rows</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Show all columns</span>

<span class="n">display</span><span class="p">(</span><span class="n">trends_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Start_Year</th>
      <th>End_Year</th>
      <th>Sen_Slope</th>
      <th>Rate_of_Change (%)</th>
      <th>Type</th>
      <th>P_Value</th>
      <th>Corrected_P_Value</th>
      <th>Recommended_Trend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cataluña</td>
      <td>1992</td>
      <td>2022</td>
      <td>29.978</td>
      <td>3.244</td>
      <td>Total</td>
      <td>25.816569</td>
      <td>25.816569</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cataluña</td>
      <td>1992</td>
      <td>2001</td>
      <td>19.808</td>
      <td>3.516</td>
      <td>Segmented</td>
      <td>18.075780</td>
      <td>18.075780</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cataluña</td>
      <td>2001</td>
      <td>2022</td>
      <td>23.508</td>
      <td>2.181</td>
      <td>Segmented</td>
      <td>22.618817</td>
      <td>22.618817</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Comunitat Valenciana</td>
      <td>1992</td>
      <td>2022</td>
      <td>29.382</td>
      <td>4.406</td>
      <td>Total</td>
      <td>27.571900</td>
      <td>27.571900</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Comunitat Valenciana</td>
      <td>1992</td>
      <td>2016</td>
      <td>27.894</td>
      <td>4.868</td>
      <td>Segmented</td>
      <td>25.882260</td>
      <td>25.882260</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Comunitat Valenciana</td>
      <td>2016</td>
      <td>2022</td>
      <td>13.182</td>
      <td>1.274</td>
      <td>Segmented</td>
      <td>3.792648</td>
      <td>3.792648</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Galicia</td>
      <td>1992</td>
      <td>2022</td>
      <td>10.474</td>
      <td>3.084</td>
      <td>Total</td>
      <td>9.430378</td>
      <td>9.430378</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Galicia</td>
      <td>1992</td>
      <td>2011</td>
      <td>7.978</td>
      <td>2.894</td>
      <td>Segmented</td>
      <td>6.751959</td>
      <td>6.751959</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Galicia</td>
      <td>2011</td>
      <td>2016</td>
      <td>18.701</td>
      <td>4.399</td>
      <td>Segmented</td>
      <td>12.269491</td>
      <td>12.269491</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Galicia</td>
      <td>2016</td>
      <td>2022</td>
      <td>2.102</td>
      <td>0.445</td>
      <td>Segmented</td>
      <td>1.331900</td>
      <td>1.331900</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Principado de Asturias</td>
      <td>1992</td>
      <td>2022</td>
      <td>3.135</td>
      <td>2.348</td>
      <td>Total</td>
      <td>2.992976</td>
      <td>2.992976</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Principado de Asturias</td>
      <td>1992</td>
      <td>2011</td>
      <td>3.186</td>
      <td>2.712</td>
      <td>Segmented</td>
      <td>3.130418</td>
      <td>3.130418</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Principado de Asturias</td>
      <td>2011</td>
      <td>2022</td>
      <td>1.258</td>
      <td>0.779</td>
      <td>Segmented</td>
      <td>0.289213</td>
      <td>0.289213</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Cantabria</td>
      <td>1992</td>
      <td>2022</td>
      <td>2.523</td>
      <td>3.111</td>
      <td>Total</td>
      <td>2.303179</td>
      <td>2.303179</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Cantabria</td>
      <td>1992</td>
      <td>2016</td>
      <td>2.789</td>
      <td>3.761</td>
      <td>Segmented</td>
      <td>2.475802</td>
      <td>2.475802</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Cantabria</td>
      <td>2016</td>
      <td>2022</td>
      <td>0.162</td>
      <td>0.147</td>
      <td>Segmented</td>
      <td>0.069371</td>
      <td>0.069371</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>16</th>
      <td>País Vasco</td>
      <td>1992</td>
      <td>2022</td>
      <td>4.755</td>
      <td>2.161</td>
      <td>Total</td>
      <td>4.356248</td>
      <td>4.356248</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>17</th>
      <td>País Vasco</td>
      <td>1992</td>
      <td>2006</td>
      <td>5.239</td>
      <td>2.910</td>
      <td>Segmented</td>
      <td>4.661537</td>
      <td>4.661537</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>18</th>
      <td>País Vasco</td>
      <td>2006</td>
      <td>2022</td>
      <td>2.957</td>
      <td>1.157</td>
      <td>Segmented</td>
      <td>2.146939</td>
      <td>2.146939</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Comunidad Foral de Navarra</td>
      <td>1992</td>
      <td>2022</td>
      <td>3.418</td>
      <td>4.795</td>
      <td>Total</td>
      <td>3.230488</td>
      <td>3.230488</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Comunidad Foral de Navarra</td>
      <td>1992</td>
      <td>2006</td>
      <td>2.393</td>
      <td>5.625</td>
      <td>Segmented</td>
      <td>2.201681</td>
      <td>2.201681</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Comunidad Foral de Navarra</td>
      <td>2006</td>
      <td>2016</td>
      <td>3.638</td>
      <td>4.196</td>
      <td>Segmented</td>
      <td>3.231207</td>
      <td>3.231207</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Comunidad Foral de Navarra</td>
      <td>2016</td>
      <td>2022</td>
      <td>1.395</td>
      <td>1.243</td>
      <td>Segmented</td>
      <td>0.421822</td>
      <td>0.421822</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>23</th>
      <td>La Rioja</td>
      <td>1992</td>
      <td>2022</td>
      <td>1.374</td>
      <td>4.352</td>
      <td>Total</td>
      <td>1.285802</td>
      <td>1.285802</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>24</th>
      <td>La Rioja</td>
      <td>1992</td>
      <td>2016</td>
      <td>1.260</td>
      <td>4.706</td>
      <td>Segmented</td>
      <td>1.150617</td>
      <td>1.150617</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>25</th>
      <td>La Rioja</td>
      <td>2016</td>
      <td>2022</td>
      <td>1.129</td>
      <td>2.246</td>
      <td>Segmented</td>
      <td>0.140980</td>
      <td>0.140980</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Aragón</td>
      <td>1992</td>
      <td>2022</td>
      <td>5.334</td>
      <td>4.901</td>
      <td>Total</td>
      <td>4.492973</td>
      <td>4.492973</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Aragón</td>
      <td>1992</td>
      <td>2011</td>
      <td>3.169</td>
      <td>4.202</td>
      <td>Segmented</td>
      <td>2.248442</td>
      <td>2.248442</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Aragón</td>
      <td>2011</td>
      <td>2016</td>
      <td>8.596</td>
      <td>6.259</td>
      <td>Segmented</td>
      <td>3.455944</td>
      <td>3.455944</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Aragón</td>
      <td>2016</td>
      <td>2022</td>
      <td>7.960</td>
      <td>4.257</td>
      <td>Segmented</td>
      <td>2.943951</td>
      <td>2.943951</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Comunidad de Madrid</td>
      <td>1992</td>
      <td>2022</td>
      <td>22.065</td>
      <td>3.327</td>
      <td>Total</td>
      <td>20.944778</td>
      <td>20.944778</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Comunidad de Madrid</td>
      <td>1992</td>
      <td>2016</td>
      <td>20.863</td>
      <td>3.530</td>
      <td>Segmented</td>
      <td>19.376291</td>
      <td>19.376291</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Comunidad de Madrid</td>
      <td>2016</td>
      <td>2022</td>
      <td>10.800</td>
      <td>1.146</td>
      <td>Segmented</td>
      <td>2.908593</td>
      <td>2.908593</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Castilla y León</td>
      <td>1992</td>
      <td>2022</td>
      <td>14.204</td>
      <td>4.526</td>
      <td>Total</td>
      <td>12.672479</td>
      <td>12.672479</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Castilla y León</td>
      <td>1992</td>
      <td>2011</td>
      <td>9.745</td>
      <td>4.297</td>
      <td>Segmented</td>
      <td>7.592196</td>
      <td>7.592196</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Castilla y León</td>
      <td>2011</td>
      <td>2016</td>
      <td>24.978</td>
      <td>6.185</td>
      <td>Segmented</td>
      <td>12.488989</td>
      <td>12.488989</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Castilla y León</td>
      <td>2016</td>
      <td>2022</td>
      <td>7.701</td>
      <td>1.512</td>
      <td>Segmented</td>
      <td>2.756236</td>
      <td>2.756236</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Castilla-La Mancha</td>
      <td>1992</td>
      <td>2022</td>
      <td>14.260</td>
      <td>4.493</td>
      <td>Total</td>
      <td>12.914538</td>
      <td>12.914538</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Castilla-La Mancha</td>
      <td>1992</td>
      <td>2011</td>
      <td>10.572</td>
      <td>4.512</td>
      <td>Segmented</td>
      <td>8.489794</td>
      <td>8.489794</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Castilla-La Mancha</td>
      <td>2011</td>
      <td>2016</td>
      <td>20.948</td>
      <td>5.107</td>
      <td>Segmented</td>
      <td>8.952858</td>
      <td>8.952858</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Castilla-La Mancha</td>
      <td>2016</td>
      <td>2022</td>
      <td>8.436</td>
      <td>1.688</td>
      <td>Segmented</td>
      <td>5.459367</td>
      <td>5.459367</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Extremadura</td>
      <td>1992</td>
      <td>2022</td>
      <td>5.222</td>
      <td>3.658</td>
      <td>Total</td>
      <td>4.798019</td>
      <td>4.798019</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Extremadura</td>
      <td>1992</td>
      <td>2006</td>
      <td>2.733</td>
      <td>2.719</td>
      <td>Segmented</td>
      <td>2.371352</td>
      <td>2.371352</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Extremadura</td>
      <td>2006</td>
      <td>2016</td>
      <td>6.235</td>
      <td>3.856</td>
      <td>Segmented</td>
      <td>5.711919</td>
      <td>5.711919</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Extremadura</td>
      <td>2016</td>
      <td>2022</td>
      <td>5.179</td>
      <td>2.491</td>
      <td>Segmented</td>
      <td>2.296373</td>
      <td>2.296373</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Illes Balears</td>
      <td>1992</td>
      <td>2022</td>
      <td>4.007</td>
      <td>3.363</td>
      <td>Total</td>
      <td>3.649426</td>
      <td>3.649426</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Illes Balears</td>
      <td>1992</td>
      <td>2001</td>
      <td>2.528</td>
      <td>3.450</td>
      <td>Segmented</td>
      <td>2.303964</td>
      <td>2.303964</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Illes Balears</td>
      <td>2001</td>
      <td>2022</td>
      <td>3.623</td>
      <td>2.616</td>
      <td>Segmented</td>
      <td>3.210246</td>
      <td>3.210246</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Andalucía</td>
      <td>1992</td>
      <td>2022</td>
      <td>30.412</td>
      <td>3.542</td>
      <td>Total</td>
      <td>27.133751</td>
      <td>27.133751</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Andalucía</td>
      <td>1992</td>
      <td>2011</td>
      <td>21.091</td>
      <td>3.141</td>
      <td>Segmented</td>
      <td>18.263217</td>
      <td>18.263217</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Andalucía</td>
      <td>2011</td>
      <td>2016</td>
      <td>55.514</td>
      <td>5.294</td>
      <td>Segmented</td>
      <td>19.647710</td>
      <td>19.647710</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Andalucía</td>
      <td>2016</td>
      <td>2022</td>
      <td>37.620</td>
      <td>2.944</td>
      <td>Segmented</td>
      <td>15.757222</td>
      <td>15.757222</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Región de Murcia</td>
      <td>1992</td>
      <td>2022</td>
      <td>6.635</td>
      <td>4.715</td>
      <td>Total</td>
      <td>4.820787</td>
      <td>4.820787</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Región de Murcia</td>
      <td>1992</td>
      <td>2011</td>
      <td>3.282</td>
      <td>3.459</td>
      <td>Segmented</td>
      <td>2.839551</td>
      <td>2.839551</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Región de Murcia</td>
      <td>2011</td>
      <td>2016</td>
      <td>15.775</td>
      <td>8.806</td>
      <td>Segmented</td>
      <td>4.817285</td>
      <td>4.817285</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Región de Murcia</td>
      <td>2016</td>
      <td>2022</td>
      <td>9.680</td>
      <td>3.906</td>
      <td>Segmented</td>
      <td>4.496604</td>
      <td>4.496604</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Norte</td>
      <td>1992</td>
      <td>2022</td>
      <td>24.717</td>
      <td>2.939</td>
      <td>Total</td>
      <td>22.897260</td>
      <td>22.897260</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Norte</td>
      <td>1992</td>
      <td>2001</td>
      <td>21.005</td>
      <td>3.637</td>
      <td>Segmented</td>
      <td>19.052864</td>
      <td>19.052864</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Norte</td>
      <td>2001</td>
      <td>2006</td>
      <td>30.777</td>
      <td>4.086</td>
      <td>Segmented</td>
      <td>24.442391</td>
      <td>24.442391</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Norte</td>
      <td>2006</td>
      <td>2022</td>
      <td>18.553</td>
      <td>1.825</td>
      <td>Segmented</td>
      <td>14.227799</td>
      <td>14.227799</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Algarve</td>
      <td>1992</td>
      <td>2022</td>
      <td>3.831</td>
      <td>5.079</td>
      <td>Total</td>
      <td>3.017438</td>
      <td>3.017438</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Algarve</td>
      <td>1992</td>
      <td>2001</td>
      <td>0.812</td>
      <td>3.085</td>
      <td>Segmented</td>
      <td>0.723160</td>
      <td>0.723160</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Algarve</td>
      <td>2001</td>
      <td>2022</td>
      <td>2.953</td>
      <td>3.084</td>
      <td>Segmented</td>
      <td>2.783638</td>
      <td>2.783638</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Centro (PT)</td>
      <td>1992</td>
      <td>2022</td>
      <td>20.834</td>
      <td>4.859</td>
      <td>Total</td>
      <td>19.321511</td>
      <td>19.321511</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Centro (PT)</td>
      <td>1992</td>
      <td>2011</td>
      <td>18.201</td>
      <td>5.941</td>
      <td>Segmented</td>
      <td>14.213573</td>
      <td>14.213573</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Centro (PT)</td>
      <td>2011</td>
      <td>2022</td>
      <td>16.126</td>
      <td>2.524</td>
      <td>Segmented</td>
      <td>7.878988</td>
      <td>7.878988</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>1992</td>
      <td>2022</td>
      <td>11.428</td>
      <td>2.553</td>
      <td>Total</td>
      <td>10.415274</td>
      <td>10.415274</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>1992</td>
      <td>2001</td>
      <td>9.183</td>
      <td>2.854</td>
      <td>Segmented</td>
      <td>6.999145</td>
      <td>6.999145</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>2001</td>
      <td>2011</td>
      <td>12.818</td>
      <td>2.876</td>
      <td>Segmented</td>
      <td>10.702783</td>
      <td>10.702783</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>2011</td>
      <td>2022</td>
      <td>4.460</td>
      <td>0.808</td>
      <td>Segmented</td>
      <td>2.615993</td>
      <td>2.615993</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Alentejo</td>
      <td>1992</td>
      <td>2022</td>
      <td>6.318</td>
      <td>5.717</td>
      <td>Total</td>
      <td>5.882752</td>
      <td>5.882752</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Alentejo</td>
      <td>1992</td>
      <td>2001</td>
      <td>2.107</td>
      <td>4.779</td>
      <td>Segmented</td>
      <td>1.620979</td>
      <td>1.620979</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Alentejo</td>
      <td>2001</td>
      <td>2022</td>
      <td>6.730</td>
      <td>4.869</td>
      <td>Segmented</td>
      <td>6.163737</td>
      <td>6.163737</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="trend-analysis">
<h4>Trend Analysis<a class="headerlink" href="#trend-analysis" title="Link to this heading">#</a></h4>
<p>The results demonstrates that, although breakpoints were identified, they do not substantially alter the underlying trend estimates. In all cases, the total trend was preferred, as segmented alternatives did not exhibit significantly stronger slopes or lower p-values.</p>
<p>This suggests that the dataset provides a coherent temporal structure for monitoring urban land cover change. While localised variations exist, the broader trend of urban expansion remains largely continuous and statistically stable.</p>
<p>Furthermore, the reliability of the total trend is evident even in regions with marked breakpoint clusters, such as Galicia, Andalucía, and Región de Murcia. Despite temporary changes in slope magnitude, the segmented trends did not offer a statistically significant improvement over the total series, suggesting that short-term accelerations or decelerations are well-integrated into the full-period estimate.</p>
<p>Geographical characteristics modulate this effect. Larger metropolitan areas or regions with long-standing urban infrastructure exhibit smoother temporal evolution, while smaller or emerging urban zones may reflect sharper shifts in land cover classification. Nevertheless, these fluctuations did not systematically translate into divergent trend recommendations.</p>
<p>In summary, the analysis confirms that the dataset is suitable for deriving consistent urbanisation trends across multi-decadal periods. Segmentation remains a valuable diagnostic tool for identifying local deviations, but for most spatial planning and land management applications, the total trend offers a statistically supported and methodologically stable representation of urban growth dynamics.</p>
</section>
</section>
<section id="discussion">
<span id="satellite-satellite-land-cover-trend-assessment-q02-code-section-5"></span><h3><strong>5. Discussion</strong><a class="headerlink" href="#discussion" title="Link to this heading">#</a></h3>
<p>The results of this analysis demonstrate the suitability of the dataset for assessing long-term urbanisation trends. Despite the presence of breakpoints the overall consistency of the dataset supports its use for reliable trend estimation in urban land cover.</p>
<p>For spatial planning and land management applications, this temporal continuity is critical. The ability to trace urban expansion over a multi-decadal period enables stakeholders to evaluate the spatial footprint of urban growth, assess policy impacts, and inform future development strategies. The dataset captures the general trajectory of urbanisation effectively, even in the presence of short-term fluctuations or classification refinements.</p>
<p>Nonetheless, the analysis highlights the importance of methodological awareness. Breakpoints occurring around years such as 2001, 2011, and 2016 often coincide with known changes in satellite platforms or classification algorithms. These may introduce artificial discontinuities in urban extent, particularly in regions undergoing rapid development or where classification thresholds are more sensitive to spectral or spatial resolution. Such effects must be considered when interpreting apparent changes in urban dynamics.</p>
<p>Geographic and demographic context also influence data interpretation. Larger metropolitan regions, such as Madrid or Lisbon, tend to exhibit smoother trends, as broader patterns of growth absorb minor classification inconsistencies. In contrast, smaller or fast-developing regions may show more pronounced breaks, either due to real shifts in urbanisation or amplified sensitivity to methodological updates.</p>
<p>From a practical standpoint, the dataset supports robust urban trend detection, but effective application requires a cautious and informed approach. Users should:</p>
<ul class="simple">
<li><p>Consider the potential influence of sensor transitions and processing updates on detected breakpoints</p></li>
<li><p>Prioritise total trends for general assessments, while using segmentation to highlight context-specific deviations</p></li>
<li><p>Interpret statistical outputs alongside relevant contextual knowledge, such as infrastructure investments, economic cycles, or policy milestones</p></li>
</ul>
<p>In conclusion, the dataset provides a strong foundation for monitoring urbanisation trends. Its temporal stability and spatial resolution are appropriate for regional-scale planning, but optimal use depends on integrating quantitative outputs with critical understanding of the dataset’s structure.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key Resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The CDS catalogue entry for the data used was <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-land-cover?tab=overview">Land cover classification gridded maps from 1992 to present derived from satellite observations</a></p></li>
<li><p>Product User Guide and Specification of the dataset <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D5.3.1_PUGS_ICDR_LC_v2.1.x_PRODUCTS_v1.1.pdf">version 2.1</a> and <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D3.3.11-v1.0_PUGS_CDR_LC-CCI_v2.0.7cds_Products_v1.0.1_APPROVED_Ver1.pdf">version 2.0</a></p></li>
<li><p><a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts">Eurostat NUTS</a> (Nomenclature of territorial units for statistics)</p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, c3s_eqc_automatic_quality_control, prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>Vargo, J., Habeeb, D. M., &amp; Stone, B. (2013). The importance of land cover change across urban-rural typologies for climate modeling. Journal of Environmental Management, 114, 243-252. <a class="reference external" href="https://doi.org/10.1016/j.jenvman.2012.10.007">https://doi.org/10.1016/j.jenvman.2012.10.007</a></p>
<p>Chang, Y., Hou, K., Li, X., Zhang, Y., &amp; Chen, P. (2018). Review of land use and land cover change research progress. IOP Conference Series: Earth and Environmental Science, 113, 012087. <a class="reference external" href="https://doi.org/10.1088/1755-1315/113/1/012087">https://doi.org/10.1088/1755-1315/113/1/012087</a></p>
<p>Chelali, A., Benediktsson, J. A., Chanussot, J., &amp; Akbari, V. (2019). A review of artificial intelligence techniques for land cover change detection using remote sensing images. IEEE Transactions on Geoscience and Remote Sensing, 57(10), 7649–7668. <a class="reference external" href="https://ieeexplore.ieee.org/document/8808967">https://ieeexplore.ieee.org/document/8808967</a></p>
<p>Delgado, L., &amp; Romero, J. (2021). Evaluating the impact of Madrid Central on urban mobility: A step toward sustainable cities? Cities, 113, 103120. <a class="reference external" href="https://doi.org/10.1016/j.cities.2021.103120">https://doi.org/10.1016/j.cities.2021.103120</a></p>
<p>González, M. J., &amp; Leal, J. (2018). Urban growth and real estate development in the Iberian Peninsula: The boom of 1996–2007. Land Use Policy, 76, 648–657. <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2018.05.023">https://doi.org/10.1016/j.landusepol.2018.05.023</a></p>
<p>Gutiérrez, F., Rodríguez, V., &amp; Prieto, C. (2016). Aging population and urbanization: Implications for Spain’s demographic landscape. Journal of Rural Studies, 45, 85–98. <a class="reference external" href="https://doi.org/10.1016/j.jrurstud.2016.03.008">https://doi.org/10.1016/j.jrurstud.2016.03.008</a></p>
<p>López, F. A., Martín, J. C., &amp; Albalate, D. (2017). High-speed rail and urban expansion in the Iberian Peninsula: The cases of AVE and Alfa Pendular. Journal of Transport Geography, 60, 57–68. <a class="reference external" href="https://doi.org/10.1016/j.jtrangeo.2017.02.005">https://doi.org/10.1016/j.jtrangeo.2017.02.005</a></p>
<p>Martínez, P., &amp; García, R. (2015). The impact of the 2008 financial crisis on urban expansion in southern Spain. Habitat International, 47, 42–50. <a class="reference external" href="https://doi.org/10.1016/j.habitatint.2015.01.010">https://doi.org/10.1016/j.habitatint.2015.01.010</a></p>
<p>Palmero-Iniesta, H., Fernández, J. A., &amp; Olcina, J. (2021). Land-use changes and natural land recovery after the 2008 crisis: Evidence from Spain. Environmental Science &amp; Policy, 116, 72–83. <a class="reference external" href="https://api.semanticscholar.org/CorpusID:238829360">https://api.semanticscholar.org/CorpusID:238829360</a></p>
<p>Rullan, O. (2014). The impact of tourism-driven urbanisation in Spain and Portugal: Coastal transformations and land use. Land Use Policy, 38, 139–150. <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2014.02.009">https://doi.org/10.1016/j.landusepol.2014.02.009</a></p>
<p>Sánchez, M., Pérez, L., &amp; Torres, D. (2019). Rural depopulation and urban migration trends in Spain and Portugal. Geoforum, 104, 78–91. <a class="reference external" href="https://doi.org/10.1016/j.geoforum.2019.06.015">https://doi.org/10.1016/j.geoforum.2019.06.015</a></p>
<p>Silva, E., &amp; Fernandes, J. (2019). The influence of urban planning policies on land prices and informal settlements in Iberian cities. Land Use Policy, 89, 104200. <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2019.04.012">https://doi.org/10.1016/j.landusepol.2019.04.012</a></p>
<p>Silva, V., Santos, R., &amp; Moreira, J. (2017). The expansion of peri-urban areas in Lisbon and Porto: Drivers and consequences. Cities, 66, 101–112. <a class="reference external" href="https://doi.org/10.1016/j.cities.2017.04.002">https://doi.org/10.1016/j.cities.2017.04.002</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Biosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Biosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Hydrology/Land_Hydrology.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-quantify-urbanisation-trends">🌍 Use case: Using land cover products to quantify urbanisation trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data"><strong>1. Define the AoI, search and download LC data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#install-cds-api">Install CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula"><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-urban-area-for-each-nuts-2-region">Compute urban area for each NUTS 2 region</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-urban-classes-and-prepare-dataset">Select Urban Classes and Prepare Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-urban-area-per-region-and-year">Compute urban area per region and year</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-urban-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">Map urban percentage coverage over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-urban-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">Map urban percentage coverage change over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-analysis">Map Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-drivers-and-methodological-considerations-in-urbanisation-trends-in-the-iberian-peninsula-19922022"><strong>Potential Drivers and Methodological Considerations in Urbanisation Trends in the Iberian Peninsula (1992–2022)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-detection"><strong>3. Breakpoint Detection</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-analysis">Breakpoint Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-table">📊 <strong>Summary Table</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-assessment"><strong>4.Trend Assessment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis">Trend Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion"><strong>5. Discussion</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>