
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Consistency of carbon dioxide satellite observations for the evaluation of Earth system models. &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_consistency_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">🌍 Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variable-of-interest">Define the variable of interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-monthly-xco-2-data-coverage">Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-data-coverage-for-different-periods">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-growth-rate-and-seasonal-cycles">Calculation of growth rate and seasonal cycles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-seasonal-cycle-amplitude-sca">Calculation of the Seasonal Cycle Amplitude (SCA)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="consistency-of-carbon-dioxide-satellite-observations-for-the-evaluation-of-earth-system-models">
<h1><span class="section-number">1.2.1. </span>Consistency of carbon dioxide satellite observations for the evaluation of Earth system models.<a class="headerlink" href="#consistency-of-carbon-dioxide-satellite-observations-for-the-evaluation-of-earth-system-models" title="Link to this heading">#</a></h1>
<p>Production date: 15-09-2025</p>
<p>Produced by: CNR</p>
<section id="use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">
<h2>🌍 Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models<a class="headerlink" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the temporal consistency of the Level-3 Obs4MIPs merged dataset suitable for calculating changes in the annual growth rates of XCO₂ and the amplitude of the seasonal cycles?</strong></p></li>
</ul>
<p>The most important anthropogenic greenhouse gas is carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>), with CO<span class="math notranslate nohighlight">\(_2\)</span> emissions contributing 66% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>. It is therefore important to monitor the long-term changes in atmospheric CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations, to understand the sources and sinks of the atmospheric carbon content and to provide reliable projections of future CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations under various scenarios.</p>
<p>Earth System Models (ESMs) are computer simulations that couple the physical climate (i.e. the atmosphere, the oceans and sea ice) with other components of the Earth, such as the land surface, vegetation, biogeochemistry (i.e. the carbon and nitrogen cycles), the cryosphere and, in some cases, human systems, in order to simulate how the entire Earth behaves now and in the future <a class="reference external" href="https://doi.org/10.5194/gmd-9-1937-2016" rel="noreferrer" target="_blank">[2]</a>. They are widely used, among other aims, to provide climate projections under different greenhouse gas and land use scenarios, to determine the contribution of human activities to observed changes or specific extreme events, to investigate biogeochemical cycles, and to inform mitigation pathways and climate risk analysis for policymakers.</p>
<p>In this assessment, we show how the column-averaged mixing ratios of CO<span class="math notranslate nohighlight">\(_2\)</span> (XCO<span class="math notranslate nohighlight">\(_2\)</span>) provided by the Obs4MIPs Level 3 data product of <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> can be used to evaluate the annual growth rates and seasonal cycles of CO<span class="math notranslate nohighlight">\(_2\)</span> provided by ESMs. The Obs4MIPs Level 3 data product results from integrating XCO₂ data from different combinations of satellite sensors and algorithms over time and space. Based on the results of references <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> and independent analyses, we investigate the impact of changes in the sampling characteristics of the Obs4MIPs dataset on the ability to use it to evaluate the capacity of ESMs to reproduce CO₂ seasonal cycle amplitudes and related trends/inter-annual variability, across its entire temporal coverage.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The Obs4MIPs Lev3 merged dataset is suitable for assessing the capacity of Earth System Models to reproduce CO₂ growth rates and seasonal cycle variability, however the dataset features related to the spatial and temporal data coverage must be carefully considered (see points below).</p></li>
<li><p>For annual aggregation, high-latitude regions (i.e.. latitudes higher than 60°N and 60°S) should not be considered due to non-uniform data coverage across the different seasons.</p></li>
<li><p>The introduction of new satellite data (e.g., GOSAT in 2009 and OCO-2 in 2015) affects the data coverage at global scale with changing coverage of high latitude regions and oceans.</p></li>
<li><p>The months characterised by changes in the contributing satellite data can show inconsistent CO₂ growth rates; however, this feature is averaged out when computing the annual growth.</p></li>
<li><p>Changes in data coverage over the period covered by the Obs4MIPs Level 3 dataset affect the calculation of the seasonal cycle amplitude.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>To assess if the temporal consistency of the Level-3 Obs4MIPs merged dataset from the Climate Data Store “Carbon dioxide data from 2002 to present derived from satellite observations” <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> is suitable for calculating changes in the annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the amplitude of the seasonal cycles, we inspected a specific case study available from scientific literature  <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> and we performed independent analyses. In particular, we analysed the changes of data coverage as a function of months and years, we calculated the monthly resolved CO<span class="math notranslate nohighlight">\(_2\)</span> annual growth rates and the annual seasonal cycles. To do that we used a methodology consistent with <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>. However, we perform our analyses over the period 2003 - 2022 by using the most recent version (4.5) of the Level-3 Obs4MIPs merged dataset <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[5]</a>. This dataset is obtained by gridding the merged level-2 product generated with the ensemble median algorithm (XCO2_EMMA). EMMA combines several different XCO2 level-2 satellite data products: SCIAMACHY/Envisat (2003–2012), TANSO-FTS/GOSAT (2009–2022), OCO-2 (2014-2022), TANSO-FTS-2/GOSAT2 (2019-2022).</p>
<p>A previous study <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> evaluated  emission-driven CMIP5 and CMIP6 simulations with satellite data of column-average CO<span class="math notranslate nohighlight">\(_2\)</span> mole fractions (XCO<span class="math notranslate nohighlight">\(_2\)</span>) by considering a earlier version of the Level-3 Obs4MIPs merged data product available by the Climate Data Store (Obs4MIPs, version 3) from 2003 to 2016. In particular, this previous study evaluated the agreement between CMIP5 and CMIP6 simulations with satellite data in depicting the annual growth rate of CO<span class="math notranslate nohighlight">\(_2\)</span> as well as the changes of seasonal cycle amplitude (SCA) with time.</p>
<p>More specifically, this notebook aims to:</p>
<ul class="simple">
<li><p>Generate global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage, to show that the spatial coverage of data is not uniform across the different regions of the world for the different seasons.</p></li>
<li><p>Generate global maps of  XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage as a function of the different temporal periods covered by different satellite/sensors, i.e. SCIAMACHY/Envisat (2003–2012), TANSO-FTS/GOSAT (2009–2022), OCO-2 (2014-2022), TANSO-FTS-2/GOSAT2 (2019-2022).</p></li>
<li><p>To calculate the global annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the seasonal cycle amplitudes for the entire measurement period 2003-2022.</p></li>
</ul>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-1"><span class="std std-ref">1. Choose the data to use and set-up the code</span></a></strong></p>
<ul class="simple">
<li><p>Import all relevant packages.</p></li>
<li><p>Select the variable of interest</p></li>
<li><p>Cache needed functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-2"><span class="std std-ref">2. Retrieve data</span></a></strong></p>
<ul class="simple">
<li><p>Define the data request to CDS.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-carbon-dioxide-consistency-q04-template-section-3"><span class="std std-ref">3. Data analysis</span></a></strong></p>
<p>This section presents several results for the XCO<span class="math notranslate nohighlight">\(_2\)</span> products, i.e.:</p>
<ul class="simple">
<li><p>The monthtly mean data coverage of XCO<span class="math notranslate nohighlight">\(_2\)</span> over the period 2003-2022.</p></li>
<li><p>The mean data coverage of XCO<span class="math notranslate nohighlight">\(_2\)</span> over specific time periods characterised by the use of observations from different satellites.</p></li>
<li><p>The calculation of the XCO<span class="math notranslate nohighlight">\(_2\)</span> growth rates and annual seasonal cycles by using an approach similar to that adopted by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>. Specifically, we computed monthly resolved annual growth rates by subtracting the XCO<span class="math notranslate nohighlight">\(_2\)</span> value 6 months in the future from the one 6 months in the past. Then these monthly resolved growth rates are averaged to a yearly GR for a calendar year. We calculated the annual seasonal cycled of global XCO<span class="math notranslate nohighlight">\(_2\)</span> by detrending the monthly time series with the cumulative sum of monthly growth rates, using the annual mean growth rates as substitution for missing values where necessary. Finally, we normalised the time series of detrended monthly values by subtracting the average seasonal cycle over the whole period 2003 - 2022. Spatial averages are calculated by taking the arithmetic averages over all grid cells weighted by their area.</p></li>
<li><p>Similarly to <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>, we calculated of the annual seasonal cycle amplitudes (SCAs) as the peak-to-trough amplitude in a calendar year of the detrended time series.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-1"></span><h3>1. Choose the data to use and set-up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-relevant-packages">
<h4>Import all relevant packages<a class="headerlink" href="#import-all-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook and we define the style for plot appearance (“seaborn-v0_8-notebook”) as well as the style of hatches used in the maps.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span> <span class="c1">#to suppress warning</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaxNLocator</span><span class="p">,</span> <span class="n">FuncFormatter</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/putero_davide/.cdsapirc&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;hatch.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">download</span><span class="o">.</span><span class="n">INVALIDATE_CACHE</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">#Set True to invalidate the caching</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span> <span class="c1">#To filter out warnings</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-the-variable-of-interest">
<h4>Define the variable of interest<a class="headerlink" href="#define-the-variable-of-interest" title="Link to this heading">#</a></h4>
<p>In this section, we define the parameters to be ingested by the code (that can be customized by the user), i.e.:</p>
<ul class="simple">
<li><p>the variable of interest.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose variable (xch4 or xco2)</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;xco2&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">,</span> <span class="s2">&quot;xco2&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_nobs&quot;</span><span class="p">,</span> <span class="s2">&quot;_stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;_stddev&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="cache-needed-functions">
<h4>Cache needed functions<a class="headerlink" href="#cache-needed-functions" title="Link to this heading">#</a></h4>
<p>In this section, we cached a list of functions used in the analyses.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> function rescales XCO<span class="math notranslate nohighlight">\(_2\)</span> mole fraction to parts per million (ppm).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_coverage</span></code> function calculates the spatial fractional coverage of the available data and creates associated maps.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">area_weighted_series</span></code> function calculates the spatial averages over all grid cells in a region. It uses spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_GR_and_seasonal</span></code> funtion calculates the monthly resolved annual growth rates of XCO<span class="math notranslate nohighlight">\(_2\)</span> and the annual seasonal cycles.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_da</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">min_land_fraction</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span>
<span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)))</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_nobs&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">da</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppb&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e9</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppb&quot;</span>
        <span class="k">elif</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppm&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e6</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppm&quot;</span>
    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_coverage</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">missing_values</span><span class="o">=</span><span class="mf">1.0e20</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">da</span> <span class="o">!=</span> <span class="n">missing_values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">/</span> <span class="n">da</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">area_weighted_series</span><span class="p">(</span><span class="n">xda</span><span class="p">,</span> <span class="n">weights2d</span><span class="p">):</span>
    <span class="c1"># numerator: sum over lat,lon of x * weight (ignore NaNs in x)</span>
    <span class="n">num</span> <span class="o">=</span> <span class="p">(</span><span class="n">xda</span> <span class="o">*</span> <span class="n">weights2d</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xda</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">weights2d</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xda</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
    <span class="c1"># avoid division by zero</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">den</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ts</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    series: pandas.Series indexed by Timestamp (monthly)</span>
<span class="sd">    returns: monthly_GR (ppm/yr, pandas.Series), seasonal (ppm, pandas.Series)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert to xarray DataArray with time coords</span>
    <span class="n">s_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,))</span>
    <span class="c1"># compute GR: GR(m) = x(t+6) - x(t-6)</span>
    <span class="n">xco2_future</span> <span class="o">=</span> <span class="n">s_xr</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">xco2_past</span>   <span class="o">=</span> <span class="n">s_xr</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=+</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">monthly_GR</span> <span class="o">=</span> <span class="p">(</span><span class="n">xco2_future</span> <span class="o">-</span> <span class="n">xco2_past</span><span class="p">)</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span>

    <span class="c1"># annual mean GR (used to substitute missing monthly GR)</span>
    <span class="n">yearly_GR</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">monthly_GR</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># fill monthly GR missing with annual mean where possible</span>
    <span class="n">monthly_GR_filled</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">yearly_GR</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span>
            <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthly_GR_filled</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="c1"># monthly increment (ppm/month) from yearly GR</span>
    <span class="n">monthly_trend</span> <span class="o">=</span> <span class="n">monthly_GR</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">yearly_GR</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">monthly_trend</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="n">monthly_trend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="mf">12.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">monthly_trend</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># cumulative trend (ppm)</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">monthly_trend</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="c1"># seasonal cycle: xco2 - cumulative trend ; center to zero mean</span>
    <span class="n">seasonal</span> <span class="o">=</span> <span class="n">series</span> <span class="o">-</span> <span class="n">trend</span>
    <span class="n">seasonal</span> <span class="o">=</span> <span class="n">seasonal</span> <span class="o">-</span> <span class="n">seasonal</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">monthly_GR</span><span class="p">,</span> <span class="n">seasonal</span>    
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="retrieve-data">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-2"></span><h3>2. Retrieve data<a class="headerlink" href="#retrieve-data" title="Link to this heading">#</a></h3>
<section id="obs4mips">
<h4>2.1 Obs4MIPs<a class="headerlink" href="#obs4mips" title="Link to this heading">#</a></h4>
<p>In this section, we define the data request to CDS (data product Obs4MIPs, Level 3, version 4.5, XCO<span class="math notranslate nohighlight">\(_2\)</span>) and download the full dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-carbon-dioxide&quot;</span> <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;satellite-methane&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;level_3&quot;</span><span class="p">],</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;merged_obs4mips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4_5&quot;</span><span class="p">],</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;zip&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-analysis">
<span id="satellite-satellite-carbon-dioxide-consistency-q04-template-section-3"></span><h3>3. Data analysis<a class="headerlink" href="#data-analysis" title="Link to this heading">#</a></h3>
<section id="global-maps-of-monthly-xco-2-data-coverage">
<h4>Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage<a class="headerlink" href="#global-maps-of-monthly-xco-2-data-coverage" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and plot the mean monthly fractional coverage of data over the period 2003 - 2022. In agreement with the results by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>, the number of available observations depends significantly on the location with low data coverage values over locations typically affected by high cloud coverage (like tropics) and low Sun elevation (like high latitude in winter months). Coverage over ocean is sparse as ocean retrievals are included from GOSAT, OCO-2 and GOSAT2 Sun-glint mode observations. <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> demonstrated that taking into account this sampling coverage feature is essential for a proper comparison with outputs from ESMs.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request</span><span class="p">)</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">compute_coverage</span><span class="p">)</span>
<span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;XCO$_2$ Data Coverage&quot;</span><span class="p">}</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">plot_func</span><span class="o">=</span><span class="s2">&quot;contourf&quot;</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
    <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greens&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">},</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/1 [00:00&lt;?, ?it/s]2025-09-15 16:03:44,233 INFO [2025-09-03T00:00:00] To improve our C3S service, we need to hear from you! Please complete this very short [survey](https://confluence.ecmwf.int/x/E7uBEQ/). Thank you.
2025-09-15 16:03:44,234 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-09-15 16:03:44,451 INFO [2025-09-03T00:00:00] To improve our C3S service, we need to hear from you! Please complete this very short [survey](https://confluence.ecmwf.int/x/E7uBEQ/). Thank you.
2025-09-15 16:03:44,452 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-09-15 16:03:44,628 INFO Request ID is 40d292e5-b4ff-4bb3-90df-b1b024ce7034
2025-09-15 16:03:44,706 INFO status has been updated to accepted
2025-09-15 16:03:58,197 INFO status has been updated to running
2025-09-15 16:04:34,397 INFO status has been updated to successful

a87f027c6b4189cffe45c5c8be80fcbb.zip:   0%|          | 0.00/57.0M [00:00&lt;?, ?B/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:   2%|▏         | 1.00M/57.0M [00:00&lt;00:42, 1.37MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:   5%|▌         | 3.00M/57.0M [00:03&lt;01:03, 886kB/s] 
a87f027c6b4189cffe45c5c8be80fcbb.zip:   7%|▋         | 4.00M/57.0M [00:06&lt;01:33, 597kB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:   9%|▉         | 5.00M/57.0M [00:07&lt;01:18, 699kB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  11%|█         | 6.00M/57.0M [00:07&lt;00:55, 965kB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  12%|█▏        | 7.00M/57.0M [00:07&lt;00:40, 1.29MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  14%|█▍        | 8.00M/57.0M [00:07&lt;00:30, 1.70MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  16%|█▌        | 9.00M/57.0M [00:08&lt;00:22, 2.22MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  18%|█▊        | 10.0M/57.0M [00:08&lt;00:17, 2.84MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  19%|█▉        | 11.0M/57.0M [00:08&lt;00:13, 3.50MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  23%|██▎       | 13.0M/57.0M [00:08&lt;00:09, 4.88MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  25%|██▍       | 14.0M/57.0M [00:08&lt;00:08, 5.57MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  26%|██▋       | 15.0M/57.0M [00:08&lt;00:07, 6.20MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  30%|██▉       | 17.0M/57.0M [00:08&lt;00:05, 7.65MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  33%|███▎      | 19.0M/57.0M [00:09&lt;00:04, 8.94MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  37%|███▋      | 21.0M/57.0M [00:09&lt;00:03, 9.80MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  40%|████      | 23.0M/57.0M [00:09&lt;00:03, 10.5MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  44%|████▍     | 25.0M/57.0M [00:09&lt;00:02, 11.2MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  47%|████▋     | 27.0M/57.0M [00:09&lt;00:02, 11.9MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  51%|█████     | 29.0M/57.0M [00:09&lt;00:02, 12.5MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  54%|█████▍    | 31.0M/57.0M [00:10&lt;00:02, 12.9MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  58%|█████▊    | 33.0M/57.0M [00:10&lt;00:01, 14.2MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  61%|██████▏   | 35.0M/57.0M [00:10&lt;00:01, 13.8MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  65%|██████▍   | 37.0M/57.0M [00:10&lt;00:01, 14.5MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  68%|██████▊   | 39.0M/57.0M [00:10&lt;00:01, 14.2MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  72%|███████▏  | 41.0M/57.0M [00:10&lt;00:01, 14.9MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  75%|███████▌  | 43.0M/57.0M [00:10&lt;00:00, 15.5MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  79%|███████▉  | 45.0M/57.0M [00:10&lt;00:00, 15.6MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  82%|████████▏ | 47.0M/57.0M [00:11&lt;00:00, 16.6MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  86%|████████▌ | 49.0M/57.0M [00:11&lt;00:00, 16.6MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  91%|█████████ | 52.0M/57.0M [00:11&lt;00:00, 17.4MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  95%|█████████▍| 54.0M/57.0M [00:12&lt;00:00, 5.61MB/s]
a87f027c6b4189cffe45c5c8be80fcbb.zip:  98%|█████████▊| 56.0M/57.0M [00:12&lt;00:00, 6.96MB/s]
                                                                                          
  0%|          | 0/1 [00:00&lt;?, ?it/s]
100%|██████████| 1/1 [01:08&lt;00:00, 68.73s/it]
</pre></div>
</div>
<img alt="../../_images/063ae8c947b12f9aa9aad242ec28e2168a57dbeff742c2a0ea6257e998beaaa0.png" src="../../_images/063ae8c947b12f9aa9aad242ec28e2168a57dbeff742c2a0ea6257e998beaaa0.png" />
</div>
</div>
<p><em>The figure shows the monthly fractional XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage from 2003 to 2022 derived from the XCO2_OBS4MIPS dataset (version 4.5).</em></p>
</section>
<section id="global-maps-of-xco-2-data-coverage-for-different-periods">
<h4>Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods<a class="headerlink" href="#global-maps-of-xco-2-data-coverage-for-different-periods" title="Link to this heading">#</a></h4>
<p>In this section, to assess the temporal consistency of spatial data coverage over the whole period covered by the Level-3 Obs4MIPs merged dataset, we calculate and plot the mean fractional coverage of CO<span class="math notranslate nohighlight">\(_2\)</span> data for time periods characterised by the contribution of different satellite observations: i.e., 2003 - 2008 (only SCIAMACHY observations), 2009 - 2011 (combination of SCIAMACHY and GOSAT), 2012 - 2014 (GOSAT), 2015 - 2018 (combination of GOSAT and OCO-2), 2019 -2022 (combination of GOSAT, OCO-2 and GOSAT2). A comprehensive analysis of the number of soundings contained within the EMMA database on a monthly basis, along with the comparative contribution of each individual Level 2 algorithm to the EMMA database, can be found in <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[6]</a>.</p>
<p>Besides not including data over oceans, with respect to subsequent periods in which GOSAT measurements were used (2009 - 2011 and 2012 - 2014), for the period 2003 - 2008 more data are available for regions higher than 50°N as well as over tropical regions in South America and Africa. The introduction of OCO-2 and GOSAT2 observations (2015–2018 and 2019–2022, respectively) resulted in an increase of the data coverage over Europe and the oceans. A substantial proportion of these regions exhibited data coverage levels exceeding 0.5, with the data extending to higher latitudes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To define temporal coverage</span>
<span class="n">bins</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2003-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2009-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2012-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2015-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2019-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SCHIAMACHY (2003-2008)&quot;</span><span class="p">,</span> <span class="s2">&quot;SCHIAMACHY+GOSAT (2009-2011)&quot;</span><span class="p">,</span> <span class="s2">&quot;GOSAT (2012-2014)&quot;</span><span class="p">,</span> <span class="s2">&quot;GOSAT+OCO-2  (2015-2018)&quot;</span><span class="p">,</span> <span class="s2">&quot;GOSAT+OCO-2+GOSAT2 (2019-2012)&quot;</span><span class="p">]</span>

<span class="n">interval_coord</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_index</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ds_1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">interval_coord</span><span class="p">))</span>

<span class="c1"># To categorise data coverage as a function of time periods</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds_1</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">compute_coverage</span><span class="p">)</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;XCO$_2$ Data Coverage&quot;</span><span class="p">}</span>

<span class="c1"># Plotting</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">plot_func</span><span class="o">=</span><span class="s2">&quot;contourf&quot;</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span>
    <span class="n">col_wrap</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greens&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">},</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
    <span class="c1"># add custom labels</span>
    <span class="n">col_labels</span><span class="o">=</span><span class="n">labels</span>
<span class="p">)</span>

<span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span> 

<span class="c1"># Add hatched pattern where coverage &gt; 0.5</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">subda</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;interval&quot;</span><span class="p">)):</span>
    <span class="c1"># convert to 2D array (lat, lon)</span>
    <span class="n">sub2d</span> <span class="o">=</span> <span class="n">subda</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="c1"># mask values &lt;=0.5</span>
    <span class="n">hatched</span> <span class="o">=</span> <span class="n">sub2d</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub2d</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">hatched</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
        <span class="n">hatched</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span>
        <span class="n">hatched</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">hatches</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;///&quot;</span><span class="p">],</span>
        <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    
<span class="c1"># Adjust layout and move colorbar below all maps</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.78</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f78236c50123740283e09a7ee78749f468853b1d365469c2757f5c48b75e8b67.png" src="../../_images/f78236c50123740283e09a7ee78749f468853b1d365469c2757f5c48b75e8b67.png" />
</div>
</div>
<p><em>The figure shows the monthly fractional XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different time periods characterised by the use of different satellites/sensors to obtain obervations. The hatched areas denote regions with data coverage higher than 0.5</em></p>
</section>
<section id="calculation-of-growth-rate-and-seasonal-cycles">
<h4>Calculation of growth rate and seasonal cycles<a class="headerlink" href="#calculation-of-growth-rate-and-seasonal-cycles" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and report the time series of monthly global CO₂ values, the resolved annual growth rate, and the seasonal cycles.
Over the period 2003–2014, our average growth rate of 2.02 ppm/year (with a standard deviation of 0.49 ppm/year) is in very good agreement with the values provided in <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>. The calculated seasonal cycles also completely agree with those calculated in <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>, which report a clear change in shape and amplitude when GOSAT observations began contributing to the calculation of global CO₂ in 2009. The low growth rate observed in 2009 is due to the introduction of GOSAT data, which altered the shape of the seasonal cycle. When considering only land-based data (orange lines), the low growth rate in 2009 disappears, and the seasonal cycles appear more consistent throughout the measurement period with an higher amplitude due to the higher carbon fluxes occurring over land regions than over oceans. This clearly shows that any changes to the sampling features that occur during the period covered by the dataset must be taken into account, particularly when evaluating uniform, gap-free datasets such as those provided by ESMs.
The high growth rate values observed in 2010, 2012, 2016 and 2019 are consistent with those reported by the in situ global network coordinated by <a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a>, and are related to El Niño conditions which favour net carbon emissions into the atmosphere on a global scale.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Load dataset and basic preprocess</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#ds = download.download_and_transform(*request)</span>

<span class="c1"># Replace missing value 1.0e20 with NaN</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.0e20</span><span class="p">)</span>

<span class="c1"># Convert xco2 to ppm</span>
<span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Prepare area weights (cos(lat)) as 2D DataArray (lat, lon)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">lat_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">lat_weights_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">)</span>
<span class="n">weights_lat</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">lat_weights_1d</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]},</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,))</span>
<span class="n">ones_2d</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>  <span class="c1"># shape (latitude, longitude)</span>
<span class="n">weights_2d_raw</span> <span class="o">=</span> <span class="n">weights_lat</span> <span class="o">*</span> <span class="n">ones_2d</span>            <span class="c1"># broadcast to (latitude, longitude)</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># land mask: keep only cells with land_fraction &gt; 0.5</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">land_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span>  <span class="c1"># dims (latitude, longitude)</span>
<span class="c1"># weights masked</span>
<span class="n">weights_2d_masked</span> <span class="o">=</span> <span class="n">weights_2d_raw</span> <span class="o">*</span> <span class="n">land_mask</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Compute series for both cases: all gridcells and masked (land_fraction&gt;0.5)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">x_all</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span>                     <span class="c1"># all points</span>
<span class="n">x_masked</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;xco2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">land_mask</span><span class="p">)</span>  <span class="c1"># masked xco2 (NaN outside mask)</span>

<span class="c1"># area-weighted global series</span>
<span class="n">global_all_series</span> <span class="o">=</span> <span class="n">area_weighted_series</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">weights_2d_raw</span><span class="p">)</span>
<span class="n">global_masked_series</span> <span class="o">=</span> <span class="n">area_weighted_series</span><span class="p">(</span><span class="n">x_masked</span><span class="p">,</span> <span class="n">weights_2d_masked</span><span class="p">)</span>

<span class="c1"># compute monthly GR and seasonal cycle for both</span>
<span class="n">monthly_GR_all</span><span class="p">,</span> <span class="n">seasonal_all</span> <span class="o">=</span> <span class="n">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">global_all_series</span><span class="p">)</span>
<span class="n">monthly_GR_masked</span><span class="p">,</span> <span class="n">seasonal_masked</span> <span class="o">=</span> <span class="n">compute_GR_and_seasonal</span><span class="p">(</span><span class="n">global_masked_series</span><span class="p">)</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Quick diagnostics (optional prints)</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#print(&quot;Global (all) series length:&quot;, len(global_all_series.dropna()))</span>
<span class="c1">#print(&quot;Global (masked) series length:&quot;, len(global_masked_series.dropna()))</span>
<span class="c1">#print(&quot;Fraction positive GR (all):&quot;, (monthly_GR_all.dropna() &gt; 0).mean())</span>
<span class="c1">#print(&quot;Fraction positive GR (masked):&quot;, (monthly_GR_masked.dropna() &gt; 0).mean())</span>

<span class="c1"># -------------------------------------------------------</span>
<span class="c1"># Plotting: three vertical plots with both lines</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
<span class="n">color_all</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">color_mask</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># (1) Global monthly mean XCO2</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">global_all_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">global_all_series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">global_masked_series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">global_masked_series</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;xco2 (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Global Monthly Mean XCO₂&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># (2) Monthly Growth Rate (ppm/yr)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;GR (ppm/yr)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Monthly Growth Rate (GR)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># add stats box for both series (means and stds)</span>
<span class="n">mean_all</span> <span class="o">=</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_all</span> <span class="o">=</span> <span class="n">monthly_GR_all</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">mean_mask</span> <span class="o">=</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_mask</span> <span class="o">=</span> <span class="n">monthly_GR_masked</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">textstr</span> <span class="o">=</span> <span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;All: mean=</span><span class="si">{</span><span class="n">mean_all</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">std_all</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;Mask: mean=</span><span class="si">{</span><span class="n">mean_mask</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">std_mask</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">))</span>

<span class="c1"># (3) Seasonal Cycle (detrended)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">seasonal_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seasonal_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">seasonal_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land_fraction &gt; 0.5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Seasonal cycle (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Detrended Seasonal Cycle&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>

<span class="c1"># center y-axis of seasonal cycle around zero (symmetric limits) using both series combined</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">seasonal_all</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">seasonal_masked</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="k">if</span> <span class="n">combined</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># -------------------------</span>
<span class="c1"># Format x-axis to show integer years</span>
<span class="c1"># -------------------------</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>   <span class="c1"># one tick per year</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/53902a00530e2217ae959d1f5e263fa56ae60ae7ad3b06eb701c0daf86432c65.png" src="../../_images/53902a00530e2217ae959d1f5e263fa56ae60ae7ad3b06eb701c0daf86432c65.png" />
</div>
</div>
<p><em>The figure shows the global time series of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> mean values (upper panel), monthly resolved annual growth rate (middle panel) and detrended seasonal cycles (bottom panel) from 2003 to 2022. Blue lines indicate results for the whole dataset, orange lines indicate results for land-masked data.</em></p>
</section>
<section id="calculation-of-the-seasonal-cycle-amplitude-sca">
<h4>Calculation of the Seasonal Cycle Amplitude (SCA)<a class="headerlink" href="#calculation-of-the-seasonal-cycle-amplitude-sca" title="Link to this heading">#</a></h4>
<p>In this section, we show the time series of the annual global SCA calculated for the XCO<span class="math notranslate nohighlight">\(_2\)</span> variables for the whole dataset (blue) as well as for the land data (orange). Overall, the global SCA shows a decreasing trend over the period 2003 - 2022, however it should be pointed out that discontinuities exist at the time when new satellite observations were added to retrieve XCO<span class="math notranslate nohighlight">\(_2\)</span>: especially GOSAT in 2009 and OCO-2 in 2015. When the land data only are considered, the negative tendency diappeared from 2008 onward in agreement with the ESM simulations reported by <a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a>. The high SCA amplitude observed in 2003 can be partially attributed to the relatively high global bias of the SCIAMACHY data product in the first half of the year created by the BESD (Bremen Optimal Estimation DOAS) algorithm (see Figure 5 in <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[6]</a>).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---------------------------------------------------------------------</span>
<span class="c1"># Compute the SCA (peak-to-trough amplitude in each year, min 7 months of data)</span>
<span class="c1"># ---------------------------------------------------------------------</span>
<span class="n">sca_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dt_df</span> <span class="o">=</span> <span class="n">seasonal_all</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">dt_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">dt_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">sca_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">valid</span><span class="o">.</span><span class="n">min</span><span class="p">()})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sca_list</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>

<span class="n">sca_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sca_list</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="n">sca_list_masked</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dt_df</span> <span class="o">=</span> <span class="n">seasonal_masked</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">dt_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">dt_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">sca_list_masked</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">valid</span><span class="o">.</span><span class="n">min</span><span class="p">()})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sca_list_masked</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;SCA&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">})</span>

<span class="n">sca_masked</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sca_list_masked</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1"># Plotting</span>
<span class="c1">#------------------------------------------------------------------------------</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># (1) SCA plot</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All data&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_all</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_all</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_all</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Land fraction &gt; 0.5&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sca_masked</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">sca_masked</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_mask</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Seasonal Cycle Amplitude (ppm)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Years&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Global Monthly Mean XCO₂&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/05bc748ac5d1d3be4a3c2e7b82e994e032eea6fd6903c29e469662b554ff00ab.png" src="../../_images/05bc748ac5d1d3be4a3c2e7b82e994e032eea6fd6903c29e469662b554ff00ab.png" />
</div>
</div>
<p><em>The figure shows the annual time series of SCA from 2003 to 2022 for the whole dataset (blue) and for land-masked data (orange).</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Carbon dioxide data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
<p>Users interested in accessing official C3S products about long term trends of greenhouse gases from satellite observations are encouraged to access specifically designed Copernicus resources like the <a class="reference external" href="https://climate.copernicus.eu/esotc/2024/trends-climate-indicators" rel="noreferrer" target="_blank">European State of Climate</a> or the <a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024" rel="noreferrer" target="_blank">Global Climate Highlights</a>.</p>
<p>Users interested in the investigation of CO<span class="math notranslate nohighlight">\(_2\)</span> fluxes can consider to use specifically designed Copernicus resources like <a class="reference external" href="https://ads.atmosphere.copernicus.eu/datasets/cams-global-greenhouse-gas-inversion?tab=overview" rel="noreferrer" target="_blank">CAMS global inversion-optimised greenhouse gas fluxes and concentrations</a>.</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/idurl/4/69057" rel="noreferrer" target="_blank">[1]</a> World Meteorological Organization. (2024). WMO Greenhouse Gas Bulletin, 20, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.5194/gmd-9-1937-2016" rel="noreferrer" target="_blank">[2]</a> Eyring, V., Bony, S., Meehl, G. A., Senior, C. A., Stevens, B., Stouffer, R. J., and Taylor, K. E. (2016). Overview of the Coupled Model Intercomparison Project Phase 6 (CMIP6) experimental design and organization, Geoscience Model Development, 9, 1937–1958.</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide?tab=overview" rel="noreferrer" target="_blank">[3]</a> Copernicus Climate Change Service, Climate Data Store. (2018). Carbon dioxide data from 2002 to present derived from satellite observations. Copernicus Climate Change Service (C3S) Climate Data Store (CDS) (Accessed on 23-Aug-2025).</p>
<p><a class="reference external" href="https://doi.org/10.5194/bg-17-6115-2020" rel="noreferrer" target="_blank">[4]</a> Gier, B. K., Buchwitz, M., Reuter, M., Cox, P. M., Friedlingstein, P., and Eyring, V. (2020). Spatially resolved evaluation of Earth system models with satellite column-averaged CO2, Biogeosciences, 17, 6115–6144.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[5]</a> Buchwitz, M. (2024). Product User Guide and Specification (PUGS) – Main document for Greenhouse Gas (GHG: CO<span class="math notranslate nohighlight">\(_2\)</span> &amp; CH<span class="math notranslate nohighlight">\(_4\)</span>) data set CDR7 (01.2003-12.2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.3.</p>
<p><a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[6]</a> Reuter, M., and Buchwitz, M. (2024). Algorithm Theoretical Basis Document (ATBD) – ANNEX D for products XCO2_EMMA, XCH4_EMMA, XCO2_OBS4MIPS, XCH4_OBS4MIPS (v4.5, CDR7, 2003-2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.1b.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-evaluating-carbon-dioxide-growth-rates-and-seasonal-cycles-provided-by-earth-system-models">🌍 Use case: Using satellite observations for evaluating carbon dioxide growth rates and seasonal cycles provided by Earth System Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-variable-of-interest">Define the variable of interest</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#obs4mips">2.1 Obs4MIPs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-monthly-xco-2-data-coverage">Global maps of monthly XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xco-2-data-coverage-for-different-periods">Global maps of XCO<span class="math notranslate nohighlight">\(_2\)</span> data coverage for different periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-growth-rate-and-seasonal-cycles">Calculation of growth rate and seasonal cycles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-seasonal-cycle-amplitude-sca">Calculation of the Seasonal Cycle Amplitude (SCA)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>