
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1.1. Monitoring long-term changes of precipitation in support of rain-fed farming &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmosphere_Physics/satellite_satellite-precipitation_validation_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2. Atmospheric Composition" href="../Atmospheric_Composition/Atmospheric_Composition.html" />
    <link rel="prev" title="1.1. Atmosphere Physics" href="Atmosphere_Physics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.1.1. Monitoring long-term changes of precipitation in support of rain-fed farming</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmosphere_Physics/satellite_satellite-precipitation_validation_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmosphere_Physics/satellite_satellite-precipitation_validation_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Monitoring long-term changes of precipitation in support of rain-fed farming</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-observing-the-regional-evolution-of-rainfall">üåç Use case: Observing the regional evolution of rainfall</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">1. Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-map">Plot the map</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-dataset">Download the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-precipitation-climatology">Daily precipitation climatology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-term-trend-and-uncertainty">Long term trend and uncertainty</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-year-average-precipitation-and-fitting-the-data">Compute the year average precipitation and fitting the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-useful-material">Reference/Useful material</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="monitoring-long-term-changes-of-precipitation-in-support-of-rain-fed-farming">
<h1><span class="section-number">1.1.1. </span>Monitoring long-term changes of precipitation in support of rain-fed farming<a class="headerlink" href="#monitoring-long-term-changes-of-precipitation-in-support-of-rain-fed-farming" title="Link to this heading">#</a></h1>
<p>Production date: 31-12-2025</p>
<p>Produced by: ‚ÄòCNRS‚Äô</p>
<section id="use-case-observing-the-regional-evolution-of-rainfall">
<h2>üåç Use case: Observing the regional evolution of rainfall<a class="headerlink" href="#use-case-observing-the-regional-evolution-of-rainfall" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>What is the variability of the observed precipitation over different regions?</strong></p></li>
</ul>
<p>Precipitation is a fundamental component of the hydrological cycle. It significantly influences ecosystems, agriculture, water resources, and weather patterns. In recent decades, climate change has been altering precipitation patterns globally, resulting in shifts in intensity, frequency, and distribution.
Monitoring and understanding the precipitation changes are crucial for predicting future climate impacts and formulating adaptive strategies.
Satellite remote sensing has played a crucial role in this regard, providing comprehensive data on global precipitation. Unlike in situ measurements, which are limited to specific locations, satellite measurements offer extensive coverage across the globe, including remote and oceanic regions [<a class="reference external" href="https://doi.org/10.3390/atmos9040138" rel="noreferrer" target="_blank">1</a>,<a class="reference external" href="https://doi.org/10.1007/s00382-022-06567-9" rel="noreferrer" target="_blank">2</a>].</p>
<!-- This comprehensive data allows for a more complete and accurate assessment of precipitation, enhancing our understanding of how climate change is modifying precipitation patterns and aiding in effective response planning. -->
<p>The Global Precipitation Climatology Project (GPCP), the Copernicus Microwave-based Global Precipitation (COBRA) and the Global Interpolated RAinFall Estimation (GIRAFE) are international initiatives aimed at providing accurate, long-term records of global precipitation.
Estimate of precipitation intensity is obtained by the combination of microwave imagers on polar-orbiting satellites and infrared imagers on geostationary satellites regarding GPCP and GIRAFE products and only microwave imagers on polar-orbiting satellites for COBRA. The time period covered by these daily estimates varies depending on the product :</p>
<ul class="simple">
<li><p>GPCP from 1996 to 2024</p></li>
<li><p>COBRA from 2000 to 2017</p></li>
<li><p>GIRAFE from 2002 to 2022</p></li>
</ul>
<p>These datasets are available on the Copernicus Data Store (CDS) at <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation?tab=overview" rel="noreferrer" target="_blank"><strong>Precipitation monthly and daily gridded data from 1979 to present derived from satellite measurements</strong></a>, <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave?tab=overview" rel="noreferrer" target="_blank"><strong>Precipitation monthly and daily gridded data from 2000 to 2017 derived from satellite microwave observations</strong></a> and <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave-infrared?tab=overview" rel="noreferrer" target="_blank"><strong>Daily and monthly Global Interpolated RAinFall Estimation (GIRAFE) data derived from satellite observations</strong></a> for GPCP, COBRA and GIRAFE respectively. There are several versions of GPCP. For this notebook, the choice is based on the evaluation of the latest version, 3.3, which is available in 0.5¬∞/daily. The comparison between the other versions are available on CDS <a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/36/21/JCLI-D-23-0123.1.xml" rel="noreferrer" target="_blank">[7]</a></p>
<p>The following notebook provides a clear example of computing the climatological annual cycle of daily precipitation and computing the precipitation trend, considering the uncertainties present in the different datasets. This ensures an accurate estimation of the uncertainty in the fitted trend.</p>
<p>The analysis focuses on the tropical belt with an emphasis on the Sahel region, located between the Sahara Desert to the north and the humid tropical savanna to the south. The Sahel is a critical area for monitoring precipitation trends due to its significant dependence on the Hadley cell circulation. Additionally, this region experiences large interannual and decadal variability in rainfall, which profoundly impacts agriculture, water resources, and living conditions. Monitoring precipitation trends in the Sahel is essential for understanding the effects of climate change and for developing effective water management and agricultural strategies to enhance food security for the local population.</p>
<!--The analysis focuses on the Sahel region, but the geolocation can be adjusted to study any region of interest.-->
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Precipitation estimates from GPCP, GIRAFE and COBRA, fall within the range seen in the literature <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1748-9326/ab6a22" rel="noreferrer" target="_blank">[6]</a> concerning the climatological annual cycle of daily precipitation over the common period 2001-2013 over the 20¬∞N-20¬∞S region and they present a bias between them which change following the studied region.</p></li>
<li><p>The uncertainty of the long-term linear trend is affected by possible autocorrelation of the noise in the data. Thus, the trend uncertainty is corrected as suggested by [<a class="reference external" href="https://doi.org/10.1029/98JD00995" rel="noreferrer" target="_blank">4</a>].</p></li>
<li><p>All three products show a mostly positive trends relatively close for the Sahel region and the 20¬∞N-20¬∞S region for the common period 2002-2018 and their respective period exept for COBRA over Sahel region which shows a higher positive trend and also GIRAFE which shows a negative trend for the common period.</p></li>
<li><p>GPCP and GIRAFE present closer uncertainties following the studied region compared to COBRA which shows more variability. Overall, the uncertainties of the three data records are of the same order of magnitude.</p></li>
<li><p>The tau values and 95% confidence intervals for the precipitation trends over both regions are mostly positive for each products which indicates an increase of precipitation with time but the p-values indicates that all products require more data over time in order to obtain meaningful statistics.</p></li>
<li><p>The trend values and the associated uncertainties of each products over Sahel region are consistent with the literature [<a class="reference external" href="https://doi.org/10.1007/s00382-022-06567-9" rel="noreferrer" target="_blank">2</a>, <a class="reference external" href="https://doi.org/10.1002/wcc.591" rel="noreferrer" target="_blank">3</a>].</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>Precipitation observations from GPCP, GIRAFE and COBRA datasets are downloaded from the Climate Data Store for the tropical belt region (20¬∞N-20¬∞S) and the Sahel region, covering the period 1998-2023, 2002-2023 and 2000-2018 respectively. The datasets have a resolution of 5 degrees for GIRAFE and COBRA and 2.5 degrees for GPCP. Only GIRAFE and COBRA provide daily precipitation estimates with associated uncertainties.</p>
<p>The precipitation amount is averaged annually and across the region of interest. The uncertainty of the mean is computed under the assumption that each measurement is independent. The uncertainties for each grid box are averaged quadratically. Then, the uncertainty of the mean is obtained by scaling with the square root of the number of observations:
$<span class="math notranslate nohighlight">\(\sigma_{year} = \frac{1}{\sqrt{N}} \sqrt{ \frac{\sum_{gridbox} \sum_{month} \sigma_{g,m}^2}{N} }\)</span><span class="math notranslate nohighlight">\(
where \)</span>\sigma_{g,m}<span class="math notranslate nohighlight">\( is the error associated to each measurement, \)</span>\sigma_{year}<span class="math notranslate nohighlight">\( is the resulting uncertatinty of the precipitation average, and \)</span>N<span class="math notranslate nohighlight">\( is the total number of data over the studied region for one year.
As GPCP doesn't provide uncertainties, the decision was made to use the standart deviation in time and space of the precipitation over the studied region for one year. Then, \)</span>\sigma_{year}$ is calculated as follows :</p>
<div class="math notranslate nohighlight">
\[\sigma_{year} =  \frac{\sigma_{std}}{\sqrt{N}} \]</div>
<p>The obtained uncertainties <span class="math notranslate nohighlight">\(\sigma_{year}\)</span> are taken into accout in the fit in order to obtain the correct trend uncertainty.
Following [4], the trend uncertainty must be corrected with a factor that depend on the autocorrelation of the precipitation time series. The correction is:</p>
<div class="math notranslate nohighlight">
\[ \sigma_{corrected} = \sigma_{fit} \sqrt{\frac{1+\phi}{1-\phi}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{fit}\)</span> is the uncertainty obtained from the fit procedure, and <span class="math notranslate nohighlight">\(\sigma_{corrected}\)</span> is the true uncertainty of the trend.
Lastly, the 95% confidence level of the trend measurement is computed.</p>
<p>The analysis comprises the following steps:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-precipitation-validation-q01-section-1"><span class="std std-ref">1. Choose the parameters to use and setup code</span></a></strong></p>
<ul class="simple">
<li><p>Import the relevant packages. Define the parameters of the analysis and set the dataset requests</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-precipitation-validation-q01-section-2"><span class="std std-ref">Download the dataset</span></a></strong></p>
<ul class="simple">
<li><p>Download the precipitation amount of COBRA, GIRAFE and GPCP products and their uncertainties provided by the CDS in the 20¬∞N-20¬∞S region.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-precipitation-validation-q01-section-3"><span class="std std-ref">Daily precipitation climatology</span></a></strong></p>
<ul class="simple">
<li><p>The precipitation amount is averaged per day of the year over the 2001-2013 period across the entire 20¬∞N-20¬∞S and Sahel region.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-precipitation-validation-q01-section-4"><span class="std std-ref">Long term trend and uncertainty</span></a></strong></p>
<ul class="simple">
<li><p>The precipitation amount is averaged annually and across the entire 20¬∞N-20¬∞S and Sahel region.</p></li>
<li><p>The precipitation errors are propagated to the means, assuming full independence among the measurements.</p></li>
<li><p>A linear fit is performed on the time series, using the precipitation uncertainties to best estimate the true slope.</p></li>
<li><p>The time series and the associated linear trend are visualized and compared to the known literature.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-parameters-to-use-and-setup-code">
<span id="satellite-satellite-precipitation-validation-q01-section-1"></span><h3>1. Choose the parameters to use and setup code<a class="headerlink" href="#choose-the-parameters-to-use-and-setup-code" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">kendalltau</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/carbone_sullivan/.cdsapirc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters">
<h4>Define parameters<a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Region of interest</span>
<span class="n">lat_min</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>
<span class="n">lat_max</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
<span class="n">lon_min</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="o">-</span><span class="mi">17</span><span class="p">]</span>
<span class="n">lon_max</span> <span class="o">=</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span><span class="mi">35</span><span class="p">]</span>

<span class="c1"># setup plot</span>
<span class="n">precipitation_product</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COBRA&#39;</span><span class="p">,</span> <span class="s1">&#39;GPCP&#39;</span><span class="p">,</span> <span class="s1">&#39;GIRAFE&#39;</span><span class="p">]</span>
<span class="n">color_point</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="n">color_curve</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-the-map">
<h4>Plot the map<a class="headerlink" href="#plot-the-map" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definition of the region of interest : Sahel</span>
<span class="n">Sahel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">lon_min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_min</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_min</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
<span class="n">tropique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">lon_min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_min</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">lon_min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_min</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>

<span class="n">regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">Regions</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Sahel</span><span class="p">,</span> <span class="n">tropique</span><span class="p">],</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sahel&quot;</span><span class="p">,</span> <span class="s2">&quot;Tropiques&quot;</span><span class="p">],</span>
    <span class="n">abbrevs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SAH&quot;</span><span class="p">,</span> <span class="s2">&quot;Tropical belt (20¬∞N-20¬∞S)&quot;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Regions_climatiques&quot;</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;abbrev&quot;</span><span class="p">,</span>
    <span class="n">add_ocean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/677b4e95d2e65854822c6186b6fbedc52fd8773e672efae984860f6f5a20f893.png" src="../../_images/677b4e95d2e65854822c6186b6fbedc52fd8773e672efae984860f6f5a20f893.png" />
</div>
</div>
<p><em>Figure 1: World map showing the tropical belt (20¬∞S‚Äì20¬∞N) and the Sahel region studied in this notebook.</em></p>
</section>
<section id="set-the-data-request">
<h4>Set the data request<a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Region</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Define requests</span>
<span class="n">requests</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">time_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;satellite-precipitation-microwave&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v1_0&quot;</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2018</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;satellite-precipitation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_mean&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v3_3&quot;</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1998</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)],</span>
<span class="p">}</span>
<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;satellite-precipitation-microwave-infrared&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">2023</span><span class="p">)],</span>
<span class="p">}</span>

<span class="c1"># Download</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reindex_coords</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">instruments</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SSMI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SSMIS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MHS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AMSU-B&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TMI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;AMSR-E&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">platforms</span> <span class="o">=</span> <span class="n">platforms</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;noaa15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noaa16&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noaa17&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noaa18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noaa19&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f13&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f14&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f16&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f17&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;aqua&quot;</span><span class="p">,</span>
        <span class="s2">&quot;trmm&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;instrument_id&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">instrument_id</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instruments</span><span class="p">)))</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;instrument_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;instrument_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;instrument_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;instrument_id&quot;</span><span class="p">,</span> <span class="n">instruments</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;instrument_name&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;platform_id&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">platform_id</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">platforms</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;platform_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;platform_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;platform_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;platform_id&quot;</span><span class="p">,</span> <span class="n">platforms</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;platform_name&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-the-dataset">
<span id="satellite-satellite-precipitation-validation-q01-section-2"></span><h3>Download the dataset<a class="headerlink" href="#download-the-dataset" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span>
            <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">preprocess</span><span class="o">=</span><span class="n">reindex_coords</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1">#ds_GPCP = download.download_and_transform(</span>
<span class="c1">#    collection_id,</span>
<span class="c1">#    download.update_request_date(request, start, stop, stringify_dates=True),</span>
<span class="c1">#    chunks=chunks,</span>
<span class="c1">#)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>collection_id=&#39;satellite-precipitation-microwave&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 216/216 [00:15&lt;00:00, 14.06it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>collection_id=&#39;satellite-precipitation&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 300/300 [00:15&lt;00:00, 19.81it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>collection_id=&#39;satellite-precipitation-microwave-infrared&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 252/252 [00:14&lt;00:00, 17.64it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="daily-precipitation-climatology">
<span id="satellite-satellite-precipitation-validation-q01-section-3"></span><h3>Daily precipitation climatology<a class="headerlink" href="#daily-precipitation-climatology" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave-infrared&#39;</span> <span class="p">:</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lat_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2013-12-31&quot;</span> <span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lat_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2013-12-31&quot;</span> <span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            
            <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">],</span><span class="n">da</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">precipitation_product</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;20¬∞N-20¬∞S&#39;</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave-infrared&#39;</span> <span class="p">:</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lat_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lon_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2013-12-31&quot;</span> <span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lat_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">,</span><span class="n">lon_max</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2013-12-31&quot;</span> <span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            
            <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;dayofyear&#39;</span><span class="p">],</span><span class="n">da</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">precipitation_product</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sahel&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Day of the year&quot;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;mm/day&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/42bd65ee7d990b92b83e41fb4438a27358540ddac3ac60aa06123cd16929ea8e.png" src="../../_images/42bd65ee7d990b92b83e41fb4438a27358540ddac3ac60aa06123cd16929ea8e.png" />
</div>
</div>
<p><em>Figure 2 : Climatological (2001-2013) annual cycle of daily precipitation (mm/day) over 20¬∞N-20¬∞S (upper panel) and over Sahel region (lower panel) for each precipitation product.</em></p>
<p>Over both regions, each precipitation product appears to exhibit the same paterns with an existing bias more or less important between them. These biases vary depending on the type of surface, as can be seen over the Sahel region. The existence of these biases and their variabilities have already been documented between GIRAFE-GPCP (3.2) <a class="reference external" href="https://essd.copernicus.org/articles/17/4097/2025/essd-17-4097-2025.html" rel="noreferrer" target="_blank">[5]</a> and COBRA-GPCP (1.3) in the confluence page of COBRA : <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=278552380#COBRA:ProductQualityAssessmentReport(PQAR)-section2_3_22.3.2Comparisonwithglobaldatasets" rel="noreferrer" target="_blank"><strong>Product Quality Assessement Report (PQAR)</strong></a>.
The climatological annual cycle over 20¬∞N-20¬∞S of all three products are in the range seen in the literature and present the same pattern. It is interesting to note that over the Sahel region, all three products also present the same pattern as over the 20¬∞N-50¬∞N  but with a slightly shifted maximum <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1748-9326/ab6a22" rel="noreferrer" target="_blank">[6]</a>.</p>
</section>
<section id="long-term-trend-and-uncertainty">
<span id="satellite-satellite-precipitation-validation-q01-section-4"></span><h3>Long term trend and uncertainty<a class="headerlink" href="#long-term-trend-and-uncertainty" title="Link to this heading">#</a></h3>
<section id="compute-the-year-average-precipitation-and-fitting-the-data">
<h4>Compute the year average precipitation and fitting the data<a class="headerlink" href="#compute-the-year-average-precipitation-and-fitting-the-data" title="Link to this heading">#</a></h4>
</section>
<section id="results">
<h4>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h4>
<p>We are assuming the errors to be independent. Thus, we perform a quadratic mean.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">:</span> 
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">enumerate</span> <span class="p">(</span><span class="n">datasets</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">setup_print</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;tau&quot;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;P&quot;</span> <span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;confidence&quot;</span> <span class="p">:</span> <span class="p">[]}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave&#39;</span> <span class="p">:</span>
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip_stdv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave-infrared&#39;</span> <span class="p">:</span> 
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;sampling_error&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation&#39;</span> <span class="p">:</span>
                    <span class="n">da_error</span> <span class="o">=</span>  <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span> <span class="o">/</span> <span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">365</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                     
            <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="mi">1</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave&#39;</span> <span class="p">:</span>
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip_stdv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation-microwave-infrared&#39;</span> <span class="p">:</span> 
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;sampling_error&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precipitation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s1">&#39;satellite-precipitation&#39;</span> <span class="p">:</span>
                    <span class="n">da_error</span> <span class="o">=</span>  <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span>
                    <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span> <span class="o">/</span> <span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">365</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
                    <span class="n">ds_precip</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">][</span><span class="s1">&#39;precip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">time</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2017-12-31&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                    
            <span class="k">if</span> <span class="n">product</span> <span class="o">!=</span> <span class="s1">&#39;satellite-precipitation&#39;</span>  <span class="p">:</span>
                <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span>  <span class="o">**</span> <span class="mi">2</span>
                <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;YE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span>  <span class="o">**</span> <span class="mf">0.5</span>
                <span class="n">da_error</span> <span class="o">=</span> <span class="n">da_error</span> <span class="o">/</span> <span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="n">datasets</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lon_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">lon_max</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">latitude</span> <span class="o">=</span> <span class="nb">slice</span> <span class="p">(</span><span class="n">lat_min</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">lat_max</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">365</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
          
    
            <span class="n">X</span> <span class="o">=</span> <span class="n">ds_precip</span><span class="p">[</span><span class="s1">&#39;time.year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> 
            <span class="n">P</span> <span class="o">=</span> <span class="n">ds_precip</span><span class="o">.</span><span class="n">data</span>
            <span class="n">Perr</span> <span class="o">=</span> <span class="n">da_error</span><span class="o">.</span><span class="n">data</span>
            
            <span class="c1"># Linear Model to fit</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">linear_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
            
            <span class="c1"># Perform the fit, using weights as the inverse of the uncertainties</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">linear_model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">Perr</span><span class="p">,</span> <span class="n">absolute_sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="c1"># Extract the fitting parameters</span>
            <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">popt</span>
            
            <span class="c1"># Calculate the uncertainties in the fitting parameters</span>
            <span class="n">perr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">pcov</span><span class="p">))</span>
            <span class="n">slope_err</span> <span class="o">=</span> <span class="n">perr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            
            <span class="c1"># Correction due to autocorrelation</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">P</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">phi</span><span class="p">))</span>
            <span class="n">slope_err</span> <span class="o">=</span> <span class="n">slope_err</span> <span class="o">*</span> <span class="n">k</span>
            
            
            <span class="c1"># Calculate the 95% confidence interval for the slope</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># 95% confidence level</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>  <span class="c1"># Number of data points</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">popt</span><span class="p">)</span>  <span class="c1"># Number of parameters</span>
            <span class="n">dof</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># Degrees of freedom</span>
            <span class="n">t_val</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>  <span class="c1"># T-value for the 95% confidence interval</span>
            <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">t_val</span> <span class="o">*</span> <span class="n">slope_err</span>  <span class="c1"># confidence interval</span>
        
            <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">Perr</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                     <span class="n">capsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_point</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">capthick</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
            <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">*</span><span class="n">popt</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">color_curve</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">precipitation_product</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s1"> years Trend: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> ¬± </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">slope_err</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1"> mm/day / decade&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;20¬∞N-20¬∞S&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sahel&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;precipitation [mm/day]&#39;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
            <span class="n">tau</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">kendalltau</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>

            <span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">precipitation_product</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2"> years&quot;</span><span class="p">)</span>
            <span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
            <span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
            <span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">slope</span> <span class="o">-</span> <span class="n">confidence_interval</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span><span class="n">slope</span> <span class="o">+</span> <span class="n">confidence_interval</span><span class="o">.</span><span class="n">compute</span><span class="p">()])</span>
            
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;20¬∞N-20¬∞S</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sahel</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">^210</span><span class="si">}</span><span class="s2">&quot;</span> <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kendall&#39;s tau: </span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">^160</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">^190</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;95% confidence interval for the slope: </span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">setup_print</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20¬∞N-20¬∞S

COBRA 18 years                                                                                                   COBRA 16 years                                                                                                  
Kendall&#39;s tau: 0.09803921568627452                                                                              -0.15                                                                              
P-value: 0.6009311332228355                                                                                      0.45028488627204627                                                                                      
95% confidence interval for the slope: [np.float64(0.0042269686714095445), np.float64(0.005382611121273389)] 	[np.float64(-0.002590329646249522), np.float64(-0.001411808636107526)]


GPCP 25 years                                                                                                   GPCP 16 years                                                                                                   
Kendall&#39;s tau: 0.05999999999999999                                                                               0.0                                                                               
P-value: 0.6943423762297564                                                                                              1.0                                                                                              
95% confidence interval for the slope: [np.float64(0.0024050547249787994), np.float64(0.0028069092429464145)] 	[np.float64(0.0007342567108860575), np.float64(0.001799143127146268)]


GIRAFE 21 years                                                                                                  GIRAFE 16 years                                                                                                  
Kendall&#39;s tau: -0.06666666666666667                                                                       0.06666666666666667                                                                       
P-value: 0.6981882790943121                                                                                       0.7565550254451803                                                                                      
95% confidence interval for the slope: [np.float64(-0.00045015418253929615), np.float64(-0.00029719062815141594)] 	[np.float64(0.003720533011538342), np.float64(0.003949934116540205)]


Sahel

COBRA 18 years                                                                                                   COBRA 16 years                                                                                                  
Kendall&#39;s tau: 0.411764705882353                                                                       0.31666666666666665                                                                       
P-value: 0.017207715883354357                                                                                      0.09604970873347041                                                                                      
95% confidence interval for the slope: [np.float64(0.010735517889555977), np.float64(0.01333878371854047)] 	[np.float64(0.008949978732408189), np.float64(0.010837452383308634)]


GPCP 25 years                                                                                                   GPCP 16 years                                                                                                   
Kendall&#39;s tau: 0.15999999999999995                                                                       0.06666666666666667                                                                       
P-value: 0.27546798247377474                                                                                       0.7565550254451803                                                                                      
95% confidence interval for the slope: [np.float64(0.004221410829999773), np.float64(0.004668153553027666)] 	[np.float64(0.0041367629748654995), np.float64(0.004510206350256571)]


GIRAFE 21 years                                                                                                  GIRAFE 16 years                                                                                                  
Kendall&#39;s tau: 0.14285714285714285                                                                       -0.21666666666666667                                                                      
P-value: 0.3857814338605447                                                                                      0.26504598877832025                                                                                      
95% confidence interval for the slope: [np.float64(0.0038832766636291835), np.float64(0.004235017056789372)] 	[np.float64(-0.008262930093228461), np.float64(-0.007859295646921737)]
</pre></div>
</div>
<img alt="../../_images/0546516299bde44bdea3bd631ba62cda679affb3b10f176d165473cdb6394c3f.png" src="../../_images/0546516299bde44bdea3bd631ba62cda679affb3b10f176d165473cdb6394c3f.png" />
</div>
</div>
<p><em>Figure 3 : linear fit of precipitation data over time for each product : GIRAFE, COBRA and GPCP over 20¬∞N-20¬∞S region (upper panel) and Sahel region (lower panel). The colored squares represent the observed precipitation values, while the gray error bars correspond to two times the uncertainty of each measurement. The colored lines are the best-fit linear model for the data, indicating the trend in precipitation over each period. Each trend value is reported in the legend with the 95% confidence interval. The tau value, the P-value and 95% confidence interval for the slop are given above the figure for each product, each period and each region.</em></p>
<p>Over the 20¬∞N-20¬∞S region, all three products show mostly positive trends relatively close for both periods except for GIRAFE for its respective period and COBRA for the common period. Their uncertainties are of the same order of magnitude for both periods, except for GIRAFE, which are much lower.</p>
<p>Over the Sahel region, all three products also show mostly positive trends for both periods except for GIRAFE concerning the common period. Compared to the other products, COBRA shows positive trends relatively much higher for both periods. The uncertainties are again of the same magnitude for both periods, except for COBRA, which are much higher.</p>
<p>GPCP is more stable from one period to another concerning its trends in both regions compared to GIRAFE and COBRA. Only COBRA shows different uncertainties from one region to another.</p>
<p>The analysis of the precipitation trend using Kendall‚Äôs tau test yields positive tau values, which indicate a positive association, suggesting that precipitation increases with time over both regions.
Overall, the trend values and their uncertainties of each product over the Sahel region are relatively close to those reported in the literature [<a class="reference external" href="https://doi.org/10.1007/s00382-022-06567-9" rel="noreferrer" target="_blank">2</a>, <a class="reference external" href="https://doi.org/10.1002/wcc.591" rel="noreferrer" target="_blank">3</a>].</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entry for the data used is:</p>
<ul class="simple">
<li><p>Precipitation monthly and daily gridded data from 1979 to present derived from satellite measurements:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-precipitation?tab=overview</a></p></li>
<li><p>Daily and monthly Global Interpolated RAinFall Estimation (GIRAFE) data derived from satellite observations:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave-infrared?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave-infrared?tab=overview</a></p></li>
<li><p>Precipitation monthly and daily gridded data from 2000 to 2017 derived from satellite microwave observations:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-precipitation-microwave?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="reference-useful-material">
<h3>Reference/Useful material<a class="headerlink" href="#reference-useful-material" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.3390/atmos9040138" rel="noreferrer" target="_blank">[1]</a> Adler, R.F.; Sapiano, M.R.P.; Huffman, G.J.; Wang, J.-J.; Gu, G.; Bolvin, D.; Chiu, L.; Schneider, U.; Becker, A.; Nelkin, E.; et al. The Global Precipitation Climatology Project (GPCP) Monthly Analysis (New Version 2.3) and a Review of 2017 Global Precipitation. Atmosphere 2018, 9, 138. <a class="reference external" href="https://doi.org/10.3390/atmos9040138" rel="noreferrer" target="_blank">https://doi.org/10.3390/atmos9040138</a></p>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-022-06567-9" rel="noreferrer" target="_blank">[2]</a> Gu, G., Adler, R.F. Observed variability and trends in global precipitation during 1979‚Äì2020. Clim Dyn 61, 131‚Äì150 (2023). <a class="reference external" href="https://doi.org/10.1007/s00382-022-06567-9" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00382-022-06567-9</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/wcc.591" rel="noreferrer" target="_blank">[3]</a> Biasutti M. Rainfall trends in the African Sahel: Characteristics, processes, and causes. WIREs Clim Change. 2019; 10:e591. <a class="reference external" href="https://doi.org/10.1002/wcc.591" rel="noreferrer" target="_blank">https://doi.org/10.1002/wcc.591</a></p>
<p><a class="reference external" href="https://doi.org/10.1029/98JD00995" rel="noreferrer" target="_blank">[4]</a> Weatherhead, E. C., Reinsel, G. C., Tiao, G. C., Meng, X.-L., Choi, D., Cheang, W.-K., Keller, T., DeLuisi, J., Wuebbles, D. J., Kerr, J. B., Miller, A. J., Oltmans, S. J., and Frederick, J. E.: Factors af-
fecting the detection of trends: Statistical considerations and applications to environmental data, J. Geophys. Res.-Atmos., 103, 17149‚Äì17161, <a class="reference external" href="https://doi.org/10.1029/98JD00995" rel="noreferrer" target="_blank">https://doi.org/10.1029/98JD00995</a>, 1998.</p>
<p><a class="reference external" href="https://essd.copernicus.org/articles/17/4097/2025/essd-17-4097-2025.html" rel="noreferrer" target="_blank">[5]</a> Konrad, H., Roca, R., Niedorf, A., Finkensieper, S., Schr√∂der, M., Cloch√©, S., Panegrossi, G., San√≤, P., Kidd, C., Juc√° Oliveira, R. A., Fennig, K., Sikorski, T., Lemoine, M., and Hollmann, R.: GIRAFE v1: a global climate data record for precipitation accompanied by a daily sampling uncertainty, Earth Syst. Sci. Data, 17, 4097‚Äì4124, <a class="reference external" href="https://doi.org/10.5194/essd-17-4097-2025" rel="noreferrer" target="_blank">https://doi.org/10.5194/essd-17-4097-2025</a>, 2025.</p>
<p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/1748-9326/ab6a22" rel="noreferrer" target="_blank">[6]</a> Margot Bador, Lisa V Alexander, Steefan Contractor and Remy Roca: Diverse estimates of annual maxima daily precipitation in 22 state-of-the-art quasi-global land observation datasets, Environ. Res. Lett. 15 035005, <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1748-9326/ab6a22" rel="noreferrer" target="_blank">https://iopscience.iop.org/article/10.1088/1748-9326/ab6a22</a>, 2020.</p>
<p><a class="reference external" href="https://journals.ametsoc.org/view/journals/clim/36/21/JCLI-D-23-0123.1.xml" rel="noreferrer" target="_blank">[7]</a> Huffman, G. J., R. F. Adler, A. Behrangi, D. T. Bolvin, E. J. Nelkin, G. Gu, and M. R. Ehsani, 2023: The New Version 3.2 Global Precipitation Climatology Project (GPCP) Monthly and Daily Precipitation Products. J. Climate, 36, 7635‚Äì7655, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-23-0123.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JCLI-D-23-0123.1</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmosphere_Physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmosphere_Physics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.1. </span>Atmosphere Physics</p>
      </div>
    </a>
    <a class="right-next"
       href="../Atmospheric_Composition/Atmospheric_Composition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-observing-the-regional-evolution-of-rainfall">üåç Use case: Observing the regional evolution of rainfall</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">1. Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-map">Plot the map</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-dataset">Download the dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#daily-precipitation-climatology">Daily precipitation climatology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-term-trend-and-uncertainty">Long term trend and uncertainty</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-year-average-precipitation-and-fitting-the-data">Compute the year average precipitation and fitting the data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-useful-material">Reference/Useful material</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>