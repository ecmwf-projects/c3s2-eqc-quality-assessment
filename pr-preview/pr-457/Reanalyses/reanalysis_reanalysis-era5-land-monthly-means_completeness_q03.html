
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Detecting and Attributing Climate Change Impacts on Global Lake Ice Depth and Mixed-Layer Temperature &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_completeness_q03';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Detecting and Attributing Climate Change Impacts on Global Lake Ice Depth and Mixed-Layer Temperature</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-era5-land-monthly-means_completeness_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-era5-land-monthly-means_completeness_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Detecting and Attributing Climate Change Impacts on Global Lake Ice Depth and Mixed-Layer Temperature</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-reference-product-for-climate-change-detection-and-attribution">🌍 Use case: Reference product for climate change detection and attribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyzed-changes-in-lake-ice-and-temperature">1. Reanalyzed changes in lake ice and temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-change-detection-and-attribution">2. Climate change detection and attribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#suitability-of-era5-land">3. Suitability of ERA5-Land</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="detecting-and-attributing-climate-change-impacts-on-global-lake-ice-depth-and-mixed-layer-temperature">
<h1><span class="section-number">3.1. </span>Detecting and Attributing Climate Change Impacts on Global Lake Ice Depth and Mixed-Layer Temperature<a class="headerlink" href="#detecting-and-attributing-climate-change-impacts-on-global-lake-ice-depth-and-mixed-layer-temperature" title="Link to this heading">#</a></h1>
<p>Production date: 29-09-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-reference-product-for-climate-change-detection-and-attribution">
<h2>🌍 Use case: Reference product for climate change detection and attribution<a class="headerlink" href="#use-case-reference-product-for-climate-change-detection-and-attribution" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can ERA5-Land be used as a reference product in place of observations for climate change detection and atribution of lake ice and temperature changes on a global scale?</strong></p></li>
</ul>
<p>Lakes worldwide are experiencing changes in ice cover and water temperature. Climate change impacts detection and attribution of these changes require long-term, consistent, and spatially extensive datasets, yet direct observations remain sparse, discontinuous, or limited to recent decades. Reanalysis products such as ERA5-Land provide an alternative, offering global coverage at high spatial and temporal resolution and showing strong agreement with in situ and satellite observations. This quality assessment draws on the study by Grant et al. (2021) <em>Attribution of global lake systems change to anthropogenic forcing</em> (Nat. Geosci., 14, 849–854)<a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a>, reviewing specifically the parts where ERA5-Land was used as a reference for historical detection and attribution (excluding future projections). The aim is to assess whether ERA5-Land can reliably serve as a substitute for direct observations in global-scale detection and attribution of climate-driven changes in lake ice and mixed-layer temperature.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>ERA5-Land provides long, continuous, and high-resolution global records that have been validated against in situ and satellite datasets, showing strong agreement for both lake temperature and ice phenology.</p></li>
<li><p>These characteristics make ERA5-Land a suitable reference product for detection and attribution of climate change impacts on lakes globally, especially where direct observations are sparse or discontinuous.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The relevant results to this assessment from Grant et al. (2021) <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a> are presented to highlight the role of ERA5-Land in detection and attribution. First, changes in lake mixed-layer temperature and ice depth from ERA5-Land are shown by comparing a recent period (2010-2019) with a baseline (1981-1990). These changes represent key observations with implications for ecosystems, local weather, and climate impacts. To formally detect the influence of climate change, two approaches were applied: (i) Spearman rank correlation coefficients apporach, and (ii) regularized optimal fingerprinting (ROF), which provides both detection and attribution. Finally, the high temporal and spatial resolution of ERA5-Land is discussed as an important factor supporting its suitability as a reference dataset in attribution studies.</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-1"><span class="std std-ref">1. Reanalyzed changes in lake ice and temperature</span></a></strong></p>
<ul class="simple">
<li><p>Download lake mixed-layer temperature and lake ice depth from ERA5-Land monthly for the periods 2010-2019 and 1981-1990.</p></li>
<li><p>Change in lake mixed-layer temperature from ERA5-Land in the recent period 2010-2019 compared to the baseline period 1981-1990.</p></li>
<li><p>Changes in ice onset, break-up and duration derived from ERA5-Land lake ice depth in the recent period 2010-2019 compared to the baseline period 1981-1990.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-2"><span class="std std-ref">2. Climate change detection and attribution</span></a></strong></p>
<ul class="simple">
<li><p>Detection of climate change impacts using Spearman rank correlation coefficients.</p></li>
<li><p>Detection and attribution using ROF.</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-3"><span class="std std-ref">3. Suitability of ERA5-Land</span></a></strong></p>
<ul class="simple">
<li><p>Review ERA5-Land’s temporal and spatial completeness and its usefulness as a reference product.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="reanalyzed-changes-in-lake-ice-and-temperature">
<span id="reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-1"></span><h3>1. Reanalyzed changes in lake ice and temperature<a class="headerlink" href="#reanalyzed-changes-in-lake-ice-and-temperature" title="Link to this heading">#</a></h3>
<p>Grant et al. (2021) observed that the lake mixed-layer temperature from ERA5-Land in the recent period 2010-2019 compared to the baseline period 1981-1990 had an average global increase of 0.4 °C <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rioxarray</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land-monthly-means&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;lake_ice_depth&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lake_mix_layer_temperature&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1981&quot;</span><span class="p">,</span> <span class="s2">&quot;1982&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1983&quot;</span><span class="p">,</span> <span class="s2">&quot;1984&quot;</span><span class="p">,</span> <span class="s2">&quot;1985&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1986&quot;</span><span class="p">,</span> <span class="s2">&quot;1987&quot;</span><span class="p">,</span> <span class="s2">&quot;1988&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1989&quot;</span><span class="p">,</span> <span class="s2">&quot;1990&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2010&quot;</span><span class="p">,</span> <span class="s2">&quot;2011&quot;</span><span class="p">,</span> <span class="s2">&quot;2012&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2013&quot;</span><span class="p">,</span> <span class="s2">&quot;2014&quot;</span><span class="p">,</span> <span class="s2">&quot;2015&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2016&quot;</span><span class="p">,</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span> <span class="s2">&quot;2018&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2019&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 20/20 [00:02&lt;00:00,  7.80it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/cfgrib/xarray_plugin.py:131: FutureWarning: In a future version, xarray will not decode the variable &#39;step&#39; into a timedelta64 dtype based on the presence of a timedelta-like &#39;units&#39; attribute by default. Instead it will rely on the presence of a timedelta64 &#39;dtype&#39; attribute, which is now xarray&#39;s default way of encoding timedelta64 values.
To continue decoding into a timedelta64 dtype, either set `decode_timedelta=True` when opening this dataset, or add the attribute `dtype=&#39;timedelta64[ns]&#39;` to this variable on disk.
To opt-in to future behavior, set `decode_timedelta=False`.
  vars, attrs, coord_names = xr.conventions.decode_cf_variables(
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shift longitude from 0–360 → -180–180</span>
<span class="n">ds_shifted</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span>

<span class="c1"># Now work with this shifted dataset</span>
<span class="n">da_lmlt</span> <span class="o">=</span> <span class="n">ds_shifted</span><span class="p">[</span><span class="s2">&quot;lmlt&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define baseline and recent periods</span>
<span class="n">baseline_lmlt</span> <span class="o">=</span> <span class="n">da_lmlt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1981-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;1990-12-31&quot;</span><span class="p">))</span>
<span class="n">recent_lmlt</span>   <span class="o">=</span> <span class="n">da_lmlt</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-12-31&quot;</span><span class="p">))</span>

<span class="c1"># Compute climatological seasonal means for each period</span>
<span class="n">baseline_seasonal_lmlt</span> <span class="o">=</span> <span class="n">baseline_lmlt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time.season&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">)</span>
<span class="n">recent_seasonal_lmlt</span>   <span class="o">=</span> <span class="n">recent_lmlt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time.season&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;forecast_reference_time&quot;</span><span class="p">)</span>

<span class="c1"># Difference (recent - baseline)</span>
<span class="n">diff_lmlt</span> <span class="o">=</span> <span class="n">recent_seasonal_lmlt</span> <span class="o">-</span> <span class="n">baseline_seasonal_lmlt</span>

<span class="c1"># Order seasons</span>
<span class="n">seasons_lmlt</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DJF&quot;</span><span class="p">,</span> <span class="s2">&quot;MAM&quot;</span><span class="p">,</span> <span class="s2">&quot;JJA&quot;</span><span class="p">,</span> <span class="s2">&quot;SON&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/VUB-HYDR/2021_Grant_etal/raw/refs/heads/master/python/part1/data/mlt/era5-land_lakes_mixlayertemp_DJF_signal_1981_2019.nc&quot;</span>
<span class="n">local_path</span> <span class="o">=</span> <span class="s2">&quot;era5_land_lakes.nc&quot;</span>

<span class="c1"># Download and save</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># Open with netcdf4 engine</span>
<span class="n">ds_paper</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;netcdf4&quot;</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shift longitude from 0–360 → -180–180</span>
<span class="n">ds_paper_shifted</span> <span class="o">=</span> <span class="n">ds_paper</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">ds_paper</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span>

<span class="c1"># Now work with this shifted dataset</span>
<span class="n">ds_paper_shifted_lmlt</span> <span class="o">=</span> <span class="n">ds_paper_shifted</span><span class="p">[</span><span class="s2">&quot;lmlt&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paper_data</span> <span class="o">=</span> <span class="n">ds_paper_shifted_lmlt</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># first time step</span>

<span class="n">mask_aligned</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">paper_data</span><span class="p">))</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="n">diff_lmlt</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="n">diff_lmlt</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
<span class="p">)</span>

<span class="n">masked_data</span> <span class="o">=</span> <span class="n">diff_lmlt</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask_aligned</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define boundaries (14 boundaries = 13 bins)</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># Define colors (15 colors for 15 bins including extensions)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;#08306b&quot;</span><span class="p">,</span>  <span class="c1"># &lt; -3 (extra darkest blue)</span>
    <span class="s2">&quot;#08519c&quot;</span><span class="p">,</span> <span class="s2">&quot;#2171b5&quot;</span><span class="p">,</span> <span class="s2">&quot;#4292c6&quot;</span><span class="p">,</span> <span class="s2">&quot;#6baed6&quot;</span><span class="p">,</span> <span class="s2">&quot;#9ecae1&quot;</span><span class="p">,</span> <span class="s2">&quot;#c6dbef&quot;</span><span class="p">,</span> <span class="c1"># -2.5 to -0.25</span>
    <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span>                                                <span class="c1"># -0.25 to 0.25</span>
    <span class="s2">&quot;#f8eadf&quot;</span><span class="p">,</span> <span class="s2">&quot;#fedbc7&quot;</span><span class="p">,</span> <span class="s2">&quot;#f9bfa5&quot;</span><span class="p">,</span> <span class="s2">&quot;#e48368&quot;</span><span class="p">,</span> <span class="s2">&quot;#c23c3b&quot;</span><span class="p">,</span> <span class="s2">&quot;#890b26&quot;</span><span class="p">,</span>  <span class="c1"># 0.25 to 3</span>
    <span class="s2">&quot;#70021f&quot;</span>   <span class="c1"># &gt; 3 (extra darkest red)</span>
<span class="p">]</span>

<span class="c1"># Make colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>  <span class="c1"># NaN = white</span>

<span class="c1"># BoundaryNorm with extension</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">seasons_lmlt</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">masked_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
        <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2"> (2010–2019 minus 1981–1990)&quot;</span><span class="p">)</span>

<span class="c1"># Shared colorbar</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">boundaries</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Δ Mixed Layer Temperature (°C)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/wp5/.tmp/ipykernel_316472/2513860882.py:37: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0, 0.9, 1])
</pre></div>
</div>
<img alt="../_images/44550014b92a5481335f9cf866313679174c5f720940cee95ba571cfcddebc09.png" src="../_images/44550014b92a5481335f9cf866313679174c5f720940cee95ba571cfcddebc09.png" />
</div>
</div>
<p><em>Figure 1: Change in lake mixed layer from ERA5-Land in 40 years across baseline (1981-1990) and recent (2010-2019) periods. Replicated from:  Grant et al. (2021) <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a> (Supplementary information)</em></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spatial_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">masked_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># temporal mean (lazy dask object)</span>
<span class="n">avg_temporal</span> <span class="o">=</span> <span class="n">spatial_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">)</span>

<span class="c1"># actually compute it</span>
<span class="n">avg_temporal_value</span> <span class="o">=</span> <span class="n">avg_temporal</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average Δ Mixed Layer Temperature = &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">avg_temporal_value</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span><span class="s2">&quot; °C&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average Δ Mixed Layer Temperature =  0.39  °C
</pre></div>
</div>
</div>
</div>
<p>The lake ice depth variable from ERA5-Land was used to calculate homogenized ice onset, break-up and duration values. The difference between the same baseline and recent periods were computed showing that 130,472 lake grid cells have experienced two weeks of lake ice-loss. On average, lakes lost 9 days of ice-cover according to this analysis.</p>
<p><img alt="fig1.jpg" src="../_images/bdc11b65-c247-48cb-bfcf-6aadbfc0a246.jpg" /></p>
<p><em>Figure 2: a–c, Changes (Δ) in ice onset (a), ice break-up (b) and ice duration (c) in 40 years across baseline (1981–1990) and recent (2010–2019) periods as obtained from ERA5-Land. Source: Grant et al. (2021) <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a></em></p>
<p>The variables lake ice depth and lake mix layer temperature from ERA5-Land were employed by Grant et al. (2021) as a reference product and substitute for observations. It was used as a reference for detection and attribution of climate change impacts.</p>
</section>
<section id="climate-change-detection-and-attribution">
<span id="reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-2"></span><h3>2. Climate change detection and attribution<a class="headerlink" href="#climate-change-detection-and-attribution" title="Link to this heading">#</a></h3>
<p>Global sacale simulations were performed with 5 lake models each forced by 4 global climate models (GSMs). The forcings were carried out under historical (HIST) and a collection of induvidual pre-industrial control (PIC) scenarios.</p>
<p>To perform the detection of climate change impacts, the annual global average of the simulation outputs were computed and them anomalies computed. The same was done for the reference reanalisis product. This was used to perfor detection by two approaches: correlation and regularized optimal fingerprinting (ROF).</p>
<p>Spearman rank correlation coefficients were calculated between chunks of PIC and HIST simulations. A probability density function (PDF) of these coefficients was derived under the assumption of a normal distribution, and 95% and 99% confidence intervals were estimated. This distribution represents the correlations expected under pre-industrial climate variability. In addition, the Spearman correlation was also calculated between HIST and ERA5-Land. These results are shown in Figure 3a–d and demonstrate that the HIST vs. ERA5-Land correlations for all variables are not consistent with what would be expected from pre-industrial climate variability. The HIST vs. ERA5-Land probability density is much higher than what would be expected according to the PIC vs. HIST distribution, for the correlation coefficients respective to HIST vs. ERA5-Land. These correlation coefficients exceed the 99% confidence level in case of water temperature, ice break-up and ice duration, and lie above the 95% confidence level for ice onset.</p>
<p>Figure 3e–h show the anomalies for the different variables over the years. Also, as insets in the subfigures is the single-factor ROF output of comparing HIST to ERA5-Land. If this factor does not everlap with 0, ROF communicates detection. Moreover, if the factor overlaps with 1, “ROF attributes the changes in a given lake variable to all external forcings, revealing that a lake variable’s trend can be explained by historical climate forcings dominated by anthropogenic climate change” <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a>. Therefore, ROF communicates detection of climate change impacts for all variables studied and atribution for lake ice depth related variables, but not for water temperature.</p>
<p><img alt="fig2.jpg" src="../_images/acb63262-e234-4733-90e5-f44661266286.jpg" /></p>
<p><em>Figure 3: a–d, Empirical distribution of correlation coefficients between PIC and HIST for lake temperature (a), ice onset (b), ice break-up (c) and ice duration (d). Red lines show the correlation coefficient between HIST and ERA5-Land. Vertical blue lines mark the 95% and 99% cumulative probability of an assumed normal distribution for the sample of PIC–HIST coefficients. e–h, Global multimodel mean time series and spread (ensemble standard deviation) for PIC and HIST forced response patterns and ERA5-Land smoothed by a 5 yr running mean for lake temperature (e), ice onset (f), ice break-up (g) and ice duration (h). Results of single-factor ROF output on HIST are displayed in insets. Scaling factor confidence intervals denote their 2.5–97.5% uncertainty range and infer detection when excluding the 0 line. Attribution is achieved when confidence intervals additionally include unity. Source: Grant et al. (2021) <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a></em></p>
<p>Water temperature changes were not formally attributed, as Figure 3e shows that the HIST simulations consistently overestimate anomalies compared with the ERA5-Land reference. Since ERA5-Land has been evaluated against observations and shown strong agreement, the discrepancy is more likely due to issues within the ISIMIP lake simulations. Grant et al. (2021) <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a> identified these three factors presented in the supplementary information section:</p>
<ul class="simple">
<li><p>Lake depth fields: Both ERA5-Land and ISIMIP use the Global Lake Depth Database (GLDB), but ERA5-Land relies on version 3, which contains more accurate and extensive information, while ISIMIP employs version 1,</p></li>
<li><p>Water transparency: ERA5-Land applies a fixed light extinction coefficient of 3, representing turbid brown water, whereas ISIMIP parameterizations vary by lake depth or, in one case, particulate organic matter.</p></li>
<li><p>ISIMIP meteorological forcing: Although corrected for long-term statistics of observations, the atmospheric variables are not corrected for potential biases in trends.</p></li>
</ul>
</section>
<section id="suitability-of-era5-land">
<span id="reanalysis-reanalysis-era5-land-monthly-means-completeness-q03-section-3"></span><h3>3. Suitability of ERA5-Land<a class="headerlink" href="#suitability-of-era5-land" title="Link to this heading">#</a></h3>
<p>ERA5-Land provides global coverage from January 1950 to the present at hourly resolution and is updated daily. Its finer spatial resolution (0.1°, ~9 km) offers more detailed representation of local climate than coarser reanalyses such as ERA5, making it particularly suitable for lake studies. These characteristics make ERA5-Land a valid reference product for detection and attribution studies, which require sufficiently long time periods for the climate signal to emerge clearly above annual and decadal variability <a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a>. In contrast, satellite products are limited to more recent decades and contain some temporal gaps, for example due to cloud and water vapor interference. Because of these temporal limitations and discontinuities in satellite records, ERA5-Land offers a more consistent and extended dataset and is therefore a strong candidate for use as the reference in attribution analyses.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>J. Muñoz-Sabater, Dutra, E., Agustí-Panareda, A., Albergel, C., Arduini, G., Balsamo, G., Boussetta, S., Choulga, M., Harrigan, S., Hersbach, H., Martens, B., Miralles, D. G., Piles, M., Rodríguez-Fernández, N. J., Zsoter, E., Buontempo, C., &amp; Thépaut, J.-N. (2021) ERA5-Land: A state-of-the-art global reanalysis dataset for land applications, Earth Syst. Sci. Data,13, 4349–4383. <a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021" rel="noreferrer" target="_blank"></a>.</p></li>
<li><p>Bindoff, N.L., P.A. Stott, K.M. AchutaRao, M.R. Allen, N. Gillett, D. Gutzler, K. Hansingo, G. Hegerl, Y. Hu, S. Jain, I.I.
Mokhov, J. Overland, J. Perlwitz, R. Sebbari &amp; X. Zhang. (2013) Detection and Attribution of Climate Change:
from Global to Regional. In: Climate Change 2013: The Physical Science Basis. Contribution of Working Group
I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change Stocker, T.F., D. Qin, G.-K.
Plattner, M. Tignor, S.K. Allen, J. Boschung, A. Nauels, Y. Xia, V. Bex and P.M. Midgley (eds.). Cambridge University
Press, Cambridge, United Kingdom and New York, NY, USA. <a class="reference external" href="https://www.ipcc.ch/site/assets/uploads/2018/02/WG1AR5_Chapter10_FINAL.pdf" rel="noreferrer" target="_blank"></a>.</p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1038/s41561-021-00833-x" rel="noreferrer" target="_blank">[1]</a> Grant, L., Vanderkelen, I., Gudmundsson, L., Tan, Z., Perroud, M., Stepanenko, V. M., Debolskiy, A. V., Droppers, B., Janssen, A. B. G., Woolway, R. I., Choulga, M., Balsamo, G., Kirillin, G., Schewe, J., Zhao, F., Vega del Valle, I., Golub, M., Pierson, D., Marcé, R., Seneviratne, S. I., &amp; Thiery, W. (2021) Attribution of global lake systems change to anthropogenic forcing. Nat. Geosci. 14, 849–854.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-reference-product-for-climate-change-detection-and-attribution">🌍 Use case: Reference product for climate change detection and attribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reanalyzed-changes-in-lake-ice-and-temperature">1. Reanalyzed changes in lake ice and temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-change-detection-and-attribution">2. Climate change detection and attribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#suitability-of-era5-land">3. Suitability of ERA5-Land</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>