
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4.1. Satellite Land Cover completeness for Spatial Planning and Land Management &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_consistency-assessment_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5. Land Hydrology" href="../Land_Hydrology/Land_Hydrology.html" />
    <link rel="prev" title="1.4. Land Biosphere" href="Land_Biosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Biosphere.html">1.4. Land Biosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.4.1. Satellite Land Cover completeness for Spatial Planning and Land Management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_consistency-assessment_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_consistency-assessment_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite Land Cover completeness for Spatial Planning and Land Management</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-monitor-land-cover-lc-changes">🌍 Use case: Using land cover products to monitor Land Cover (LC) changes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data">1. Define the AoI, search and download LC data.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data">2. Inspect and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#label-color-definition-and-class-correspondence">Label Color Definition and Class Correspondence</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-maps">Plot maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-total-area-and-area-percentage-of-change-in-for-aoi-by-lc-classes">3. Calculate total area and area percentage of change in for AoI by LC classes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-charts-iberian-peninsula">Bar Charts - Iberian Peninsula</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-analysis">Plot Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-area-percentage-and-the-area-percentage-change-for-the-most-populated-regions">4. Calculate the area percentage and the area percentage change for the most populated regions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-percentage-area-absolute-change-and-relative-percentage-change-for-each-ipcc-class-category">Calculation of the percentage area, absolute change, and relative percentage change for each IPCC class category</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-chart-analysis"><strong>Bar Chart Analysis</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-eurostat-artificial-land-data">Comparison with EUROSTAT Artificial Land Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">5. Main Takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-land-cover-completeness-for-spatial-planning-and-land-management">
<h1><span class="section-number">1.4.1. </span>Satellite Land Cover completeness for Spatial Planning and Land Management<a class="headerlink" href="#satellite-land-cover-completeness-for-spatial-planning-and-land-management" title="Link to this heading">#</a></h1>
<p>Production date: 22-10-2024</p>
<p>Produced by: Luís Figueiredo e Inês Girão (+ATLANTIC)</p>
<section id="use-case-using-land-cover-products-to-monitor-land-cover-lc-changes">
<h2>🌍 Use case: Using land cover products to monitor Land Cover (LC) changes<a class="headerlink" href="#use-case-using-land-cover-products-to-monitor-land-cover-lc-changes" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How consistent with other datasets are satellite observations in capturing land cover changes, such as urbanisation?</strong></p></li>
</ul>
<p>Land cover data is a vital resource across a wide range of fields, from climate change research to urban and regional planning. Products with long historical timelines allow scientists, policymakers, and planners to assess how land use and land cover have evolved over time, supporting evidence-based decision-making.</p>
<p>In this notebook, we use the <em><strong>Land Cover Classification Gridded Maps from 1992 to present derived from satellite observations</strong></em> (hereafter referred to as <strong>LC</strong>) provided by the Climate Data Store (CDS) of the <a class="reference external" href="https://climate.copernicus.eu/esotc/2023" rel="noreferrer" target="_blank">Copernicus Climate Change Service (C3S)</a>. The analysis focuses on evaluating the consistency of C3S-derived settlement (Artificial Land) classes with independent statistical records from <strong>EUROSTAT</strong>, across selected years and NUTS2 regions in the Iberian Peninsula.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The dataset demonstrates physical consistency and precision among the different datasets as it aligns closely with equivalent statistics from official sources <a class="reference external" href="https://ec.europa.eu/eurostat/databrowser/bookmark/63d3fd90-2f5b-4bec-99f3-4f88814e2624?lang=en" rel="noreferrer" target="_blank">(EUROSTAT,2025)</a>. Specifically, the analysis shows that the Urban/Settlements category closely matches EUROSTAT’s statistics for the Artificial Land category in the most populated NUTs 2 regions. Differences are typically small, within 0.3–5% absolute difference for the majority of regions and years assessed.</p></li>
<li><p>Beyond the scope of this analysis, additional work could examine whether the dataset aligns with findings reported in peer-reviewed studies, such as <a class="reference external" href="https://doi.org/10.1016/j.apgeog.2009.07.003" rel="noreferrer" target="_blank">Fernández-Nogueira and Corbelle-Rico (2018)</a>. This would help validate the robustness and reliability of the dataset through comparison with multiple datasets.</p></li>
<li><p>Another aspect of the analysis supporting the dataset’s precision is the identification of trade-offs between urban expansion and the decline of agricultural areas, a well-documented phenomenon. Numerous studies, including observations across multiple European regions, note that urban growth frequently replaces agricultural lands <a class="reference external" href="https://doi.org/10.1088/1748-9326/9/6/064015" rel="noreferrer" target="_blank">Bagan and Yamagata (2014)</a>.</p></li>
</ul>
</div>
<p><img alt="Urbanization_Map_Series_v2.png" src="../../_images/Urbanization_Map_Series_v2.png" /></p>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-consistency-assessment-q01-code-section-1"><span class="std std-ref">1. Define the AoI, search and download LC data.</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-consistency-assessment-q01-code-section-2"><span class="std std-ref">2. Inspect and view data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-consistency-assessment-q01-code-section-3"><span class="std std-ref">3. Calculate total area and area percentage of change in for AoI by LC classes</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-consistency-assessment-q01-code-section-4"><span class="std std-ref">4. Calculate the area percentage and the area percentage change for the most populated regions</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-consistency-assessment-q01-code-section-5"><span class="std std-ref">5. Main Takeaways</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="define-the-aoi-search-and-download-lc-data">
<span id="satellite-satellite-land-cover-consistency-assessment-q01-code-section-1"></span><h3>1. Define the AoI, search and download LC data.<a class="headerlink" href="#define-the-aoi-search-and-download-lc-data" title="Link to this heading">#</a></h3>
<p>Before we begin we must prepare our environment. This includes installing the Application Programming Interface (API) of the CDS, and importing the various python libraries that we will need.</p>
<section id="import-all-the-libraries-packages">
<h4>Import all the libraries/packages<a class="headerlink" href="#import-all-the-libraries-packages" title="Link to this heading">#</a></h4>
<p>We will be working with data in NetCDF format. To best handle this type of data we will use libraries for working with multidimensional arrays, in particular Xarray.
We will also need libraries for plotting and viewing data.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span> <span class="c1"># import vector geospatial data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span> <span class="c1"># plot graphs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1"># perform trigonometric calculations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span> <span class="c1"># work with geometric shapes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span> <span class="c1"># transform attributes and geometries into specific regions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.vectorized</span><span class="w"> </span><span class="kn">import</span> <span class="n">contains</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span> <span class="c1"># predifined style of all graphical outputs</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-overview">
<h4>Data Overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h4>
<p>To search for data, visit the CDS website: <a class="reference external" href="http://cds.climate.copernicus.eu" rel="noreferrer" target="_blank">http://cds.climate.copernicus.eu</a> Here you can search for ‘Satellite observations land’ using the search bar. The data we need for this tutorial is the <em><strong>Land cover classification gridded maps from 1992 to present derived from satellite observations</strong></em>. This catalogue entry provides global Land Cover Classification (LCC) maps with a very high spatial resolution, with a L4 processing level, on an annual basis with a one-year delay, following the <a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245" rel="noreferrer" target="_blank">Global Climate Observing System(GCOS) convention requirements</a>.  These Land Cover (LC) maps correspond to a global classification scheme encompassing 22 land cover classes.</p>
<p><strong>Note:</strong> Although the dataset is officially described as having 22 global land cover classes, many of these classes are internally subdivided into more detailed subcategories (e.g., types of cropland, forest canopy structure, types of shrubland). These subdivisions allow for greater ecological detail but can be aggregated back into the 22 main classes for standard analysis and intercomparison purposes.</p>
<p>Data specifications for this use case:</p>
<ul class="simple">
<li><p><strong>Years:</strong> 2009, 2012, 2015, and 2018</p></li>
<li><p><strong>Versions:</strong> v2.0.7 for years up to 2015; v2.1.1 for 2018</p></li>
<li><p><strong>Format:</strong> Downloaded as .zip files</p></li>
</ul>
<p>At the end of the data request form on CDS, select <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">API</span> <span class="pre">request</span></code> to generate Python code, which can be pasted directly into a Jupyter Notebook cell. Running this cell will retrieve the requested files, provided that you have accepted the dataset’s <code class="docutils literal notranslate"><span class="pre">terms</span> <span class="pre">and</span> <span class="pre">conditions</span></code> on the CDS platform. It is advisable to define the desired time period and Area of Interest (AoI) explicitly when preparing the API request, as shown in the example cells below.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Years to download</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2009</span><span class="p">,</span><span class="mi">2012</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2018</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of requests to retrieve data</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-land-cover&quot;</span>
<span class="n">requests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2_0_7cds&quot;</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2016</span> <span class="k">else</span> <span class="s2">&quot;v2_1_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Region of interest (Iberian Peninsula)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and regionalize by AoI</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/4 [00:00&lt;?, ?it/s]2025-04-29 17:43:39,005 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:43:39,007 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:43:39,009 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:43:39,214 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:43:39,216 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:43:39,217 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:43:39,652 INFO Request ID is 62702611-0b50-4cff-87de-32574e74cffb
2025-04-29 17:43:39,751 INFO status has been updated to accepted
2025-04-29 17:44:01,457 INFO status has been updated to running
2025-04-29 17:44:14,530 INFO status has been updated to successful
 25%|██▌       | 1/4 [00:38&lt;01:55, 38.51s/it]2025-04-29 17:44:17,397 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:44:17,399 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:44:17,401 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:44:17,612 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:44:17,612 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:44:17,613 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:44:18,106 INFO Request ID is 3c67d48d-10bf-48ce-a355-26ece748377c
2025-04-29 17:44:18,196 INFO status has been updated to accepted
2025-04-29 17:45:09,337 INFO status has been updated to successful
 50%|█████     | 2/4 [01:41&lt;01:46, 53.11s/it]2025-04-29 17:45:20,679 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:45:20,682 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:45:20,684 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:45:20,890 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:45:20,892 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:45:20,894 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:45:21,453 INFO Request ID is 491f01b9-85f4-4379-9b5d-6f02f9e770dc
2025-04-29 17:45:21,542 INFO status has been updated to accepted
2025-04-29 17:45:43,061 INFO status has been updated to running
2025-04-29 17:45:56,036 INFO status has been updated to successful
 75%|███████▌  | 3/4 [02:19&lt;00:46, 46.05s/it]2025-04-29 17:45:58,343 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:45:58,344 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:45:58,345 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:45:58,548 WARNING [2025-04-29T00:00:00] Multiple maintenance sessions are planned this week, which may affect data downloads and other services. Check [here](https://status.ecmwf.int/) for status updates.
2025-04-29 17:45:58,548 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-29 17:45:58,549 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-29 17:45:58,951 INFO Request ID is 1a93ffe8-bff0-45e0-8d58-7590abdaa5a9
2025-04-29 17:45:59,054 INFO status has been updated to accepted
2025-04-29 17:46:20,299 INFO status has been updated to successful
100%|██████████| 4/4 [02:44&lt;00:00, 41.23s/it]
/tmp/ipykernel_1102/3410308190.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  ds = ds.assign_coords(year=ds[&quot;time&quot;].dt.year).swap_dims(time=&quot;year&quot;).drop(&quot;time&quot;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="inspect-and-view-data">
<span id="satellite-satellite-land-cover-consistency-assessment-q01-code-section-2"></span><h3>2. Inspect and view data<a class="headerlink" href="#inspect-and-view-data" title="Link to this heading">#</a></h3>
<p>Now that we have downloaded the data, we can inspect it. We have requested the data in NetCDF format. This is a commonly used format for array-oriented scientific data. To read and process this data we will make use of the Xarray library. Xarray is an open source project and Python package that makes working with labelled multi-dimensional arrays simple and efficient. We will read the data from our NetCDF file into an xarray.</p>
<section id="label-color-definition-and-class-correspondence">
<h4>Label Color Definition and Class Correspondence<a class="headerlink" href="#label-color-definition-and-class-correspondence" title="Link to this heading">#</a></h4>
<p>To facilitate visual inspection of the Land Cover (LC) classes, we define a dictionary containing each class label (the “keys”), the corresponding color code (the “colors”), and the associated numeric identifier (the “values”). In addition, we create a second dictionary to establish the correspondence between the original land cover classes provided in the metadata and the aggregated IPCC classes, as described in the Product User Guide (see resources).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define LC labels dictionary</span>
<span class="n">keys</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lccs_class</span><span class="o">.</span><span class="n">flag_meanings</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lccs_class</span><span class="o">.</span><span class="n">flag_colors</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">element</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>
<span class="n">colors</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">lccs_class</span><span class="o">.</span><span class="n">flag_values</span>

<span class="n">lccs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">values</span><span class="p">)}</span>

<span class="c1"># Helper function to format the labels text</span>
<span class="k">def</span><span class="w"> </span><span class="nf">format_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

<span class="n">lccs_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">format_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">lccs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">lccs_dict</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;No Data&#39;: (&#39;#000000&#39;, 0),
 &#39;Cropland Rainfed&#39;: (&#39;#ffff64&#39;, 10),
 &#39;Cropland Rainfed Herbaceous Cover&#39;: (&#39;#ffff64&#39;, 11),
 &#39;Cropland Rainfed Tree Or Shrub Cover&#39;: (&#39;#ffff00&#39;, 12),
 &#39;Cropland Irrigated&#39;: (&#39;#aaf0f0&#39;, 20),
 &#39;Mosaic Cropland&#39;: (&#39;#dcf064&#39;, 30),
 &#39;Mosaic Natural Vegetation&#39;: (&#39;#c8c864&#39;, 40),
 &#39;Tree Broadleaved Evergreen Closed To Open&#39;: (&#39;#006400&#39;, 50),
 &#39;Tree Broadleaved Deciduous Closed To Open&#39;: (&#39;#00a000&#39;, 60),
 &#39;Tree Broadleaved Deciduous Closed&#39;: (&#39;#00a000&#39;, 61),
 &#39;Tree Broadleaved Deciduous Open&#39;: (&#39;#aac800&#39;, 62),
 &#39;Tree Needleleaved Evergreen Closed To Open&#39;: (&#39;#003c00&#39;, 70),
 &#39;Tree Needleleaved Evergreen Closed&#39;: (&#39;#003c00&#39;, 71),
 &#39;Tree Needleleaved Evergreen Open&#39;: (&#39;#005000&#39;, 72),
 &#39;Tree Needleleaved Deciduous Closed To Open&#39;: (&#39;#285000&#39;, 80),
 &#39;Tree Needleleaved Deciduous Closed&#39;: (&#39;#285000&#39;, 81),
 &#39;Tree Needleleaved Deciduous Open&#39;: (&#39;#286400&#39;, 82),
 &#39;Tree Mixed&#39;: (&#39;#788200&#39;, 90),
 &#39;Mosaic Tree And Shrub&#39;: (&#39;#8ca000&#39;, 100),
 &#39;Mosaic Herbaceous&#39;: (&#39;#be9600&#39;, 110),
 &#39;Shrubland&#39;: (&#39;#966400&#39;, 120),
 &#39;Shrubland Evergreen&#39;: (&#39;#966400&#39;, 121),
 &#39;Shrubland Deciduous&#39;: (&#39;#966400&#39;, 122),
 &#39;Grassland&#39;: (&#39;#ffb432&#39;, 130),
 &#39;Lichens And Mosses&#39;: (&#39;#ffdcd2&#39;, 140),
 &#39;Sparse Vegetation&#39;: (&#39;#ffebaf&#39;, 150),
 &#39;Sparse Tree&#39;: (&#39;#ffc864&#39;, 151),
 &#39;Sparse Shrub&#39;: (&#39;#ffd278&#39;, 152),
 &#39;Sparse Herbaceous&#39;: (&#39;#ffebaf&#39;, 153),
 &#39;Tree Cover Flooded Fresh Or Brakish Water&#39;: (&#39;#00785a&#39;, 160),
 &#39;Tree Cover Flooded Saline Water&#39;: (&#39;#009678&#39;, 170),
 &#39;Shrub Or Herbaceous Cover Flooded&#39;: (&#39;#00dc82&#39;, 180),
 &#39;Urban&#39;: (&#39;#c31400&#39;, 190),
 &#39;Bare Areas&#39;: (&#39;#fff5d7&#39;, 200),
 &#39;Bare Areas Consolidated&#39;: (&#39;#dcdcdc&#39;, 201),
 &#39;Bare Areas Unconsolidated&#39;: (&#39;#fff5d7&#39;, 202),
 &#39;Water&#39;: (&#39;#0046c8&#39;, 210),
 &#39;Snow And Ice&#39;: (&#39;#ffffff&#39;, 220)}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define IPCC labels dictionary</span>
<span class="n">ipcc_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;No Data&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="s2">&quot;Agriculture&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#ffffcc&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span>
    <span class="s2">&quot;Forest&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#4c9900&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">]),</span>
    <span class="s2">&quot;Grassland&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#ccff99&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">130</span><span class="p">]),</span>
    <span class="s2">&quot;Settlement&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#ff0000&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">190</span><span class="p">]),</span>
    <span class="s2">&quot;Wetland&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#99ffff&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">180</span><span class="p">]),</span>
    <span class="s2">&quot;Other&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;#0000ff&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">210</span><span class="p">]),</span>
<span class="p">}</span>

<span class="n">ipcc_dict</span> 
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;No Data&#39;: (&#39;#000000&#39;, [0]),
 &#39;Agriculture&#39;: (&#39;#ffffcc&#39;, [10, 11, 12, 20, 30, 40]),
 &#39;Forest&#39;: (&#39;#4c9900&#39;,
  [50, 60, 61, 62, 70, 71, 72, 80, 81, 82, 90, 100, 160, 170]),
 &#39;Grassland&#39;: (&#39;#ccff99&#39;, [110, 130]),
 &#39;Settlement&#39;: (&#39;#ff0000&#39;, [190]),
 &#39;Wetland&#39;: (&#39;#99ffff&#39;, [180]),
 &#39;Other&#39;: (&#39;#0000ff&#39;,
  [120, 121, 122, 140, 150, 151, 152, 153, 200, 201, 202, 210])}
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-maps">
<h4>Plot maps<a class="headerlink" href="#plot-maps" title="Link to this heading">#</a></h4>
<p>Having defined the color and legends for the IPCC classes and using the metadata of the dataset to get the colors and legends for each Land Cover class it is now possible to plot our data either with the original colors or with the IPCC previously defined colors.</p>
<p>The function below plots the LC maps for the year of your choice , using both land cover schemes. From the output, we can already distinguish the differences in classification schemes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_year</span> <span class="o">=</span> <span class="mi">2009</span>  <span class="c1"># choose the year you want</span>

<span class="c1"># Filter the dataset for the selected year</span>
<span class="n">lccs_selected</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lccs_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">selected_year</span><span class="p">)</span>

<span class="c1"># Adjust the size of the figure and legend to make maps bigger and the legend smaller</span>
<span class="k">for</span> <span class="n">legend_dict</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">ipcc_dict</span><span class="p">]:</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">lccs_map</span><span class="p">(</span>
        <span class="n">lccs_selected</span><span class="p">,</span>
        <span class="n">legend_dict</span><span class="o">=</span><span class="n">legend_dict</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;antialiased&quot;</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># Set the figure size </span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a28e92d68a34edc036f351a03d0f413a7c9e58c4b28de6ac6ae343565cc5be81.png" src="../../_images/a28e92d68a34edc036f351a03d0f413a7c9e58c4b28de6ac6ae343565cc5be81.png" />
<img alt="../../_images/8b10f1ac2c0bce43748c75eb1b71f9dbe4f51fdf6ee30018342cf96166701d8c.png" src="../../_images/8b10f1ac2c0bce43748c75eb1b71f9dbe4f51fdf6ee30018342cf96166701d8c.png" />
</div>
</div>
</section>
</section>
<section id="calculate-total-area-and-area-percentage-of-change-in-for-aoi-by-lc-classes">
<span id="satellite-satellite-land-cover-consistency-assessment-q01-code-section-3"></span><h3>3. Calculate total area and area percentage of change in for AoI by LC classes<a class="headerlink" href="#calculate-total-area-and-area-percentage-of-change-in-for-aoi-by-lc-classes" title="Link to this heading">#</a></h3>
<p>To further identify changes in LC patterns, in this user question, Nomenclature of Territorial Units for Statistics (NUTS) 2 will be used, providing the information regarding the main regions/parcels of the Iberian Peninsula.</p>
<p>The <a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts" rel="noreferrer" target="_blank">NUTS</a> are a hierarchical system divided into 3 levels. NUTS 1 correspond to major socio-economic regions, NUTS 2 correspond to basic regions for the application of regional policies, and NUTS 3 correspond to small regions for specific diagnoses. Additionally a NUTS 0 level, usually co-incident with national boundaries is also available. The NUTS legislation is periodically amended; therefore multiple years are available for download.</p>
<p>The step below masks the Land Cover data according to the NUTS 2 boundaries and calculates the area of each pixel (weighted by Latitude). For each NUTS 2 region, we proceed with the analysis and visual inspection of Land Cover areas per class and corresponding percentages during the selected period.</p>
<section id="mask-regions">
<h4>Mask regions<a class="headerlink" href="#mask-regions" title="Link to this heading">#</a></h4>
<p>First, we need to establish the geometry of the NUTS region (level 2) in order to make the corresponding statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shapefile with regions (NUTS2)</span>
<span class="n">shapefile_url</span> <span class="o">=</span> <span class="s2">&quot;https://gisco-services.ec.europa.eu/distribution/v2/nuts/shp/NUTS_RG_20M_2021_4326.shp.zip&quot;</span> <span class="c1">#NUTS2 download path</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the CRS for the Iberian Peninsula (WGS84)</span>
<span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;epsg:4326&quot;</span>  <span class="c1"># EPSG code for WGS84 (latitude/longitude)</span>

<span class="c1"># Data filter: load the shapefile and filter for NUTS2 regions in Spain and Portugal</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shapefile_url</span><span class="p">)</span>  <span class="c1"># Read the shapefile NUTS2</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;LEVL_CODE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># Keep only features at the second administrative level (NUTS2)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;NUTS_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span> <span class="s2">&quot;PT&quot;</span><span class="p">))]</span>  <span class="c1"># Keep only NUTS2 regions for Spain (ES) and Portugal (PT)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="p">)</span>  <span class="c1"># Ensure CRS is consistent with the dataset</span>

<span class="c1"># Create a mask for the NUTS2 regions that intersect with the Iberian Peninsula</span>
<span class="n">regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">)</span>  <span class="c1"># Create regions mask based on GeoPandas DataFrame</span>

<span class="c1"># Apply the mask to the dataset</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span>

<span class="c1"># Only keep land areas (not ocean) by applying the mask</span>
<span class="c1"># This ensures that only land pixels are used in the area calculations</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Drop ocean pixels that are outside the NUTS2 regions</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-cell-area">
<h4>Compute cell area<a class="headerlink" href="#compute-cell-area" title="Link to this heading">#</a></h4>
<p>Then, we can calculate the area of each pixel taking into consideration the curvature of the earth (i.e., weighted by Latitude).</p>
<p><a class="reference external" href="https://rdrr.io/cran/raster/man/area.html" rel="noreferrer" target="_blank">If you want to know more</a></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Pixel Area after applying the mask</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">0.002778</span>  <span class="c1"># Define a scaling factor for conversion</span>
<span class="n">resolution_km</span> <span class="o">=</span> <span class="n">scaling_factor</span> <span class="o">*</span> <span class="mf">111.195</span>  <span class="c1"># Calculate the grid cell resolution in kilometers</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]),</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">)</span>  <span class="c1"># Create an array of latitude indexes</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">indexes</span> <span class="o">*</span> <span class="n">scaling_factor</span>
<span class="n">grid_cell_area</span> <span class="o">=</span> <span class="n">resolution_km</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span>
<span class="n">grid_cell_area</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cell_area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km2&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">cell_area</span><span class="o">=</span><span class="n">grid_cell_area</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="bar-charts-iberian-peninsula">
<h4>Bar Charts - Iberian Peninsula<a class="headerlink" href="#bar-charts-iberian-peninsula" title="Link to this heading">#</a></h4>
<p>Having the area calculated and the NUTS 2 regions assigned to each pixel, we can now proceed to create the plots of the LC areas per class, by year. First, let’s inspect the total area of each LC class in this AoI. We will use the original LC classes to highlight which ones have more significant changes.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Fuction to calculate class area with original classes</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_area_by_class</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    <span class="c1"># Select the data for the given year</span>
    <span class="n">ds_year</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">)</span>
    
    <span class="c1"># Initialize a dictionary to store the area for each land cover class</span>
    <span class="n">area_by_class</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Loop over each unique land cover class (lccs_class)</span>
    <span class="k">for</span> <span class="n">lc_class</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ds_year</span><span class="p">[</span><span class="s1">&#39;lccs_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="c1"># Create a mask for the current LC class</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">ds_year</span><span class="p">[</span><span class="s1">&#39;lccs_class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lc_class</span>
        
        <span class="c1"># Calculate the total area for the current LC class</span>
        <span class="n">total_area</span> <span class="o">=</span> <span class="n">cell_area</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Use .compute() to get the result</span>
        <span class="n">area_by_class</span><span class="p">[</span><span class="n">lc_class</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_area</span>
    
    <span class="k">return</span> <span class="n">area_by_class</span>

<span class="c1"># Calculate areas for 1992 and 2022</span>
<span class="n">area_2009</span> <span class="o">=</span> <span class="n">calculate_area_by_class</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;cell_area&quot;</span><span class="p">],</span> <span class="mi">2009</span><span class="p">)</span>
<span class="n">area_2012</span> <span class="o">=</span> <span class="n">calculate_area_by_class</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;cell_area&quot;</span><span class="p">],</span> <span class="mi">2012</span><span class="p">)</span>
<span class="n">area_2015</span> <span class="o">=</span> <span class="n">calculate_area_by_class</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;cell_area&quot;</span><span class="p">],</span> <span class="mi">2015</span><span class="p">)</span>
<span class="n">area_2018</span> <span class="o">=</span> <span class="n">calculate_area_by_class</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;cell_area&quot;</span><span class="p">],</span> <span class="mi">2018</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine area dictionaries into a single dictionary</span>
<span class="n">area_by_year</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">2009</span><span class="p">:</span> <span class="n">area_2009</span><span class="p">,</span>
    <span class="mi">2012</span><span class="p">:</span> <span class="n">area_2012</span><span class="p">,</span>
    <span class="mi">2015</span><span class="p">:</span> <span class="n">area_2015</span><span class="p">,</span>
    <span class="mi">2018</span><span class="p">:</span> <span class="n">area_2018</span>
<span class="p">}</span>

<span class="c1"># Ensure lc_classes excludes NaN</span>
<span class="n">lc_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">lc_class</span> <span class="k">for</span> <span class="n">lc_class</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lccs_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lc_class</span><span class="p">)]</span>

<span class="c1"># Prepare area lists for plotting</span>
<span class="n">area_lists</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span><span class="p">:</span> <span class="p">[</span><span class="n">area_by_year</span><span class="p">[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">lc_class</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">lc_class</span> <span class="ow">in</span> <span class="n">lc_classes</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">area_by_year</span>
<span class="p">}</span>

<span class="c1"># Get class names and colors from the mapping dictionaries</span>
<span class="n">numeric_to_name</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">lccs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">numeric_to_color</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">lccs_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">numeric_to_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lc_class</span><span class="p">),</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">lc_class</span> <span class="ow">in</span> <span class="n">lc_classes</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">numeric_to_color</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lc_class</span><span class="p">),</span> <span class="s1">&#39;#000000&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">lc_class</span> <span class="ow">in</span> <span class="n">lc_classes</span><span class="p">]</span>

<span class="c1"># Bar plot settings</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lc_classes</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Unique hatching patterns for visual separation by year</span>
<span class="n">hatch_patterns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">2009</span><span class="p">:</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
    <span class="mi">2012</span><span class="p">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
    <span class="mi">2015</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="mi">2018</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span>
<span class="p">}</span>

<span class="c1"># Plot bars for each year</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">area_by_year</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">index</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">bar_width</span><span class="p">,</span>
        <span class="n">area_lists</span><span class="p">[</span><span class="n">year</span><span class="p">],</span>
        <span class="n">bar_width</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">hatch</span><span class="o">=</span><span class="n">hatch_patterns</span><span class="p">[</span><span class="n">year</span><span class="p">]</span>
    <span class="p">)</span>

<span class="c1"># Final plot customization</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Land Cover Class&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of Area [km²]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparison of Land Cover Classes in 2009, 2012, 2015, and 2018&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">class_names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/6dbd52e80375e49dea39317a163a27e850e77f9175bf90304338aefb9e2d531a.png" src="../../_images/6dbd52e80375e49dea39317a163a27e850e77f9175bf90304338aefb9e2d531a.png" />
</div>
</div>
</section>
<section id="plot-analysis">
<h4>Plot Analysis<a class="headerlink" href="#plot-analysis" title="Link to this heading">#</a></h4>
<p>The bar chart above compares the total land cover class areas across four years: 2009, 2012, 2015, and 2018. The most notable trend is the steady increase in the ‘Urban’ class over time, reflecting ongoing urbanisation in the Iberian Peninsula. Although the total area classified as ‘Urban’ remains relatively small compared to other categories, it shows a consistent upward trajectory across the four years.</p>
</section>
</section>
<section id="calculate-the-area-percentage-and-the-area-percentage-change-for-the-most-populated-regions">
<span id="satellite-satellite-land-cover-consistency-assessment-q01-code-section-4"></span><h3>4. Calculate the area percentage and the area percentage change for the most populated regions<a class="headerlink" href="#calculate-the-area-percentage-and-the-area-percentage-change-for-the-most-populated-regions" title="Link to this heading">#</a></h3>
<p>Having identified general urbanisation trends in the Iberian Peninsula, we now focus on specific NUTS2 regions in greater detail. These regions were selected based on their inclusion of the largest urban areas in terms of population, according to the Urban Audit Indicators dataset from the European Commission (Eurostat).</p>
<p>The selected NUTS2 regions are:</p>
<ul class="simple">
<li><p><strong>Comunidad de Madrid</strong>, which includes the city of Madrid (5,098,717 inhabitants in 2022), the capital of Spain;</p></li>
<li><p><strong>Cataluña</strong>, which includes Barcelona (3,755,512 inhabitants in 2022);</p></li>
<li><p><strong>Área Metropolitana de Lisboa</strong>, which includes Lisbon (1,872,036 inhabitants in 2022), the capital of Portugal;</p></li>
<li><p><strong>Comunitat Valenciana</strong>, which includes Valencia (1,417,464 inhabitants in 2022);</p></li>
<li><p><strong>Norte</strong>, which includes Porto (955,864 inhabitants in 2022).</p></li>
</ul>
<p>For each of these regions, we analyse land cover dynamics in terms of <strong>area percentages by IPCC classes</strong>, in order to highlight broader, aggregated land cover changes. Additionally, we compare dataset results with EUROSTAT statistics to assess the consistency between datasets.</p>
<section id="calculation-of-the-percentage-area-absolute-change-and-relative-percentage-change-for-each-ipcc-class-category">
<h4>Calculation of the percentage area, absolute change, and relative percentage change for each IPCC class category<a class="headerlink" href="#calculation-of-the-percentage-area-absolute-change-and-relative-percentage-change-for-each-ipcc-class-category" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Area Percentage Coverage</strong>:<br />
<em>Example</em>: In 1992, forest land covered 35% of the total area, while urban areas occupied 10%. By 2022, forest coverage decreased to 30%, and urban areas expanded to 15%. This metric gives the proportion of the total land occupied by each land cover class.</p></li>
<li><p><strong>Absolute Percentage Difference</strong>:<br />
<em>Example</em>: In 1992, 10% of the region was classified as agricultural land. By 2022, this had decreased to 8%. The absolute percentage difference in agricultural land coverage is −2% (from 10% in 1992 to 8% in 2022, representing a 2% decrease in total land area occupied by agriculture).</p></li>
<li><p><strong>Relative Percentage Difference</strong>:<br />
<em>Example</em>: In 1992, 10% of the area was classified as wetlands. By 2022, wetlands accounted for 12% of the total area. The relative percentage difference is calculated as ((12−10)/10)∗100 = +20%. This means there was a 20% increase in wetland area relative to its size in 1992.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter the GeoDataFrame to include only the regions of interest</span>
<span class="n">regions</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Comunidad de Madrid&quot;</span><span class="p">,</span> <span class="s2">&quot;Cataluña&quot;</span><span class="p">,</span> <span class="s2">&quot;Área Metropolitana de Lisboa&quot;</span><span class="p">,</span> <span class="s2">&quot;Comunitat Valenciana&quot;</span><span class="p">,</span> <span class="s2">&quot;Norte&quot;</span><span class="p">]</span>

<span class="n">gdf_filtered</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;NUTS_NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">regions</span><span class="p">)]</span>
<span class="n">gdf_filtered</span> <span class="o">=</span> <span class="n">gdf_filtered</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>

<span class="c1"># Expand cell_area ONCE outside the loops</span>
<span class="n">cell_area</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;cell_area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Prepare latitude and longitude grids ONCE</span>
<span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>  <span class="c1"># avoid recalculating inside mask function</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create region mask using shapely</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_region_mask</span><span class="p">(</span><span class="n">region_geom</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lon_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">lat_grid</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">region_geom</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">points</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">lon_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">])</span>

<span class="c1"># Calculate IPCC class % coverage for a given year and region</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_ipcc_coverage</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">region_mask</span><span class="p">,</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">ipcc_dict</span><span class="p">,</span> <span class="n">total_area</span><span class="p">):</span>
    <span class="n">lccs</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lccs_class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">region_mask</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">group</span><span class="p">:</span> <span class="p">((</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">lccs</span><span class="p">,</span> <span class="n">codes</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="n">total_area</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipcc_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

<span class="c1"># Compute absolute and relative differences</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_differences</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">abs_diff</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">target</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">base</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">base</span><span class="p">}</span>
    <span class="n">rel_diff</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">((</span><span class="n">target</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">base</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span> <span class="n">base</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">base</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">base</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">abs_diff</span><span class="p">,</span> <span class="n">rel_diff</span>

<span class="c1"># Padded y-axis limits</span>
<span class="k">def</span><span class="w"> </span><span class="nf">padded_limits</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">finite_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">finite_vals</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">min_v</span><span class="p">,</span> <span class="n">max_v</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">finite_vals</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">finite_vals</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">min_v</span><span class="p">,</span> <span class="n">max_v</span> <span class="o">+</span> <span class="p">(</span><span class="n">max_v</span> <span class="o">-</span> <span class="n">min_v</span><span class="p">)</span> <span class="o">*</span> <span class="n">pad</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot area coverage (bar chart comparing 2009 and 2018)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_coverage</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cov_2009</span><span class="p">,</span> <span class="n">cov_2018</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">ymax</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cov_2009</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;No Data&#39;</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">ipcc_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">cov_2009</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="n">cov_2018</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2009&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;//&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2018&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Coverage Area (%)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1">&quot; NUTS2&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Plot absolute and relative differences (side-by-side bars)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_differences</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">abs_d</span><span class="p">,</span> <span class="n">rel_d</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">lims_abs</span><span class="p">,</span> <span class="n">lims_rel</span><span class="p">):</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">abs_d</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;No Data&#39;</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">ipcc_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

    <span class="c1"># Absolute difference</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">abs_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">],</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absolute Change (%)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Abs Diff &quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">lims_abs</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

    <span class="c1"># Relative difference</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">rel_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">],</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Relative Change (%)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rel Diff &quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">lims_rel</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preprocessing</span>
<span class="n">years_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2018</span><span class="p">]</span>
<span class="n">global_cov</span><span class="p">,</span> <span class="n">global_abs</span><span class="p">,</span> <span class="n">global_rel</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="c1"># Storage dictionary for later reuse</span>
<span class="n">all_coverages</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># (region, year) -&gt; coverage dict</span>

<span class="c1"># Calculate everything</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">gdf_filtered</span><span class="p">[</span><span class="n">gdf_filtered</span><span class="p">[</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">union_all</span><span class="p">()</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">create_region_mask</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">lon_grid</span><span class="p">,</span> <span class="n">lat_grid</span><span class="p">)</span>
    <span class="n">total_area</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">total_area</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years_to_check</span><span class="p">:</span>
        <span class="n">cov</span> <span class="o">=</span> <span class="n">calculate_ipcc_coverage</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">ipcc_dict</span><span class="p">,</span> <span class="n">total_area</span><span class="p">)</span>
        <span class="n">all_coverages</span><span class="p">[(</span><span class="n">region</span><span class="p">,</span> <span class="n">year</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cov</span>

    <span class="c1"># For plotting (only cov_2009 vs cov_2018)</span>
    <span class="n">cov_2009</span> <span class="o">=</span> <span class="n">all_coverages</span><span class="p">[(</span><span class="n">region</span><span class="p">,</span> <span class="mi">2009</span><span class="p">)]</span>
    <span class="n">cov_2018</span> <span class="o">=</span> <span class="n">all_coverages</span><span class="p">[(</span><span class="n">region</span><span class="p">,</span> <span class="mi">2018</span><span class="p">)]</span>
    <span class="n">abs_d</span><span class="p">,</span> <span class="n">rel_d</span> <span class="o">=</span> <span class="n">compute_differences</span><span class="p">(</span><span class="n">cov_2009</span><span class="p">,</span> <span class="n">cov_2018</span><span class="p">)</span>

    <span class="n">global_cov</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cov_2009</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">cov_2018</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">global_abs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">abs_d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">global_rel</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rel_d</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="c1"># Calculate global plot limits</span>
<span class="n">lims_cov</span> <span class="o">=</span> <span class="n">padded_limits</span><span class="p">(</span><span class="n">global_cov</span><span class="p">)</span>
<span class="n">lims_abs</span> <span class="o">=</span> <span class="n">padded_limits</span><span class="p">(</span><span class="n">global_abs</span><span class="p">)</span>
<span class="n">lims_rel</span> <span class="o">=</span> <span class="n">padded_limits</span><span class="p">(</span><span class="n">global_rel</span><span class="p">)</span>


<span class="c1"># Plot results</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="n">cov_2009</span> <span class="o">=</span> <span class="n">all_coverages</span><span class="p">[(</span><span class="n">region</span><span class="p">,</span> <span class="mi">2009</span><span class="p">)]</span>
    <span class="n">cov_2018</span> <span class="o">=</span> <span class="n">all_coverages</span><span class="p">[(</span><span class="n">region</span><span class="p">,</span> <span class="mi">2018</span><span class="p">)]</span>
    <span class="n">abs_d</span><span class="p">,</span> <span class="n">rel_d</span> <span class="o">=</span> <span class="n">compute_differences</span><span class="p">(</span><span class="n">cov_2009</span><span class="p">,</span> <span class="n">cov_2018</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plot_coverage</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">cov_2009</span><span class="p">,</span> <span class="n">cov_2018</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">lims_cov</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plot_differences</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">abs_d</span><span class="p">,</span> <span class="n">rel_d</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">lims_abs</span><span class="p">,</span> <span class="n">lims_rel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ca9a5bd477279af07dae917bd08e36366f83e406bc6be4b0ec32d61d2fc16eb8.png" src="../../_images/ca9a5bd477279af07dae917bd08e36366f83e406bc6be4b0ec32d61d2fc16eb8.png" />
<img alt="../../_images/78ac16eb6db6a2029b5fe6c02f3dbebb540a648a64f62e9e023c51bfc4bedc96.png" src="../../_images/78ac16eb6db6a2029b5fe6c02f3dbebb540a648a64f62e9e023c51bfc4bedc96.png" />
<img alt="../../_images/72b3665b9c586749a63b0607aa151eb2c17c17131081ca143d1910043ec44e60.png" src="../../_images/72b3665b9c586749a63b0607aa151eb2c17c17131081ca143d1910043ec44e60.png" />
<img alt="../../_images/2575494d342e7decaee619ff2de6cd6750811d98f6ccb472a9d1a1f8b26be055.png" src="../../_images/2575494d342e7decaee619ff2de6cd6750811d98f6ccb472a9d1a1f8b26be055.png" />
<img alt="../../_images/554e39a40c47154c7f504a2e40c2a73f5a267dc929c3ff15ebe697db82af484e.png" src="../../_images/554e39a40c47154c7f504a2e40c2a73f5a267dc929c3ff15ebe697db82af484e.png" />
</div>
</div>
</section>
<section id="bar-chart-analysis">
<h4><strong>Bar Chart Analysis</strong><a class="headerlink" href="#bar-chart-analysis" title="Link to this heading">#</a></h4>
<p>Across the five most populated NUTS2 regions clear land cover change patterns are observed between 2009 and 2018, especially in relation to urban expansion and agricultural decline.</p>
<ul class="simple">
<li><p><strong>Settlement/Urban areas</strong> show a consistent and significant increase in all regions, with the most pronounced growth occurring in Área Metropolitana de Lisboa and Comunidad de Madrid.</p></li>
<li><p><strong>Agricultural land</strong> has decreased across all regions, with the sharpest reduction seen in Área Metropolitana de Lisboa. The decline appears moderate in Comunidad de Madrid, Cataluña, and Comunitat Valenciana, suggesting a gradual conversion of agricultural land to urban or other uses.</p></li>
<li><p><strong>Forest and grassland areas</strong> remained mostly stable in several regions, with small increases in Comunitat Valenciana and Cataluña, indicating preservation or limited natural regeneration in non‑urbanised areas. However, in Norte and Valencia, forest cover declined despite only a minimal change of agricultural land. This pattern suggests that the reduction in forest area is linked to the expansion of settlements.</p></li>
<li><p><strong>Wetlands and other land cover categories</strong> continue to represent a negligible share of total area. Their relative and absolute changes are minimal, with little to no impact on the overall land use structure of the regions.</p></li>
</ul>
<p>These trends are consistent with well-documented urbanisation dynamics in Southern Europe, where urban growth often occurs at the expense of agricultural land. The dataset captures these patterns clearly, supporting its reliability for regional land cover monitoring.</p>
</section>
<section id="comparison-with-eurostat-artificial-land-data">
<h4>Comparison with EUROSTAT Artificial Land Data<a class="headerlink" href="#comparison-with-eurostat-artificial-land-data" title="Link to this heading">#</a></h4>
<p>To validate the consistency of the dataset, we compared the percentage of land classified as “Settlement” against the values for artificial land reported by <a class="reference external" href="https://ec.europa.eu/eurostat/databrowser/bookmark/63d3fd90-2f5b-4bec-99f3-4f88814e2624?lang=en" rel="noreferrer" target="_blank">EUROSTAT</a>. The table below shows values for the five most populated NUTS2 regions in the Iberian Peninsula for the four EUROSTAT available years.</p>
<p>While these datasets differ in classification methodology, temporal resolution, and source data, the values are comparable in magnitude. This alignment supports the conclusion that the C3S dataset is broadly consistent with other authoritative sources for regional monitoring of urbanisation.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Manually define EUROSTAT values for comparison</span>
<span class="n">eurostat_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;Área Metropolitana de Lisboa&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">):</span> <span class="mf">14.6</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Área Metropolitana de Lisboa&quot;</span><span class="p">,</span> <span class="mi">2012</span><span class="p">):</span> <span class="mf">15.4</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Área Metropolitana de Lisboa&quot;</span><span class="p">,</span> <span class="mi">2015</span><span class="p">):</span> <span class="mf">15.8</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Área Metropolitana de Lisboa&quot;</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span> <span class="mf">18.9</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunidad de Madrid&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">):</span> <span class="mf">9.7</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunidad de Madrid&quot;</span><span class="p">,</span> <span class="mi">2012</span><span class="p">):</span> <span class="mf">10.1</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunidad de Madrid&quot;</span><span class="p">,</span> <span class="mi">2015</span><span class="p">):</span> <span class="mf">10.6</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunidad de Madrid&quot;</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span> <span class="mf">11.7</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Cataluña&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">):</span> <span class="mf">6.3</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Cataluña&quot;</span><span class="p">,</span> <span class="mi">2012</span><span class="p">):</span> <span class="mf">6.4</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Cataluña&quot;</span><span class="p">,</span> <span class="mi">2015</span><span class="p">):</span> <span class="mf">6.5</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Cataluña&quot;</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span> <span class="mf">5.3</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunitat Valenciana&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">):</span> <span class="mf">6.1</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunitat Valenciana&quot;</span><span class="p">,</span> <span class="mi">2012</span><span class="p">):</span> <span class="mf">6.2</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunitat Valenciana&quot;</span><span class="p">,</span> <span class="mi">2015</span><span class="p">):</span> <span class="mf">6.5</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Comunitat Valenciana&quot;</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span> <span class="mf">7.2</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Norte&quot;</span><span class="p">,</span> <span class="mi">2009</span><span class="p">):</span> <span class="mf">6.8</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Norte&quot;</span><span class="p">,</span> <span class="mi">2012</span><span class="p">):</span> <span class="mf">6.9</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Norte&quot;</span><span class="p">,</span> <span class="mi">2015</span><span class="p">):</span> <span class="mf">7.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;Norte&quot;</span><span class="p">,</span> <span class="mi">2018</span><span class="p">):</span> <span class="mf">9.4</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Build DataFrame for comparison</span>
<span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years_to_check</span><span class="p">:</span>
        <span class="n">cov</span> <span class="o">=</span> <span class="n">all_coverages</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">region</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cov</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">settlement_percentage</span> <span class="o">=</span> <span class="n">cov</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Settlement&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span>
            <span class="s2">&quot;C3S Settlement (%)&quot;</span><span class="p">:</span> <span class="n">settlement_percentage</span><span class="p">,</span>
            <span class="s2">&quot;EUROSTAT Artificial (%)&quot;</span><span class="p">:</span> <span class="n">eurostat_data</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">region</span><span class="p">,</span> <span class="n">year</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">})</span>

<span class="n">df_comparison</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="n">df_comparison</span> <span class="o">=</span> <span class="n">df_comparison</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add Differences</span>
<span class="n">df_comparison</span><span class="p">[</span><span class="s2">&quot;Absolute Difference (%)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_comparison</span><span class="p">[</span><span class="s2">&quot;C3S Settlement (%)&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_comparison</span><span class="p">[</span><span class="s2">&quot;EUROSTAT Artificial (%)&quot;</span><span class="p">]</span>

<span class="c1"># Display table</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_comparison</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      Region  Year  C3S Settlement (%)  EUROSTAT Artificial (%)  Absolute Difference (%)
                    Cataluña  2009                3.29                      6.3                    -3.01
                    Cataluña  2012                3.49                      6.4                    -2.91
                    Cataluña  2015                3.71                      6.5                    -2.79
                    Cataluña  2018                3.93                      5.3                    -1.37
         Comunidad de Madrid  2009                9.09                      9.7                    -0.61
         Comunidad de Madrid  2012                9.62                     10.1                    -0.48
         Comunidad de Madrid  2015               10.30                     10.6                    -0.30
         Comunidad de Madrid  2018               12.23                     11.7                     0.53
        Comunitat Valenciana  2009                3.16                      6.1                    -2.94
        Comunitat Valenciana  2012                3.46                      6.2                    -2.74
        Comunitat Valenciana  2015                3.86                      6.5                    -2.64
        Comunitat Valenciana  2018                4.58                      7.2                    -2.62
                       Norte  2009                4.33                      6.8                    -2.47
                       Norte  2012                4.68                      6.9                    -2.22
                       Norte  2015                5.08                      7.0                    -1.92
                       Norte  2018                5.14                      9.4                    -4.26
Área Metropolitana de Lisboa  2009               15.46                     14.6                     0.86
Área Metropolitana de Lisboa  2012               16.58                     15.4                     1.18
Área Metropolitana de Lisboa  2015               17.66                     15.8                     1.86
Área Metropolitana de Lisboa  2018               18.12                     18.9                    -0.78
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="main-takeaways">
<span id="satellite-satellite-land-cover-consistency-assessment-q01-code-section-5"></span><h3>5. Main Takeaways<a class="headerlink" href="#main-takeaways" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The dataset demonstrates strong physical consistency with official sources, aligning well with <a class="reference external" href="https://ec.europa.eu/eurostat/databrowser/bookmark/63d3fd90-2f5b-4bec-99f3-4f88814e2624?lang=en" rel="noreferrer" target="_blank">EUROSTAT statistics</a> and findings from <a class="reference external" href="https://doi.org/10.1016/j.apgeog.2009.07.003" rel="noreferrer" target="_blank">Feranec et al. (2010)</a> and <a class="reference external" href="https://doi.org/10.3390/land7030099" rel="noreferrer" target="_blank">Fernández-Nogueira &amp; Corbelle-Rico (2018)</a>. Between 2009 and 2018, significant urbanisation occurred across major NUTS2 regions, with settlement areas doubling in some cases. This expansion largely came at the expense of Agriculture and Grassland classes, except in Norte where Forest declined instead. These patterns align with broader European trends identified by <a class="reference external" href="https://publications.jrc.ec.europa.eu/repository/handle/JRC116711" rel="noreferrer" target="_blank">Alberti et al. (2019)</a> using the GHSL dataset. Small discrepancies (&lt;5%) with EUROSTAT are observed, but they do not compromise the dataset’s reliability for identifying overall trends in land-use change, though users focusing on very localised patterns should interpret results with some caution.</p></li>
<li><p>Urban expansion mainly replaced agricultural and open land, while Forest areas remained largely stable. Settlements now occupy a larger share of the land but still cover less than 20% in most regions. These findings are consistent with spatial trade-off patterns reported by <a class="reference external" href="https://doi.org/10.1088/1748-9326/9/6/064015" rel="noreferrer" target="_blank">Bagan &amp; Yamagata (2014)</a>, where urban growth frequently takes from agricultural lands.</p></li>
<li><p>The use of both detailed and aggregated IPCC classes provided a comprehensive view of land cover trends, balancing precision and generalization. Although class aggregation introduces some uncertainties (e.g., between Agriculture and Grassland), it enables clearer identification of dominant land transitions like urban expansion.</p></li>
<li><p>Minor classification differences between datasets (e.g., how mixed-use or greenhouse areas are coded) can introduce uncertainties. Nonetheless, the dataset maintains high accuracy and precision in identifying urban expansion trends, consistent with findings by <a class="reference external" href="https://www.mdpi.com/2072-4292/15/9/2285" rel="noreferrer" target="_blank">Zhao et al (2023)</a>.</p></li>
</ul>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entry for the data used were:</p>
<ul class="simple">
<li><p>Land cover classification gridded maps from 1992 to present derived from satellite observations:
(<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-land-cover?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-land-cover?tab=overview</a>)</p></li>
<li><p>Product User Guide and Specification of the dataset <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D5.3.1_PUGS_ICDR_LC_v2.1.x_PRODUCTS_v1.1.pdf" rel="noreferrer" target="_blank">version 2.1</a> and <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D3.3.11-v1.0_PUGS_CDR_LC-CCI_v2.0.7cds_Products_v1.0.1_APPROVED_Ver1.pdf" rel="noreferrer" target="_blank">version 2.0</a></p></li>
</ul>
<p>Additional resources:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts" rel="noreferrer" target="_blank">Eurostat NUTS</a> (Nomenclature of territorial units for statistics)</p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1016/j.apgeog.2009.07.003" rel="noreferrer" target="_blank">Feranec, J., Jaffrain, G., Soukup, T., &amp; Hazeu, G. (2010). Determining changes and flows in European landscapes 1990–2000 using CORINE land cover data. Applied geography, 30(1), 19-35.</a></p>
<p><a class="reference external" href="https://doi.org/10.3390/land7030099" rel="noreferrer" target="_blank">Fernández-Nogueira, D., &amp; Corbelle-Rico, E. (2018). Land use changes in Iberian Peninsula 1990–2012. Land, 7(3), 99.</a></p>
<p><a class="reference external" href="https://ec.europa.eu/statistical-atlas/viewer/?ch=gridvizChapter&amp;amp;mids=BKGCNT,totalPop21,CNTOVL&amp;amp;o=1,1,0.7&amp;amp;center=40.94812,-2.2287,5&amp;amp;lcis=totalPop21&amp;amp;" rel="noreferrer" target="_blank">Eurostat, Statistical Atlas</a></p>
<p><a class="reference external" href="https://doi.org/10.1088/1748-9326/9/6/064015" rel="noreferrer" target="_blank">Bagan, H., &amp; Yamagata, Y. (2014). Land-cover change analysis in 50 global cities by using a combination of Landsat data and analysis of grid cells. Environmental Research Letters, 9.</a></p>
<p><a class="reference external" href="https://publications.jrc.ec.europa.eu/repository/handle/JRC116711" rel="noreferrer" target="_blank">Alberti, V. et al (2019) The Future of Cities, Vandecasteele, I., Baranzelli, C., Siragusa, A. and Aurambout, J. editor(s), EUR 29752 EN, Publications Office of the European Union, Luxembourg, 2019, ISBN 978-92-76-03847-4, doi:10.2760/375209, JRC116711.</a></p>
<p><a class="reference external" href="https://www.mdpi.com/2072-4292/15/9/2285" rel="noreferrer" target="_blank">Zhao, T., Zhang, X., Gao, Y., Mi, J., Liu, W., Wang, J., Jiang, M., &amp; Liu, L. (2023). Assessing the Accuracy and Consistency of Six Fine-Resolution Global Land Cover Products Using a Novel Stratified Random Sampling Validation Dataset. Remote. Sens., 15, 2285.</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Biosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Biosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Hydrology/Land_Hydrology.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-monitor-land-cover-lc-changes">🌍 Use case: Using land cover products to monitor Land Cover (LC) changes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data">1. Define the AoI, search and download LC data.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data">2. Inspect and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#label-color-definition-and-class-correspondence">Label Color Definition and Class Correspondence</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-maps">Plot maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-total-area-and-area-percentage-of-change-in-for-aoi-by-lc-classes">3. Calculate total area and area percentage of change in for AoI by LC classes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-charts-iberian-peninsula">Bar Charts - Iberian Peninsula</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-analysis">Plot Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-area-percentage-and-the-area-percentage-change-for-the-most-populated-regions">4. Calculate the area percentage and the area percentage change for the most populated regions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-percentage-area-absolute-change-and-relative-percentage-change-for-each-ipcc-class-category">Calculation of the percentage area, absolute change, and relative percentage change for each IPCC class category</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bar-chart-analysis"><strong>Bar Chart Analysis</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-eurostat-artificial-land-data">Comparison with EUROSTAT Artificial Land Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">5. Main Takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>