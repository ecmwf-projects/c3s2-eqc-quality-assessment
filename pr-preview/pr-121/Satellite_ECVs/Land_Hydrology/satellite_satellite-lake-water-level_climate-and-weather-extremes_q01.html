
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.5.1. Lake Victoria‚Äôs 2020 Flood Event Analysis &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_climate-and-weather-extremes_q01';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. Ocean" href="../Ocean/Ocean.html" />
    <link rel="prev" title="1.5. Land Hydrology" href="Land_Hydrology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Hydrology.html">1.5. Land Hydrology</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.5.1. Lake Victoria‚Äôs 2020 Flood Event Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_climate-and-weather-extremes_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_climate-and-weather-extremes_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lake Victoria‚Äôs 2020 Flood Event Analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-definition-of-the-2020-lake-victoria-flood-event-through-statistical-analysis">üåç Use case: Definition of the 2020 Lake Victoria flood event through statistical analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-request-and-download">1. Data request and download</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c3s-comparison-dahiti">2. C3S comparison DAHITI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-preprocess-dahiti-data">Load and preprocess DAHITI data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monthly-temporal-completeness">Monthly temporal completeness</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-c3s-and-dahiti-s-water-level">Plot C3S and DAHITI‚Äôs Water Level</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-reconstruction">3. Time series reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-preprocess-hydromet-data">Load and preprocess HYDROMET data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-the-datasets-together">Merging the datasets together</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-extreme-event-analysis">4. Probabilistic extreme event analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#event-definition">Event definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="lake-victorias-2020-flood-event-analysis">
<h1><span class="section-number">1.5.1. </span>Lake Victoria‚Äôs 2020 Flood Event Analysis<a class="headerlink" href="#lake-victorias-2020-flood-event-analysis" title="Link to this heading">#</a></h1>
<p>Production date: 28-05-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-definition-of-the-2020-lake-victoria-flood-event-through-statistical-analysis">
<h2>üåç Use case: Definition of the 2020 Lake Victoria flood event through statistical analysis<a class="headerlink" href="#use-case-definition-of-the-2020-lake-victoria-flood-event-through-statistical-analysis" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can extreme value analysis be applied to detect, define and quantify Lake Victoria‚Äôs 2020 Flood Event using the LWL v5.0 lake water level dataset?</strong></p></li>
</ul>
<p>In 2020, Lake Victoria experienced an extreme flood event with significant regional impacts. Accurate definition and characterization of such events are essential for understanding their causes and informing adaptation strategies. This notebook explores whether the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lake-water-level?tab=overview">satellite-lake-water-level</a> (C3S-LWL v5.0) dataset, a freely available and harmonized satellite-derived product, is suitable for defining high-impact flood events through statistical analysis.</p>
<p>Inspired by methodologies such as those applied by Pietrosanti et al. using the DAHITI dataset, this analysis applies extreme value analysis (EVA) to assess the 2020 flood event. The goal is to evaluate whether C3S-LWL v5.0 can serve as a reliable resource for event definition in impact attribution workflows, particularly in data-scarce regions like the Lake Victoria basin.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The 2020 event ranked as the third-highest 180-day lake level rise in the historical record (1948‚Äì2023), with only 1962 and 1998 recording greater increases.</p></li>
<li><p>The magnitude of the 2020 rise was 1.21 meters, identical in both the C3S-LWL and DAHITI datasets, strengthening confidence in the validity of satellite-based lake level measurements.</p></li>
<li><p>From 2016 onward, improved satellite coverage has led to strong agreement between C3S-LWL and DAHITI, demonstrating the potential of the C3S-LWL v5.0 dataset for reliable use in impact atribution, long-term hydrological analyses and flood risk projections.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-1"><span class="std std-ref">1. Data request and download</span></a></strong></p>
<ul class="simple">
<li><p>Download C3S‚ÄìLWL v5.0 satellite-lake-water-level data for Lake Victoria.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-2"><span class="std std-ref">2. C3S comparison DAHITI</span></a></strong></p>
<ul class="simple">
<li><p>Load and preprocess DAHITI data.</p></li>
<li><p>Plot monthly count of data recorded for both the DAHITI and C3S data.</p></li>
<li><p>Plot C3S and DAHITI‚Äôs Water Level and show the maximum difference.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-3"><span class="std std-ref">3. Time series reconstruction</span></a></strong></p>
<ul class="simple">
<li><p>Load and preprocess HYDROMET data.</p></li>
<li><p>Calculate the average difference between HYDROMET and C3S-LWL overlapping data and correct the HYDROMET dataset based on this.</p></li>
<li><p>Interpolate to fill missing gaps in HYDROMET.</p></li>
<li><p>Plot reconstructed time series.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-4"><span class="std std-ref">4. Probabilistic extreme event analysis</span></a></strong></p>
<ul class="simple">
<li><p>Apply the annual block maxima to the reconstructed time series.</p></li>
<li><p>Compare with the results from Pietroiusti et al. (2024) <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="data-request-and-download">
<span id="satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-1"></span><h3>1. Data request and download<a class="headerlink" href="#data-request-and-download" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<p>Import the packages to download the data using the c3s_eqc_automatic_quality_control library.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="o">,</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">genextreme</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/trigoso_camila/.cdsapirc&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-the-data-request">
<h4>Set the data request<a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<p>Set the request for the specific lake (Victoria in our case) analyzed and the collection id (satellite lake water level).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-lake-water-level&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="s2">&quot;southern_africa&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake&quot;</span><span class="p">:</span> <span class="s2">&quot;victoria&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s2">&quot;water_surface_height_above_reference_datum&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data">
<h4>Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 12.34it/s]
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="c3s-comparison-dahiti">
<span id="satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-2"></span><h3>2. C3S comparison DAHITI<a class="headerlink" href="#c3s-comparison-dahiti" title="Link to this heading">#</a></h3>
<section id="load-and-preprocess-dahiti-data">
<h4>Load and preprocess DAHITI data<a class="headerlink" href="#load-and-preprocess-dahiti-data" title="Link to this heading">#</a></h4>
<p>This assesment will apply the methods developed by Pietroiusti et al. (2024) <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>. On that paper, the DAHITI dataset <a class="reference external" href="https://hess.copernicus.org/articles/19/4345/2015/hess-19-4345-2015.html">[2]</a> was employed. Therefore, a comparison of water level of lake Victoria data in C3S-LWL v5.0 and in DAHITI will be carried out.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load DAHITI lake water levels</span>
<span class="n">df_dahiti</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/DAHITI_lake_victoria.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="c1"># ----- Prepare Data -----</span>
<span class="c1"># Convert df_dahiti datetime column and set it as index</span>
<span class="n">df_dahiti</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_dahiti</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Convert df_dahiti water level from millimeters to meters (if needed)</span>
<span class="n">df_dahiti</span><span class="p">[</span><span class="s1">&#39;water_level_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_dahiti</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span>
<span class="n">df_dahiti_o</span><span class="o">=</span><span class="n">df_dahiti</span>
<span class="n">df_dahiti</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="monthly-temporal-completeness">
<h4>Monthly temporal completeness<a class="headerlink" href="#monthly-temporal-completeness" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First dataset: xarray object</span>
<span class="n">monthly_counts_1</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Second dataset: Pandas DataFrame</span>
<span class="n">monthly_counts_2</span> <span class="o">=</span> <span class="n">df_dahiti</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># Create subplots with 1 row and 2 columns</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot first bar chart</span>
<span class="n">monthly_counts_1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Monthly Count of Available C3S-LWL v5.0 Water Level Values&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count of Available Values&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">monthly_counts_1</span><span class="p">),</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_counts_1</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Plot second bar chart</span>
<span class="n">monthly_counts_2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Monthly Count of Available DAHITI Water Level Values&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">monthly_counts_2</span><span class="p">),</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_counts_2</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/completeness.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/00c6487b6737d97042fba0e12975daa31a7cc69a6ece645483a2d5f5f39878c2.png" src="../../_images/00c6487b6737d97042fba0e12975daa31a7cc69a6ece645483a2d5f5f39878c2.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-completeness" style="width: 100%">
<img alt="../../_images/017e0bfa-a444-4633-bf0a-7c2e4daf6232.png" src="../../_images/017e0bfa-a444-4633-bf0a-7c2e4daf6232.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.1 </span><span class="caption-text">Comparison of count of monthly values over time available in the C3S-LWL v5.0 dataset (on the left) and in DAHITI (on the right).</span><a class="headerlink" href="#fig-completeness" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The DAHITI dataset exhibits a relatively consistent number of monthly observations, typically ranging from 1 to 4 throughout its entire temporal span. In contrast, the C3S-LWL v5.0 dataset shows variability in the number of monthly values, depending on the availability of satellite missions over time.
Up until the end of 2010, only one value per month was recorded. From 2011 to 2015, this number increased to mostly three observations per month, likely reflecting additional unfiltered data from the Jason-2 mission. A significant increase in observation frequency is evident from 2016 onward, corresponding to the introduction of Jason-3 and Sentinel-3A satellites. The C3S-LWL v5.0 dataset contains only one gap in 2006, indicating strong overall temporal completeness.</p>
<p>This can be explained by the fact that DAHITI applies interpolation using a Kalman filter, a statistical technique that predicts the water level at the next time step based on previous observations and associated uncertainties <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>. This allows DAHITI to maintain a nearly uniform temporal resolution, achieving approximately three observations per month even during periods with limited satellite overpasses. On the other hand, the C3S-LWL v5.0 dataset does not interpolate. It provides water level observations derived from satellite altimetry at the actual times satellites pass over a lake. According to the Algorithm Theoretical Basis Document <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">(ATBD)</a>, C3S applies strict data filtering based on two key criteria: (i) removal of measurements with invalid (NaN) geophysical corrections, and (ii) exclusion of data with backscatter coefficient (sigma0) values indicating land contamination. Consequently, more data from earlier missions is filtered out due to the lower quality of older satellite sensors and ground processing systems, which improved significantly in later years.</p>
</section>
<section id="plot-c3s-and-dahiti-s-water-level">
<h4>Plot C3S and DAHITI‚Äôs Water Level<a class="headerlink" href="#plot-c3s-and-dahiti-s-water-level" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract time series from xarray (da)</span>
<span class="n">da_df</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;water_level&#39;</span><span class="p">)</span>
<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">df_dahiti_o</span><span class="p">[</span><span class="s1">&#39;water_level_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DAHITI&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">da_df</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;C3S-LWL v5.0&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Final touches</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Lake Victoria Water Level Comparison Between Products&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water Level [m]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/comparisonDH.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/ef104f9c9b628087071066fe6a58c273fe08cf1f0b8bbfe8e5ba9873d43eaf87.png" src="../../_images/ef104f9c9b628087071066fe6a58c273fe08cf1f0b8bbfe8e5ba9873d43eaf87.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-comparisondh" style="width: 100%">
<img alt="../../_images/f53887f6-cfee-4af8-90b7-2fc3eb54b191.png" src="../../_images/f53887f6-cfee-4af8-90b7-2fc3eb54b191.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.2 </span><span class="caption-text">Lake Victoria‚Äôs water level from 1992 to present from C3S-LWL v5.0 and DAHITI</span><a class="headerlink" href="#fig-comparisondh" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract time series from xarray (da)</span>
<span class="n">df_c3s</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;water_level_c3s&#39;</span><span class="p">)</span>
<span class="n">df_c3s</span> <span class="o">=</span> <span class="n">df_c3s</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df_c3s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;datetime&#39;</span>

<span class="c1"># Align by nearest timestamp</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge_asof</span><span class="p">(</span>
    <span class="n">df_c3s</span><span class="p">,</span>
    <span class="n">df_dahiti</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;water_level_m&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;water_level_m&#39;</span><span class="p">:</span> <span class="s1">&#39;water_level_dahiti&#39;</span><span class="p">}),</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;3D&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Drop rows where no match was found</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">comparison_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Compute difference</span>
<span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;water_level_c3s&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;water_level_dahiti&#39;</span><span class="p">]</span>

<span class="c1"># Ensure the datetime column is in datetime format</span>
<span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span>

<span class="c1"># Define periods</span>
<span class="n">periods</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;1992-2002 (TOPEX/Poseidon)&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;1992-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2001-12&#39;</span><span class="p">),</span>
    <span class="s1">&#39;2002-2016&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;2002-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-12&#39;</span><span class="p">),</span>
    <span class="s1">&#39;2016-2023&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;2016-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Calculate average differences using the datetime column</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">periods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">comparison_df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">)</span>
    <span class="n">avg_diff</span> <span class="o">=</span> <span class="n">comparison_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s1">&#39;diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average difference for </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg_diff</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average difference for 1992-2002 (TOPEX/Poseidon): 0.332 m
Average difference for 2002-2016: 0.042 m
Average difference for 2016-2023: 0.083 m
</pre></div>
</div>
</div>
</div>
<p>The difference in water level estimates for Lake Victoria between the DAHITI and C3S-LWL v5.0 datasets varies noticeably over time (see <a class="reference internal" href="#fig-comparisondh"><span class="std std-numref">Fig. 1.5.1.2</span></a>). A larger discrepancy is observed during the first decade of the time series (1992-2002), when the only satellite data available originated from the TOPEX/Poseidon mission. During this period, the average difference between the two datasets is 33.2 cm in average, with C3S values consistently higher than those from DAHITI.</p>
<p>This early discrepancy appears to stem from differences in the algorithms and retracking methods used by the two datasets. DAHITI, in some cases, applies an improved 10% threshold retracker for better perfomance on inland water bodies, depending of the especific case. However, specific information on whether the 10% retracker was applied to Lake Victoria could not be confirmed, since available documentation only details its application forlakes in the Americas. Additionally, DAHITI employs a Kalman filter to interpolate and smooth its time series, further influencing the results <a class="reference external" href="https://hess.copernicus.org/articles/19/4345/2015/hess-19-4345-2015.html">[2]</a>. In contrast, according to the <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328942">ATBD</a>, the C3S-LWL v5.0 dataset uses a ocean model retracking for large lakes such as Lake Victoria</p>
<p>However, this difference diminishes noticeably after 2002 (less than 10 cm in average), as newer satellite missions introduced more frequent and accurate measurements. The influence of processing seems to be much smaller in later years, likely because the improvements in sensor technology and data availability reduce the impact of such methodological differences.</p>
<p>These findings are supported by the <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">PQAR</a>, which includes Lake Victoria under the Southern Africa region. According to the PQAR, the Pearson correlation coefficient between DAHITI and C3S in this region is very close to 1, and the Unbiased Root Mean Square Error (URMSE) remains below 25%, indicating strong overall agreement in this region.</p>
</section>
</section>
<section id="time-series-reconstruction">
<span id="satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-3"></span><h3>3. Time series reconstruction<a class="headerlink" href="#time-series-reconstruction" title="Link to this heading">#</a></h3>
<p>The code on this section is based on the work of Pietroiusti et al. (2024) <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>.</p>
<section id="load-and-preprocess-hydromet-data">
<h4>Load and preprocess HYDROMET data<a class="headerlink" href="#load-and-preprocess-hydromet-data" title="Link to this heading">#</a></h4>
<p>From January 1, 1948 to August 1, 1996, daily in situ water level measurements at the Jinja station were obtained from the WMO Hydrometeorological Survey (hereafter referred to as HYDROMET) <a class="reference external" href="https://library.wmo.int/records/item/54830-hydrometeorological-survey-of-the-catchments-of-lakes-victoria-kyoga-and-albert?offset=32">[3]</a>. These measurements, originally recorded as water depth at the lake‚Äôs outflow, were later converted to meters above sea level by adding a geoid correction of 1122.887 m, following the approach of Vanderkelen et al. (2018) <a class="reference external" href="https://hess.copernicus.org/articles/22/5509/2018/">[4]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load data</span>
<span class="n">HYDROMET_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data/wp5/trigoso_camila/q01/Water Level/Jinja_lakelevels_Van.txt&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
<span class="c1">#Pre-process data</span>
<span class="n">HYDROMET_raw</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;water level&#39;</span><span class="p">,</span> <span class="s1">&#39;meas&#39;</span><span class="p">]</span>
<span class="n">HYDROMET_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">HYDROMET_raw</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">]])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">HYDROMET_dates</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;water_level&#39;</span><span class="p">,</span> <span class="s1">&#39;meas&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">HYDROMET_raw</span><span class="p">[[</span><span class="s1">&#39;water level&#39;</span><span class="p">,</span> <span class="s1">&#39;meas&#39;</span><span class="p">]]</span>
<span class="n">HYDROMET</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="c1"># Replace HYDROMET zeros with NaN, so that Matplotlib won&#39;t connect the points</span>
<span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;meas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;meas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">HYDROMET</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>water_level</th>
      <th>meas</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1948-01-01</th>
      <td>1134.097</td>
      <td>11.210</td>
    </tr>
    <tr>
      <th>1948-01-02</th>
      <td>1134.102</td>
      <td>11.215</td>
    </tr>
    <tr>
      <th>1948-01-03</th>
      <td>1134.062</td>
      <td>11.175</td>
    </tr>
    <tr>
      <th>1948-01-04</th>
      <td>1134.052</td>
      <td>11.165</td>
    </tr>
    <tr>
      <th>1948-01-05</th>
      <td>1134.077</td>
      <td>11.190</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1996-07-28</th>
      <td>1134.777</td>
      <td>11.890</td>
    </tr>
    <tr>
      <th>1996-07-29</th>
      <td>1134.757</td>
      <td>11.870</td>
    </tr>
    <tr>
      <th>1996-07-30</th>
      <td>1134.752</td>
      <td>11.865</td>
    </tr>
    <tr>
      <th>1996-07-31</th>
      <td>1134.717</td>
      <td>11.830</td>
    </tr>
    <tr>
      <th>1996-08-01</th>
      <td>1134.747</td>
      <td>11.860</td>
    </tr>
  </tbody>
</table>
<p>17746 rows √ó 2 columns</p>
</div></div></div>
</div>
</section>
<section id="merging-the-datasets-together">
<h4>Merging the datasets together<a class="headerlink" href="#merging-the-datasets-together" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C3S</span><span class="o">=</span><span class="n">da_df</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">C3S</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;C3S&quot;</span><span class="p">)</span>
<span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HYDROMET&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water level [m]&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/initial.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/abd73b2efbe4e7e3891259fc983ed84235363fddc1b4e77156e9248cca53ff7d.png" src="../../_images/abd73b2efbe4e7e3891259fc983ed84235363fddc1b4e77156e9248cca53ff7d.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-initial" style="width: 100%">
<img alt="../../_images/9d1e4010-dcda-47ab-9103-beea2c887763.png" src="../../_images/9d1e4010-dcda-47ab-9103-beea2c887763.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.3 </span><span class="caption-text">HYDROMET (1948-1996) and C3S (1992-2023) datasets timeseries before correction.</span><a class="headerlink" href="#fig-initial" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>To obtain the reconstructed dataseries of Lake Victoria‚Äôs water levels it is necessary to perform a correction to HYDROMET data based on the overlaping period (1992-1996).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge the two time-series, key on date, keep all observations (outer)</span>
<span class="n">d_HYDROMET</span> <span class="o">=</span> <span class="n">HYDROMET</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;meas&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d_C3S</span> <span class="o">=</span> <span class="n">C3S</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">d_C3S</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">d_C3S</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">d_HYDROMET</span><span class="p">,</span> <span class="n">d_C3S</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HYDROMET&#39;</span><span class="p">,</span> <span class="s1">&#39;C3S&#39;</span><span class="p">]</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>

<span class="c1"># Get only the overlapping observations</span>
<span class="n">df_overlap</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;HYDROMET == HYDROMET &amp; C3S == C3S&#39;</span><span class="p">)</span>
<span class="n">df_overlap</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># 137 rows [1992-09-28 : 1996-07-18] </span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HYDROMET</th>
      <th>C3S</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1992-09-28</th>
      <td>1134.567</td>
      <td>1135.32</td>
    </tr>
    <tr>
      <th>1992-10-18</th>
      <td>1134.572</td>
      <td>1135.30</td>
    </tr>
    <tr>
      <th>1992-11-15</th>
      <td>1134.597</td>
      <td>1135.36</td>
    </tr>
    <tr>
      <th>1992-12-16</th>
      <td>1134.672</td>
      <td>1135.43</td>
    </tr>
    <tr>
      <th>1993-01-14</th>
      <td>1134.767</td>
      <td>1135.54</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">avg_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_overlap</span><span class="p">[</span><span class="s1">&#39;C3S&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_overlap</span><span class="p">[</span><span class="s1">&#39;HYDROMET&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># C3S overestimates vs. HYDROMET</span>
<span class="n">n_diff</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_overlap</span><span class="p">)</span>
<span class="n">std_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_overlap</span><span class="p">[</span><span class="s1">&#39;C3S&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_overlap</span><span class="p">[</span><span class="s1">&#39;HYDROMET&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;avg_diff =&#39;</span><span class="p">,</span> <span class="n">avg_diff</span><span class="p">,</span>  <span class="s1">&#39;n_diff =&#39;</span><span class="p">,</span> <span class="n">n_diff</span><span class="p">,</span> <span class="s1">&#39;std_diff =&#39;</span><span class="p">,</span> <span class="n">std_diff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;avg_diff_r =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">avg_diff</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;std_diff_r =&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">std_diff</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="c1"># DATHI2022 data: Avg diff is 43.2 cm +/- 5.24 cm (one std)</span>
<span class="c1"># C3S2023 data: Avg diff is 77.8 cm +/- 3 cm (one std)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avg_diff = 0.7777871747927428 n_diff = 47 std_diff = 0.02967133397421761
avg_diff_r = 0.778 std_diff_r = 0.03
</pre></div>
</div>
</div>
</div>
<p>The mean difference between the two datasets is 77.8 ¬± 3.0 cm, while the average offset between HYDROMET and DAHITI was 43.2 ¬± 5.24 cm <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Snap the two timeseries together, add avg diff to HYDROMET </span>
<span class="n">HYDROMET_corr</span> <span class="o">=</span> <span class="n">HYDROMET</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">HYDROMET_corr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HYDROMET</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">round</span><span class="p">(</span><span class="n">avg_diff</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="c1"># === Left Plot: Full time series ===</span>
<span class="n">HYDROMET_corr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HYDROMET&quot;</span><span class="p">)</span>
<span class="n">C3S</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;C3S&quot;</span><span class="p">)</span>

<span class="n">min_date</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">HYDROMET_corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">C3S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="n">max_date</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">HYDROMET_corr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">C3S</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">min_date</span><span class="p">,</span> <span class="n">max_date</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Full Time Series&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water level [m]&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === Right Plot: Zoomed section ===</span>
<span class="n">C3S</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;C3S&quot;</span><span class="p">)</span>
<span class="n">HYDROMET_corr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HYDROMET&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="s1">&#39;1992-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;1997-01-10&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Zoomed View: 1992‚Äì1997&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;C3S 2023 data </span><span class="se">\n</span><span class="s2">Avg diff with HYDROMET is 77.8 cm ¬± 3 cm&quot;</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
             <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="c1"># === Layout &amp; Save ===</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/corrected_combined.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/a6c67839726245aebecce6fc9b0509b1e5d274ef991399c7892d51e00f430a6d.png" src="../../_images/a6c67839726245aebecce6fc9b0509b1e5d274ef991399c7892d51e00f430a6d.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-corrected" style="width: 100%">
<img alt="../../_images/19d08709-ecfe-4d73-aa3e-0170ad23724d.png" src="../../_images/19d08709-ecfe-4d73-aa3e-0170ad23724d.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.4 </span><span class="caption-text">HYDROMET (1948-1996) and C3S (1992-2023) datasets timeseries after correction.</span><a class="headerlink" href="#fig-corrected" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>A single dataset of with both sourceds was created. The when C3S LWL-v5.0 was available it was replaced and the gaps in HYDROMET filled by interpolation</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#CORRECT FOR DIFFERENCE</span>
<span class="n">startHYDROMET</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1948-01-01&#39;</span><span class="p">)</span>
<span class="n">endHYDROMET</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1996-08-01&#39;</span><span class="p">)</span>

<span class="n">startC3S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;1992-09-28&#39;</span><span class="p">)</span>
<span class="n">endC3S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2023-12-27&#39;</span><span class="p">)</span> 

<span class="n">HYDROMET_keep</span> <span class="o">=</span> <span class="n">HYDROMET_corr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">startHYDROMET</span> <span class="p">:</span> <span class="p">(</span><span class="n">startC3S</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s2">&quot;1 day&quot;</span><span class="p">))</span> <span class="p">]</span>
<span class="n">HYDROMET_keep</span> <span class="o">=</span> <span class="n">HYDROMET_keep</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;meas&#39;</span><span class="p">])</span>

<span class="c1"># Overwriting time-series with C3S where available</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#To have only one valule per day </span>
<span class="n">C3S_keep</span> <span class="o">=</span> <span class="n">C3S</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="n">C3S_keep</span> <span class="o">=</span> <span class="n">C3S_keep</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="c1"># Make only one list with HYDROMET+C3S data</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">HYDROMET_keep</span><span class="p">,</span> <span class="n">C3S_keep</span><span class="p">]</span>
<span class="n">lakelevels_all_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Round to 2 sig figs </span>
<span class="n">lakelevels_all</span> <span class="o">=</span> <span class="n">lakelevels_all_raw</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanL</span> <span class="o">=</span> <span class="n">lakelevels_all</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">maxL</span> <span class="o">=</span> <span class="n">lakelevels_all</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">minL</span> <span class="o">=</span> <span class="n">lakelevels_all</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">mtrim</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">trim_mean</span><span class="p">(</span><span class="n">lakelevels_all</span><span class="p">[[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]],</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">mtrim</span> <span class="o">=</span> <span class="n">mtrim</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p10</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">lakelevels_all</span><span class="p">[[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]],</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># 10th percentile </span>
<span class="n">p90</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">lakelevels_all</span><span class="p">[[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]],</span> <span class="mi">90</span><span class="p">)</span> <span class="c1"># 90th percentile </span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate to daily res and round to 2 sig figs</span>
<span class="n">lakelevels_intr</span> <span class="o">=</span> <span class="n">lakelevels_all</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">asfreq</span><span class="p">()</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">left</span> <span class="o">=</span> <span class="s1">&#39;1948-01-01&#39;</span>
<span class="n">right</span> <span class="o">=</span> <span class="s1">&#39;2023-12-27&#39;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">lakelevels_intr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HYDROMET and C3S merged&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water level [m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
<span class="n">plot_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mean: </span><span class="si">{:.2f}</span><span class="s1">, max </span><span class="si">{:.2f}</span><span class="s1">, min </span><span class="si">{:.2f}</span><span class="s1">, range </span><span class="si">{:.2f}</span><span class="s1">, </span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> mtrim </span><span class="si">{:.2f}</span><span class="s1">, p10 </span><span class="si">{:.2f}</span><span class="s1">, p90 </span><span class="si">{:.2f}</span><span class="s1"> [m] </span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> start date: </span><span class="si">{}</span><span class="s1">, end date: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> </span><span class="se">\n</span><span class="s1"> HM 1948-1992, C3S 1992-2023&#39;</span>
             <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">meanL</span><span class="p">,</span> <span class="n">maxL</span><span class="p">,</span> <span class="n">minL</span><span class="p">,</span> <span class="n">maxL</span><span class="o">-</span><span class="n">minL</span><span class="p">,</span> <span class="n">mtrim</span><span class="p">,</span> <span class="n">p10</span><span class="p">,</span><span class="n">p90</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))</span>  <span class="c1">#, start date {:.3f}, end date {:.3f} </span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="p">(</span><span class="n">plot_text</span><span class="p">),</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> 
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">YearLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/reconstructed.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/fcedbfbd7588bdd99e48b324dcffbb4527cd21a6bdf3018e2085258706a33a6d.png" src="../../_images/fcedbfbd7588bdd99e48b324dcffbb4527cd21a6bdf3018e2085258706a33a6d.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-reconstructed" style="width: 100%">
<img alt="../../_images/dfd3858a-2054-4ce8-b334-2e2451c1b6b4.png" src="../../_images/dfd3858a-2054-4ce8-b334-2e2451c1b6b4.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.5 </span><span class="caption-text">Reconstructed Lake Victoria‚Äôs water levels timeseries (1948-2023).</span><a class="headerlink" href="#fig-reconstructed" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="probabilistic-extreme-event-analysis">
<span id="satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-4"></span><h3>4. Probabilistic extreme event analysis<a class="headerlink" href="#probabilistic-extreme-event-analysis" title="Link to this heading">#</a></h3>
<p>Pietroiusti et al. (2024) <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a> assessed the influence of anthropogenic climate change on the 2020 Lake Victoria floods using the extreme event attribution framework outlined by Philip et al. (2020) <a class="reference external" href="https://ascmo.copernicus.org/articles/6/177/2020/">[5]</a> and van Oldenborgh et al. (2021) <a class="reference external" href="https://link.springer.com/article/10.1007/s10584-021-03071-7">[6]</a>. The methodology follows a structured sequence of steps: (i) defining the event, (ii) estimating probabilities and trends based on observational data, (iii) validating climate models, (iv) conducting attribution using multiple models and methods, and (v) synthesizing the findings into clear attribution statements.</p>
<p>In this assessment, only the first step, event definition, is performed, using reconstructed Lake Victoria water level time series from the HYDROMET dataset and the C3S LWL-v5.0 product. The aim is to assess whether the C3S LWL-v5.0 dataset is suitable for use in attribution analyses of this kind. While the remaining steps involve model simulations and additional data sources that are beyond the scope of this work, the assumption is that if the observational component is consistent, the full attribution framework could, in principle, be applied using this dataset as well.</p>
<section id="event-definition">
<h4>Event definition<a class="headerlink" href="#event-definition" title="Link to this heading">#</a></h4>
<p>The varaible chosen for analysis is rate of change in water levels (ŒîL) over a tme-window (Œît). The Œît chosen was 180 days since most of the level rise in the flooding event of 2020 in Lake Victoria ocurred in the 6 months period between November 2019 and May 2020 <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>.</p>
<p>The annual block maxima was calculated to retain the maximum ŒîL over a 180 days ocurred in each year.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Step 1: Set the time window (dt) ===</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">180</span>  <span class="c1"># days</span>
<span class="n">lakelevels_intr</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lakelevels_intr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">lakelevels_intr</span><span class="p">[</span><span class="s1">&#39;water_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

<span class="c1"># === Step 2: Extract annual block maxima ===</span>
<span class="n">df_block</span> <span class="o">=</span> <span class="n">lakelevels_intr</span><span class="p">[[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_block</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_block</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>

<span class="c1"># Keep only years with full data</span>
<span class="n">all_years</span> <span class="o">=</span> <span class="n">df_block</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">if</span> <span class="n">df_block</span><span class="p">[</span><span class="n">df_block</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">all_years</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">365</span><span class="p">:</span>
    <span class="n">valid_years</span> <span class="o">=</span> <span class="n">all_years</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">valid_years</span> <span class="o">=</span> <span class="n">all_years</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">valid_years</span><span class="p">:</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">df_block</span><span class="p">[</span><span class="n">df_block</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">year_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">max_day</span> <span class="o">=</span> <span class="n">year_data</span><span class="p">[</span><span class="n">year_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_val</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">records</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">year</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">max_day</span><span class="p">))</span>

<span class="n">df_max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>

<span class="c1"># === Step 3: Calculate rank of each year ===</span>
<span class="n">df_max</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_max</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># === Step 4: Print 2020 event details ===</span>
<span class="k">if</span> <span class="mi">2020</span> <span class="ow">in</span> <span class="n">df_max</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">df_max</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2020</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="n">df_max</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2020</span><span class="p">,</span> <span class="s1">&#39;rank&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîπ 2020 ŒîL/Œît (180 days): </span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üîπ 2020 Rank: </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_max</span><span class="p">)</span><span class="si">}</span><span class="s2"> years&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2020 is not in the index. Check your data coverage.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üîπ 2020 ŒîL/Œît (180 days): 1.210 m
üîπ 2020 Rank: 3 out of 74 years
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure rolling mean exists</span>
<span class="n">df_max</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_max</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Get top 3 values</span>
<span class="n">top3</span> <span class="o">=</span> <span class="n">df_max</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># === Plot ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="c1"># Step plot for annual maxima (red)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">df_max</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_max</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Annual max (Œît = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1"> days)&#39;</span><span class="p">)</span>

<span class="c1"># Rolling mean (green)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_max</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_max</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;10-year rolling mean&#39;</span><span class="p">)</span>

<span class="c1"># Top 3 events (black markers + labels)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">top3</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;dLdt_</span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.02</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Labels, title, grid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Annual Block Maxima of ŒîL/Œît (Œît = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1"> days), 1948‚Äì2021&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ŒîL/Œît max (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/q01/Water Level/fig/anual_block_maxima.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/004ee4728001b5ef88c63419b06c90d5c7776d3d1a5d561fe9135e1aee4308a8.png" src="../../_images/004ee4728001b5ef88c63419b06c90d5c7776d3d1a5d561fe9135e1aee4308a8.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-annual-block-maxima" style="width: 100%">
<img alt="../../_images/5fede85b-25bb-4126-9f51-b1050a26ae3a.png" src="../../_images/5fede85b-25bb-4126-9f51-b1050a26ae3a.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.6 </span><span class="caption-text">Annual block maxima time series <span class="math notranslate nohighlight">\((\Delta L / \Delta t)_{\text{max}}\)</span> with Œît=180‚Äâd for the period 1897‚Äì2021 and 10-year rolling mean of the time series (using C3S-LWL v5.0 data).</span><a class="headerlink" href="#fig-annual-block-maxima" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-block-rosa" style="width: 100%">
<img alt="../../_images/e4f5e3f5-af36-4613-9df5-03a4f99fde20.png" src="../../_images/e4f5e3f5-af36-4613-9df5-03a4f99fde20.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.7 </span><span class="caption-text">Annual block maxima time series <span class="math notranslate nohighlight">\((\Delta L / \Delta t)_{\text{max}}\)</span> with Œît=180‚Äâd for the period 1897‚Äì2021 and 10-year rolling mean of the time series (using DAHITI data). Source: Pietroiusti et al. (2022) <a class="reference external" href="https://cris.vub.be/ws/portalfiles/portal/95073120/Geography_MSc_thesis_Rosa_Pietroiusti_final.pdf">[7]</a></span><a class="headerlink" href="#fig-block-rosa" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The results of this analysis are consistent with those reported by Pietroiusti et al. (2024) <a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a>. According to the C3S-LWL v5.0 dataset, the year 2020 recorded the third-largest 180-day lake level rise, surpassed only by 1962 and 1998. The magnitude of the 2020 rise was 1.21 meters, which matches the value obtained by Pietroiusti et al. using the DAHITI dataset.</p>
<p>However, some discrepancies emerge when comparing other years. For instance, in 2000, the C3S-LWL v5.0 data shows a negative value, indicating a consistent decrease in lake levels throughout the year (see <a class="reference internal" href="#fig-annual-block-maxima"><span class="std std-numref">Fig. 1.5.1.6</span></a>). Conversely, the corresponding figure in Pietroiusti et al. (2022) <a class="reference external" href="https://cris.vub.be/ws/portalfiles/portal/95073120/Geography_MSc_thesis_Rosa_Pietroiusti_final.pdf">[7]</a> (see <a class="reference internal" href="#fig-block-rosa"><span class="std std-numref">Fig. 1.5.1.7</span></a>) shows a slightly positive value.</p>
<p>These differences likely stem from variations in the underlying datasets, as discussed in <a class="reference internal" href="#satellite-satellite-lake-water-level-climate-and-weather-extremes-q01-section-2"><span class="std std-ref">2. C3S comparison DAHITI</span></a>. In 2000, TOPEX/Poseidon was still the only mission providing data for the C3S-LWL, with only one value per month. Meanwhile, DAHITI applied Kalman-filtered interpolation, resulting in a denser time series. Because no reliable in situ data are available for this period, it is difficult to determine which dataset more accurately reflects reality.</p>
<p>Nevertheless, the agreement between both datasets on the 2020 block maximum strengthens confidence in the reliability of this result. Although C3S-LWL and DAHITI use different processing algorithms, the increased availability of satellite observations in recent years (particularly after 2016) has led to more similar their outputs. With more frequent and higher-quality measurements from multiple missions, the differences between the datasets diminish, making the 1.21 meter increase observed in 2020 not only consistent across sources, but also giving more confidence in the result.</p>
<p>Furthermore, the C3S-LWL v5.0 dataset could potentially be used to support future hydrological analyses and projections <a class="reference external" href="https://doi.org/10.5194/hess-22-5527-2018">[9]</a>, particularly in regions where in situ data are limited or unavailable</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>NASA (2021). <a class="reference external" href="https://earthobservatory.nasa.gov/images/148414/lake-victorias-rising-waters">Lake Victoria‚Äôs Rising Waters</a></p></li>
<li><p>ACSA Uganda &amp; Uganda Coalition for Sustainble Development (UCSD) (2020). <a class="reference external" href="https://acsa-ug.org/wordpress/wp-content/uploads/2020/06/THE-IMPLICATION-OF-FLOODS-TO-FOOD-SECURITY-DURING-AND-THE-AFTERMATH-OF-COVID19-PANDEMIC-IN-UGANDA.pdf">The Implication of Floods to Food Security During and the Aftermath of COVID-19 Pandemic in Uganda</a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
<p>Dataset documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328964">LWL v5.0 and LWL-S v1.0: Product User Guide and Specification (PUGS)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328942">LWL v5.0 and LWL-S v1.0: Algorithm Theoretical Basis Document (ATBD)</a></p></li>
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">LWL v5.0 and LWL-S v1.0: Product Quality Assessment Report (PQAR)</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://esd.copernicus.org/articles/15/225/2024/">[1]</a> Pietroiusti, R., Vanderkelen, I., Otto, F. E. L., Barnes, C., Temple, L., Akurut, M., Bally, P., van Lipzig, N. P. M., and Thiery, W. (2024). Possible role of anthropogenic climate change in the record-breaking 2020 Lake Victoria levels and floods, Earth Syst. Dynam., 15, 225‚Äì264.</p>
<p><a class="reference external" href="https://hess.copernicus.org/articles/19/4345/2015/hess-19-4345-2015.html">[2]</a> Schwatke, C., Dettmering, D., Bosch, W., and Seitz, F. (2015). DAHITI - an innovative approach for estimating water level time series over inland waters using multi-mission satellite altimetry: , Hydrol. Earth Syst. Sci., 19, 4345-4364.</p>
<p><a class="reference external" href="https://library.wmo.int/records/item/54830-hydrometeorological-survey-of-the-catchments-of-lakes-victoria-kyoga-and-albert?offset=32">[3]</a> WMO-UNPD (1974). Hydrometeorological Survey of the Catchments of Lakes Victoria, Kyoga
and Albert: Vol 1 Meteorology and Hydrology of the Basin.</p>
<p><a class="reference external" href="https://hess.copernicus.org/articles/22/5509/2018/">[4]</a> Vanderkelen, I., Van Lipzig, N. P., and Thiery, W. (2018). Modelling the water balance of Lake Victoria (East Africa)-Part 1: Observational analysis. Hydrology and Earth System Sciences, 22(10):5509‚Äì5525.</p>
<p><a class="reference external" href="https://ascmo.copernicus.org/articles/6/177/2020/">[5]</a> Philip, S., Kew, S., van Oldenborgh, G. J., Otto, F., Vautard, R., van der Wiel, K., King, A., Lott, F., Arrighi, J., Singh, R., and van Aalst, M. (2020). A protocol for probabilistic extreme event attribution analyses, Adv. Stat. Clim. Meteorol. Oceanogr., 6, 177‚Äì203.</p>
<p><a class="reference external" href="https://link.springer.com/article/10.1007/s10584-021-03071-7">[6]</a> G. J. van Oldenborgh, K. van der Wiel, S. Kew, S. Philip, F. Otto, R. Vautard, A. King, F. Lott, J. Arrighi, R. Singh, and M. van Aalst. Pathways and pitfalls in extreme event attribution.  Climatic Change, vol. 166, no. 1, p. 13, 2021.</p>
<p><a class="reference external" href="https://cris.vub.be/ws/portalfiles/portal/95073120/Geography_MSc_thesis_Rosa_Pietroiusti_final.pdf">[7]</a> Pietroiusti, R., Vanderkelen, I., van Lipzig, N. P. M., and Thiery, W. (2022). Was the 2020 Lake Victoria flooding ‚Äòcaused‚Äô by anthropogenic climate change? An event attribution study. <a class="reference external" href="http://M.Sc">M.Sc</a>. thesis, Dept. of Hydrology and Climate, Vrije Universiteit Brussel and KU Leuven.</p>
<p><a class="reference external" href="https://link.springer.com/book/10.1007/978-1-4471-3675-0">[8]</a> Coles, S. (2001). An Introduction to Statistical Modeling of Extreme Values. Springer Series in Statistics. Springer-Verlag London. ISBN: 978-1-85233-459-8.</p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-22-5527-2018">[9]</a> Vanderkelen, I., van Lipzig, N. P. M., and Thiery, W. (2018). Modelling the water balance of Lake Victoria (East Africa) ‚Äì Part 2: Future projections, Hydrol. Earth Syst. Sci., 22, 5527‚Äì5549.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Hydrology"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Hydrology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
    </a>
    <a class="right-next"
       href="../Ocean/Ocean.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-definition-of-the-2020-lake-victoria-flood-event-through-statistical-analysis">üåç Use case: Definition of the 2020 Lake Victoria flood event through statistical analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-request-and-download">1. Data request and download</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c3s-comparison-dahiti">2. C3S comparison DAHITI</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-preprocess-dahiti-data">Load and preprocess DAHITI data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#monthly-temporal-completeness">Monthly temporal completeness</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-c3s-and-dahiti-s-water-level">Plot C3S and DAHITI‚Äôs Water Level</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-reconstruction">3. Time series reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-preprocess-hydromet-data">Load and preprocess HYDROMET data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-the-datasets-together">Merging the datasets together</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilistic-extreme-event-analysis">4. Probabilistic extreme event analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#event-definition">Event definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>