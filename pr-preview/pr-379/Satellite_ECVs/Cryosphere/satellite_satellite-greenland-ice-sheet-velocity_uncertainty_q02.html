
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.3.1. Ice sheet velocity data from satellite observations: temporal and spatial variability of velocity-related uncertainties for glaciological applications &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_uncertainty_q02';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4. Land Biosphere" href="../Land_Biosphere/Land_Biosphere.html" />
    <link rel="prev" title="1.3. Cryosphere" href="Cryosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Cryosphere.html">1.3. Cryosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.3.1. Ice sheet velocity data from satellite observations: temporal and spatial variability of velocity-related uncertainties for glaciological applications</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_uncertainty_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_uncertainty_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ice sheet velocity data from satellite observations: temporal and spatial variability of velocity-related uncertainties for glaciological applications</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-remote-sensing-derived-ice-sheet-surface-flow-velocities-for-the-calibration-or-validation-of-a-simulation-with-an-ice-sheet-model">🌍 Use case: Using remote sensing-derived ice sheet surface flow velocities for the calibration or validation of a simulation with an ice sheet model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-and-sub-sections">Structure and (sub)sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation-and-processing">1. Data preparation and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1 Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request-and-download">1.2 Define request and download</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-and-inspect-data-structure">1.3 Display and inspect data structure</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-sheet-flow-velocities-and-their-uncertainty-estimates-in-space-and-time">2. Ice sheet flow velocities and their uncertainty estimates in space and time</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#average-horizontal-ice-flow-velocities">2.1 Average horizontal ice flow velocities</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-flow-velocity-uncertainty-accuracy-and-precision">2.2 Ice flow velocity uncertainty: accuracy and precision</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-gris">2.3 Spatio-temporal distribution of ice flow velocity uncertainty for the GrIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-ais">2.4 Spatio-temporal distribution of ice flow velocity uncertainty for the AIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#valid-measurement-counts-for-the-surface-ice-flow-velocity">3. Valid measurement counts for the surface ice flow velocity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-gris">3.1 Spatio-temporal distribution of ice flow velocity valid pixel counts for the GrIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-ais">3.2 Spatio-temporal distribution of ice flow velocity valid pixel counts for the AIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-use-of-horizontal-ice-flow-velocity-data-in-an-ice-sheet-modelling-framework">4. Implications for use of horizontal ice flow velocity data in an ice sheet modelling framework</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-sheet-model-initialisation-and-tuning-of-the-surface-flow-velocity-field">4.1 Ice sheet model initialisation and tuning of the surface flow velocity field</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#presence-of-arteficial-striping">4.2 Presence of arteficial ‘striping’</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#short-summary-and-take-home-messages">5. Short summary and take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="ice-sheet-velocity-data-from-satellite-observations-temporal-and-spatial-variability-of-velocity-related-uncertainties-for-glaciological-applications">
<h1><span class="section-number">1.3.1. </span>Ice sheet velocity data from satellite observations: temporal and spatial variability of velocity-related uncertainties for glaciological applications<a class="headerlink" href="#ice-sheet-velocity-data-from-satellite-observations-temporal-and-spatial-variability-of-velocity-related-uncertainties-for-glaciological-applications" title="Link to this heading">#</a></h1>
<p>Production date: 31-05-2025</p>
<p>Dataset version: 1.3 to 1.5</p>
<p>Produced by: Yoni Verhaegen and Philippe Huybrechts (Vrije Universiteit Brussel)</p>
<section id="use-case-using-remote-sensing-derived-ice-sheet-surface-flow-velocities-for-the-calibration-or-validation-of-a-simulation-with-an-ice-sheet-model">
<h2>🌍 Use case: Using remote sensing-derived ice sheet surface flow velocities for the calibration or validation of a simulation with an ice sheet model<a class="headerlink" href="#use-case-using-remote-sensing-derived-ice-sheet-surface-flow-velocities-for-the-calibration-or-validation-of-a-simulation-with-an-ice-sheet-model" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>“How does the uncertainty of the horizontal ice sheet surface flow velocity vary in space and time and is the dataset sufficiently accurate and precise to be used in an ice sheet modeling framework?”</strong></p></li>
</ul>
<p>Ice sheets are not static, but instead flow. The total velocity magnitude is the sum of the velocity related to internal ice deformation, and is complemented by basal sliding and bed deformation components. Mapping ice sheet surface flow velocities and their temporal changes provides key information for investigating the dynamic response of the ice sheets to climate change. Remote sensing techniques, such as the use of satellites, are an important feature to derive and study these flow velocities. Satellites are able to inspect directly and repeatedly large areas of ice, and, as such are able to detect the movement of its surface. Remote sensing techniques that use satellite data are therefore considered the only feasible manner to derive accurate surface velocities of the ice sheets on a regular basis. In this dataset, they are derived by applying offset tracking techniques using Sentinel-1 synthetic aperture radar (SAR) satellite data. The main principle of the “<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-greenland-ice-sheet-velocity?tab=overview" rel="noreferrer" target="_blank">Ice sheet velocity for Antarctica and Greenland derived from satellite observations</a>” dataset therefore relies on the preservation of surface features or other detectable patterns (e.g. speckle) in between multiple image acquisition periods. The extraction of these features/patterns from images acquired over different time periods is used to detect their displacements, and with further processing this information can be used to derive velocity fields [<a class="reference external" href="https://doi.org/10.3390/rs70709371" rel="noreferrer" target="_blank">1</a>].</p>
<p>This notebook investigates how well the dataset on the CDS (here we use versions 1.3 to 1.5) can be used in the context of an ice sheet modelling framework for Greenland and Antarctica. More specifically, the notebook evaluates whether the dataset is of sufficient maturity and quality for that purpose in terms of its spatio-temporal coverage and uncertainty.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Ice velocity (“displacement”) observation by satellites is a useful tool to grasp the overall patterns of flow dynamics of the ice sheets. The C3S ice sheet velocity dataset provides annually averaged surface velocities for both the Greenland (GrIS) and Antarctic (AIS) Ice Sheets at a high spatial resolution that meets international proposed standards. However, the temporal extent of the data series is rather short and significant data gaps remain over the interior of the AIS.</p></li>
<li><p>Data quality in terms of error and uncertainty can be assessed by two variables: the standard deviation (as a precision error estimate) and the valid pixel count maps (as the total number of valid measurements used in the annually averaged velocity estimate over 1 year of data acquisition). Consulting the accompanying standard deviation and the valid measurement count maps is therefore recommended to assess the error and uncertainty characterization of the product. The majority of pixels meet the proposed GCOS thresholds in terms of uncertainty. However, data quality can be slightly lower in some regions (due to ‘striping’, higher error values and/or lower valid measurements). Errors are furthermore provided as absolute values, while for flow fields, the relative error is generally considered to be more useful.</p></li>
<li><p>Due to the high spatial resolution/coverage and the quality-rich uncertainty characterization, the C3S ice sheet velocity dataset is particularly well-suited for the use as a calibration or validation tool within an ice sheet modelling framework. The user can, if desired, prioritize high-quality data (i.e. pixels with low absolute or relative errors and/or high valid pixel counts) when adjusting tuning parameters in an ice sheet model, such that the modelled ice thickness or surface velocity matches the observed one as close as possible.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<section id="dataset-description">
<h3>Dataset description<a class="headerlink" href="#dataset-description" title="Link to this heading">#</a></h3>
<p>The ‘Ice sheet velocity for Antarctica and Greenland derived from satellite observations’ dataset, available on the Climate Data Store (CDS), offers annually averaged surface ice flow velocities and their easting and northing components for the Antarctic (AIS) and Greenland (GrIS) Ice Sheets. This data is provided on a spatial resolution grid of either 200 m, 250 m or 500 m, depending on the ice sheet and dataset version. The dataset includes horizontal velocity components in the east and north directions, as well as the total horizontal velocity magnitude and its uncertainty, expressed as 1-sigma precission errors. Surface flow velocities are treated as “displacements”, normalized to true meters per day, and are available for each glaciological year since 2014-2015 for the GrIS and since 2021-2022 for the AIS. The horizontal velocities and their components are derived using offset tracking techniques with Sentinel-1 synthetic aperture radar (SAR) satellite data. The data are provided in NetCDF format as gridded data fields in Polar Stereographic projection, covering the entire GrIS domain, including peripheral glaciers and ice caps.</p>
</section>
<section id="structure-and-sub-sections">
<h3>Structure and (sub)sections<a class="headerlink" href="#structure-and-sub-sections" title="Link to this heading">#</a></h3>
<p><strong><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1"><span class="std std-ref">1. Data preparation and processing</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-1"><span class="std std-ref">1.1 Import packages</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-2"><span class="std std-ref">1.2 Define request and download</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-3"><span class="std std-ref">1.3 Display and inspect data structure</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2"><span class="std std-ref">2. Ice sheet flow velocities and their uncertainty estimates in space and time</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-1"><span class="std std-ref">2.1 Average horizontal ice flow velocities</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-2"><span class="std std-ref">2.2 Ice flow velocity uncertainty: accuracy and precision</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-3"><span class="std std-ref">2.3 Spatio-temporal distribution of ice flow velocity uncertainty for the GrIS</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-4"><span class="std std-ref">2.4 Spatio-temporal distribution of ice flow velocity uncertainty for the AIS</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3"><span class="std std-ref">3. Valid measurement counts for the surface ice flow velocity</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3-1"><span class="std std-ref">3.1 Spatio-temporal distribution of ice flow velocity valid pixel counts for the GrIS</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3-2"><span class="std std-ref">3.2 Spatio-temporal distribution of ice flow velocity valid pixel counts for the AIS</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4"><span class="std std-ref">4. Implications for use of horizontal ice flow velocity data in an ice sheet modelling framework</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4-1"><span class="std std-ref">4.1 Ice sheet model initialisation and tuning of the surface flow velocity field</span></a></p></li>
<li><p><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4-2"><span class="std std-ref">4.2 Presence of arteficial ‘striping’</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-5"><span class="std std-ref">5. Short summary and take-home messages</span></a></strong></p>
</section>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="data-preparation-and-processing">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1"></span><h3>1. Data preparation and processing<a class="headerlink" href="#data-preparation-and-processing" title="Link to this heading">#</a></h3>
<section id="import-packages">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-1"></span><h4>1.1 Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<p>First we load the packages:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ticker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">circmean</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/verhaegen_yoni/.cdsapirc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-request-and-download">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-2"></span><h4>1.2 Define request and download<a class="headerlink" href="#define-request-and-download" title="Link to this heading">#</a></h4>
<p>Then we define requests for download from the CDS and download the GrIS and AIS velocity data and immediately perform some data handling to make the dataset more readable.</p>
<p>🚨 <strong>The files can be large! Since the data files to be downloaded are of considerable size due to the high spatial resolution, this may take a couple of minutes.</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">periods</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;greenland_ice_sheet&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2014_2015&quot;</span><span class="p">,</span> <span class="s2">&quot;2022_2023&quot;</span><span class="p">],</span>
    <span class="s2">&quot;antarctic_ice_sheet&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2021_2022&quot;</span><span class="p">,</span> <span class="s2">&quot;2022_2023&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">periods</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading ice sheet velocity data, this make take a couple of minutes...&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_std_flowdirection_and_reform</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># Add period dim</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;to&quot;</span><span class="p">)</span>
    <span class="n">period</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">start</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">stop</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="p">[</span><span class="n">period</span><span class="p">])</span>

    <span class="c1"># Compute standard deviation</span>
    <span class="n">std</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_easting_stddev&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_northing_stddev&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">std</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Velocity standard deviation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_easting_stddev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;m/year&quot;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span>

    <span class="c1"># Flow direction</span>
    <span class="n">angle_radians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_northing_velocity&quot;</span><span class="p">],</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_easting_velocity&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">angle_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">angle_radians</span><span class="p">)</span>
    <span class="n">flow_direction</span> <span class="o">=</span> <span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">angle_degrees</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="n">flow_direction</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Flow direction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_flow_direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_direction</span>

    <span class="c1"># Keep only selected variables</span>
    <span class="n">keep_vars</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;land_ice_surface_measurement_count&quot;</span><span class="p">,</span>
        <span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;land_ice_flow_direction&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">keep_vars</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;chunksizes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">postprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;land_ice_surface_measurement_count&quot;</span><span class="p">:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;image pairs&quot;</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Count of valid measurements&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;land_ice_flow_direction&quot;</span><span class="p">:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Flow direction&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;m/year&quot;</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Velocity magnitude&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;m/year&quot;</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Velocity standard deviation&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;long_name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-greenland-ice-sheet-velocity&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="n">period_start</span><span class="p">,</span> <span class="n">period_stop</span><span class="p">)</span> <span class="ow">in</span> <span class="n">periods</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y0_start</span><span class="p">,</span> <span class="n">y1_start</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">period_start</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span>
    <span class="n">y0_stop</span><span class="p">,</span> <span class="n">y1_stop</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">period_stop</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">y0_start</span><span class="p">,</span> <span class="n">y0_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">y1_start</span><span class="p">,</span> <span class="n">y1_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="n">period</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y0</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">y1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">y0</span> <span class="o">&gt;=</span> <span class="mi">2021</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1_5&quot;</span>
        <span class="k">elif</span> <span class="n">y0</span> <span class="o">&gt;=</span> <span class="mi">2020</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1_4&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1_3&quot;</span>
        <span class="n">requests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="n">domain</span><span class="p">}</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span> <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="n">period</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_std_flowdirection_and_reform</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">postprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading ice sheet velocity data complete.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading ice sheet velocity data, this make take a couple of minutes...
domain = &#39;greenland_ice_sheet&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 9/9 [00:05&lt;00:00,  1.57it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>domain = &#39;antarctic_ice_sheet&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 2/2 [00:00&lt;00:00,  5.84it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading ice sheet velocity data complete.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="display-and-inspect-data-structure">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-1-3"></span><h4>1.3 Display and inspect data structure<a class="headerlink" href="#display-and-inspect-data-structure" title="Link to this heading">#</a></h4>
<p>Let us print out the data to inspect its structure after the data handling:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;greenland_ice_sheet&#39;: &lt;xarray.Dataset&gt; Size: 12GB
 Dimensions:                              (period: 9, y: 10801, x: 5984)
 Coordinates:
   * period                               (period) &lt;U9 324B &#39;2014-2015&#39; ... &#39;2...
     source                               (period) &lt;U32 1kB &#39;3f623b8825fe15dda...
   * y                                    (y) float64 86kB -6.556e+05 ... -3.3...
   * x                                    (x) float64 48kB -6.399e+05 ... 8.55...
 Data variables:
     land_ice_surface_velocity_magnitude  (period, y, x) float32 2GB dask.array&lt;chunksize=(1, 3601, 1995), meta=np.ndarray&gt;
     land_ice_surface_measurement_count   (period, y, x) float64 5GB dask.array&lt;chunksize=(1, 3601, 1995), meta=np.ndarray&gt;
     land_ice_surface_stddev              (period, y, x) float32 2GB dask.array&lt;chunksize=(1, 1351, 748), meta=np.ndarray&gt;
     land_ice_flow_direction              (period, y, x) float32 2GB dask.array&lt;chunksize=(1, 1351, 748), meta=np.ndarray&gt;
 Attributes: (12/13)
     Conventions:    CF-1.7
     title:          Ice Velocity of the Greenland Ice Sheet
     reference:      Main: Nagler, T.; Rott, H.; Hetzenecker, M.; Wuite, J.; P...
     source:         Copernicus Sentinel-1A and Sentinel-1B
     institution:    Copernicus Climate Change Service
     contact:        copernicus-support@ecmwf.int
     ...             ...
     creation_date:  2024-12-12
     comment:        Ice velocity map of Greenland derived from Sentinel-1 SAR...
     history:        product version 1.3
     summary:        Ice velocity derived for Greenland Ice Sheet gridded at 2...
     keywords:       EARTH SCIENCE CLIMATE INDICATORS CRYOSPHERIC INDICATORS G...
     license:        C3S general license,
 &#39;antarctic_ice_sheet&#39;: &lt;xarray.Dataset&gt; Size: 28GB
 Dimensions:                              (period: 2, y: 24580, x: 28680)
 Coordinates:
   * period                               (period) &lt;U9 72B &#39;2021-2022&#39; &#39;2022-2...
     source                               (period) &lt;U32 256B &#39;24d8cbb7053b3957...
   * y                                    (y) float64 197kB 2.458e+06 ... -2.4...
   * x                                    (x) float64 229kB -2.868e+06 ... 2.8...
 Data variables:
     land_ice_surface_velocity_magnitude  (period, y, x) float32 6GB dask.array&lt;chunksize=(1, 4097, 4780), meta=np.ndarray&gt;
     land_ice_surface_measurement_count   (period, y, x) float64 11GB dask.array&lt;chunksize=(1, 4097, 4780), meta=np.ndarray&gt;
     land_ice_surface_stddev              (period, y, x) float32 6GB dask.array&lt;chunksize=(1, 1891, 2207), meta=np.ndarray&gt;
     land_ice_flow_direction              (period, y, x) float32 6GB dask.array&lt;chunksize=(1, 1891, 2207), meta=np.ndarray&gt;
 Attributes: (12/13)
     Conventions:    CF-1.7
     title:          Ice Velocity of the Antarctic Ice Sheet
     reference:      Main: Nagler, T.; Rott, H.; Hetzenecker, M.; Wuite, J.; P...
     source:         Copernicus Sentinel-1A and Sentinel-1B
     institution:    Copernicus Climate Change Service
     contact:        copernicus-support@ecmwf.int
     ...             ...
     creation_date:  2023-12-15
     comment:        Ice velocity map of Antarctica derived from Sentinel-1 SA...
     history:        product version 1.5
     summary:        Ice velocity derived for Antarctic Ice Sheet gridded at 2...
     keywords:       EARTH SCIENCE CLIMATE INDICATORS CRYOSPHERIC INDICATORS G...
     license:        C3S general license}
</pre></div>
</div>
</div>
</div>
<p>For the GrIS, the versions 1.3 to 1.5 are a gridded dataset at a 250 m spatial resolution containing annually averaged values of the ice sheet horizontal surface flow velocity <span class="math notranslate nohighlight">\(V_s\)</span> (in m/day) of a grid cell (<code class="docutils literal notranslate"><span class="pre">land_ice_surface_velocity_magnitude</span></code>) and its components (<code class="docutils literal notranslate"><span class="pre">land_ice_surface_easting_velocity</span></code> (<span class="math notranslate nohighlight">\(V_x\)</span>) and <code class="docutils literal notranslate"><span class="pre">land_ice_surface_northing_velocity</span></code> (<span class="math notranslate nohighlight">\(V_y\)</span>)) since the 2014-2015 hydrological year. The uncertainties (reported as precision errors or standard deviations) of the horizontal components are also given as <code class="docutils literal notranslate"><span class="pre">land_ice_surface_easting_stddev</span></code> (<span class="math notranslate nohighlight">\(\sigma_{V_x}\)</span>) and <code class="docutils literal notranslate"><span class="pre">land_ice_surface_northing_stddev</span></code> (<span class="math notranslate nohighlight">\(\sigma_{V_y}\)</span>). Also the vertical component is given as <code class="docutils literal notranslate"><span class="pre">land_ice_surface_vertical_velocity</span></code> (<span class="math notranslate nohighlight">\(V_z\)</span>), but without a corresponding uncertainty. Next to that, also a variable named <code class="docutils literal notranslate"><span class="pre">land_ice_surface_measurement_count</span></code> is present, which quantifies the total number of valid image pairs used in the annually averaged velocity estimate for a certain pixel. For the AIS, only version 1.5 is available at a spatial resolution of 200 m since the 2021-2022 period. After the data handling we performed, our dataset array now only holds the most important information: the total horizontal velocity magnitude (<code class="docutils literal notranslate"><span class="pre">land_ice_surface_velocity_magnitude</span></code>), the valid pixel count (<code class="docutils literal notranslate"><span class="pre">land_ice_surface_measurement_count</span></code>), the calculated ice flow direction (<code class="docutils literal notranslate"><span class="pre">land_ice_flow_direction</span></code>), and our calculated standard deviation (<code class="docutils literal notranslate"><span class="pre">land_ice_surface_stddev</span></code>) from the northing and easting components.</p>
<p>For clarification, the total horizontal surface velocity magnitude <span class="math notranslate nohighlight">\(V_s\)</span> and its uncertainty <span class="math notranslate nohighlight">\(\sigma_{V_s}\)</span> are calculated from its components as follows (with subscript ‘s’ referring to the surface):</p>
<p><span class="math notranslate nohighlight">\(
V_s
\)</span>
[m day⁻¹]
<span class="math notranslate nohighlight">\(
= \sqrt {V_x^2 + V_y^2}
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\sigma_{V_s}
\)</span>
[m day⁻¹]
<span class="math notranslate nohighlight">\(
= \sqrt {(\sigma_{V_x})^2 + (\sigma_{V_y})^2}
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(V_x\)</span> and <span class="math notranslate nohighlight">\(V_y\)</span> are respectively the easting and northing components of the horizontal velocity vector.</p>
<p>The flow direction of the ice can be calculated as follows:</p>
<p><span class="math notranslate nohighlight">\(
\theta_{\text{V}_s} = \left( 90^\circ - \left( \arctan2(v_y, v_x) \times \left( \frac{180}{\pi} \right) \right) \right) \mod 360^\circ
\)</span></p>
<p>Let us begin with the analysis.</p>
</section>
</section>
<section id="ice-sheet-flow-velocities-and-their-uncertainty-estimates-in-space-and-time">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2"></span><h3>2. Ice sheet flow velocities and their uncertainty estimates in space and time<a class="headerlink" href="#ice-sheet-flow-velocities-and-their-uncertainty-estimates-in-space-and-time" title="Link to this heading">#</a></h3>
<section id="average-horizontal-ice-flow-velocities">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-1"></span><h4>2.1 Average horizontal ice flow velocities<a class="headerlink" href="#average-horizontal-ice-flow-velocities" title="Link to this heading">#</a></h4>
<p>We begin by plotting the average ice flow velocities for each hydrological year between the beginning and end period that we selected for the velocity data with a defined plotting function. Let us begin with the GrIS:</p>
<p>🚨 <strong>The files can be large! Since the data files to be plotted are of considerable size, this may take a couple of minutes.</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Greenland setup</span>
<span class="n">ds_gris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;greenland_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_gris</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">]</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal surface ice flow velocity $V_</span><span class="si">{s}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/day&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Greenland</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_gris</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average flow velocity over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/9dcaa4ff32e1b5ad62a23543d4c69be50e3e8810274eff8f0c0e30e9611ad8ae.png" src="../../_images/9dcaa4ff32e1b5ad62a23543d4c69be50e3e8810274eff8f0c0e30e9611ad8ae.png" />
</div>
</div>
<p><em>Figure 1. Magnitude of the average horizontal surface flow velocities over Greenland over the defined time period.</em></p>
<p>And now also the AIS:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Antarctica setup</span>
<span class="n">ds_ais</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;antarctic_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_ais</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=-</span><span class="mi">71</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="n">ds_ais</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">]</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal surface ice flow velocity $V_</span><span class="si">{s}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/day&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Antarctica</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_ais</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average flow velocity over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/39e3089c727b335c133c89b93baeff100439703d8a4e9a360621983d5d17ccad.png" src="../../_images/39e3089c727b335c133c89b93baeff100439703d8a4e9a360621983d5d17ccad.png" />
</div>
</div>
<p><em>Figure 2. Magnitude of the average horizontal surface flow velocities over Antarctica over the defined time period.</em></p>
<p>The corresponding data are annually averaged values, and are hence derived from all-year round observations during the glaciological balance year. The annually averaged nature of the data meets the minimum requirement for GCOS (Global Climate Observing System) [<a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245" rel="noreferrer" target="_blank">2</a>]. For the GrIS, the dataset shows almost no temporal or spatial (as most have been filled up) data gaps and is presented as gridded values at a spatial resolution of 250 meter (for versions 1.3 to 1.5 as used here), even though spatially filled gaps are not flagged and hence not detectable. The spatial coverage of the data thus approximates 100% and encompasses the entire ice sheet, including peripheral glaciers and ice caps. However, an ice mask is not included and it is thus not possible to exclude non ice-covered pixels from the data. Pixels over ice-free terrain hold non-NaN data and have not been removed, implying that the data exhibits false low velocity measurements and noise over ice-free terrain. For the AIS, most of the margin is covered by the C3S product, but no values are present over the interior of the ice sheet due to the Sentinel-1 acquisition mask (data is only collected at the margins).</p>
</section>
<section id="ice-flow-velocity-uncertainty-accuracy-and-precision">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-2"></span><h4>2.2 Ice flow velocity uncertainty: accuracy and precision<a class="headerlink" href="#ice-flow-velocity-uncertainty-accuracy-and-precision" title="Link to this heading">#</a></h4>
<p>Let us now consider the unceratinty of the dataset. The total error of an annual ice flow velocity estimate is theoretically given by the sum of the precision (random) and the accuracy (systematic) error:</p>
<p><span class="math notranslate nohighlight">\(
\varepsilon = a\sigma + \delta
\)</span>
where <span class="math notranslate nohighlight">\(\sigma\)</span> is the random error (i.e. standard deviation), <span class="math notranslate nohighlight">\(a\)</span> the critical z-score related to a certain confidence interval, and <span class="math notranslate nohighlight">\(\delta\)</span> the systematic error.</p>
<p>In the ice flow velocity dataset, precision errors are reported as the standard deviation (i.e. the 68% confidence interval) and the accuracy error is not provided. Therefore, in our case, <span class="math notranslate nohighlight">\(\delta\)</span> = 0.</p>
<p>Accuracy errors are thus not directly included in the total error estimate of the dataset. To get an idea of the accuracy, the <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=355348656" rel="noreferrer" target="_blank">PQAR</a> can be consulted, where the results of a validation study are summarized. The validation process involved comparing the velocity maps with in-situ GPS data from various sites, as well as with NASA’s MEaSUREs velocity product [<a class="reference external" href="https://nsidc.org/data/nsidc-0777/versions/1" rel="noreferrer" target="_blank">3</a>]. Quality assurance furthermore included an algorithm performance assessment in stable terrain (where velocities should equal 0) [<a class="reference external" href="https://doi.org/10.1016/j.rse.2017.08.038" rel="noreferrer" target="_blank">6</a>]. The results demonstrate a relatively good agreement between the dataset and independent external data.</p>
<p>Quantitative pixel-by-pixel error estimates are, on the other hand, available for the dataset in the form of precision errors and valid measurement counts. The uncertainty characterization is hence quantified by two variables: the standard deviation (i.e. a precision error from a 5x5 pixel neighbourhood) of the velocity estimate with units of m/day, and the valid pixel count (the number of non-NaN observations used in the production of each annual velocity estimate for a certain pixel, or differently stated, the amount of individual displacement estimates (i.e. image pairs) that were used to calculate the annually averaged velocity at that pixel). Let us express the valid pixel count variable with symbol <span class="math notranslate nohighlight">\(N_{VP}\)</span>.</p>
<p>We will proceed by changing the units of the error <span class="math notranslate nohighlight">\(\varepsilon\)</span> to m yr⁻¹ because the GCOS Implementation Plan report advises uncertainty values to be provided in these units [<a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245" rel="noreferrer" target="_blank">2</a>]. We will also multiply the standard deviation by 2 because the GCOS assesses precision errors in the form of 2 standard deviations:</p>
<p><span class="math notranslate nohighlight">\(
\varepsilon_{{V_s}}
\)</span>
[m yr⁻¹]
<span class="math notranslate nohighlight">\(
= 365.25 \cdot (2 \cdot \sigma_{V_{s}})
\)</span></p>
<p>We can now perform some statistics on the error term over all pixels and all years to inspect its overall value for both ice sheets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">domain</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">domain</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Show error</span>
    <span class="n">da</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean velocity error (2σ) for </span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2"> CE: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m/yr&quot;</span><span class="p">)</span>

    <span class="c1"># Show measurements count</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_measurement_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean measurement count for </span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2"> CE: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> estimates/pixel&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>domain = &#39;greenland_ice_sheet&#39;
Mean velocity error (2σ) for 2014-2015 CE: 20.42 m/yr
Mean velocity error (2σ) for 2015-2016 CE: 10.93 m/yr
Mean velocity error (2σ) for 2016-2017 CE: 9.92 m/yr
Mean velocity error (2σ) for 2017-2018 CE: 9.19 m/yr
Mean velocity error (2σ) for 2018-2019 CE: 7.90 m/yr
Mean velocity error (2σ) for 2019-2020 CE: 7.14 m/yr
Mean velocity error (2σ) for 2020-2021 CE: 328.67 m/yr
Mean velocity error (2σ) for 2021-2022 CE: 7.69 m/yr
Mean velocity error (2σ) for 2022-2023 CE: 12.84 m/yr
Mean measurement count for 2014-2015 CE: 19.75 estimates/pixel
Mean measurement count for 2015-2016 CE: 61.04 estimates/pixel
Mean measurement count for 2016-2017 CE: 108.80 estimates/pixel
Mean measurement count for 2017-2018 CE: 133.65 estimates/pixel
Mean measurement count for 2018-2019 CE: 138.09 estimates/pixel
Mean measurement count for 2019-2020 CE: 136.80 estimates/pixel
Mean measurement count for 2020-2021 CE: 122.56 estimates/pixel
Mean measurement count for 2021-2022 CE: 78.79 estimates/pixel
Mean measurement count for 2022-2023 CE: 51.34 estimates/pixel

domain = &#39;antarctic_ice_sheet&#39;
Mean velocity error (2σ) for 2021-2022 CE: 14.09 m/yr
Mean velocity error (2σ) for 2022-2023 CE: 19.45 m/yr
Mean measurement count for 2021-2022 CE: 71.04 estimates/pixel
Mean measurement count for 2022-2023 CE: 45.61 estimates/pixel
</pre></div>
</div>
</div>
</div>
<p>The threshold (i.e. the minimum requirement to be met to ensure that data are useful) for surface ice flow velocity uncertainty (expressed in terms of 2<span class="math notranslate nohighlight">\(\sigma\)</span>) proposed by the GCOS is 100 m yr⁻¹, while the “goal” value (i.e. an ideal requirement above which further improvements are not necessary) would be 10 m yr⁻¹ per grid point [<a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245" rel="noreferrer" target="_blank">2</a>]. The overall arithmetic mean error over both space and time shows that the minimum threshold is reached for all years but the 2020-2021 period for the GrIS (which will be discussed later).</p>
</section>
<section id="spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-gris">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-3"></span><h4>2.3 Spatio-temporal distribution of ice flow velocity uncertainty for the GrIS<a class="headerlink" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-gris" title="Link to this heading">#</a></h4>
<p>Let us now plot the spatial distribution of the errors (here thus visualized as 2 times the standard deviation with units in meters per year):</p>
<p>🚨 <strong>The files can be large! Since the data files to be plotted are of considerable size, this may therefore take a couple of minutes.</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Greenland setup</span>
<span class="n">ds_gris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;greenland_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_gris</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">]</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal surface ice flow velocity error $\varepsilon_{{V_s}}$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/year&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Greenland</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_gris</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average flow velocity error over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/69af1eba77a80900b6eea6dd181f55c8155806dae7f0509762db3c9a1327337f.png" src="../../_images/69af1eba77a80900b6eea6dd181f55c8155806dae7f0509762db3c9a1327337f.png" />
</div>
</div>
<p><em>Figure 3. Magnitude of the average horizontal surface flow velocity error over Greenland over the defined time period.</em></p>
<p>Here, high standard deviation areas suggest lower precision and higher uncertainty. From the images above, it can immediately be seen why the horizontal velocity error for the 2020-2021 period is relatively high when compared to the earlier years: the data for this particular  year have not been masked. High errors prevail over the ocean, which is of course unrealistic, and data even extend further into the Canadian Arctic. We can solve this by masking the data (i.e. by excluding the data outside of the Greenland continent land borders) and recalculating the error:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std_2020_2021</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="s1">&#39;2020-2021&#39;</span><span class="p">)</span>
<span class="n">std_2020_2021</span> <span class="o">=</span> <span class="n">std_2020_2021</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="s1">&#39;2020-2021&#39;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The masked arithmetic mean precision error (2σ) &quot;</span> 
          <span class="sa">f</span><span class="s2">&quot;for the 2020-2021 period &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;is </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">std_2020_2021</span><span class="p">)))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> m yr⁻¹.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The masked arithmetic mean precision error (2σ) for the 2020-2021 period is 6.51 m yr⁻¹.
</pre></div>
</div>
</div>
</div>
<p>Nevertheless, from the figure above, the precision errors seem to be especially higher near the margins of the ice sheet. In these regions, the threshold value of 100 m yr⁻¹ is locally not reached. Let us make this plot a bit clearer by grouping the errors (here averaged over all time periods) with respect to the threshold values proposed by the GCOS:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_m_yr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_velocity_magnitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="s1">&#39;2020-2021&#39;</span><span class="p">)))</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">error_m_yr</span> <span class="o">=</span> <span class="n">error_m_yr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">error_m_yr</span> <span class="o">=</span> <span class="n">error_m_yr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps_single</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Create subplots with Polar Stereographic projection</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=</span><span class="mi">70</span><span class="p">)})</span>
    <span class="k">if</span> <span class="n">suptitle</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    
    <span class="c1"># Plot the data </span>
    <span class="n">subset_da</span> <span class="o">=</span> <span class="n">da</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># Set extent and plot features</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=</span><span class="mi">70</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Classified temporally averaged precision error of</span><span class="se">\n</span><span class="s2">the horizontal surface velocity $</span><span class="se">\\</span><span class="s2">epsilon_</span><span class="si">{V_s}</span><span class="s2">$ [m/yr]&quot;</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([(</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">30</span><span class="o">+</span><span class="mi">140</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">da</span><span class="p">))</span><span class="o">/</span><span class="mf">1.5</span><span class="p">])</span>  <span class="c1"># Set the ticks at the midpoints of the ranges</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;&lt; 10&#39;</span><span class="p">,</span> <span class="s1">&#39;10-30&#39;</span><span class="p">,</span> <span class="s1">&#39;30-100&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt; 100&#39;</span><span class="p">])</span>  <span class="c1"># Set the tick labels</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Apply the function to the velocity standard deviation data</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">error_m_yr</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal ice flow velocity error $\varepsilon_{{V_s}}$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/yr&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Define bounds and colormap</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">da</span><span class="p">)]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plot_maps_single</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/e2b3e73e6736c8fb9ff91a2c7e048b2cf42da7795c60097e9ff6a4857bbd3d94.png" src="../../_images/e2b3e73e6736c8fb9ff91a2c7e048b2cf42da7795c60097e9ff6a4857bbd3d94.png" />
</div>
</div>
<p><em>Figure 4. Classification of the average horizontal surface flow velocity error over Greenland over the defined time period according to proposed GCOS thresholds.</em></p>
<p>When plotted, the error (in the figure above plotted as averaged over all time periods) of the ice velocity product exhibits a significant spatial variability, with higher values generally observed near the ice sheet margins. Here, the terrain complexity, rapidly changing surface conditions (such as high ice melt or any other changes in the terrain that can alter the scattering characteristics of the radar pulse), as well as the relatively high speed of the outlet glaciers, have a direct impact on the absolute error value [<a class="reference external" href="https://doi.org/10.1016/j.rse.2017.08.038" rel="noreferrer" target="_blank">6</a>]. Conversely, towards the interior of the ice sheet, where there is little or no melt and ice flow speeds are relatively low and stable, the standard deviation is relatively low as well.</p>
<p>We can check in what percentage of the pixels the GCOS requirements have been reached or not reached:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_spatial</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">])</span>
<span class="n">count_10</span> <span class="o">=</span> <span class="p">(</span><span class="n">error_spatial</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">count_100</span> <span class="o">=</span> <span class="p">(</span><span class="n">error_spatial</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">count_nonnan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">error_spatial</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percentage of data points with a velocity precision error value (2σ) less than 10 m yr⁻¹ is </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">count_10</span><span class="o">/</span><span class="n">count_nonnan</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percentage of data points with a velocity precision error value (2σ) more than 100 m yr⁻¹ is </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">count_100</span><span class="o">/</span><span class="n">count_nonnan</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The percentage of data points with a velocity precision error value (2σ) less than 10 m yr⁻¹ is 71.03%.
The percentage of data points with a velocity precision error value (2σ) more than 100 m yr⁻¹ is 1.54%.
</pre></div>
</div>
</div>
</div>
<p>The majority of data therefore meet the uncertainty threshold proposed by the GCOS in the case of the GrIS, which adds credibility to the C3S ice sheet velocity product.</p>
</section>
<section id="spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-ais">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-2-4"></span><h4>2.4 Spatio-temporal distribution of ice flow velocity uncertainty for the AIS<a class="headerlink" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-ais" title="Link to this heading">#</a></h4>
<p>Now let us repeat the same procedure for Antarctica. We first plot the average velocity errors:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Antarctica setup</span>
<span class="n">ds_ais</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;antarctic_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_ais</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=-</span><span class="mi">71</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_ais</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">]</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal surface ice flow velocity error $\varepsilon_{{V_s}}$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/year&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Antarctica</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_ais</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average flow velocity error over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/132dd31fe0ba0f85b989068891cab89c467c03e1c448f902dc7168ed889ce6e8.png" src="../../_images/132dd31fe0ba0f85b989068891cab89c467c03e1c448f902dc7168ed889ce6e8.png" />
</div>
</div>
<p><em>Figure 5. Magnitude of the average horizontal surface flow velocity error over Antarctica over the defined time period.</em></p>
<p>In the above figure, we note a very similar pattern as with the GrIS: the flow velocity errors are relatively high near the margins, but are considered small over the interior low-flow zones of the ice sheet. Let us classify them according to the proposed GCOS thresholds:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_m_yr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_ais</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">])</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">error_m_yr</span> <span class="o">=</span> <span class="n">error_m_yr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">error_m_yr</span> <span class="o">=</span> <span class="n">error_m_yr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;period&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps_single</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">suptitle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># Create subplots with Polar Stereographic projection</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=-</span><span class="mi">71</span><span class="p">)})</span>
    <span class="k">if</span> <span class="n">suptitle</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">suptitle</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    
    <span class="c1"># Plot the data </span>
    <span class="n">subset_da</span> <span class="o">=</span> <span class="n">da</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># Set extent and plot features</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=-</span><span class="mi">71</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add colorbar</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Classified temporally averaged precision error of</span><span class="se">\n</span><span class="s2">the horizontal surface velocity $</span><span class="se">\\</span><span class="s2">epsilon_</span><span class="si">{V_s}</span><span class="s2">$ [m/yr]&quot;</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([(</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">40</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">30</span><span class="o">+</span><span class="mi">140</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">da</span><span class="p">))</span><span class="o">/</span><span class="mf">1.5</span><span class="p">])</span>  <span class="c1"># Set the ticks at the midpoints of the ranges</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;&lt; 10&#39;</span><span class="p">,</span> <span class="s1">&#39;10-30&#39;</span><span class="p">,</span> <span class="s1">&#39;30-100&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt; 100&#39;</span><span class="p">])</span>  <span class="c1"># Set the tick labels</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Apply the function to the velocity standard deviation data</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">error_m_yr</span>
<span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Horizontal ice flow velocity error $\varepsilon_{{V_s}}$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m/yr&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Define bounds and colormap</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">da</span><span class="p">)]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">plot_maps_single</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a837894c1ec90f3bcc15a20fab3aeda256366aad38d6e3c9446dbb9eca8acfed.png" src="../../_images/a837894c1ec90f3bcc15a20fab3aeda256366aad38d6e3c9446dbb9eca8acfed.png" />
</div>
</div>
<p><em>Figure 6. Classification of the average horizontal surface flow velocity error over Antarctica over the defined time period according to proposed GCOS thresholds.</em></p>
<p>The spatio-temporal pattern of ice sheet velocity errors is therefore similar to that of the GrIS. Let us check in what percentage of the pixels the GCOS requirements have been reached or not reached:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_spatial</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="n">ds_ais</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_stddev&quot;</span><span class="p">])</span>
<span class="n">count_10</span> <span class="o">=</span> <span class="p">(</span><span class="n">error_spatial</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">count_100</span> <span class="o">=</span> <span class="p">(</span><span class="n">error_spatial</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">count_nonnan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">error_spatial</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percentage of data points with a velocity precision error value (2σ) less than 10 m yr⁻¹ is </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">count_10</span><span class="o">/</span><span class="n">count_nonnan</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percentage of data points with a velocity precision error value (2σ) more than 100 m yr⁻¹ is </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">count_100</span><span class="o">/</span><span class="n">count_nonnan</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The percentage of data points with a velocity precision error value (2σ) less than 10 m yr⁻¹ is 55.56%.
The percentage of data points with a velocity precision error value (2σ) more than 100 m yr⁻¹ is 1.59%.
</pre></div>
</div>
</div>
</div>
<p>As with the GrIS, the majority of the pixels exhibit uncertainty values that fall within the thresholds proposed by GCOS. This ensures that the C3S AIS velocity product holds credible data. Next, let us deal with the second measure of error and uncertainty: the valid pixel count.</p>
</section>
</section>
<section id="valid-measurement-counts-for-the-surface-ice-flow-velocity">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3"></span><h3>3. Valid measurement counts for the surface ice flow velocity<a class="headerlink" href="#valid-measurement-counts-for-the-surface-ice-flow-velocity" title="Link to this heading">#</a></h3>
<section id="spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-gris">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3-1"></span><h4>3.1 Spatio-temporal distribution of ice flow velocity valid pixel counts for the GrIS<a class="headerlink" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-gris" title="Link to this heading">#</a></h4>
<p>In the figure below, we plot the averaged pixel-by-pixel valid measurement counts of the horizontal surface velocity for the GrIS:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Greenland setup</span>
<span class="n">ds_gris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;greenland_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_gris</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mi">45</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="n">ds_gris</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_measurement_count&quot;</span><span class="p">]</span>
<span class="n">da_gris</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Valid pixel counts $N_</span><span class="si">{VP}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;counts/pixel&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_gris</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Greenland</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_gris</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_gris</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_gris</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average valid measurement count over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d652d19084129b12da9a679d84a5327df06e917314f85363972af0553f56332c.png" src="../../_images/d652d19084129b12da9a679d84a5327df06e917314f85363972af0553f56332c.png" />
</div>
</div>
<p><em>Figure 7. Average valid pixel count of the horizontal surface flow velocity for Greenland over the defined time period.</em></p>
<p>In the figure above, the straight edges of different valid pixel counts and the apperant paths of data acquisition are an indicator that the differences in valid pixel count are mostly due to the satellite acquisition. However, higher valid pixel counts are clearly observed along the margins of the ice sheet and major outlet glaciers, consistent with areas of fast dynamics that require a more detailed monitoring. This high density of observations enhances the accuracy and reliability of the velocity maps, particularly in dynamic regions. Generating high-density velocity estimates using SAR-based offset tracking is generally more challenging in the interior of the ice sheet. This difficulty mainly arises because of the relatively slow movement of ice in the interior compared to the faster-flowing edges, which results in smaller displacements between image pairs. This makes it harder to detect and measure them accurately. A drawback to the data is the fact that there is no information given related to the time of the year during which valid measurements were acquired and that no data at a finer temporal resolution than 1 year are present.</p>
</section>
<section id="spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-ais">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-3-2"></span><h4>3.2 Spatio-temporal distribution of ice flow velocity valid pixel counts for the AIS<a class="headerlink" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-ais" title="Link to this heading">#</a></h4>
<p>Let us plot the same for the AIS:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Antarctica setup</span>
<span class="n">ds_ais</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;antarctic_ice_sheet&quot;</span><span class="p">]</span>
<span class="n">projection_ais</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">true_scale_latitude</span><span class="o">=-</span><span class="mi">71</span><span class="p">)</span>

<span class="c1"># Extract and preprocess data</span>
<span class="n">slice_step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="n">ds_ais</span><span class="p">[</span><span class="s2">&quot;land_ice_surface_measurement_count&quot;</span><span class="p">]</span>
<span class="n">da_ais</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">slice_step</span><span class="p">))</span>
<span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Valid pixel counts $N_</span><span class="si">{VP}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;counts/pixel&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">stop</span> <span class="o">=</span> <span class="n">da_ais</span><span class="p">[</span><span class="s2">&quot;period&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>

<span class="c1"># Plot Antarctica</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">projection_ais</span><span class="p">})</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">da_ais</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;rainbow&quot;</span><span class="p">,</span>  
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable default colorbar</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="c1"># Colorbar with formatting </span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.49</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Variable&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_ais</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;units&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average valid measurement count over all time periods (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/75e58adc3a1069656c391ec3f1b41d4dfcc7984cc9ffc38ed9e975728fb7b5b5.png" src="../../_images/75e58adc3a1069656c391ec3f1b41d4dfcc7984cc9ffc38ed9e975728fb7b5b5.png" />
</div>
</div>
<p><em>Figure 8. Average valid pixel count of the horizontal surface flow velocity for Antarctica over the defined time period.</em></p>
<p>As with the GrIS, a higher count in the figure above typically indicates a more reliable estimate due to the inclusion of more observations into the velocity estimate. Paths of data acquisition are, however, also clearly visible in the pattern. This suggests that valid pixel counts are also dependent on the satellite acquisition and do not always represent glaciological signals. As with Greenland, a drawback to the data is the fact that there is no information given related to the time of the year during which valid measurements were acquired. Again, no thresholds are proposed by GCOS with respect to valid pixel counts, so no comparison is possible. However, the higher the valid pixel count, the more reliable a velocity estimate can be considered.</p>
</section>
</section>
<section id="implications-for-use-of-horizontal-ice-flow-velocity-data-in-an-ice-sheet-modelling-framework">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4"></span><h3>4. Implications for use of horizontal ice flow velocity data in an ice sheet modelling framework<a class="headerlink" href="#implications-for-use-of-horizontal-ice-flow-velocity-data-in-an-ice-sheet-modelling-framework" title="Link to this heading">#</a></h3>
<section id="ice-sheet-model-initialisation-and-tuning-of-the-surface-flow-velocity-field">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4-1"></span><h4>4.1 Ice sheet model initialisation and tuning of the surface flow velocity field<a class="headerlink" href="#ice-sheet-model-initialisation-and-tuning-of-the-surface-flow-velocity-field" title="Link to this heading">#</a></h4>
<p>In the following section, we integrate all information derived above (with respect to spatio-temporal coverage and uncertainty) to assess the suitability of the ice sheet surface ice flow velocity dataset to use the velocity product in an ice sheet modelling framework.</p>
<p>At the heart of an ice sheet model is the solution of the time-dependent continuity equation for ice thickness <span class="math notranslate nohighlight">\(H\)</span>:</p>
<p><span class="math notranslate nohighlight">\(
\dfrac{\partial H}{\partial t} = -\nabla \cdot (\vec{\overline{v}}H) + M - S
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the ice thickness, <span class="math notranslate nohighlight">\(\vec{\overline{v}}\)</span> is the vertically averaged horizontal velocity vector, <span class="math notranslate nohighlight">\(M\)</span> is the surface mass balance, and <span class="math notranslate nohighlight">\(S\)</span> is the basal mass balance. A calibration procedure involves adjusting, for example, the basal sliding coefficient in Weertman’s basal sliding law in areas with basal temperatures at the pressure melting point and/or to adjust the rate factor in Glen’s flow law for interior regions frozen to bedrock (which impact <span class="math notranslate nohighlight">\(\vec{\overline{v}}\)</span>). This allows the modelled ice thickness or surface velocity to match the observed one (e.g. [<a class="reference external" href="https://doi.org/10.5194/gmd-12-2481-2019" rel="noreferrer" target="_blank">4</a>, <a class="reference external" href="https://doi.org/10.3390/rs11121407" rel="noreferrer" target="_blank">5</a>]). This approach is valid as the present-day velocities of the ice sheets are supposedly close to the balance velocities.</p>
<p>In that regard, comparing modelled surface velocity fields to the observed ones provides a tool for the calibration/validation of an ice sheet model. The C3S ice sheet velocity product is particularly well-suited for this purpose. Even though large spatial gaps remain for the AIS product, the most prominent and dynamic regions across the margins are covered. Moreover, the GrIS product practically entirely covers the Greenland continent. Furthermore, the C3S velocity product includes quantitative pixel-by-pixel error estimates, for which the uncertainty characterization is represented by two variables: the standard deviation (i.e. a precision error) and the valid pixel count (the number of observations used to estimate the eventual average pixel value). The inclusion of both variables enhances the product quality and can serve as an important factor to consider when using the velocity product in an ice sheet modelling framework. When tuning an ice sheet model, it can, for example, be beneficial to prioritize high-quality velocity data (i.e. with a low absolute or relative error and a high valid measurement count). This ensures that the model solution is based on the most reliable observations and higher quality data have a greater influence on the eventual solution. One strategy could be to weigh the data using weights based on both the velocity standard deviation and the valid measurement count. This approach involves combining the two variables to form a single weight <span class="math notranslate nohighlight">\(w_i\)</span> for each data point <span class="math notranslate nohighlight">\(i\)</span>:</p>
<p><span class="math notranslate nohighlight">\(w_i = \alpha \cdot (1-\varepsilon_{V_{s},i}^{'}) + \beta \cdot N_{VP,i}^{'}
\)</span></p>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\varepsilon_{V_{s},i}^{'}\)</span> are the normalized (relative) errors,</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{VP,i}^{'}\)</span> are the normalized valid measurement counts,</p></li>
<li><p>weights <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> for which <span class="math notranslate nohighlight">\(\alpha + \beta = 1\)</span>.</p></li>
</ul>
<p>When using these weights in model validation, each data point’s contribution to the model can be weighed accordingly. For instance, the weighted sum of squared residuals can be compared:</p>
<p><span class="math notranslate nohighlight">\(
\sum_i w_i (y_i - f(x_i))^2
\)</span></p>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_i\)</span> is the observed data (i.e. here the velocities from the dataset)</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x_i)\)</span> is the model prediction for the i<span class="math notranslate nohighlight">\(^{th}\)</span> data point</p></li>
<li><p><span class="math notranslate nohighlight">\(w_i\)</span> is the weight for the i<span class="math notranslate nohighlight">\(^{th}\)</span> data point</p></li>
</ul>
</section>
<section id="presence-of-arteficial-striping">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-4-2"></span><h4>4.2 Presence of arteficial ‘striping’<a class="headerlink" href="#presence-of-arteficial-striping" title="Link to this heading">#</a></h4>
<p>Apart from quantitive error estimates, another phenomenom deserves special attention. Namely, the presence of ‘striping’ (i.e. arteficial banding or noise in the velocity data that become especially visible in low-flow zones) in SAR offset tracking-based ice velocity estimates can have several significant impacts when using the C3S product for the validation of ice sheet models, especially in interior low-flow zones. The presence of striping reduces the overall quality of the velocity data, can distort flow patterns, and may lead to the misinterpretation of physical processes driving ice flow in low-flow zones. This unrealistic pattern, especially visible in the interior of the ice sheet, may therefore limit the use of the product for slowly moving ice and is hence important to consider when using the data. Mitigating these artefacts involves, for example, noise reduction methods such as spatial averaging or filtering, or the integration of velocities from SAR interferomerty, which are generally very accurate for slow-moving ice [<a class="reference external" href="https://doi.org/10.3390/rs70709371" rel="noreferrer" target="_blank">1</a>, <a class="reference external" href="https://doi.org/10.3390/rs9101062" rel="noreferrer" target="_blank">7</a>, <a class="reference external" href="https://doi.org/10.1029/2019GL083826" rel="noreferrer" target="_blank">9</a>]. Another possible solution is replacing the distorted velocities in these areas by balance velocities or to only use velocities above a certain threshold (i.e. &gt;5 m yr⁻¹) for the relevant procedure.</p>
</section>
</section>
<section id="short-summary-and-take-home-messages">
<span id="satellite-satellite-greenland-ice-sheet-velocity-uncertainty-q02-section-5"></span><h3>5. Short summary and take-home messages<a class="headerlink" href="#short-summary-and-take-home-messages" title="Link to this heading">#</a></h3>
<p>Satellite-derived ice velocity data provide valuable insight into the flow dynamics of the ice sheets, but users should be aware of specific limitations in the SAR offset tracking-based velocity products. It should be noted that data quality varies across the ice sheet and is best assessed using the provided standard deviation maps (indicating precision errors) and valid measurement count maps (reflecting the number of successful matches used in annual velocity averaging). Challenging regions include the fast-flowing margins, where high absolute errors occur, as well as the interior low-velocity zones, where lower valid pixel counts and artefacts such as striping may furthermore occur. Nevertheless, the majority of pixels of the C3S ice sheet velocity dataset meets the GCOS uncertainty target. The product also meets the spatial (250 m) and temporal (annual) resolution thresholds set by GCOS, which further enhances the credibility of the C3S ice sheet velocity product (cfr. the “Maturity Matrix” [<a class="reference external" href="https://doi.org/10.1175/BAMS-D-21-0109.1" rel="noreferrer" target="_blank">8</a>]). However, significant data gaps remain over the interior of the AIS.</p>
<p>The dataset thus offers offers a strong spatial and temporal coverage and uncertainty pattern for use in ice sheet model calibration or validation (e.g. [<a class="reference external" href="https://doi.org/10.5194/gmd-12-2481-2019" rel="noreferrer" target="_blank">4</a>, <a class="reference external" href="https://doi.org/10.3390/rs11121407" rel="noreferrer" target="_blank">5</a>, <a class="reference external" href="https://doi.org/10.5194/tc-6-1561-2012" rel="noreferrer" target="_blank">10</a>]). The user can, if desired, prioritize high-quality data (i.e. pixels with low absolute/relative errors and high valid pixel counts) for this purpose. Errors are, however, provided as absolute values, while for flow fields, the relative error is generally considered to be more useful. Other potential limitations include the absence of information on acquisition timing, no flagging of spatially filled pixels or missing data, the lack of an ice mask to exclude non-ice-covered cells with velocity values, and the relatively short temporal span of the dataset. To address these issues, users can, for example, apply custom ice masks and complement the product with external datasets for a more robust velocity estimation.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>“<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-greenland-ice-sheet-velocity?tab=overview" rel="noreferrer" target="_blank">Ice sheet velocity for Antarctica and Greenland derived from satellite observations</a>” on the CDS</p></li>
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-greenland-ice-sheet-velocity?tab=documentation" rel="noreferrer" target="_blank">Documentation on the CDS</a> and the <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=355348656" rel="noreferrer" target="_blank">ECMWF Confluence Wiki</a> (Copernicus Knowledge Base).</p></li>
<li><p><a class="reference external" href="https://climate.copernicus.eu/climate-indicators/ice-sheets" rel="noreferrer" target="_blank">Copernicus climate change indicators: ice sheets</a></p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> prepared by <a class="reference external" href="https://www.bopen.eu" rel="noreferrer" target="_blank">B-Open</a>.</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>[<a class="reference external" href="https://doi.org/10.3390/rs70709371" rel="noreferrer" target="_blank">1</a>] Nagler, T., Rott, H., Hetzenecker, M., Wuite, J. and Potin, P. (2015). The Sentinel-1 Mission: New Opportunities for Ice Sheet Observations. Remote Sensing. 7(7):9371-9389. <a class="reference external" href="https://doi.org/10.3390/rs70709371" rel="noreferrer" target="_blank">https://doi.org/10.3390/rs70709371</a></p></li>
<li><p>[<a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245" rel="noreferrer" target="_blank">2</a>] GCOS (Global Climate Observing System) (2022). The 2022 GCOS ECVs Requirements (GCOS-245). World Meteorological Organization: Geneva, Switzerland. doi: <a class="reference external" href="https://library.wmo.int/idurl/4/58111" rel="noreferrer" target="_blank">https://library.wmo.int/idurl/4/58111</a></p></li>
<li><p>[<a class="reference external" href="https://nsidc.org/data/nsidc-0777/versions/1" rel="noreferrer" target="_blank">3</a>] Howat, I., Chudley, T., and Noh, M. (2022). MEaSUREs Greenland Ice Velocity: Selected Glacier Site Single-Pair Velocity Maps from Optical Images, <a class="reference external" href="https://doi.org/10.5067/b28fm2qvvywy" rel="noreferrer" target="_blank">https://doi.org/10.5067/b28fm2qvvywy</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.5194/gmd-12-2481-2019" rel="noreferrer" target="_blank">4</a>] Le clec’h, S., Quiquet, A., Charbit, S., Dumas, C., Kageyama, M., and Ritz, C. (2019). A rapidly converging initialisation method to simulate the present-day Greenland ice sheet using the GRISLI ice sheet model (version 1.3), Geosci. Model Dev., 12, 2481–2499, <a class="reference external" href="https://doi.org/10.5194/gmd-12-2481-2019" rel="noreferrer" target="_blank">https://doi.org/10.5194/gmd-12-2481-2019</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.3390/rs11121407" rel="noreferrer" target="_blank">5</a>] Mottram, R., Simonsen, S. B., Svendsen, S. H., Barletta, V. R., Sørensen, L. S., Nagler, T., Wuite, J., Groh, A., Horwath, M., Rosier, J., Solgaard, A., Hvidberg, C. S., and Forsberg, R. (2019). An integrated view of Greenland Ice Sheet mass changes based on models and satellite observations. Remote Sensing, 11(12), 1407. <a class="reference external" href="https://doi.org/10.3390/rs11121407" rel="noreferrer" target="_blank">https://doi.org/10.3390/rs11121407</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.1016/j.rse.2017.08.038" rel="noreferrer" target="_blank">6</a>] Paul, F., Bolch, T., Briggs, K., Kääb, A., McMillan, M., McNabb, R., Nagler, T., Nuth, C., Rastner, P., Strozzi, T., and Wuite, J. (2017). Error sources and guidelines for quality assessment of glacier area, elevation change, and velocity products derived from satellite data in the Glaciers_cci project, Remote Sensing of Environment, 203, 256-275. <a class="reference external" href="https://doi.org/10.1016/j.rse.2017.08.038" rel="noreferrer" target="_blank">https://doi.org/10.1016/j.rse.2017.08.038</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.3390/rs9101062" rel="noreferrer" target="_blank">7</a>] Lüttig, C., Neckel, N., and Humbert, A. (2017). A Combined Approach for Filtering Ice Surface Velocity Fields Derived from Remote Sensing Methods, Remote Sensing, 9(10). <a class="reference external" href="https://doi.org/10.3390/rs9101062" rel="noreferrer" target="_blank">https://doi.org/10.3390/rs9101062</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.1175/BAMS-D-21-0109.1" rel="noreferrer" target="_blank">8</a>] Yang, C. X., Cagnazzo, C., Artale, V., Nardelli, B. B., Buontempo, C., Busatto, J., Caporaso, L., Cesarini, C., Cionni, I., Coll, J., Crezee, B., Cristofanelli, P., de Toma, V., Essa, Y. H., Eyring, V., Fierli, F., Grant, L., Hassler, B., Hirschi, M., Huybrechts, P., Le Merle, E., Leonelli, F. E., Lin, X., Madonna, F., Mason, E., Massonnet, F., Marcos, M., Marullo, S., Muller, B., Obregon, A., Organelli, E., Palacz, A., Pascual, A., Pisano, A., Putero, D., Rana, A., Sanchez-Roman, A., Seneviratne, S. I., Serva, F., Storto, A., Thiery, W., Throne, P., Van Tricht, L., Verhaegen, Y., Volpe, G., and Santoleri, R. (2022). Independent Quality Assessment of Essential Climate Variables: Lessons Learned from the Copernicus Climate Change Service, B. Am. Meteorol. Soc., 103, E2032–E2049, <a class="reference external" href="https://doi.org/10.1175/Bams-D-21-0109.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/Bams-D-21-0109.1</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.1029/2019GL083826" rel="noreferrer" target="_blank">9</a>] Mouginot, J., E. Rignot, and B. Scheuchl (2019). Continent-wide, interferometric SAR phase, mapping of Antarctic ice velocity, Geophys. Res. Lett., 46, 9710-9718, <a class="reference external" href="https://doi.org/10.1029/2019GL083826" rel="noreferrer" target="_blank">https://doi.org/10.1029/2019GL083826</a></p></li>
<li><p>[<a class="reference external" href="https://doi.org/10.5194/tc-6-1561-2012" rel="noreferrer" target="_blank">10</a>] Gillet-Chaulet, F., Gagliardini, O., Seddik, H., Nodet, M., Durand, G., Ritz, C., Zwinger, T., Greve, R., and Vaughan, D. G. (2012). Greenland ice sheet contribution to sea-level rise from a new-generation ice-sheet model, The Cryosphere, 6, 1561–1576, <a class="reference external" href="https://doi.org/10.5194/tc-6-1561-2012" rel="noreferrer" target="_blank">https://doi.org/10.5194/tc-6-1561-2012</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Cryosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Cryosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Biosphere/Land_Biosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-remote-sensing-derived-ice-sheet-surface-flow-velocities-for-the-calibration-or-validation-of-a-simulation-with-an-ice-sheet-model">🌍 Use case: Using remote sensing-derived ice sheet surface flow velocities for the calibration or validation of a simulation with an ice sheet model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-description">Dataset description</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-and-sub-sections">Structure and (sub)sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation-and-processing">1. Data preparation and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1 Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-request-and-download">1.2 Define request and download</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#display-and-inspect-data-structure">1.3 Display and inspect data structure</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-sheet-flow-velocities-and-their-uncertainty-estimates-in-space-and-time">2. Ice sheet flow velocities and their uncertainty estimates in space and time</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#average-horizontal-ice-flow-velocities">2.1 Average horizontal ice flow velocities</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-flow-velocity-uncertainty-accuracy-and-precision">2.2 Ice flow velocity uncertainty: accuracy and precision</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-gris">2.3 Spatio-temporal distribution of ice flow velocity uncertainty for the GrIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-uncertainty-for-the-ais">2.4 Spatio-temporal distribution of ice flow velocity uncertainty for the AIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#valid-measurement-counts-for-the-surface-ice-flow-velocity">3. Valid measurement counts for the surface ice flow velocity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-gris">3.1 Spatio-temporal distribution of ice flow velocity valid pixel counts for the GrIS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatio-temporal-distribution-of-ice-flow-velocity-valid-pixel-counts-for-the-ais">3.2 Spatio-temporal distribution of ice flow velocity valid pixel counts for the AIS</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-use-of-horizontal-ice-flow-velocity-data-in-an-ice-sheet-modelling-framework">4. Implications for use of horizontal ice flow velocity data in an ice sheet modelling framework</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ice-sheet-model-initialisation-and-tuning-of-the-surface-flow-velocity-field">4.1 Ice sheet model initialisation and tuning of the surface flow velocity field</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#presence-of-arteficial-striping">4.2 Presence of arteficial ‘striping’</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#short-summary-and-take-home-messages">5. Short summary and take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>