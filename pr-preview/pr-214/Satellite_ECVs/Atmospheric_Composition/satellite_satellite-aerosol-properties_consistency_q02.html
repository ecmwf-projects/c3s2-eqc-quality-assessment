
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Satellite AOD data accuracy assessment for air quality and temperature relationships in the Southeastern US &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Satellite AOD data accuracy assessment for air quality and temperature relationships in the Southeastern US</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite AOD data accuracy assessment for air quality and temperature relationships in the Southeastern US</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-to-explain-the-relationship-between-aerosols-and-both-near-surface-and-skin-temperatures">🌍 Use case: Using satellite observations to explain the relationship between aerosols and both near-surface  and skin temperatures.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collection-and-preprocessing-download-aod-and-fine-aod-data">1. Data Collection and Preprocessing: Download AOD and fine_AOD data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-the-spatially-weighted-mean-of-aod550-and-faod550">2. Calculate and plot the spatially weighted mean of AOD550 and fAOD550.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-2-m-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">3. Download 2 m temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-2-m-temperature">4. Plot the monthly time series of AOD550 and fine_AOD550 versus 2 m temperature.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-skin-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">5. Download skin temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-skin-temperature">6. Plot the monthly time series of AOD550 and fine_AOD550 versus skin temperature.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-mean-time-series-of-2m-temperature-and-skin-temperature-for-southeastern-us-during-2017-2022">7. Plot the monthly mean time series of 2m_temperature and skin_temperature for Southeastern US during 2017-2022</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-aod-data-accuracy-assessment-for-air-quality-and-temperature-relationships-in-the-southeastern-us">
<h1><span class="section-number">1.2.1. </span>Satellite AOD data accuracy assessment for air quality and temperature relationships in the Southeastern US<a class="headerlink" href="#satellite-aod-data-accuracy-assessment-for-air-quality-and-temperature-relationships-in-the-southeastern-us" title="Link to this heading">#</a></h1>
<p> </p>
<p>Production date: 30-09-2024</p>
<p>Produced by: Consiglio Nazionale delle Ricerche (CNR)</p>
<section id="use-case-using-satellite-observations-to-explain-the-relationship-between-aerosols-and-both-near-surface-and-skin-temperatures">
<h2>🌍 Use case: Using satellite observations to explain the relationship between aerosols and both near-surface  and skin temperatures.<a class="headerlink" href="#use-case-using-satellite-observations-to-explain-the-relationship-between-aerosols-and-both-near-surface-and-skin-temperatures" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>• Is the accuracy of the AOD estimates sufficient to study the relationship between air quality and temperature in the Southeastern US?</strong></p>
<p>The “satellite-aerosol-properties” catalogue provides global information on essential aerosol variables: aerosol optical depth (AOD) and fine-mode aerosol optical depth (fAOD) from 1995 to present, derived from satellite observations. The SLSTR dataset is used in the following analysis to demonstrate how this catalogue can capture the seasonal maps and monthly trends of AOD and fAOD.</p>
<p>The dominant source of natural aerosols over Earth’s vast forested regions are biogenic volatile organic compounds (BVOC). Recently, studies on the emissions of BVOCs have substantially increased, as they have a significant impact on human health and climate change due to their large emissions and high reactivity [1]. There is evidence that the temperature in the southeastern US is dependent on enhanced natural BVOC emissions on warmer days. There are several aerosol sources that could explain the temperature dependence of AOD, for example, biogenic emissions, secondary organic aerosols (SOA) formed in the aqueous phase, or biomass burning emissions [2]. This notebook determines whether the AOD’s time and spatial sampling are sufficient to support our investigation of the monthly correlation between the AOD and temperature.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<p>The accuracy of the AOD from the Sentinel 3 satellite is not sufficient to study the relationship between air quality and temperature in the southeastern US.</p>
<ol class="arabic simple">
<li><p>Considering the spatial maps of AOD and fAOD for the period 2017–2022 in the southeastern US, the highest values of AOD and fAOD were observed during the summer.</p></li>
<li><p>In the literature, the near-surface temperature in the southeastern US was demonstrated to depend on enhanced natural BVOC emissions on warmer days (Liu, W., 2005; Xu, L., 2015). The impact of fAOD and total AOD on temperature over the southeastern US shows that there is not a straightforward correlation between temperature and AOD (total and fine mode), allowing us to support the thesis of a strong correlation between aerosols due to anthropogenic emissions and near-surface temperature. Also, the time and spatial sampling of the AOD estimates are not sufficient to study the relationship between air quality and temperature in the southeastern US.</p></li>
<li><p>The monthly time series mapping of 2 m temperature and skin temperature indicates a notable positive correlation between these variables, demonstrating consistency between the two products.</p></li>
</ol>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p>• Data Collection and Preprocessing: Download AOD and fine_AOD data (AOD550 and F5_AOD500 (Aerosol properties gridded data from 1995 to present derived from satellite observations), horizontal resolution: 1° x 1°; temporal resolution: monthly).</p>
<p>• Calculate and plot the spatially weighted mean of AOD550 and fAOD550.</p>
<p>• Download 2 m temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</p>
<p>• Plot the monthly time series of AOD550 and fine_AOD550 versus 2 m temperatures.</p>
<p>• Download skin temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</p>
<p>• Plot the monthly time series of AOD550 and fine_AOD550 versus skin temperatures.</p>
<p>• Plot the monthly time series of 2 m and skin temperatures.</p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="data-collection-and-preprocessing-download-aod-and-fine-aod-data">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-1"></span><h3>1. Data Collection and Preprocessing: Download AOD and fine_AOD data<a class="headerlink" href="#data-collection-and-preprocessing-download-aod-and-fine-aod-data" title="Link to this heading">#</a></h3>
<p>Packages that were requested have been imported. The request was defined, and data was downloaded.
The time dimension for both versions was converted and redefined to ensure consistency.
The two monthly datasets (AOD and Fine_AOD) were combined along the version dimension to create a unified dataset for further analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">c3s_eqc_automatic_quality_control</span> <span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span><span class="n">utils</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">c3s_eqc_automatic_quality_control</span> <span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span><span class="n">utils</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">c3s_eqc_automatic_quality_control</span> <span class="kn">import</span> <span class="n">download</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-aerosol-properties&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_average&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;aerosol_optical_depth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;slstr_on_sentinel_3a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;ens&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">time_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;v2.1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-07&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-06&quot;</span><span class="p">},</span>
    <span class="s2">&quot;v2.2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-07&quot;</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-12&quot;</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>

<span class="n">ds_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">time_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">ds_dict</span><span class="p">[</span><span class="n">version</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span> <span class="n">requests</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">)</span>



<span class="n">ds_monthly_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">ds_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ds_monthly</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ds_monthly</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m&quot;</span><span class="p">)</span>

    <span class="n">ds_monthly</span> <span class="o">=</span> <span class="n">ds_monthly</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">})</span>

    <span class="n">ds_monthly</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds_monthly</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>

    <span class="n">ds_monthly_dict</span><span class="p">[</span><span class="n">version</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_monthly</span>

<span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">ds_monthly</span> <span class="ow">in</span> <span class="n">ds_monthly_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Version </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
   



<span class="n">ds_monthly_merged</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_monthly_dict</span><span class="p">[</span><span class="s1">&#39;v2.1&#39;</span><span class="p">],</span><span class="n">ds_monthly_dict</span><span class="p">[</span><span class="s1">&#39;v2.2&#39;</span><span class="p">]],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ds_monthly_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 36/36 [00:01&lt;00:00, 20.91it/s]
100%|██████████| 30/30 [00:01&lt;00:00, 21.88it/s]
                                     
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Version v2.1:
Version v2.2:
&lt;xarray.Dataset&gt; Size: 128kB
Dimensions:                      (time: 66, latitude: 11, longitude: 11)
Coordinates:
  * time                         (time) datetime64[ns] 528B 2017-07-01 ... 20...
  * latitude                     (latitude) float32 44B 24.5 25.5 ... 33.5 34.5
  * longitude                    (longitude) float32 44B -89.5 -88.5 ... -79.5
Data variables:
    AOD550                       (time, latitude, longitude) float32 32kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    FM_AOD550                    (time, latitude, longitude) float32 32kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    AOD550_UNCERTAINTY_ENSEMBLE  (time, latitude, longitude) float32 32kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    NMEAS                        (time, latitude, longitude) float32 32kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
Attributes: (12/18)
    Conventions:               CF-1.6
    creator_email:             thomas.popp@dlr.de
    creator_name:              German Aerospace Center, DFD
    geospatial_lat_max:        90.0
    geospatial_lat_min:        -90.0
    geospatial_lon_max:        180.0
    ...                        ...
    sensor:                    SLSTR
    standard_name_vocabulary:  NetCDF Climate and Forecast (CF) Metadata Conv...
    summary:                   Level 3 aerosol properties retreived using sat...
    title:                     Ensemble aerosol product level 3
    tracking_id:               5eb634e0-a0e8-11eb-9949-0050569370b0
    version:                   v2.1
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-and-plot-the-spatially-weighted-mean-of-aod550-and-faod550">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-2"></span><h3>2. Calculate and plot the spatially weighted mean of AOD550 and fAOD550.<a class="headerlink" href="#calculate-and-plot-the-spatially-weighted-mean-of-aod550-and-faod550" title="Link to this heading">#</a></h3>
<p>We calculated the spatially weighted mean of AOD550 and fAOD550 over Southeastern US for the period 2017-2022.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_seas</span><span class="o">=</span><span class="n">ds_monthly_merged</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#seasonal mean</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_seas</span><span class="p">)</span>

<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Average AOD550 during Jan-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Average AOD550 during Apr-Jun&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Average AOD550 during Jul-Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Average AOD550 during Oct-Dec&#39;</span><span class="p">]</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">ds_seas</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                      <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                                      <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">},</span>
                                      <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">mappable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create colorbar</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Optical Depth &#39;</span><span class="p">)</span>

<span class="c1"># Set the main title for the entire figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Seasonal Average of Aerosol Optical Depth (AOD) over Southeastern US 2017-2022&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Adjust layout to make space for the main title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">############</span>
<span class="c1"># Assuming `ds_seas` and other necessary data are already defined</span>

<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Average FM_AOD550 during Jan-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Average FM_AOD550 during Apr-Jun&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Average FM_AOD550 during Jul-Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Average FM_AOD550 during Oct-Dec&#39;</span><span class="p">]</span>

<span class="n">map_proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">()</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">ds_seas</span><span class="p">[</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlOrRd&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                         <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                                         <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">map_proj</span><span class="p">},</span>
                                         <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">mappable</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create colorbar</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Optical Depth&#39;</span><span class="p">)</span>

<span class="c1"># Set the main title for the entire figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Seasonal Average of fine-mode Aerosol Optical Depth (fAOD) over Southeastern US 2017-2022&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Adjust layout to make space for the main title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 8kB
Dimensions:                      (season: 4, latitude: 11, longitude: 11)
Coordinates:
  * latitude                     (latitude) float32 44B 24.5 25.5 ... 33.5 34.5
  * longitude                    (longitude) float32 44B -89.5 -88.5 ... -79.5
  * season                       (season) object 32B &#39;DJF&#39; &#39;JJA&#39; &#39;MAM&#39; &#39;SON&#39;
Data variables:
    AOD550                       (season, latitude, longitude) float32 2kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    FM_AOD550                    (season, latitude, longitude) float32 2kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    AOD550_UNCERTAINTY_ENSEMBLE  (season, latitude, longitude) float32 2kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
    NMEAS                        (season, latitude, longitude) float32 2kB dask.array&lt;chunksize=(1, 11, 11), meta=np.ndarray&gt;
Attributes: (12/18)
    Conventions:               CF-1.6
    creator_email:             thomas.popp@dlr.de
    creator_name:              German Aerospace Center, DFD
    geospatial_lat_max:        90.0
    geospatial_lat_min:        -90.0
    geospatial_lon_max:        180.0
    ...                        ...
    sensor:                    SLSTR
    standard_name_vocabulary:  NetCDF Climate and Forecast (CF) Metadata Conv...
    summary:                   Level 3 aerosol properties retreived using sat...
    title:                     Ensemble aerosol product level 3
    tracking_id:               5eb634e0-a0e8-11eb-9949-0050569370b0
    version:                   v2.1
</pre></div>
</div>
<img alt="../../_images/b004c2385d9c15c4d4e3b30e3f05fcd861dfef87cefab5c08cbbf97326f685c8.png" src="../../_images/b004c2385d9c15c4d4e3b30e3f05fcd861dfef87cefab5c08cbbf97326f685c8.png" />
<img alt="../../_images/b615aab701629b421ae7e2078152b48973e53a205589487df6424fe3df0965e6.png" src="../../_images/b615aab701629b421ae7e2078152b48973e53a205589487df6424fe3df0965e6.png" />
</div>
</div>
</section>
<section id="download-2-m-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-3"></span><h3>3. Download 2 m temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).<a class="headerlink" href="#download-2-m-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id_t2m</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land-monthly-means&quot;</span>
<span class="n">request_t2m</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;2019&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;2021&quot;</span><span class="p">,</span> <span class="s2">&quot;2022&quot;</span><span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span><span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">],</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">],</span>
<span class="p">}</span>



<span class="c1"># Download the original data</span>
<span class="n">ds_t2m_original</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id_t2m</span><span class="p">,</span> <span class="n">request_t2m</span><span class="p">)</span>

<span class="c1"># Regrid the original data to match the grid of ds_monthly_merged </span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">ds_t2m_regrid</span> <span class="o">=</span> <span class="n">ds_t2m_original</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="n">ds_monthly_merged</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="n">ds_monthly_merged</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>  <span class="c1"># Use nearest-neighbor interpolation</span>
<span class="p">)</span>


<span class="c1"># Calculate spatial weighted mean of the regridded data</span>
<span class="n">da_t2m_spatial_weighted_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds_t2m_regrid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">da_t2m_spatial_weighted_mean</span><span class="p">)</span> 


<span class="n">t2m_subset_ds</span> <span class="o">=</span> <span class="n">da_t2m_spatial_weighted_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-07-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-12-31&#39;</span><span class="p">))</span>
<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in ds_monmean_t2m</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 26.03it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 1kB
Dimensions:                  (forecast_reference_time: 72)
Coordinates:
    realization              int64 8B 0
    leadtime                 timedelta64[ns] 8B 1 days
    surface                  float64 8B 0.0
    time                     (forecast_reference_time) datetime64[ns] 576B dask.array&lt;chunksize=(72,), meta=np.ndarray&gt;
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 576B 20...
Data variables:
    t2m                      (forecast_reference_time) float32 288B dask.array&lt;chunksize=(72,), meta=np.ndarray&gt;
Attributes:
    GRIB_edition:            1
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2024-10-09T07:51 GRIB to CDM+CF via cfgrib-0.9.1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-2-m-temperature">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-4"></span><h3>4. Plot the monthly time series of AOD550 and fine_AOD550 versus 2 m temperature.<a class="headerlink" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-2-m-temperature" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in ds_monmean_t2m</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Define the x-axis positions and labels for quarterly intervals</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]))</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">time_period</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Plot AOD550</span>
<span class="n">aod_values</span> <span class="o">=</span> <span class="n">ds_monthly_merged</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">aod_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Monthly)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>


<span class="c1"># Link temperature to the first axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Convert temperature to Celsius</span>
<span class="n">temperature_kelvin</span> <span class="o">=</span> <span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>

<span class="c1"># Plot temperature (t2m)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_kelvin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;t2m (monthly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;2m Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis ticks and labels for every other data point</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">monthly_labels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AOD550 and 2m Temperature monthly time-series for Southeastern US (2017-2022)&#39;</span><span class="p">)</span>
<span class="c1"># Adding gridlines to the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Adjust layout and display the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>







<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in ds_monmean_t2m</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Define the x-axis positions and labels</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]))</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">time_period</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Plot AOD550</span>
<span class="n">aod_values</span> <span class="o">=</span> <span class="n">ds_monthly_merged</span><span class="p">[</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">aod_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FM_AOD550 (Quarterly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Monthly)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;FM_AOD550&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># Link temperature to the first axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Convert temperature to Celsius</span>
<span class="n">temperature_kelvin</span> <span class="o">=</span> <span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>

<span class="c1"># Plot temperature (t2m)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_kelvin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;t2m (Quarterly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis ticks and labels for every other data point</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">monthly_labels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FAOD and 2m Temperature Monthly Time-Series for Southeastern US (2017-2022)&#39;</span><span class="p">)</span>
<span class="c1"># Adding gridlines to the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Adjust layout and display the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/1eefc41282cdfd9eb655bfbf6670e9df4c16330b984b416473267cf11468403f.png" src="../../_images/1eefc41282cdfd9eb655bfbf6670e9df4c16330b984b416473267cf11468403f.png" />
<img alt="../../_images/b758d9302fb38b6ffaee92a0e513983c685f6b409650501aa332657caf8cd1b7.png" src="../../_images/b758d9302fb38b6ffaee92a0e513983c685f6b409650501aa332657caf8cd1b7.png" />
</div>
</div>
</section>
<section id="download-skin-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-5"></span><h3>5. Download skin temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).<a class="headerlink" href="#download-skin-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id_skin_temperature</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-land-monthly-means&quot;</span>
<span class="n">request_skin_temperature</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;skin_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;2019&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span> <span class="s2">&quot;2021&quot;</span><span class="p">,</span> <span class="s2">&quot;2022&quot;</span><span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span> <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span><span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">],</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">],</span>
<span class="p">}</span>


<span class="c1"># Download the original data</span>
<span class="n">ds_skin_temperature_original</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id_skin_temperature</span><span class="p">,</span> <span class="n">request_skin_temperature</span><span class="p">)</span>

<span class="c1"># Regrid the original data to match the grid of ds_monthly_merged </span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">ds_skin_temperature_regrid</span> <span class="o">=</span> <span class="n">ds_skin_temperature_original</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="n">ds_monthly_merged</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="n">ds_monthly_merged</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>  <span class="c1"># Use nearest-neighbor interpolation</span>
<span class="p">)</span>


<span class="c1"># Calculate spatial weighted mean of the regridded data</span>
<span class="n">da_skin_temperature_spatial_weighted_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds_skin_temperature_regrid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">da_skin_temperature_spatial_weighted_mean</span><span class="p">)</span> 


<span class="n">skin_temperature_subset_ds</span> <span class="o">=</span> <span class="n">da_skin_temperature_spatial_weighted_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2017-07-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-12-31&#39;</span><span class="p">))</span>
<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in ds_monmean_t2m</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00, 11.26it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.Dataset&gt; Size: 1kB
Dimensions:                  (forecast_reference_time: 72)
Coordinates:
    realization              int64 8B 0
    leadtime                 timedelta64[ns] 8B 00:00:00
    surface                  float64 8B 0.0
    time                     (forecast_reference_time) datetime64[ns] 576B dask.array&lt;chunksize=(72,), meta=np.ndarray&gt;
  * forecast_reference_time  (forecast_reference_time) datetime64[ns] 576B 20...
Data variables:
    skt                      (forecast_reference_time) float32 288B dask.array&lt;chunksize=(72,), meta=np.ndarray&gt;
Attributes:
    GRIB_edition:            1
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts
    history:                 2024-10-09T07:51 GRIB to CDM+CF via cfgrib-0.9.1...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-skin-temperature">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-6"></span><h3>6. Plot the monthly time series of AOD550 and fine_AOD550 versus skin temperature.<a class="headerlink" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-skin-temperature" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate </span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Define the x-axis positions and labels</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]))</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">time_period</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Plot AOD550</span>
<span class="n">aod_values</span> <span class="o">=</span> <span class="n">ds_monthly_merged</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">aod_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (monthly)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AOD550&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>


<span class="c1"># Link temperature to the first axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Convert temperature to Celsius</span>
<span class="n">temperature_kelvin</span> <span class="o">=</span> <span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s2">&quot;skt&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>

<span class="c1"># Plot temperature (t2m)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_kelvin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;skt (monthly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;skin Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis ticks and labels for every other data point</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">monthly_labels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AOD550 and skin_temperature monthly Time-Series for Southeastern US (2017-2022)&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>






<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in ds_monmean_t2m</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Define the x-axis positions and labels for quarterly intervals</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]))</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">time_period</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Plot AOD550</span>
<span class="n">aod_values</span> <span class="o">=</span> <span class="n">ds_monthly_merged</span><span class="p">[</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">aod_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FM_AOD550 (Quarterly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (monthly)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;FM_AOD550&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>


<span class="c1"># Link temperature to the first axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Convert temperature to Celsius</span>
<span class="n">temperature_kelvin</span> <span class="o">=</span> <span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s2">&quot;skt&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>

<span class="c1"># Plot temperature (t2m)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_kelvin</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;skt (monthly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;skin Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis ticks and labels for every other data point</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">monthly_labels</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FM_AOD550 and skin_temperature monthly Time-Series for Southeastern US (2017-2022)&#39;</span><span class="p">)</span>
<span class="c1"># Adding gridlines to the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Adjust layout and display the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/4c403e2203b93d5e98783196491f838282c68d6f5e5f89d98ea9452a302be17f.png" src="../../_images/4c403e2203b93d5e98783196491f838282c68d6f5e5f89d98ea9452a302be17f.png" />
<img alt="../../_images/71e1e589ae7655d4fd8d8a949a871513b97c88871cecae88f201464169ce8d53.png" src="../../_images/71e1e589ae7655d4fd8d8a949a871513b97c88871cecae88f201464169ce8d53.png" />
</div>
</div>
</section>
<section id="plot-the-monthly-mean-time-series-of-2m-temperature-and-skin-temperature-for-southeastern-us-during-2017-2022">
<span id="satellite-satellite-aerosol-properties-consistency-q02-template-section-7"></span><h3>7. Plot the monthly mean time series of 2m_temperature and skin_temperature for Southeastern US during 2017-2022<a class="headerlink" href="#plot-the-monthly-mean-time-series-of-2m-temperature-and-skin-temperature-for-southeastern-us-during-2017-2022" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Extract the Period data directly from the forecast_reference_time coordinate in t2m_subset_ds</span>
<span class="n">time_period</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodIndex</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>

<span class="c1"># Define the x-axis positions and labels for every other month</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s1">&#39;forecast_reference_time&#39;</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">monthly_labels</span> <span class="o">=</span> <span class="n">time_period</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># Link temperature to the first axis</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="c1"># Convert temperature to Celsius</span>
<span class="n">temperature_skin_kelvin</span> <span class="o">=</span> <span class="n">skin_temperature_subset_ds</span><span class="p">[</span><span class="s2">&quot;skt&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>
<span class="n">temperature_t2m_kelvin</span> <span class="o">=</span> <span class="n">t2m_subset_ds</span><span class="p">[</span><span class="s2">&quot;t2m&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span>

<span class="c1"># Plot temperature (t2m)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_t2m_kelvin</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;temperature_2m (Monthly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;2m Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">monthly_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;2m and skin temperature Monthly Time-Series for Southeastern US (2017-2022)&#39;</span><span class="p">)</span>
<span class="c1"># Adding gridlines to the plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Plot temperature (skin_temperature)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">temperature_skin_kelvin</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;skin_temperature (Monthly)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Skin Temperature (°C)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout and display the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/496c32e30578896449f5a87b3090eb5270f0c116c7e53963cc537eeb66e2de14.png" src="../../_images/496c32e30578896449f5a87b3090eb5270f0c116c7e53963cc537eeb66e2de14.png" />
</div>
</div>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Cai, M., An, C., &amp; Guy, C. (2021). A scientometric analysis and review of biogenic volatile organic compound emissions: Research hotspots, new frontiers, and environmental implications. Renewable and Sustainable Energy Reviews, 149, 111317.</p></li>
<li><p>Liu, W., Wang, Y., Russell, A. and Edgerton, E.S., 2005. Atmospheric aerosol over two urban–rural pairs in the southeastern United States: Chemical composition and possible sources. Atmospheric Environment, 39(25), pp.4453-4470.</p></li>
<li><p>Xu, L., Suresh, S., Guo, H., Weber, R.J. and Ng, N.L., 2015. Aerosol characterization over the southeastern United States using high-resolution aerosol mass spectrometry: spatial and seasonal variation of aerosol composition and sources with a focus on organic nitrates. Atmospheric Chemistry and Physics, 15(13), pp.7307-7336.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-to-explain-the-relationship-between-aerosols-and-both-near-surface-and-skin-temperatures">🌍 Use case: Using satellite observations to explain the relationship between aerosols and both near-surface  and skin temperatures.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collection-and-preprocessing-download-aod-and-fine-aod-data">1. Data Collection and Preprocessing: Download AOD and fine_AOD data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-the-spatially-weighted-mean-of-aod550-and-faod550">2. Calculate and plot the spatially weighted mean of AOD550 and fAOD550.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-2-m-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">3. Download 2 m temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-2-m-temperature">4. Plot the monthly time series of AOD550 and fine_AOD550 versus 2 m temperature.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-skin-temperature-data-from-the-era5-land-monthly-averaged-data-from-1950-to-present-catalog-horizontal-resolution-0-1-x-0-1-temporal-resolution-monthly">5. Download skin temperature data from the “ERA5-Land monthly averaged data from 1950 to present” catalog (horizontal resolution: 0.1° x 0.1°; temporal resolution: monthly).</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-time-series-of-aod550-and-fine-aod550-versus-skin-temperature">6. Plot the monthly time series of AOD550 and fine_AOD550 versus skin temperature.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-monthly-mean-time-series-of-2m-temperature-and-skin-temperature-for-southeastern-us-during-2017-2022">7. Plot the monthly mean time series of 2m_temperature and skin_temperature for Southeastern US during 2017-2022</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>