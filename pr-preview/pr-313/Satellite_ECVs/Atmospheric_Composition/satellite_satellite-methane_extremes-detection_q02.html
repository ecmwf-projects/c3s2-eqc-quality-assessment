
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Spatial and temporal completeness of methane satellite observations for the analysis of extreme events related to large episodic releases &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_extremes-detection_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Spatial and temporal completeness of methane satellite observations for the analysis of extreme events related to large episodic releases</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_extremes-detection_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_extremes-detection_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Spatial and temporal completeness of methane satellite observations for the analysis of extreme events related to large episodic releases</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-detecting-extreme-release-of-methane-into-the-atmosphere">🌍 Use case: Detecting extreme release of methane into the atmosphere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-libraries-to-be-used">Define libraries to be used</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-notebook-setting-parameters-and-data-request">Define notebook setting parameters and data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-used-in-the-analysis">Define functions used in the analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">2. Data retrieval</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">Download and transform data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-and-plotting">3. Analyses and plotting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-analysis-of-mid-tropospheric-ch4">Spatial and temporal analysis of mid-tropospheric CH4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-analysis-of-cloud-cover">Spatial and temporal analysis of cloud cover</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-the-altitude-sensitivity-of-the-retrieved-mid-tropospheric-ch4">Analysis of the altitude sensitivity of the retrieved mid-tropospheric CH4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-variability-of-mid-tropospheric-ch-4-over-the-region">Temporal variability of mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> over the region</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="spatial-and-temporal-completeness-of-methane-satellite-observations-for-the-analysis-of-extreme-events-related-to-large-episodic-releases">
<h1><span class="section-number">1.2.1. </span>Spatial and temporal completeness of methane satellite observations for the analysis of extreme events related to large episodic releases<a class="headerlink" href="#spatial-and-temporal-completeness-of-methane-satellite-observations-for-the-analysis-of-extreme-events-related-to-large-episodic-releases" title="Link to this heading">#</a></h1>
<p>Production date: 23-04-2025</p>
<p>Produced by: CNR</p>
<section id="use-case-detecting-extreme-release-of-methane-into-the-atmosphere">
<h2>🌍 Use case: Detecting extreme release of methane into the atmosphere<a class="headerlink" href="#use-case-detecting-extreme-release-of-methane-into-the-atmosphere" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Are methane satellite observations suitable for detecting atmospheric signals associated with extreme emission releases?</strong></p></li>
<li><p><strong>How well, in terms of completeness, do Level 2 mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> columns capture the spatial variability of methane associated with large release events?</strong></p></li>
</ul>
<p>Methane (CH<span class="math notranslate nohighlight">\(_4\)</span>) is the second most important anthropogenic greenhouse gas after carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>), representing about 19% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://wmo.int/publication-series/wmo-greenhouse-gas-bulletin-no-19">[1]</a>. Atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> also adversely affects human health as a precursor of tropospheric ozone <a class="reference external" href="https://doi.org/10.1073/pnas.0600201103">[2]</a>. Thus, sudden large release of CH<span class="math notranslate nohighlight">\(_4\)</span> into the atmosphere could have significant consequences in terms of climate change and health.</p>
<p>On 26 September 2022, multiple gas leaks were detected from the Nord Stream, an offshore submerged pipeline system that carries natural gas from Russian facilities into Western Europe (<a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>, <a class="reference external" href="https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study">[4]</a>).</p>
<p>In this application, the Level-2 mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> columns from the IASI instruments (dataset version 10.2) is evaluated. A Level 2 dataset corresponds to data from a specific combination of satellite sensor and retrivial algorithm for each individual satellite footprint along the orbit tracks (see <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[5]</a>).</p>
<p>Although the CH<span class="math notranslate nohighlight">\(_4\)</span> satellite observations provided by the Climate Data Store are not specifically designed to identify sudden large release events, this application explores the possibility that mid-tropospheric satellite IASI CH<span class="math notranslate nohighlight">\(_4\)</span> (v10.2) data can be used to identify the atmospheric signal of emissions as those associated with the Nord Stream event.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The IASI CH<span class="math notranslate nohighlight">\(_4\)</span> (v10.2) mid-tropospheric product was only able to partially detect the atmospheric signal of massive CH<span class="math notranslate nohighlight">\(_4\)</span> release associated with the Nord Stream leak on September 2022.</p></li>
<li><p>In terms of completeness, the ability of IASI CH<span class="math notranslate nohighlight">\(_4\)</span> (v10.2) mid-tropospheric product to detect the atmospheric signal of the CH<span class="math notranslate nohighlight">\(_4\)</span> plume was mostly limited by the cloud coverage and users need to be aware about the strict cloud screening adopted for the production of this dataset.</p></li>
<li><p>As the vertical sensitivity of CH<span class="math notranslate nohighlight">\(_4\)</span> can affect the quantification of the atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> signal associated with surface releases, users must be aware of the vertical sensitivity of the product. They should consult the the Documentation (e.g., <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_E_latest.pdf">[7]</a>) for information about the altitude sensitivity of the retrieved CH<span class="math notranslate nohighlight">\(_4\)</span>.</p></li>
<li><p>The use of this data product to investigate CH<span class="math notranslate nohighlight">\(_4\)</span> fluxes occurring at the Earth’s surface is recommended in conjunction with appropriate (inversion) modelling.</p></li>
<li><p>Since this dataset is updated on a yearly basis, users interested in near real time applications should consider other Copernicus resources (e.g., <a class="reference external" href="https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;amp;utm_medium=referral&amp;amp;utm_campaign=CH4-app-2025">[11]</a>).</p></li>
</ul>
</div>
<p><img alt="Figure1.jpg" src="../../_images/c54ae6d5-d20f-46bf-b1c3-0cfa38b58afb.jpg" /></p>
<p><em>The figure shows mid-tropospheric IASI column average CH<span class="math notranslate nohighlight">\(_4\)</span> (ppb) for 26–28 September 2022 as provided by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a> under CC-BY license. Turquoise boxes show regions characterised by the presence of the methane plume. AM (PM) indicate the morning (evening) satellite overpasses of each day</em></p>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This notebook has three main objectives:</p>
<ul class="simple">
<li><p>To compare the spatial fields of mid-tropospheric column-averaged methane (CH<span class="math notranslate nohighlight">\(_4\)</span>) mixing ratios from IASI sensors with independent analyses <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a> over the geographical region and time frame (26-28 September 2022) affected by the Nord Stream emissions.</p></li>
<li><p>To attribute the observed differences as a function of the cloud cover over the observation scene and the adopted averaging kernels (describing the vertical sensitivity of the retrieved products).</p></li>
<li><p>To guide the user in the correct use of the evaluated data sets.</p></li>
</ul>
<p>The analysis methodology is divided into the following steps:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-extremes-detection-q02-section-1"><span class="std std-ref">1. Choose the data to use and setup the code</span></a></strong></p>
<ul class="simple">
<li><p>Define the libraries to be used.</p></li>
<li><p>Define notebook setup parameters and data requests.</p></li>
<li><p>Define the functions used in the analysis.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-extremes-detection-q02-section-2"><span class="std std-ref">2. Data retrieval</span></a></strong></p>
<ul class="simple">
<li><p>Download mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> and cloud cover data for the time period and spatial region of interest.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-extremes-detection-q02-section-3"><span class="std std-ref">3. Analyses and plotting</span></a></strong></p>
<ul class="simple">
<li><p>Spatial and temporal analysis of mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span>.</p></li>
<li><p>Spatial and temporal analysis of cloud cover.</p></li>
<li><p>Analysis of the altitude sensitivity of the retrieved mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span>.</p></li>
<li><p>Temporal variability of mid-tropospheric CH4 over the region.</p></li>
</ul>
<p>Note that prior to the analyses, the original Level 2 mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> data were regridded to a regular 1° x 1° grid and the cloud cover data were retrieved from the Climate Data Store dataset <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview">[6]</a> “Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations” (CLARA-A3).</p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-setup-the-code">
<span id="satellite-satellite-methane-extremes-detection-q02-section-1"></span><h3>1. Choose the data to use and setup the code<a class="headerlink" href="#choose-the-data-to-use-and-setup-the-code" title="Link to this heading">#</a></h3>
<section id="define-libraries-to-be-used">
<h4>Define libraries to be used<a class="headerlink" href="#define-libraries-to-be-used" title="Link to this heading">#</a></h4>
<p>In this step, libraries needed to run the code are imported.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/cristofanelli_paolo/.cdsapirc&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.mpl.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cticker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xarray.groupers</span><span class="w"> </span><span class="kn">import</span> <span class="n">BinGrouper</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>

<span class="n">download</span><span class="o">.</span><span class="n">INVALIDATE_CACHE</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Set True to invalidate the caching</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-notebook-setting-parameters-and-data-request">
<h4>Define notebook setting parameters and data request<a class="headerlink" href="#define-notebook-setting-parameters-and-data-request" title="Link to this heading">#</a></h4>
<p>In this step, we define:</p>
<ul class="simple">
<li><p>the list of sensors to be used for getting methane data.</p></li>
<li><p>the region of interest.</p></li>
<li><p>the variables to be retrieved by the datasets.</p></li>
<li><p>the time frame of data to be analysed.</p></li>
<li><p>the range of legend variability to plot CH4 values in the spatial map.</p></li>
<li><p>the list of Climate Data Store datasets to be downloaded.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sensors</span>
<span class="n">sensors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;iasi_metop_b_nlis&quot;</span><span class="p">,</span> <span class="s2">&quot;iasi_metop_c_nlis&quot;</span><span class="p">]</span>

<span class="c1"># Region to plot</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Variable to plot</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s2">&quot;ch4&quot;</span>
<span class="n">vertical_profile</span> <span class="o">=</span> <span class="s2">&quot;ch4_averaging_kernel&quot;</span>
<span class="n">varname_cloud</span> <span class="o">=</span> <span class="s2">&quot;cfc&quot;</span>

<span class="c1"># List of days to be considered (format &#39;YYYY-MM-DD&#39;)</span>
<span class="n">selected_days</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2022-09-26&quot;</span><span class="p">,</span><span class="s2">&quot;2022-09-27&quot;</span><span class="p">,</span><span class="s2">&quot;2022-09-28&quot;</span><span class="p">]</span>
<span class="n">selected_days_AK</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2022-09-28&quot;</span><span class="p">]</span>

<span class="c1"># To define the range of map legend</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">1875</span>  <span class="c1"># Min value</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">1950</span>  <span class="c1"># max value</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2022&quot;</span><span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;09&quot;</span><span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-methane&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">time_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;level_2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;ch4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10_2&quot;</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">collection_id_cloud</span> <span class="o">=</span> <span class="s2">&quot;satellite-cloud-properties&quot;</span>
<span class="n">request_cloud</span> <span class="o">=</span> <span class="n">time_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;clara_a3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;eumetsat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cloud_fraction&quot;</span><span class="p">],</span>
    <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;interim_climate_data_record&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_mean&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-functions-used-in-the-analysis">
<h4>Define functions used in the analysis<a class="headerlink" href="#define-functions-used-in-the-analysis" title="Link to this heading">#</a></h4>
<p>In this step we define the functions to be used in the analysis:</p>
<ul class="simple">
<li><p>Function to regrid the data to a regular spatial grid.</p></li>
<li><p>Function to extract mean kernel values and associated pressure levels from the mid-tropospheric IASI CH4 (v10.2) dataset and perform spatial aggregation.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_unweighted_average</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">d_lon</span><span class="p">,</span> <span class="n">d_lat</span><span class="p">,</span> <span class="n">lon1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lon1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lon1 must be 180 or 360. </span><span class="si">{</span><span class="n">lon1</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lon0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span> <span class="k">if</span> <span class="n">lon1</span> <span class="o">==</span> <span class="mi">180</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon0</span><span class="p">],</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="p">],</span> <span class="p">[</span><span class="n">d_lat</span><span class="p">,</span> <span class="n">d_lon</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="n">coords</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">BinGrouper</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span>
            <span class="n">include_lowest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">stop</span> <span class="o">+</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">coords</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">_bins&quot;</span><span class="p">:</span> <span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">regionalised_daily_bin_grouper</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">d_lon</span><span class="p">,</span> <span class="n">d_lat</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=</span><span class="mi">180</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;level_dim&quot;</span><span class="p">,</span> <span class="s2">&quot;layer_dim&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;pressure_levels&quot;</span><span class="p">,</span> <span class="s2">&quot;pressure_weight&quot;</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">==</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">var</span><span class="p">})</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;pressure_levels&quot;</span><span class="p">])</span>
    <span class="n">ds_out</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
        <span class="n">arithmetic_unweighted_average</span><span class="p">,</span> <span class="n">d_lon</span><span class="o">=</span><span class="n">d_lon</span><span class="p">,</span> <span class="n">d_lat</span><span class="o">=</span><span class="n">d_lat</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=</span><span class="n">lon1</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds_out</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-retrieval">
<span id="satellite-satellite-methane-extremes-detection-q02-section-2"></span><h3>2. Data retrieval<a class="headerlink" href="#data-retrieval" title="Link to this heading">#</a></h3>
<section id="download-and-transform-data">
<h4>Download and transform data<a class="headerlink" href="#download-and-transform-data" title="Link to this heading">#</a></h4>
<p>In this step, mid-tropospheric IASI CH4 (v10.2) and cloud cover data (CLARA-A3) are downloaded from the Climate Data Store; functions are applied to the datasets.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">}</span>

<span class="c1"># Methane</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">sensors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sensor</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="n">sensor</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">regionalised_daily_bin_grouper</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">kwargs</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;d_lon&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">#This define the spatial resolution of longitude for the regular grid</span>
            <span class="s2">&quot;d_lat&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">#This define the spatial resolution of Latitude for the regular grid</span>
            <span class="s2">&quot;lon1&quot;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sensor</span><span class="o">=</span><span class="p">[</span><span class="n">sensor</span><span class="p">]))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;sensor&quot;</span><span class="p">)</span>

<span class="c1"># Cloud</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cloud cover&quot;</span><span class="p">)</span>
<span class="n">ds_cloud</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id_cloud</span><span class="p">,</span>
    <span class="n">request_cloud</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sensor = &#39;iasi_metop_b_nlis&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00,  1.63it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sensor = &#39;iasi_metop_c_nlis&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00,  5.96it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cloud cover
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:00&lt;00:00,  1.60it/s]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analyses-and-plotting">
<span id="satellite-satellite-methane-extremes-detection-q02-section-3"></span><h3>3. Analyses and plotting<a class="headerlink" href="#analyses-and-plotting" title="Link to this heading">#</a></h3>
<section id="spatial-and-temporal-analysis-of-mid-tropospheric-ch4">
<h4>Spatial and temporal analysis of mid-tropospheric CH4<a class="headerlink" href="#spatial-and-temporal-analysis-of-mid-tropospheric-ch4" title="Link to this heading">#</a></h4>
<p>Here we have plotted the mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> data from IASI-B and IASI-C in the spatial domain and temporal framework defined by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>.
As described by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>, the CH<span class="math notranslate nohighlight">\(_4\)</span> released from the Nordstream pipeline moved from the Baltic Sea northwards and eastwards from the point of emission during the first day, while during the following two days it was transported westwards across the Scandinavian peninsula and the North Sea.</p>
<p>The area of high CH<span class="math notranslate nohighlight">\(_4\)</span> values identified by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a> as affected by the Nord Stream release over [0°-5° E, 60° - 65°N] is well visible in the IASI-C data on 28 September 2022 and partially detected by IASI-B over the western Scandinavian coasts. However, despite <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>, the Climate Data Store mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> data from the IASI-B and IASI-C were not able to detect the Nord Stream plume over the Baltic Sea on 26 September 2022 and west of 0°E on 28 September 2022. This is related to the fact that the Climate Data Store mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> columns have a lower spatial occurrence of valid data, due to the different algorithm and quality control screening applied in the dataset production.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To plot CH4 data for sensors and selected days</span>
<span class="k">for</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">ds_sensor</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;sensor&quot;</span><span class="p">):</span>
        <span class="c1"># Select days of interest</span>
        <span class="n">ds_sensor_filtered</span> <span class="o">=</span> <span class="n">ds_sensor</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_days</span><span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">ds_sensor_filtered</span><span class="p">[</span><span class="s2">&quot;ch4&quot;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sensor</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/5ea4fc86ed6a4424693e27ac594d61df911148dca38a444366f0479ec9621d9a.png" src="../../_images/5ea4fc86ed6a4424693e27ac594d61df911148dca38a444366f0479ec9621d9a.png" />
<img alt="../../_images/d7547fb86539ed1ad03ab1ae87cfc9e423905eb687e726aaa8cc52e4d6745b85.png" src="../../_images/d7547fb86539ed1ad03ab1ae87cfc9e423905eb687e726aaa8cc52e4d6745b85.png" />
</div>
</div>
<p><em>The figure shows mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> (expressed in ppb) for 26-28 September 2022 as provided by the IASI-B (upper plots) and IASI-C (lower plots) datasets (v10.2).</em></p>
</section>
<section id="spatial-and-temporal-analysis-of-cloud-cover">
<h4>Spatial and temporal analysis of cloud cover<a class="headerlink" href="#spatial-and-temporal-analysis-of-cloud-cover" title="Link to this heading">#</a></h4>
<p>To attribute differences in the data availability between mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> data from Climate Data Store and that reported by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>, we inspected the daily values of cloud cover fraction provided by the Interim Climate Data Record <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview">[6]</a> “Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations” (product family: CLARA-A3).</p>
<p>It is clear that the the presence of high values of cloud cover fraction over the most part of the observation scene prevented the detection of the Nord Stream plume on 26 -  27 September 202 by the Climate Data Store IASI mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> dataset. According to the Documentation <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_E_latest.pdf">[7]</a>, the Climate Data Store mid-tropospheric satellite IASI CH4 (v10.2) dataset is retrieved when no cloud or aerosol is detected. On the other hand, for the dataset used by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a>, only scenes strongly affected by clouds are not processed <a class="reference external" href="https://doi.org/10.5281/zenodo.5873645">[8]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;custom_cmap&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">])</span>

<span class="c1"># Filter data for selected days</span>
<span class="n">ds_cloud_filtered</span> <span class="o">=</span> <span class="n">ds_cloud</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_days</span><span class="p">)</span>

<span class="c1"># Setting plot view</span>
<span class="n">plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;col_wrap&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="c1"># Plotting cloud cover data</span>
<span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">ds_cloud_filtered</span><span class="p">[</span><span class="n">varname_cloud</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Cloud cover&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ea8f788c3979c898f92b8652c29315e197ee5c04ae80077999c81237a6096d36.png" src="../../_images/ea8f788c3979c898f92b8652c29315e197ee5c04ae80077999c81237a6096d36.png" />
</div>
</div>
<p><em>The figure shows the total cloud coverage fraction (espressed as %) for 26-28 September 2022 as provided by the Climate Data Store Interim Climate Data Record “Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations” (product family: CLARA-A3)</em></p>
</section>
<section id="analysis-of-the-altitude-sensitivity-of-the-retrieved-mid-tropospheric-ch4">
<h4>Analysis of the altitude sensitivity of the retrieved mid-tropospheric CH4<a class="headerlink" href="#analysis-of-the-altitude-sensitivity-of-the-retrieved-mid-tropospheric-ch4" title="Link to this heading">#</a></h4>
<p>The vertical sensitivity of the IASI CH<span class="math notranslate nohighlight">\(_4\)</span> mid-tropospheric product may affect the identification and the quantification of the plume from the Nord Stream pipelines. The averaging kernel (AK), which is provided as variable in the Climate Data Store data, accounts for the vertical sensitivity of the derived CH<span class="math notranslate nohighlight">\(_4\)</span> values from the IASI retrievals, as described in <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_E_latest.pdf">[7]</a>.</p>
<p>For the Climate Data Store mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> product, the normalised column AK values averaged over the spatial domain showed a maximum sensitivity in the mid-upper troposphere (from 100 to 600 hPa) during the time period considered. According to [[3]] (<a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">https://doi.org/10.5194/acp-24-10639-2024</a>), the southern part of the Nord Stream plume [59-63° N; 0-7° E], extending from the west coast of Scandinavia, was diffuse above 500 hPa, favouring the plume detection by the Climate Data Store mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> IASI data products.</p>
<p>Users interested in further information on the use of the AKs (as an example for comparison with model simulations) are encouraged to consult the dataset documentation <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_E_latest.pdf">[9]</a> and <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[5]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting plot view</span>
<span class="n">plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;col_wrap&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="k">for</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">da_sensor</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="n">vertical_profile</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;sensor&quot;</span><span class="p">):</span>
    <span class="n">da_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da_sensor</span><span class="p">)</span>
    <span class="n">da_std</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_std</span><span class="p">(</span><span class="n">da_sensor</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">da_mean</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="n">da_mean</span> <span class="o">+</span> <span class="n">da_std</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean $+$ std&quot;</span><span class="p">]),</span>
            <span class="p">(</span><span class="n">da_mean</span> <span class="o">-</span> <span class="n">da_std</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean $-$ std&quot;</span><span class="p">]),</span>
        <span class="p">],</span>
        <span class="s2">&quot;label&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">da_filtered</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_days_AK</span><span class="p">)</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da_filtered</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure_weight&quot;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
        <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
        <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>  <span class="c1"># Limit y axis to 1</span>
        <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sensor</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f7616b16d1b9464a62059a678288b08faf0e02257fef40d0d20cdbd7af5057ea.png" src="../../_images/f7616b16d1b9464a62059a678288b08faf0e02257fef40d0d20cdbd7af5057ea.png" />
<img alt="../../_images/65b61a78abbd3ff2a41ad9b9f08dd59e44135020a66267252f538a525db0db92.png" src="../../_images/65b61a78abbd3ff2a41ad9b9f08dd59e44135020a66267252f538a525db0db92.png" />
</div>
</div>
<p><em>IASI-B (top plot) and IASI-C (bottom plot) for CH<span class="math notranslate nohighlight">\(_4\)</span> normalised column averaging kernel computed over the analysed region on 28 September 2022.</em></p>
</section>
<section id="temporal-variability-of-mid-tropospheric-ch-4-over-the-region">
<h4>Temporal variability of mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> over the region<a class="headerlink" href="#temporal-variability-of-mid-tropospheric-ch-4-over-the-region" title="Link to this heading">#</a></h4>
<p>As clearly stated in the dataset Documentation <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[5]</a>, the dataset “Methane data from 2002 to present derived from satellite observations” should be used them in combination with appropriate modelling to obtain information on surface CH<span class="math notranslate nohighlight">\(_4\)</span> fluxes.</p>
<p>To illustrate that the use of this dataset without appropriate modelling can lead to misleading conclusions, we analysed the temporal variability of the mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> column over the study region. In particular, we calculated the distribution of CH<span class="math notranslate nohighlight">\(_4\)</span> values for each single day during September 2022 for both IASI-B and IASI-C. The box and wiskers plot shows the percentiles of the data distribution, the median (green line) as well as the outliers.
It can be seen that despite the occurrence of the Nord Stream leak and the effective detection of the plume signal by IASI-C on 29 September 2022, the CH<span class="math notranslate nohighlight">\(_4\)</span> values did not deviate from the monthly variability. This shows that even if the atmospheric data provided by the mid-tropospheric IASI CH<span class="math notranslate nohighlight">\(_4\)</span> (v10.2) dataset contain the signal of the CH<span class="math notranslate nohighlight">\(_4\)</span> release from the Nord Stream pipelines, it can hardly be detected without the use of appropriate modelling, as adopted by <a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a> or <a class="reference external" href="https://climate.copernicus.eu/esotc/2023/greenhouse-gas-fluxes">[10]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">ds_sensor</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;sensor&quot;</span><span class="p">):</span>
    <span class="n">da_sensor</span> <span class="o">=</span> <span class="n">ds_sensor</span><span class="p">[</span><span class="s2">&quot;ch4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="n">df_sensor</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">da_sensor</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
        <span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">df_sensor</span> <span class="o">=</span> <span class="n">df_sensor</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;ch4&quot;</span><span class="p">]]</span>
    <span class="n">df_sensor</span><span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sensor</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">df_sensor</span><span class="p">[[</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;ch4&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sensor</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;day&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_sensor</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_sensor</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c1fc4e375728f69a5591f5e7be8d2458d43734cff45ee8684dd476a3a819c91b.png" src="../../_images/c1fc4e375728f69a5591f5e7be8d2458d43734cff45ee8684dd476a3a819c91b.png" />
<img alt="../../_images/b465c4a30ac62ff726874664b46f28574b25349b216f5d266ac4c045016ced0b.png" src="../../_images/b465c4a30ac62ff726874664b46f28574b25349b216f5d266ac4c045016ced0b.png" />
</div>
</div>
<p><em>Daily percentiles and outliers for mid-tropospheric CH4 (expressed in ppb) during September 2022 as provided by the IASI-B (upper plots) and IASI-C (lower plots) datasets (v10.2).</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Methane data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview">https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview</a></p></li>
<li><p>Cloud properties global gridded monthly and daily data from 1979 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview">https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview</a></p></li>
</ul>
<p>More information on the Nord Stream leak event can be found in <a class="reference external" href="https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study">[4]</a>.</p>
<p>Users interested in near-ral time detection of hot-spot locations for methane emissions can consider to use the CAMS Methane Hotspot Explorer <a class="reference external" href="https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;amp;utm_medium=referral&amp;amp;utm_campaign=CH4-app-2025">[11]</a>.</p>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
<p><a class="reference external" href="https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study">https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study</a></p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://wmo.int/publication-series/wmo-greenhouse-gas-bulletin-no-19">[1]</a> World Meteorological Organization (2023). WMO Greenhouse Gas Bulletin, No. 19, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.1073/pnas.0600201103">[2]</a> West, J. J., Fiore, A. M., Horowitz, L. W., and Mauzerall, D. L. (2006). Global health benefits of mitigating ozone pollution with methane emission controls. P. Natl. Acad. Sci. USA, 103, 3988–3993.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-24-10639-2024">[3]</a> Wilson, C., Kerridge, B. J., Siddans, R., Moore, D. P., Ventress, L. J., Dowd, E., Feng, W., Chipperfield, M. P., and Remedios, J. J. (2024). Quantifying large methane emissions from the Nord Stream pipeline gas leak of September 2022 using IASI satellite observations and inverse modelling. Atmos. Chem. Phys., 24, 10639–10653.</p>
<p><a class="reference external" href="https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study">[4]</a> United Nations Environmental Programme (UNEP), (2025). Pipeline blasts released record-shattering amount of methane: UNEP study. <a class="reference external" href="https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study">https://www.unep.org/news-and-stories/story/pipeline-blasts-released-record-shattering-amount-methane-unep-study</a>.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[5]</a> Buchwitz, M. (2024). Product User Guide and Specification (PUGS) – Main document for Greenhouse Gas (GHG: CO2 &amp; CH4) data set CDR7 (01.2003-12.2022).</p>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-cloud-properties?tab=overview">[6]</a> Copernicus Climate Change Service (C3S), Climate Data Store (CDS). (2022). Cloud properties global gridded monthly and daily data from 1982 to present derived from satellite observations. Copernicus Climate Change Service (C3S) Climate Data Store (CDS). DOI: 10.24381/cds.68653055 (Accessed on 19-Mar-2025).</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_E_latest.pdf">[7]</a> Crevoisier, C. (2024). Algorithm Theoretical Basis Document (ATBD) – ANNEX E for IASI CO2 (v10.1) and CH4 (v10.2) and AIRS CO2 mid-tropospheric products.</p>
<p><a class="reference external" href="https://doi.org/10.5281/zenodo.5873645">[8]</a>. Ventress, L., Siddans, R., Knappett, D. (2021). RAL IASI Methane Retrieval (ATDB).</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_E_latest.pdf">[9]</a> Crevoisier, C. (2023). Product User Guide and Specification (PUGS) – ANNEX E for IASI CO2 (10.1) and CH4 (v10.2) and AIRS CO2 mid-tropospheric products.</p>
<p><a class="reference external" href="https://climate.copernicus.eu/esotc/2023/greenhouse-gas-fluxes">[10]</a> Copernicus Climate Change Service (C3S). (2024). European State of the Climate 2023, Web site.</p>
<p><a class="reference external" href="https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;amp;utm_medium=referral&amp;amp;utm_campaign=CH4-app-2025">[11]</a> Copernicus Atmosphere Monitoring Service (CAMS). (2025). Copernicus: Tool to routinely identify and track methane emissions and leaks goes operational, Web site.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-detecting-extreme-release-of-methane-into-the-atmosphere">🌍 Use case: Detecting extreme release of methane into the atmosphere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-libraries-to-be-used">Define libraries to be used</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-notebook-setting-parameters-and-data-request">Define notebook setting parameters and data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-used-in-the-analysis">Define functions used in the analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">2. Data retrieval</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">Download and transform data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyses-and-plotting">3. Analyses and plotting</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-analysis-of-mid-tropospheric-ch4">Spatial and temporal analysis of mid-tropospheric CH4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-and-temporal-analysis-of-cloud-cover">Spatial and temporal analysis of cloud cover</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-the-altitude-sensitivity-of-the-retrieved-mid-tropospheric-ch4">Analysis of the altitude sensitivity of the retrieved mid-tropospheric CH4</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-variability-of-mid-tropospheric-ch-4-over-the-region">Temporal variability of mid-tropospheric CH<span class="math notranslate nohighlight">\(_4\)</span> over the region</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>