
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1.1. Satellite Earth‚Äôs outgoing longwave and shortwave radiation budget intercomparison for climate monitoring &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmosphere_Physics/satellite_satellite-earth-radiation-budget_climate-monitoring_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2. Atmospheric Composition" href="../Atmospheric_Composition/Atmospheric_Composition.html" />
    <link rel="prev" title="1.1. Atmosphere Physics" href="Atmosphere_Physics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.1.1. Satellite Earth‚Äôs outgoing longwave and shortwave radiation budget intercomparison for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmosphere_Physics/satellite_satellite-earth-radiation-budget_climate-monitoring_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmosphere_Physics/satellite_satellite-earth-radiation-budget_climate-monitoring_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite Earth‚Äôs outgoing longwave and shortwave radiation budget intercomparison for climate monitoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-consistency-assessment-of-earth-radiation-budget-products">üåç Use case: Consistency assessment of Earth Radiation Budget products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-code">1. Choose the data to use and setup code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">2. Download and transform</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-weighted-time-series">3. Plot spatial weighted time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-weighted-means">4. Plot time weighted means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-weighted-zonal-means">5. Plot spatial weighted zonal means</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-applications">Discussion and applications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-earth-s-outgoing-longwave-and-shortwave-radiation-budget-intercomparison-for-climate-monitoring">
<h1><span class="section-number">1.1.1. </span>Satellite Earth‚Äôs outgoing longwave and shortwave radiation budget intercomparison for climate monitoring<a class="headerlink" href="#satellite-earth-s-outgoing-longwave-and-shortwave-radiation-budget-intercomparison-for-climate-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 11-06-2025</p>
<p>Produced by: CNR-ISMAR, Andrea Storto, Vincenzo de Toma</p>
<section id="use-case-consistency-assessment-of-earth-radiation-budget-products">
<h2>üåç Use case: Consistency assessment of Earth Radiation Budget products<a class="headerlink" href="#use-case-consistency-assessment-of-earth-radiation-budget-products" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>‚ùì Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How consistent are the Earth Radiation Budget products provided by C3S?</strong></p></li>
</ul>
<p>The Earth Radiation Budget (ERB) Outgoing Longwave Radiation (OLR) and Outgoing Shortwave Radiation (OSR) products allow quantifying outgoing longwave and shortwave radiation, respectively, which are in turn important for several climate applications. In particular, a non-exhaustive list of possible applications include: i) evaluation and potential improvement of climate models, through routinely validation of CMIP individual simulations and ensembles against OLR and OSR data, allowing to assess the net radiative forcing and possibly leading to improved configurations through re-tuning of e.g. aerosol-cloud interactions, radiative transfer schemes, etc.; ii) tracking the Earth‚Äôs Energy Imbalance (EEI), which consists of long-term mean imbalance of incoming and outgoing energy at the top-of-the-atmosphere (TOA). This imbalance is mostly accumulated into the oceans, and its analysis is crucial to monitor recent global warming; iii) diagnosing El-Ni√±o Southern Oscillation (ENSO) and other climate variability modes, which are intimately linked to anomalies of OLR (e.g. enhanced convection); iv) analyse cloud radiative effects (e.g. in combination with clear-sky radiative data) and their impact on climatic changes; and many more.
However, their temporal coverage and spatial detail varies across the ERB products. Over the overlapping periods, the products are in good agreement, except for the OLR at high latitudes (e.g. north of 60*N / south of 60¬∞S), while discrepancies in OSR arise at both mid- (generally less than 10 W m-2) and high-latitudes.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The OLR/OSR products capture the spatial and temporal variability of the outgoing longwave radiation / outgoing shortwave radiation (at the top of the atmosphere) for use in climate analyses, climate model evaluations, and radiative forcing studies.</p></li>
<li><p>The ERB OLR/OSR products have different temporal coverage and spatial resolution, namely their combined use is not straightforward and it is recommended for advanced users only, or for selected periods.</p></li>
<li><p>The consistency between the products concerning spatially averaged values is generally acceptable. Climatological maps and zonally averaged values indicate that the products are sufficiently consistent in most areas, although differences exist and tend to increase near the polar regions.</p></li>
</ul>
</div>
<p>The estimation of outgoing longwave radiation (OLR) at the top of the atmosphere is crucial for understanding the Earth‚Äôs radiation budget (ERB), which plays a significant role in climate dynamics and energy balance. Despite its importance, accurately assessing OLR-ERB variability using remote sensing data and satellite missions is fraught with challenges due to calibration inconsistencies, data gaps, and the complex interactions of radiation with atmospheric constituents (<a class="reference external" href="https://doi.org/10.1175/2008JCLI2637.1" rel="noreferrer" target="_blank">[1]</a>;
<a class="reference external" href="https://doi.org/10.1038/35066553" rel="noreferrer" target="_blank">[2]</a>; <a class="reference external" href="https://doi.org/10.1175/1520-0477%281996%29077%3C0853:CATERE%3E2.0.CO;2" rel="noreferrer" target="_blank">[3]</a>; <a class="reference external" href="https://doi.org/10.1007/s10712-012-9175-1" rel="noreferrer" target="_blank">[4]</a>).</p>
<figure class="align-default" id="id1">
<img alt="../../_images/fe6b3cc3-aeda-4728-9fc5-f6236eefd64b.png" src="../../_images/fe6b3cc3-aeda-4728-9fc5-f6236eefd64b.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.1.1.1 </span><span class="caption-text">Monthly mean time series of OLR (first row), OSR (second row) Ensemble mean Net Top Of the Atmosphere Radiation (NTOAR) (third row) for different geographical regions (columns).</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>In this notebook we inter-compare the following Earth Radiation Budget Products, available through the Climate Data Store (CDS) by C3S:</p>
<ol class="arabic simple">
<li><p>CERES Energy Balanced and Filled (EBAF) TOA Monthly means data in netCDF Edition4.1. NASA Langley Atmospheric Science Data Center DAAC (NASA CERES EBAF)</p></li>
<li><p>NOAA CDR Program, (2018): NOAA Climate Data Record (CDR) of Monthly Outgoing Longwave Radiation (OLR), Version 2.7 (NOAA/NCEI HIRS).</p></li>
<li><p>Earth‚Äôs radiation budget from 1979 to present derived from satellite observations. CCI ICDR product version 3.1. Copernicus Climate Change Service Climate Data Store (C3S CCI).</p></li>
<li><p>ESA Cloud Climate Change Initiative (ESA Cloud_cci) data: Cloud_cci ATSR2-AATSR L3C/L3U CLD_PRODUCTS v3.0 (ESA Cloud CCI).</p></li>
</ol>
<p>CERES is the only product which gives also the incoming shortwave radiation: thus, in order to evaluate the Net Top Of the Atmosphere Radiation, the ensemble mean budget was built using outgoing longwave and outgoing shortwave from each product, and the incoming shortwave from CERES, and then averaging across the product dimension.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-earth-radiation-budget-climate-monitoring-q01-choose-the-data-to-use-and-setup-code"><span class="std std-ref">1. Choose the data to use and setup code</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-earth-radiation-budget-climate-monitoring-q01-download-and-transform"><span class="std std-ref">2. Download and transform</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-spatial-weighted-time-series"><span class="std std-ref">3. Plot spatial weighted time series</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-time-weighted-means"><span class="std std-ref">4. Plot time weighted means</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-spatial-weighted-zonal-means"><span class="std std-ref">5. Plot spatial weighted zonal means</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-setup-code">
<span id="satellite-satellite-earth-radiation-budget-climate-monitoring-q01-choose-the-data-to-use-and-setup-code"></span><h3>1. Choose the data to use and setup code<a class="headerlink" href="#choose-the-data-to-use-and-setup-code" title="Link to this heading">#</a></h3>
<p>In this section, we import the required packages and set up the dataset names for further use in the following sections. Processing functions are also defined. We select only complete years available for each dataset in order to have a fair comparison between different products.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/detoma_vincenzo/.cdsapirc&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy</span><span class="w"> </span><span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.mpl.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cticker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">diagnostics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Variable to analyse</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">,</span> <span class="s2">&quot;outgoing_shortwave&quot;</span><span class="p">,</span> <span class="s2">&quot;incoming_shortwave&quot;</span><span class="p">]</span>
<span class="n">request_dicts</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>

    <span class="c1"># Region for timeseries</span>
    <span class="n">region_slices</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)},</span>
        <span class="s2">&quot;northern hemisphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)},</span>
        <span class="s2">&quot;southern hemisphere&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)},</span>
    <span class="p">}</span>

    <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-earth-radiation-budget&quot;</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;olr&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_lw_all_mon&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;outgoing_longwave&quot;</span> <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;rsf&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_sw_all_mon&quot;</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-earth-radiation-budget&quot;</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;olr&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_lw_all_mon&quot;</span><span class="p">,</span> <span class="s2">&quot;LW_flux&quot;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;outgoint_longwave&quot;</span>
        <span class="k">else</span> <span class="p">{</span><span class="s2">&quot;rsf&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_sw_all_mon&quot;</span><span class="p">,</span> <span class="s2">&quot;SW_flux&quot;</span><span class="p">}</span>
    <span class="p">)</span>

    <span class="n">request_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;CERES&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2001-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;ceres_ebaf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;nasa&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">_radiation&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;Sentinel 3A&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;c3s&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;slstr_on_sentinel_3a&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all_variables&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;cci&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;interim_climate_data_record&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;Sentinel 3B&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;c3s&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;slstr_on_sentinel_3b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all_variables&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;cci&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;interim_climate_data_record&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;Sentinel 3A_3B&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;c3s&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;slstr_on_sentinel_3a_3b&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all_variables&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;cci&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;interim_climate_data_record&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;ESA ENVISAT&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2003-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2011-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;esa&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;cci&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;aatsr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all_variables&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;CLARA_A3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;1979-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;clara_a3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;eumetsat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">_radiation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;HIRS&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;1979-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;noaa_ncei&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;hirs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_7_reprocessed&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">_radiation&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;CERES_noMask&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;2001-01&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-12&quot;</span><span class="p">,</span>
            <span class="s2">&quot;product_family&quot;</span><span class="p">:</span> <span class="s2">&quot;ceres_ebaf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;climate_data_record_type&quot;</span><span class="p">:</span> <span class="s2">&quot;thematic_climate_data_record&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;nasa&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2">_radiation&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">request_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">request_dict</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_time</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">ds</span> <span class="ow">and</span> <span class="s2">&quot;units&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
        <span class="c1"># Could not decode</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;time_coverage_start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">,</span> <span class="n">regrid</span><span class="p">,</span> <span class="n">ds_obj</span><span class="p">,</span> <span class="n">SKIP</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">regrid</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="n">SKIP</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="n">SKIP</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">regrid</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="n">SKIP</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mask</span><span class="p">)),</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="n">SKIP</span><span class="p">)</span>

<span class="n">xarray_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;time_bounds&quot;</span><span class="p">,</span> <span class="s2">&quot;record_status&quot;</span><span class="p">],</span>
    <span class="s2">&quot;preprocess&quot;</span><span class="p">:</span> <span class="n">preprocess_time</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform">
<span id="satellite-satellite-earth-radiation-budget-climate-monitoring-q01-download-and-transform"></span><h3>2. Download and transform<a class="headerlink" href="#download-and-transform" title="Link to this heading">#</a></h3>
<p>The code below will download the products. Notice the definition of common periods for the different products, and their inclusion in the mean map dictionary. When the variable to download is the shortwave component, we skip the HIRS dataset, since only longwave is available within it.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span><span class="o">=</span><span class="kc">True</span>
<span class="n">skipna</span><span class="o">=</span><span class="kc">True</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">start_var</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">stop_var</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">DS</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">variable</span><span class="p">,</span> <span class="n">request_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">request_dicts</span><span class="p">):</span>
    <span class="n">Ds</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">start_prod</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stop_prod</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">request_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;HIRS&quot;</span> <span class="ow">and</span> <span class="n">variable</span> <span class="o">!=</span> <span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s2">&quot;CERES&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">product</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">==</span><span class="s2">&quot;incoming_shortwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
    
        <span class="n">start</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;stop&quot;</span><span class="p">)</span>
        <span class="n">start_prod</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">start</span>
        <span class="n">stop_prod</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">stop</span>
        
        <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
            <span class="n">request</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">stop</span><span class="p">,</span> <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id</span><span class="p">,</span>
            <span class="n">requests</span><span class="p">,</span>
            <span class="c1">#transform_func=diagnostics.time_weighted_mean,</span>
            <span class="c1">#transform_func_kwargs={&#39;weights&#39;:True, &#39;skipna&#39;:False},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
            <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">,</span>
            <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">Ds</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
    <span class="n">start_var</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_prod</span>
    <span class="n">stop_var</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">stop_prod</span>
    <span class="n">DS</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ds</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clara_a3_start</span><span class="p">,</span> <span class="n">clara_a3_end</span> <span class="o">=</span><span class="s2">&quot;1980-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12&quot;</span>
<span class="n">ceres_start</span><span class="p">,</span> <span class="n">ceres_end</span> <span class="o">=</span> <span class="s2">&quot;2001-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-12&quot;</span>
<span class="n">esa_envisat_start</span><span class="p">,</span> <span class="n">esa_envisat_end</span> <span class="o">=</span> <span class="s2">&quot;2003-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2011-12&quot;</span> 
<span class="n">sentinel_start</span><span class="p">,</span> <span class="n">sentinel_end</span> <span class="o">=</span> <span class="s2">&quot;2019-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2021-12&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mean_map_period</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">S</span><span class="p">):</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span>
    <span class="n">time_coord</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">time_coord</span><span class="p">,</span> <span class="n">selection</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">attrs</span><span class="p">)})</span>
    <span class="n">ds_map</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="n">S</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_map</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_varname</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">variable</span><span class="o">==</span><span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">:</span>
        <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;olr&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_lw_all_mon&quot;</span><span class="p">,</span> <span class="s2">&quot;LW_flux&quot;</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">variable</span><span class="o">==</span><span class="s2">&quot;outgoing_shortwave&quot;</span><span class="p">:</span>
        <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;rsf&quot;</span><span class="p">,</span> <span class="s2">&quot;toa_sw_all_mon&quot;</span><span class="p">,</span> <span class="s2">&quot;SW_flux&quot;</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;solar_mon&quot;</span><span class="p">}</span>
        <span class="p">)</span>
        
    <span class="p">(</span><span class="n">varname</span><span class="p">,)</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">varnames</span>
    <span class="k">return</span> <span class="n">varname</span>

<span class="n">ds_maps</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ds_maps_p1</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ds_maps_p2</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ds_maps_p3</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ds_maps_p4</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">variable</span><span class="p">,</span> <span class="n">request_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">request_dicts</span><span class="p">):</span>
    <span class="n">da_maps</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">da_maps_p1</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">da_maps_p2</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">da_maps_p3</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">da_maps_p4</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">request_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;HIRS&quot;</span> <span class="ow">and</span> <span class="n">variable</span> <span class="o">!=</span> <span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s2">&quot;CERES&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">product</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">==</span><span class="s2">&quot;incoming_shortwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
    
        <span class="n">start</span> <span class="o">=</span> <span class="n">start_var</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">stop_var</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>

        <span class="n">ds</span> <span class="o">=</span> <span class="n">DS</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>
        
        <span class="n">varname</span><span class="o">=</span><span class="n">get_varname</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
        
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">product</span><span class="o">==</span><span class="s2">&quot;CERES&quot;</span><span class="p">:</span>
            <span class="n">regrid</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">da_obj</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">regrid</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
        <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
        <span class="n">da_maps</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">curr_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)</span>
        <span class="n">ceres_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">ceres_start</span><span class="p">,</span> <span class="n">ceres_end</span><span class="p">)</span>
        <span class="n">clara_a3_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">clara_a3_start</span><span class="p">,</span> <span class="n">clara_a3_end</span><span class="p">)</span>
        <span class="n">esa_envisat_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">esa_envisat_start</span><span class="p">,</span> <span class="n">esa_envisat_end</span><span class="p">)</span>
        <span class="n">sentinel_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">sentinel_start</span><span class="p">,</span> <span class="n">sentinel_end</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clara_a3_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span> <span class="ow">and</span> <span class="n">clara_a3_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span><span class="p">:</span>
            <span class="n">da_maps_p1</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_map_period</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">clara_a3_start</span><span class="p">,</span> <span class="n">clara_a3_end</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">skipna</span><span class="p">)</span>
            <span class="n">da_maps_p1</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da_maps_p1</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">),</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ceres_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span> <span class="ow">and</span> <span class="n">ceres_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span><span class="p">:</span>
            <span class="n">da_maps_p2</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_map_period</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ceres_start</span><span class="p">,</span> <span class="n">ceres_end</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">skipna</span><span class="p">)</span>
            <span class="n">da_maps_p2</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da_maps_p2</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">),</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">esa_envisat_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span> <span class="ow">and</span> <span class="n">esa_envisat_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span><span class="p">:</span>
            <span class="n">da_maps_p3</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_map_period</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">esa_envisat_start</span><span class="p">,</span> <span class="n">esa_envisat_end</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">skipna</span><span class="p">)</span> 
            <span class="n">da_maps_p3</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da_maps_p3</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">),</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sentinel_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span> <span class="ow">and</span> <span class="n">sentinel_time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">curr_time</span><span class="p">:</span>
            <span class="n">da_maps_p4</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_map_period</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">sentinel_start</span><span class="p">,</span> <span class="n">sentinel_end</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">skipna</span><span class="p">)</span> 
            <span class="n">da_maps_p4</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da_maps_p4</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">),</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>

    <span class="n">ds_maps_p1</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_maps_p1</span>
    <span class="n">ds_maps_p2</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_maps_p2</span>
    <span class="n">ds_maps_p3</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_maps_p3</span>
    <span class="n">ds_maps_p4</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_maps_p4</span>
    <span class="n">ds_maps</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_maps</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listmasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_maps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_maps</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">lw_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">listmasks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">l</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">listmasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;product&#39;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sw_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">listmasks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">l</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">listmasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;product&#39;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">lw_mask</span><span class="p">,</span> <span class="n">sw_mask</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;variable&#39;</span><span class="p">:</span><span class="n">variables</span><span class="p">[:</span><span class="mi">2</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_timeseries</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">variable</span><span class="p">,</span> <span class="n">request_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">request_dicts</span><span class="p">):</span>
    <span class="n">da_timeseries</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">request_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;HIRS&quot;</span> <span class="ow">and</span> <span class="n">variable</span> <span class="o">!=</span> <span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s2">&quot;CERES&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">product</span> <span class="ow">and</span> <span class="n">variable</span><span class="o">==</span><span class="s2">&quot;incoming_shortwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
        
        <span class="n">start</span> <span class="o">=</span> <span class="n">start_var</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">stop_var</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>

        <span class="n">ds</span> <span class="o">=</span> <span class="n">DS</span><span class="p">[</span><span class="n">variable</span><span class="p">][</span><span class="n">product</span><span class="p">]</span>
        
        <span class="n">varname</span><span class="o">=</span><span class="n">get_varname</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
        
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">product</span><span class="o">==</span><span class="s2">&quot;CERES&quot;</span><span class="p">:</span>
            <span class="n">regrid</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">da_obj</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">regrid</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">da_obj</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
        <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
        
        <span class="n">regrid_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;regrid&#39;</span><span class="p">:</span><span class="n">regrid</span><span class="p">,</span> <span class="s1">&#39;ds_obj&#39;</span><span class="p">:</span><span class="n">da_obj</span><span class="p">}</span>

        <span class="n">SkipNa</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;SKIP&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">product</span><span class="o">==</span><span class="s2">&quot;CERES_noMask&quot;</span><span class="p">:</span>
            <span class="n">Mask</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">variable</span><span class="o">==</span><span class="s1">&#39;incoming_shortwave&#39;</span><span class="p">:</span>
            <span class="n">Mask</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Mask</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mask&#39;</span><span class="p">:</span> <span class="n">mask</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variable</span><span class="o">=</span><span class="n">variable</span><span class="p">)}</span>
        
        <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">region_slices</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dall</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">regrid_dict</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SkipNa</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Mask</span><span class="p">)</span>
            <span class="n">da_ts</span> <span class="o">=</span> <span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;lon_slice&#39;</span><span class="p">],</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;lat_slice&#39;</span><span class="p">],</span> <span class="n">regrid</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;regrid&#39;</span><span class="p">],</span> <span class="n">ds_obj</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;ds_obj&#39;</span><span class="p">],</span> <span class="n">SKIP</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;SKIP&#39;</span><span class="p">],</span> <span class="n">mask</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">])</span>
            <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da_ts</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
        
        <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
        <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span> <span class="n">stop</span><span class="p">})</span>
        <span class="n">da_timeseries</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="n">ds_timeseries</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_timeseries</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_periods_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_maps_p1</span><span class="p">,</span> <span class="n">ds_maps_p2</span><span class="p">,</span> <span class="n">ds_maps_p3</span><span class="p">,</span> <span class="n">ds_maps_p4</span><span class="p">]</span>
<span class="n">periods</span> <span class="o">=</span> <span class="p">[</span><span class="n">clara_a3_time</span><span class="p">,</span> <span class="n">ceres_time</span><span class="p">,</span> <span class="n">esa_envisat_time</span><span class="p">,</span> <span class="n">sentinel_time</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-spatial-weighted-time-series">
<span id="satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-spatial-weighted-time-series"></span><h3>3. Plot spatial weighted time series<a class="headerlink" href="#plot-spatial-weighted-time-series" title="Link to this heading">#</a></h3>
<p>Below, we calculate and plot spatially weighted means for the different earth radiation budget products, in terms of montly climatologies, although the sampling period of each dataset is, in general, different from the others (i.e. CERES: 2001-2023, Sentinel 3A: 2017-2021, Sentinel 3B: 2019-2021, Sentinel 3A_3B: 2019-2021, ESA_Envisat: 2003-2011, CLARA_A3: 1979-2020, HIRS: 1979-2023, CERES_noMask: 2001-2023). Despite each dataset has a different length, we want here to inspect how the different products reproduce the seasonal cycle, both for the global mean, and for each hemisphere. Notice we also used the non-masked version of CERES (CERES_noMask), for two reasons: fist, we want to have an idea of what is the main effect of the masking (i.e. if it affects mainly the northern and southern hemisphere), and second to have the possibility of giving the best possible estimate of the Net Top of the Atmosphere Radiation (i.e. as much as possible close to a sort of Earth Energy Imbalance).</p>
<p>The pronounced seasonality in OLR is mostly linked with the larger land area in the Northern Hemisphere, while that one in OSR linked with the solar cycle.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lw_ts</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]})</span>
<span class="n">sw_ts</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_timeseries</span><span class="p">[</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]})</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">lw_ts</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1">#.resample(time=&#39;1M&#39;).mean()</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">t1</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c45dcbff5c8da2e54430b4c049a8cee243f349a3e91fcd83705ca998f195d601.png" src="../../_images/c45dcbff5c8da2e54430b4c049a8cee243f349a3e91fcd83705ca998f195d601.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2</span> <span class="o">=</span> <span class="n">sw_ts</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1">#.resample(time=&#39;1M&#39;).mean()</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">t2</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/2e4c47401c86c8661ca8a2c2808e19b182d5072f1163a6ee9c5293d90a81157e.png" src="../../_images/2e4c47401c86c8661ca8a2c2808e19b182d5072f1163a6ee9c5293d90a81157e.png" />
</div>
</div>
<p>The offsets are greater in OLR than in OSR, with the ESA product (ENVISAT) being positively biased compared to the other products.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_nohirs</span> <span class="o">=</span> <span class="n">sw_ts</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">values</span>
<span class="n">res_var</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fix_lon</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">&gt;</span><span class="mf">350.</span><span class="p">:</span>
        <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span>
        <span class="c1"># Step 2: Sort by the new longitude values to maintain increasing order</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds</span><span class="o">=</span><span class="n">ds</span>
    <span class="k">return</span> <span class="n">ds</span>
    
<span class="k">for</span> <span class="n">request_dict</span> <span class="ow">in</span> <span class="n">request_dicts</span><span class="p">:</span>
    <span class="n">prod</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">request</span> <span class="ow">in</span> <span class="n">request_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;HIRS&quot;</span> <span class="ow">and</span> <span class="n">variable</span> <span class="o">!=</span> <span class="s2">&quot;outgoing_longwave&quot;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>

        <span class="n">lw_ds</span> <span class="o">=</span> <span class="n">DS</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">][</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">sw_ds</span> <span class="o">=</span> <span class="n">DS</span><span class="p">[</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">][</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">sw_ds_in</span> <span class="o">=</span> <span class="n">DS</span><span class="p">[</span><span class="s1">&#39;incoming_shortwave&#39;</span><span class="p">][</span><span class="s1">&#39;CERES&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">sw_ds_in</span> <span class="o">=</span> <span class="n">fix_lon</span><span class="p">(</span><span class="n">sw_ds_in</span><span class="p">)</span>
        <span class="n">lw_ds</span> <span class="o">=</span> <span class="n">fix_lon</span><span class="p">(</span><span class="n">lw_ds</span><span class="p">)</span>
        <span class="n">sw_ds</span> <span class="o">=</span> <span class="n">fix_lon</span><span class="p">(</span><span class="n">sw_ds</span><span class="p">)</span>

        <span class="n">shortname_out</span> <span class="o">=</span> <span class="n">get_varname</span><span class="p">(</span><span class="n">sw_ds</span><span class="p">,</span> <span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">)</span>
        <span class="n">longname</span> <span class="o">=</span> <span class="n">get_varname</span><span class="p">(</span><span class="n">lw_ds</span><span class="p">,</span> <span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">)</span>
        <span class="n">shortname_in</span> <span class="o">=</span> <span class="n">get_varname</span><span class="p">(</span><span class="n">sw_ds_in</span><span class="p">,</span> <span class="s1">&#39;incoming_shortwave&#39;</span><span class="p">)</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sw_ds</span><span class="p">[</span><span class="n">shortname_out</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sw_ds_in</span><span class="p">[</span><span class="n">shortname_in</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">lw_ds</span><span class="p">[</span><span class="n">longname</span><span class="p">])</span>
        <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">region_slices</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">dall</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">regrid_dict</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">SkipNa</span><span class="p">)</span>
            <span class="n">dall</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">Mask</span><span class="p">)</span>
            <span class="n">da_sel</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;lon_slice&#39;</span><span class="p">],</span> <span class="n">latitude</span><span class="o">=</span><span class="n">dall</span><span class="p">[</span><span class="s1">&#39;lat_slice&#39;</span><span class="p">])</span>
            <span class="n">da_ts</span> <span class="o">=</span> <span class="n">da_sel</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">da_sel</span><span class="o">.</span><span class="n">latitude</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">])</span>
            <span class="c1">#da_ts = spatial_weighted_mean(da, lon_slice=dall[&#39;lon_slice&#39;], lat_slice=dall[&#39;lat_slice&#39;], regrid=dall[&#39;regrid&#39;], ds_obj=dall[&#39;ds_obj&#39;], SKIP=dall[&#39;SKIP&#39;], mask=dall[&#39;mask&#39;])</span>
            <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da_ts</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
        
        <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
        <span class="n">prod</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">da</span>
    <span class="n">res_var</span><span class="p">[</span><span class="s1">&#39;EEI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prod</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Most satellite datasets available from the Climate Data Store (CDS), such as those from the CLARA or HIRS record, are not gap-filled and do not always provide full global coverage. Therefore, they cannot be directly used to compute global EEI without additional assumptions, spatial extrapolation, or fusion with other datasets.
Here, CERES-EBAF is referenced as a benchmark for EEI estimation, but the datasets from the CDS are not used to compute EEI directly, since they do not currently support a comparable global radiative balance analysis. Still, it is possible to look at the Imbalance annual cycles for the Net Top Of the Atmosphere Radiation, which is shown below. Specifically, NTOAR is calculated for each of the datasets in this notebook as the difference between the net shortwave and net longwave component, but calculating the net shortwave using always the incoming component from CERES-EBAF. In the end, the mean across product is extracted, constituting a sort of Ensemble mean.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">res_var</span><span class="p">[</span><span class="s1">&#39;EEI&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_nohirs</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">p_nohirs</span><span class="p">})</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;product&#39;</span><span class="p">)</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NTOAR EnsMean&#39;</span><span class="p">)</span> <span class="c1">#.resample(time=&#39;1M&#39;).mean()</span>
<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Net</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Top Of the Atmosphere</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">r</span><span class="s2">&quot;Radiation = $\langle (sw_{\mathrm</span><span class="si">{out}</span><span class="s2">} - sw_{\mathrm</span><span class="si">{in}</span><span class="s2">}^{[\mathrm</span><span class="si">{CERES}</span><span class="s2">]}) - lw \rangle$&quot;</span>
        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[W m$^{-2}$]&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/108a2e1da8fd455a81a968f80a00f430d7fd80bea6cbccce8cbd57f70f47c136.png" src="../../_images/108a2e1da8fd455a81a968f80a00f430d7fd80bea6cbccce8cbd57f70f47c136.png" />
</div>
</div>
<p>Next, we show the Net Top Of the Atmosphere Radiation annual cycle for the whole available domain (with masking and regridding), and for the Northern and Southern Hemisphere. The EEI is the small difference between the sunlight the Earth absorbs and the thermal (longwave) plus reflected (shortwave) radiation it emits, and represents a fundamental ‚Äúengine‚Äù of climate change. Even a tiny positive imbalance (on the order of 0.5-1 W m-2, according to recent estimates <a class="reference external" href="https://doi.org/10.5194/essd-15-1675-2023" rel="noreferrer" target="_blank">[13]</a>) sustained year after year is what drives ocean heat uptake, ice melt, sea-level rise and ultimately the global temperature increase we observe.</p>
<p>The global average of Net Top Of the Atmosphere Radiation indicates a small seasonal cycle (about 15 W m-2 peak-to-peak) compared to hemispheric averages, with a slight maximum Net Top Of the Atmosphere Radiation in June-July. That means mid-year the Earth is absorbing just a bit more energy than at other times, largely because Northern Hemisphere land is warm, and snow-free.</p>
</section>
<section id="plot-time-weighted-means">
<span id="satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-time-weighted-means"></span><h3>4. Plot time weighted means<a class="headerlink" href="#plot-time-weighted-means" title="Link to this heading">#</a></h3>
<p>Below, we calculate and plot time-weighted means for the different radiation budget products. Please note that different periods were considered, in order to make fair comparison between products wich have a different temporal extent.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">listmasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_maps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_maps</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">lw_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">listmasks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">l</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">listmasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;product&#39;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sw_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">listmasks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">l</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">listmasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;product&#39;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">lw_mask</span><span class="p">,</span> <span class="n">sw_mask</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;variable&#39;</span><span class="p">:</span><span class="n">variables</span><span class="p">[:</span><span class="mi">2</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ds_maps</span><span class="p">,</span> <span class="n">times</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ds_periods_list</span><span class="p">,</span> <span class="n">periods</span><span class="p">):</span>
    <span class="n">p_to_show</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds_maps</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">==</span><span class="s1">&#39;CERES_noMask&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_to_show</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    
    <span class="n">p_to_show_whirs</span> <span class="o">=</span> <span class="n">p_to_show</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">p_to_show</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;HIRS&quot;</span><span class="p">)</span>
    <span class="n">lw_maps</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_maps</span><span class="p">[</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_to_show_whirs</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">p_to_show_whirs</span><span class="p">})</span>
    <span class="n">lw_maps_masked</span> <span class="o">=</span> <span class="n">lw_maps</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;outgoing_longwave&#39;</span><span class="p">)))</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">lw_maps_masked</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> 
                             <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                             <span class="n">levels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                             <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
                             <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;nipy_spectral&quot;</span><span class="p">,</span>
                             <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">p1</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>  <span class="c1"># loop through the map axes</span>
        <span class="n">subplotspec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">():</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s2">&quot;compressed&quot;</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;longwave [W m-2]&#39;</span><span class="p">)</span>
    <span class="n">p1</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean map on the period </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_to_show</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">sw_maps</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_maps</span><span class="p">[</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">][</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_to_show</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">p_to_show</span><span class="p">})</span>
        <span class="n">sw_maps_masked</span> <span class="o">=</span> <span class="n">sw_maps</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">)))</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">sw_maps_masked</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span>
                                 <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                 <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                                 <span class="n">levels</span><span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                                 <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
                                 <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gist_ncar&quot;</span><span class="p">,</span>
                                 <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">p2</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>  <span class="c1"># loop through the map axes</span>
            <span class="n">subplotspec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>
        <span class="n">p2</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s2">&quot;compressed&quot;</span><span class="p">)</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">p2</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
        <span class="n">p2</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;net shortwave [W m-2]&#39;</span><span class="p">)</span>
        <span class="n">p2</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean map on the period </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/86203b3bd99177ed51665c52c55e2ad6c3ef89183f5bda95096f5b21a4361416.png" src="../../_images/86203b3bd99177ed51665c52c55e2ad6c3ef89183f5bda95096f5b21a4361416.png" />
<img alt="../../_images/86ccdefe7ec7fd5f6c8fc63a98dcea73d679b441a847488e2df2102630d81856.png" src="../../_images/86ccdefe7ec7fd5f6c8fc63a98dcea73d679b441a847488e2df2102630d81856.png" />
<img alt="../../_images/816f6929dd7c152a6ffb3d1dfa8ec62ac882ae88747f7c3740cd59d22fab7977.png" src="../../_images/816f6929dd7c152a6ffb3d1dfa8ec62ac882ae88747f7c3740cd59d22fab7977.png" />
<img alt="../../_images/c51b22f7bfedd16593b1d1e3e81ff9e8a1188feacd8142d8a754d0de326caacb.png" src="../../_images/c51b22f7bfedd16593b1d1e3e81ff9e8a1188feacd8142d8a754d0de326caacb.png" />
<img alt="../../_images/d5cd77ed85d2eeef37367c8c16a4e3d32fb08c0934d9a708f458dc07751c447f.png" src="../../_images/d5cd77ed85d2eeef37367c8c16a4e3d32fb08c0934d9a708f458dc07751c447f.png" />
<img alt="../../_images/7e2d5918ac0f3f4866902e179d4e11e35c8eba7ebf9250fa9f92d14c9b3acb55.png" src="../../_images/7e2d5918ac0f3f4866902e179d4e11e35c8eba7ebf9250fa9f92d14c9b3acb55.png" />
<img alt="../../_images/b68234555db2a80be102ab89da5943f5bbca677be466be6da9ea5962eaae3f85.png" src="../../_images/b68234555db2a80be102ab89da5943f5bbca677be466be6da9ea5962eaae3f85.png" />
<img alt="../../_images/17a8627dfa82fbb7870dcf0491bbbe2e730305b373de44c666b92f61f8ac87f0.png" src="../../_images/17a8627dfa82fbb7870dcf0491bbbe2e730305b373de44c666b92f61f8ac87f0.png" />
</div>
</div>
<p>Time mean spatial maps show consistent spatial features across the products, although with large offsets and difference (e.g. near the Equator, at high latitudes). Differences are also due to varying spatial resolution, and different temporal and spatial sampling across the products.</p>
<p>All products show highest OLR over the subtropical deserts (e.g. Sahara, Arabian Peninsula, central Australia) and clear‚Äêskies over the eastern subtropical ocean gyres, and lowest OLR where deep convection occurs (ITCZ, tropical rainforests) and at high latitudes under clouds. All OLR products agree on the major ‚Äúwarm‚Äù desert maxima and ‚Äúcold‚Äù convective minima. Differences are very small (&lt;5 W m-2) in the well‚Äêsampled tropical belt; HIRS can show a bit more structure in the Intertropical Convergence Zone (likely due to higher spectral resolution), whereas the other products tend to smooth the strongest minima and maxima slightly.
Concerning the OSR, all products feature bright subtropical desert maxima (200‚Äì220 W m-2), low OSR (80‚Äì100 W m-2) in persistently cloudy regions (ITCZ, midlatitude storm tracks, equatorial Pacific), and moderate values (120‚Äì160 W m-2) over clear‚Äêsky oceans. The spatial patterns are remarkably consistent across the products, with differences generally of the order of less than 4 W m-2.</p>
</section>
<section id="plot-spatial-weighted-zonal-means">
<span id="satellite-satellite-earth-radiation-budget-climate-monitoring-q01-plot-spatial-weighted-zonal-means"></span><h3>5. Plot spatial weighted zonal means<a class="headerlink" href="#plot-spatial-weighted-zonal-means" title="Link to this heading">#</a></h3>
<p>The code below will calculate and plot weighted zonal means for the radiation budget products. For the sake of comparison, different periods are shown consistently with different temporal overlapping windows.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">ds_maps</span><span class="p">,</span> <span class="n">times</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ds_periods_list</span><span class="p">,</span> <span class="n">periods</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zonal Mean on the period </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">variable</span><span class="p">,</span> <span class="n">da_maps</span> <span class="ow">in</span> <span class="n">ds_maps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">variable</span><span class="o">==</span><span class="s1">&#39;incoming_shortwave&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span> <span class="k">if</span> <span class="n">variable</span><span class="o">==</span><span class="s1">&#39;outgoing_longwave&#39;</span> <span class="k">else</span> <span class="n">ax2</span>
        <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">da_maps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">product</span><span class="o">==</span><span class="s1">&#39;CERES_noMask&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">product</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">variable</span><span class="o">==</span><span class="s1">&#39;outgoing_shortwave&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2"> [W m-2]&quot;</span><span class="p">)</span>
    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/bd3c5ca0c907881186c7323ce5090ac6eadf0c02d736b04e55729720a41bd745.png" src="../../_images/bd3c5ca0c907881186c7323ce5090ac6eadf0c02d736b04e55729720a41bd745.png" />
<img alt="../../_images/3b06dccb37159c00fc6c766acda715557dff8c13a930cc6d88e9b8b090801fca.png" src="../../_images/3b06dccb37159c00fc6c766acda715557dff8c13a930cc6d88e9b8b090801fca.png" />
<img alt="../../_images/a1d82f3844fbddfc98dc78e2199d80175c55b4c39edd4a36009e61e823752c4c.png" src="../../_images/a1d82f3844fbddfc98dc78e2199d80175c55b4c39edd4a36009e61e823752c4c.png" />
<img alt="../../_images/d1b74051f06a86667413f5c38fac8e888856209274e8ea7caa115849cabcd452.png" src="../../_images/d1b74051f06a86667413f5c38fac8e888856209274e8ea7caa115849cabcd452.png" />
</div>
</div>
<p>Zonal averages indicate the good consistency among the products, except at thig latitudes (e.g., south of 50¬∞S and north of 50¬∞N). In particular, CERES and ESA ENVISAT show good agreement in the OLR, with CLARA_A3 and HIRS possibly deviating slightly, especially at higher latitudes. Also, OSR shows the largest discrepancies going poleward, which may arise from differences in cloud detection or albedo algorithms.</p>
<section id="discussion-and-applications">
<h4>Discussion and applications<a class="headerlink" href="#discussion-and-applications" title="Link to this heading">#</a></h4>
<p>The differences identified across the OLR and OSR datasets primarily reflect known characteristics of the satellite instruments and retrieval algorithms from which the various climate data records are constructed. For OLR, the spread between the CERES EBAF record and the HIRS and CLARA-A3 products is consistent with the long-recognized sensitivity of longwave flux retrievals to spectral sampling, cloud detection, and scene-dependent angular corrections (<a class="reference external" href="https://doi.org/10.1175/2008JCLI2637.1" rel="noreferrer" target="_blank">[1]</a>, <a class="reference external" href="https://doi.org/10.1007/s10712-012-9175-1" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1029/2012JD017997" rel="noreferrer" target="_blank">[5]</a>). CERES derives broadband fluxes using detailed angular-distribution models (ADMs) developed specifically for top-of-atmosphere applications
<a class="reference external" href="https://doi.org/10.1175/1520-0477%281996%29077%3C0853:CATERE%3E2.0.CO;2" rel="noreferrer" target="_blank">[3]</a>, which typically results in smaller biases in cloudy and high-latitude regions. In contrast, HIRS and the AVHRR-based CLARA-A3 rely on narrower channels and empirical regressions to estimate broadband longwave radiation, a known source of latitudinal and surface-type‚Äìdependent discrepancies documented in their validation reports (<a class="reference external" href="https://confluence.ecmwf.int/x/8lIiEg" rel="noreferrer" target="_blank">HIRS PVR</a>, <a class="reference external" href="https://confluence.ecmwf.int/x/UwOaFQ" rel="noreferrer" target="_blank">CLARA-A3 PVR</a>). These differences help explain the stronger gradients observed in the CLARA-A3 OLR fields and the slight warm-scene bias in HIRS over subtropical dry regions.</p>
<p>The Sentinel-3 SLSTR (3A, 3B, and the merged 3A+3B) interim CDRs show overall good consistency with the CERES reference but display enhanced variability in the tropics and over land surfaces. This behaviour is in line with their validation documentation, which highlights sensitivity to cloud screening and to the limited temporal extent of the interim SLSTR record relative to multi-decadal products (<a class="reference external" href="https://confluence.ecmwf.int/x/6FLlEw" rel="noreferrer" target="_blank">CERES Quality Summary</a>, <a class="reference external" href="https://confluence.ecmwf.int/x/ulIiEg" rel="noreferrer" target="_blank">Sentinel Quality Assurance Document</a>). The relatively short data period (2017‚Äì2021) also means that interannual variability associated with ENSO events‚Äîknown to modulate tropical OLR <a class="reference external" href="https://doi.org/10.1002/2017JD027002" rel="noreferrer" target="_blank">[7]</a>‚Äîcan disproportionately influence the mean differences when compared to long records such as CERES or HIRS.</p>
<p>For OSR, discrepancies among products similarly reflect differences in sensor spectral coverage, calibration stability in the visible and near-infrared, and the treatment of anisotropy in the shortwave domain. CERES shortwave fluxes benefit from scene-dependent ADMs and long-term calibration stability <a class="reference external" href="https://doi.org/10.1175/2008JCLI2637.1" rel="noreferrer" target="_blank">[1]</a>, <a class="reference external" href="https://doi.org/10.1007/s10712-012-9175-1" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1038/ngeo1375" rel="noreferrer" target="_blank">[9]</a>, which contributes to the coherent latitudinal reflection patterns typically used as a benchmark. The CLARA-A3 product, derived from AVHRR, shows slightly higher reflected shortwave radiation in bright subtropical and high-latitude regions, consistent with known limitations in AVHRR-based angular corrections and cloud-phase retrievals noted in its product validation reports. Similarly, OSR from ESA‚Äôs ENVISAT AATSR and from SLSTR shows small but systematic differences over marine stratocumulus regions‚Äîareas where shortwave anisotropy and cloud optical properties strongly influence flux retrievals. These patterns are consistent with prior evaluations of shortwave absorption and model‚Äìobservation differences <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0212.1" rel="noreferrer" target="_blank">[11]</a>, <a class="reference external" href="https://doi.org/10.1080/17538947.2023.2198262" rel="noreferrer" target="_blank">[12]</a>.</p>
<p>Overall, the magnitude and spatial structure of the inter-product differences observed here align with previously documented behaviour of broadband radiation datasets and with theoretical expectations derived from radiative-transfer and climate-feedback studies <a class="reference external" href="https://doi.org/10.1073/pnas.1412190111" rel="noreferrer" target="_blank">[6]</a>, <a class="reference external" href="https://doi.org/10.1175/JCLI3799.1" rel="noreferrer" target="_blank">[8]</a>, <a class="reference external" href="https://doi.org/10.1038/nclimate2876" rel="noreferrer" target="_blank">[10]</a>, <a class="reference external" href="https://doi.org/10.5194/essd-15-1675-2023" rel="noreferrer" target="_blank">[13]</a>. The consistency of many features across independent retrievals‚Äîparticularly the subtropical shortwave reflection maxima and the tropical longwave minima‚Äîsupports the robustness of these products for climatological analyses, while the remaining discrepancies can be traced to well-understood algorithmic and instrumental differences identified in the respective validation reports.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1175/2008JCLI2637.1" rel="noreferrer" target="_blank">[1]</a> Loeb, N. G., Wielicki, B. A., Doelling, D. R., Smith, G. L., Keyes, D. F., Kato, S., ‚Ä¶ &amp; Wong, T. (2009). Toward optimal closure of the Earth‚Äôs top-of-atmosphere radiation budget. Journal of Climate, 22(3), 748-766</p>
<p><a class="reference external" href="https://doi.org/10.1038/35066553" rel="noreferrer" target="_blank">[2]</a> Harries, J. E., Brindley, H. E., Sagoo, P. J., &amp; Bantges, R. J. (2001). Increases in greenhouse forcing inferred from the outgoing longwave radiation spectra of the Earth in 1970 and 1997. Nature, 410(6826), 355-357.</p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0477%281996%29077%3C0853:CATERE%3E2.0.CO;2" rel="noreferrer" target="_blank">[3]</a> Wielicki, B. A., Barkstrom, B. R., Harrison, E. F., Lee III, R. B., Smith, G. L., &amp; Cooper, J. E. (1996). Clouds and the Earth‚Äôs Radiant Energy System (CERES): An Earth observing system experiment. Bulletin of the American Meteorological Society, 77(5), 853-868.</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10712-012-9175-1" rel="noreferrer" target="_blank">[4]</a> Loeb, N. G., Wielicki, B. A., Su, W., Loukachine, K., Sun, W., Wong, T., ‚Ä¶ &amp; Lin, B. (2012). Advances in understanding top-of-atmosphere radiation variability from satellite observations. Surveys in Geophysics, 33(3-4), 359-385</p>
<p><a class="reference external" href="https://doi.org/10.1029/2012JD017997" rel="noreferrer" target="_blank">[5]</a> Susskind, J., G. Molnar, L. Iredell, et al., 2012: Interannual variability of outgoing longwave radiation as observed by AIRS and CERES. J. Geophys. Res. Atmos., 117, D23107, doi: 10.1029/2012JD017997.</p>
<p><a class="reference external" href="https://doi.org/10.1073/pnas.1412190111" rel="noreferrer" target="_blank">[6]</a> Donohoe, A., Armour, K. C., Pendergrass, A. G., &amp; Battisti, D. S. (2014). Shortwave and longwave radiative contributions to global warming under increasing CO2. Proceedings of the National Academy of Sciences, 111(47), 16700-16705. <a class="reference external" href="https://doi.org/10.1073/pnas.1412190111" rel="noreferrer" target="_blank">https://doi.org/10.1073/pnas.1412190111</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/2017JD027002" rel="noreferrer" target="_blank">[7]</a> Su, W., N. G. Loeb, L. Liang, N. Liu, and C. Liu (2017), The El Ni√±o‚ÄìSouthern Oscillation effect on tropical outgoing longwave radiation: A daytime versus nighttime perspective, J. Geophys. Res. Atmos., 122, 7820‚Äì7833, <a class="reference external" href="https://doi.org/10.1002/2017JD027002" rel="noreferrer" target="_blank">https://doi.org/10.1002/2017JD027002</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI3799.1" rel="noreferrer" target="_blank">[8]</a> Soden, B. J., and I. M. Held, 2006: An Assessment of Climate Feedbacks in Coupled Ocean‚ÄìAtmosphere Models. J. Climate, 19, 3354‚Äì3360, <a class="reference external" href="https://doi.org/10.1175/JCLI3799.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JCLI3799.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1038/ngeo1375" rel="noreferrer" target="_blank">[9]</a> Loeb, N. G., J. M. Lyman, G. C. Johnson, R. P. Allan, D. R. Doelling, T. Wong, B. J. Soden, and G. L. Stephens, 2012: Observed changes in top-of-the-atmosphere radiation and upper-ocean heating consistent within uncertainty. Nat. Geosci., 5, 110‚Äì113, <a class="reference external" href="https://doi.org/10.1038/ngeo1375" rel="noreferrer" target="_blank">https://doi.org/10.1038/ngeo1375</a></p>
<p><a class="reference external" href="https://doi.org/10.1038/nclimate2876" rel="noreferrer" target="_blank">[10]</a> von Schuckmann, K., and Coauthors, 2016: An imperative to monitor Earth‚Äôs energy balance. Nat. Climate Change, 6, 138‚Äì144, <a class="reference external" href="https://doi.org/10.1038/nclimate2876" rel="noreferrer" target="_blank">https://doi.org/10.1038/nclimate2876</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0212.1" rel="noreferrer" target="_blank">[11]</a> Schwarz, M., D. Folini, S. Yang, and M. Wild, 2019: The Annual Cycle of Fractional Atmospheric Shortwave Absorption in Observations and Models: Spatial Structure, Magnitude, and Timing. J. Climate, 32, 6729‚Äì6748, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0212.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JCLI-D-19-0212.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1080/17538947.2023.2198262" rel="noreferrer" target="_blank">[12]</a> Yang, S., Zhang, X., Guan, S., Zhao, W., Duan, Y., Yao, Y., ‚Ä¶ Jiang, B. (2023). A review and comparison of surface incident shortwave radiation from multiple data sources: satellite retrievals, reanalysis data and GCM simulations. International Journal of Digital Earth, 16(1), 1332‚Äì1357. <a class="reference external" href="https://doi.org/10.1080/17538947.2023.2198262" rel="noreferrer" target="_blank">https://doi.org/10.1080/17538947.2023.2198262</a></p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-15-1675-2023" rel="noreferrer" target="_blank">[13]</a> von Schuckmann, K. and Coauthors, 2023: Heat stored in the Earth system 1960‚Äì2020: where does the energy go? Earth System Science Data, 15(4), 1675-1709, <a class="reference external" href="https://doi.org/10.5194/essd-15-1675-2023" rel="noreferrer" target="_blank">https://doi.org/10.5194/essd-15-1675-2023</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmosphere_Physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmosphere_Physics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.1. </span>Atmosphere Physics</p>
      </div>
    </a>
    <a class="right-next"
       href="../Atmospheric_Composition/Atmospheric_Composition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-consistency-assessment-of-earth-radiation-budget-products">üåç Use case: Consistency assessment of Earth Radiation Budget products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-code">1. Choose the data to use and setup code</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">2. Download and transform</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-weighted-time-series">3. Plot spatial weighted time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-weighted-means">4. Plot time weighted means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-weighted-zonal-means">5. Plot spatial weighted zonal means</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion-and-applications">Discussion and applications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>