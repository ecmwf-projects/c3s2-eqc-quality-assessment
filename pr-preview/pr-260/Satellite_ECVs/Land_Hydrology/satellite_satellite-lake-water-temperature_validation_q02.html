
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.5.1. Satellite-Derived Data Insights into Long-Term Lake Temperature Trends &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-temperature_validation_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. Ocean" href="../Ocean/Ocean.html" />
    <link rel="prev" title="1.5. Land Hydrology" href="Land_Hydrology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Hydrology.html">1.5. Land Hydrology</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.5.1. Satellite-Derived Data Insights into Long-Term Lake Temperature Trends</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-temperature_validation_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-temperature_validation_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite-Derived Data Insights into Long-Term Lake Temperature Trends</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-analyzing-the-long-term-trend-in-surface-water-temperature-of-lake-superior">🌍 Use case: Analyzing the long-term trend in surface water temperature of Lake Superior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-variables">Set variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">2. Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-lakeid">Plot lakeid</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-filtering">Data filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-weighted-mean">Spatial weighted mean</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summer-mean-analisys">3. Summer mean analisys</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summer-mean-and-standard-deviation">Summer mean and standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-linear-regression-for-the-full-set-1995-2023">Perform linear regression for the full set (1995-2023)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-results">Plot results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-to-noaa-great-lakes-coastwatch-data">4. Comparison to NOAA Great Lakes CoastWatch data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-noaa-dataset">Load the NOAA dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-both-datasets-over-time">Plot both datasets over time</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-calculation">Metrics calculation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-plot">Residual Plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-mean-summer-lswt-for-outlier-value">Map of mean summer LSWT for outlier value</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-derived-data-insights-into-long-term-lake-temperature-trends">
<h1><span class="section-number">1.5.1. </span>Satellite-Derived Data Insights into Long-Term Lake Temperature Trends<a class="headerlink" href="#satellite-derived-data-insights-into-long-term-lake-temperature-trends" title="Link to this heading">#</a></h1>
<p>Production date: 29-04-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-analyzing-the-long-term-trend-in-surface-water-temperature-of-lake-superior">
<h2>🌍 Use case: Analyzing the long-term trend in surface water temperature of Lake Superior<a class="headerlink" href="#use-case-analyzing-the-long-term-trend-in-surface-water-temperature-of-lake-superior" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>❓ Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can satellite data be used to detect the observed increase in summer water temperatures in Lake Superior due to global warming?</strong></p></li>
</ul>
<p>Cases of an increasing trend in lake surface water temperature (LSWT) have been observed in numerous lakes across various regions, including the United States, Europe, and other parts of the world <a class="reference external" href="https://doi.org/10.1038/s41558-024-02122-y">[1]</a> <a class="reference external" href="https://climate.copernicus.eu/lake-surface-temperatures">[2]</a>. For example, Austin and Colman (2008) found that summer LSWT in Lake Superior increased at a rate of (11±6)×10<sup>-2</sup> °C/year from 1979 to 2006. They attributed this trend to the earlier retreat of winter ice, which causes the positive overturning period to begin sooner, allowing the lake more time to warm. Their analysis was based on measurements from in-situ buoys <a class="reference external" href="https://doi.org/10.1029/2006GL029021">[3]</a>. Later, the Great Lakes Integrated Sciences and Assessments (GLISA) analyzed the annual mean LSWT of Lake Superior between 1995 and 2021. The increasing long-term trend observed by Austin and Colman was not apparent in the period analyzed by GLISA. However, they noted a shift to higher temperatures after 1998 [4]. The LSWT data analyzed by GLISA was derived from satellite observations and obtained through the NOAA Great Lakes CoastWatch <a class="reference external" href="https://coastwatch.glerl.noaa.gov/statistics/average-surface-water-temperature-glsea/">[5]</a>.</p>
<p>The objective of this study is to evaluate whether the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lake-water-temperature?tab=overview">satellite-lake-water-temperature</a> dataset from the Climate Data Store (CDS) is suitable for climate change monitoring, using Lake Superior as a case study. We calculated the trend summer LWST for a period of 28 years, from 1995 to 2023.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Lake Superior’s summer LSWT trend from 1995 to 2023 shows a slightly negative slope, though this trend is not statistically significant. The mean summer temperature during this period was 14.1 °C.</p></li>
<li><p>The <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lake-water-temperature?tab=overview">satellite-lake-water-temperature</a> dataset and NOAA’s satellite-derived LSWT data are very similar overall. However, during colder years, NOAA’s LSWT values tend to be lower, possibly due to cloud contamination.</p></li>
<li><p>This dataset is valuable for climate change monitoring. However, complementing it with in situ data from years prior to 1995, if available, could provide a more comprehensive understanding of long-term trends.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-temperature-validation-q02-section-1"><span class="std std-ref">1. Request and download data</span></a></strong></p>
<ul class="simple">
<li><p>Download satellite water temperature data for the summer months (July, August, September) from 1995 to 2023.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-temperature-validation-q02-section-2"><span class="std std-ref">2. Data preprocessing</span></a></strong></p>
<ul class="simple">
<li><p>Filter the data by quality level and lake ID.</p></li>
<li><p>Calculate the spatial weighted mean of LSWT.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-temperature-validation-q02-section-3"><span class="std std-ref">3. Summer mean analisys</span></a></strong></p>
<ul class="simple">
<li><p>Calculate the yearly summer mean of LSWT.</p></li>
<li><p>Perform linear regression.</p></li>
<li><p>Plot the results.</p></li>
<li><p>Discuss results.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-temperature-validation-q02-section-4"><span class="std std-ref">4. Comparison to NOAA Great Lakes CoastWatch data</span></a></strong></p>
<ul class="simple">
<li><p>Load the NOAA dataset.</p></li>
<li><p>Plot both datasets over time.</p></li>
<li><p>Calculate Mean Bias, Mean Absolute Error (MAE), Root Mean Square Error (RMSE).</p></li>
<li><p>Plot Residuals (CDS-NOAA) and plot a map of outlier value.</p></li>
<li><p>Discuss results.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="request-and-download-data">
<span id="satellite-satellite-lake-water-temperature-validation-q02-section-1"></span><h3>1. Request and download data<a class="headerlink" href="#request-and-download-data" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cbook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpatches</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-variables">
<h4>Set variables<a class="headerlink" href="#set-variables" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1995</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2023</span>

<span class="c1"># Region</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">92.10</span><span class="p">,</span> <span class="o">-</span><span class="mf">84.80</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">46.30</span><span class="p">,</span> <span class="mf">49.00</span><span class="p">)</span>

<span class="c1"># Variable</span>
<span class="n">varname</span> <span class="o">=</span> <span class="s2">&quot;lake_surface_water_temperature&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-the-data-request">
<h4>Set the data request<a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-lake-water-temperature&quot;</span>
<span class="n">requests</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)],</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">],</span>
            <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;4_5&quot;</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2021</span> <span class="k">else</span> <span class="s2">&quot;4_5_2&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data">
<h4>Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">},</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 29/29 [00:16&lt;00:00,  1.71it/s]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-preprocessing">
<span id="satellite-satellite-lake-water-temperature-validation-q02-section-2"></span><h3>2. Data preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">#</a></h3>
<section id="plot-lakeid">
<h4>Plot lakeid<a class="headerlink" href="#plot-lakeid" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lakeid_data</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lakeid_CCI&#39;</span><span class="p">]</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span>
<span class="n">lons</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span>

<span class="c1"># Replace this with your actual unique IDs</span>
<span class="n">unique_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">lakeid_data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lakeid_data</span><span class="o">.</span><span class="n">values</span><span class="p">)])</span>  <span class="c1"># Exclude NaN values</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_ids</span><span class="p">))</span>  <span class="c1"># Use a discrete colormap</span>

<span class="c1"># Plot the map</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lakeid_data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Create a custom legend</span>
<span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_ids</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">uid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_ids</span><span class="p">)</span>
<span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>  <span class="c1"># Position the legend</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Lake ID CCI&#39;</span><span class="p">,</span>
    <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ID Identification for Lake Superior and Outliers&#39;</span><span class="p">)</span>
<span class="c1"># Save the plot as a file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/lakeID_lswt.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/a03b2778a69d4df40401ede1257f3fb5d528b2554d1d6dd4e26bd4283a74e4ed.png" src="../../_images/a03b2778a69d4df40401ede1257f3fb5d528b2554d1d6dd4e26bd4283a74e4ed.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-ids" style="width: 80%">
<img alt="../../_images/d7197153-082e-41a7-a8fc-0fdcfaa1c66f.png" src="../../_images/d7197153-082e-41a7-a8fc-0fdcfaa1c66f.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.1 </span><span class="caption-text">ID Identification for Lake Superior and Outliers.</span><a class="headerlink" href="#fig-ids" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="data-filtering">
<h4>Data filtering<a class="headerlink" href="#data-filtering" title="Link to this heading">#</a></h4>
<p>It can be observed that the lake ID of Lake Superior is 2, which is the lowest value when printing the values, and it is plotted in purple.
Regarding the quality level. We will only use these levels:</p>
<ul class="simple">
<li><p>4: good quality</p></li>
<li><p>5: best quality</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reindex using lakeids and min_quality_level</span>
<span class="n">lakeid</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lakeid_CCI&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;lakeid_CCI&quot;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;lakeid_CCI&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">min_quality_level</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;min_quality_level&quot;</span><span class="p">))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;lakeid_CCI&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lakeid_CCI&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lakeid</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;lswt_quality_level&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_quality_level</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">lakeid_CCI</span><span class="o">=</span><span class="n">lakeid</span><span class="p">,</span> <span class="n">min_quality_level</span><span class="o">=</span><span class="n">min_quality_level</span><span class="p">)</span>

<span class="n">filtered_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lakeid_CCI</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_quality_level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="spatial-weighted-mean">
<h4>Spatial weighted mean<a class="headerlink" href="#spatial-weighted-mean" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spatial weighted mean</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">filtered_ds</span><span class="p">[</span><span class="n">varname</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="summer-mean-analisys">
<span id="satellite-satellite-lake-water-temperature-validation-q02-section-3"></span><h3>3. Summer mean analisys<a class="headerlink" href="#summer-mean-analisys" title="Link to this heading">#</a></h3>
<section id="summer-mean-and-standard-deviation">
<h4>Summer mean and standard deviation<a class="headerlink" href="#summer-mean-and-standard-deviation" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Convert to °C</span>
<span class="n">daC</span> <span class="o">=</span> <span class="n">da</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1">#We convert to °C for comparison with Austin &amp; Colman (2007)</span>
<span class="c1">#Calculate the mean</span>
<span class="n">summer_yearly_mean</span> <span class="o">=</span> <span class="n">daC</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="c1">#Calculate the standard deviation</span>
<span class="n">summer_yearly_std_dev</span> <span class="o">=</span> <span class="n">daC</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="perform-linear-regression-for-the-full-set-1995-2023">
<h4>Perform linear regression for the full set (1995-2023)<a class="headerlink" href="#perform-linear-regression-for-the-full-set-1995-2023" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the years for the full dataset and subset</span>
<span class="n">years_full</span> <span class="o">=</span> <span class="n">summer_yearly_mean</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Perform linear regression on the full dataset</span>
<span class="n">slope_full</span><span class="p">,</span> <span class="n">intercept_full</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">years_full</span><span class="p">,</span> <span class="n">summer_yearly_mean</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">trend_full</span> <span class="o">=</span> <span class="n">slope_full</span> <span class="o">*</span> <span class="n">years_full</span> <span class="o">+</span> <span class="n">intercept_full</span>

<span class="c1"># Print the linear regression equation in a readable format</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The equation of the trend line is: </span><span class="se">\n</span><span class="s2">y = </span><span class="si">{</span><span class="n">slope_full</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> °C/year * x + </span><span class="si">{</span><span class="n">intercept_full</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> °C&quot;</span><span class="p">)</span>
<span class="c1"># Printing the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Slope of the trend line:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">slope_full</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&quot;°C/year&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Intercept of the trend line:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">intercept_full</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&quot;°C&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation coefficient (R value):&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;P-value of the regression:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Standard error of the slope:&quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">std_err</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&quot;°C/year&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The equation of the trend line is: 
y = -0.0133 °C/year * x + 40.7965 °C

Slope of the trend line: -0.0133 °C/year
Intercept of the trend line: 40.7965 °C
Correlation coefficient (R value): -0.0887
P-value of the regression: 0.6472
Standard error of the slope: 0.0287 °C/year
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-results">
<h4>Plot results<a class="headerlink" href="#plot-results" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot both the original data and the trend lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">170</span><span class="p">)</span>

<span class="c1">#Plot yearly mean</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_full</span><span class="p">,</span> <span class="n">summer_yearly_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Summer (Jul-Aug-Sep) Mean&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Plot the trend lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_full</span><span class="p">,</span> <span class="n">trend_full</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Trend&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>  <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.7</span><span class="p">)</span>
<span class="n">mean_all</span><span class="o">=</span><span class="n">summer_yearly_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">mean_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LSWT (°C)&quot;</span><span class="p">)</span>  <span class="c1"># Adjust units if necessary</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Trend of Mean Summer LSWT in Lake Superior&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Save the plot as a file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/trend_lswt.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/4c28bcf1f436c05a15282f9ce21a7eb120af71212a988204c5956d8ab9b038c4.png" src="../../_images/4c28bcf1f436c05a15282f9ce21a7eb120af71212a988204c5956d8ab9b038c4.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-trend" style="width: 100%">
<img alt="../../_images/f6752a95-e0ee-4c9f-8f92-7cc92126ba79.png" src="../../_images/f6752a95-e0ee-4c9f-8f92-7cc92126ba79.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.2 </span><span class="caption-text">Mean Summer LSWT and Trend for the period 1995 - 2023 using the CDS dataset.</span><a class="headerlink" href="#fig-trend" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p>The trend line in <a class="reference internal" href="#fig-trend"><span class="std std-ref">Mean Summer LSWT and Trend for the period 1995 - 2023 using the CDS dataset.</span></a> has a negative slope of -0.0133 °C/yr. However, the standard error of the slope is 0.0287 °C/year, which is relatively large compared to the slope itself, indicating low confidence in this trend. Additionally, the p-value of 0.6472 is substantially higher than the commonly used significance threshold of 0.05. This high p-value suggests that the trend is not statistically significant. The absence of significance could be partly due to the relatively short period of 28 years analyzed in this study, as longer time series are often needed to detect meaningful climate trends in such large water bodies.</p>
<p>The findings from Austin and Colman (2008) <a class="reference external" href="https://doi.org/10.1029/2006GL029021">[3]</a> provide additional context to the LSWT trends in Lake Superior. Their analysis, which included in situ buoy measurements, showed an increasing trend in lake surface temperature during the 1980s and 1990s. This warming period may have led to elevated temperature levels that persisted in the following decades. Although the current analysis from 1995 to 2023 does not reveal a statistically significant trend, Austin and Colman’s findings suggest that earlier warming could have established a higher baseline, potentially masking any recent, subtle changes in LSWT.</p>
</section>
</section>
<section id="comparison-to-noaa-great-lakes-coastwatch-data">
<span id="satellite-satellite-lake-water-temperature-validation-q02-section-4"></span><h3>4. Comparison to NOAA Great Lakes CoastWatch data<a class="headerlink" href="#comparison-to-noaa-great-lakes-coastwatch-data" title="Link to this heading">#</a></h3>
<section id="load-the-noaa-dataset">
<h4>Load the NOAA dataset<a class="headerlink" href="#load-the-noaa-dataset" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#NOAA data</span>
<span class="n">df_noaa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/lake_superior.csv&quot;</span><span class="p">)</span> 

<span class="c1"># Filter the dataframe to only keep rows where the month is July, August, or September</span>
<span class="n">summer_df</span> <span class="o">=</span> <span class="n">df_noaa</span><span class="p">[</span><span class="n">df_noaa</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])]</span>

<span class="c1"># Group by year and calculate the mean of the &#39;Sup.&#39; column for each year</span>
<span class="n">summer_mean</span> <span class="o">=</span> <span class="n">summer_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)[</span><span class="s1">&#39;Sup.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Rename the columns for clarity (optional)</span>
<span class="n">summer_mean</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Summer_Mean_Sup&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The CSV file contains the mean daily temperature for every day from 1995 to 2023. This data was obtained from the NOAA Great Lakes CoastWatch webpage <a class="reference external" href="https://coastwatch.glerl.noaa.gov/statistics/average-surface-water-temperature-glsea/">[5]</a> under the section “Average GLSEA Surface Water Temperature Data (by year)”.</p>
<p>The NOAA CoastWatch Great Lakes Regional Node dataset provides lake surface water temperature (LSWT) data derived from multiple sources, including the NOAA Advanced Very High Resolution Radiometer (AVHRR), the Visible Infrared Imaging Radiometer Suite on the Suomi National Polar-Orbiting Partnership spacecraft (VIIRS S-NPP), and the VIIRS instrument on NOAA-20 <a class="reference external" href="https://coastwatch.glerl.noaa.gov/satellite-data-products/lake-surface-temperature/?lk=g&amp;amp;yr=2021">[6]</a>.</p>
</section>
<section id="plot-both-datasets-over-time">
<h4>Plot both datasets over time<a class="headerlink" href="#plot-both-datasets-over-time" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot both the original data and the trend lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">170</span><span class="p">)</span>

<span class="c1">#Plot summer mean CDS</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_full</span><span class="p">,</span> <span class="n">summer_yearly_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CDS&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1">#Plot summer mean NOAA</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years_full</span><span class="p">,</span> <span class="n">summer_mean</span><span class="p">[</span><span class="s1">&#39;Summer_Mean_Sup&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NOAA&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># Add labels, title, and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LSWT (°C)&quot;</span><span class="p">)</span>  <span class="c1"># Adjust units if necessary</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison of Mean Summer LSWT from different datasets&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Save the plot as a file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/fig_NOAA.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/ac1160faccaabc14bf9c592f4790ae7ba7dc290eee4229eb52e4611acfee4766.png" src="../../_images/ac1160faccaabc14bf9c592f4790ae7ba7dc290eee4229eb52e4611acfee4766.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-cds-noaa-vs-time" style="width: 100%">
<img alt="../../_images/39459e06-5043-4a5e-980e-656a549de12b.png" src="../../_images/39459e06-5043-4a5e-980e-656a549de12b.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.3 </span><span class="caption-text">Comparison of mean Summer LSWT and Trend for the period 1995 - 2023 using two different datasets, CDS and NOAA.</span><a class="headerlink" href="#fig-cds-noaa-vs-time" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="metrics-calculation">
<h4>Metrics calculation<a class="headerlink" href="#metrics-calculation" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cds_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">summer_yearly_mean</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">noaa_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">summer_mean</span><span class="p">[</span><span class="s1">&#39;Summer_Mean_Sup&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">1995</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">cds_data</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Calculate residuals and other metrics</span>
<span class="n">mean_temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">cds_data</span> <span class="o">+</span> <span class="n">noaa_data</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">cds_data</span> <span class="o">-</span> <span class="n">noaa_data</span>
<span class="n">absolute_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">mean_bias</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_diff</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Summary statistics</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mean Bias&quot;</span><span class="p">,</span> <span class="s2">&quot;Mean Absolute Error (MAE)&quot;</span><span class="p">,</span> <span class="s2">&quot;Root Mean Square Error (RMSE)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Value (°C)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">mean_bias</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">summary</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Metric</th>
      <th>Value (°C)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mean Bias</td>
      <td>-0.017580</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mean Absolute Error (MAE)</td>
      <td>0.674757</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Root Mean Square Error (RMSE)</td>
      <td>0.885780</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="residual-plot">
<h4>Residual Plot<a class="headerlink" href="#residual-plot" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Residual plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mean_temp</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zero Residual Line&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Mean of CDS and NOAA LSWT (°C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals (CDS - NOAA) (°C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Plot: CDS vs NOAA LSWT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/residual_plot.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/47d173e886d384a53ffbe9be6cd2f4b77b570d766424dfeda4d73ec97d0e33b1.png" src="../../_images/47d173e886d384a53ffbe9be6cd2f4b77b570d766424dfeda4d73ec97d0e33b1.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-residuals" style="width: 100%">
<img alt="../../_images/00628707-395e-485b-b851-a75162154d53.png" src="../../_images/00628707-395e-485b-b851-a75162154d53.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.4 </span><span class="caption-text">Residual plot of CDS - NOAA LWST.</span><a class="headerlink" href="#fig-residuals" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="map-of-mean-summer-lswt-for-outlier-value">
<h4>Map of mean summer LSWT for outlier value<a class="headerlink" href="#map-of-mean-summer-lswt-for-outlier-value" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Convert to °C</span>
<span class="n">dsC</span> <span class="o">=</span> <span class="n">filtered_ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.15</span> <span class="c1">#We convert to °C for comparison with Austin &amp; Colman (2007)</span>
<span class="c1">#Calculate the mean</span>
<span class="n">dsy</span> <span class="o">=</span> <span class="n">dsC</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dsy96</span> <span class="o">=</span> <span class="n">dsy</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">1996</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a figure and a map projection</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the data</span>
<span class="n">data_plot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
    <span class="n">dsy96</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">],</span> 
    <span class="n">dsy96</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> 
    <span class="n">dsy96</span><span class="p">,</span> 
    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> 
    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span>  <span class="c1"># Adjust colormap as needed</span>
<span class="p">)</span>

<span class="c1"># Add a color bar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">data_plot</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LSWT (°C)&#39;</span><span class="p">)</span>

<span class="c1"># Add title and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mean summer LSWT - 1996&quot;</span><span class="p">)</span>
<span class="c1"># Save the plot as a file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeSurfaceTemperature/latest_submission/lswt96.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/683d8c5023b256dfca53dd815da837ca8ee75ca6f51229bc72ca243fe61c6007.png" src="../../_images/683d8c5023b256dfca53dd815da837ca8ee75ca6f51229bc72ca243fe61c6007.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-lswt96" style="width: 80%">
<img alt="../../_images/551a0382-01d5-4966-a95f-caca7f7ea551.png" src="../../_images/551a0382-01d5-4966-a95f-caca7f7ea551.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.5 </span><span class="caption-text">Mean summer LWST of Lake Superior for the year 1996 .</span><a class="headerlink" href="#fig-lswt96" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="id1">
<h4>Discussion<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>The CDS and NOAA values plotted in <a class="reference internal" href="#fig-cds-noaa-vs-time"><span class="std std-numref">Fig. 1.5.1.3</span></a>, along with the calculated comparison metrics, show that the mean summer LSWT values are mostly similar between the two datasets, with notable exceptions during colder years. The residuals plot in <a class="reference internal" href="#fig-residuals"><span class="std std-numref">Fig. 1.5.1.4</span></a> reveals that the largest differences occur at the two lowest temperatures. From <a class="reference internal" href="#fig-cds-noaa-vs-time"><span class="std std-numref">Fig. 1.5.1.3</span></a>, we observe that the greatest discrepancy occurred in 1997, where the NOAA dataset recorded a significantly lower temperature compared to the CDS dataset.</p>
<p>One possible explanation for this discrepancy is that the NOAA dataset may not filter out cloud contamination as effectively as the CDS dataset. This could result in artificially lower temperatures, as the NOAA data may be influenced by the temperature of cloud tops instead of the water surface.</p>
<p>To address whether the filtering applied in the CDS data introduced empty cells, we plotted a map of the summer mean LSWT for 1996 in <a class="reference internal" href="#fig-lswt96"><span class="std std-numref">Fig. 1.5.1.5</span></a>. The map revealed that only a few pixels were missing, indicating that the lake is largely complete with minimal data gaps.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Farina, G., Thiem, H. (2024) <a class="reference external" href="https://www.climate.gov/news-features/event-tracker/several-great-lakes-experience-record-warm-water-temperatures-heading#">Several Great Lakes experience record-warm water temperatures heading into winter</a>. <a class="reference external" href="http://Climate.gov">Climate.gov</a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Dataset documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=348800177">LSWT v4.5: Product User Guide and Specification (PUGS)</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>List the references used in the Notebook here.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1038/s41558-024-02122-y">[1]</a> Wang, X., Shi, K., Qin, B. et al. (2024). Disproportionate impact of atmospheric heat events on lake surface water temperature increases. Nat. Clim. Chang.</p></li>
<li><p><a class="reference external" href="https://climate.copernicus.eu/lake-surface-temperatures">[2]</a> Copernicus (2018). Lake surface temperatures. Climate Change Service.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1029/2006GL029021">[3]</a> Jay A. Austin, Steven M. Colman (2007). Lake Superior summer water temperatures are increasing more rapidly than regional air temperatures: A positive ice-albedo feedback. Geophysical Research LettersVolume 34, Issue 6.</p></li>
<li><p><a class="reference external" href="https://glisa.umich.edu/lake-superior-retrospective/">[4]</a> GLISA (2024). Lake Superior Retrospective.</p></li>
<li><p><a class="reference external" href="https://coastwatch.glerl.noaa.gov/statistics/average-surface-water-temperature-glsea/">[5]</a> NOAA CoastWatch Great Lakes Regional Node (2024). Average Surface Water Temperature (GLSEA).</p></li>
<li><p><a class="reference external" href="https://coastwatch.glerl.noaa.gov/satellite-data-products/lake-surface-temperature/?lk=g&amp;amp;yr=2021">[6]</a> NOAA CoastWatch Great Lakes Regional Node (2024). Lake Surface Temperature.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Hydrology"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Hydrology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
    </a>
    <a class="right-next"
       href="../Ocean/Ocean.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-analyzing-the-long-term-trend-in-surface-water-temperature-of-lake-superior">🌍 Use case: Analyzing the long-term trend in surface water temperature of Lake Superior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">❓ Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-variables">Set variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preprocessing">2. Data preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-lakeid">Plot lakeid</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-filtering">Data filtering</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-weighted-mean">Spatial weighted mean</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summer-mean-analisys">3. Summer mean analisys</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#summer-mean-and-standard-deviation">Summer mean and standard deviation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-linear-regression-for-the-full-set-1995-2023">Perform linear regression for the full set (1995-2023)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-results">Plot results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-to-noaa-great-lakes-coastwatch-data">4. Comparison to NOAA Great Lakes CoastWatch data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-noaa-dataset">Load the NOAA dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-both-datasets-over-time">Plot both datasets over time</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-calculation">Metrics calculation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-plot">Residual Plot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-mean-summer-lswt-for-outlier-value">Map of mean summer LSWT for outlier value</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>