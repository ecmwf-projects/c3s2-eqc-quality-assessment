
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.1. Reproducibility of drought indicators in the ERA5‚ÄìDrought dataset &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Indicators/indicator_derived-drought-historical-monthly_consistency_q01';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Derived Datasets" href="../Derived_Datasets/derived.html" />
    <link rel="prev" title="6. Indicators" href="indicator.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="indicator.html">6. Quality assessments for Climate Indicators</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.1. Reproducibility of drought indicators in the ERA5‚ÄìDrought dataset</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FIndicators/indicator_derived-drought-historical-monthly_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Indicators/indicator_derived-drought-historical-monthly_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reproducibility of drought indicators in the ERA5‚ÄìDrought dataset</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-retrieving-drought-indicators-from-the-era5drought-dataset">üåç Use case: Retrieving drought indicators from the ERA5‚ÄìDrought dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading-pre-processing">Data downloading &amp; (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulation-periods">Accumulation periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-spi-and-spei">Calculating SPI and SPEI</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#categorising-spi-and-spei">Categorising SPI and SPEI</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags">Quality flags</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">2. General setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-setup">2.1 Analysis setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cds-download-setup">2.2 CDS download setup</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#era5">ERA5</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#era5drought">ERA5‚ÄìDrought</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-land-sea-mask">2.3 Download land-sea mask</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison">3. SPI comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-monthly-precipitation-data-from-era5">3.1 Download monthly precipitation data from ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-total-precipitation-over-accumulation-periods">3.2 Calculate total precipitation over accumulation periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-gamma-distribution-by-calendar-month">3.3 Fit gamma distribution by calendar month</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-for-months-with-zero-precipitation">3.4 Adjust for months with zero precipitation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-spi">3.5 Compute SPI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison-time-series-in-example-site">3.6 SPI comparison: Time series in example site</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison-regional-snapshot">3.7 SPI comparison: Regional snapshot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags-probability-of-zero-precipitation">3.8 Quality flags: Probability of zero precipitation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags-shapirowilk-normality-test">3.9 Quality flags: Shapiro‚ÄìWilk normality test</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison">4. SPEI comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-monthly-precipitation-and-potential-evaporation-data-from-era5">4.1 Download monthly precipitation and potential evaporation data from ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-water-balance-over-accumulation-periods">4.2 Calculate water balance over accumulation periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-logistic-distribution-and-compute-spei">4.3 Fit logistic distribution and compute SPEI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison-time-series-in-example-site">4.4 SPEI comparison: Time series in example site</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison-regional-snapshot">4.5 SPEI comparison: Regional snapshot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.6 Quality flags: Shapiro‚ÄìWilk normality test</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-comparison">5. Ensemble comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-spi-and-spei-from-era5-ensemble">5.1 Compute SPI and SPEI from ERA5 ensemble</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-spi-and-spei-ensembles-from-era5drought">5.2 Download SPI and SPEI ensembles from ERA5‚ÄìDrought</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-comparison-time-series-in-example-site">5.3 Ensemble comparison: Time series in example site</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#control-member">Control member</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#full-ensemble">Full ensemble</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">6. Conclusions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="reproducibility-of-drought-indicators-in-the-era5drought-dataset">
<h1><span class="section-number">6.1. </span>Reproducibility of drought indicators in the ERA5‚ÄìDrought dataset<a class="headerlink" href="#reproducibility-of-drought-indicators-in-the-era5drought-dataset" title="Link to this heading">#</a></h1>
<p>Production date: 2026-02-19.</p>
<p><strong>Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch.</strong></p>
<p>Dataset version: 1.0.</p>
<p>Produced by: Enis Gerxhalija, Olivier Burggraaff (National Physical Laboratory).</p>
<section id="use-case-retrieving-drought-indicators-from-the-era5drought-dataset">
<h2>üåç Use case: Retrieving drought indicators from the ERA5‚ÄìDrought dataset<a class="headerlink" href="#use-case-retrieving-drought-indicators-from-the-era5drought-dataset" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Are the drought indicators in the ERA5‚ÄìDrought dataset consistent with and reproducible from ERA5 data?</strong></p></li>
</ul>
<p>Drought and extreme precipitation have far-reaching environmental, societal, and economic impacts.
In the United Kingdom, the record-breaking hot and dry spring and summer of 2025 caused harvest losses worth more than ¬£800 million [<a class="reference external" href="https://eciu.net/analysis/reports/2025/estimated-financial-losses-faced-by-uk-farmers-due-dry-weather-impacts-on-key-arable-crops" rel="noreferrer" target="_blank">ECIU+25</a>].
An 18-month drought in Brazil in 2023‚Äì24,
the most severe since monitoring began in 1954,
led to 720 health centres in affected areas becoming non-operational [<a class="reference external" href="https://reliefweb.int/node/4111326" rel="noreferrer" target="_blank">UNICEF+24</a>].
Extreme rainfall killed hundreds of people and caused billions of ‚Ç¨ in damages in Spain in 2024 [<a class="reference external" href="https://doi.org/10.48088/ejg.i.fra.16.2.286.297" rel="noreferrer" target="_blank">Franch-Pardo+25</a>].
Climate change is thought to be the primary driver behind the increase in drought and extreme precipitation events since the 1950s [<a class="reference external" href="https://doi.org/10.59327/IPCC/AR6-9789291691647" rel="noreferrer" target="_blank">IPCC+23</a>],
and this trend is expected to continue into the future.</p>
<p>Given these impacts,
monitoring drought and extreme precipitation is vital.
Several quantitative proxies have been developed to aid in this monitoring,
generally based on
a combination of
total precipitation, soil moisture, evapotranspiration, and surface (air) temperature.
Two widely-employed indices are the
<em>Standardised Precipitation Index (SPI)</em> [<a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf" rel="noreferrer" target="_blank">McKee+93</a>]
and
<em>Standardised Precipitation-Evapotranspiration Index (SPEI)</em> [<a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1" rel="noreferrer" target="_blank">Vicente-Serrano+10</a>].
Both operate on the same principle,
namely quantifying the amount of precipitation
over a given time frame at a given location
relative to its historical climatology.
For example,
an SPI value of +1 corresponds to a precipitation that is 1 standard deviation above the mean,
for that site and time frame.
This probabilistic approach lends itself to statements on the occurrence rate of extreme events [<a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf" rel="noreferrer" target="_blank">McKee+93</a>].
SPEI expands on SPI by including not just gains from precipitation, but also losses due to evapotranspiration.
SPI and SPEI can be evaluated over different <em>accumulation periods</em> to probe phenomena at different time scales [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>, <a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_spi.pdf" rel="noreferrer" target="_blank">EDO+25</a>]:</p>
<ul class="simple">
<li><p>1, 3 months: soil moisture, flow in smaller creeks.</p></li>
<li><p>6, 12 months: reservoir storage, stream flow.</p></li>
<li><p>24, 36, 48 months: reservoir and groundwater recharge.</p></li>
</ul>
<p>Indicators like SPI and SPEI depend on reliable input data in the form of historical meteorological time series.
Weather stations can provide these data with high accuracy and precision for specific sites,
but their coverage is sparse and their data are not always interoperable.
Reanalyses,
which integrate observations and forecast modelling,
can provide similar data consistently with long-term global coverage.
For example, ECMWF‚Äôs fifth-generation reanalysis <em>ERA5</em> provides meteorological data on a global ~31 km grid
going back to 1940 [<a class="reference external" href="https://doi.org/10.1002/qj.4803" rel="noreferrer" target="_blank">Soci+24</a>, <a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>].</p>
<p>The Copernicus Climate Change Service (C3S)
now provides pre-calculated SPI and SPEI indices derived from ERA5
in the ERA5‚ÄìDrought dataset [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>],
<a class="reference external" href="https://doi.org/10.24381/9bea5e16" rel="noreferrer" target="_blank">available from the Climate Data Store (CDS)</a>.
This derived dataset can be a valuable resource for applications in many sectors,
since it can be used out of the box,
freeing users from the need to find and process the underpinning meteorological data themselves.
ERA5‚ÄìDrought provides monthly SPI and SPEI for 7 different accumulation periods,
interpolated to a 0.25¬∞ √ó 0.25¬∞ grid.
It includes ERA5‚Äôs deterministic reanalysis as well as 10 propagated members of the ERA5-EDA ensemble.
The latter can be used to quantify the uncertainty in SPI or SPEI resulting from uncertainty in the input data.
Moreover, ERA5‚ÄìDrought provides multiple quality flags that can be used to filter data that do not meet the requirements for SPI or SPEI to be applicable.</p>
<p>This quality assessment tests the consistency of ERA5‚ÄìDrought with the underpinning ERA5 data in terms of its reproducibility.
By manually reproducing SPI, SPEI, and the associated quality indicators from ERA5 data and comparing the results,
we assess whether ERA5‚ÄìDrought can indeed be used as a more convenient alternative to ERA5 for monitoring drought and extreme precipitation.
Furthermore,
any discrepancies found in the comparison can shed light on caveats in the use of ERA5‚ÄìDrought specifically and drought indicators broadly,
such as the underlying assumptions.
This notebook provides code for reproducing SPI and SPEI from ERA5 data and can be a jumping-off point for further analysis by the reader.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Drought indicators (SPI and SPEI) and quality flags provided in the ERA5‚ÄìDrought dataset (reanalysis and ensemble) are highly consistent with values calculated from the underpinning ERA5 dataset. The pre-calculated values in ERA5‚ÄìDrought can be used confidently.</p></li>
<li><p>For SPI, some differences between ERA5‚ÄìDrought and the reproduced dataset occur in isolated spikes or in regions that are captured within the included quality flags. These do not affect real-world use cases, but highlight that quality flags should be applied before application of the data.</p></li>
<li><p>For SPEI, ambiguity in the choice of statistical distribution used is the most likely cause for differences between ERA5‚ÄìDrought and its reproduction. The same is true for the associated normality quality flag.</p></li>
<li><p>Users of SPI and SPEI datasets, such as ERA5‚ÄìDrought, should take note of the underlying assumptions and potential sources of difference between datasets. The quality flags in ERA5‚ÄìDrought should be used to mask low-quality data.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This quality assessment tests the reproducibility of drought indices in the ERA5‚ÄìDrought
(<a class="reference external" href="https://doi.org/10.24381/9bea5e16" rel="noreferrer" target="_blank"><em>Monthly drought indices from 1940 to present derived from ERA5 reanalysis</em></a>)
dataset
from their origins in ERA5.</p>
<p>This notebook provides and runs through Python code for reproducing
the SPI and SPEI indicators
as well as
the associated quality flags
(probability of zero precipitation <em>p<sub>0</sub></em> and Shapiro‚ÄìWilk normality <em>Œ±</em>)
from ERA5.
These reproduced values are then compared to the pre-made data in ERA5‚ÄìDrought in two case studies,
namely
a full time-series comparison in one location
and
a geospatial comparison at one point in time.
Because the goal of this assessment is to test the reproducibility of ERA5‚ÄìDrought,
rather than intercomparing two independent datasets,
comparisons will be made on both low- and high-quality data,
instead of masking and ignoring low-quality data.
When using the dataset in practice,
masking low-quality data <em>is</em> recommended, as explained in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</p>
<p>This notebook is set up so that the test sites and dates are easily customised,
so you can download it and apply it to your preferred domain.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"><span class="std std-ref">1. Code setup</span></a></strong></p>
<ul class="simple">
<li><p>Import all required libraries.</p></li>
<li><p>Define helper functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a></strong></p>
<ul class="simple">
<li><p>Define scope of analysis (time, location).</p></li>
<li><p>Set up CDS downloads for ERA5 and ERA5‚ÄìDrought.</p></li>
<li><p>Download land-sea mask.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spi"><span class="std std-ref">3. SPI comparison</span></a></strong></p>
<ul class="simple">
<li><p>Download ERA5 precipitation data.</p></li>
<li><p>Compute SPI over different accumulation periods.</p></li>
<li><p>Download ERA5‚ÄìDrought SPI and quality flags.</p></li>
<li><p>Compare ERA5‚ÄìDrought and reproduced SPI (time series, geospatial).</p></li>
<li><p>Compare ERA5‚ÄìDrought and reproduced quality flags.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spei"><span class="std std-ref">4. SPEI comparison</span></a></strong></p>
<ul class="simple">
<li><p>Download ERA5 precipitation and potential evaporation data.</p></li>
<li><p>Compute SPEI over different accumulation periods.</p></li>
<li><p>Download ERA5‚ÄìDrought SPEI and quality flags.</p></li>
<li><p>Compare ERA5‚ÄìDrought and reproduced SPEI (time series, geospatial).</p></li>
<li><p>Compare ERA5‚ÄìDrought and reproduced quality flags.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-ensemble"><span class="std std-ref">5. Ensemble comparison</span></a></strong></p>
<ul class="simple">
<li><p>Download ERA5 precipitation data.</p></li>
<li><p>Compute SPI for different ERA5 ensemble members.</p></li>
<li><p>Download ERA5‚ÄìDrought SPI ensemble.</p></li>
<li><p>Compare ERA5‚ÄìDrought and reproduced SPI ensembles.</p></li>
</ul>
<p><strong><a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-conclusion"><span class="std std-ref">6. Conclusions</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="code-setup">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"></span><h3>1. Code setup<a class="headerlink" href="#code-setup" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a> for downloading (<a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a>) and visualising (<a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a>) data. Because earthkit is in active development, some functionality may change after this notebook is published. If any part of the code stops functioning, please raise an issue on our GitHub repository so it can be fixed.</p>
</div>
<section id="import-required-libraries">
<h4>Import required libraries<a class="headerlink" href="#import-required-libraries" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Input / Output</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.data</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekd</span>

<span class="c1"># General data handling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">batched</span>

<span class="c1"># Analysis</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dask.array</span><span class="w"> </span><span class="kn">import</span> <span class="n">nanmedian</span><span class="p">,</span> <span class="n">ravel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="c1"># Visualisation</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">earthkit.plots</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ekp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Style</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy</span><span class="w"> </span><span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">BoundaryNorm</span><span class="p">,</span> <span class="n">ListedColormap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span><span class="p">,</span> <span class="n">trange</span>  <span class="c1"># Progress bars</span>

<span class="c1"># Visualisation in Jupyter book -- automatically ignored otherwise</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">glue</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Type hints</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas.io.formats.style</span><span class="w"> </span><span class="kn">import</span> <span class="n">Styler</span> <span class="k">as</span> <span class="n">pdStyler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">rv_continuous</span> <span class="k">as</span> <span class="n">Distribution</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.data.readers.netcdf.fieldlist</span><span class="w"> </span><span class="kn">import</span> <span class="n">NetCDFMultiFieldList</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">earthkit.plots.geo.domains</span><span class="w"> </span><span class="kn">import</span> <span class="n">Domain</span>
<span class="n">AnyDomain</span> <span class="o">=</span> <span class="p">(</span><span class="n">Domain</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="helper-functions">
<h4>Helper functions<a class="headerlink" href="#helper-functions" title="Link to this heading">#</a></h4>
<p>This section defines some functions and variables used in the following analysis, allowing code cells in later sections to be shorter and ensuring consistency.</p>
<section id="data-downloading-pre-processing">
<h5>Data downloading &amp; (pre-)processing<a class="headerlink" href="#data-downloading-pre-processing" title="Link to this heading">#</a></h5>
<p>The following functions handle downloading data in specific circumstances, e.g. a geographical or temporal subset:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Geographical</span>
<span class="k">def</span><span class="w"> </span><span class="nf">request_data_for_one_site</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">half_width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Return a CDS request for a bounding box around a point (lon, lat). &quot;&quot;&quot;</span>
    <span class="n">north</span><span class="p">,</span> <span class="n">south</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">+</span> <span class="n">half_width</span><span class="p">,</span> <span class="n">lat</span> <span class="o">-</span> <span class="n">half_width</span>
    <span class="n">east</span> <span class="p">,</span> <span class="n">west</span>  <span class="o">=</span> <span class="n">lon</span> <span class="o">+</span> <span class="n">half_width</span><span class="p">,</span> <span class="n">lon</span> <span class="o">-</span> <span class="n">half_width</span>
    <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="n">north</span><span class="p">,</span> <span class="n">west</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">east</span><span class="p">]</span>
    <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">box</span><span class="p">]</span>  <span class="c1"># Round all coordinates to 2 digits</span>
    <span class="n">request_box</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">box</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">request_box</span>

<span class="c1"># Handling CDS size limits</span>
<span class="k">def</span><span class="w"> </span><span class="nf">batch_requests</span><span class="p">(</span><span class="n">main_request</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">batch_key</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Take a big request (e.g. ERA5‚ÄìDrought for all years) and separate it into smaller ones (size `n`). &quot;&quot;&quot;</span>
    <span class="n">full_range</span> <span class="o">=</span> <span class="n">main_request</span><span class="p">[</span><span class="n">batch_key</span><span class="p">]</span>  <span class="c1"># e.g. [1940, 1941, ..., 2024]</span>
    <span class="n">batched_range</span> <span class="o">=</span> <span class="n">batched</span><span class="p">(</span><span class="n">full_range</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># e.g. [1940, ..., 1959], [1960, ..., 1979], ...</span>
    <span class="n">subrequests</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_request</span> <span class="o">|</span> <span class="p">{</span><span class="n">batch_key</span><span class="p">:</span> <span class="n">batch</span><span class="p">}</span> <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batched_range</span><span class="p">]</span>  <span class="c1"># create corresponding CDS requests</span>
    <span class="k">return</span> <span class="n">subrequests</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions ensure consistency in dimensions, which have inconsistent names (e.g. <code class="docutils literal notranslate"><span class="pre">valid_time</span></code> vs. <code class="docutils literal notranslate"><span class="pre">time</span></code>) and definitions (e.g. longitude 0 to 360 or ‚Äì180 to 180) between ERA5 and ERA5‚ÄìDrought:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rename_era5_dimensions</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rename dimensions</span>
<span class="sd">    from ERA5 (valid_time, latitude, longitude)</span>
<span class="sd">    to ERA5‚ÄìDrought (time, lat, lon)</span>
<span class="sd">    format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;valid_time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="s2">&quot;lon&quot;</span><span class="p">,</span>
                       <span class="p">})</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span><span class="w"> </span><span class="nf">longitude_360_to_180</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">longitude_dimension</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert longitude from 0..360 to -180..180 format. &quot;&quot;&quot;</span>
    <span class="n">longitude_new</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">longitude_dimension</span><span class="p">]</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="n">longitude_dimension</span><span class="p">:</span> <span class="n">longitude_new</span><span class="p">})</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">longitude_dimension</span><span class="p">)</span><span class="c1">#.squeeze()</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle unit conversions, e.g. m to mm precipitation:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unit conversion</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_unit</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert the units of dataset[key] to new_unit using a conversion function (e.g. lambda x: x*1000 for m to mm), in-place. &quot;&quot;&quot;</span>
    <span class="c1"># Metadata handling</span>
    <span class="n">metadata_old</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="n">metadata_new</span> <span class="o">=</span> <span class="n">metadata_old</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">new_unit</span><span class="p">}</span>

    <span class="c1"># Apply changes</span>
    <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">conversion</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">(</span><span class="o">**</span><span class="n">metadata_new</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span>  <span class="c1"># Redundant because modified in-place</span>

<span class="n">convert_m2mm</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">convert_unit</span><span class="p">,</span> <span class="n">conversion</span><span class="o">=</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">1000</span><span class="p">),</span> <span class="n">new_unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">)</span>  <span class="c1"># meter -&gt; millimeter</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following function handles the overall pre-processing of ERA5 data: renaming dimensions, converting units, and adjusting longitudes:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">preprocess_era5</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Pre-process ERA5 data (precipitation and/or evapotranspiration) into the right format for analysis. &quot;&quot;&quot;</span>
    <span class="c1"># Dimensions</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">rename_era5_dimensions</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">longitude_360_to_180</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">)</span>  <span class="c1"># Convert longitude from 0..360 to ‚Äì180..180</span>

    <span class="c1"># Units</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>  <span class="c1"># Assume all data_vars need to be converted to mm</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">convert_m2mm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>  <span class="c1"># Convert from m to mm</span>

    <span class="c1"># Re-chunk for speed gain in fitting</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,})</span>

    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following function calculates the water balance <code class="docutils literal notranslate"><span class="pre">wb</span></code> from the total precipitation and potential evaporation (<a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spei"><span class="std std-ref">4. SPEI comparison</span></a>):</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_waterbalance</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                           <span class="n">precipitation_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="n">evaporation_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;pev&quot;</span><span class="p">,</span>
                           <span class="n">waterbalance_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the water balance from precipitation and evaporation.</span>
<span class="sd">    Assumes the ECMWF sign convention where downward flux is positive and upward flux is negative,</span>
<span class="sd">    i.e. WB = TP + PEV.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate water balance</span>
    <span class="n">waterbalance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">precipitation_variable</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">evaporation_variable</span><span class="p">]</span>

    <span class="c1"># Apply variable name, metadata, and convert to dataset</span>
    <span class="n">waterbalance</span> <span class="o">=</span> <span class="n">waterbalance</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">waterbalance_variable</span><span class="p">)</span>
    <span class="n">waterbalance</span> <span class="o">=</span> <span class="n">waterbalance</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">precipitation_variable</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="p">,</span>
                                              <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Water balance&quot;</span><span class="p">,</span>
                                             <span class="p">})</span>
    <span class="n">waterbalance</span> <span class="o">=</span> <span class="n">waterbalance</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">waterbalance</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions aid in processing quality flag data from ERA5‚ÄìDrought into a standard format:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">preprocess_era5drought_qualityflag</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ekd</span><span class="o">.</span><span class="n">FieldList</span><span class="p">],</span> <span class="n">variable_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                       <span class="n">month_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Turn a dict of earthkit FieldLists with ERA5‚ÄìDrought quality flags, organised by accumulation period, into one big xr.Dataset.</span>
<span class="sd">    Rename the variables according to the dict keys; optionally using `variable_out` (e.g. SPEI -&gt; SPEI1, SPEI3, etc).</span>
<span class="sd">    Convert a 12-month time dimension (2020-01-01, 2020-02-01, ...) into a month dimension (1, 2, ...).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert field lists to xarray Datasets</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="c1"># Rename variables to include keys (e.g. accumulation periods)</span>
    <span class="n">first_fieldlist</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">data_var</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">first_fieldlist</span><span class="o">.</span><span class="n">data_vars</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">variable_out</span><span class="p">:</span>  <span class="c1"># If not manually specified, append keys to existing variable name</span>
        <span class="n">variable_out</span> <span class="o">=</span> <span class="n">data_var</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">({</span><span class="n">data_var</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_out</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

    <span class="c1"># Merge into one</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>

    <span class="c1"># Change time dimension to months</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="n">month_dimension</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">})</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="n">time_dimension</span><span class="p">:</span> <span class="n">month_dimension</span><span class="p">})</span>
    
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions restructure the ensemble members in the ERA5‚ÄìDrought dataset along a new dimension, as in ERA5:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_number_dimension</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">n_members</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                         <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">ensemble_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a dataset</span>
<span class="sd">    from ERA5‚ÄìDrought format (10-duplicate `time` dimension)</span>
<span class="sd">    to ERA5 format (`number` dimension for ensemble members)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Find unique times and use these to generate datasets for successive members</span>
    <span class="n">member_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_members</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">],</span> <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">time_dimension</span><span class="p">:</span> <span class="n">index</span> <span class="o">+</span> <span class="n">i</span><span class="p">})</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">member_numbers</span><span class="p">]</span>

    <span class="c1"># Combine into one dataset</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">ensemble_dimension</span><span class="p">)</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">member_numbers</span><span class="p">)</span>

    <span class="c1"># Rechunk for memory efficiency</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="n">ensemble_dimension</span><span class="p">:</span> <span class="n">n_members</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mi">103</span><span class="p">,})</span>

    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_era5drought_ensemble</span><span class="p">(</span><span class="n">fieldlist</span><span class="p">:</span> <span class="n">NetCDFMultiFieldList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pre-process ERA5‚ÄìDrought ensemble data that were downloaded in batches.</span>
<span class="sd">    Find and open the files in the `fieldlist`, convert them to ERA5 structure (`number` dimension),</span>
<span class="sd">        then merge them together into an xarray Dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Load data from file</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">reader</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">reader</span> <span class="ow">in</span> <span class="n">fieldlist</span><span class="o">.</span><span class="n">_indexes</span><span class="p">]</span>  <span class="c1"># Extract file paths from the earthkit FieldList</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">]</span>  <span class="c1"># Open each file in xarray</span>

    <span class="c1"># Pre-process individual files</span>
    <span class="n">processed</span> <span class="o">=</span> <span class="p">[</span><span class="n">add_number_dimension</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]</span>  <span class="c1"># Add the number dimension to each dataset</span>

    <span class="c1"># Combine and return</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">combine_by_coords</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">combine_attrs</span><span class="o">=</span><span class="s2">&quot;drop&quot;</span><span class="p">)</span>  <span class="c1"># Stack all datasets together</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Rechunk to single time dimension</span>
    <span class="k">return</span> <span class="n">final</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="accumulation-periods">
<h5>Accumulation periods<a class="headerlink" href="#accumulation-periods" title="Link to this heading">#</a></h5>
<p>The following cells contain constants and functions used in accumulating variables (e.g. precipitation) over time:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define constants such as the accumulation periods to use</span>
<span class="n">ACCUMULATION_PERIODS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">48</span><span class="p">]</span>  <span class="c1"># Months</span>
<span class="n">MONTHS</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>  <span class="c1"># January to December (inclusive)</span>
<span class="n">MONTHS_NAMED</span> <span class="o">=</span> <span class="p">{</span>
     <span class="mi">1</span><span class="p">:</span>  <span class="s2">&quot;January&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span>  <span class="s2">&quot;February&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>  <span class="s2">&quot;March&quot;</span><span class="p">,</span>
     <span class="mi">4</span><span class="p">:</span>  <span class="s2">&quot;April&quot;</span><span class="p">,</span>   <span class="mi">5</span><span class="p">:</span>  <span class="s2">&quot;May&quot;</span><span class="p">,</span>      <span class="mi">6</span><span class="p">:</span>  <span class="s2">&quot;June&quot;</span><span class="p">,</span>
     <span class="mi">7</span><span class="p">:</span>  <span class="s2">&quot;July&quot;</span><span class="p">,</span>    <span class="mi">8</span><span class="p">:</span>  <span class="s2">&quot;August&quot;</span><span class="p">,</span>   <span class="mi">9</span><span class="p">:</span>  <span class="s2">&quot;September&quot;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s2">&quot;October&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="s2">&quot;November&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span>  <span class="s2">&quot;December&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">INDEXES_NAMED</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Mapping from e.g. SPI1 to SPI-1</span>
                 <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SPI&quot;</span><span class="p">,</span> <span class="s2">&quot;SPEI&quot;</span><span class="p">]</span>             <span class="c1"># ERA5‚ÄìDrought provides data in former format (SPI1)</span>
                 <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span>       <span class="c1"># But figures should be labelled in the latter (SPI-1)</span>
<span class="p">}</span>

<span class="c1"># Perform accumulation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
               <span class="n">accumulation_periods</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="n">ACCUMULATION_PERIODS</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Accumulate the given variable `var` (e.g. total precipitation) over different accumulation periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Find the number of days in each month</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">])</span>  <span class="c1"># Convert time dimension to datetime format</span>
    <span class="n">days_in_month</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">time_index</span><span class="o">.</span><span class="n">days_in_month</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">time_dimension</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]})</span>  <span class="c1"># Aligned with `data` coordinates</span>

    <span class="c1"># Monthly mean `var` ‚Üí Monthly total `var`</span>
    <span class="n">monthly_total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">*</span> <span class="n">days_in_month</span>

    <span class="c1">## Accumulate over periods (rolling windows)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">accumulation_periods</span><span class="p">:</span>
        <span class="n">rolling_sum</span> <span class="o">=</span> <span class="n">monthly_total</span><span class="o">.</span><span class="n">rolling</span><span class="p">({</span><span class="n">time_dimension</span><span class="p">:</span> <span class="n">period</span><span class="p">},</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># Rolling sum</span>
        <span class="n">result</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rolling_sum</span>  <span class="c1"># Assign variable in same format as ERA5‚ÄìDrought (e.g. SPI6)</span>

    <span class="c1"># Reorganise</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">var</span><span class="p">])</span>  <span class="c1"># Drop original var</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chunksizes</span><span class="p">)</span>  <span class="c1"># Rechunk like input data</span>

    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions calculate the probability
(regular and accounting for the centre of mass)
of months with zero (accumulated) precipitation:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">number_of_months_with_zero_precipitation</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                             <span class="n">round_to</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                             <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the number of months with zero precipitation (and total months) in a given dataset.</span>
<span class="sd">    Rounds to `round_to` decimals (default 2, e.g. 0.01 mm).</span>
<span class="sd">    Zero precipitation means &lt;= `threshold` (0. by default).</span>
<span class="sd">    Applied per calendar month and to all variables (e.g. accumulation periods).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Round data, to 2 decimals by default</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">round_to</span><span class="p">)</span>

    <span class="c1"># Find months below threshold</span>
    <span class="n">is_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">)</span>

    <span class="c1"># Group by calendar month and find total number</span>
    <span class="n">data_by_calendar_month</span> <span class="o">=</span> <span class="n">is_zero</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">is_zero</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
    <span class="n">n_zero</span>  <span class="o">=</span> <span class="n">data_by_calendar_month</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">time_dimension</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">n_total</span> <span class="o">=</span> <span class="n">data_by_calendar_month</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">time_dimension</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">n_total</span><span class="p">,</span> <span class="n">n_zero</span>

<span class="k">def</span><span class="w"> </span><span class="nf">probability_of_zero_precipitation</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate the simple probability of zero precipitation in the given dataset, per calendar month. &quot;&quot;&quot;</span>
    <span class="c1"># Find number of months (total / zero precipitation)</span>
    <span class="n">n_total</span><span class="p">,</span> <span class="n">n_zero</span> <span class="o">=</span> <span class="n">number_of_months_with_zero_precipitation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Calculate simple probability</span>
    <span class="n">p_zero</span> <span class="o">=</span> <span class="n">n_zero</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">p_zero</span>
   
<span class="k">def</span><span class="w"> </span><span class="nf">probability_of_zero_precipitation_weighted</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate the weighted probability of zero precipitation in the given dataset, per calendar month. &quot;&quot;&quot;</span>
    <span class="c1"># Find number of months (total / zero precipitation)</span>
    <span class="n">n_total</span><span class="p">,</span> <span class="n">n_zero</span> <span class="o">=</span> <span class="n">number_of_months_with_zero_precipitation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>    

    <span class="c1"># Calculate weighted probability</span>
    <span class="n">p_zero</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">n_zero</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>                          <span class="c1"># Condition: More than 0 months with zero precipitation</span>
        <span class="p">(</span><span class="n">n_zero</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_total</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>  <span class="c1"># If condition met: weighted probability</span>
        <span class="mi">0</span>                                    <span class="c1"># If condition not met: just 0</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">p_zero</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="calculating-spi-and-spei">
<h5>Calculating SPI and SPEI<a class="headerlink" href="#calculating-spi-and-spei" title="Link to this heading">#</a></h5>
<p>The following functions fit the appropriate distributions
(gamma, generalised logistic)
and calculate corresponding CDF and SPI / SPEI values:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General fitting function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit_distributions</span><span class="p">(</span><span class="n">reference_data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">Distribution</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                      <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit distributions (e.g. gamma) for each month and accumulation period using xarray parallelisation.</span>
<span class="sd">    Data are assumed to have been sliced to the reference period.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define fitting function for the given distribution</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># If fitting fails, return NaN</span>
            <span class="c1"># Should only catch a specific Exception type</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">numargs</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>  <span class="c1"># Always convert result (values or NaN) to desired format</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Extend with axis for stats (alpha, loc, scale, ...)</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="c1"># Split dataset by month</span>
    <span class="n">reference_data_by_month</span> <span class="o">=</span> <span class="n">reference_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">reference_data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>

    <span class="c1"># Apply fitting function by month</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span> <span class="n">reference_data_by_month</span><span class="p">,</span>
                            <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="n">time_dimension</span><span class="p">]],</span> <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;stat&quot;</span><span class="p">]],</span>
                            <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
                            <span class="n">dask_gufunc_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;output_sizes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;stat&quot;</span><span class="p">:</span> <span class="n">distribution</span><span class="o">.</span><span class="n">numargs</span><span class="o">+</span><span class="mi">2</span><span class="p">}},</span>  <span class="c1"># e.g. 3 for gamma (alpha, loc, scale)</span>
                            <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
                           <span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">params</span>

<span class="c1"># Fitting functions for SPI, SPEI distributions specifically</span>
<span class="n">fit_monthly_spi</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">fit_distributions</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
<span class="n">fit_monthly_spei</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">fit_distributions</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">genlogistic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions apply the fitted distributions to calculate CDF values for observed data:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function: Clip the CDF to avoid infinities</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clip_cdf</span><span class="p">(</span><span class="n">cdf</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clip CDF values to `threshold` on both sides. &quot;&quot;&quot;</span>
    <span class="n">cdf_clipped</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cdf_clipped</span>

<span class="c1"># Main function: Compute CDF values for observed data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_cdf</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">distribution</span><span class="p">:</span> <span class="n">Distribution</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                <span class="n">month_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For observed `data`, compute the corresponding cumulative distribution function (CDF)</span>
<span class="sd">    values for the given `distribution` and `parameters`.</span>

<span class="sd">    Assumes that `data` and `parameters` have compatible:</span>
<span class="sd">        Coordinates (except time)</span>
<span class="sd">        Variables (e.g. corresponding to accumulation periods)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a month dimension for broadcasting with the one in parameters</span>
    <span class="n">data_month</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">month_dimension</span><span class="p">)</span>

    <span class="c1"># Extract parameters</span>
    <span class="n">nr_parameters</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;stat&quot;</span><span class="p">]</span>  <span class="c1"># 3 for gamma / genlogistic</span>
    <span class="n">parameters_extracted</span> <span class="o">=</span> <span class="p">[</span><span class="n">parameters</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="n">month_dimension</span><span class="p">:</span> <span class="n">data_month</span><span class="p">})</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr_parameters</span><span class="p">)]</span>

    <span class="c1"># Calculate CDF values by month</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">parameters_extracted</span><span class="p">,</span>
                         <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]],</span> <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[]],</span>
                         <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
                         <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
                         <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span>
                        <span class="p">)</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">clip_cdf</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span>  <span class="c1"># Clip extreme values to avoid infinities</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chunksizes</span><span class="p">)</span> <span class="c1"># Rechunk like input data</span>

    <span class="k">return</span> <span class="n">cdf</span>

<span class="c1"># Compute SPI, SPEI with preset distributions</span>
<span class="n">compute_cdf_spi</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">compute_cdf</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">)</span>
<span class="n">compute_cdf_spei</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">compute_cdf</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">genlogistic</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">adjust_cdf_for_zero_precipitation</span><span class="p">(</span><span class="n">cdf</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                      <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adjust CDF for months with zero precipitation, following Stagge+15 (doi:10.1002/joc.4267) method.</span>
<span class="sd">    `cdf` can be for any time range, `data` should be for the reference period only.</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="c1"># Calculate probability of zero precipitation</span>
    <span class="n">p_zero</span> <span class="o">=</span> <span class="n">probability_of_zero_precipitation_weighted</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">p_zero</span> <span class="o">=</span> <span class="n">p_zero</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Rechunk for efficiency</span>

    <span class="c1"># Adjust CDF by calendar month</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_cdf_by_calendar_month</span><span class="p">(</span><span class="n">cdf_one_month</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
        <span class="n">this_month</span> <span class="o">=</span> <span class="n">cdf_one_month</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span> <span class="c1"># Cannot use GroupBy label inside .map() unfortunately</span>
        <span class="n">p_zero_this_month</span> <span class="o">=</span> <span class="n">p_zero</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">this_month</span><span class="p">})</span>
        <span class="n">cdf_adjusted</span> <span class="o">=</span> <span class="n">p_zero_this_month</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_zero_this_month</span><span class="p">)</span> <span class="o">*</span> <span class="n">cdf_one_month</span>
        <span class="k">return</span> <span class="n">cdf_adjusted</span>

    <span class="n">cdf_by_calendar_month</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">cdf</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
    <span class="n">cdf_adjusted</span> <span class="o">=</span> <span class="n">cdf_by_calendar_month</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">adjust_cdf_by_calendar_month</span><span class="p">)</span>  
    <span class="c1"># Alternative approach: Broadcast p_zero against cdf instead of using GroupBy (not implemented here)</span>

    <span class="c1"># Reorganise for efficiency</span>
    <span class="n">cdf_adjusted</span> <span class="o">=</span> <span class="n">cdf_adjusted</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">cdf</span><span class="o">.</span><span class="n">chunksizes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cdf_adjusted</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions calculate the SPI/SPEI index based on CDF values:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main function: Convert CDF values to indexes</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cdf_to_index</span><span class="p">(</span><span class="n">cdf</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Transform CDF values to a standard normal distribution. &quot;&quot;&quot;</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">clip_cdf</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span>  <span class="c1"># Clip extreme values to avoid infinities</span>

    <span class="c1"># Convert CDF to index</span>
    <span class="n">index_values</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">,</span> <span class="n">cdf</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  
                                  <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[],</span> <span class="p">[],</span> <span class="p">[]],</span> <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[]],</span>
                                  <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
                                  <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
                                  <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="p">)</span>

    <span class="c1"># Adjust variable names to ERA5‚ÄìDrought format (e.g. SPI6) if desired</span>
    <span class="k">if</span> <span class="n">var</span> <span class="ow">and</span> <span class="n">index_name</span><span class="p">:</span>
        <span class="n">rename_variables</span> <span class="o">=</span> <span class="p">{</span><span class="n">datavar</span><span class="p">:</span> <span class="n">datavar</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">index_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">datavar</span> <span class="ow">in</span> <span class="n">cdf</span><span class="o">.</span><span class="n">data_vars</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">datavar</span><span class="p">}</span>
        <span class="n">index_values</span> <span class="o">=</span> <span class="n">index_values</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">(</span><span class="n">rename_variables</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">index_values</span>

<span class="c1"># Compute SPI, SPEI with preset names</span>
<span class="n">cdf_to_spi</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">cdf_to_index</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;SPI&quot;</span><span class="p">)</span>
<span class="n">cdf_to_spei</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">cdf_to_index</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="s2">&quot;SPEI&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For convenience, we also provide the following functions that wrap the entire process from data to SPI/SPEI into one:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full SPI pipeline</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_spi_from_era5</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reference_window</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">],</span>
                            <span class="n">do_preprocessing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">evaluation_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">precipitation_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;tp&quot;</span><span class="p">,</span>
                            <span class="n">accumulation_periods</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="n">ACCUMULATION_PERIODS</span><span class="p">,</span>
                           <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate SPI from ERA5 precipitation data, including all steps.</span>
<span class="sd">    Input should be ERA5 data in xarray format, either</span>
<span class="sd">        freshly downloaded (`do_preprocessing=True`)</span>
<span class="sd">        or</span>
<span class="sd">        pre-processed (`do_preprocessing=False`).</span>
<span class="sd">    Some parameters can be adjusted,</span>
<span class="sd">        e.g. the name of the precipitation variable (&quot;tp&quot; by default).</span>
<span class="sd">        This should make the function easier to transfer to other datasets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Optional: pre-process to desired format</span>
    <span class="k">if</span> <span class="n">do_preprocessing</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">preprocess_era5</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Accumulate total precipitation</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">precipitation_variable</span><span class="p">,</span> <span class="n">accumulation_periods</span><span class="o">=</span><span class="n">accumulation_periods</span><span class="p">)</span>

    <span class="c1"># Select data in reference window</span>
    <span class="n">data_reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">reference_window</span><span class="p">)</span>
    
    <span class="c1"># Fit gamma distribution</span>
    <span class="n">spi_parameters</span> <span class="o">=</span> <span class="n">fit_monthly_spi</span><span class="p">(</span><span class="n">data_reference</span><span class="p">)</span>

    <span class="c1"># Optional: Only calculate index in evaluation window</span>
    <span class="k">if</span> <span class="n">evaluation_window</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">evaluation_window</span><span class="p">)</span>

    <span class="c1"># Compute CDF time series</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">compute_cdf_spi</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spi_parameters</span><span class="p">)</span>

    <span class="c1"># Adjust CDF</span>
    <span class="n">cdf_adjusted</span> <span class="o">=</span> <span class="n">adjust_cdf_for_zero_precipitation</span><span class="p">(</span><span class="n">cdf</span><span class="p">,</span> <span class="n">data_reference</span><span class="p">)</span>

    <span class="c1"># Calculate SPI from adjusted CDF</span>
    <span class="n">spi</span> <span class="o">=</span> <span class="n">cdf_to_spi</span><span class="p">(</span><span class="n">cdf_adjusted</span><span class="p">)</span>
    <span class="n">spi</span> <span class="o">=</span> <span class="n">spi</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chunksizes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spi</span>

<span class="c1"># Full SPEI pipeline</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_spei_from_era5</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reference_window</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">],</span>
                             <span class="n">do_preprocessing</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">evaluation_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">precipitation_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="n">evaporation_variable</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;pev&quot;</span><span class="p">,</span>
                             <span class="n">accumulation_periods</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="n">ACCUMULATION_PERIODS</span><span class="p">,</span>
                            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate SPEI from ERA5 precipitation and potential evaporation data, including all steps.</span>
<span class="sd">    Input should be ERA5 data in xarray format, either</span>
<span class="sd">        freshly downloaded (`do_preprocessing=True`)</span>
<span class="sd">        or</span>
<span class="sd">        pre-processed (`do_preprocessing=False`).</span>
<span class="sd">    Some parameters can be adjusted,</span>
<span class="sd">        e.g. the name of the precipitation variable (&quot;tp&quot; by default).</span>
<span class="sd">        This should make the function easier to transfer to other datasets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Optional: pre-process to desired format</span>
    <span class="k">if</span> <span class="n">do_preprocessing</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">preprocess_era5</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Calculate water balance</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">calculate_waterbalance</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Accumulate water balance</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>

    <span class="c1"># Select data in reference window</span>
    <span class="n">data_reference</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">reference_window</span><span class="p">)</span>

    <span class="c1"># Fit generalised logistic distribution</span>
    <span class="n">spei_parameters</span> <span class="o">=</span> <span class="n">fit_monthly_spei</span><span class="p">(</span><span class="n">data_reference</span><span class="p">)</span>

    <span class="c1"># Optional: Only calculate index in evaluation window</span>
    <span class="k">if</span> <span class="n">evaluation_window</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">evaluation_window</span><span class="p">)</span>

    <span class="c1"># Compute CDF time series</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">compute_cdf_spei</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spei_parameters</span><span class="p">)</span>

    <span class="c1"># Calculate SPI from CDF</span>
    <span class="n">spei</span> <span class="o">=</span> <span class="n">cdf_to_spei</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span>
    <span class="n">spei</span> <span class="o">=</span> <span class="n">spei</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">chunksizes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spei</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="categorising-spi-and-spei">
<h5>Categorising SPI and SPEI<a class="headerlink" href="#categorising-spi-and-spei" title="Link to this heading">#</a></h5>
<p>The following cell defines categories for SPI and SPEI values, e.g. ‚Äúsevere drought‚Äù:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Category format: [lower limit, upper limit, label, colour]</span>
<span class="c1"># Colours are picked from Fig. 4 in Keune+25 and labelled for convenience</span>
<span class="c1"># Limits are left-inclusive: [lower, upper)</span>
<span class="c1"># Extreme values of 100 / -100 should be treated as infinities but play nicer with some code than np.inf</span>

<span class="n">CATEGORIES_SPI</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># Approximates the GDO scheme</span>
    <span class="p">(</span>   <span class="mf">2.00</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>     <span class="s2">&quot;Extremely wet&quot;</span><span class="p">,</span>            <span class="s2">&quot;#7a007b&quot;</span><span class="p">),</span>  <span class="c1"># deepest purple </span>
    <span class="p">(</span>   <span class="mf">1.50</span><span class="p">,</span>   <span class="mf">2.00</span><span class="p">,</span>  <span class="s2">&quot;Severely wet&quot;</span><span class="p">,</span>             <span class="s2">&quot;#af51c3&quot;</span><span class="p">),</span>  <span class="c1"># dark purple</span>
    <span class="p">(</span>   <span class="mf">1.00</span><span class="p">,</span>   <span class="mf">1.50</span><span class="p">,</span>  <span class="s2">&quot;Moderately wet&quot;</span><span class="p">,</span>           <span class="s2">&quot;#eaccf8&quot;</span><span class="p">),</span>  <span class="c1"># medium purple</span>
    <span class="p">(</span>   <span class="mf">0.00</span><span class="p">,</span>   <span class="mf">1.00</span><span class="p">,</span>  <span class="s2">&quot;Near‚Äënormal / mildly wet&quot;</span><span class="p">,</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">),</span>  <span class="c1"># white</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">1.00</span><span class="p">,</span>   <span class="mf">0.00</span><span class="p">,</span>  <span class="s2">&quot;Near‚Äënormal / mildly dry&quot;</span><span class="p">,</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">),</span>  <span class="c1"># white</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">1.50</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.00</span><span class="p">,</span>  <span class="s2">&quot;Moderately dry&quot;</span><span class="p">,</span>           <span class="s2">&quot;#fffc03&quot;</span><span class="p">),</span>  <span class="c1"># yellow</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">2.00</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.50</span><span class="p">,</span>  <span class="s2">&quot;Severely dry&quot;</span><span class="p">,</span>             <span class="s2">&quot;#feaa00&quot;</span><span class="p">),</span>  <span class="c1"># orange</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span>     <span class="o">-</span><span class="mf">2.00</span><span class="p">,</span>  <span class="s2">&quot;Extremely dry&quot;</span><span class="p">,</span>            <span class="s2">&quot;#ff0100&quot;</span><span class="p">),</span>  <span class="c1"># red</span>
<span class="p">]</span>

<span class="n">CATEGORIES_SPEI</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span>   <span class="mf">2.33</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>    <span class="s2">&quot;Extremely wet&quot;</span><span class="p">,</span>  <span class="s2">&quot;#01148b&quot;</span><span class="p">),</span>  <span class="c1"># very dark navy</span>
    <span class="p">(</span>   <span class="mf">1.65</span><span class="p">,</span>   <span class="mf">2.33</span><span class="p">,</span> <span class="s2">&quot;Severely wet&quot;</span><span class="p">,</span>   <span class="s2">&quot;#1871de&quot;</span><span class="p">),</span>  <span class="c1"># strong blue</span>
    <span class="p">(</span>   <span class="mf">1.28</span><span class="p">,</span>   <span class="mf">1.65</span><span class="p">,</span> <span class="s2">&quot;Moderately wet&quot;</span><span class="p">,</span> <span class="s2">&quot;#14acf4&quot;</span><span class="p">),</span>  <span class="c1"># medium blue</span>
    <span class="p">(</span>   <span class="mf">0.84</span><span class="p">,</span>   <span class="mf">1.28</span><span class="p">,</span> <span class="s2">&quot;Mildly wet&quot;</span><span class="p">,</span>     <span class="s2">&quot;#00f2fe&quot;</span><span class="p">),</span>  <span class="c1"># cyan</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">0.84</span><span class="p">,</span>   <span class="mf">0.84</span><span class="p">,</span> <span class="s2">&quot;Near-normal&quot;</span><span class="p">,</span>    <span class="s2">&quot;#9afa93&quot;</span><span class="p">),</span>  <span class="c1"># light green</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">1.28</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.84</span><span class="p">,</span> <span class="s2">&quot;Mildly dry&quot;</span><span class="p">,</span>     <span class="s2">&quot;#fdc403&quot;</span><span class="p">),</span>  <span class="c1"># yellow</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">1.65</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.28</span><span class="p">,</span> <span class="s2">&quot;Moderately dry&quot;</span><span class="p">,</span> <span class="s2">&quot;#f2631d&quot;</span><span class="p">),</span>  <span class="c1"># orange</span>
    <span class="p">(</span>  <span class="o">-</span><span class="mf">2.33</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.65</span><span class="p">,</span> <span class="s2">&quot;Severely dry&quot;</span><span class="p">,</span>   <span class="s2">&quot;#df2929&quot;</span><span class="p">),</span>  <span class="c1"># red</span>
    <span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span>     <span class="o">-</span><span class="mf">2.33</span><span class="p">,</span> <span class="s2">&quot;Extremely dry&quot;</span><span class="p">,</span>  <span class="s2">&quot;#8c1b1a&quot;</span><span class="p">),</span>  <span class="c1"># dark red</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions categorise SPI / SPEI values into said categories:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_digitise_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">persist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Digitise all variables in `data` according to a list of left bin edges, e.g. SPI categories (&quot;extremely dry&quot;).</span>
<span class="sd">    In this notebook, do not call this function directly, but use the categorise_dataset wrapper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Perform digitisation</span>
    <span class="n">data_digitised</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span>
                                    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bins&quot;</span><span class="p">:</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> 
                                    <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[]],</span>
                                    <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
                                    <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">],</span>  <span class="c1"># uint8 is small; not suitable for &gt;256 categories</span>
    <span class="p">)</span>

    <span class="c1"># Persist in memory if desired (default True because uint8s are small)</span>
    <span class="k">if</span> <span class="n">persist</span><span class="p">:</span>
        <span class="n">data_digitised</span> <span class="o">=</span> <span class="n">data_digitised</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data_digitised</span>

<span class="k">def</span><span class="w"> </span><span class="nf">categorise_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Iterable</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Categorise a dataset into bins defined by category thresholds.</span>
<span class="sd">    Extracts bin edges from `categories` and then digitises `data` accordingly.</span>
<span class="sd">    Handles NaNs by adding a dummy category (extremely high bin edge).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract bin edges from categories</span>
    <span class="c1"># Last element is dropped to extend range to infinity (although values should be clipped anyway)</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Add dummy category to catch NaNs</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100000</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span>

    <span class="c1"># Apply digitisation</span>
    <span class="n">data_categorised</span> <span class="o">=</span> <span class="n">_digitise_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_categorised</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="quality-flags">
<h5>Quality flags<a class="headerlink" href="#quality-flags" title="Link to this heading">#</a></h5>
<p>The following functions create and apply quality flag tests, such as the probability of zero precipitation and the Shapiro‚ÄìWilk normality test:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">shapiro_wilk_normality</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                           <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">month_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Shapiro‚ÄìWilk normality p-value for every variable in `data`</span>
<span class="sd">        along the `time_dimension`, grouped by month.</span>
<span class="sd">    Make sure to provide data for the desired period (generally the reference window) only.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Group by month</span>
    <span class="n">data_by_month</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>

    <span class="c1"># Perform test</span>
    <span class="n">_</span> <span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">,</span> <span class="n">data_by_month</span><span class="p">,</span>
                              <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="n">time_dimension</span><span class="p">]],</span> <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[],[]],</span>
                              <span class="n">vectorize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
                              <span class="n">output_dtypes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
                              <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="p">)</span>
    <span class="k">return</span> <span class="n">pval</span>

<span class="k">def</span><span class="w"> </span><span class="nf">apply_sw_quality_mask</span><span class="p">(</span><span class="n">era5_quality</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">index_ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">indicator</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply significance-based quality masks to drought indicator datasets.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index_ds</span> <span class="o">=</span> <span class="n">safe_rename</span><span class="p">(</span><span class="n">index_ds</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span><span class="p">:</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">era5_quality</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;significance_</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">sig</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">index_ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indicator</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
        <span class="n">index_ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indicator</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">index_ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indicator</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">index_ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="statistics">
<h5>Statistics<a class="headerlink" href="#statistics" title="Link to this heading">#</a></h5>
<p>The following functions calculate and display the difference (by month) between datasets:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper functions: Calculate statistics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">align_data_variables</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Only look at variables that are in both datasets, following the order in `data2`.</span>
<span class="sd">    Optional: variables have to include `var`, e.g. &quot;SPI&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matching_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_var</span> <span class="k">for</span> <span class="n">data_var</span> <span class="ow">in</span> <span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span>
                          <span class="k">if</span> <span class="n">data_var</span> <span class="ow">in</span> <span class="n">data1</span><span class="o">.</span><span class="n">data_vars</span> <span class="ow">and</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">data_var</span><span class="p">]</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">matching_variables</span><span class="p">]</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">median_by_month</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate the median by month, flattening all other dimensions (time, lat, lon, etc.) &quot;&quot;&quot;</span>
    <span class="n">data_by_month</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">data_by_month</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">dim</span><span class="o">=...</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># .quantile function has better dask support than .median</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">median</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;quantile&quot;</span><span class="p">)</span>  <span class="c1"># Drop unneeded coordinate</span>
    <span class="k">return</span> <span class="n">median</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fraction_by_month</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">as_percentage</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Given a dataset of bools, return the fraction per calendar month that are True. &quot;&quot;&quot;</span>
    <span class="n">data_by_month</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">time_dimension</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="n">data_by_month</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=...</span><span class="p">)</span> <span class="o">/</span> <span class="n">data_by_month</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=...</span><span class="p">)</span>  <span class="c1"># dim=... reduces over all dimensions (e.g. lat, lon)]</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="n">fraction</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">fraction</span><span class="o">.</span><span class="n">coords</span> <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s2">&quot;month&quot;</span><span class="p">)</span>  <span class="c1"># Remove unneeded coordinates (e.g. lat, lon for 1D dataset)</span>
    <span class="k">if</span> <span class="n">as_percentage</span><span class="p">:</span>
        <span class="n">fraction</span> <span class="o">*=</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">fraction</span>

<span class="c1"># Main function: Calculate statistics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">comparison_monthly_statistics</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                  <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>
                                  <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given two datasets, calculate a number of statistics for each variable and return the result in a table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Align data variables</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">align_data_variables</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>

    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">data2</span> <span class="o">-</span> <span class="n">data1</span>
    <span class="n">difference_absolute</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>

    <span class="c1"># Calculate monthly medians</span>
    <span class="n">md</span>  <span class="o">=</span> <span class="n">median_by_month</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span>          <span class="n">time_dimension</span><span class="o">=</span><span class="n">time_dimension</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    <span class="n">mad</span> <span class="o">=</span> <span class="n">median_by_month</span><span class="p">(</span><span class="n">difference_absolute</span><span class="p">,</span> <span class="n">time_dimension</span><span class="o">=</span><span class="n">time_dimension</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

    <span class="c1"># Calculate fraction over threshold</span>
    <span class="n">difference_over_threshold</span> <span class="o">=</span> <span class="p">(</span><span class="n">difference_absolute</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="n">fraction_over_threshold</span> <span class="o">=</span> <span class="n">fraction_by_month</span><span class="p">(</span><span class="n">difference_over_threshold</span><span class="p">,</span> <span class="n">time_dimension</span><span class="o">=</span><span class="n">time_dimension</span><span class="p">,</span> <span class="n">as_percentage</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
    
    <span class="c1"># Combine into one DataFrame</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">({</span><span class="s2">&quot;MŒî&quot;</span><span class="p">:</span> <span class="n">md</span><span class="p">,</span>
                       <span class="s2">&quot;M|Œî|&quot;</span><span class="p">:</span> <span class="n">mad</span><span class="p">,</span>
                      <span class="sa">f</span><span class="s2">&quot;|Œî| ‚â• </span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">fraction_over_threshold</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">swaplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>             <span class="c1"># Accumulation period on top, statistic below</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">]</span>                    <span class="c1"># Same order as inputs</span>

    <span class="k">return</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function: Styling for statistics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_add_matching_vertical_separators</span><span class="p">(</span><span class="n">styler</span><span class="p">:</span> <span class="n">pdStyler</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                      <span class="n">colour</span><span class="o">=</span><span class="s2">&quot;#bbbbbb&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;1px&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pdStyler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add vertical separators corresponding to the top level columns,</span>
<span class="sd">        e.g. SPI1 ‚Äì SPI3 etc. but not Œî ‚Äì |Œî| in comparison_monthly_statistics outputs.</span>

<span class="sd">    Note: This function is largely AI-generated, with manual edits.</span>
<span class="sd">      - Adds a left border to the first subcolumn of each top-level group</span>
<span class="sd">        in the BODY (data cells),</span>
<span class="sd">      - Adds the same border to the HEADER cells for both level 0 and level 1</span>
<span class="sd">        at the same positions (using .col{i} classes).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get data, check applicability</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">styler</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="p">)</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected MultiIndex columns with ‚â•2 levels.&quot;</span><span class="p">)</span>

    <span class="c1"># Group boundaries (indices of first subcolumn of each new top-level label)</span>
    <span class="n">lvl0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flatnonzero</span><span class="p">(</span><span class="n">lvl0</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">lvl0</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">breaks</span><span class="p">]</span>  <span class="c1"># Include first element</span>

    <span class="c1"># Define common styles</span>
    <span class="n">border_left</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2"> solid </span><span class="si">{</span><span class="n">colour</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># 1) BODY: draw the vertical rule down through the data</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">breaks</span><span class="p">:</span>
        <span class="n">styler</span> <span class="o">=</span> <span class="n">styler</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span>
            <span class="n">subset</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
            <span class="o">**</span><span class="p">{</span><span class="s2">&quot;border-left&quot;</span><span class="p">:</span> <span class="n">border_left</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># 2) HEADER: mirror the exact same left border on header cells</span>
    <span class="c1"># Each header cell at position i has classes: th.col_heading.level{0|1}.col{i}</span>
    <span class="n">header_rules</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">breaks</span><span class="p">:</span>
        <span class="n">header_rules</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;th.col_heading.level0.col</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border-left&quot;</span><span class="p">,</span> <span class="n">border_left</span><span class="p">)]}</span>
            <span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;th.col_heading.level1.col</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border-left&quot;</span><span class="p">,</span> <span class="n">border_left</span><span class="p">)]}</span>
        <span class="p">])</span>

    <span class="c1"># Optional: normalize other header borders so only our verticals stand out</span>
    <span class="n">header_rules</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;th.col_heading&quot;</span><span class="p">,</span> <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border-bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)]},</span>
        <span class="c1"># keep overall layout tight and consistent</span>
        <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>
         <span class="s2">&quot;props&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;border-collapse&quot;</span><span class="p">,</span> <span class="s2">&quot;separate&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;border-spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)]}</span>
    <span class="p">])</span>

    <span class="n">styler</span> <span class="o">=</span> <span class="n">styler</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">((</span><span class="n">styler</span><span class="o">.</span><span class="n">table_styles</span> <span class="ow">or</span> <span class="p">[])</span> <span class="o">+</span> <span class="n">header_rules</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">styler</span>

<span class="c1"># Main function: Display statistics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">display_monthly_statistics</span><span class="p">(</span><span class="n">comparison_stats</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                               <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pdStyler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display the statistics calculated in comparison_monthly_statistics with more style.</span>
<span class="sd">    Note: does NOT do the actual calculations, unlike in other notebooks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use words for month names + Format indexes for output (e.g. SPI1 to SPI-1)</span>
    <span class="n">comparison_stats</span> <span class="o">=</span> <span class="n">comparison_stats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">MONTHS_NAMED</span><span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">comparison_stats</span> <span class="o">=</span> <span class="n">comparison_stats</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">INDEXES_NAMED</span><span class="p">)</span>

    <span class="c1"># Apply styles:</span>
    <span class="c1"># Number of digits</span>
    <span class="c1"># Caption</span>
    <span class="c1"># No sticky index ‚Äì does not play nice with jupyter-book</span>
    <span class="c1"># Apply vertical lines to separate columns</span>
    <span class="n">formatted</span> <span class="o">=</span> <span class="n">comparison_stats</span><span class="o">.</span><span class="n">style</span> \
                                <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  \
                                <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">label1</span><span class="si">}{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  \
                                <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">_add_matching_vertical_separators</span><span class="p">)</span>
    
    <span class="c1"># Center headers ; AI-generated</span>
    <span class="n">formatted</span> <span class="o">=</span> <span class="n">formatted</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span>
        <span class="p">(</span><span class="n">formatted</span><span class="o">.</span><span class="n">table_styles</span> <span class="ow">or</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span>
            <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th.col_heading&#39;</span><span class="p">,</span>
             <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;text-align&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">),</span>
                       <span class="p">(</span><span class="s1">&#39;vertical-align&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">),</span>
                      <span class="p">],</span>
             <span class="p">},</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">formatted</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions compare quality flags quantitatively:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">count_flagged_months</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; For a dataset with quality flags for 12 months, return a new dataset with the number of months failing that flag. &quot;&quot;&quot;</span>
    <span class="n">sum_by_month</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>  <span class="c1"># Number of months *passing* the flag</span>
    <span class="k">if</span> <span class="n">invert</span><span class="p">:</span>  <span class="c1"># Make False for e.g. mismatched months</span>
        <span class="n">sum_by_month</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">-</span> <span class="n">sum_by_month</span>                   <span class="c1"># Number of months *failing* the flag</span>
    <span class="k">return</span> <span class="n">sum_by_month</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_matching_fraction</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                       <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
    <span class="c1"># Round to precision if floating-point numbers</span>
    <span class="k">if</span> <span class="s2">&quot;float&quot;</span> <span class="ow">in</span> <span class="n">data1</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>

    <span class="c1"># Compare and determine matching fraction</span>
    <span class="n">equal</span> <span class="o">=</span> <span class="p">(</span><span class="n">data1</span> <span class="o">==</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">equal</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal_fraction</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># %</span>

    <span class="c1"># Tabulate</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal_fraction</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Perform calculations ‚Äì this step may take a few minutes</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal_fraction</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>  <span class="c1"># -&gt; pd.Series</span>

    <span class="k">return</span> <span class="n">equal_fraction</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_quality_flags</span><span class="p">(</span><span class="n">flags</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]],</span>  <span class="c1"># e.g. p0 (probabilities), p0 &lt; 0.33 (mask)</span>
                          <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pdStyler</span><span class="p">:</span>
    <span class="c1"># Set up progress bar</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">flags</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Finding matching flags&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;pair&quot;</span><span class="p">)</span>

    <span class="c1"># Perform comparisons</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Matching &quot;</span><span class="o">+</span><span class="n">key</span><span class="p">:</span> <span class="n">_matching_fraction</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">}</span>  <span class="c1"># str: pd.Series</span>
    
    <span class="c1"># Tabulate</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">equal_fraction</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Flags as rows, variables as columns</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal_fraction</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">INDEXES_NAMED</span><span class="p">)</span>  <span class="c1"># e.g. SPI1 to SPI-1</span>

    <span class="c1"># Stylise</span>
    <span class="n">equal_fraction</span> <span class="o">=</span> <span class="n">equal_fraction</span><span class="o">.</span><span class="n">style</span> \
                                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  \
                                   <span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Quality flag matches</span><span class="si">{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">equal_fraction</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="visualisation">
<h5>Visualisation<a class="headerlink" href="#visualisation" title="Link to this heading">#</a></h5>
<p>The following cell defines <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/_api/plots/styles/index.html" rel="noreferrer" target="_blank">earthkit-plots styles</a> for the variables in the datasets.
These styles define the colour maps and colour bar ranges for each quantity. Earthkit-plots styles are explained further in the <a class="reference external" href="https://earthkit-plots.readthedocs.io/en/latest/examples/examples/examples.html#Styles" rel="noreferrer" target="_blank">corresponding documentation</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function: Translate tabulated categories to Style</span>
<span class="k">def</span><span class="w"> </span><span class="nf">categories_to_earthkit_style</span><span class="p">(</span><span class="n">var_categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Style</span><span class="p">:</span>  <span class="c1"># e.g. CATEGORIES_SPI</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; From a list of categories, create an earthkit.plots Style. &quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="n">category</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">var_categories</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Colours in reverse (ascending) order</span>
    <span class="n">norm</span> <span class="o">=</span>   <span class="n">BoundaryNorm</span><span class="p">([</span><span class="n">category</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">var_categories</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
    <span class="n">style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">cmap</span><span class="p">,</span> <span class="s2">&quot;norm&quot;</span><span class="p">:</span> <span class="n">norm</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">style</span>

<span class="c1"># Styles for SPI, SPEI based on Keune+25 colours</span>
<span class="n">_style_spi</span>  <span class="o">=</span> <span class="n">categories_to_earthkit_style</span><span class="p">(</span><span class="n">CATEGORIES_SPI</span><span class="p">)</span>
<span class="n">_style_spei</span> <span class="o">=</span> <span class="n">categories_to_earthkit_style</span><span class="p">(</span><span class="n">CATEGORIES_SPEI</span><span class="p">)</span>
<span class="n">_style_spi_diff</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
<span class="n">_style_spei_diff</span> <span class="o">=</span> <span class="n">_style_spi_diff</span>

<span class="c1"># Styles for quality flags</span>
<span class="n">_style_probability</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">magma</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">_style_probability_diff</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">_style_flag_summed</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s2">&quot;#000000&quot;</span><span class="p">,</span> <span class="s2">&quot;#ffffcd&quot;</span><span class="p">,</span> <span class="s2">&quot;#f4eabb&quot;</span><span class="p">,</span> <span class="s2">&quot;#ebd4ac&quot;</span><span class="p">,</span> <span class="s2">&quot;#e2bc99&quot;</span><span class="p">,</span> <span class="s2">&quot;#d5a888&quot;</span><span class="p">,</span> <span class="s2">&quot;#c8947a&quot;</span><span class="p">,</span>
                                                         <span class="s2">&quot;#bf7e6b&quot;</span><span class="p">,</span> <span class="s2">&quot;#b4685d&quot;</span><span class="p">,</span> <span class="s2">&quot;#a7544e&quot;</span><span class="p">,</span> <span class="s2">&quot;#9b3d3f&quot;</span><span class="p">,</span> <span class="s2">&quot;#8d2733&quot;</span><span class="p">,</span> <span class="s2">&quot;#800029&quot;</span><span class="p">,]),</span>
                      <span class="s2">&quot;norm&quot;</span><span class="p">:</span> <span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">13</span><span class="p">),</span>
                      <span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                     <span class="p">}</span>

<span class="c1"># Individual styles</span>
<span class="c1"># Set up like this so they can still be edited individually</span>
<span class="n">styles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Indexes</span>
    <span class="s2">&quot;SPI&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_spi</span><span class="p">),</span>  <span class="s2">&quot;SPI_diff&quot;</span><span class="p">:</span>  <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_spi_diff</span><span class="p">),</span>
    <span class="s2">&quot;SPEI&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_spei</span><span class="p">),</span> <span class="s2">&quot;SPEI_diff&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_spei_diff</span><span class="p">),</span>

    <span class="c1"># Quality flags</span>
    <span class="s2">&quot;probability&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_probability</span><span class="p">),</span> <span class="s2">&quot;probability_diff&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_probability_diff</span><span class="p">),</span>
    <span class="s2">&quot;flag_summed&quot;</span><span class="p">:</span> <span class="n">Style</span><span class="p">(</span><span class="o">**</span><span class="n">_style_flag_summed</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Apply general settings</span>
<span class="k">for</span> <span class="n">style</span> <span class="ow">in</span> <span class="n">styles</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">style</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following cell contains some base helper functions (e.g. displaying in Jupyter Notebook or Jupyter Book style, adding textboxes with consistent formatting, etc.):</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualisation: Helper functions, general</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">glue</span><span class="p">(</span><span class="n">glue_label</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">|</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Add a text box to each of the specified subplots. &quot;&quot;&quot;</span>
    <span class="c1"># Get the plt.Axes for each ekp.Subplot</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">subplot</span><span class="o">.</span><span class="n">ax</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Subplot</span><span class="p">)</span> <span class="k">else</span> <span class="n">subplot</span> <span class="k">for</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>

    <span class="c1"># Set up location</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.95</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="mf">0.05</span>
    <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span> <span class="k">if</span> <span class="n">right</span> <span class="k">else</span> <span class="s2">&quot;left&quot;</span>

    <span class="c1"># Add the text</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">horizontalalignment</span><span class="o">=</span><span class="n">horizontalalignment</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;boxstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span>
              <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_zero_line</span><span class="p">(</span><span class="o">*</span><span class="n">axs</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot the y=0 line with consistent styling. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions are also base helper functions, but specific to geospatial plots.
Administrative boundaries are downloaded from
the <em>Geographic Information System of the Commission</em> (GISCO)
through earthkit-plots,
and are ¬© EuroGeographics.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default geospatial domain</span>
<span class="c1"># To do: Use Robinson CRS but maintain aspect ratio</span>
<span class="n">DOMAIN_GLOBAL</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">Domain</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">)</span>
<span class="c1"># DOMAIN_GLOBAL = ekp.geo.domains.Domain.from_string(&quot;global&quot;, crs=ccrs.Robinson())</span>

<span class="c1"># Visualisation: Helper functions for geospatial plots</span>
<span class="k">def</span><span class="w"> </span><span class="nf">decorate_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">:</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Decorate an earthkit figure with land, coastlines, etc. &quot;&quot;&quot;</span>
    <span class="c1"># Add progress bar because individual steps can be very slow for large plots</span>
    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Decorating&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">progressbar</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">land</span><span class="p">()</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">borders</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;gisco&quot;</span><span class="p">)</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;grid.linestyle&quot;</span><span class="p">])</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">progressbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions handle visualisation of accumulated variables such as total precipitation and water balance:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main function: Plot any accumulated variable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_accumulated_variable</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">site</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">],</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                              <span class="n">accumulation_periods</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="n">ACCUMULATION_PERIODS</span><span class="p">,</span>
                              <span class="n">start_at_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot accumulated time series for variable `var` in multiple accumulation periods, in one `site`. &quot;&quot;&quot;</span>
    <span class="c1"># Select data in site</span>
    <span class="n">data_site</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">site</span><span class="p">)</span>
    
    <span class="c1"># Create figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Plot data for each accumulation period</span>
    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">accumulation_periods</span><span class="p">:</span>
        <span class="n">period_var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">data_site</span><span class="p">[</span><span class="n">period_var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">period</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> months&quot;</span><span class="p">)</span>
    
    <span class="c1"># Decorate figure</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_label</span><span class="si">}</span><span class="s2"> at (</span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">site</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> ¬∞E) accumulated over different periods&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accumulated </span><span class="si">{</span><span class="n">var_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Accumulation</span><span class="se">\n</span><span class="s2">period&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start_at_zero</span><span class="p">:</span>  <span class="c1"># Start y-axis at 0, e.g. for total precipitation</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>              <span class="c1"># If values can be + or -, show the 0-line clearly</span>
        <span class="n">plot_zero_line</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>      

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Plot tp, wb with preset names</span>
<span class="n">plot_accumulated_precipitation</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_accumulated_variable</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="n">start_at_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">var_label</span><span class="o">=</span><span class="s2">&quot;Total precipitation [mm]&quot;</span><span class="p">)</span>
<span class="n">plot_accumulated_waterbalance</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_accumulated_variable</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;wb&quot;</span><span class="p">,</span> <span class="n">start_at_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_label</span><span class="o">=</span><span class="s2">&quot;Water balance [mm]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions produce time series comparisons between datasets, such as reproduced vs. ERA5‚ÄìDrought SPI:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function: Display SPI / SPEI categories</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_index_categories</span><span class="p">(</span><span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Iterable</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Display SPI / SPEI categories (e.g. &quot;extreme drought&quot;) on an Axes panel. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">colour</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhspan</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>


<span class="c1"># Main function: Plot time series of absolute values (left) and differences (right)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_time_series_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                <span class="n">accumulation_periods</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="n">ACCUMULATION_PERIODS</span><span class="p">,</span>
                                <span class="n">var_categories</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># e.g. CATEGORIES_SPI</span>
                                <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot time series of one variable (e.g. SPI) in two datasets.</span>
<span class="sd">    Left column: Overlapping time series.</span>
<span class="sd">    Right column: Differences (data2 ‚Äì data1).</span>

<span class="sd">    One row for each accumulation period.</span>
<span class="sd">    `var` and `accumulation_periods` are provided manually, rather than inferred,</span>
<span class="sd">        to allow plotting of individual time series.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">data2</span> <span class="o">-</span> <span class="n">data1</span>
    <span class="n">difference_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Setup: Figure</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">accumulation_periods</span><span class="p">)</span>  <span class="c1"># Note: not checking if accumulation periods are actually present in data1, data2</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;wspace&quot;</span><span class="p">:</span> <span class="mf">0.07</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">2.7</span><span class="o">*</span><span class="n">nrows</span><span class="p">))</span>

    <span class="c1"># Setup: Styles for line plots</span>
    <span class="n">timeseries_kwargs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">label1</span><span class="p">},</span>
                         <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span> <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="s2">&quot;dotted&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">label2</span><span class="p">},</span>
                        <span class="p">]</span>

    <span class="c1"># Plot data</span>
    <span class="k">for</span> <span class="n">ax_row</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">accumulation_periods</span><span class="p">):</span>
        <span class="n">var_period</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Plot absolute time series</span>
        <span class="k">for</span> <span class="n">data</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">],</span> <span class="n">timeseries_kwargs</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">var_period</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">style</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Display categories and 0 line</span>
        <span class="n">plot_index_categories</span><span class="p">(</span><span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">var_categories</span><span class="p">)</span>
        <span class="n">plot_zero_line</span><span class="p">(</span><span class="o">*</span><span class="n">ax_row</span><span class="p">)</span>

        <span class="c1"># Plot difference</span>
        <span class="n">difference</span><span class="p">[</span><span class="n">var_period</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#004488&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">md</span>  <span class="o">=</span> <span class="n">nanmedian</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span>              <span class="n">difference</span><span class="p">[</span><span class="n">var_period</span><span class="p">]),</span>  <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="n">mad</span> <span class="o">=</span> <span class="n">nanmedian</span><span class="p">(</span><span class="n">ravel</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">difference</span><span class="p">[</span><span class="n">var_period</span><span class="p">])),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Œî: </span><span class="si">{</span><span class="n">md</span><span class="si">:</span><span class="s2">+.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">Median |Œî|: </span><span class="si">{</span><span class="n">mad</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        

    <span class="c1"># Decorate figure</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> values&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Difference (</span><span class="si">{</span><span class="n">difference_label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax_row</span><span class="p">,</span> <span class="n">period</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">accumulation_periods</span><span class="p">):</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ax_row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2"> difference&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Time series for </span><span class="si">{</span><span class="n">var</span><span class="si">}{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">()</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Plot SPI, SPEI with preset names</span>
<span class="n">plot_time_series_comparison_spi</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_time_series_comparison</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPI&quot;</span><span class="p">,</span>  <span class="n">var_categories</span><span class="o">=</span><span class="n">CATEGORIES_SPI</span><span class="p">)</span>
<span class="n">plot_time_series_comparison_spei</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_time_series_comparison</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPEI&quot;</span><span class="p">,</span> <span class="n">var_categories</span><span class="o">=</span><span class="n">CATEGORIES_SPEI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions produce confusion matrices for the SPI / SPEI categories, e.g. how many ‚Äúextremely dry‚Äù points in the reproduced dataset are also classified as ‚Äúextremely dry‚Äù in ERA5‚ÄìDrought:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main function: Plot confusion matrices with counts (text) and fractions (colour)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_confusion_matrices</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">var_categories</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Iterable</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span>  <span class="c1"># e.g. CATEGORIES_SPI</span>
                            <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                            <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot confusion matrices of categories for one variable (e.g. SPI &quot;extremely dry&quot;) in two datasets.</span>
<span class="sd">    One panel for each data_variable that occurs in both datasets and matches the variable `var`,</span>
<span class="sd">        e.g. different accumulation periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Align datasets</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">align_data_variables</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>  <span class="c1"># Ensure only matching variables</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>  <span class="c1"># Ensure only matching points</span>
    <span class="c1"># data1 = data1.transpose(*[dim for dim in data2.dims])  # Ensure same order of dimensions</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">point</span><span class="o">=</span><span class="n">data2</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>  <span class="c1"># Make 1D list</span>

    <span class="c1"># Apply categorisation</span>
    <span class="n">categories1</span><span class="p">,</span> <span class="n">categories2</span> <span class="o">=</span> <span class="p">[</span><span class="n">categorise_dataset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">var_categories</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>

    <span class="c1"># Create figure</span>
    <span class="n">n_categories</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_categories</span><span class="p">)</span>
    <span class="n">category_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_categories</span><span class="p">)</span>
    <span class="n">n_datavars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_datavars</span> <span class="o">//</span> <span class="n">ncols</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">nrows</span><span class="p">),</span>
                            <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hspace&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s2">&quot;wspace&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span> <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">)</span>

    <span class="c1"># Loop over data variables</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data_var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
        <span class="c1"># Create confusion matrix from categorisation values</span>
        <span class="n">matrix_absolute</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">categories1</span><span class="p">[</span><span class="n">data_var</span><span class="p">],</span> <span class="n">categories2</span><span class="p">[</span><span class="n">data_var</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">category_index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">matrix_relative</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">categories1</span><span class="p">[</span><span class="n">data_var</span><span class="p">],</span> <span class="n">categories2</span><span class="p">[</span><span class="n">data_var</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">category_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>  <span class="c1"># Normalised by rows (data1)</span>
        <span class="c1"># For operational code, you would add an assert here to check that the sum of elements in matrix_absolute</span>
        <span class="c1"># corresponds to the number of not-NaN elements of the input data</span>

        <span class="c1"># Plot fractions for color background</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">matrix_relative</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="o">.</span><span class="n">resampled</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

        <span class="c1"># Annotate with absolute counts</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">category_index</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">category_index</span><span class="p">:</span>
                <span class="n">counts_abs</span><span class="p">,</span> <span class="n">counts_rel</span> <span class="o">=</span> <span class="n">matrix_absolute</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">matrix_relative</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">counts_abs</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>  <span class="c1"># Add text</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span> <span class="k">if</span> <span class="n">counts_rel</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>       <span class="c1"># Colour based on background</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                             <span class="c1"># Text settings</span>

        <span class="c1"># Label based on data variable, adding a hyphen</span>
        <span class="n">data_var_hyphenated</span> <span class="o">=</span> <span class="n">data_var</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">var</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">data_var_hyphenated</span><span class="p">)</span>

    <span class="c1"># Add category labels</span>
    <span class="n">category_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">var_categories</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">category_index</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">category_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">category_index</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">category_labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_inverted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Add a single shared colorbar showing row-wise fraction</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span><span class="c1"># shrink=0.6)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraction of </span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> data (rows)&quot;</span><span class="p">)</span>

    <span class="c1"># Hide extra panels if odd number of variables</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">n_datavars</span><span class="p">:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Decorate figure</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Confusion matrices for </span><span class="si">{</span><span class="n">var</span><span class="si">}{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="n">label2</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="n">label1</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>


<span class="c1"># Plot SPI, SPEI with preset names</span>
<span class="n">plot_confusion_matrices_spi</span>  <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_confusion_matrices</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPI&quot;</span><span class="p">,</span>  <span class="n">var_categories</span><span class="o">=</span><span class="n">CATEGORIES_SPI</span><span class="p">)</span>
<span class="n">plot_confusion_matrices_spei</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">plot_confusion_matrices</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPEI&quot;</span><span class="p">,</span> <span class="n">var_categories</span><span class="o">=</span><span class="n">CATEGORIES_SPEI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions display geospatial comparisons between index values:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main function: Plot maps of absolute values (left, middle) and differences (right)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_geospatial_comparison</span><span class="p">(</span><span class="n">data1</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">data2</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                               <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                               <span class="n">domain</span><span class="p">:</span> <span class="n">AnyDomain</span><span class="o">=</span><span class="n">DOMAIN_GLOBAL</span><span class="p">,</span>
                               <span class="n">time_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span>
                               <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot geospatial views of categories for one variable (e.g. SPI &quot;extremely dry&quot;) in two datasets.</span>
<span class="sd">    One panel for each data_variable that occurs in both datasets and matches the variable `var`,</span>
<span class="sd">        e.g. different accumulation periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select data for one timestamp</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="n">time_dimension</span><span class="p">:</span> <span class="n">time</span><span class="p">})</span>
                    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)]</span>

    <span class="c1"># Only look at variables that are in both datasets</span>
    <span class="c1"># Note: Not checking for matching coordinates / xr.align</span>
    <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span> <span class="o">=</span> <span class="n">align_data_variables</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>

    <span class="c1"># Calculate difference</span>
    <span class="n">difference</span> <span class="o">=</span> <span class="n">data2</span> <span class="o">-</span> <span class="n">data1</span>
    <span class="n">difference_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Setup: Figure</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># data1, data2, diff</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mf">3.7</span><span class="o">*</span><span class="n">nrows</span><span class="p">))</span>

    <span class="c1"># Loop over variables (e.g. accumulation periods)</span>
    <span class="k">for</span> <span class="n">data_var</span> <span class="ow">in</span> <span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="c1"># Plot index</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">):</span>
            <span class="n">subplot</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
            <span class="n">subplot</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">data_var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>

        <span class="c1"># Plot difference</span>
        <span class="n">subplot_diff</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
        <span class="n">subplot_diff</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">difference</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">data_var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="n">var</span><span class="o">+</span><span class="s2">&quot;_diff&quot;</span><span class="p">])</span>

    <span class="c1"># Label dataset at the top</span>
    <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">[:</span><span class="n">ncols</span><span class="p">],</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">,</span> <span class="n">difference_label</span><span class="p">]):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="c1"># Label indicator in the corner</span>
    <span class="k">for</span> <span class="n">subplots</span><span class="p">,</span> <span class="n">data_var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">batched</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">data2</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
        <span class="n">data_var_hyphenated</span> <span class="o">=</span> <span class="n">INDEXES_NAMED</span><span class="p">[</span><span class="n">data_var</span><span class="p">]</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">data_var_hyphenated</span><span class="p">,</span> <span class="o">*</span><span class="n">subplots</span><span class="p">)</span>

    <span class="c1"># Legend at the bottom</span>
    <span class="k">for</span> <span class="n">subplot</span> <span class="ow">in</span> <span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">[</span><span class="o">-</span><span class="n">ncols</span><span class="p">:]:</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>

    <span class="c1"># Decorate figure</span>
    <span class="n">time_for_title</span> <span class="o">=</span> <span class="n">time</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span> <span class="c1"># Could be changed to proper datetime format, e.g. %B %Y</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Geospatial comparison for </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">domain</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">time_for_title</span><span class="si">}</span><span class="s2">)</span><span class="si">{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">decorate_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>The following functions display geospatial comparisons between quality flags:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main function: Plot maps of absolute values (left, middle) and differences (right)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="n">var</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                             <span class="n">probabilities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]]]</span><span class="o">=</span><span class="p">{},</span>  <span class="c1"># e.g. p0</span>
                                             <span class="n">masks</span><span class="p">:</span>         <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]]]</span><span class="o">=</span><span class="p">{},</span>  <span class="c1"># e.g. p0 &lt; 0.33 or alpha &gt; 0.05</span>
                                             <span class="n">label1</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;ERA5‚ÄìDrought&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;Reproduced&quot;</span><span class="p">,</span> <span class="n">title_suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                             <span class="n">example_month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># e.g. 12 for December</span>
                                             <span class="n">flag_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                             <span class="n">domain</span><span class="p">:</span> <span class="n">AnyDomain</span><span class="o">=</span><span class="n">DOMAIN_GLOBAL</span><span class="p">,</span> <span class="n">shared_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">month_dimension</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
                                             <span class="n">glue_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot geospatial views of pre-calculated quality flags in two datasets.</span>
<span class="sd">    probabilities are datasets with quality flag probabilities.</span>
<span class="sd">        These are ingested as a dict with str keys (the label for that mask) and an Iterable of xr.Datasets.</span>
<span class="sd">        These are displayed for variable `var` (e.g. tp3, SPEI3) in `example_month` (e.g. 12).</span>
<span class="sd">    masks created from the quality flags can be included, e.g. where p0 &lt;= 0.33.</span>
<span class="sd">        These are ingested as a dict with str keys (the label for that mask) and an Iterable of xr.Datasets.</span>
<span class="sd">        Following Keune+25 Fig 3, masks are displayed as their sum over all 12 months (left, middle)</span>
<span class="sd">        as well as the number of mismatched months (right).</span>
<span class="sd">    An additional `shared_mask`, e.g. a land-sea mask, can be applied to all panels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Setup: Labels</span>
    <span class="n">difference_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="s2"> ‚Äì </span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Setup: Types of data to plot</span>
    <span class="n">n_probabilities</span><span class="p">,</span> <span class="n">n_masks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">probabilities</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">masks</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">n_probabilities</span> <span class="ow">or</span> <span class="n">n_masks</span><span class="p">,</span> <span class="s2">&quot;No data provided to plot_geospatial_comparison_quality_flags.&quot;</span>

    <span class="c1"># Setup: Figure</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">n_probabilities</span> <span class="o">+</span> <span class="n">n_masks</span>  <span class="c1"># 1 each per probability (generally 0 or 1) + 1 each per mask</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># data1, data2, diff</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">nrows</span><span class="p">)</span> <span class="k">if</span> <span class="n">domain</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Global&quot;</span> <span class="k">else</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">ncols</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">+</span><span class="mf">3.7</span><span class="o">*</span><span class="n">nrows</span><span class="p">)</span>  <span class="c1"># Adjust aspect ratio for global plots</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="c1"># Plot probabilities (if any)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">list_of_datasets</span> <span class="ow">in</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Select data for one month</span>
        <span class="k">assert</span> <span class="n">example_month</span> <span class="ow">in</span> <span class="n">MONTHS</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Cannot use example month `</span><span class="si">{</span><span class="n">example_month</span><span class="si">}</span><span class="s2">`; please use a number from 1 through 12.&quot;</span>
        <span class="n">month_label</span> <span class="o">=</span> <span class="n">MONTHS_NAMED</span><span class="p">[</span><span class="n">example_month</span><span class="p">]</span>
        <span class="n">list_of_datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">prob</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="n">month_dimension</span><span class="p">:</span> <span class="n">example_month</span><span class="p">})</span> <span class="k">for</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">list_of_datasets</span><span class="p">]</span>

        <span class="c1"># Calculate difference</span>
        <span class="n">probability_difference</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ufuncs</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="o">*</span><span class="n">list_of_datasets</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># data2 - data1</span>

        <span class="c1"># Create and fill panels</span>
        <span class="n">subplots</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subplots</span><span class="p">,</span> <span class="n">list_of_datasets</span><span class="p">):</span>
            <span class="n">subplot</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">shared_mask</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="s2">&quot;probability&quot;</span><span class="p">])</span>
        <span class="n">subplots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">probability_difference</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">shared_mask</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="s2">&quot;probability_diff&quot;</span><span class="p">])</span>

        <span class="c1"># Add colour bars</span>
        <span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">month_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">subplots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="c1"># Plot masks (if any)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">list_of_datasets</span> <span class="ow">in</span> <span class="n">masks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Create and fill panels</span>
        <span class="n">subplots</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">add_map</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span>

        <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">mask</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subplots</span><span class="p">,</span> <span class="n">list_of_datasets</span><span class="p">):</span>
            <span class="c1"># Add up per month and invert (to get number of *flagged* rather than *allowed* points)</span>
            <span class="n">flagged_months</span> <span class="o">=</span> <span class="n">count_flagged_months</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

            <span class="c1"># Plot</span>
            <span class="n">subplot</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">flagged_months</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">shared_mask</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="s2">&quot;flag_summed&quot;</span><span class="p">])</span>

        <span class="c1"># Find and plot mismatched months</span>
        <span class="n">mask1</span><span class="p">,</span> <span class="n">mask2</span> <span class="o">=</span> <span class="n">list_of_datasets</span>
        <span class="n">masks_not_matching</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask1</span> <span class="o">!=</span> <span class="n">mask2</span><span class="p">)</span>
        <span class="n">months_not_matching</span> <span class="o">=</span> <span class="n">count_flagged_months</span><span class="p">(</span><span class="n">masks_not_matching</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">subplots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid_cells</span><span class="p">(</span><span class="n">months_not_matching</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">shared_mask</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">styles</span><span class="p">[</span><span class="s2">&quot;flag_summed&quot;</span><span class="p">])</span>

        <span class="c1"># Add colour bars</span>
        <span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Flagged months&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">subplots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mismatched months&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

        <span class="c1"># Label masks in the corner</span>
        <span class="n">_add_textbox_to_subplots</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">*</span><span class="n">subplots</span><span class="p">)</span>

    <span class="c1"># Label dataset at the top</span>
    <span class="k">for</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots</span><span class="p">[:</span><span class="n">ncols</span><span class="p">],</span> <span class="p">[</span><span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">,</span> <span class="n">difference_label</span><span class="p">]):</span>
        <span class="n">subplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="c1"># Decorate figure</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">INDEXES_NAMED</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">INDEXES_NAMED</span> <span class="k">else</span> <span class="n">var</span>  <span class="c1"># e.g. SPI1 to SPI-1, if possible</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label1</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="n">label2</span><span class="si">}</span><span class="se">\n</span><span class="s2">Geospatial comparison of </span><span class="si">{</span><span class="n">flag_label</span><span class="si">}</span><span class="se">\n</span><span class="s2">(</span><span class="si">{</span><span class="n">domain</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">)</span><span class="si">{</span><span class="n">title_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">decorate_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Show result</span>
    <span class="n">_glue_or_show</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">glue_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
</section>
<section id="general-setup">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"></span><h3>2. General setup<a class="headerlink" href="#general-setup" title="Link to this heading">#</a></h3>
<p>This section provides some of the setup for the further analysis,
including
the timespan and sites to investigate
as well as
the CDS data downloads.
This ensures that the following sections
(SPI, SPEI, etc.)
can be run independently.</p>
<section id="analysis-setup">
<h4>2.1 Analysis setup<a class="headerlink" href="#analysis-setup" title="Link to this heading">#</a></h4>
<p>In this assessment,
we will calculate SPI and SPEI for the years 1940‚Äì2024.
For the reference period,
we will use the World Meteorological Organization (WMO) current standard 30-year reference period of 1991‚Äì2020,
which is also used in ERA5‚ÄìDrought.
Both of these date ranges can be adjusted in the cell below when running the analysis yourself:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define your preferred analysis and reference periods</span>
<span class="n">years</span>           <span class="o">=</span> <span class="p">(</span><span class="mi">1940</span><span class="p">,</span> <span class="mi">2024</span><span class="p">)</span>  <span class="c1"># Years for the analysis (inclusive)</span>
<span class="n">years_reference</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">2020</span><span class="p">)</span>  <span class="c1"># Years for the reference period (inclusive)</span>
<span class="n">year_snapshot</span>   <span class="o">=</span> <span class="mi">2024</span>          <span class="c1"># Year for example region geospatial analysis</span>

<span class="c1"># Derived variables for convenience:</span>
<span class="n">reference_window</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">years_reference</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">years_reference</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">),}</span>  <span class="c1">#  Slice (1991-01-01, 2020-12-01)</span>
<span class="n">entire_window</span>    <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">years</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">),}</span>            <span class="c1">#  Slice (1940-01-01, 2024-12-01)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Some parts of the analysis will be performed globally, others in specific sites for computational reasons.
This notebook uses Addis Ababa in Ethiopia (9.00 ¬∞N, 38.75 ¬∞E) and the Horn of Africa region around it as an example;
a different site can be chosen when running the notebook yourself by editing the cell below:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define your preferred site for the time series analysis</span>
<span class="n">example_site</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="mf">9.00</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="mf">38.75</span><span class="p">}</span>  <span class="c1"># Compatible with ERA5‚ÄìDrought and pre-processed ERA5 data</span>

<span class="c1"># Define the size and name of the surrounding region</span>
<span class="n">example_region_size</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># Degrees to either side of the example side</span>
<span class="n">label_region</span> <span class="o">=</span> <span class="s2">&quot;Horn of Africa&quot;</span>

<span class="c1"># Derived variables for convenience</span>
<span class="c1"># Example site</span>
<span class="n">label_site</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">example_site</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ¬∞N, </span><span class="si">{</span><span class="n">example_site</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ¬∞E)&quot;</span>
<span class="n">request_site</span> <span class="o">=</span> <span class="n">request_data_for_one_site</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Example region</span>
<span class="n">example_region</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">example_site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">example_region_size</span><span class="p">,</span> <span class="n">example_site</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">example_region_size</span><span class="p">),</span>  <span class="c1"># Decreasing order</span>
                  <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">example_site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">example_region_size</span><span class="p">,</span> <span class="n">example_site</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">example_region_size</span><span class="p">),}</span> <span class="c1"># Increasing order</span>
<span class="n">request_region</span> <span class="o">=</span> <span class="n">request_data_for_one_site</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">,</span> <span class="n">half_width</span><span class="o">=</span><span class="n">example_region_size</span><span class="p">)</span>
<span class="n">domain_region</span> <span class="o">=</span> <span class="n">ekp</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">domains</span><span class="o">.</span><span class="n">Domain</span><span class="p">(</span>
    <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="n">example_region</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">example_region</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">example_region</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">example_region</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="n">label_region</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="cds-download-setup">
<h4>2.2 CDS download setup<a class="headerlink" href="#cds-download-setup" title="Link to this heading">#</a></h4>
<p>Having defined our target years, we can now define our CDS request.
First, we define templates with some default parameters
(e.g. years, data format)
that will also be used later in the notebook.
Additional information for specific downloads
(e.g. variable, data stream)
is mixed into this template where relevant.</p>
<p>This notebook uses <a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a> to download files from the CDS.
If you intend to run this notebook multiple times, it is highly recommended that you <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/caching.html" rel="noreferrer" target="_blank">enable caching</a> to prevent having to download the same files multiple times.
If you prefer not to use earthkit, the following requests can also be used with the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api#linux-use-client-step" rel="noreferrer" target="_blank">cdsapi module</a>.
In either case (earthkit-data or cdsapi), it is required to set up a CDS account and API key as explained <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api" rel="noreferrer" target="_blank">on the CDS website</a>.</p>
<section id="era5">
<h5>ERA5<a class="headerlink" href="#era5" title="Link to this heading">#</a></h5>
<p>We start by setting up a template for requests from the <a class="reference external" href="https://doi.org/10.24381/cds.143582cf" rel="noreferrer" target="_blank"><em>Complete ERA5 global atmospheric reanalysis</em></a> dataset, from which we will obtain precipitation and (for SPEI) potential evapotranspiration:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ID_ERA5</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-complete&quot;</span>

<span class="n">request_era5_template</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;ea&quot;</span><span class="p">,</span>            <span class="c1"># Default for ERA5</span>
    <span class="c1"># Dates: ERA5 takes these in the format 19400101/19400201/.../20241101/20241201</span>
    <span class="c1"># The following lines generate a string in said format for the chosen year range</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}{</span><span class="n">month</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">01&quot;</span>                    <span class="c1"># yyyymm01 format</span>
                     <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">years</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># All years in specified range, inclusive</span>
                     <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">MONTHS</span><span class="p">),</span>                    <span class="c1"># All calendar months</span>
    <span class="s2">&quot;expver&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>            <span class="c1"># ERA5 consolidated data</span>
    <span class="s2">&quot;levtype&quot;</span><span class="p">:</span> <span class="s2">&quot;sfc&quot;</span><span class="p">,</span>         <span class="c1"># Surface</span>
    <span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="s2">&quot;0.25/0.25&quot;</span><span class="p">,</span>      <span class="c1"># Grid: 0.25¬∞ by 0.25¬∞ (interpolated from native)</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;fc&quot;</span><span class="p">,</span>             <span class="c1"># Forecast</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>  <span class="c1"># NetCDF data</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="era5drought">
<h5>ERA5‚ÄìDrought<a class="headerlink" href="#era5drought" title="Link to this heading">#</a></h5>
<p>We also set up a template for requests from ERA5‚ÄìDrought (<a class="reference external" href="https://doi.org/10.24381/9bea5e16" rel="noreferrer" target="_blank"><em>Monthly drought indices from 1940 to present derived from ERA5 reanalysis</em></a>):</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ID_ERA5_DROUGHT</span> <span class="o">=</span> <span class="s2">&quot;derived-drought-historical-monthly&quot;</span>

<span class="c1"># General request template</span>
<span class="n">request_era5drought_template</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1_0&quot;</span><span class="p">,</span>                                <span class="c1"># Current version</span>
    <span class="s2">&quot;dataset_type&quot;</span><span class="p">:</span> <span class="s2">&quot;consolidated_dataset&quot;</span><span class="p">,</span>          <span class="c1"># Only use consolidated data, i.e. not ERA5T-derived</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;reanalysis&quot;</span><span class="p">],</span>                  <span class="c1"># Reanalysis by default, can be overridden in ensemble section</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">MONTHS</span><span class="p">],</span>   <span class="c1"># All calendar months</span>
<span class="p">}</span>

<span class="c1"># Request for SPI or SPEI data</span>
<span class="n">request_era5drought_index</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;accumulation_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">years</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>    
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_template</span>

<span class="c1"># Request for quality flags</span>
<span class="n">request_era5drought_flag</span> <span class="o">=</span> <span class="n">request_era5drought_template</span>

<span class="c1"># Request for SPI/SPEI ensemble data</span>
<span class="n">request_era5drought_index_ensemble</span> <span class="o">=</span> <span class="n">request_era5drought_index</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ensemble_members&quot;</span><span class="p">],}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-land-sea-mask">
<h4>2.3 Download land-sea mask<a class="headerlink" href="#download-land-sea-mask" title="Link to this heading">#</a></h4>
<p>ERA5‚ÄìDrought uses a land-sea mask to only provide values over land.
Here, we download the <a class="reference external" href="https://confluence.ecmwf.int/display/FUG/Section+2.1.3.1+Land-Sea+Mask" rel="noreferrer" target="_blank">ERA5 land-sea mask</a> from the <a class="reference external" href="https://doi.org/10.24381/cds.adbb2d47" rel="noreferrer" target="_blank"><em>ERA5 hourly data on single levels from 1940 to present</em></a> dataset:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ID_ERA5_LANDSEAMASK</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span>

<span class="n">request_landsea_mask</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;land_sea_mask&quot;</span><span class="p">,</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span>  <span class="c1"># Does nothing but is required in CDS form</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>       <span class="c1"># Does nothing but is required in CDS form</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Download mask</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_LANDSEAMASK</span><span class="p">,</span> <span class="n">request_landsea_mask</span><span class="p">)</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="n">LAND</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>

<span class="c1"># Convert longitude from 0..360 to ‚Äì180..180</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="n">rename_era5_dimensions</span><span class="p">(</span><span class="n">LAND</span><span class="p">)</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="n">longitude_360_to_180</span><span class="p">(</span><span class="n">LAND</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">)</span>

<span class="c1"># Drop time dimension</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="n">LAND</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="c1"># Convert to boolean mask: Land if &gt; 0.5 (following ERA5 convention)</span>
<span class="n">LAND</span> <span class="o">=</span> <span class="p">(</span><span class="n">LAND</span><span class="p">[</span><span class="s2">&quot;lsm&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="c1"># Land considered to be full</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="spi-comparison">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-spi"></span><h3>3. SPI comparison<a class="headerlink" href="#spi-comparison" title="Link to this heading">#</a></h3>
<section id="download-monthly-precipitation-data-from-era5">
<h4>3.1 Download monthly precipitation data from ERA5<a class="headerlink" href="#download-monthly-precipitation-data-from-era5" title="Link to this heading">#</a></h4>
<p>First, the monthly-mean total precipitation data from the ERA5 reanalysis are downloaded.
Generally, one would use the <a class="reference external" href="https://doi.org/10.24381/cds.f17050d7" rel="noreferrer" target="_blank"><em>ERA5 monthly averaged data on single levels from 1940 to present</em></a> dataset for this, which provides pre-calculated monthly means at 0.25¬∞ by 0.25¬∞ resolution.
For this assessment,
to be as close to the ERA5‚ÄìDrought data processing pipeline as possible
and
to make use of some of MARS‚Äôs functionalities (see <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-ensemble"><span class="std std-ref">5. Ensemble comparison</span></a>),
we instead use the <a class="reference external" href="https://doi.org/10.24381/cds.143582cf" rel="noreferrer" target="_blank"><em>Complete ERA5 global atmospheric reanalysis</em></a> dataset.</p>
<p>We want to download
total precipitation data (variable <code class="docutils literal notranslate"><span class="pre">228.128</span></code>)
from the
<code class="docutils literal notranslate"><span class="pre">moda</span></code> stream (monthly-mean reanalysis data),
so we mix this information into the request template set up <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">previously</span></a>
and submit the request to the CDS.
More information about the format for these requests is available in the <a class="reference external" href="https://apps.ecmwf.int/data-catalogues/era5/?class=ea" rel="noreferrer" target="_blank">MARS ERA5 catalogue</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_era5_precipitation_moda</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;param&quot;</span><span class="p">:</span> <span class="s2">&quot;228.128&quot;</span><span class="p">,</span>  <span class="c1"># Variable: Total precipitation</span>
    <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;moda&quot;</span><span class="p">,</span>    <span class="c1"># Data stream: Monthly mean reanalysis</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5_template</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data and load into xarray</span>
<span class="n">data_era5_precipitation_cds</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5</span><span class="p">,</span> <span class="n">request_era5_precipitation_moda</span><span class="p">)</span>  <span class="c1"># Download as field list</span>
<span class="n">data_era5_precipitation_cds</span> <span class="o">=</span> <span class="n">data_era5_precipitation_cds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>

<span class="c1"># Pre-process to desired format</span>
<span class="c1"># Note the change in variable name</span>
<span class="n">data_era5_precipitation_preprocessed</span> <span class="o">=</span> <span class="n">preprocess_era5</span><span class="p">(</span><span class="n">data_era5_precipitation_cds</span><span class="p">)</span>

<span class="c1"># Display in notebook</span>
<span class="n">data_era5_precipitation_preprocessed</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 4GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B ...
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
Data variables:
    tp       (time, lat, lon) float32 4GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7625b7e6-3d60-4faf-918d-a16825822fdb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7625b7e6-3d60-4faf-918d-a16825822fdb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2d61845a-3386-4327-855e-74d7775d147e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2d61845a-3386-4327-855e-74d7775d147e' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-83853de2-da63-4967-86c2-3c2a7a98adb1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-83853de2-da63-4967-86c2-3c2a7a98adb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24c3f053-23fb-4722-8e4d-ca37878cc6fe' class='xr-var-data-in' type='checkbox'><label for='data-24c3f053-23fb-4722-8e4d-ca37878cc6fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-cb7fb293-636d-4576-9732-3360c7fbce2c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb7fb293-636d-4576-9732-3360c7fbce2c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d704bf25-b468-40fa-b9db-edf3c5ac930d' class='xr-var-data-in' type='checkbox'><label for='data-d704bf25-b468-40fa-b9db-edf3c5ac930d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-3e1aafc2-ac60-4ca0-8957-5e82c44d43d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3e1aafc2-ac60-4ca0-8957-5e82c44d43d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81ae6b5e-4a6e-47f9-8434-9dc52d39f801' class='xr-var-data-in' type='checkbox'><label for='data-81ae6b5e-4a6e-47f9-8434-9dc52d39f801' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-f4605afa-9ba2-4ce6-9717-d9531a5eaecc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4605afa-9ba2-4ce6-9717-d9531a5eaecc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a369bf31-db23-4da3-bb4e-17455bd29e78' class='xr-var-data-in' type='checkbox'><label for='data-a369bf31-db23-4da3-bb4e-17455bd29e78' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-49b14cf5-c3c6-469c-b387-b8b1c4150d90' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49b14cf5-c3c6-469c-b387-b8b1c4150d90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40f7c91c-e2ba-40a3-9b6f-435eaca8f538' class='xr-var-data-in' type='checkbox'><label for='data-40f7c91c-e2ba-40a3-9b6f-435eaca8f538' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-07819eaf-7f76-48b4-832a-0c1eea20e869' class='xr-section-summary-in' type='checkbox'  checked><label for='section-07819eaf-7f76-48b4-832a-0c1eea20e869' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-0f26b773-4f59-46d4-8a64-400301d33d61' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0f26b773-4f59-46d4-8a64-400301d33d61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-361275a3-aece-4958-a8a4-10e07d993581' class='xr-var-data-in' type='checkbox'><label for='data-361275a3-aece-4958-a8a4-10e07d993581' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>228</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgad</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>359.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total precipitation</dd><dt><span>GRIB_shortName :</span></dt><dd>tp</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>units :</span></dt><dd>mm</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.95 GiB </td>
                        <td> 144.28 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-7e71bd9a-27cc-43b9-9ed8-31439f5de68d' class='xr-section-summary-in' type='checkbox'  ><label for='section-7e71bd9a-27cc-43b9-9ed8-31439f5de68d' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-076dd642-a18a-4426-bd34-758cde4b7345' class='xr-index-data-in' type='checkbox'/><label for='index-076dd642-a18a-4426-bd34-758cde4b7345' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0770dac7-539d-4f74-a02c-a9ae6b3c6118' class='xr-index-data-in' type='checkbox'/><label for='index-0770dac7-539d-4f74-a02c-a9ae6b3c6118' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8a679cf0-3f03-4691-9367-144e3fde8ef1' class='xr-index-data-in' type='checkbox'/><label for='index-8a679cf0-3f03-4691-9367-144e3fde8ef1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-57c4f32f-dd46-4bdb-9b2d-f33da28a93c9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-57c4f32f-dd46-4bdb-9b2d-f33da28a93c9' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="calculate-total-precipitation-over-accumulation-periods">
<h4>3.2 Calculate total precipitation over accumulation periods<a class="headerlink" href="#calculate-total-precipitation-over-accumulation-periods" title="Link to this heading">#</a></h4>
<p>As explained above,
SPI and SPEI are commonly evaluated over different accumulation periods.
ERA5‚ÄìDrought provides both indices for periods of 1, 3, 6, 12, 24, 36, and 48 months.
Here, we perform this accumulation by calculating the total precipitation over the previous <em>p</em> months
at every coordinate and timestamp in the ERA5 data,
for each accumulation period <em>p</em>.
The implementation used here
(which can be found in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"><span class="std std-ref">1. Code setup</span></a>)
accounts for the variable number of days in each month,
including leap years.</p>
<p>The resulting accumulated time series for the site defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>,
Addis Ababa in Ethiopia in our example,
are displayed in Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-tp-accumulated"><span class="std std-numref">6.1.1</span></a>.
This example clearly shows how shorter accumulation periods probe short-term effects such as seasonality,
which are smoothed out in longer periods.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accumulate total precipitation</span>
<span class="n">data_era5_precipitation</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">data_era5_precipitation_preprocessed</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">data_era5_precipitation</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B ...
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
Data variables:
    tp1      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp3      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp6      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp12     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp24     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp36     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp48     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-749666af-8090-4691-9a09-8254ac69018a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-749666af-8090-4691-9a09-8254ac69018a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-1c221131-f810-41a8-832c-6a93b5e26e9d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1c221131-f810-41a8-832c-6a93b5e26e9d' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bb353cb5-9bb9-4bc5-b72e-41368c43989a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb353cb5-9bb9-4bc5-b72e-41368c43989a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a82a6895-65d5-4c6f-9fcf-1de2431f90ba' class='xr-var-data-in' type='checkbox'><label for='data-a82a6895-65d5-4c6f-9fcf-1de2431f90ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-c96e16e6-adce-4d55-b585-2d50f64e49c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c96e16e6-adce-4d55-b585-2d50f64e49c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-485479f1-45f8-4de6-9134-021c2e26913a' class='xr-var-data-in' type='checkbox'><label for='data-485479f1-45f8-4de6-9134-021c2e26913a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-d14d732d-1df1-410c-87dc-68ea276bf44d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d14d732d-1df1-410c-87dc-68ea276bf44d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba2b61bc-bc89-4aee-8288-35775018cdab' class='xr-var-data-in' type='checkbox'><label for='data-ba2b61bc-bc89-4aee-8288-35775018cdab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-a174b927-d9bb-49c9-aeab-58f45e429c7b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a174b927-d9bb-49c9-aeab-58f45e429c7b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84e111ae-1ae9-4648-ba5b-b0483759c41c' class='xr-var-data-in' type='checkbox'><label for='data-84e111ae-1ae9-4648-ba5b-b0483759c41c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-db7eb4fd-3a32-4598-bf59-fe22d8c57dce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db7eb4fd-3a32-4598-bf59-fe22d8c57dce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f04bcf3a-75e8-4724-bebe-3a1d00383353' class='xr-var-data-in' type='checkbox'><label for='data-f04bcf3a-75e8-4724-bebe-3a1d00383353' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b992f15f-5d91-450a-8e4d-58e0e2d2f44e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b992f15f-5d91-450a-8e4d-58e0e2d2f44e' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-b96f6657-6f58-4f35-bdbc-4219630387fe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b96f6657-6f58-4f35-bdbc-4219630387fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5eba3493-0b47-466f-969e-b134a12dfabb' class='xr-var-data-in' type='checkbox'><label for='data-5eba3493-0b47-466f-969e-b134a12dfabb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 20 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-a6054af5-a156-4551-9fa9-dcd2dd9178f9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a6054af5-a156-4551-9fa9-dcd2dd9178f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-edbcc6ba-04b9-4f2c-a312-c6fa0e0a9b63' class='xr-var-data-in' type='checkbox'><label for='data-edbcc6ba-04b9-4f2c-a312-c6fa0e0a9b63' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-195a6a1d-b590-4c37-bb47-234147fa1f00' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-195a6a1d-b590-4c37-bb47-234147fa1f00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0ea1d0f-a5a7-4953-b215-e0245e38358a' class='xr-var-data-in' type='checkbox'><label for='data-c0ea1d0f-a5a7-4953-b215-e0245e38358a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-324e956d-4cab-493b-ae1f-47b1707fa73c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-324e956d-4cab-493b-ae1f-47b1707fa73c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb53dbeb-b18a-4034-8939-af609c87fc13' class='xr-var-data-in' type='checkbox'><label for='data-cb53dbeb-b18a-4034-8939-af609c87fc13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-e73317ab-7905-4068-8ebe-1b73a7c9de68' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e73317ab-7905-4068-8ebe-1b73a7c9de68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c9d143c-873b-4eea-a66b-0ae6e3630288' class='xr-var-data-in' type='checkbox'><label for='data-8c9d143c-873b-4eea-a66b-0ae6e3630288' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-1d263a8c-9ec3-4df7-8fda-e7653fc55717' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1d263a8c-9ec3-4df7-8fda-e7653fc55717' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b034c74-6896-4819-8ef0-f87764e499a7' class='xr-var-data-in' type='checkbox'><label for='data-8b034c74-6896-4819-8ef0-f87764e499a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-d65b48b9-7642-4090-a820-e03b806d9739' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d65b48b9-7642-4090-a820-e03b806d9739' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5aa6ab43-c4ae-45e3-be07-df54fc470d19' class='xr-var-data-in' type='checkbox'><label for='data-5aa6ab43-c4ae-45e3-be07-df54fc470d19' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 30 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-104739c6-e493-42c4-b757-765a40f14826' class='xr-section-summary-in' type='checkbox'  ><label for='section-104739c6-e493-42c4-b757-765a40f14826' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-941127cc-86a0-4eee-95cd-0d4936c2ead7' class='xr-index-data-in' type='checkbox'/><label for='index-941127cc-86a0-4eee-95cd-0d4936c2ead7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ab4040af-d7d4-4cbf-bd87-6c8be9709dcb' class='xr-index-data-in' type='checkbox'/><label for='index-ab4040af-d7d4-4cbf-bd87-6c8be9709dcb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cd9d397d-cfe6-4912-84dd-d95f9902d7be' class='xr-index-data-in' type='checkbox'/><label for='index-cd9d397d-cfe6-4912-84dd-d95f9902d7be' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4cec55b7-66c9-4f17-9050-d18bcdcf9d73' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4cec55b7-66c9-4f17-9050-d18bcdcf9d73' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display accumulated precipitation at example site</span>
<span class="n">plot_accumulated_precipitation</span><span class="p">(</span><span class="n">data_era5_precipitation</span><span class="p">,</span> <span class="n">example_site</span><span class="p">,</span>
                               <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-tp-accumulated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-tp-accumulated">
<img alt="../_images/5f6088c45f2fe40112576ed4662bce63cd4ad56eb86d9dc7c9df6bb3c4edadaf.png" src="../_images/5f6088c45f2fe40112576ed4662bce63cd4ad56eb86d9dc7c9df6bb3c4edadaf.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.1 </span><span class="caption-text">Total precipitation from ERA5 accumulated over different periods, for the example site of Addis Ababa, Ethiopia.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-tp-accumulated" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="fit-gamma-distribution-by-calendar-month">
<h4>3.3 Fit gamma distribution by calendar month<a class="headerlink" href="#fit-gamma-distribution-by-calendar-month" title="Link to this heading">#</a></h4>
<p>At the core of SPI is the assumption that (monthly) total precipitation values follow a gamma distribution.
Here, this distribution is fitted to data within the reference period (1991‚Äì2020 by default, see above).
A separate distribution is fitted for each calendar month,
i.e.
we fit one distribution for all 30 Januaries in the reference period,
another for all 30 Februaries,
and so on.
This separation allows the resulting index to account for seasonal differences.
This fitting process is then repeated for each accumulation period.</p>
<p>Here, we use
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.gamma.html" rel="noreferrer" target="_blank">scipy.stats.gamma</a>
to fit the gamma distribution.
This returns three parameters for each calendar month and accumulation period, namely
shape (<em>Œ±</em>), location (<em>Œº</em>), and scale (<em>Œ≤</em>).</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select data in reference window</span>
<span class="n">data_era5_precipitation_reference</span> <span class="o">=</span> <span class="n">data_era5_precipitation</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Fit gamma distribution</span>
<span class="n">spi_parameters</span> <span class="o">=</span> <span class="n">fit_monthly_spi</span><span class="p">(</span><span class="n">data_era5_precipitation_reference</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">spi_parameters</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:  (month: 12, lat: 721, lon: 1440, stat: 3)
Coordinates:
    number   int64 8B ...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Dimensions without coordinates: stat
Data variables:
    tp1      (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp3      (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp6      (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp12     (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp24     (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp36     (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;
    tp48     (month, lat, lon, stat) float64 299MB dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1e11c6dc-38e1-4a00-ae97-4315b1b3e7f7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1e11c6dc-38e1-4a00-ae97-4315b1b3e7f7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li><li><span>stat</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-efd4c694-f4c0-417f-a97a-762159fca808' class='xr-section-summary-in' type='checkbox'  checked><label for='section-efd4c694-f4c0-417f-a97a-762159fca808' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-80d22c5c-f447-4835-9dd6-88b354b0d2c8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-80d22c5c-f447-4835-9dd6-88b354b0d2c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af239d87-049c-4ec1-99d5-936529a836df' class='xr-var-data-in' type='checkbox'><label for='data-af239d87-049c-4ec1-99d5-936529a836df' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-f338a4e6-58b7-454d-998a-e10504771aec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f338a4e6-58b7-454d-998a-e10504771aec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a18c300-cd5d-4f7f-9908-ed31ed51fc13' class='xr-var-data-in' type='checkbox'><label for='data-1a18c300-cd5d-4f7f-9908-ed31ed51fc13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-aeb2f48b-a814-4ea5-beb0-71bd7fa20167' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aeb2f48b-a814-4ea5-beb0-71bd7fa20167' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6933853-9e7e-453d-be9c-9caba2c5c05c' class='xr-var-data-in' type='checkbox'><label for='data-c6933853-9e7e-453d-be9c-9caba2c5c05c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-5a044cb9-c231-4e1b-9f20-512a4cc6f974' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a044cb9-c231-4e1b-9f20-512a4cc6f974' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f2bcc69-e4ad-4b69-ad18-06d634f2b395' class='xr-var-data-in' type='checkbox'><label for='data-1f2bcc69-e4ad-4b69-ad18-06d634f2b395' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b120ffef-724c-4aeb-bb9c-9e4208ddd7f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b120ffef-724c-4aeb-bb9c-9e4208ddd7f1' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-44c150d8-8e10-4db6-abf3-60fe64179f35' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44c150d8-8e10-4db6-abf3-60fe64179f35' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee131319-9117-4b83-a8ef-eb424cd0f0fd' class='xr-var-data-in' type='checkbox'><label for='data-ee131319-9117-4b83-a8ef-eb424cd0f0fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 95 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-639d2940-1008-4372-be48-8eb400e99351' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-639d2940-1008-4372-be48-8eb400e99351' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96a627fb-4556-4265-a200-33ddcb55e2c8' class='xr-var-data-in' type='checkbox'><label for='data-96a627fb-4556-4265-a200-33ddcb55e2c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-4168d003-c0c0-4526-93a3-69fb94f539fa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4168d003-c0c0-4526-93a3-69fb94f539fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d886117f-bb81-4cc9-9a8c-5333dd2bb967' class='xr-var-data-in' type='checkbox'><label for='data-d886117f-bb81-4cc9-9a8c-5333dd2bb967' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-bf82b1cb-9e86-4cf6-923c-e082eefe1460' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf82b1cb-9e86-4cf6-923c-e082eefe1460' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cb3aed8-7bac-4b54-a5dc-d92c235f2dbc' class='xr-var-data-in' type='checkbox'><label for='data-1cb3aed8-7bac-4b54-a5dc-d92c235f2dbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-8ef57419-9fa8-4306-ba05-b1568f8ff8f4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8ef57419-9fa8-4306-ba05-b1568f8ff8f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ef9b00d-5937-44f1-9b58-723d28d09f86' class='xr-var-data-in' type='checkbox'><label for='data-2ef9b00d-5937-44f1-9b58-723d28d09f86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-a0b6cae0-55b1-49b2-a087-8c1543593b0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0b6cae0-55b1-49b2-a087-8c1543593b0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd513293-b240-4b03-8fe6-0170c2a6f036' class='xr-var-data-in' type='checkbox'><label for='data-bd513293-b240-4b03-8fe6-0170c2a6f036' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(month, lat, lon, stat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 103, 360, 3), meta=np.ndarray&gt;</div><input id='attrs-77de5971-9cd4-4485-bbe7-9b29c8aea226' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77de5971-9cd4-4485-bbe7-9b29c8aea226' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d85f89a2-0936-4783-bae5-b5bba265cfb7' class='xr-var-data-in' type='checkbox'><label for='data-d85f89a2-0936-4783-bae5-b5bba265cfb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 285.16 MiB </td>
                        <td> 10.18 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440, 3) </td>
                        <td> (12, 103, 360, 3) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 105 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="300" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="95" y1="30" x2="130" y2="65" />
  <line x1="95" y1="60" x2="130" y2="95" />
  <line x1="95" y1="90" x2="130" y2="125" />
  <line x1="95" y1="120" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="120" style="stroke-width:2" />
  <line x1="100" y1="5" x2="100" y2="125" />
  <line x1="105" y1="10" x2="105" y2="130" />
  <line x1="110" y1="15" x2="110" y2="135" />
  <line x1="115" y1="20" x2="115" y2="140" />
  <line x1="120" y1="25" x2="120" y2="145" />
  <line x1="125" y1="30" x2="125" y2="150" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 95.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="100" y1="5" x2="125" y2="5" />
  <line x1="105" y1="10" x2="130" y2="10" />
  <line x1="110" y1="15" x2="135" y2="15" />
  <line x1="115" y1="20" x2="140" y2="20" />
  <line x1="120" y1="25" x2="145" y2="25" />
  <line x1="125" y1="30" x2="150" y2="30" />
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="155" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 120.41261651458248,0.0 155.75575376948444,35.34313725490196 130.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="130" y1="35" x2="155" y2="35" style="stroke-width:2" />
  <line x1="130" y1="65" x2="155" y2="65" />
  <line x1="130" y1="95" x2="155" y2="95" />
  <line x1="130" y1="125" x2="155" y2="125" />
  <line x1="130" y1="155" x2="155" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />
  <line x1="155" y1="35" x2="155" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="130.34313725490196,35.34313725490196 155.75575376948444,35.34313725490196 155.75575376948444,155.34313725490196 130.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="143.049446" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >3</text>
  <text x="175.755754" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,175.755754,95.343137)">1440</text>
  <text x="102.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1e2266bb-0748-4da2-8b63-a2665819ed61' class='xr-section-summary-in' type='checkbox'  ><label for='section-1e2266bb-0748-4da2-8b63-a2665819ed61' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7c977a0c-ef9a-43e3-8531-6ceef7587688' class='xr-index-data-in' type='checkbox'/><label for='index-7c977a0c-ef9a-43e3-8531-6ceef7587688' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f62d1e8a-7fad-4d02-8558-3d76dbb464f1' class='xr-index-data-in' type='checkbox'/><label for='index-f62d1e8a-7fad-4d02-8558-3d76dbb464f1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ce5be998-9748-4da4-8301-f4ba0c03aa18' class='xr-index-data-in' type='checkbox'/><label for='index-ce5be998-9748-4da4-8301-f4ba0c03aa18' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eedc47b1-df32-4eff-8277-a01a8ce661f2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-eedc47b1-df32-4eff-8277-a01a8ce661f2' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>The observed (accumulated) total precipitation values along the entire time series
(1940‚Äì2024 in our example)
are then compared to the fitted parameters.
This is quantified in terms of where the observed values fall on the cumulative distribution function (CDF):</p>
<div class="math notranslate nohighlight">
\[
P(X \leq x) = F_X(x ; \alpha, \mu, \beta) = \int_{-\infty}^{x}f(y ; \alpha, \mu, \beta) \, \text{d}y
\]</div>
<p>Where
<em>P(X ‚â§ x)</em> is the probability for a randomly drawn total precipitation <em>X</em> to be equal to or less than the observed value <em>x</em>;
<em>F<sub>X</sub></em> is the CDF for a gamma distribution with shape <em>Œ±</em>, location <em>¬µ</em>, and scale <em>Œ≤</em>;
and
the CDF is equal to the integral of the corresponding probability density function up to <em>x</em>.</p>
<p>As before, there is a distribution for each calendar month, for each accumulation period.</p>
<p>Note that actually evaluating the CDF
‚Äì as opposed to <a class="reference external" href="https://docs.xarray.dev/en/stable/user-guide/dask.html" rel="noreferrer" target="_blank">queueing it up in dask</a>, as done here ‚Äì
can be slow, especially for a large dataset like global ERA5 precipitation.
As such, if you are interested in a subset of the data,
such as a specific site or period in time,
it may be best to subset your data <em>before</em> calculating the CDF rather than afterwards.
An example of this is provided below in the comparison with ERA5‚ÄìDrought SPI.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute CDF time series</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">compute_cdf_spi</span><span class="p">(</span><span class="n">data_era5_precipitation</span><span class="p">,</span> <span class="n">spi_parameters</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">cdf</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    tp1      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp3      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp6      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp12     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp24     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp36     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    tp48     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4c7a6453-c730-4eb0-a177-62a4e4a92e60' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4c7a6453-c730-4eb0-a177-62a4e4a92e60' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-03b38135-a920-4a34-af69-1cb9732035cb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-03b38135-a920-4a34-af69-1cb9732035cb' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-e76fc7a1-a42f-4896-94c0-2d261b32e452' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e76fc7a1-a42f-4896-94c0-2d261b32e452' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09184972-bd62-4a03-9a18-fe6c5a9f8f76' class='xr-var-data-in' type='checkbox'><label for='data-09184972-bd62-4a03-9a18-fe6c5a9f8f76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-2c9ee0c4-4fff-4efa-8b0c-b654af18b290' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c9ee0c4-4fff-4efa-8b0c-b654af18b290' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d96efbf9-c76b-44a8-aa6d-93088a6ef5a9' class='xr-var-data-in' type='checkbox'><label for='data-d96efbf9-c76b-44a8-aa6d-93088a6ef5a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-6d81a1b8-ce38-420b-84cd-bbda3df69df2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6d81a1b8-ce38-420b-84cd-bbda3df69df2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36ee55cd-cd02-408f-97ee-830d2c39e002' class='xr-var-data-in' type='checkbox'><label for='data-36ee55cd-cd02-408f-97ee-830d2c39e002' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-03e0d21b-c150-41df-a72d-a8264e18196f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-03e0d21b-c150-41df-a72d-a8264e18196f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-16b1680e-fa1d-47c8-8257-f2496b00401a' class='xr-var-data-in' type='checkbox'><label for='data-16b1680e-fa1d-47c8-8257-f2496b00401a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-cc6f30a9-f8f7-422b-8563-ee56b73a7df4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cc6f30a9-f8f7-422b-8563-ee56b73a7df4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-283ba640-410d-4ffd-9ab5-e8d91a31245f' class='xr-var-data-in' type='checkbox'><label for='data-283ba640-410d-4ffd-9ab5-e8d91a31245f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-03eefee2-04ad-4cc4-9864-7d057cd53065' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-03eefee2-04ad-4cc4-9864-7d057cd53065' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-107c434c-f6b0-4759-9d9b-65f851a6d246' class='xr-var-data-in' type='checkbox'><label for='data-107c434c-f6b0-4759-9d9b-65f851a6d246' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-252c158d-85dc-4cd6-9f43-ef1e1e8c2683' class='xr-section-summary-in' type='checkbox'  checked><label for='section-252c158d-85dc-4cd6-9f43-ef1e1e8c2683' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-1a9b367a-18b3-46b2-916d-87f858dee8f1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1a9b367a-18b3-46b2-916d-87f858dee8f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c8870c0-1ace-4f5a-b05d-8bb82c2f9338' class='xr-var-data-in' type='checkbox'><label for='data-3c8870c0-1ace-4f5a-b05d-8bb82c2f9338' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 107 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-fbebc57c-403b-4f8e-a332-6b5260c293e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fbebc57c-403b-4f8e-a332-6b5260c293e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df760a5b-b317-46b8-9a78-dff912e70bfc' class='xr-var-data-in' type='checkbox'><label for='data-df760a5b-b317-46b8-9a78-dff912e70bfc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-ed459222-0874-4117-afd1-0b85e271811e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ed459222-0874-4117-afd1-0b85e271811e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7fc5f1f-8d4c-4713-a0e4-3cf81ada6a7a' class='xr-var-data-in' type='checkbox'><label for='data-d7fc5f1f-8d4c-4713-a0e4-3cf81ada6a7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-18f8bb57-8070-4d73-b609-65d0582c5619' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-18f8bb57-8070-4d73-b609-65d0582c5619' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbbb4df2-8733-449f-8df5-402f6ff5cf32' class='xr-var-data-in' type='checkbox'><label for='data-dbbb4df2-8733-449f-8df5-402f6ff5cf32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-d6714924-bb87-4819-a30e-aade8aa9ade2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d6714924-bb87-4819-a30e-aade8aa9ade2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d55bbad-b905-409e-bf99-2d6c2226a631' class='xr-var-data-in' type='checkbox'><label for='data-0d55bbad-b905-409e-bf99-2d6c2226a631' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-e87380b5-e9a5-4f34-9f61-21b217ece35f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e87380b5-e9a5-4f34-9f61-21b217ece35f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24058cd7-3ff8-46f1-ba1e-99208b76673d' class='xr-var-data-in' type='checkbox'><label for='data-24058cd7-3ff8-46f1-ba1e-99208b76673d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-b8ab17c6-b190-40a4-afe6-974d26949b9a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b8ab17c6-b190-40a4-afe6-974d26949b9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-363cc8ff-08c0-48f8-bfcf-0d744489b334' class='xr-var-data-in' type='checkbox'><label for='data-363cc8ff-08c0-48f8-bfcf-0d744489b334' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 117 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-faa5e406-ac90-4091-8707-fe797a9c060e' class='xr-section-summary-in' type='checkbox'  ><label for='section-faa5e406-ac90-4091-8707-fe797a9c060e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4b40dc7a-e96d-4459-a1c4-41cbdfde97b8' class='xr-index-data-in' type='checkbox'/><label for='index-4b40dc7a-e96d-4459-a1c4-41cbdfde97b8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c44aff67-bbad-41ac-a802-e6659519634a' class='xr-index-data-in' type='checkbox'/><label for='index-c44aff67-bbad-41ac-a802-e6659519634a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-540b8959-3ff7-4653-bcd0-3adfe03d3e83' class='xr-index-data-in' type='checkbox'/><label for='index-540b8959-3ff7-4653-bcd0-3adfe03d3e83' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-227df2f3-1a6f-4192-8fe8-02876d8fc84a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-227df2f3-1a6f-4192-8fe8-02876d8fc84a' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
</section>
<section id="adjust-for-months-with-zero-precipitation">
<h4>3.4 Adjust for months with zero precipitation<a class="headerlink" href="#adjust-for-months-with-zero-precipitation" title="Link to this heading">#</a></h4>
<p>Sometimes, zero (or near-zero) monthly precipitation is observed,
particularly in dry areas like deserts.
Maintaining the desired statistics,
such as the mean SPI in the reference period being 0,
requires adjusting the CDF to account for these zero-precipitation months.</p>
<p>ERA5‚ÄìDrought follows the [<a class="reference external" href="https://doi.org/10.1002/joc.4267" rel="noreferrer" target="_blank">Stagge+15</a>] method to adjust the CDF.
First, the probability of zero precipitation is calculated as follows:</p>
<div class="math notranslate nohighlight">
\[
\bar{p_0} = \frac{n_0 + 1}{2 (n + 1)}
\]</div>
<p>where
<em>n<sub>0</sub></em> is the number of months with zero precipitation in the reference period,
and
<em>n</em> is the total number of months in the reference period (here 30 for 1991‚Äì2020).
While some datasets define ‚Äúzero precipitation‚Äù using a slightly higher threshold
(e.g. less than 0.1 mm)
to account for measurement uncertainty,
ERA5‚ÄìDrought uses a threshold of exactly 0 mm total precipitation in the underpinning ERA5 data.</p>
<p>Having calculated the probability of zero precipitation, the CDF is adjusted as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F'_X(x ; \alpha, \mu, \beta) =
\begin{cases}
\bar{p_0} + (1 - \bar{p_0}) \, F_X(x; \alpha, \mu, \beta), &amp; x &gt; 0, \\
\frac{n_0 + 1}{2(n+1)}, &amp; x = 0
\end{cases}
\end{split}\]</div>
<p>As before, this adjustment is carried out individually for each calendar month and accumulation period.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust CDF</span>
<span class="n">cdf_adjusted</span> <span class="o">=</span> <span class="n">adjust_cdf_for_zero_precipitation</span><span class="p">(</span><span class="n">cdf</span><span class="p">,</span> <span class="n">data_era5_precipitation_reference</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">cdf_adjusted</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (lat: 721, lon: 1440, time: 1020)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    tp1      (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp3      (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp6      (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp12     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp24     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp36     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    tp48     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-838eaf9e-26b4-4583-a94a-e1a42758fe5a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-838eaf9e-26b4-4583-a94a-e1a42758fe5a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-46712fed-4c53-4071-b2c9-be0f0f360aeb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46712fed-4c53-4071-b2c9-be0f0f360aeb' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-0ef88013-3625-46a4-a9f8-dcb8d46a8148' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0ef88013-3625-46a4-a9f8-dcb8d46a8148' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c19198fa-2c21-4dbd-ae92-5a77ede937f0' class='xr-var-data-in' type='checkbox'><label for='data-c19198fa-2c21-4dbd-ae92-5a77ede937f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-67cc8875-439a-4cea-9989-ef2e8c63606a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67cc8875-439a-4cea-9989-ef2e8c63606a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c205369b-4fd0-4b28-a3e2-e7a1db449435' class='xr-var-data-in' type='checkbox'><label for='data-c205369b-4fd0-4b28-a3e2-e7a1db449435' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-dc989299-1b9d-407f-83fc-67f2176cca40' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dc989299-1b9d-407f-83fc-67f2176cca40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed9351a7-470b-45b4-9b90-467fd6541f11' class='xr-var-data-in' type='checkbox'><label for='data-ed9351a7-470b-45b4-9b90-467fd6541f11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-0ba0b2e3-e938-4be0-9041-e1f7291664a8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0ba0b2e3-e938-4be0-9041-e1f7291664a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6d08dc86-6ab8-4e71-ad87-8dbe3a83434e' class='xr-var-data-in' type='checkbox'><label for='data-6d08dc86-6ab8-4e71-ad87-8dbe3a83434e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-47ade8d4-46de-4f48-9702-f94f3f6d992e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-47ade8d4-46de-4f48-9702-f94f3f6d992e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2306e423-e0ea-4ac5-8340-8610e6e13955' class='xr-var-data-in' type='checkbox'><label for='data-2306e423-e0ea-4ac5-8340-8610e6e13955' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-364c9218-680c-425d-bc07-7d25b051682b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-364c9218-680c-425d-bc07-7d25b051682b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f79d8876-d90b-4659-8a89-b17600547c58' class='xr-var-data-in' type='checkbox'><label for='data-f79d8876-d90b-4659-8a89-b17600547c58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 29 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-fd5998aa-da45-47c1-b44b-b32e486c4389' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fd5998aa-da45-47c1-b44b-b32e486c4389' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-ddad1ae9-fc40-4ae3-b31d-e8872d5c8daa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ddad1ae9-fc40-4ae3-b31d-e8872d5c8daa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fac265a0-82e6-4384-be06-c3016007a473' class='xr-var-data-in' type='checkbox'><label for='data-fac265a0-82e6-4384-be06-c3016007a473' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 296 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-e4e19715-56d9-4015-bc0f-67f63e4de960' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4e19715-56d9-4015-bc0f-67f63e4de960' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-acbdf8a6-d658-4987-acf2-a97bca104eb2' class='xr-var-data-in' type='checkbox'><label for='data-acbdf8a6-d658-4987-acf2-a97bca104eb2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-eb33910e-12ad-425a-ae2d-de18c065a42c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb33910e-12ad-425a-ae2d-de18c065a42c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6121f78d-c6e3-4652-b96c-bb1cfaf38c33' class='xr-var-data-in' type='checkbox'><label for='data-6121f78d-c6e3-4652-b96c-bb1cfaf38c33' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-4580b4ad-f595-4af7-8463-06452a77bbd9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4580b4ad-f595-4af7-8463-06452a77bbd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-317d5e97-03a6-44eb-81a1-08a468d2809f' class='xr-var-data-in' type='checkbox'><label for='data-317d5e97-03a6-44eb-81a1-08a468d2809f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-f558d114-d33f-4504-9ee1-0de2769214c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f558d114-d33f-4504-9ee1-0de2769214c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a65cdf4-3266-457b-b21b-725607dce4cc' class='xr-var-data-in' type='checkbox'><label for='data-5a65cdf4-3266-457b-b21b-725607dce4cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-999ffa1b-09d1-4d41-9c20-9e96ce6b4ff1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-999ffa1b-09d1-4d41-9c20-9e96ce6b4ff1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3e8e1b5-914e-45d2-afa8-1bc03d48d56c' class='xr-var-data-in' type='checkbox'><label for='data-d3e8e1b5-914e-45d2-afa8-1bc03d48d56c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-04e15f5d-af0d-4668-acf2-4c431621729c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04e15f5d-af0d-4668-acf2-4c431621729c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d63bcaec-2637-43b6-b67b-5bb78b6c37fb' class='xr-var-data-in' type='checkbox'><label for='data-d63bcaec-2637-43b6-b67b-5bb78b6c37fb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 306 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b627d3ef-034a-4870-8e77-95cc18f7d2b1' class='xr-section-summary-in' type='checkbox'  ><label for='section-b627d3ef-034a-4870-8e77-95cc18f7d2b1' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2d91b04d-6834-4b8a-8425-f02b63caa221' class='xr-index-data-in' type='checkbox'/><label for='index-2d91b04d-6834-4b8a-8425-f02b63caa221' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a9940cf3-d83f-4ba6-9cc4-eb5111ad112f' class='xr-index-data-in' type='checkbox'/><label for='index-a9940cf3-d83f-4ba6-9cc4-eb5111ad112f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6d0ce35f-ab8c-40e8-acea-734a256e6fe4' class='xr-index-data-in' type='checkbox'/><label for='index-6d0ce35f-ab8c-40e8-acea-734a256e6fe4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-92896ff1-bfa0-4924-8f8e-424ac36de5a8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-92896ff1-bfa0-4924-8f8e-424ac36de5a8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
</section>
<section id="compute-spi">
<h4>3.5 Compute SPI<a class="headerlink" href="#compute-spi" title="Link to this heading">#</a></h4>
<p>Finally,
SPI values
for each data point (latitude, longitude, time)
are calculated from the adjusted CDF values <em>F‚Äô<sub>X</sub></em> by transforming to a standard normal distribution.
The function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html" rel="noreferrer" target="_blank">scipy.stats.norm.ppf</a> is used to calculate the inverse CDF <em>Œ¶<sup>-1</sup></em> of the normal distribution:</p>
<div class="math notranslate nohighlight">
\[
\text{SPI}(x) = \Phi^{-1}\left(F'_X(x ; \alpha, \mu, \beta)\right)
\]</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI from adjusted CDF</span>
<span class="n">spi_reproduced</span> <span class="o">=</span> <span class="n">cdf_to_spi</span><span class="p">(</span><span class="n">cdf_adjusted</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">spi_reproduced</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (lat: 721, lon: 1440, time: 1020)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    SPI1     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI3     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI6     (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI12    (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI24    (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI36    (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;
    SPI48    (lat, lon, time) float64 8GB dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-bc206c1f-a9c5-4486-9e98-676a3899d1d0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bc206c1f-a9c5-4486-9e98-676a3899d1d0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c5fb8670-bf14-408b-8d14-c4f4e59dd216' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c5fb8670-bf14-408b-8d14-c4f4e59dd216' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-612b358c-fd8e-475f-a37c-4dc1efaa07ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-612b358c-fd8e-475f-a37c-4dc1efaa07ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38644371-7fcb-48a2-a76c-5d803e4d369d' class='xr-var-data-in' type='checkbox'><label for='data-38644371-7fcb-48a2-a76c-5d803e4d369d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-a8d643ba-084b-4092-9614-e8f44e617cb7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a8d643ba-084b-4092-9614-e8f44e617cb7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2031468-4e93-424f-9672-8f774e3b8380' class='xr-var-data-in' type='checkbox'><label for='data-a2031468-4e93-424f-9672-8f774e3b8380' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-31ee4153-1117-4de2-b2f5-a5daf5392a3a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-31ee4153-1117-4de2-b2f5-a5daf5392a3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a11fe69-a696-433e-8b72-ac4444f09711' class='xr-var-data-in' type='checkbox'><label for='data-2a11fe69-a696-433e-8b72-ac4444f09711' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-46015bc0-b496-4922-accf-23e060ea33e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-46015bc0-b496-4922-accf-23e060ea33e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5479e62e-cf29-4147-b6d7-b1aa3170e47b' class='xr-var-data-in' type='checkbox'><label for='data-5479e62e-cf29-4147-b6d7-b1aa3170e47b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-9b12c6df-c042-400e-887b-6099ad5a8400' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b12c6df-c042-400e-887b-6099ad5a8400' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab1aa6cd-fbbf-4f39-95bb-a0c67058809a' class='xr-var-data-in' type='checkbox'><label for='data-ab1aa6cd-fbbf-4f39-95bb-a0c67058809a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-a0557820-d6cf-4ebb-8825-4b484531bece' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0557820-d6cf-4ebb-8825-4b484531bece' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7c89654-fd59-462c-9139-64b496e3fa71' class='xr-var-data-in' type='checkbox'><label for='data-a7c89654-fd59-462c-9139-64b496e3fa71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 29 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-fb078d3a-208f-440d-bb5a-65d7ab8451ec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fb078d3a-208f-440d-bb5a-65d7ab8451ec' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-484e24ee-8c1e-4185-83ad-7c181615171c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-484e24ee-8c1e-4185-83ad-7c181615171c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcf4af0f-915f-487e-9401-d1af85174d04' class='xr-var-data-in' type='checkbox'><label for='data-bcf4af0f-915f-487e-9401-d1af85174d04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 302 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-8d4b9f1d-2df6-42dd-9e0a-68f0f1b3a528' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d4b9f1d-2df6-42dd-9e0a-68f0f1b3a528' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8df694c0-d190-40bb-ab7d-e50cf2dfd8ae' class='xr-var-data-in' type='checkbox'><label for='data-8df694c0-d190-40bb-ab7d-e50cf2dfd8ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-b2988e0c-8383-4f96-ab2a-7b210e4b1898' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b2988e0c-8383-4f96-ab2a-7b210e4b1898' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b92fc1fe-22ff-4dbd-bb67-f21271d34a5e' class='xr-var-data-in' type='checkbox'><label for='data-b92fc1fe-22ff-4dbd-bb67-f21271d34a5e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-d45ae1e9-0bdd-4d1b-9f6e-680400eb41c2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d45ae1e9-0bdd-4d1b-9f6e-680400eb41c2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86ba5232-62ba-47a8-aa8e-5a60f2ea6bc6' class='xr-var-data-in' type='checkbox'><label for='data-86ba5232-62ba-47a8-aa8e-5a60f2ea6bc6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-27754afd-877c-4268-877f-93cac602970f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-27754afd-877c-4268-877f-93cac602970f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bebcce8-7cd3-4b0e-9200-e42019042f4e' class='xr-var-data-in' type='checkbox'><label for='data-9bebcce8-7cd3-4b0e-9200-e42019042f4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-c774cc81-10d8-4d10-b429-3313e013a81d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c774cc81-10d8-4d10-b429-3313e013a81d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24ea1d55-f7fd-4787-a5c7-6b3115bec998' class='xr-var-data-in' type='checkbox'><label for='data-24ea1d55-f7fd-4787-a5c7-6b3115bec998' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(103, 360, 1020), meta=np.ndarray&gt;</div><input id='attrs-2fb59886-7731-4631-b433-6a672a1a0bb3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2fb59886-7731-4631-b433-6a672a1a0bb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-810cb7b2-0ad4-435d-8618-527a690d6e76' class='xr-var-data-in' type='checkbox'><label for='data-810cb7b2-0ad4-435d-8618-527a690d6e76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (721, 1440, 1020) </td>
                        <td> (103, 360, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 311 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="180" height="205" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="10" y1="30" x2="45" y2="65" />
  <line x1="10" y1="60" x2="45" y2="95" />
  <line x1="10" y1="90" x2="45" y2="125" />
  <line x1="10" y1="120" x2="45" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="20" y1="10" x2="20" y2="130" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="30" y1="20" x2="30" y2="140" />
  <line x1="35" y1="25" x2="35" y2="145" />
  <line x1="40" y1="30" x2="40" y2="150" />
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 45.34313725490196,35.34313725490196 45.34313725490196,155.34313725490196 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="95" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="100" y2="5" />
  <line x1="20" y1="10" x2="105" y2="10" />
  <line x1="25" y1="15" x2="110" y2="15" />
  <line x1="30" y1="20" x2="115" y2="20" />
  <line x1="35" y1="25" x2="120" y2="25" />
  <line x1="40" y1="30" x2="125" y2="30" />
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="45" y2="35" style="stroke-width:2" />
  <line x1="95" y1="0" x2="130" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 95.0,0.0 130.34313725490196,35.34313725490196 45.34313725490196,35.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="45" y1="35" x2="130" y2="35" style="stroke-width:2" />
  <line x1="45" y1="65" x2="130" y2="65" />
  <line x1="45" y1="95" x2="130" y2="95" />
  <line x1="45" y1="125" x2="130" y2="125" />
  <line x1="45" y1="155" x2="130" y2="155" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="45" y1="35" x2="45" y2="155" style="stroke-width:2" />
  <line x1="130" y1="35" x2="130" y2="155" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="45.34313725490196,35.34313725490196 130.34313725490196,35.34313725490196 130.34313725490196,155.34313725490196 45.34313725490196,155.34313725490196" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="87.843137" y="175.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="150.343137" y="95.343137" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,150.343137,95.343137)">1440</text>
  <text x="17.671569" y="157.671569" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,17.671569,157.671569)">721</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-781bdbdf-d017-497d-9e55-bfcb06189769' class='xr-section-summary-in' type='checkbox'  ><label for='section-781bdbdf-d017-497d-9e55-bfcb06189769' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-92050d43-0e85-4594-8af9-9216fab3283e' class='xr-index-data-in' type='checkbox'/><label for='index-92050d43-0e85-4594-8af9-9216fab3283e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2baf6eaa-acf0-41ad-a172-250e7e2e78e1' class='xr-index-data-in' type='checkbox'/><label for='index-2baf6eaa-acf0-41ad-a172-250e7e2e78e1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5becd2d0-750c-4413-8a93-9d3cc3a3505f' class='xr-index-data-in' type='checkbox'/><label for='index-5becd2d0-750c-4413-8a93-9d3cc3a3505f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-00164e1a-b362-4bd9-9532-35e73fb5b613' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-00164e1a-b362-4bd9-9532-35e73fb5b613' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="spi-comparison-time-series-in-example-site">
<h4>3.6 SPI comparison: Time series in example site<a class="headerlink" href="#spi-comparison-time-series-in-example-site" title="Link to this heading">#</a></h4>
<p>Having reproduced the SPI index from ERA5 precipitation data following the ERA5‚ÄìDrought methodology,
we can now compare the results to determine the reproducibility of ERA5‚ÄìDrought.
We first compare the datasets over time at the example site defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.</p>
<p>The previous sections set up the SPI reproduction pipeline for the entire ERA5 precipitation dataset (global, 1940‚Äì2024).
Because actually executing said calculation takes a long time,
as noted in the CDF subsection,
here we sub-select the downloaded ERA5 precipitation data and calculate SPI for the example site only.
For convenience, the full SPI pipeline is wrapped into a single <code class="docutils literal notranslate"><span class="pre">calculate_spi_from_era5</span></code> function,
as defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"><span class="std std-ref">1. Code setup</span></a>.</p>
<p>Note that while the two may seem equivalent,
downloading the ERA5 precipitation data for the example site only and then running the SPI pipeline,
rather than downloading the entire dataset and subselecting for the example site,
produces different results.
This is likely caused by the inner workings of the MARS regridding function.
For consistency with ERA5‚ÄìDrought, it is necessary to download the global ERA5 dataset and subselect.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_precipitation_site</span> <span class="o">=</span> <span class="n">data_era5_precipitation_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Calculate SPI</span>
<span class="n">spi_reproduced_site</span> <span class="o">=</span> <span class="n">calculate_spi_from_era5</span><span class="p">(</span><span class="n">data_era5_precipitation_site</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spi_reproduced_site</span> <span class="o">=</span> <span class="n">spi_reproduced_site</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spi_reproduced_site</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 90kB
Dimensions:  (time: 1020)
Coordinates:
    number   int64 8B 0
    lat      float64 8B 9.0
    lon      float64 8B 38.75
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    SPI1     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI3     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI6     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI12    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI24    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI36    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI48    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-91bf84bb-a530-43b9-a6de-df3a50c2b026' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-91bf84bb-a530-43b9-a6de-df3a50c2b026' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-71671b28-3727-4d54-902f-0b31b9cd0c2f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-71671b28-3727-4d54-902f-0b31b9cd0c2f' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-bb0ca39a-4e29-43fd-b882-7c9f0a347e25' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bb0ca39a-4e29-43fd-b882-7c9f0a347e25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b06fd1e3-fe2b-4a9a-9a26-744a9d6176a1' class='xr-var-data-in' type='checkbox'><label for='data-b06fd1e3-fe2b-4a9a-9a26-744a9d6176a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-a2764fa0-baa3-4b23-8084-0b6186b2e2a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a2764fa0-baa3-4b23-8084-0b6186b2e2a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5211173a-d7fc-49a4-b685-be1be48b9025' class='xr-var-data-in' type='checkbox'><label for='data-5211173a-d7fc-49a4-b685-be1be48b9025' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-f7558089-2b10-4b84-a386-17f1881c152a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f7558089-2b10-4b84-a386-17f1881c152a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1dcc90ce-aac1-40a9-b4f0-299051989ec2' class='xr-var-data-in' type='checkbox'><label for='data-1dcc90ce-aac1-40a9-b4f0-299051989ec2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-2332c067-3f47-4942-8f43-c89d002d5df0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2332c067-3f47-4942-8f43-c89d002d5df0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-247533cc-9d0f-4593-9e0e-6a88f718ccb2' class='xr-var-data-in' type='checkbox'><label for='data-247533cc-9d0f-4593-9e0e-6a88f718ccb2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-0ba22bc2-668e-4126-8f7e-c00dacd68ca7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0ba22bc2-668e-4126-8f7e-c00dacd68ca7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-daadaad7-6ea1-4ae1-9838-1fe890f43c86' class='xr-var-data-in' type='checkbox'><label for='data-daadaad7-6ea1-4ae1-9838-1fe890f43c86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-034933aa-e96a-42aa-a380-ec134349c9af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-034933aa-e96a-42aa-a380-ec134349c9af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17f67bb9-7c70-4b7a-ade6-c53aadc0b5f4' class='xr-var-data-in' type='checkbox'><label for='data-17f67bb9-7c70-4b7a-ade6-c53aadc0b5f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-337e8cd0-1aa8-40ee-a09d-d957aa8ab841' class='xr-section-summary-in' type='checkbox'  checked><label for='section-337e8cd0-1aa8-40ee-a09d-d957aa8ab841' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-5e260938-d03a-4226-ba0f-d183158c10bc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5e260938-d03a-4226-ba0f-d183158c10bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45381cd3-0788-439d-aef7-112e328caec0' class='xr-var-data-in' type='checkbox'><label for='data-45381cd3-0788-439d-aef7-112e328caec0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-56984f3e-dcce-4423-b091-8b4754e9c4dd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-56984f3e-dcce-4423-b091-8b4754e9c4dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ffcd61d-b486-42f8-b603-1e41d05dcd51' class='xr-var-data-in' type='checkbox'><label for='data-0ffcd61d-b486-42f8-b603-1e41d05dcd51' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-75bc8f23-a4b6-482d-bb01-f66e9729763e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-75bc8f23-a4b6-482d-bb01-f66e9729763e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ffc5a6a1-2b5f-4e39-bd51-bd5e314277e7' class='xr-var-data-in' type='checkbox'><label for='data-ffc5a6a1-2b5f-4e39-bd51-bd5e314277e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-06753822-d21b-4969-a8c4-9d3700c01cd9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-06753822-d21b-4969-a8c4-9d3700c01cd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d643fac-a55a-414a-b614-066b291523e6' class='xr-var-data-in' type='checkbox'><label for='data-0d643fac-a55a-414a-b614-066b291523e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-1409f0c0-40c4-46ff-a34d-6f61f032bce7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1409f0c0-40c4-46ff-a34d-6f61f032bce7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95c076db-e70d-444f-aec1-d94658a9a79e' class='xr-var-data-in' type='checkbox'><label for='data-95c076db-e70d-444f-aec1-d94658a9a79e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-fc826c66-0c7c-4961-a95c-0724a6b34182' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc826c66-0c7c-4961-a95c-0724a6b34182' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04edb81e-2a7d-46c2-ace3-059f7ed920cb' class='xr-var-data-in' type='checkbox'><label for='data-04edb81e-2a7d-46c2-ace3-059f7ed920cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-a72865a6-a341-4812-bf7d-c74b93d93d60' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a72865a6-a341-4812-bf7d-c74b93d93d60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff93e649-463b-45f6-ab73-ee589304a857' class='xr-var-data-in' type='checkbox'><label for='data-ff93e649-463b-45f6-ab73-ee589304a857' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-460e9acd-27e8-47fd-aac5-a65a7dbf18c5' class='xr-section-summary-in' type='checkbox'  ><label for='section-460e9acd-27e8-47fd-aac5-a65a7dbf18c5' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-df0c9efc-9751-4c4f-9c33-9d9202f32e24' class='xr-index-data-in' type='checkbox'/><label for='index-df0c9efc-9751-4c4f-9c33-9d9202f32e24' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2e72b4f9-0b6e-433b-a599-3b4689ad429c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2e72b4f9-0b6e-433b-a599-3b4689ad429c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>Next, we download the corresponding data from ERA5‚ÄìDrought.
Because of size limits on the CDS,
the time series must be downloaded in parts:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main request, based on template and example site</span>
<span class="n">request_era5drought_spi</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index</span> <span class="o">|</span> <span class="n">request_site</span>

<span class="c1"># Split into batches of up to 20 years each</span>
<span class="n">subrequests_era5drought_spi</span> <span class="o">=</span> <span class="n">batch_requests</span><span class="p">(</span><span class="n">request_era5drought_spi</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Download data and load into xarray</span>
<span class="n">spi_era5drought_site</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="o">*</span><span class="n">subrequests_era5drought_spi</span><span class="p">)</span>
<span class="n">spi_era5drought_site</span> <span class="o">=</span> <span class="n">spi_era5drought_site</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">spi_era5drought_site</span> <span class="o">=</span> <span class="n">spi_era5drought_site</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Full time series in one chunk</span>

<span class="c1"># Select only desired site (remove margins)</span>
<span class="n">spi_era5drought_site</span> <span class="o">=</span> <span class="n">spi_era5drought_site</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spi_era5drought_site</span> <span class="o">=</span> <span class="n">spi_era5drought_site</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spi_era5drought_site</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 65kB
Dimensions:  (time: 1020)
Coordinates:
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    lat      float64 8B 9.0
    lon      float64 8B 38.75
Data variables:
    SPI12    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI1     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI24    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI36    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI3     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI48    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPI6     (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Attributes: (12/17)
    title:                   SPI12
    description:             Drought Index: Standardized Drought Index calcul...
    Conventions:             CF-1.8
    history:                 Created 13/08/2024 14:50:11 using DRYFALL.
    institution:             European Centre for Medium-Range Weather Forecasts
    source:                  DRYFALL v1.0
    ...                      ...
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    ref_publication:         Keune, J., Di Giuseppe, F., Barnard, C., Damasio...
    cds_data_catalogue_url:  https://cds.climate.copernicus.eu/datasets/deriv...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-72fa9bd0-2c02-440a-91ae-521dbd2169b1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-72fa9bd0-2c02-440a-91ae-521dbd2169b1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4e9e00de-ab8c-4a45-a3f7-502958a6dc8e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4e9e00de-ab8c-4a45-a3f7-502958a6dc8e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-7a2231fa-648a-40fb-837f-c865bb0cd319' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a2231fa-648a-40fb-837f-c865bb0cd319' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e30a1da-a94d-412e-ad08-4af254522d92' class='xr-var-data-in' type='checkbox'><label for='data-7e30a1da-a94d-412e-ad08-4af254522d92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-a79c9f67-79a4-47da-b398-3d41f97f527c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a79c9f67-79a4-47da-b398-3d41f97f527c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92ab10eb-2873-48e4-b15f-43e0f407c8c1' class='xr-var-data-in' type='checkbox'><label for='data-92ab10eb-2873-48e4-b15f-43e0f407c8c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-5c9aa32f-cb60-43eb-bf21-fe49f7a0711a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5c9aa32f-cb60-43eb-bf21-fe49f7a0711a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af38068e-1fee-43a5-a9e5-e6b1e14d0f4b' class='xr-var-data-in' type='checkbox'><label for='data-af38068e-1fee-43a5-a9e5-e6b1e14d0f4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ebcb70a6-cb88-4fdb-863c-ac4aa9e2980d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ebcb70a6-cb88-4fdb-863c-ac4aa9e2980d' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-744293cc-c930-49f6-beb7-7166d4272f86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-744293cc-c930-49f6-beb7-7166d4272f86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d19a7ca-d88e-48ef-91c5-77838bdee4e8' class='xr-var-data-in' type='checkbox'><label for='data-1d19a7ca-d88e-48ef-91c5-77838bdee4e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI12)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-bedb7a57-19f0-4c96-9845-82feb10247c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bedb7a57-19f0-4c96-9845-82feb10247c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5f2ec7b-15e3-48e6-9e19-5c971a5609ef' class='xr-var-data-in' type='checkbox'><label for='data-a5f2ec7b-15e3-48e6-9e19-5c971a5609ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI1)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-67821e39-eccc-4e38-bbd1-b08bc9ab0a63' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-67821e39-eccc-4e38-bbd1-b08bc9ab0a63' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-649af89a-a01d-4174-9441-35b890107ae2' class='xr-var-data-in' type='checkbox'><label for='data-649af89a-a01d-4174-9441-35b890107ae2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI24)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-88ce4b26-0a4d-4463-96ef-f5421e19b437' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-88ce4b26-0a4d-4463-96ef-f5421e19b437' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-505d0e54-399a-415b-a0a3-96c1988c0a8e' class='xr-var-data-in' type='checkbox'><label for='data-505d0e54-399a-415b-a0a3-96c1988c0a8e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI36)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-b9ce8a11-6d3e-4f87-a41b-ca87f3f74466' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b9ce8a11-6d3e-4f87-a41b-ca87f3f74466' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d17ccab-616b-43d8-b751-f0306467355b' class='xr-var-data-in' type='checkbox'><label for='data-1d17ccab-616b-43d8-b751-f0306467355b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI3)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-ccf4588a-add7-4777-9f76-3bf6e31d9526' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ccf4588a-add7-4777-9f76-3bf6e31d9526' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6730ddb-e6e3-4501-8e67-7415a336367f' class='xr-var-data-in' type='checkbox'><label for='data-a6730ddb-e6e3-4501-8e67-7415a336367f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI48)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-8601492c-964a-48a2-bca6-b9676407b6f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8601492c-964a-48a2-bca6-b9676407b6f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc2ce72e-15dd-4751-9e3a-a50e4fdace14' class='xr-var-data-in' type='checkbox'><label for='data-fc2ce72e-15dd-4751-9e3a-a50e4fdace14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI6)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-00843ccb-4f5b-452c-a70c-c4144dcd6515' class='xr-section-summary-in' type='checkbox'  ><label for='section-00843ccb-4f5b-452c-a70c-c4144dcd6515' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-dbbbfcd4-452c-46f0-b228-4cdb4906db43' class='xr-index-data-in' type='checkbox'/><label for='index-dbbbfcd4-452c-46f0-b228-4cdb4906db43' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e618e746-1b34-4b93-8c98-678c749a1a02' class='xr-section-summary-in' type='checkbox'  ><label for='section-e618e746-1b34-4b93-8c98-678c749a1a02' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>SPI12</dd><dt><span>description :</span></dt><dd>Drought Index: Standardized Drought Index calculated according to the WMO guidelines (see https://library.wmo.int/doc_num.php?explnum_id=7768).</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>history :</span></dt><dd>Created 13/08/2024 14:50:11 using DRYFALL.</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., Di Giuseppe, F., Barnard, C., Damasio da Costa, E., and Wetterhall, F. (2025): ERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis, Scientific Data 12, 616. https://doi.org/10.1038/s41597-025-04896-y</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://cds.climate.copernicus.eu/datasets/derived-drought-historical-monthly</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>First, we examine the per-point difference in SPI between ERA5‚ÄìDrought and the reproduction.
This comparison is performed separately for each calendar month and each accumulation period
to reflect the fitting process.
We calculate the median difference MŒî and median absolute difference M|Œî|,
as well as the percentage of match-ups where |Œî| ‚â• 0.10:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI median differences</span>
<span class="n">spi_difference_site</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spi_era5drought_site</span><span class="p">,</span> <span class="n">spi_reproduced_site</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spi_difference_site</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_03a14 th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_03a14 th.col_heading {
  border-bottom: 0;
}
#T_03a14 table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_03a14 th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_03a14_row0_col0, #T_03a14_row0_col3, #T_03a14_row0_col6, #T_03a14_row0_col9, #T_03a14_row0_col12, #T_03a14_row0_col15, #T_03a14_row0_col18, #T_03a14_row1_col0, #T_03a14_row1_col3, #T_03a14_row1_col6, #T_03a14_row1_col9, #T_03a14_row1_col12, #T_03a14_row1_col15, #T_03a14_row1_col18, #T_03a14_row2_col0, #T_03a14_row2_col3, #T_03a14_row2_col6, #T_03a14_row2_col9, #T_03a14_row2_col12, #T_03a14_row2_col15, #T_03a14_row2_col18, #T_03a14_row3_col0, #T_03a14_row3_col3, #T_03a14_row3_col6, #T_03a14_row3_col9, #T_03a14_row3_col12, #T_03a14_row3_col15, #T_03a14_row3_col18, #T_03a14_row4_col0, #T_03a14_row4_col3, #T_03a14_row4_col6, #T_03a14_row4_col9, #T_03a14_row4_col12, #T_03a14_row4_col15, #T_03a14_row4_col18, #T_03a14_row5_col0, #T_03a14_row5_col3, #T_03a14_row5_col6, #T_03a14_row5_col9, #T_03a14_row5_col12, #T_03a14_row5_col15, #T_03a14_row5_col18, #T_03a14_row6_col0, #T_03a14_row6_col3, #T_03a14_row6_col6, #T_03a14_row6_col9, #T_03a14_row6_col12, #T_03a14_row6_col15, #T_03a14_row6_col18, #T_03a14_row7_col0, #T_03a14_row7_col3, #T_03a14_row7_col6, #T_03a14_row7_col9, #T_03a14_row7_col12, #T_03a14_row7_col15, #T_03a14_row7_col18, #T_03a14_row8_col0, #T_03a14_row8_col3, #T_03a14_row8_col6, #T_03a14_row8_col9, #T_03a14_row8_col12, #T_03a14_row8_col15, #T_03a14_row8_col18, #T_03a14_row9_col0, #T_03a14_row9_col3, #T_03a14_row9_col6, #T_03a14_row9_col9, #T_03a14_row9_col12, #T_03a14_row9_col15, #T_03a14_row9_col18, #T_03a14_row10_col0, #T_03a14_row10_col3, #T_03a14_row10_col6, #T_03a14_row10_col9, #T_03a14_row10_col12, #T_03a14_row10_col15, #T_03a14_row10_col18, #T_03a14_row11_col0, #T_03a14_row11_col3, #T_03a14_row11_col6, #T_03a14_row11_col9, #T_03a14_row11_col12, #T_03a14_row11_col15, #T_03a14_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_03a14">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_03a14_level0_col0" class="col_heading level0 col0" colspan="3">SPI-1</th>
      <th id="T_03a14_level0_col3" class="col_heading level0 col3" colspan="3">SPI-3</th>
      <th id="T_03a14_level0_col6" class="col_heading level0 col6" colspan="3">SPI-6</th>
      <th id="T_03a14_level0_col9" class="col_heading level0 col9" colspan="3">SPI-12</th>
      <th id="T_03a14_level0_col12" class="col_heading level0 col12" colspan="3">SPI-24</th>
      <th id="T_03a14_level0_col15" class="col_heading level0 col15" colspan="3">SPI-36</th>
      <th id="T_03a14_level0_col18" class="col_heading level0 col18" colspan="3">SPI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_03a14_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_03a14_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_03a14_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_03a14_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_03a14_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_03a14_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_03a14_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_03a14_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_03a14_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_03a14_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_03a14_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_03a14_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_03a14_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_03a14_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_03a14_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_03a14_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_03a14_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_03a14_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_03a14_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_03a14_row0_col2" class="data row0 col2" >1.1765</td>
      <td id="T_03a14_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_03a14_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_03a14_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_03a14_row0_col6" class="data row0 col6" >0.0000</td>
      <td id="T_03a14_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_03a14_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_03a14_row0_col9" class="data row0 col9" >0.0000</td>
      <td id="T_03a14_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_03a14_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_03a14_row0_col12" class="data row0 col12" >0.0000</td>
      <td id="T_03a14_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_03a14_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_03a14_row0_col15" class="data row0 col15" >0.0000</td>
      <td id="T_03a14_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_03a14_row0_col17" class="data row0 col17" >1.1765</td>
      <td id="T_03a14_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_03a14_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_03a14_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_03a14_row1_col0" class="data row1 col0" >0.0000</td>
      <td id="T_03a14_row1_col1" class="data row1 col1" >0.0000</td>
      <td id="T_03a14_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_03a14_row1_col3" class="data row1 col3" >0.0000</td>
      <td id="T_03a14_row1_col4" class="data row1 col4" >0.0000</td>
      <td id="T_03a14_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_03a14_row1_col6" class="data row1 col6" >0.0000</td>
      <td id="T_03a14_row1_col7" class="data row1 col7" >0.0000</td>
      <td id="T_03a14_row1_col8" class="data row1 col8" >0.0000</td>
      <td id="T_03a14_row1_col9" class="data row1 col9" >0.0000</td>
      <td id="T_03a14_row1_col10" class="data row1 col10" >0.0000</td>
      <td id="T_03a14_row1_col11" class="data row1 col11" >0.0000</td>
      <td id="T_03a14_row1_col12" class="data row1 col12" >0.0000</td>
      <td id="T_03a14_row1_col13" class="data row1 col13" >0.0000</td>
      <td id="T_03a14_row1_col14" class="data row1 col14" >0.0000</td>
      <td id="T_03a14_row1_col15" class="data row1 col15" >0.0000</td>
      <td id="T_03a14_row1_col16" class="data row1 col16" >0.0000</td>
      <td id="T_03a14_row1_col17" class="data row1 col17" >1.1765</td>
      <td id="T_03a14_row1_col18" class="data row1 col18" >0.0000</td>
      <td id="T_03a14_row1_col19" class="data row1 col19" >0.0000</td>
      <td id="T_03a14_row1_col20" class="data row1 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_03a14_row2_col0" class="data row2 col0" >0.0000</td>
      <td id="T_03a14_row2_col1" class="data row2 col1" >0.0000</td>
      <td id="T_03a14_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_03a14_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_03a14_row2_col4" class="data row2 col4" >0.0000</td>
      <td id="T_03a14_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_03a14_row2_col6" class="data row2 col6" >0.0000</td>
      <td id="T_03a14_row2_col7" class="data row2 col7" >0.0000</td>
      <td id="T_03a14_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_03a14_row2_col9" class="data row2 col9" >0.0000</td>
      <td id="T_03a14_row2_col10" class="data row2 col10" >0.0000</td>
      <td id="T_03a14_row2_col11" class="data row2 col11" >0.0000</td>
      <td id="T_03a14_row2_col12" class="data row2 col12" >0.0000</td>
      <td id="T_03a14_row2_col13" class="data row2 col13" >0.0000</td>
      <td id="T_03a14_row2_col14" class="data row2 col14" >0.0000</td>
      <td id="T_03a14_row2_col15" class="data row2 col15" >0.0000</td>
      <td id="T_03a14_row2_col16" class="data row2 col16" >0.0000</td>
      <td id="T_03a14_row2_col17" class="data row2 col17" >0.0000</td>
      <td id="T_03a14_row2_col18" class="data row2 col18" >0.0000</td>
      <td id="T_03a14_row2_col19" class="data row2 col19" >0.0000</td>
      <td id="T_03a14_row2_col20" class="data row2 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_03a14_row3_col0" class="data row3 col0" >0.0000</td>
      <td id="T_03a14_row3_col1" class="data row3 col1" >0.0000</td>
      <td id="T_03a14_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_03a14_row3_col3" class="data row3 col3" >0.0000</td>
      <td id="T_03a14_row3_col4" class="data row3 col4" >0.0000</td>
      <td id="T_03a14_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_03a14_row3_col6" class="data row3 col6" >0.0000</td>
      <td id="T_03a14_row3_col7" class="data row3 col7" >0.0000</td>
      <td id="T_03a14_row3_col8" class="data row3 col8" >0.0000</td>
      <td id="T_03a14_row3_col9" class="data row3 col9" >0.0000</td>
      <td id="T_03a14_row3_col10" class="data row3 col10" >0.0000</td>
      <td id="T_03a14_row3_col11" class="data row3 col11" >0.0000</td>
      <td id="T_03a14_row3_col12" class="data row3 col12" >0.0000</td>
      <td id="T_03a14_row3_col13" class="data row3 col13" >0.0000</td>
      <td id="T_03a14_row3_col14" class="data row3 col14" >1.1765</td>
      <td id="T_03a14_row3_col15" class="data row3 col15" >0.0000</td>
      <td id="T_03a14_row3_col16" class="data row3 col16" >0.0000</td>
      <td id="T_03a14_row3_col17" class="data row3 col17" >0.0000</td>
      <td id="T_03a14_row3_col18" class="data row3 col18" >0.0000</td>
      <td id="T_03a14_row3_col19" class="data row3 col19" >0.0000</td>
      <td id="T_03a14_row3_col20" class="data row3 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_03a14_row4_col0" class="data row4 col0" >0.0000</td>
      <td id="T_03a14_row4_col1" class="data row4 col1" >0.0000</td>
      <td id="T_03a14_row4_col2" class="data row4 col2" >0.0000</td>
      <td id="T_03a14_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_03a14_row4_col4" class="data row4 col4" >0.0000</td>
      <td id="T_03a14_row4_col5" class="data row4 col5" >0.0000</td>
      <td id="T_03a14_row4_col6" class="data row4 col6" >0.0000</td>
      <td id="T_03a14_row4_col7" class="data row4 col7" >0.0000</td>
      <td id="T_03a14_row4_col8" class="data row4 col8" >0.0000</td>
      <td id="T_03a14_row4_col9" class="data row4 col9" >-0.0001</td>
      <td id="T_03a14_row4_col10" class="data row4 col10" >0.0008</td>
      <td id="T_03a14_row4_col11" class="data row4 col11" >0.0000</td>
      <td id="T_03a14_row4_col12" class="data row4 col12" >0.0000</td>
      <td id="T_03a14_row4_col13" class="data row4 col13" >0.0000</td>
      <td id="T_03a14_row4_col14" class="data row4 col14" >0.0000</td>
      <td id="T_03a14_row4_col15" class="data row4 col15" >0.0000</td>
      <td id="T_03a14_row4_col16" class="data row4 col16" >0.0000</td>
      <td id="T_03a14_row4_col17" class="data row4 col17" >1.1765</td>
      <td id="T_03a14_row4_col18" class="data row4 col18" >0.0000</td>
      <td id="T_03a14_row4_col19" class="data row4 col19" >0.0000</td>
      <td id="T_03a14_row4_col20" class="data row4 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_03a14_row5_col0" class="data row5 col0" >0.0000</td>
      <td id="T_03a14_row5_col1" class="data row5 col1" >0.0000</td>
      <td id="T_03a14_row5_col2" class="data row5 col2" >0.0000</td>
      <td id="T_03a14_row5_col3" class="data row5 col3" >0.0000</td>
      <td id="T_03a14_row5_col4" class="data row5 col4" >0.0000</td>
      <td id="T_03a14_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_03a14_row5_col6" class="data row5 col6" >0.0000</td>
      <td id="T_03a14_row5_col7" class="data row5 col7" >0.0000</td>
      <td id="T_03a14_row5_col8" class="data row5 col8" >0.0000</td>
      <td id="T_03a14_row5_col9" class="data row5 col9" >0.0000</td>
      <td id="T_03a14_row5_col10" class="data row5 col10" >0.0000</td>
      <td id="T_03a14_row5_col11" class="data row5 col11" >0.0000</td>
      <td id="T_03a14_row5_col12" class="data row5 col12" >0.0000</td>
      <td id="T_03a14_row5_col13" class="data row5 col13" >0.0000</td>
      <td id="T_03a14_row5_col14" class="data row5 col14" >0.0000</td>
      <td id="T_03a14_row5_col15" class="data row5 col15" >0.0000</td>
      <td id="T_03a14_row5_col16" class="data row5 col16" >0.0000</td>
      <td id="T_03a14_row5_col17" class="data row5 col17" >0.0000</td>
      <td id="T_03a14_row5_col18" class="data row5 col18" >-0.0085</td>
      <td id="T_03a14_row5_col19" class="data row5 col19" >0.0085</td>
      <td id="T_03a14_row5_col20" class="data row5 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_03a14_row6_col0" class="data row6 col0" >0.0000</td>
      <td id="T_03a14_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_03a14_row6_col2" class="data row6 col2" >0.0000</td>
      <td id="T_03a14_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_03a14_row6_col4" class="data row6 col4" >0.0000</td>
      <td id="T_03a14_row6_col5" class="data row6 col5" >1.1765</td>
      <td id="T_03a14_row6_col6" class="data row6 col6" >0.0000</td>
      <td id="T_03a14_row6_col7" class="data row6 col7" >0.0000</td>
      <td id="T_03a14_row6_col8" class="data row6 col8" >0.0000</td>
      <td id="T_03a14_row6_col9" class="data row6 col9" >0.0000</td>
      <td id="T_03a14_row6_col10" class="data row6 col10" >0.0000</td>
      <td id="T_03a14_row6_col11" class="data row6 col11" >0.0000</td>
      <td id="T_03a14_row6_col12" class="data row6 col12" >0.0000</td>
      <td id="T_03a14_row6_col13" class="data row6 col13" >0.0000</td>
      <td id="T_03a14_row6_col14" class="data row6 col14" >0.0000</td>
      <td id="T_03a14_row6_col15" class="data row6 col15" >0.0000</td>
      <td id="T_03a14_row6_col16" class="data row6 col16" >0.0000</td>
      <td id="T_03a14_row6_col17" class="data row6 col17" >0.0000</td>
      <td id="T_03a14_row6_col18" class="data row6 col18" >0.0000</td>
      <td id="T_03a14_row6_col19" class="data row6 col19" >0.0000</td>
      <td id="T_03a14_row6_col20" class="data row6 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_03a14_row7_col0" class="data row7 col0" >0.0000</td>
      <td id="T_03a14_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_03a14_row7_col2" class="data row7 col2" >0.0000</td>
      <td id="T_03a14_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_03a14_row7_col4" class="data row7 col4" >0.0000</td>
      <td id="T_03a14_row7_col5" class="data row7 col5" >2.3529</td>
      <td id="T_03a14_row7_col6" class="data row7 col6" >0.0000</td>
      <td id="T_03a14_row7_col7" class="data row7 col7" >0.0000</td>
      <td id="T_03a14_row7_col8" class="data row7 col8" >0.0000</td>
      <td id="T_03a14_row7_col9" class="data row7 col9" >0.0000</td>
      <td id="T_03a14_row7_col10" class="data row7 col10" >0.0000</td>
      <td id="T_03a14_row7_col11" class="data row7 col11" >0.0000</td>
      <td id="T_03a14_row7_col12" class="data row7 col12" >0.0003</td>
      <td id="T_03a14_row7_col13" class="data row7 col13" >0.0004</td>
      <td id="T_03a14_row7_col14" class="data row7 col14" >0.0000</td>
      <td id="T_03a14_row7_col15" class="data row7 col15" >0.0000</td>
      <td id="T_03a14_row7_col16" class="data row7 col16" >0.0000</td>
      <td id="T_03a14_row7_col17" class="data row7 col17" >0.0000</td>
      <td id="T_03a14_row7_col18" class="data row7 col18" >-0.0008</td>
      <td id="T_03a14_row7_col19" class="data row7 col19" >0.0067</td>
      <td id="T_03a14_row7_col20" class="data row7 col20" >1.1765</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_03a14_row8_col0" class="data row8 col0" >0.0000</td>
      <td id="T_03a14_row8_col1" class="data row8 col1" >0.0000</td>
      <td id="T_03a14_row8_col2" class="data row8 col2" >0.0000</td>
      <td id="T_03a14_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_03a14_row8_col4" class="data row8 col4" >0.0000</td>
      <td id="T_03a14_row8_col5" class="data row8 col5" >0.0000</td>
      <td id="T_03a14_row8_col6" class="data row8 col6" >0.0000</td>
      <td id="T_03a14_row8_col7" class="data row8 col7" >0.0000</td>
      <td id="T_03a14_row8_col8" class="data row8 col8" >0.0000</td>
      <td id="T_03a14_row8_col9" class="data row8 col9" >0.0000</td>
      <td id="T_03a14_row8_col10" class="data row8 col10" >0.0000</td>
      <td id="T_03a14_row8_col11" class="data row8 col11" >0.0000</td>
      <td id="T_03a14_row8_col12" class="data row8 col12" >0.0000</td>
      <td id="T_03a14_row8_col13" class="data row8 col13" >0.0000</td>
      <td id="T_03a14_row8_col14" class="data row8 col14" >0.0000</td>
      <td id="T_03a14_row8_col15" class="data row8 col15" >-0.0040</td>
      <td id="T_03a14_row8_col16" class="data row8 col16" >0.0041</td>
      <td id="T_03a14_row8_col17" class="data row8 col17" >1.1765</td>
      <td id="T_03a14_row8_col18" class="data row8 col18" >0.0000</td>
      <td id="T_03a14_row8_col19" class="data row8 col19" >0.0000</td>
      <td id="T_03a14_row8_col20" class="data row8 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_03a14_row9_col0" class="data row9 col0" >0.0000</td>
      <td id="T_03a14_row9_col1" class="data row9 col1" >0.0000</td>
      <td id="T_03a14_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_03a14_row9_col3" class="data row9 col3" >0.0012</td>
      <td id="T_03a14_row9_col4" class="data row9 col4" >0.0012</td>
      <td id="T_03a14_row9_col5" class="data row9 col5" >0.0000</td>
      <td id="T_03a14_row9_col6" class="data row9 col6" >0.0000</td>
      <td id="T_03a14_row9_col7" class="data row9 col7" >0.0000</td>
      <td id="T_03a14_row9_col8" class="data row9 col8" >0.0000</td>
      <td id="T_03a14_row9_col9" class="data row9 col9" >0.0000</td>
      <td id="T_03a14_row9_col10" class="data row9 col10" >0.0000</td>
      <td id="T_03a14_row9_col11" class="data row9 col11" >0.0000</td>
      <td id="T_03a14_row9_col12" class="data row9 col12" >0.0000</td>
      <td id="T_03a14_row9_col13" class="data row9 col13" >0.0000</td>
      <td id="T_03a14_row9_col14" class="data row9 col14" >0.0000</td>
      <td id="T_03a14_row9_col15" class="data row9 col15" >0.0000</td>
      <td id="T_03a14_row9_col16" class="data row9 col16" >0.0000</td>
      <td id="T_03a14_row9_col17" class="data row9 col17" >0.0000</td>
      <td id="T_03a14_row9_col18" class="data row9 col18" >0.0000</td>
      <td id="T_03a14_row9_col19" class="data row9 col19" >0.0000</td>
      <td id="T_03a14_row9_col20" class="data row9 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_03a14_row10_col0" class="data row10 col0" >0.0000</td>
      <td id="T_03a14_row10_col1" class="data row10 col1" >0.0000</td>
      <td id="T_03a14_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_03a14_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_03a14_row10_col4" class="data row10 col4" >0.0000</td>
      <td id="T_03a14_row10_col5" class="data row10 col5" >0.0000</td>
      <td id="T_03a14_row10_col6" class="data row10 col6" >0.0000</td>
      <td id="T_03a14_row10_col7" class="data row10 col7" >0.0000</td>
      <td id="T_03a14_row10_col8" class="data row10 col8" >0.0000</td>
      <td id="T_03a14_row10_col9" class="data row10 col9" >0.0000</td>
      <td id="T_03a14_row10_col10" class="data row10 col10" >0.0000</td>
      <td id="T_03a14_row10_col11" class="data row10 col11" >1.1765</td>
      <td id="T_03a14_row10_col12" class="data row10 col12" >0.0000</td>
      <td id="T_03a14_row10_col13" class="data row10 col13" >0.0000</td>
      <td id="T_03a14_row10_col14" class="data row10 col14" >0.0000</td>
      <td id="T_03a14_row10_col15" class="data row10 col15" >-0.0005</td>
      <td id="T_03a14_row10_col16" class="data row10 col16" >0.0019</td>
      <td id="T_03a14_row10_col17" class="data row10 col17" >0.0000</td>
      <td id="T_03a14_row10_col18" class="data row10 col18" >0.0000</td>
      <td id="T_03a14_row10_col19" class="data row10 col19" >0.0000</td>
      <td id="T_03a14_row10_col20" class="data row10 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_03a14_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_03a14_row11_col0" class="data row11 col0" >0.0000</td>
      <td id="T_03a14_row11_col1" class="data row11 col1" >0.0000</td>
      <td id="T_03a14_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_03a14_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_03a14_row11_col4" class="data row11 col4" >0.0000</td>
      <td id="T_03a14_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_03a14_row11_col6" class="data row11 col6" >0.0000</td>
      <td id="T_03a14_row11_col7" class="data row11 col7" >0.0000</td>
      <td id="T_03a14_row11_col8" class="data row11 col8" >0.0000</td>
      <td id="T_03a14_row11_col9" class="data row11 col9" >0.0000</td>
      <td id="T_03a14_row11_col10" class="data row11 col10" >0.0000</td>
      <td id="T_03a14_row11_col11" class="data row11 col11" >0.0000</td>
      <td id="T_03a14_row11_col12" class="data row11 col12" >0.0000</td>
      <td id="T_03a14_row11_col13" class="data row11 col13" >0.0000</td>
      <td id="T_03a14_row11_col14" class="data row11 col14" >0.0000</td>
      <td id="T_03a14_row11_col15" class="data row11 col15" >-0.0028</td>
      <td id="T_03a14_row11_col16" class="data row11 col16" >0.0033</td>
      <td id="T_03a14_row11_col17" class="data row11 col17" >0.0000</td>
      <td id="T_03a14_row11_col18" class="data row11 col18" >0.0000</td>
      <td id="T_03a14_row11_col19" class="data row11 col19" >0.0000</td>
      <td id="T_03a14_row11_col20" class="data row11 col20" >0.0000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It is clear from the table above that there is good agreement between the reproduced SPI values and those retrieved from ERA5‚ÄìDrought.
The median difference and median absolute difference are 0 for the vast majority of month‚Äìaccumulation period pairs,
and always ‚â§ 0.004.
Similarly,
the number of match-ups where the absolute difference is over our threshold of 0.10 is very small
(‚â§2.4%, corresponding to 1 or 2 match-ups for the 1940‚Äì2024 time span)
or none at all.
Differences between months and between accumulation periods are due to the fitting process being applied independently to each.
There are no apparent patterns across the different accumulation periods,
such as a particular month always being problematic,
although these may be expected in other sites.</p>
<p>Comparing the SPI time series
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries"><span class="std std-numref">6.1.2</span></a>)
shows that large differences occur only in isolated spikes,
generally at extreme values of SPI (below ‚Äì3 or above +3) where extreme deviations (e.g. from ‚Äì5 to ‚Äì8) are not meaningful [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
As such, these spikes do not cause a difference in SPI classifications
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion"><span class="std std-numref">6.1.3</span></a>).
The cause of these spikes is not clear,
since the underpinning data are the same and the similarity along the rest of the time series suggests that the fitted distributions are also (near-)equal.</p>
<p>In some cases,
such as SPI-36 and SPI-48 in Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries"><span class="std std-numref">6.1.2</span></a>,
small regular differences are observed.
These tend to be periodic per year,
indicating that they correspond to individual calendar months.
For example, the table above shows that SPI-48 is equal between the two datasets in all months except June and August.
These differences are the result of small differences in the obtained fit parameters,
which are likely caused by small differences in the fitting procedure and initial conditions.
Sensitivity to initial conditions and the fitting procedure is inherent to this type of regression-based indicator
and does not indicate a meaningful discrepancy in the reproducibility of ERA5‚ÄìDrought.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot time series comparison (absolute values and differences)</span>
<span class="n">plot_time_series_comparison_spi</span><span class="p">(</span><span class="n">spi_era5drought_site</span><span class="p">,</span> <span class="n">spi_reproduced_site</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-timeseries&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot confusion matrix comparison</span>
<span class="c1"># e.g. are all &quot;extremely dry&quot; data in ERA5‚ÄìDrought also &quot;extremely dry&quot; in the reproduction?</span>
<span class="n">plot_confusion_matrices_spi</span><span class="p">(</span><span class="n">spi_era5drought_site</span><span class="p">,</span> <span class="n">spi_reproduced_site</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-confusion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-0">
Time series</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries">
<img alt="../_images/452913369e04515f1f9eaa5b283cdce4f016183a75e4d9a14e96e08abab7f650.png" src="../_images/452913369e04515f1f9eaa5b283cdce4f016183a75e4d9a14e96e08abab7f650.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.2 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="confusion" for="sd-tab-item-1">
Confusion matrix</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion">
<img alt="../_images/3b1391da170d52f68f2b3d5e6855e5d8369fcf8a243500265bb6e42fd85a3479.png" src="../_images/3b1391da170d52f68f2b3d5e6855e5d8369fcf8a243500265bb6e42fd85a3479.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.3 </span><span class="caption-text">Confusion matrices for SPI categories from ERA5‚ÄìDrought vs. reproduced from ERA5, for the example site of Addis Ababa, Ethiopia, in 1940‚Äì2024.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="spi-comparison-regional-snapshot">
<h4>3.7 SPI comparison: Regional snapshot<a class="headerlink" href="#spi-comparison-regional-snapshot" title="Link to this heading">#</a></h4>
<p>Next, we investigate spatial patterns in SPI and the difference therein across a wider region around the example site.
This region is defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.
In this example, we look at part of the Horn of Africa using a box of 12¬∞ in all directions around Addis Ababa, Ethiopia.
To reduce computing requirements, the comparison is performed for one year only,
here 2024, again defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.</p>
<p>As in the time series comparison,
we subselect the desired data from ERA5 and calculate the corresponding SPI
and
download SPI from ERA5‚ÄìDrought for the desired region and time span:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_precipitation_region</span> <span class="o">=</span> <span class="n">data_era5_precipitation_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_region</span><span class="p">)</span>

<span class="c1"># Window in which to evaluate SPI</span>
<span class="n">evaluation_window</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">)}</span>  <span class="c1">#  Slice (2024-01-01, 2024-12-01)</span>

<span class="c1"># Calculate SPI</span>
<span class="n">spi_reproduced_region</span> <span class="o">=</span> <span class="n">calculate_spi_from_era5</span><span class="p">(</span><span class="n">data_era5_precipitation_region</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">,</span>
                                                <span class="n">evaluation_window</span><span class="o">=</span><span class="n">evaluation_window</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spi_reproduced_region</span> <span class="o">=</span> <span class="n">spi_reproduced_region</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spi_reproduced_region</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 6MB
Dimensions:  (lat: 97, lon: 97, time: 12)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
    month    (time) int64 96B dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;
  * time     (time) datetime64[ns] 96B 2024-01-01T06:00:00 ... 2024-12-01T06:...
    expver   (time) &lt;U4 192B dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;
Data variables:
    SPI1     (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI3     (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI6     (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI12    (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI24    (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI36    (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;
    SPI48    (lat, lon, time) float64 903kB dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cb0a0674-9fe6-4ffb-b323-cdbdb4da3c23' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cb0a0674-9fe6-4ffb-b323-cdbdb4da3c23' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li><li><span class='xr-has-index'>time</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7dc115dd-9a6e-46cb-992e-990ecce1bd7b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7dc115dd-9a6e-46cb-992e-990ecce1bd7b' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-43f948e4-d518-4e6b-9262-592e80ae52b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43f948e4-d518-4e6b-9262-592e80ae52b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2adf248-622f-45f6-b4b2-6e1c1dc2517f' class='xr-var-data-in' type='checkbox'><label for='data-d2adf248-622f-45f6-b4b2-6e1c1dc2517f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-9942015c-2723-4dbb-9aa0-95f5368d4719' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9942015c-2723-4dbb-9aa0-95f5368d4719' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5eda251-75ee-4ead-b33a-59d2bcbc94a2' class='xr-var-data-in' type='checkbox'><label for='data-f5eda251-75ee-4ead-b33a-59d2bcbc94a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-454f306b-12b1-4ebc-99b3-218163b6a680' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-454f306b-12b1-4ebc-99b3-218163b6a680' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4b32def-f6a9-4f2a-99d6-0707f85cc672' class='xr-var-data-in' type='checkbox'><label for='data-a4b32def-f6a9-4f2a-99d6-0707f85cc672' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;</div><input id='attrs-b2793960-a18d-406f-967e-bf2eed51170a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b2793960-a18d-406f-967e-bf2eed51170a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-746dcb5e-18b8-4dd4-92ad-0081571f9823' class='xr-var-data-in' type='checkbox'><label for='data-746dcb5e-18b8-4dd4-92ad-0081571f9823' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 96 B </td>
                        <td> 96 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12,) </td>
                        <td> (12,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.56358655585696 0.0,37.56358655585696" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.563587" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.000000" y="18.781793" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.781793)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-b6f32aca-70e6-4308-a7cc-c03127d70a74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b6f32aca-70e6-4308-a7cc-c03127d70a74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abfe2ebf-76a9-41cf-979c-0b817ecddfc1' class='xr-var-data-in' type='checkbox'><label for='data-abfe2ebf-76a9-41cf-979c-0b817ecddfc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-01-01T06:00:00.000000000&#x27;, &#x27;2024-02-01T06:00:00.000000000&#x27;,
       &#x27;2024-03-01T06:00:00.000000000&#x27;, &#x27;2024-04-01T06:00:00.000000000&#x27;,
       &#x27;2024-05-01T06:00:00.000000000&#x27;, &#x27;2024-06-01T06:00:00.000000000&#x27;,
       &#x27;2024-07-01T06:00:00.000000000&#x27;, &#x27;2024-08-01T06:00:00.000000000&#x27;,
       &#x27;2024-09-01T06:00:00.000000000&#x27;, &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;</div><input id='attrs-1f4e3e63-7a4b-443f-ac05-e4e813e3142b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1f4e3e63-7a4b-443f-ac05-e4e813e3142b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ae58ed9-a057-4528-9bef-b748a8ec6953' class='xr-var-data-in' type='checkbox'><label for='data-2ae58ed9-a057-4528-9bef-b748a8ec6953' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 192 B </td>
                        <td> 192 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12,) </td>
                        <td> (12,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.56358655585696 0.0,37.56358655585696" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.563587" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.000000" y="18.781793" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.781793)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ad2b3839-3437-4335-80dc-cf1c358f5ec2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ad2b3839-3437-4335-80dc-cf1c358f5ec2' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-407789b9-1b57-46d8-bdb2-8faf773000c5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-407789b9-1b57-46d8-bdb2-8faf773000c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34c10ef9-bcb2-4209-9617-dd5da6b0743d' class='xr-var-data-in' type='checkbox'><label for='data-34c10ef9-bcb2-4209-9617-dd5da6b0743d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-e4c7cc4b-65f9-4eac-83d2-e21b1a9a9117' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4c7cc4b-65f9-4eac-83d2-e21b1a9a9117' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89657917-05ee-41bb-9568-12c0a561d368' class='xr-var-data-in' type='checkbox'><label for='data-89657917-05ee-41bb-9568-12c0a561d368' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-d70f017d-85c2-48b6-b4b6-2d99c812b806' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d70f017d-85c2-48b6-b4b6-2d99c812b806' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70031bdd-ddd1-4dd8-848b-7d766bb145eb' class='xr-var-data-in' type='checkbox'><label for='data-70031bdd-ddd1-4dd8-848b-7d766bb145eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-44a308d1-9dc1-4f79-aff9-98446230313f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44a308d1-9dc1-4f79-aff9-98446230313f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-59cd27ab-25f3-4e4b-9176-32dbab767599' class='xr-var-data-in' type='checkbox'><label for='data-59cd27ab-25f3-4e4b-9176-32dbab767599' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-7dd85315-6d98-4c4b-8411-fc867850de32' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7dd85315-6d98-4c4b-8411-fc867850de32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8ec5b44-03a1-46a1-ad95-bb392c9b0f4d' class='xr-var-data-in' type='checkbox'><label for='data-d8ec5b44-03a1-46a1-ad95-bb392c9b0f4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-eecf3570-3f89-4301-a461-63a1a18c14be' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eecf3570-3f89-4301-a461-63a1a18c14be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06c7b6c3-e4d5-4cbc-845c-50dcf1faf58c' class='xr-var-data-in' type='checkbox'><label for='data-06c7b6c3-e4d5-4cbc-845c-50dcf1faf58c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(lat, lon, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(33, 97, 12), meta=np.ndarray&gt;</div><input id='attrs-37a9fc97-b2ee-4336-9621-7606ca86e107' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-37a9fc97-b2ee-4336-9621-7606ca86e107' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a29a6253-3780-475f-9444-edd415a622ad' class='xr-var-data-in' type='checkbox'><label for='data-a29a6253-3780-475f-9444-edd415a622ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (97, 97, 12) </td>
                        <td> (64, 97, 12) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="240" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="120" x2="80" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="34" y1="24" x2="34" y2="144" />
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,190.58823529411765 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="49" y2="0" style="stroke-width:2" />
  <line x1="34" y1="24" x2="73" y2="24" />
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="49" y1="0" x2="120" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 49.74021099023569,0.0 120.32844628435333,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="120" y2="70" style="stroke-width:2" />
  <line x1="80" y1="190" x2="120" y2="190" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="190" style="stroke-width:2" />
  <line x1="120" y1="70" x2="120" y2="190" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 120.32844628435333,70.58823529411765 120.32844628435333,190.58823529411765 80.58823529411765,190.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="100.458341" y="210.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.328446" y="130.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.328446,130.588235)">97</text>
  <text x="35.294118" y="175.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,175.294118)">97</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-f8a9605f-2cff-47c9-a9b7-67614af2e04e' class='xr-section-summary-in' type='checkbox'  ><label for='section-f8a9605f-2cff-47c9-a9b7-67614af2e04e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6da8069a-f2d7-4467-84ff-3dabf8e74881' class='xr-index-data-in' type='checkbox'/><label for='index-6da8069a-f2d7-4467-84ff-3dabf8e74881' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4bb2c9a8-cc1f-4c40-9662-bf26e364ed3f' class='xr-index-data-in' type='checkbox'/><label for='index-4bb2c9a8-cc1f-4c40-9662-bf26e364ed3f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f75baf81-3635-4239-b58c-d9f388deeb9c' class='xr-index-data-in' type='checkbox'/><label for='index-f75baf81-3635-4239-b58c-d9f388deeb9c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-01-01 06:00:00&#x27;, &#x27;2024-02-01 06:00:00&#x27;,
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6ec32d4b-055c-4a0b-9ddb-7f4fff0a2910' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6ec32d4b-055c-4a0b-9ddb-7f4fff0a2910' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main request, based on template and example region</span>
<span class="n">request_era5drought_spi</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index</span> <span class="o">|</span> <span class="n">request_region</span>

<span class="c1"># Select only desired year</span>
<span class="n">request_era5drought_spi</span> <span class="o">=</span> <span class="n">request_era5drought_spi</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],}</span>

<span class="c1"># Download data and load into xarray</span>
<span class="n">spi_era5drought_region</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="n">request_era5drought_spi</span><span class="p">)</span>
<span class="n">spi_era5drought_region</span> <span class="o">=</span> <span class="n">spi_era5drought_region</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">spi_era5drought_region</span> <span class="o">=</span> <span class="n">spi_era5drought_region</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Full time series in one chunk</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spi_era5drought_region</span> <span class="o">=</span> <span class="n">spi_era5drought_region</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spi_era5drought_region</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 6MB
Dimensions:  (time: 12, lat: 97, lon: 97)
Coordinates:
  * time     (time) datetime64[ns] 96B 2024-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
Data variables:
    SPI12    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI1     (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI24    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI36    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI3     (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI48    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPI6     (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
Attributes: (12/17)
    title:                   SPI12
    description:             Drought Index: Standardized Drought Index calcul...
    Conventions:             CF-1.8
    history:                 Created 30/10/2024 07:50:12 using DRYFALL.
    institution:             European Centre for Medium-Range Weather Forecasts
    source:                  DRYFALL v1.0
    ...                      ...
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    ref_publication:         Keune, J., Di Giuseppe, F., Barnard, C., Damasio...
    cds_data_catalogue_url:  https://cds.climate.copernicus.eu/datasets/deriv...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5a5516df-cf28-471c-82f2-60233d14e86b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5a5516df-cf28-471c-82f2-60233d14e86b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 12</li><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6ee31006-1ad8-411e-b6e4-54f4dc3f991c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6ee31006-1ad8-411e-b6e4-54f4dc3f991c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-780e2fb8-7138-430f-889c-cc4af83797de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-780e2fb8-7138-430f-889c-cc4af83797de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05c52cb3-104b-4715-9889-4e8bd6ecff76' class='xr-var-data-in' type='checkbox'><label for='data-05c52cb3-104b-4715-9889-4e8bd6ecff76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-01-01T06:00:00.000000000&#x27;, &#x27;2024-02-01T06:00:00.000000000&#x27;,
       &#x27;2024-03-01T06:00:00.000000000&#x27;, &#x27;2024-04-01T06:00:00.000000000&#x27;,
       &#x27;2024-05-01T06:00:00.000000000&#x27;, &#x27;2024-06-01T06:00:00.000000000&#x27;,
       &#x27;2024-07-01T06:00:00.000000000&#x27;, &#x27;2024-08-01T06:00:00.000000000&#x27;,
       &#x27;2024-09-01T06:00:00.000000000&#x27;, &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-a9ea0e6b-b68b-4122-8bef-daba4dd5c209' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9ea0e6b-b68b-4122-8bef-daba4dd5c209' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6ae2166-55c9-400f-beb0-4af22fefd61a' class='xr-var-data-in' type='checkbox'><label for='data-d6ae2166-55c9-400f-beb0-4af22fefd61a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-0c8abff1-4566-4e52-8f0b-d3816367768f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c8abff1-4566-4e52-8f0b-d3816367768f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04f85a19-01f5-4610-aa7f-1f8608fb0f95' class='xr-var-data-in' type='checkbox'><label for='data-04f85a19-01f5-4610-aa7f-1f8608fb0f95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9b4b735d-b000-4099-ba0c-fc8675e87326' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9b4b735d-b000-4099-ba0c-fc8675e87326' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-5179d450-21ce-4cbd-aeaf-bd2d2df5ec89' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5179d450-21ce-4cbd-aeaf-bd2d2df5ec89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26415a3a-fd31-4d19-897b-5a5d6788b389' class='xr-var-data-in' type='checkbox'><label for='data-26415a3a-fd31-4d19-897b-5a5d6788b389' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI12)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-04f669d6-ae7f-4fd5-929e-c1c070d0db0b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04f669d6-ae7f-4fd5-929e-c1c070d0db0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d69827d-5a49-4dcc-aec6-5e552b4e532c' class='xr-var-data-in' type='checkbox'><label for='data-3d69827d-5a49-4dcc-aec6-5e552b4e532c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI1)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-bb954930-ea41-4537-a6f2-6bfbcf7b3280' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb954930-ea41-4537-a6f2-6bfbcf7b3280' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0c63c9a-5e79-48b7-9626-2f81f36b264e' class='xr-var-data-in' type='checkbox'><label for='data-c0c63c9a-5e79-48b7-9626-2f81f36b264e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI24)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-1d800df3-20ea-4921-8616-dcbcf67a0a69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1d800df3-20ea-4921-8616-dcbcf67a0a69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6daaaa23-b0aa-4c4d-82ab-2cdd97153a5c' class='xr-var-data-in' type='checkbox'><label for='data-6daaaa23-b0aa-4c4d-82ab-2cdd97153a5c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI36)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-f04cb779-fb08-499b-92ed-97dd1dede583' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f04cb779-fb08-499b-92ed-97dd1dede583' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbeb579a-6958-4a73-ade2-9fd068684f87' class='xr-var-data-in' type='checkbox'><label for='data-cbeb579a-6958-4a73-ade2-9fd068684f87' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI3)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-3f9ff172-7c12-4733-b30f-b82245d73346' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f9ff172-7c12-4733-b30f-b82245d73346' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed5b3896-8f59-4d51-94c9-00f55b4f376f' class='xr-var-data-in' type='checkbox'><label for='data-ed5b3896-8f59-4d51-94c9-00f55b4f376f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI48)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-34aa0603-b196-4360-833c-716438fcb171' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34aa0603-b196-4360-833c-716438fcb171' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5338f962-d4b4-4153-9d41-559f496fc795' class='xr-var-data-in' type='checkbox'><label for='data-5338f962-d4b4-4153-9d41-559f496fc795' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPI6)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-a50cfd90-e55e-4de9-b7e3-55b83beba956' class='xr-section-summary-in' type='checkbox'  ><label for='section-a50cfd90-e55e-4de9-b7e3-55b83beba956' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a74419eb-f689-4d1b-9ba4-48f992d7d12c' class='xr-index-data-in' type='checkbox'/><label for='index-a74419eb-f689-4d1b-9ba4-48f992d7d12c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-01-01 06:00:00&#x27;, &#x27;2024-02-01 06:00:00&#x27;,
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-6c2ad6b3-f7ab-4cd9-ba0a-89baa999e810' class='xr-index-data-in' type='checkbox'/><label for='index-6c2ad6b3-f7ab-4cd9-ba0a-89baa999e810' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-08d17ae8-5cd6-4c3d-87ee-10a73cf904e9' class='xr-index-data-in' type='checkbox'/><label for='index-08d17ae8-5cd6-4c3d-87ee-10a73cf904e9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7d38bc7b-bd21-4bd8-8a06-73546450452c' class='xr-section-summary-in' type='checkbox'  ><label for='section-7d38bc7b-bd21-4bd8-8a06-73546450452c' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>SPI12</dd><dt><span>description :</span></dt><dd>Drought Index: Standardized Drought Index calculated according to the WMO guidelines (see https://library.wmo.int/doc_num.php?explnum_id=7768).</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>history :</span></dt><dd>Created 30/10/2024 07:50:12 using DRYFALL.</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., Di Giuseppe, F., Barnard, C., Damasio da Costa, E., and Wetterhall, F. (2025): ERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis, Scientific Data 12, 616. https://doi.org/10.1038/s41597-025-04896-y</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://cds.climate.copernicus.eu/datasets/derived-drought-historical-monthly</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>As before,
we examine the per-point difference in SPI between ERA5‚ÄìDrought and the reproduction for each calendar month and each accumulation period:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI median differences</span>
<span class="n">spi_difference_region</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spi_era5drought_region</span><span class="p">,</span> <span class="n">spi_reproduced_region</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spi_difference_region</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_72e02 th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_72e02 th.col_heading {
  border-bottom: 0;
}
#T_72e02 table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_72e02 th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_72e02_row0_col0, #T_72e02_row0_col3, #T_72e02_row0_col6, #T_72e02_row0_col9, #T_72e02_row0_col12, #T_72e02_row0_col15, #T_72e02_row0_col18, #T_72e02_row1_col0, #T_72e02_row1_col3, #T_72e02_row1_col6, #T_72e02_row1_col9, #T_72e02_row1_col12, #T_72e02_row1_col15, #T_72e02_row1_col18, #T_72e02_row2_col0, #T_72e02_row2_col3, #T_72e02_row2_col6, #T_72e02_row2_col9, #T_72e02_row2_col12, #T_72e02_row2_col15, #T_72e02_row2_col18, #T_72e02_row3_col0, #T_72e02_row3_col3, #T_72e02_row3_col6, #T_72e02_row3_col9, #T_72e02_row3_col12, #T_72e02_row3_col15, #T_72e02_row3_col18, #T_72e02_row4_col0, #T_72e02_row4_col3, #T_72e02_row4_col6, #T_72e02_row4_col9, #T_72e02_row4_col12, #T_72e02_row4_col15, #T_72e02_row4_col18, #T_72e02_row5_col0, #T_72e02_row5_col3, #T_72e02_row5_col6, #T_72e02_row5_col9, #T_72e02_row5_col12, #T_72e02_row5_col15, #T_72e02_row5_col18, #T_72e02_row6_col0, #T_72e02_row6_col3, #T_72e02_row6_col6, #T_72e02_row6_col9, #T_72e02_row6_col12, #T_72e02_row6_col15, #T_72e02_row6_col18, #T_72e02_row7_col0, #T_72e02_row7_col3, #T_72e02_row7_col6, #T_72e02_row7_col9, #T_72e02_row7_col12, #T_72e02_row7_col15, #T_72e02_row7_col18, #T_72e02_row8_col0, #T_72e02_row8_col3, #T_72e02_row8_col6, #T_72e02_row8_col9, #T_72e02_row8_col12, #T_72e02_row8_col15, #T_72e02_row8_col18, #T_72e02_row9_col0, #T_72e02_row9_col3, #T_72e02_row9_col6, #T_72e02_row9_col9, #T_72e02_row9_col12, #T_72e02_row9_col15, #T_72e02_row9_col18, #T_72e02_row10_col0, #T_72e02_row10_col3, #T_72e02_row10_col6, #T_72e02_row10_col9, #T_72e02_row10_col12, #T_72e02_row10_col15, #T_72e02_row10_col18, #T_72e02_row11_col0, #T_72e02_row11_col3, #T_72e02_row11_col6, #T_72e02_row11_col9, #T_72e02_row11_col12, #T_72e02_row11_col15, #T_72e02_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_72e02">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_72e02_level0_col0" class="col_heading level0 col0" colspan="3">SPI-1</th>
      <th id="T_72e02_level0_col3" class="col_heading level0 col3" colspan="3">SPI-3</th>
      <th id="T_72e02_level0_col6" class="col_heading level0 col6" colspan="3">SPI-6</th>
      <th id="T_72e02_level0_col9" class="col_heading level0 col9" colspan="3">SPI-12</th>
      <th id="T_72e02_level0_col12" class="col_heading level0 col12" colspan="3">SPI-24</th>
      <th id="T_72e02_level0_col15" class="col_heading level0 col15" colspan="3">SPI-36</th>
      <th id="T_72e02_level0_col18" class="col_heading level0 col18" colspan="3">SPI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_72e02_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_72e02_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_72e02_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_72e02_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_72e02_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_72e02_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_72e02_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_72e02_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_72e02_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_72e02_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_72e02_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_72e02_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_72e02_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_72e02_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_72e02_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_72e02_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_72e02_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_72e02_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_72e02_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_72e02_row0_col2" class="data row0 col2" >15.5702</td>
      <td id="T_72e02_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_72e02_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_72e02_row0_col5" class="data row0 col5" >8.7576</td>
      <td id="T_72e02_row0_col6" class="data row0 col6" >0.0000</td>
      <td id="T_72e02_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_72e02_row0_col8" class="data row0 col8" >6.8658</td>
      <td id="T_72e02_row0_col9" class="data row0 col9" >0.0000</td>
      <td id="T_72e02_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_72e02_row0_col11" class="data row0 col11" >1.2754</td>
      <td id="T_72e02_row0_col12" class="data row0 col12" >0.0000</td>
      <td id="T_72e02_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_72e02_row0_col14" class="data row0 col14" >16.4842</td>
      <td id="T_72e02_row0_col15" class="data row0 col15" >0.0000</td>
      <td id="T_72e02_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_72e02_row0_col17" class="data row0 col17" >0.0106</td>
      <td id="T_72e02_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_72e02_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_72e02_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_72e02_row1_col0" class="data row1 col0" >0.0000</td>
      <td id="T_72e02_row1_col1" class="data row1 col1" >0.0000</td>
      <td id="T_72e02_row1_col2" class="data row1 col2" >20.0128</td>
      <td id="T_72e02_row1_col3" class="data row1 col3" >0.0000</td>
      <td id="T_72e02_row1_col4" class="data row1 col4" >0.0000</td>
      <td id="T_72e02_row1_col5" class="data row1 col5" >8.5556</td>
      <td id="T_72e02_row1_col6" class="data row1 col6" >0.0000</td>
      <td id="T_72e02_row1_col7" class="data row1 col7" >0.0000</td>
      <td id="T_72e02_row1_col8" class="data row1 col8" >6.9402</td>
      <td id="T_72e02_row1_col9" class="data row1 col9" >0.0000</td>
      <td id="T_72e02_row1_col10" class="data row1 col10" >0.0000</td>
      <td id="T_72e02_row1_col11" class="data row1 col11" >1.5730</td>
      <td id="T_72e02_row1_col12" class="data row1 col12" >0.0000</td>
      <td id="T_72e02_row1_col13" class="data row1 col13" >0.0000</td>
      <td id="T_72e02_row1_col14" class="data row1 col14" >16.5374</td>
      <td id="T_72e02_row1_col15" class="data row1 col15" >0.0000</td>
      <td id="T_72e02_row1_col16" class="data row1 col16" >0.0000</td>
      <td id="T_72e02_row1_col17" class="data row1 col17" >0.0425</td>
      <td id="T_72e02_row1_col18" class="data row1 col18" >0.0000</td>
      <td id="T_72e02_row1_col19" class="data row1 col19" >0.0000</td>
      <td id="T_72e02_row1_col20" class="data row1 col20" >0.0319</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_72e02_row2_col0" class="data row2 col0" >0.0000</td>
      <td id="T_72e02_row2_col1" class="data row2 col1" >0.0000</td>
      <td id="T_72e02_row2_col2" class="data row2 col2" >18.1422</td>
      <td id="T_72e02_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_72e02_row2_col4" class="data row2 col4" >0.0000</td>
      <td id="T_72e02_row2_col5" class="data row2 col5" >11.7653</td>
      <td id="T_72e02_row2_col6" class="data row2 col6" >0.0000</td>
      <td id="T_72e02_row2_col7" class="data row2 col7" >0.0000</td>
      <td id="T_72e02_row2_col8" class="data row2 col8" >7.3228</td>
      <td id="T_72e02_row2_col9" class="data row2 col9" >0.0000</td>
      <td id="T_72e02_row2_col10" class="data row2 col10" >0.0000</td>
      <td id="T_72e02_row2_col11" class="data row2 col11" >1.2754</td>
      <td id="T_72e02_row2_col12" class="data row2 col12" >0.0000</td>
      <td id="T_72e02_row2_col13" class="data row2 col13" >0.0000</td>
      <td id="T_72e02_row2_col14" class="data row2 col14" >16.5374</td>
      <td id="T_72e02_row2_col15" class="data row2 col15" >0.0000</td>
      <td id="T_72e02_row2_col16" class="data row2 col16" >0.0000</td>
      <td id="T_72e02_row2_col17" class="data row2 col17" >0.0213</td>
      <td id="T_72e02_row2_col18" class="data row2 col18" >0.0000</td>
      <td id="T_72e02_row2_col19" class="data row2 col19" >0.0000</td>
      <td id="T_72e02_row2_col20" class="data row2 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_72e02_row3_col0" class="data row3 col0" >0.0000</td>
      <td id="T_72e02_row3_col1" class="data row3 col1" >0.0000</td>
      <td id="T_72e02_row3_col2" class="data row3 col2" >10.3093</td>
      <td id="T_72e02_row3_col3" class="data row3 col3" >0.0000</td>
      <td id="T_72e02_row3_col4" class="data row3 col4" >0.0000</td>
      <td id="T_72e02_row3_col5" class="data row3 col5" >11.5315</td>
      <td id="T_72e02_row3_col6" class="data row3 col6" >0.0000</td>
      <td id="T_72e02_row3_col7" class="data row3 col7" >0.0000</td>
      <td id="T_72e02_row3_col8" class="data row3 col8" >11.4146</td>
      <td id="T_72e02_row3_col9" class="data row3 col9" >0.0000</td>
      <td id="T_72e02_row3_col10" class="data row3 col10" >0.0000</td>
      <td id="T_72e02_row3_col11" class="data row3 col11" >1.4454</td>
      <td id="T_72e02_row3_col12" class="data row3 col12" >0.0000</td>
      <td id="T_72e02_row3_col13" class="data row3 col13" >0.0000</td>
      <td id="T_72e02_row3_col14" class="data row3 col14" >16.5586</td>
      <td id="T_72e02_row3_col15" class="data row3 col15" >0.0000</td>
      <td id="T_72e02_row3_col16" class="data row3 col16" >0.0000</td>
      <td id="T_72e02_row3_col17" class="data row3 col17" >0.0425</td>
      <td id="T_72e02_row3_col18" class="data row3 col18" >0.0000</td>
      <td id="T_72e02_row3_col19" class="data row3 col19" >0.0000</td>
      <td id="T_72e02_row3_col20" class="data row3 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_72e02_row4_col0" class="data row4 col0" >0.0000</td>
      <td id="T_72e02_row4_col1" class="data row4 col1" >0.0000</td>
      <td id="T_72e02_row4_col2" class="data row4 col2" >10.8194</td>
      <td id="T_72e02_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_72e02_row4_col4" class="data row4 col4" >0.0000</td>
      <td id="T_72e02_row4_col5" class="data row4 col5" >6.7701</td>
      <td id="T_72e02_row4_col6" class="data row4 col6" >0.0000</td>
      <td id="T_72e02_row4_col7" class="data row4 col7" >0.0000</td>
      <td id="T_72e02_row4_col8" class="data row4 col8" >5.6116</td>
      <td id="T_72e02_row4_col9" class="data row4 col9" >0.0000</td>
      <td id="T_72e02_row4_col10" class="data row4 col10" >0.0000</td>
      <td id="T_72e02_row4_col11" class="data row4 col11" >1.4135</td>
      <td id="T_72e02_row4_col12" class="data row4 col12" >0.0000</td>
      <td id="T_72e02_row4_col13" class="data row4 col13" >0.0000</td>
      <td id="T_72e02_row4_col14" class="data row4 col14" >16.5055</td>
      <td id="T_72e02_row4_col15" class="data row4 col15" >0.0000</td>
      <td id="T_72e02_row4_col16" class="data row4 col16" >0.0000</td>
      <td id="T_72e02_row4_col17" class="data row4 col17" >0.0425</td>
      <td id="T_72e02_row4_col18" class="data row4 col18" >0.0000</td>
      <td id="T_72e02_row4_col19" class="data row4 col19" >0.0000</td>
      <td id="T_72e02_row4_col20" class="data row4 col20" >0.0213</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_72e02_row5_col0" class="data row5 col0" >0.0000</td>
      <td id="T_72e02_row5_col1" class="data row5 col1" >0.0000</td>
      <td id="T_72e02_row5_col2" class="data row5 col2" >8.2155</td>
      <td id="T_72e02_row5_col3" class="data row5 col3" >0.0000</td>
      <td id="T_72e02_row5_col4" class="data row5 col4" >0.0000</td>
      <td id="T_72e02_row5_col5" class="data row5 col5" >6.3237</td>
      <td id="T_72e02_row5_col6" class="data row5 col6" >0.0000</td>
      <td id="T_72e02_row5_col7" class="data row5 col7" >0.0000</td>
      <td id="T_72e02_row5_col8" class="data row5 col8" >5.2078</td>
      <td id="T_72e02_row5_col9" class="data row5 col9" >0.0000</td>
      <td id="T_72e02_row5_col10" class="data row5 col10" >0.0000</td>
      <td id="T_72e02_row5_col11" class="data row5 col11" >1.4879</td>
      <td id="T_72e02_row5_col12" class="data row5 col12" >0.0000</td>
      <td id="T_72e02_row5_col13" class="data row5 col13" >0.0000</td>
      <td id="T_72e02_row5_col14" class="data row5 col14" >16.4948</td>
      <td id="T_72e02_row5_col15" class="data row5 col15" >0.0000</td>
      <td id="T_72e02_row5_col16" class="data row5 col16" >0.0000</td>
      <td id="T_72e02_row5_col17" class="data row5 col17" >0.0744</td>
      <td id="T_72e02_row5_col18" class="data row5 col18" >0.0000</td>
      <td id="T_72e02_row5_col19" class="data row5 col19" >0.0000</td>
      <td id="T_72e02_row5_col20" class="data row5 col20" >0.0531</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_72e02_row6_col0" class="data row6 col0" >0.0000</td>
      <td id="T_72e02_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_72e02_row6_col2" class="data row6 col2" >12.1586</td>
      <td id="T_72e02_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_72e02_row6_col4" class="data row6 col4" >0.0000</td>
      <td id="T_72e02_row6_col5" class="data row6 col5" >9.2571</td>
      <td id="T_72e02_row6_col6" class="data row6 col6" >0.0000</td>
      <td id="T_72e02_row6_col7" class="data row6 col7" >0.0000</td>
      <td id="T_72e02_row6_col8" class="data row6 col8" >5.6648</td>
      <td id="T_72e02_row6_col9" class="data row6 col9" >0.0000</td>
      <td id="T_72e02_row6_col10" class="data row6 col10" >0.0000</td>
      <td id="T_72e02_row6_col11" class="data row6 col11" >0.9884</td>
      <td id="T_72e02_row6_col12" class="data row6 col12" >0.0000</td>
      <td id="T_72e02_row6_col13" class="data row6 col13" >0.0000</td>
      <td id="T_72e02_row6_col14" class="data row6 col14" >16.4523</td>
      <td id="T_72e02_row6_col15" class="data row6 col15" >0.0000</td>
      <td id="T_72e02_row6_col16" class="data row6 col16" >0.0000</td>
      <td id="T_72e02_row6_col17" class="data row6 col17" >0.0531</td>
      <td id="T_72e02_row6_col18" class="data row6 col18" >0.0000</td>
      <td id="T_72e02_row6_col19" class="data row6 col19" >0.0000</td>
      <td id="T_72e02_row6_col20" class="data row6 col20" >0.0744</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_72e02_row7_col0" class="data row7 col0" >0.0000</td>
      <td id="T_72e02_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_72e02_row7_col2" class="data row7 col2" >14.2842</td>
      <td id="T_72e02_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_72e02_row7_col4" class="data row7 col4" >0.0000</td>
      <td id="T_72e02_row7_col5" class="data row7 col5" >8.0242</td>
      <td id="T_72e02_row7_col6" class="data row7 col6" >0.0000</td>
      <td id="T_72e02_row7_col7" class="data row7 col7" >0.0000</td>
      <td id="T_72e02_row7_col8" class="data row7 col8" >2.7527</td>
      <td id="T_72e02_row7_col9" class="data row7 col9" >0.0000</td>
      <td id="T_72e02_row7_col10" class="data row7 col10" >0.0000</td>
      <td id="T_72e02_row7_col11" class="data row7 col11" >1.3285</td>
      <td id="T_72e02_row7_col12" class="data row7 col12" >0.0000</td>
      <td id="T_72e02_row7_col13" class="data row7 col13" >0.0000</td>
      <td id="T_72e02_row7_col14" class="data row7 col14" >16.4842</td>
      <td id="T_72e02_row7_col15" class="data row7 col15" >0.0000</td>
      <td id="T_72e02_row7_col16" class="data row7 col16" >0.0000</td>
      <td id="T_72e02_row7_col17" class="data row7 col17" >0.0213</td>
      <td id="T_72e02_row7_col18" class="data row7 col18" >0.0000</td>
      <td id="T_72e02_row7_col19" class="data row7 col19" >0.0000</td>
      <td id="T_72e02_row7_col20" class="data row7 col20" >0.0744</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_72e02_row8_col0" class="data row8 col0" >0.0000</td>
      <td id="T_72e02_row8_col1" class="data row8 col1" >0.0000</td>
      <td id="T_72e02_row8_col2" class="data row8 col2" >8.7895</td>
      <td id="T_72e02_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_72e02_row8_col4" class="data row8 col4" >0.0000</td>
      <td id="T_72e02_row8_col5" class="data row8 col5" >7.7798</td>
      <td id="T_72e02_row8_col6" class="data row8 col6" >0.0000</td>
      <td id="T_72e02_row8_col7" class="data row8 col7" >0.0000</td>
      <td id="T_72e02_row8_col8" class="data row8 col8" >3.3797</td>
      <td id="T_72e02_row8_col9" class="data row8 col9" >0.0000</td>
      <td id="T_72e02_row8_col10" class="data row8 col10" >0.0000</td>
      <td id="T_72e02_row8_col11" class="data row8 col11" >1.2329</td>
      <td id="T_72e02_row8_col12" class="data row8 col12" >0.0000</td>
      <td id="T_72e02_row8_col13" class="data row8 col13" >0.0000</td>
      <td id="T_72e02_row8_col14" class="data row8 col14" >16.4948</td>
      <td id="T_72e02_row8_col15" class="data row8 col15" >0.0000</td>
      <td id="T_72e02_row8_col16" class="data row8 col16" >0.0000</td>
      <td id="T_72e02_row8_col17" class="data row8 col17" >0.0213</td>
      <td id="T_72e02_row8_col18" class="data row8 col18" >0.0000</td>
      <td id="T_72e02_row8_col19" class="data row8 col19" >0.0000</td>
      <td id="T_72e02_row8_col20" class="data row8 col20" >0.0638</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_72e02_row9_col0" class="data row9 col0" >0.0000</td>
      <td id="T_72e02_row9_col1" class="data row9 col1" >0.0000</td>
      <td id="T_72e02_row9_col2" class="data row9 col2" >7.4397</td>
      <td id="T_72e02_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_72e02_row9_col4" class="data row9 col4" >0.0000</td>
      <td id="T_72e02_row9_col5" class="data row9 col5" >6.7063</td>
      <td id="T_72e02_row9_col6" class="data row9 col6" >0.0000</td>
      <td id="T_72e02_row9_col7" class="data row9 col7" >0.0000</td>
      <td id="T_72e02_row9_col8" class="data row9 col8" >4.2406</td>
      <td id="T_72e02_row9_col9" class="data row9 col9" >0.0000</td>
      <td id="T_72e02_row9_col10" class="data row9 col10" >0.0000</td>
      <td id="T_72e02_row9_col11" class="data row9 col11" >1.5836</td>
      <td id="T_72e02_row9_col12" class="data row9 col12" >0.0000</td>
      <td id="T_72e02_row9_col13" class="data row9 col13" >0.0000</td>
      <td id="T_72e02_row9_col14" class="data row9 col14" >16.4630</td>
      <td id="T_72e02_row9_col15" class="data row9 col15" >0.0000</td>
      <td id="T_72e02_row9_col16" class="data row9 col16" >0.0000</td>
      <td id="T_72e02_row9_col17" class="data row9 col17" >0.0319</td>
      <td id="T_72e02_row9_col18" class="data row9 col18" >0.0000</td>
      <td id="T_72e02_row9_col19" class="data row9 col19" >0.0000</td>
      <td id="T_72e02_row9_col20" class="data row9 col20" >0.0213</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_72e02_row10_col0" class="data row10 col0" >0.0000</td>
      <td id="T_72e02_row10_col1" class="data row10 col1" >0.0000</td>
      <td id="T_72e02_row10_col2" class="data row10 col2" >8.2581</td>
      <td id="T_72e02_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_72e02_row10_col4" class="data row10 col4" >0.0000</td>
      <td id="T_72e02_row10_col5" class="data row10 col5" >9.0764</td>
      <td id="T_72e02_row10_col6" class="data row10 col6" >0.0000</td>
      <td id="T_72e02_row10_col7" class="data row10 col7" >0.0000</td>
      <td id="T_72e02_row10_col8" class="data row10 col8" >4.5913</td>
      <td id="T_72e02_row10_col9" class="data row10 col9" >0.0000</td>
      <td id="T_72e02_row10_col10" class="data row10 col10" >0.0000</td>
      <td id="T_72e02_row10_col11" class="data row10 col11" >1.2435</td>
      <td id="T_72e02_row10_col12" class="data row10 col12" >0.0000</td>
      <td id="T_72e02_row10_col13" class="data row10 col13" >0.0000</td>
      <td id="T_72e02_row10_col14" class="data row10 col14" >16.4523</td>
      <td id="T_72e02_row10_col15" class="data row10 col15" >0.0000</td>
      <td id="T_72e02_row10_col16" class="data row10 col16" >0.0000</td>
      <td id="T_72e02_row10_col17" class="data row10 col17" >0.0425</td>
      <td id="T_72e02_row10_col18" class="data row10 col18" >0.0000</td>
      <td id="T_72e02_row10_col19" class="data row10 col19" >0.0000</td>
      <td id="T_72e02_row10_col20" class="data row10 col20" >0.0213</td>
    </tr>
    <tr>
      <th id="T_72e02_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_72e02_row11_col0" class="data row11 col0" >0.0000</td>
      <td id="T_72e02_row11_col1" class="data row11 col1" >0.0000</td>
      <td id="T_72e02_row11_col2" class="data row11 col2" >10.1711</td>
      <td id="T_72e02_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_72e02_row11_col4" class="data row11 col4" >0.0000</td>
      <td id="T_72e02_row11_col5" class="data row11 col5" >7.6204</td>
      <td id="T_72e02_row11_col6" class="data row11 col6" >0.0000</td>
      <td id="T_72e02_row11_col7" class="data row11 col7" >0.0000</td>
      <td id="T_72e02_row11_col8" class="data row11 col8" >4.4851</td>
      <td id="T_72e02_row11_col9" class="data row11 col9" >0.0000</td>
      <td id="T_72e02_row11_col10" class="data row11 col10" >0.0000</td>
      <td id="T_72e02_row11_col11" class="data row11 col11" >1.3073</td>
      <td id="T_72e02_row11_col12" class="data row11 col12" >0.0000</td>
      <td id="T_72e02_row11_col13" class="data row11 col13" >0.0000</td>
      <td id="T_72e02_row11_col14" class="data row11 col14" >16.4948</td>
      <td id="T_72e02_row11_col15" class="data row11 col15" >0.0000</td>
      <td id="T_72e02_row11_col16" class="data row11 col16" >0.0000</td>
      <td id="T_72e02_row11_col17" class="data row11 col17" >0.0319</td>
      <td id="T_72e02_row11_col18" class="data row11 col18" >0.0000</td>
      <td id="T_72e02_row11_col19" class="data row11 col19" >0.0000</td>
      <td id="T_72e02_row11_col20" class="data row11 col20" >0.0425</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As before, the differences between ERA5‚ÄìDrought and reproduced SPI are small to zero in most cases.
Notably, differences of more than 0.10 appear in a larger number of match-ups than before,
more commonly for short accumulation periods than for long ones.
This is likely because the time series for longer accumulation periods are smoother,
which makes it easier for the fitting procedure to converge on the same optimal parameters.
There is no clear cause for certain months showing more difference than others,
such as local seasonal trends [<a class="reference external" href="https://doi.org/10.1038/s41598-019-47933-8" rel="noreferrer" target="_blank">Gebrechorkos+19</a>],
although the region may be too large and diverse to draw such correlations.</p>
<p>The distribution across the example region
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-geospatial"><span class="std std-numref">6.1.4</span></a>)
shows that
for SPI-3 and longer, discrepancies are concentrated in deserts (Sahara, Arabian peninsula) where zero-precipitation months are common
and hence it is harder to appropriately fit SPI.
In fact,
many of these areas are flagged for low data quality or even not fitted at all in ERA5‚ÄìDrought,
as discussed in the next subsection.
For SPI-1,
differences between the two datasets appear more randomly spread out.
Note that the grey area in the top left of the reproduced SPI-1 panel (Sudan) corresponds to NaN values,
i.e. areas where the fitting procedure could not converge at all.
Lastly, the large differences in SPI-24 are seemingly due to an issue with ERA5‚ÄìDrought‚Äôs land-sea mask;
SPI-24 is ‚Äì9999 on all water pixels in ERA5‚ÄìDrought,
which is clearly a filler value and not real data.
We have not applied a land-sea mask to the reproduction, causing these large differences in SPI-24 only.</p>
<p>The generally good agreement in SPI translates into good agreement in classification
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion-region"><span class="std std-numref">6.1.5</span></a>),
although some pixels do get classified differently in ERA5‚ÄìDrought vs. the reproduced dataset.
Mismatches occur mostly between adjacent categories
(e.g. ‚Äúmoderately wet‚Äù and ‚Äúseverely wet‚Äù),
although there are outliers in shorter accumulation periods;
some of these likely correspond to pixels where quality flags would normally be applied [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot geospatial comparison: SPI in one region</span>
<span class="n">plot_geospatial_comparison</span><span class="p">(</span><span class="n">spi_era5drought_region</span><span class="p">,</span> <span class="n">spi_reproduced_region</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPI&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">,</span>
                           <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                           <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-geospatial&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot confusion matrix comparison</span>
<span class="c1"># e.g. are all &quot;extremely dry&quot; data in ERA5‚ÄìDrought also &quot;extremely dry&quot; in the reproduction?</span>
<span class="n">plot_confusion_matrices_spi</span><span class="p">(</span><span class="n">spi_era5drought_region</span><span class="p">,</span> <span class="n">spi_reproduced_region</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; in </span><span class="si">{</span><span class="n">label_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-confusion-region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-2">
Geospatial</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-geospatial">
<img alt="../_images/088f96a424e36c4934ad7a112d97516de92b597eba39d7581aff44b71ca364de.png" src="../_images/088f96a424e36c4934ad7a112d97516de92b597eba39d7581aff44b71ca364de.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.4 </span><span class="caption-text">SPI downloaded from ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference between the two (right), for the region around the example site of Addis Ababa, Ethiopia.
Only one month (December 2024) is displayed.
Colours correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-geospatial" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="confusion" for="sd-tab-item-3">
Confusion matrix</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion-region">
<img alt="../_images/7d237feb7006a5a1c741e81d9c586f2109daf20849f264ce56530b59ce0fe604.png" src="../_images/7d237feb7006a5a1c741e81d9c586f2109daf20849f264ce56530b59ce0fe604.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.5 </span><span class="caption-text">Confusion matrices for SPI categories from ERA5‚ÄìDrought vs. reproduced from ERA5, across the region around the example site of Addis Ababa, Ethiopia.
Combines data for all months within one year (2024).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-confusion-region" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="quality-flags-probability-of-zero-precipitation">
<h4>3.8 Quality flags: Probability of zero precipitation<a class="headerlink" href="#quality-flags-probability-of-zero-precipitation" title="Link to this heading">#</a></h4>
<p>One of the quality flags included in ERA5‚ÄìDrought is the probability of zero precipitation <em>p<sub>0</sub></em>.
This represents,
for each calendar month and accumulation period,
the fraction of months within the reference period (1991‚Äì2020) where precipitation was zero.
While the ERA5‚ÄìDrought implementation of SPI accounts for months with zero precipitation by shifting the CDF,
as demonstrated above,
those months do skew the fitted distribution and reduce the reliability of the index.
In ERA5‚ÄìDrought,
the gamma distribution is not even fitted if at least 10 out of 30 months in the reference window have 0 precipitation,
and the authors recommend that users filter out locations with a lower threshold, such as <em>p<sub>0</sub></em> &gt; 0.1 [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</p>
<p>Unlike the zero-precipitation correction,
this quality flag uses an unweighted probability, with <em>n<sub>0</sub></em> the number of months with zero precipitation and <em>n</em> the total number of months in the reference window (30):</p>
<div class="math notranslate nohighlight">
\[
p_0 = \frac{n_0}{n + 1}
\]</div>
<p>In this subsection, we reproduce the <em>p<sub>0</sub></em> quality flag and its derived masks,
and compare their values to those provided in ERA5‚ÄìDrought.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accumulate total precipitation</span>
<span class="n">data_era5_precipitation</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">data_era5_precipitation_preprocessed</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">)</span>

<span class="c1"># Select data in reference window</span>
<span class="n">data_era5_precipitation_reference</span> <span class="o">=</span> <span class="n">data_era5_precipitation</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Calculate the probability of zero precipitation</span>
<span class="n">p_zero_reproduced</span> <span class="o">=</span> <span class="n">probability_of_zero_precipitation</span><span class="p">(</span><span class="n">data_era5_precipitation_reference</span><span class="p">)</span>

<span class="c1"># Retain in memory</span>
<span class="n">p_zero_reproduced</span> <span class="o">=</span> <span class="n">p_zero_reproduced</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">p_zero_reproduced</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 698MB
Dimensions:  (lat: 721, lon: 1440, month: 12)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    tp1      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp3      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp6      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp12     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp24     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp36     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;
    tp48     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ed893c00-2fb2-4171-9659-79966287c5f1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ed893c00-2fb2-4171-9659-79966287c5f1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>month</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e7edd29a-aa7e-46fc-ba0f-20ad3076e5a3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e7edd29a-aa7e-46fc-ba0f-20ad3076e5a3' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-0472db2f-b6f1-4db2-9e08-294fcafd9bbe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0472db2f-b6f1-4db2-9e08-294fcafd9bbe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14df3dc4-d666-4d0a-9c96-504c385c161b' class='xr-var-data-in' type='checkbox'><label for='data-14df3dc4-d666-4d0a-9c96-504c385c161b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-44344fba-a51c-4c8b-b979-e387d2340b1b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-44344fba-a51c-4c8b-b979-e387d2340b1b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ffd650da-e09d-4980-81fb-65df1ac5749c' class='xr-var-data-in' type='checkbox'><label for='data-ffd650da-e09d-4980-81fb-65df1ac5749c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-788e7778-b210-4ea7-9140-63ed7217f37f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-788e7778-b210-4ea7-9140-63ed7217f37f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40d7e928-56e4-458c-bbcb-a710e1d58220' class='xr-var-data-in' type='checkbox'><label for='data-40d7e928-56e4-458c-bbcb-a710e1d58220' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-e75ae3c4-41dd-4a62-b44e-f1ffb97816f5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e75ae3c4-41dd-4a62-b44e-f1ffb97816f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71be52bb-93cd-423f-b3de-a94da75d21b9' class='xr-var-data-in' type='checkbox'><label for='data-71be52bb-93cd-423f-b3de-a94da75d21b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-22985e43-d7d8-4cb7-bf36-5cc399107785' class='xr-section-summary-in' type='checkbox'  checked><label for='section-22985e43-d7d8-4cb7-bf36-5cc399107785' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-b8e73085-e805-4a55-a6c1-2ef6c13bb7c5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b8e73085-e805-4a55-a6c1-2ef6c13bb7c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-437f573c-6d6b-44f1-8941-8841bc5580e9' class='xr-var-data-in' type='checkbox'><label for='data-437f573c-6d6b-44f1-8941-8841bc5580e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-3b260461-d4f6-4f11-b3e9-11af07f7e900' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3b260461-d4f6-4f11-b3e9-11af07f7e900' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6748222b-5e51-4c88-908b-c93102ac8be9' class='xr-var-data-in' type='checkbox'><label for='data-6748222b-5e51-4c88-908b-c93102ac8be9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-acf28024-d8e9-45b8-bbb8-ffe485f5af82' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-acf28024-d8e9-45b8-bbb8-ffe485f5af82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7311e810-1010-44b4-a1ff-cc7988a1c3f5' class='xr-var-data-in' type='checkbox'><label for='data-7311e810-1010-44b4-a1ff-cc7988a1c3f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-065a22a8-3ef4-4c83-b3af-3922d576acc4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-065a22a8-3ef4-4c83-b3af-3922d576acc4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-30e95137-b1ac-4c90-ab21-232803e7ce84' class='xr-var-data-in' type='checkbox'><label for='data-30e95137-b1ac-4c90-ab21-232803e7ce84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-1edfebb8-5cb4-4525-809a-6ee99703aa5e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1edfebb8-5cb4-4525-809a-6ee99703aa5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aea87402-2ad0-43d1-8bcc-ce08e4d5482f' class='xr-var-data-in' type='checkbox'><label for='data-aea87402-2ad0-43d1-8bcc-ce08e4d5482f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-42b3e2dd-8b48-45fa-aeda-d37ffc087201' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-42b3e2dd-8b48-45fa-aeda-d37ffc087201' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27486cfa-0128-4725-abc0-55397cc3c0ca' class='xr-var-data-in' type='checkbox'><label for='data-27486cfa-0128-4725-abc0-55397cc3c0ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-fc6f04c2-34df-4fc6-a8a6-81486f13239e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc6f04c2-34df-4fc6-a8a6-81486f13239e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa131a8c-3988-4a05-af99-9c6d36241a3c' class='xr-var-data-in' type='checkbox'><label for='data-aa131a8c-3988-4a05-af99-9c6d36241a3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 289.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 336 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="8" x2="24" y2="23" />
  <line x1="10" y1="17" x2="24" y2="32" />
  <line x1="10" y1="25" x2="24" y2="40" />
  <line x1="10" y1="34" x2="24" y2="49" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="51" x2="24" y2="66" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="40" y1="0" x2="54" y2="14" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="100" y1="0" x2="114" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="23" x2="144" y2="23" />
  <line x1="24" y1="32" x2="144" y2="32" />
  <line x1="24" y1="40" x2="144" y2="40" />
  <line x1="24" y1="49" x2="144" y2="49" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="66" x2="144" y2="66" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="54" y1="14" x2="54" y2="75" />
  <line x1="84" y1="14" x2="84" y2="75" />
  <line x1="114" y1="14" x2="114" y2="75" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-c681bbc5-5b73-485b-8530-6b02b652219f' class='xr-section-summary-in' type='checkbox'  ><label for='section-c681bbc5-5b73-485b-8530-6b02b652219f' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c19e6b9a-0a78-4497-b78b-05f9631d34dc' class='xr-index-data-in' type='checkbox'/><label for='index-c19e6b9a-0a78-4497-b78b-05f9631d34dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9d7681fb-27b6-45f9-b28c-2b024e8d2361' class='xr-index-data-in' type='checkbox'/><label for='index-9d7681fb-27b6-45f9-b28c-2b024e8d2361' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9cd873a7-20db-44e0-b086-2ff2ed7761a4' class='xr-index-data-in' type='checkbox'/><label for='index-9cd873a7-20db-44e0-b086-2ff2ed7761a4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b6d39bc1-feb7-47c8-9ea6-a09b064d2613' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b6d39bc1-feb7-47c8-9ea6-a09b064d2613' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>The CDS provides ERA5‚ÄìDrought‚Äôs <em>p<sub>0</sub></em> flag for each accumulation period,
but does not distinguish between them in the variable name.
This means that <em>p<sub>0</sub></em> must be downloaded separately for each accumulation period, renamed, and merged together,
rather than downloading it for all simultaneously:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup: Request for each accumulation period</span>
<span class="n">request_p_zero</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;probability_of_zero_precipitation_spi&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_flag</span>

<span class="n">requests_per_accumulation_period</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;accumulation_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">period</span><span class="p">)],}</span>
                                    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span><span class="p">}</span>

<span class="n">subrequests_era5drought_p_zero</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">(</span><span class="n">req</span> <span class="o">|</span> <span class="n">request_p_zero</span><span class="p">)</span>
                                  <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests_per_accumulation_period</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Download data in individual requests</span>
<span class="n">p_zero_era5drought</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="n">subreq</span><span class="p">)</span>  <span class="c1"># Download as field lists</span>
                      <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">subreq</span> <span class="ow">in</span> <span class="n">subrequests_era5drought_p_zero</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Pre-process: Convert to xarray, handle variable names, month dimension</span>
<span class="n">p_zero_era5drought</span> <span class="o">=</span> <span class="n">preprocess_era5drought_qualityflag</span><span class="p">(</span><span class="n">p_zero_era5drought</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">)</span>

<span class="c1"># Display in notebook</span>
<span class="n">p_zero_era5drought</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 698MB
Dimensions:  (month: 12, lat: 721, lon: 1440)
Coordinates:
    time     (month) datetime64[ns] 96B 2020-01-01 2020-02-01 ... 2020-12-01
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    tp1      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp3      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp6      (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp12     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp24     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp36     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp48     (month, lat, lon) float64 100MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
Attributes: (12/19)
    CDI:                     Climate Data Interface version 1.9.10 (https://m...
    Conventions:             CF-1.8
    source:                  DRYFALL v1.0
    institution:             European Centre for Medium-Range Weather Forecasts
    title:                   Quality criteria for the derived standardized dr...
    description:             Monthly quality criteria that define the reliabi...
    ...                      ...
    resolution:              0.25x0.25
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    CDO:                     Climate Data Operators version 1.9.10 (https://m...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f5208a95-70d2-4e7c-966d-bca01df98e31' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f5208a95-70d2-4e7c-966d-bca01df98e31' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5b11cfed-597d-4ad9-8d5c-8876703292bc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5b11cfed-597d-4ad9-8d5c-8876703292bc' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01 ... 2020-12-01</div><input id='attrs-2d55d73e-c45e-498c-8f11-232d169cdde3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d55d73e-c45e-498c-8f11-232d169cdde3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97240dd7-67cd-43e8-954b-c198923f8621' class='xr-var-data-in' type='checkbox'><label for='data-97240dd7-67cd-43e8-954b-c198923f8621' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:00:00.000000000&#x27;, &#x27;2020-02-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-05-01T00:00:00.000000000&#x27;, &#x27;2020-06-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2020-08-01T00:00:00.000000000&#x27;,
       &#x27;2020-09-01T00:00:00.000000000&#x27;, &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-d57888e6-8205-4ae9-90e7-1ef1a10a99f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d57888e6-8205-4ae9-90e7-1ef1a10a99f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0f11ff2-8151-42a5-b52d-8c78c18902f3' class='xr-var-data-in' type='checkbox'><label for='data-b0f11ff2-8151-42a5-b52d-8c78c18902f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-5bc793cf-0e58-46d8-ab73-0f70935de31b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5bc793cf-0e58-46d8-ab73-0f70935de31b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a04ffac-6636-46b3-a938-c3d379df37ba' class='xr-var-data-in' type='checkbox'><label for='data-7a04ffac-6636-46b3-a938-c3d379df37ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-c5309ec5-3660-4000-a7c0-c72c0877e12f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5309ec5-3660-4000-a7c0-c72c0877e12f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a2db2e9-d822-4d15-9f55-506e13b5faf9' class='xr-var-data-in' type='checkbox'><label for='data-7a2db2e9-d822-4d15-9f55-506e13b5faf9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-646a38b2-c863-4742-b1f3-736dc1bbffe2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-646a38b2-c863-4742-b1f3-736dc1bbffe2' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-a0f663d8-c7c3-4343-a11f-b69288ddeadb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0f663d8-c7c3-4343-a11f-b69288ddeadb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7a60733-1ff1-4869-8f92-6c24a93c5603' class='xr-var-data-in' type='checkbox'><label for='data-f7a60733-1ff1-4869-8f92-6c24a93c5603' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-95682d5c-1a21-430d-9a13-58cf64a2af4d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-95682d5c-1a21-430d-9a13-58cf64a2af4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09f7668e-0143-4729-8310-180ff8ddccb2' class='xr-var-data-in' type='checkbox'><label for='data-09f7668e-0143-4729-8310-180ff8ddccb2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-82cf9db1-1c78-423b-bb9c-e6d57c3ffa5e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-82cf9db1-1c78-423b-bb9c-e6d57c3ffa5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98d5ba9e-f72f-410c-a1fb-6a5a447e414e' class='xr-var-data-in' type='checkbox'><label for='data-98d5ba9e-f72f-410c-a1fb-6a5a447e414e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-d2881191-4b09-4af8-b1e5-de152e8a8b52' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2881191-4b09-4af8-b1e5-de152e8a8b52' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe20a3c7-3630-4730-a507-ebdfdbb879ff' class='xr-var-data-in' type='checkbox'><label for='data-fe20a3c7-3630-4730-a507-ebdfdbb879ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-31afeac8-ddd7-4d71-acd0-76b2e15a557f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-31afeac8-ddd7-4d71-acd0-76b2e15a557f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7689c94-c1fb-4ce8-8a25-5276f978d518' class='xr-var-data-in' type='checkbox'><label for='data-e7689c94-c1fb-4ce8-8a25-5276f978d518' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-3c50dc89-990e-4f19-8e94-689fcbc9905c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3c50dc89-990e-4f19-8e94-689fcbc9905c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a6ec55e8-cc19-4231-9f22-8956094d9fd2' class='xr-var-data-in' type='checkbox'><label for='data-a6ec55e8-cc19-4231-9f22-8956094d9fd2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-950b1750-c929-40fa-9137-9dc8beaad02f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-950b1750-c929-40fa-9137-9dc8beaad02f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9ba5fa0-8fe4-4a25-a9a8-ba854728c3e3' class='xr-var-data-in' type='checkbox'><label for='data-f9ba5fa0-8fe4-4a25-a9a8-ba854728c3e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Number of months with zero precipitation during the reference period expressed as the fraction of the total number of months</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 95.05 MiB </td>
                        <td> 7.92 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 25 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7e852d6-fece-4ab3-a821-7095454c61d6' class='xr-section-summary-in' type='checkbox'  ><label for='section-b7e852d6-fece-4ab3-a821-7095454c61d6' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8b6cdbc1-7136-4283-89a3-4ec6d7f6e508' class='xr-index-data-in' type='checkbox'/><label for='index-8b6cdbc1-7136-4283-89a3-4ec6d7f6e508' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-678d9e6f-ef4b-4d44-b76e-9bfe20bfa138' class='xr-index-data-in' type='checkbox'/><label for='index-678d9e6f-ef4b-4d44-b76e-9bfe20bfa138' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-035cf9c5-c5ee-4f0a-83f6-b28138345675' class='xr-index-data-in' type='checkbox'/><label for='index-035cf9c5-c5ee-4f0a-83f6-b28138345675' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-48bbe7ab-d89b-4f90-a819-b4f35d326da7' class='xr-section-summary-in' type='checkbox'  ><label for='section-48bbe7ab-d89b-4f90-a819-b4f35d326da7' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 1.9.10 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>title :</span></dt><dd>Quality criteria for the derived standardized drought indices</dd><dt><span>description :</span></dt><dd>Monthly quality criteria that define the reliability of the derived drought indices.</dd><dt><span>history :</span></dt><dd>Tue Aug 13 11:21:46 2024: cdo -selvar,pzero -setdate,20200101 -seldate,19000101 /ec/ws4/tc/emos/work/cems/dryfall/emos/dryfall_monthly/generated_climate/parameters/SPI1_gamma_global_era5_moda_ref1991to2020_params.nc SPI1_spipzero_gamma_global_era5_moda_ref1991to2020_01.nc
Created 13/08/2024 11:10:50 using DRYFALL.</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., F. Di Giuseppe, C. Barnard, D. Damasio da Costa, and F. Wetterhall: ERA5‚ÄìDrought: Global drought indicators based on ECMWF reanalysis.</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://ecds.climate.copernicus.eu/datasets/derived-drought-historical</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 1.9.10 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>For both datasets, we create masks corresponding to
the threshold for not fitting a gamma distribution (<em>p<sub>0</sub></em> &gt; 0.33)
and
the recommended threshold for filtering data (<em>p<sub>0</sub></em> &gt; 0.1):</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create masks from p_zero</span>
<span class="c1"># True: below threshold, allowed</span>
<span class="c1"># False: above threshold, flagged</span>
<span class="n">p_zero_reproduced_033</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p_zero_reproduced</span>  <span class="o">&lt;=</span> <span class="mf">0.33</span><span class="p">)</span>
<span class="n">p_zero_era5drought_033</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_zero_era5drought</span> <span class="o">&lt;=</span> <span class="mf">0.33</span><span class="p">)</span>

<span class="n">p_zero_reproduced_010</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p_zero_reproduced</span>  <span class="o">&lt;=</span> <span class="mf">0.10</span><span class="p">)</span>
<span class="n">p_zero_era5drought_010</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_zero_era5drought</span> <span class="o">&lt;=</span> <span class="mf">0.10</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">p_zero_era5drought_033</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 87MB
Dimensions:  (month: 12, lon: 1440, lat: 721)
Coordinates:
    time     (month) datetime64[ns] 96B 2020-01-01 2020-02-01 ... 2020-12-01
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    tp1      (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp3      (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp6      (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp12     (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp24     (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp36     (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
    tp48     (month, lat, lon) bool 12MB dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;
Attributes: (12/19)
    CDI:                     Climate Data Interface version 1.9.10 (https://m...
    Conventions:             CF-1.8
    source:                  DRYFALL v1.0
    institution:             European Centre for Medium-Range Weather Forecasts
    title:                   Quality criteria for the derived standardized dr...
    description:             Monthly quality criteria that define the reliabi...
    ...                      ...
    resolution:              0.25x0.25
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    CDO:                     Climate Data Operators version 1.9.10 (https://m...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2cbdecf6-e330-4fe7-bcd0-48f27d456e83' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2cbdecf6-e330-4fe7-bcd0-48f27d456e83' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lon</span>: 1440</li><li><span class='xr-has-index'>lat</span>: 721</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4b4383db-2464-4c6b-849a-88e11b4ae53a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4b4383db-2464-4c6b-849a-88e11b4ae53a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01 ... 2020-12-01</div><input id='attrs-121d93bb-33c5-45e5-a728-a9b7db546276' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-121d93bb-33c5-45e5-a728-a9b7db546276' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62d0b5ea-f2e4-4cef-bac2-f331aa1c1112' class='xr-var-data-in' type='checkbox'><label for='data-62d0b5ea-f2e4-4cef-bac2-f331aa1c1112' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:00:00.000000000&#x27;, &#x27;2020-02-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-05-01T00:00:00.000000000&#x27;, &#x27;2020-06-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2020-08-01T00:00:00.000000000&#x27;,
       &#x27;2020-09-01T00:00:00.000000000&#x27;, &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-3ebfa87c-475f-49ed-b6c1-f76e99d9d24d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3ebfa87c-475f-49ed-b6c1-f76e99d9d24d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7bada951-d726-4a6b-a84e-9601723c81bd' class='xr-var-data-in' type='checkbox'><label for='data-7bada951-d726-4a6b-a84e-9601723c81bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-6fc005fe-2ddb-48f0-85c6-02bdbacb245a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6fc005fe-2ddb-48f0-85c6-02bdbacb245a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2936dd49-5b49-4e43-8bd4-aa0d68dcfae8' class='xr-var-data-in' type='checkbox'><label for='data-2936dd49-5b49-4e43-8bd4-aa0d68dcfae8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-f7b50a28-5e7b-428f-960f-8a3d41047fa3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f7b50a28-5e7b-428f-960f-8a3d41047fa3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a68db9be-50d8-4e92-9262-b73cb7256efe' class='xr-var-data-in' type='checkbox'><label for='data-a68db9be-50d8-4e92-9262-b73cb7256efe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-85d469c6-7b7e-4981-9eb5-7850c268f37f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-85d469c6-7b7e-4981-9eb5-7850c268f37f' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-88873d42-d77c-41a2-aafe-5ba7dd516d32' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-88873d42-d77c-41a2-aafe-5ba7dd516d32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2195a06c-5454-4d54-a6ad-3e3e59344b2d' class='xr-var-data-in' type='checkbox'><label for='data-2195a06c-5454-4d54-a6ad-3e3e59344b2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-e74af146-c0dd-45e7-ab1b-91fd889b2f5f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e74af146-c0dd-45e7-ab1b-91fd889b2f5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-670a221f-67d1-4ac7-9203-2f5114aede24' class='xr-var-data-in' type='checkbox'><label for='data-670a221f-67d1-4ac7-9203-2f5114aede24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-2fa7f00e-b5a1-4f3b-bd94-95d54ef44495' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2fa7f00e-b5a1-4f3b-bd94-95d54ef44495' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26d603bc-5cf9-4e29-b84d-b788ed617113' class='xr-var-data-in' type='checkbox'><label for='data-26d603bc-5cf9-4e29-b84d-b788ed617113' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-898533aa-820a-4973-a0a9-03975b43b1a9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-898533aa-820a-4973-a0a9-03975b43b1a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c0375e7-9ef1-4e4c-97a4-4d5a89f1e30f' class='xr-var-data-in' type='checkbox'><label for='data-8c0375e7-9ef1-4e4c-97a4-4d5a89f1e30f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-e69217ac-318f-458a-a2d3-e90a539a55d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e69217ac-318f-458a-a2d3-e90a539a55d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-603dc6f3-926e-4de5-9d03-f7027a31d887' class='xr-var-data-in' type='checkbox'><label for='data-603dc6f3-926e-4de5-9d03-f7027a31d887' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-d7c5eb38-85e6-46ca-8f7e-16e5a0c6e370' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d7c5eb38-85e6-46ca-8f7e-16e5a0c6e370' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85ac635f-36b5-44ab-b569-9d4eb0f10a89' class='xr-var-data-in' type='checkbox'><label for='data-85ac635f-36b5-44ab-b569-9d4eb0f10a89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 721, 1440), meta=np.ndarray&gt;</div><input id='attrs-b9f611ce-6931-42e5-9497-287c79d0a99e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b9f611ce-6931-42e5-9497-287c79d0a99e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55530c54-17c3-4b9e-9d0d-1a6106106063' class='xr-var-data-in' type='checkbox'><label for='data-55530c54-17c3-4b9e-9d0d-1a6106106063' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 11.88 MiB </td>
                        <td> 0.99 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 721, 1440) </td>
                        <td> (1, 721, 1440) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="125" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="60" x2="24" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="61" />
  <line x1="12" y1="2" x2="12" y2="62" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="14" y1="4" x2="14" y2="65" />
  <line x1="16" y1="6" x2="16" y2="66" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="18" y1="8" x2="18" y2="68" />
  <line x1="19" y1="9" x2="19" y2="70" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="22" y1="12" x2="22" y2="72" />
  <line x1="23" y1="13" x2="23" y2="73" />
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,75.03193128308774 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="75" x2="144" y2="75" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="75" style="stroke-width:2" />
  <line x1="144" y1="14" x2="144" y2="75" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,75.03193128308774 24.9485979497544,75.03193128308774" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="95.031931" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="164.948598" y="44.990265" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,44.990265)">721</text>
  <text x="7.474299" y="87.557632" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,87.557632)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-78f67547-a301-4b23-af53-40bedf7fbd12' class='xr-section-summary-in' type='checkbox'  ><label for='section-78f67547-a301-4b23-af53-40bedf7fbd12' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-329c58c5-e65b-46b4-b814-c646f4475ee1' class='xr-index-data-in' type='checkbox'/><label for='index-329c58c5-e65b-46b4-b814-c646f4475ee1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2f5103ae-08e6-4276-8f4f-3e3507ab7912' class='xr-index-data-in' type='checkbox'/><label for='index-2f5103ae-08e6-4276-8f4f-3e3507ab7912' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-536084fc-b809-4953-a357-259ca333d7df' class='xr-index-data-in' type='checkbox'/><label for='index-536084fc-b809-4953-a357-259ca333d7df' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4d031676-e3ad-4fab-922c-c86d5c0a5df4' class='xr-section-summary-in' type='checkbox'  ><label for='section-4d031676-e3ad-4fab-922c-c86d5c0a5df4' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 1.9.10 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>title :</span></dt><dd>Quality criteria for the derived standardized drought indices</dd><dt><span>description :</span></dt><dd>Monthly quality criteria that define the reliability of the derived drought indices.</dd><dt><span>history :</span></dt><dd>Tue Aug 13 11:21:46 2024: cdo -selvar,pzero -setdate,20200101 -seldate,19000101 /ec/ws4/tc/emos/work/cems/dryfall/emos/dryfall_monthly/generated_climate/parameters/SPI1_gamma_global_era5_moda_ref1991to2020_params.nc SPI1_spipzero_gamma_global_era5_moda_ref1991to2020_01.nc
Created 13/08/2024 11:10:50 using DRYFALL.</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., F. Di Giuseppe, C. Barnard, D. Damasio da Costa, and F. Wetterhall: ERA5‚ÄìDrought: Global drought indicators based on ECMWF reanalysis.</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://ecds.climate.copernicus.eu/datasets/derived-drought-historical</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 1.9.10 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>First,
we quantitatively compare how often the values of <em>p<sub>0</sub></em> and the derived masks in ERA5‚ÄìDrought and the reproduction match:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package probability and masks into dictionary for table function; note use unicode symbols / HTML</span>
<span class="n">p_zero_flags</span> <span class="o">=</span> <span class="p">{</span><span class="sa">r</span><span class="s2">&quot;p&lt;sub&gt;0&lt;/sub&gt; [%]&quot;</span><span class="p">:</span>        <span class="p">[</span><span class="n">p_zero_era5drought</span><span class="p">,</span>     <span class="n">p_zero_reproduced</span><span class="p">],</span>
                <span class="sa">r</span><span class="s2">&quot;p&lt;sub&gt;0&lt;/sub&gt; &gt; 0.33 [%]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">p_zero_era5drought_033</span><span class="p">,</span> <span class="n">p_zero_reproduced_033</span><span class="p">],</span>
                <span class="sa">r</span><span class="s2">&quot;p&lt;sub&gt;0&lt;/sub&gt; &gt; 0.10 [%]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">p_zero_era5drought_010</span><span class="p">,</span> <span class="n">p_zero_reproduced_010</span><span class="p">],</span>
               <span class="p">}</span>

<span class="c1"># Compare probabilities per variable</span>
<span class="n">compare_quality_flags</span><span class="p">(</span><span class="n">p_zero_flags</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="s2">&quot; (global)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_cd6cf">
  <caption>ERA5‚ÄìDrought vs. Reproduced
Quality flag matches (global)</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_cd6cf_level0_col0" class="col_heading level0 col0" >tp1</th>
      <th id="T_cd6cf_level0_col1" class="col_heading level0 col1" >tp3</th>
      <th id="T_cd6cf_level0_col2" class="col_heading level0 col2" >tp6</th>
      <th id="T_cd6cf_level0_col3" class="col_heading level0 col3" >tp12</th>
      <th id="T_cd6cf_level0_col4" class="col_heading level0 col4" >tp24</th>
      <th id="T_cd6cf_level0_col5" class="col_heading level0 col5" >tp36</th>
      <th id="T_cd6cf_level0_col6" class="col_heading level0 col6" >tp48</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_cd6cf_level0_row0" class="row_heading level0 row0" >Matching p<sub>0</sub> [%]</th>
      <td id="T_cd6cf_row0_col0" class="data row0 col0" >99.34</td>
      <td id="T_cd6cf_row0_col1" class="data row0 col1" >99.86</td>
      <td id="T_cd6cf_row0_col2" class="data row0 col2" >99.98</td>
      <td id="T_cd6cf_row0_col3" class="data row0 col3" >100.00</td>
      <td id="T_cd6cf_row0_col4" class="data row0 col4" >100.00</td>
      <td id="T_cd6cf_row0_col5" class="data row0 col5" >100.00</td>
      <td id="T_cd6cf_row0_col6" class="data row0 col6" >100.00</td>
    </tr>
    <tr>
      <th id="T_cd6cf_level0_row1" class="row_heading level0 row1" >Matching p<sub>0</sub> > 0.33 [%]</th>
      <td id="T_cd6cf_row1_col0" class="data row1 col0" >99.87</td>
      <td id="T_cd6cf_row1_col1" class="data row1 col1" >99.98</td>
      <td id="T_cd6cf_row1_col2" class="data row1 col2" >100.00</td>
      <td id="T_cd6cf_row1_col3" class="data row1 col3" >100.00</td>
      <td id="T_cd6cf_row1_col4" class="data row1 col4" >100.00</td>
      <td id="T_cd6cf_row1_col5" class="data row1 col5" >100.00</td>
      <td id="T_cd6cf_row1_col6" class="data row1 col6" >100.00</td>
    </tr>
    <tr>
      <th id="T_cd6cf_level0_row2" class="row_heading level0 row2" >Matching p<sub>0</sub> > 0.10 [%]</th>
      <td id="T_cd6cf_row2_col0" class="data row2 col0" >99.65</td>
      <td id="T_cd6cf_row2_col1" class="data row2 col1" >99.95</td>
      <td id="T_cd6cf_row2_col2" class="data row2 col2" >99.99</td>
      <td id="T_cd6cf_row2_col3" class="data row2 col3" >100.00</td>
      <td id="T_cd6cf_row2_col4" class="data row2 col4" >100.00</td>
      <td id="T_cd6cf_row2_col5" class="data row2 col5" >100.00</td>
      <td id="T_cd6cf_row2_col6" class="data row2 col6" >100.00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>It is immediately evident from the table above that there is excellent agreement across all accumulation periods:
‚â•99% in all cases and 100% in most.
Since <em>p<sub>0</sub></em> is derived directly from the accumulated ERA5 total precipitation,
without any intermediate fitting steps,
the few discrepancies that do occur are likely caused by small differences in the data processing between ERA5‚ÄìDrought and this notebook.
Potential examples include
the cut-off for zero precipitation (exactly 0 mm, 0.01 mm, or something else);
if the cut-off is not exactly zero, whether it is applied to the total or average precipitation in the accumulation period;
whether leap years are accounted for;
and computational factors like floating-point accuracy.
Given the level of agreement, it is safe to conclude that the <em>p<sub>0</sub></em> quality flag is reproducible.</p>
<p>The global distribution of <em>p<sub>0</sub></em> in the 3-month accumulation period
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-global"><span class="std std-numref">6.1.6</span></a>)
shows that differences occur in isolated pixels,
e.g. in Argentina, Ukraine, and Russia,
rather than clusters.
Many pixels in the example region
(Horn of Africa)
are flagged in one or more months
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-region"><span class="std std-numref">6.1.7</span></a>)
as suggested in the SPI comparison above,
although the flagged pixels do not always match one-to-one with the pixels that showed differences in SPI (compare Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-geospatial"><span class="std std-numref">6.1.4</span></a>).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package probability and masks into dictionary for plotting function; note use of LaTeX instead of unicode/HTML symbols</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="p">{</span><span class="sa">r</span><span class="s2">&quot;$p_0$ (probability of zero precipitation)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">p_zero_era5drought</span><span class="p">,</span> <span class="n">p_zero_reproduced</span><span class="p">],</span>
                <span class="p">}</span>
<span class="n">masks</span> <span class="o">=</span> <span class="p">{</span><span class="sa">r</span><span class="s2">&quot;$p_0 &gt; 0.33$&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">p_zero_era5drought_033</span><span class="p">,</span> <span class="n">p_zero_reproduced_033</span><span class="p">],</span>
         <span class="sa">r</span><span class="s2">&quot;$p_0 &gt; 0.10$&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">p_zero_era5drought_010</span><span class="p">,</span> <span class="n">p_zero_reproduced_010</span><span class="p">],</span>
         <span class="p">}</span>

<span class="c1"># Display quality flags ‚Äì this step may take a few minutes</span>
<span class="c1"># Regional for tp1, for regional SPI comparison</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;tp1&quot;</span><span class="p">,</span> <span class="n">probabilities</span><span class="o">=</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span> <span class="n">example_month</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span> <span class="n">flag_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$p_0$&quot;</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-p0-region&quot;</span><span class="p">)</span>

<span class="c1"># Global for tp3 (comparable to SPEI-3 Shapiro‚ÄìWilk plot in Keune+25 Fig 3.</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;tp3&quot;</span><span class="p">,</span> <span class="n">probabilities</span><span class="o">=</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span> <span class="n">example_month</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">flag_label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$p_0$&quot;</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-p0-global&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="global" for="sd-tab-item-4">
Global, 3-month</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-global">
<img alt="../_images/ef4aaf21aac4a836440baba13bad99c2fdfcbbb60efeaaea937b75bb39841383.png" src="../_images/ef4aaf21aac4a836440baba13bad99c2fdfcbbb60efeaaea937b75bb39841383.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.6 </span><span class="caption-text">Global probability of zero precipitation in the 3-month accumulation period and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
Probability is displayed for one calendar month (December) across the reference window (1991‚Äì2020).
Masks are displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-global" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-5">
Example region, 1-month</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-region">
<img alt="../_images/5c3cf330b8c286231a14d66722b8381f9265c1e36eb0de3776cd83414be60a95.png" src="../_images/5c3cf330b8c286231a14d66722b8381f9265c1e36eb0de3776cd83414be60a95.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.7 </span><span class="caption-text">Probability of zero precipitation in the 1-month accumulation period and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
Probability is displayed for one calendar month (December) across the reference window (1991‚Äì2020).
Masks are displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.
This figure displays only the example region (Horn of Africa), for comparison with
Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-geospatial"><span class="std std-numref">6.1.4</span></a>.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-p0-region" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="quality-flags-shapirowilk-normality-test">
<h4>3.9 Quality flags: Shapiro‚ÄìWilk normality test<a class="headerlink" href="#quality-flags-shapirowilk-normality-test" title="Link to this heading">#</a></h4>
<p>Another quality flag included in ERA5‚ÄìDrought is the normality <em>Œ±</em>,
derived using the Shapiro‚ÄìWilk test [<a class="reference external" href="https://doi.org/10.1093/biomet/52.3-4.591" rel="noreferrer" target="_blank">Shapiro+65</a>].
This <em>Œ±</em> quantifies how well the computed SPI or SPEI values
in the reference period
(1991‚Äì2020)
are described by a standard normal distribution.
As such, <em>Œ±</em> is provided for each combination of calendar month and accumulation window,
for each pixel.
The mask in ERA‚ÄìDrought uses a threshold of 0.05, meaning points where <em>Œ±</em> &lt; 0.05 are rejected.</p>
<p>In this subsection,
we reproduce the <em>Œ±</em> quality flag mask,
and compare its values to those provided in ERA5‚ÄìDrought.
Because this involves computing SPI,
which is computationally expensive,
the evaluation is performed over the example region
(Horn of Africa)
rather than globally.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_precipitation_region</span> <span class="o">=</span> <span class="n">data_era5_precipitation_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_region</span><span class="p">)</span>

<span class="c1"># Calculate SPI</span>
<span class="n">spi_reproduced_region</span> <span class="o">=</span> <span class="n">calculate_spi_from_era5</span><span class="p">(</span><span class="n">data_era5_precipitation_region</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">,</span>
                                                <span class="n">evaluation_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Shapiro‚ÄìWilk normality test</span>
<span class="n">normality_reproduced</span> <span class="o">=</span> <span class="n">shapiro_wilk_normality</span><span class="p">(</span><span class="n">spi_reproduced_region</span><span class="p">)</span>

<span class="c1"># Retain in memory</span>
<span class="n">normality_reproduced</span> <span class="o">=</span> <span class="n">normality_reproduced</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Create mask from normality p-values</span>
<span class="c1"># True: above threshold, allowed</span>
<span class="c1"># False: below threshold, flagged</span>
<span class="n">normality_reproduced_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">normality_reproduced</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">normality_reproduced_mask</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 792kB
Dimensions:  (lat: 97, lon: 97, month: 12)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    SPI1     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI3     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI6     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI12    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI24    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI36    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPI48    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8fc83804-5a7f-4c68-b6d0-c5cae0cc8074' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8fc83804-5a7f-4c68-b6d0-c5cae0cc8074' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li><li><span class='xr-has-index'>month</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-24311446-f0a4-4363-9de8-a37e00dd270b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-24311446-f0a4-4363-9de8-a37e00dd270b' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-a72a1247-eb88-4ce6-9ec0-0aa648255fd8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a72a1247-eb88-4ce6-9ec0-0aa648255fd8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bea482ef-5f23-4d77-9776-d34331efc018' class='xr-var-data-in' type='checkbox'><label for='data-bea482ef-5f23-4d77-9776-d34331efc018' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-748a3dbe-2e77-446e-a113-d2b5c4e6de6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-748a3dbe-2e77-446e-a113-d2b5c4e6de6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-739e9f2f-f106-43a1-b506-0a72d87a04b1' class='xr-var-data-in' type='checkbox'><label for='data-739e9f2f-f106-43a1-b506-0a72d87a04b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-fa76c488-7c75-40fd-abaa-43f41eb64e7f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa76c488-7c75-40fd-abaa-43f41eb64e7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89decae2-3c89-43b3-8cf6-0318628815fe' class='xr-var-data-in' type='checkbox'><label for='data-89decae2-3c89-43b3-8cf6-0318628815fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-2791dbeb-cbfa-4c08-ac79-ae1fbae68156' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2791dbeb-cbfa-4c08-ac79-ae1fbae68156' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2490e7ad-7e06-401b-bd31-2b86ac3ed1ae' class='xr-var-data-in' type='checkbox'><label for='data-2490e7ad-7e06-401b-bd31-2b86ac3ed1ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b225784-474b-4a85-ada0-6cc24a6106c7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6b225784-474b-4a85-ada0-6cc24a6106c7' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-76bf328e-3a38-4883-a2d1-6ee3c598da57' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76bf328e-3a38-4883-a2d1-6ee3c598da57' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4da0098f-2ac0-4440-aca4-6427a689db58' class='xr-var-data-in' type='checkbox'><label for='data-4da0098f-2ac0-4440-aca4-6427a689db58' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-344f6139-de73-49ab-9f2c-8e25013d8466' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-344f6139-de73-49ab-9f2c-8e25013d8466' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0aefe054-46b7-4842-8a73-123e0fe7f07a' class='xr-var-data-in' type='checkbox'><label for='data-0aefe054-46b7-4842-8a73-123e0fe7f07a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-96a250e0-9a17-4ec2-b10a-b7894a600cb4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-96a250e0-9a17-4ec2-b10a-b7894a600cb4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4eb1522-cd05-4b3e-ad54-615204a6b796' class='xr-var-data-in' type='checkbox'><label for='data-c4eb1522-cd05-4b3e-ad54-615204a6b796' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-989be7bd-5b49-4bf1-83f5-0530fe115da5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-989be7bd-5b49-4bf1-83f5-0530fe115da5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-889fe4cd-0f13-4afd-af20-159e64cf63b5' class='xr-var-data-in' type='checkbox'><label for='data-889fe4cd-0f13-4afd-af20-159e64cf63b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-fd2caa4e-d54c-4e6e-9438-732761bdf680' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fd2caa4e-d54c-4e6e-9438-732761bdf680' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-afebd618-11bc-4fda-8166-38587e619428' class='xr-var-data-in' type='checkbox'><label for='data-afebd618-11bc-4fda-8166-38587e619428' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-a50b286f-46f3-46be-9aa1-ef5c7014e072' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a50b286f-46f3-46be-9aa1-ef5c7014e072' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-966b9874-6a34-46a5-ae30-1b153d171c66' class='xr-var-data-in' type='checkbox'><label for='data-966b9874-6a34-46a5-ae30-1b153d171c66' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-19e96ab6-7f1f-4358-a602-d23dcf452f21' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-19e96ab6-7f1f-4358-a602-d23dcf452f21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11889157-58a7-4d56-a61a-1a5a7bb6c8cc' class='xr-var-data-in' type='checkbox'><label for='data-11889157-58a7-4d56-a61a-1a5a7bb6c8cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-6b44d461-002b-4654-9e6d-10678880a523' class='xr-section-summary-in' type='checkbox'  ><label for='section-6b44d461-002b-4654-9e6d-10678880a523' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-01afdbbd-294c-49b4-a479-139c89b37d13' class='xr-index-data-in' type='checkbox'/><label for='index-01afdbbd-294c-49b4-a479-139c89b37d13' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-263daf32-9f82-4fa8-8ccb-ba9baa59b0db' class='xr-index-data-in' type='checkbox'/><label for='index-263daf32-9f82-4fa8-8ccb-ba9baa59b0db' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-94418ffc-a3e8-4b6b-848a-873ead1f6aa1' class='xr-index-data-in' type='checkbox'/><label for='index-94418ffc-a3e8-4b6b-848a-873ead1f6aa1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-db5f6b1e-6198-4731-b235-7f666e649aa0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-db5f6b1e-6198-4731-b235-7f666e649aa0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>The CDS provides ERA5‚ÄìDrought‚Äôs <em>Œ±</em> flag for each accumulation period,
but does not distinguish between them in the variable name.
This means that <em>Œ±</em> must be downloaded separately for each accumulation period, renamed, and merged together,
rather than downloading it for all simultaneously.
Note that unlike for <em>p<sub>0</sub></em>,
ERA5‚ÄìDrought does not provide the value of <em>Œ±</em>, only the corresponding boolean mask.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup: Request for each accumulation period</span>
<span class="n">request_normality</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;test_for_normality_spi&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_region</span> <span class="o">|</span> <span class="n">request_era5drought_flag</span>

<span class="n">requests_per_accumulation_period</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;accumulation_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">period</span><span class="p">)],}</span>
                                    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span><span class="p">}</span>

<span class="n">subrequests_era5drought_normality</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">(</span><span class="n">req</span> <span class="o">|</span> <span class="n">request_normality</span><span class="p">)</span>
                                       <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests_per_accumulation_period</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Download data in individual requests</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="n">subreq</span><span class="p">)</span>  <span class="c1"># Download as field lists</span>
                              <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">subreq</span> <span class="ow">in</span> <span class="n">subrequests_era5drought_normality</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Pre-process: Convert to xarray, handle variable names, month dimension</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="n">preprocess_era5drought_qualityflag</span><span class="p">(</span><span class="n">normality_era5drought_mask</span><span class="p">,</span> <span class="s2">&quot;SPI&quot;</span><span class="p">)</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="n">normality_era5drought_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># Convert to boolean array (values are only 0. or 1.)</span>

<span class="c1"># Display in notebook</span>
<span class="n">normality_era5drought_mask</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 792kB
Dimensions:  (month: 12, lat: 97, lon: 97)
Coordinates:
    time     (month) datetime64[ns] 96B 2020-01-01 2020-02-01 ... 2020-12-01
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    SPI1     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI3     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI6     (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI12    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI24    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI36    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPI48    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
Attributes: (12/19)
    CDI:                     Climate Data Interface version 1.9.10 (https://m...
    Conventions:             CF-1.8
    source:                  DRYFALL v1.0
    institution:             European Centre for Medium-Range Weather Forecasts
    title:                   Quality criteria for the derived standardized dr...
    description:             Monthly quality criteria that define the reliabi...
    ...                      ...
    resolution:              0.25x0.25
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    CDO:                     Climate Data Operators version 1.9.10 (https://m...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-df6e5807-312a-4ac6-8795-1f2c02bf20c3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-df6e5807-312a-4ac6-8795-1f2c02bf20c3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-1fb72255-1f91-4bad-9f57-8aa86fadfd04' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1fb72255-1f91-4bad-9f57-8aa86fadfd04' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01 ... 2020-12-01</div><input id='attrs-38243de5-5bfc-4b9e-92db-e1070f74056a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38243de5-5bfc-4b9e-92db-e1070f74056a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e9e690e-5c4f-4848-ac6b-10832fa215b3' class='xr-var-data-in' type='checkbox'><label for='data-8e9e690e-5c4f-4848-ac6b-10832fa215b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:00:00.000000000&#x27;, &#x27;2020-02-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-05-01T00:00:00.000000000&#x27;, &#x27;2020-06-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2020-08-01T00:00:00.000000000&#x27;,
       &#x27;2020-09-01T00:00:00.000000000&#x27;, &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-d0396296-7fee-4abf-a03a-aff56bd79cd0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d0396296-7fee-4abf-a03a-aff56bd79cd0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98dab700-2287-49f9-98c1-eb2882312314' class='xr-var-data-in' type='checkbox'><label for='data-98dab700-2287-49f9-98c1-eb2882312314' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-f26cff8c-6330-4c96-86b5-79b771f7caf8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f26cff8c-6330-4c96-86b5-79b771f7caf8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abddfd8c-04b5-42e8-97fc-8ae9bd4142ba' class='xr-var-data-in' type='checkbox'><label for='data-abddfd8c-04b5-42e8-97fc-8ae9bd4142ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-dae3aaf8-f624-4817-939e-9006f447b5db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dae3aaf8-f624-4817-939e-9006f447b5db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4de9ea4-6d4c-43d3-9edd-003a8d1d744c' class='xr-var-data-in' type='checkbox'><label for='data-b4de9ea4-6d4c-43d3-9edd-003a8d1d744c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-11beaea4-6ca5-4bdd-a52d-33f9e89aaf15' class='xr-section-summary-in' type='checkbox'  checked><label for='section-11beaea4-6ca5-4bdd-a52d-33f9e89aaf15' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPI1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-faf8a97c-bfc0-4e51-9e04-360e5df328e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-faf8a97c-bfc0-4e51-9e04-360e5df328e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ce1a4b05-1fd9-4429-a624-612449c3c63f' class='xr-var-data-in' type='checkbox'><label for='data-ce1a4b05-1fd9-4429-a624-612449c3c63f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-558fd76c-e2e1-4968-9621-66dbda78d4d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-558fd76c-e2e1-4968-9621-66dbda78d4d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f0ebcbf-04b3-42fc-a3d1-a1623b43191d' class='xr-var-data-in' type='checkbox'><label for='data-3f0ebcbf-04b3-42fc-a3d1-a1623b43191d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-b7199bca-03ef-4805-9a57-4126d43f2cca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b7199bca-03ef-4805-9a57-4126d43f2cca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b003d4b-ffa5-4844-ab3c-dec9b151eceb' class='xr-var-data-in' type='checkbox'><label for='data-2b003d4b-ffa5-4844-ab3c-dec9b151eceb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-c0333e4a-698f-42b3-8d63-32ddb342e857' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0333e4a-698f-42b3-8d63-32ddb342e857' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8e4602e-b662-4e83-9a2d-583225c82b25' class='xr-var-data-in' type='checkbox'><label for='data-e8e4602e-b662-4e83-9a2d-583225c82b25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-372f98e9-062b-43b5-8d93-0ea273018170' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-372f98e9-062b-43b5-8d93-0ea273018170' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94cd0587-1a71-461f-b94b-ff2bcb8aae7a' class='xr-var-data-in' type='checkbox'><label for='data-94cd0587-1a71-461f-b94b-ff2bcb8aae7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-1573feee-371f-4998-981c-4f6cb1109a4c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1573feee-371f-4998-981c-4f6cb1109a4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c94c49c5-adda-454a-830d-6247cbf4d5a8' class='xr-var-data-in' type='checkbox'><label for='data-c94c49c5-adda-454a-830d-6247cbf4d5a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPI48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-7eb7dc70-b169-4e00-a5bf-b6aa6fde7950' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7eb7dc70-b169-4e00-a5bf-b6aa6fde7950' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4024346-c799-4a08-8254-75dc980247b9' class='xr-var-data-in' type='checkbox'><label for='data-c4024346-c799-4a08-8254-75dc980247b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-28b3fd69-c59f-4710-a25c-972f9025a4dd' class='xr-section-summary-in' type='checkbox'  ><label for='section-28b3fd69-c59f-4710-a25c-972f9025a4dd' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1e95b1cf-23dc-42a4-b4a7-e13cc66a0338' class='xr-index-data-in' type='checkbox'/><label for='index-1e95b1cf-23dc-42a4-b4a7-e13cc66a0338' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-afd5442a-0c25-4044-a4b5-21ca278a135a' class='xr-index-data-in' type='checkbox'/><label for='index-afd5442a-0c25-4044-a4b5-21ca278a135a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-19a17f28-7193-4835-bce1-ef6103322cd8' class='xr-index-data-in' type='checkbox'/><label for='index-19a17f28-7193-4835-bce1-ef6103322cd8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-40903d4b-7ca1-4350-b9ce-aa699b1fc67f' class='xr-section-summary-in' type='checkbox'  ><label for='section-40903d4b-7ca1-4350-b9ce-aa699b1fc67f' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 1.9.10 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>title :</span></dt><dd>Quality criteria for the derived standardized drought indices</dd><dt><span>description :</span></dt><dd>Monthly quality criteria that define the reliability of the derived drought indices.</dd><dt><span>history :</span></dt><dd>Tue Aug 13 11:21:46 2024: cdo -selvar,significance -setdate,20200101 -seldate,19000101 /ec/ws4/tc/emos/work/cems/dryfall/emos/dryfall_monthly/generated_climate/parameters/SPI1_gamma_global_era5_moda_ref1991to2020_params.nc SPI1_spisignificance_gamma_global_era5_moda_ref1991to2020_01.nc
Created 13/08/2024 11:10:50 using DRYFALL.</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., F. Di Giuseppe, C. Barnard, D. Damasio da Costa, and F. Wetterhall: ERA5‚ÄìDrought: Global drought indicators based on ECMWF reanalysis.</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://ecds.climate.copernicus.eu/datasets/derived-drought-historical</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 1.9.10 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>First,
we quantitatively compare how often the values of the normality mask desired from <em>Œ±</em> in ERA5‚ÄìDrought and the reproduction match:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package probability and masks into dictionary for table function; note use unicode symbols / HTML</span>
<span class="n">normality_flags</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Œ± &lt; 0.05 [%]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normality_reproduced_mask</span><span class="p">,</span> <span class="n">normality_era5drought_mask</span><span class="p">],</span>
                  <span class="p">}</span>

<span class="c1"># Compare probabilities per variable</span>
<span class="n">compare_quality_flags</span><span class="p">(</span><span class="n">normality_flags</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">domain_region</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_f861f">
  <caption>ERA5‚ÄìDrought vs. Reproduced
Quality flag matches (Horn of Africa)</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_f861f_level0_col0" class="col_heading level0 col0" >SPI-1</th>
      <th id="T_f861f_level0_col1" class="col_heading level0 col1" >SPI-3</th>
      <th id="T_f861f_level0_col2" class="col_heading level0 col2" >SPI-6</th>
      <th id="T_f861f_level0_col3" class="col_heading level0 col3" >SPI-12</th>
      <th id="T_f861f_level0_col4" class="col_heading level0 col4" >SPI-24</th>
      <th id="T_f861f_level0_col5" class="col_heading level0 col5" >SPI-36</th>
      <th id="T_f861f_level0_col6" class="col_heading level0 col6" >SPI-48</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f861f_level0_row0" class="row_heading level0 row0" >Matching Œ± < 0.05 [%]</th>
      <td id="T_f861f_row0_col0" class="data row0 col0" >74.83</td>
      <td id="T_f861f_row0_col1" class="data row0 col1" >84.23</td>
      <td id="T_f861f_row0_col2" class="data row0 col2" >87.91</td>
      <td id="T_f861f_row0_col3" class="data row0 col3" >92.21</td>
      <td id="T_f861f_row0_col4" class="data row0 col4" >90.39</td>
      <td id="T_f861f_row0_col5" class="data row0 col5" >90.06</td>
      <td id="T_f861f_row0_col6" class="data row0 col6" >88.80</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The table above shows good agreement,
especially for longer accumulation periods.
For SPI-1, a quarter of the comparisons do not match.
While there are pixels across the entire region where <em>Œ±</em> does not match for one or two calendar months
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi1"><span class="std std-numref">6.1.8</span></a>),
the majority of mismatches are concentrated in deserts (Sahara and Arabian peninsula),
which in practice would be masked anyway for failing the <em>p<sub>0</sub></em> test (see above).
This pattern is even stronger in the distribution of SPI-3 normality
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi3"><span class="std std-numref">6.1.9</span></a>).
It is more difficult to fit a gamma distribution in drier areas and drier calendar months,
in which case SPI values are less trustworthy
‚Äì meaning the normality flag is working as intended.</p>
<p>In conclusion,
the differences in the normality mask (<em>Œ±</em> &lt; 0.05) seen above are likely caused by the differences in fitted distributions seen before,
and thus do not affect the assessment of reproducibility.
The mask provided with ERA5‚ÄìDrought can be used confidently to mask corresponding SPI values.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package masks into dictionary for plotting function; note use of LaTeX instead of unicode/HTML symbols</span>
<span class="n">masks</span> <span class="o">=</span> <span class="p">{</span><span class="sa">r</span><span class="s2">&quot;$\alpha &lt; 0.05$&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normality_era5drought_mask</span><span class="p">,</span> <span class="n">normality_reproduced_mask</span><span class="p">],</span>
        <span class="p">}</span>

<span class="c1"># Display quality flags ‚Äì this step may take a few minutes</span>
<span class="c1"># SPI-1: Compare to table</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;SPI1&quot;</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-normality-region-spi1&quot;</span><span class="p">)</span>

<span class="c1"># SPI-3: Compare to Keune+25 Fig 3.</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;SPI3&quot;</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-normality-region-spi3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-6">
SPI-1</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi1">
<img alt="../_images/b6b8f73fb62122783d14f3f1fe9d45c46dc011644e447a2efe71b2c8f8242005.png" src="../_images/b6b8f73fb62122783d14f3f1fe9d45c46dc011644e447a2efe71b2c8f8242005.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.8 </span><span class="caption-text">Shapiro‚ÄìWilk normality <em>Œ±</em> for SPI-1 and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
The <em>Œ±</em> &lt; 0.05 mask is displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.
This figure displays only the example region (Horn of Africa).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="spi3" for="sd-tab-item-7">
SPI-3</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi3">
<img alt="../_images/fd91cffe30b1cd96caa85c9a738d276c5fc8d56941b6a3c92baf0dfa368e4b25.png" src="../_images/fd91cffe30b1cd96caa85c9a738d276c5fc8d56941b6a3c92baf0dfa368e4b25.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.9 </span><span class="caption-text">Shapiro‚ÄìWilk normality <em>Œ±</em> for SPI-3 and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
The <em>Œ±</em> &lt; 0.05 mask is displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.
This figure displays only the example region (Horn of Africa).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-normality-region-spi3" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="spei-comparison">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-spei"></span><h3>4. SPEI comparison<a class="headerlink" href="#spei-comparison" title="Link to this heading">#</a></h3>
<p>The process of calculating SPEI is very similar to that for SPI, with three major differences:</p>
<ul class="simple">
<li><p>SPEI is based on the water balance (precipitation and potential evaporation or evapotranspiration), rather than just precipitation.</p></li>
<li><p>SPEI is based on a logistic distribution, rather than a gamma distribution.</p></li>
<li><p>SPEI does not need to be adjusted for months with zero precipitation.</p></li>
</ul>
<p>As such, this section is structured similarly to <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spi"><span class="std std-ref">3. SPI comparison</span></a> and can be run entirely independently, but some of the more detailed explanations from said section are left out for brevity this time.</p>
<section id="download-monthly-precipitation-and-potential-evaporation-data-from-era5">
<h4>4.1 Download monthly precipitation and potential evaporation data from ERA5<a class="headerlink" href="#download-monthly-precipitation-and-potential-evaporation-data-from-era5" title="Link to this heading">#</a></h4>
<p>First, the monthly-mean total precipitation (variable <code class="docutils literal notranslate"><span class="pre">228.128</span></code>) and evaporation (variable <code class="docutils literal notranslate"><span class="pre">251.228</span></code>) are downloaded from the <a class="reference external" href="https://doi.org/10.24381/cds.143582cf" rel="noreferrer" target="_blank"><em>Complete ERA5 global atmospheric reanalysis</em></a> dataset.
More information about the format for these requests is available in the <a class="reference external" href="https://apps.ecmwf.int/data-catalogues/era5/?class=ea" rel="noreferrer" target="_blank">MARS ERA5 catalogue</a>.</p>
<p>When executing this notebook yourself, if you have previously run <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spi"><span class="std std-ref">3. SPI comparison</span></a> and have <a class="reference external" href="https://earthkit-data.readthedocs.io/en/latest/guide/caching.html" rel="noreferrer" target="_blank">caching</a> enabled in earthkit-data, the downloaded precipitation data will be re-used.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_era5_precipitation_moda</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;param&quot;</span><span class="p">:</span> <span class="s2">&quot;228.128&quot;</span><span class="p">,</span>  <span class="c1"># Variable: Total precipitation</span>
    <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;moda&quot;</span><span class="p">,</span>    <span class="c1"># Data stream: Monthly mean reanalysis</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5_template</span>

<span class="n">request_era5_pev_moda</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;param&quot;</span><span class="p">:</span> <span class="s2">&quot;251.228&quot;</span><span class="p">,</span>  <span class="c1"># Variable: Potential evaporation</span>
    <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;moda&quot;</span><span class="p">,</span>    <span class="c1"># Data stream: Monthly mean reanalysis</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5_template</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data and load into xarray</span>
<span class="n">data_era5_waterbalance_cds</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5</span><span class="p">,</span> <span class="n">request_era5_precipitation_moda</span><span class="p">,</span> <span class="n">request_era5_pev_moda</span><span class="p">)</span>  <span class="c1"># Download as field list</span>
<span class="n">data_era5_waterbalance_cds</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_cds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>

<span class="c1"># Pre-process to desired format</span>
<span class="c1"># Note the change in variable name</span>
<span class="n">data_era5_waterbalance_preprocessed</span> <span class="o">=</span> <span class="n">preprocess_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_cds</span><span class="p">)</span>

<span class="c1"># Display in notebook</span>
<span class="n">data_era5_waterbalance_preprocessed</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 8GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
Data variables:
    tp       (time, lat, lon) float32 4GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    pev      (time, lat, lon) float32 4GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f2861300-0e04-43e7-8074-5189b783e0fd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f2861300-0e04-43e7-8074-5189b783e0fd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8d0b7ea9-a690-4ec3-9635-b67237568ec2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8d0b7ea9-a690-4ec3-9635-b67237568ec2' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-abc7637a-5d47-44c1-9843-7c3d1a879532' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-abc7637a-5d47-44c1-9843-7c3d1a879532' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96e873d2-4357-49f0-bd3e-0e7f4dae5124' class='xr-var-data-in' type='checkbox'><label for='data-96e873d2-4357-49f0-bd3e-0e7f4dae5124' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-494a14f9-ff84-4ee6-8ffb-25e52919a1bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-494a14f9-ff84-4ee6-8ffb-25e52919a1bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-464ede70-8498-4590-957e-388060809453' class='xr-var-data-in' type='checkbox'><label for='data-464ede70-8498-4590-957e-388060809453' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-173796f0-074b-4737-a1dd-a7030384d871' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-173796f0-074b-4737-a1dd-a7030384d871' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbd48e90-7b36-43ca-9604-ba1777016aa7' class='xr-var-data-in' type='checkbox'><label for='data-cbd48e90-7b36-43ca-9604-ba1777016aa7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-5fcfce2f-e1a7-453a-b69e-b2fd29f59a21' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5fcfce2f-e1a7-453a-b69e-b2fd29f59a21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f6080a8f-2b5a-46a1-9afc-763f45483a15' class='xr-var-data-in' type='checkbox'><label for='data-f6080a8f-2b5a-46a1-9afc-763f45483a15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-11f75b62-37f9-4128-8b23-d84923c9f7ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-11f75b62-37f9-4128-8b23-d84923c9f7ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e756525-3452-47f6-b9a4-b6e425bd826b' class='xr-var-data-in' type='checkbox'><label for='data-3e756525-3452-47f6-b9a4-b6e425bd826b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-db1b0ba6-aa63-4b30-b047-1da0d8799c49' class='xr-section-summary-in' type='checkbox'  checked><label for='section-db1b0ba6-aa63-4b30-b047-1da0d8799c49' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-cab7b5ed-0f8b-4943-a63f-1f4f1275af39' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cab7b5ed-0f8b-4943-a63f-1f4f1275af39' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d874a272-3992-4ce9-a044-b79fb795c1c3' class='xr-var-data-in' type='checkbox'><label for='data-d874a272-3992-4ce9-a044-b79fb795c1c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>228</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgad</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>359.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total precipitation</dd><dt><span>GRIB_shortName :</span></dt><dd>tp</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>units :</span></dt><dd>mm</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.95 GiB </td>
                        <td> 144.28 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pev</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-94d406eb-f00c-4168-a488-d2399d50b836' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-94d406eb-f00c-4168-a488-d2399d50b836' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47498fb4-2ad8-45b2-b1f2-223e9a1a9db7' class='xr-var-data-in' type='checkbox'><label for='data-47498fb4-2ad8-45b2-b1f2-223e9a1a9db7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>228251</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgad</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>pev</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>359.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Potential evaporation</dd><dt><span>GRIB_shortName :</span></dt><dd>pev</dd><dt><span>GRIB_totalNumber :</span></dt><dd>0</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Potential evaporation</dd><dt><span>units :</span></dt><dd>mm</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 3.95 GiB </td>
                        <td> 144.28 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-b06735ca-7392-4128-bec2-94a5faba5e46' class='xr-section-summary-in' type='checkbox'  ><label for='section-b06735ca-7392-4128-bec2-94a5faba5e46' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7ad3ad77-a3d0-4aeb-93b6-ada56d4183f5' class='xr-index-data-in' type='checkbox'/><label for='index-7ad3ad77-a3d0-4aeb-93b6-ada56d4183f5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-60329ae7-8d2e-4086-9fed-0660d423a073' class='xr-index-data-in' type='checkbox'/><label for='index-60329ae7-8d2e-4086-9fed-0660d423a073' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ad67e7a0-b85f-40f5-af30-c30d6ead0344' class='xr-index-data-in' type='checkbox'/><label for='index-ad67e7a0-b85f-40f5-af30-c30d6ead0344' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ff0f7b1c-3f6e-46a1-b402-ce35b9a166af' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ff0f7b1c-3f6e-46a1-b402-ce35b9a166af' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="calculate-water-balance-over-accumulation-periods">
<h4>4.2 Calculate water balance over accumulation periods<a class="headerlink" href="#calculate-water-balance-over-accumulation-periods" title="Link to this heading">#</a></h4>
<p>The water balance represents the net gain or loss of water in an area due to precipitation (gain) and evaporation (loss).
<a class="reference external" href="https://codes.ecmwf.int/grib/param-db/182" rel="noreferrer" target="_blank">ECMWF‚Äôs convention</a>, as used in ERA5, is that downward fluxes are positive and upward fluxes are negative.
This means that
total precipitation is always positive (or zero),
potential evaporation is always negative (or zero),
and the water balance is simply the sum of the two: <em>WB = TP + PEV</em>.</p>
<p>Here, we calculate the water balance per point in the downloaded ERA5 data and accumulate it over the same periods as before (1, 3, 6, 12, 24, 36, and 48 months).</p>
<p>The resulting accumulated time series for the example site defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>,
Addis Ababa in Ethiopia in our example,
are displayed in Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-wb-accumulated"><span class="std std-numref">6.1.10</span></a>.
This example clearly demonstrates how the water balance moves between positive and negative
(net gain vs. net loss)
and how this changes depending on the accumulation period.
For example,
the shortest accumulation periods
(1‚Äì6 months)
swing up and down seasonally,
but the longer-term (e.g. 48-month) accumulated water balance tends to be positive except in specific periods (e.g. the 1960s).</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate water balance</span>
<span class="n">data_era5_waterbalance</span> <span class="o">=</span> <span class="n">calculate_waterbalance</span><span class="p">(</span><span class="n">data_era5_waterbalance_preprocessed</span><span class="p">)</span>

<span class="c1"># Accumulate water balance</span>
<span class="n">data_era5_waterbalance</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">data_era5_waterbalance</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">data_era5_waterbalance</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
Data variables:
    wb1      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb3      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb6      (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb12     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb24     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb36     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    wb48     (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-aeceecad-212d-4dda-aa04-cbc8c4b1ca8a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-aeceecad-212d-4dda-aa04-cbc8c4b1ca8a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-aae4f7d9-1191-48ce-960c-301c58a1dfc3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aae4f7d9-1191-48ce-960c-301c58a1dfc3' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-67247ce0-d9ff-4b1b-9bb7-01ab4eaf0976' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-67247ce0-d9ff-4b1b-9bb7-01ab4eaf0976' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ecaa53b0-a1d9-422b-a074-31e776241ad0' class='xr-var-data-in' type='checkbox'><label for='data-ecaa53b0-a1d9-422b-a074-31e776241ad0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-269e6077-1a53-411a-beb2-78fce217b175' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-269e6077-1a53-411a-beb2-78fce217b175' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9c03c0c-e073-4484-a179-f0536cf62502' class='xr-var-data-in' type='checkbox'><label for='data-a9c03c0c-e073-4484-a179-f0536cf62502' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-3bbd588c-b1cd-438a-b41a-7f38c753e42a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3bbd588c-b1cd-438a-b41a-7f38c753e42a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc8c69eb-0de6-4749-89bc-2f7850349d96' class='xr-var-data-in' type='checkbox'><label for='data-bc8c69eb-0de6-4749-89bc-2f7850349d96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-8ada1c61-77d1-42dd-81f9-b183f18ef3ec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8ada1c61-77d1-42dd-81f9-b183f18ef3ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74f341c7-62e7-4a81-990b-ad229635ff7f' class='xr-var-data-in' type='checkbox'><label for='data-74f341c7-62e7-4a81-990b-ad229635ff7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-7d7705c1-2775-4376-9797-c6721adf6839' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d7705c1-2775-4376-9797-c6721adf6839' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd6c5a08-ee6b-4670-85c1-b4de7b4746fe' class='xr-var-data-in' type='checkbox'><label for='data-fd6c5a08-ee6b-4670-85c1-b4de7b4746fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-15423e86-bb4f-4aa0-b03a-e976bd4a2846' class='xr-section-summary-in' type='checkbox'  checked><label for='section-15423e86-bb4f-4aa0-b03a-e976bd4a2846' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>wb1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-8d7e14e5-e45e-4808-8ab2-b1df6d152bf3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d7e14e5-e45e-4808-8ab2-b1df6d152bf3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2df3329-9e2a-4f48-a9da-a2cf1b65df7d' class='xr-var-data-in' type='checkbox'><label for='data-e2df3329-9e2a-4f48-a9da-a2cf1b65df7d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-d3e75a3c-9f8b-4df4-b0f6-18b993e16c0d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d3e75a3c-9f8b-4df4-b0f6-18b993e16c0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c823f8d-286a-4ff4-b955-afd66da8c2d2' class='xr-var-data-in' type='checkbox'><label for='data-0c823f8d-286a-4ff4-b955-afd66da8c2d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-2ba10c44-eeaa-47de-b104-93e6b0c21e6a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2ba10c44-eeaa-47de-b104-93e6b0c21e6a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f04030f4-f5bf-4cb2-a81e-9694d56a6fa8' class='xr-var-data-in' type='checkbox'><label for='data-f04030f4-f5bf-4cb2-a81e-9694d56a6fa8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-08dd0b8f-1aa2-42ce-b495-56208f0afe30' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-08dd0b8f-1aa2-42ce-b495-56208f0afe30' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45e33250-4b5d-4424-9878-c92b89504a13' class='xr-var-data-in' type='checkbox'><label for='data-45e33250-4b5d-4424-9878-c92b89504a13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-b188a76a-4bfc-45d5-9cfb-5f1f3a0aad84' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b188a76a-4bfc-45d5-9cfb-5f1f3a0aad84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd267cf7-8bf2-4a4f-8f2e-9291c93e5864' class='xr-var-data-in' type='checkbox'><label for='data-bd267cf7-8bf2-4a4f-8f2e-9291c93e5864' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-f8c0338b-a56d-446c-87e7-b640e19c5b5b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8c0338b-a56d-446c-87e7-b640e19c5b5b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc984344-f34e-46df-a3b2-709096816012' class='xr-var-data-in' type='checkbox'><label for='data-cc984344-f34e-46df-a3b2-709096816012' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wb48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-e71e2f6e-f48a-44e8-bcdc-20cf8423890a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e71e2f6e-f48a-44e8-bcdc-20cf8423890a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a947ef4-f24f-4e37-8837-9bc47703c876' class='xr-var-data-in' type='checkbox'><label for='data-6a947ef4-f24f-4e37-8837-9bc47703c876' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 36 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-9107a53a-b506-4dae-96c1-8f1dd51f3e85' class='xr-section-summary-in' type='checkbox'  ><label for='section-9107a53a-b506-4dae-96c1-8f1dd51f3e85' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3e58a5ea-bf46-43f3-a0c7-154b9f2cf0a4' class='xr-index-data-in' type='checkbox'/><label for='index-3e58a5ea-bf46-43f3-a0c7-154b9f2cf0a4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-147d005f-8e60-4c0a-b1f3-6ed342868e2b' class='xr-index-data-in' type='checkbox'/><label for='index-147d005f-8e60-4c0a-b1f3-6ed342868e2b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8613dec5-72ee-4ebb-a66e-72fa47ffb6c9' class='xr-index-data-in' type='checkbox'/><label for='index-8613dec5-72ee-4ebb-a66e-72fa47ffb6c9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bd250e20-92cf-4842-94c7-4c0289bcdb26' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bd250e20-92cf-4842-94c7-4c0289bcdb26' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display accumulated precipitation at example site</span>
<span class="n">plot_accumulated_waterbalance</span><span class="p">(</span><span class="n">data_era5_waterbalance</span><span class="p">,</span> <span class="n">example_site</span><span class="p">,</span>
                              <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-wb-accumulated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-wb-accumulated">
<img alt="../_images/bf90e11e50ef0d7706a0b2504d63967bee895adaef3adbef07e0cb744caa280c.png" src="../_images/bf90e11e50ef0d7706a0b2504d63967bee895adaef3adbef07e0cb744caa280c.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.10 </span><span class="caption-text">Water balance from ERA5 accumulated over different accumulation periods, for the example site of Addis Ababa, Ethiopia.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-wb-accumulated" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="fit-logistic-distribution-and-compute-spei">
<h4>4.3 Fit logistic distribution and compute SPEI<a class="headerlink" href="#fit-logistic-distribution-and-compute-spei" title="Link to this heading">#</a></h4>
<p>While SPI assumes a gamma distribution for total precipitation,
this does not hold for water balance.
For SPEI,
various distributions are used in the literature [<a class="reference external" href="https://doi.org/10.1002/joc.4267" rel="noreferrer" target="_blank">Stagge+15</a>].
While [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] specifies that ERA5‚ÄìDrought‚Äôs SPEI is based on the generalised log-logistic distribution,
following [<a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1" rel="noreferrer" target="_blank">Vicente-Serrano+10</a>],
private communication with the authors indicates that a generalised logistic distribution is used instead.</p>
<p>As before, the distribution is fitted to data in the reference window (1991‚Äì2020),
Here, we use
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.genlogistic.html" rel="noreferrer" target="_blank">scipy.stats.genlogistic</a>
to fit the generalised logistic distribution.
This returns three parameters for each calendar month and accumulation period, namely
shape (<em>c</em>), location (<em>Œº</em>), and scale (<em>Œ≤</em>).</p>
<p>The observed (accumulated) water balance values along the entire time series
are then compared to the fitted parameters in terms of where they fall on the cumulative distribution function (CDF).
From these CDF values,
SPEI values
for each data point (latitude, longitude, time)
are calculated by transforming to a standard normal distribution.
The zero-precipitation correction from <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-spi"><span class="std std-ref">3. SPI comparison</span></a> is not relevant to SPEI.</p>
<p>Note that actually evaluating the CDF
‚Äì as opposed to <a class="reference external" href="https://docs.xarray.dev/en/stable/user-guide/dask.html" rel="noreferrer" target="_blank">queueing it up in dask</a>, as done here ‚Äì
can be slow, especially for a large dataset like global ERA5 precipitation and evaporation.
As such, if you are interested in a subset of the data,
such as a specific site or period in time,
it may be best to subset your data <em>before</em> calculating the CDF rather than afterwards.
An example of this is provided below in the comparison with ERA5‚ÄìDrought SPEI.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select data in reference window</span>
<span class="n">data_era5_waterbalance_reference</span> <span class="o">=</span> <span class="n">data_era5_waterbalance</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Fit generalised logistic distribution</span>
<span class="n">spei_parameters</span> <span class="o">=</span> <span class="n">fit_monthly_spei</span><span class="p">(</span><span class="n">data_era5_waterbalance_reference</span><span class="p">)</span>

<span class="c1"># Compute CDF time series</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">compute_cdf_spei</span><span class="p">(</span><span class="n">data_era5_waterbalance</span><span class="p">,</span> <span class="n">spei_parameters</span><span class="p">)</span>

<span class="c1"># Calculate SPI from adjusted CDF</span>
<span class="n">spei_reproduced</span> <span class="o">=</span> <span class="n">cdf_to_spei</span><span class="p">(</span><span class="n">cdf</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">spei_reproduced</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 59GB
Dimensions:  (time: 1020, lat: 721, lon: 1440)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    SPEI1    (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI3    (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI6    (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI12   (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI24   (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI36   (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;
    SPEI48   (time, lat, lon) float64 8GB dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f655fa2e-c7de-43a8-8e69-83ec7e22d5ec' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f655fa2e-c7de-43a8-8e69-83ec7e22d5ec' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-aa878166-59b1-413d-9619-66b8e049e075' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aa878166-59b1-413d-9619-66b8e049e075' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-4a480a04-5ef0-4354-9539-0031aaa205aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a480a04-5ef0-4354-9539-0031aaa205aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d89406e-0823-4f2c-a7e8-370c726bbbeb' class='xr-var-data-in' type='checkbox'><label for='data-5d89406e-0823-4f2c-a7e8-370c726bbbeb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-781b35cb-5b5f-41cd-a150-6b381fec10ab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-781b35cb-5b5f-41cd-a150-6b381fec10ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5d91f64-5ab3-4474-9194-3afbd355844a' class='xr-var-data-in' type='checkbox'><label for='data-a5d91f64-5ab3-4474-9194-3afbd355844a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-755f7ab6-5679-4655-848e-5badcdf8dcc6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-755f7ab6-5679-4655-848e-5badcdf8dcc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c57d4e74-5f11-478e-ba2c-dba023098779' class='xr-var-data-in' type='checkbox'><label for='data-c57d4e74-5f11-478e-ba2c-dba023098779' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-8585af9c-3f26-496c-b181-064721b09bc6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8585af9c-3f26-496c-b181-064721b09bc6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f07d6ad-be24-4dcb-b39a-c85c1fcf0143' class='xr-var-data-in' type='checkbox'><label for='data-9f07d6ad-be24-4dcb-b39a-c85c1fcf0143' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-e5d767da-05ed-4ba6-8100-832698d6406c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e5d767da-05ed-4ba6-8100-832698d6406c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35ee570a-5077-4ad2-a3fc-71d14ecc0fc6' class='xr-var-data-in' type='checkbox'><label for='data-35ee570a-5077-4ad2-a3fc-71d14ecc0fc6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-1a6e4fcb-5440-449a-a93d-b54c67a2ee21' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a6e4fcb-5440-449a-a93d-b54c67a2ee21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d7d3c9f-3bed-48ca-bbd5-31e43f92f08a' class='xr-var-data-in' type='checkbox'><label for='data-4d7d3c9f-3bed-48ca-bbd5-31e43f92f08a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-a8832821-453b-468f-8210-3204a3ddeb9a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a8832821-453b-468f-8210-3204a3ddeb9a' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-b08f7639-93a7-45c5-b9e1-67eadb7df588' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b08f7639-93a7-45c5-b9e1-67eadb7df588' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-deda0f31-d83f-4410-8b3b-e28dfbb10667' class='xr-var-data-in' type='checkbox'><label for='data-deda0f31-d83f-4410-8b3b-e28dfbb10667' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-6f5ed377-7e81-4e85-a18b-23543800d1e2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f5ed377-7e81-4e85-a18b-23543800d1e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5fb35cc-9486-48c5-80d9-a84369622bdf' class='xr-var-data-in' type='checkbox'><label for='data-b5fb35cc-9486-48c5-80d9-a84369622bdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-9c0033f0-fa3d-4a29-9ce2-297c8275a0d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9c0033f0-fa3d-4a29-9ce2-297c8275a0d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee402c8d-5a97-4e73-929e-e6f38af2afa9' class='xr-var-data-in' type='checkbox'><label for='data-ee402c8d-5a97-4e73-929e-e6f38af2afa9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-65f38741-6636-47bb-a19d-478e08e5ff7e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65f38741-6636-47bb-a19d-478e08e5ff7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc9ba5ec-2b20-48ad-841f-a795e1a072bd' class='xr-var-data-in' type='checkbox'><label for='data-cc9ba5ec-2b20-48ad-841f-a795e1a072bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-ec66f0df-5f2b-4135-ab96-895b30d59810' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec66f0df-5f2b-4135-ab96-895b30d59810' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a22a8816-8cd9-459d-8941-f22b2d0be824' class='xr-var-data-in' type='checkbox'><label for='data-a22a8816-8cd9-459d-8941-f22b2d0be824' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-42a7c3e8-069f-4fa7-95c6-55a5c0a5ccc7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-42a7c3e8-069f-4fa7-95c6-55a5c0a5ccc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37aebe74-e0b7-4ee5-a0e6-d06e33dac9fd' class='xr-var-data-in' type='checkbox'><label for='data-37aebe74-e0b7-4ee5-a0e6-d06e33dac9fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-6dec858f-ed46-42e9-bedc-69f8a00713e4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6dec858f-ed46-42e9-bedc-69f8a00713e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e23f3cac-ec94-45eb-84ee-8c0d70fb25b1' class='xr-var-data-in' type='checkbox'><label for='data-e23f3cac-ec94-45eb-84ee-8c0d70fb25b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.89 GiB </td>
                        <td> 288.56 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020, 721, 1440) </td>
                        <td> (1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 28 chunks in 128 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="230" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="10" y1="8" x2="60" y2="58" />
  <line x1="10" y1="17" x2="60" y2="67" />
  <line x1="10" y1="25" x2="60" y2="75" />
  <line x1="10" y1="34" x2="60" y2="84" />
  <line x1="10" y1="42" x2="60" y2="92" />
  <line x1="10" y1="51" x2="60" y2="101" />
  <line x1="10" y1="60" x2="60" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 60.0,50.0 60.0,110.08333333333334 10.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="60" y2="50" style="stroke-width:2" />
  <line x1="40" y1="0" x2="90" y2="50" />
  <line x1="70" y1="0" x2="120" y2="50" />
  <line x1="100" y1="0" x2="150" y2="50" />
  <line x1="130" y1="0" x2="180" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 180.0,50.0 60.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="60" y1="50" x2="180" y2="50" style="stroke-width:2" />
  <line x1="60" y1="58" x2="180" y2="58" />
  <line x1="60" y1="67" x2="180" y2="67" />
  <line x1="60" y1="75" x2="180" y2="75" />
  <line x1="60" y1="84" x2="180" y2="84" />
  <line x1="60" y1="92" x2="180" y2="92" />
  <line x1="60" y1="101" x2="180" y2="101" />
  <line x1="60" y1="110" x2="180" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="60" y1="50" x2="60" y2="110" style="stroke-width:2" />
  <line x1="90" y1="50" x2="90" y2="110" />
  <line x1="120" y1="50" x2="120" y2="110" />
  <line x1="150" y1="50" x2="150" y2="110" />
  <line x1="180" y1="50" x2="180" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="60.0,50.0 180.0,50.0 180.0,110.08333333333334 60.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="120.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="200.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,200.000000,80.041667)">721</text>
  <text x="25.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,25.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-f6d746d1-45ce-4f2b-b624-82313876d8c8' class='xr-section-summary-in' type='checkbox'  ><label for='section-f6d746d1-45ce-4f2b-b624-82313876d8c8' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-43441475-c567-449a-b4f4-674354ad196a' class='xr-index-data-in' type='checkbox'/><label for='index-43441475-c567-449a-b4f4-674354ad196a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-da3e93b8-44b6-4d6d-9dfd-f856e41d8ff8' class='xr-index-data-in' type='checkbox'/><label for='index-da3e93b8-44b6-4d6d-9dfd-f856e41d8ff8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-65612e0f-6245-4e72-b630-db68a14357f1' class='xr-index-data-in' type='checkbox'/><label for='index-65612e0f-6245-4e72-b630-db68a14357f1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3986f355-3f44-4bbd-b024-e0574c8ed2d6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3986f355-3f44-4bbd-b024-e0574c8ed2d6' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
</section>
<section id="spei-comparison-time-series-in-example-site">
<h4>4.4 SPEI comparison: Time series in example site<a class="headerlink" href="#spei-comparison-time-series-in-example-site" title="Link to this heading">#</a></h4>
<p>Having reproduced SPEI from ERA5 precipitation and potential evaporation data following the ERA5‚ÄìDrought methodology,
we can now compare the results to assess the reproducibility of ERA5‚ÄìDrought.
We first compare the datasets over time at the example site defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.</p>
<p>As before,
because the global calculation set up in the previous subsections can take a long time to execute,
here we sub-select the downloaded ERA5 data and calculate SPEI for the example site only.
For convenience, the full SPEI pipeline is wrapped into a single <code class="docutils literal notranslate"><span class="pre">calculate_spei_from_era5</span></code> function,
as defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"><span class="std std-ref">1. Code setup</span></a>.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_waterbalance_site</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Calculate SPI</span>
<span class="n">spei_reproduced_site</span> <span class="o">=</span> <span class="n">calculate_spei_from_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_site</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spei_reproduced_site</span> <span class="o">=</span> <span class="n">spei_reproduced_site</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spei_reproduced_site</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 90kB
Dimensions:  (time: 1020)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    lat      float64 8B 9.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    lon      float64 8B 38.75
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    SPEI1    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI3    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI6    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI12   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI24   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI36   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI48   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3f1d3f8e-2333-42dc-a9ef-f0218342328d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3f1d3f8e-2333-42dc-a9ef-f0218342328d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-81ee6299-8703-4e5d-8ed9-248573225ee1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-81ee6299-8703-4e5d-8ed9-248573225ee1' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-8dba02f5-07fb-4f1d-9be3-62d6da8e83f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8dba02f5-07fb-4f1d-9be3-62d6da8e83f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e687605-240c-4579-8312-aaaed57bd2a2' class='xr-var-data-in' type='checkbox'><label for='data-5e687605-240c-4579-8312-aaaed57bd2a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-621f18d6-b040-47b0-9924-cd077e814510' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-621f18d6-b040-47b0-9924-cd077e814510' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fad57df0-52fa-45a8-a382-f4a2f001dfa6' class='xr-var-data-in' type='checkbox'><label for='data-fad57df0-52fa-45a8-a382-f4a2f001dfa6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-cc48b9eb-9105-44d0-9bf3-c208872b1bc3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc48b9eb-9105-44d0-9bf3-c208872b1bc3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1e5676f-16e6-42a8-86ef-17ff3bd80350' class='xr-var-data-in' type='checkbox'><label for='data-e1e5676f-16e6-42a8-86ef-17ff3bd80350' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-8490867c-b6ef-4fee-843e-f68f86eeaab8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8490867c-b6ef-4fee-843e-f68f86eeaab8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6accbb7e-6509-4e6c-aadd-18c671333e05' class='xr-var-data-in' type='checkbox'><label for='data-6accbb7e-6509-4e6c-aadd-18c671333e05' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-33b2d6a2-8923-4089-a064-e7c65a988e6b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-33b2d6a2-8923-4089-a064-e7c65a988e6b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f3403b9-6090-4963-8b0a-8273ee063911' class='xr-var-data-in' type='checkbox'><label for='data-9f3403b9-6090-4963-8b0a-8273ee063911' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-2592cca1-b8c5-4f12-9d2d-6c4408aa0251' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2592cca1-b8c5-4f12-9d2d-6c4408aa0251' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0117f322-193b-41d0-847a-b597f6f55fbf' class='xr-var-data-in' type='checkbox'><label for='data-0117f322-193b-41d0-847a-b597f6f55fbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-53714113-8e83-4c4d-971a-2b0c7a185895' class='xr-section-summary-in' type='checkbox'  checked><label for='section-53714113-8e83-4c4d-971a-2b0c7a185895' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-3190d463-98f9-4395-a052-c043cb772d56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3190d463-98f9-4395-a052-c043cb772d56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b81c409e-68d9-490c-a7a3-2d09f38a3460' class='xr-var-data-in' type='checkbox'><label for='data-b81c409e-68d9-490c-a7a3-2d09f38a3460' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-a46b9678-5fbe-4272-b87d-6d0b27a8ed60' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a46b9678-5fbe-4272-b87d-6d0b27a8ed60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a82c204-d401-41ce-937b-9fef1db80c01' class='xr-var-data-in' type='checkbox'><label for='data-0a82c204-d401-41ce-937b-9fef1db80c01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-71092c02-1797-45ad-8372-ec46df42907d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-71092c02-1797-45ad-8372-ec46df42907d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-997192f7-00dc-409a-acfb-7d0c79b4ff8c' class='xr-var-data-in' type='checkbox'><label for='data-997192f7-00dc-409a-acfb-7d0c79b4ff8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-9645df23-bad2-4c6d-a960-0cb732e88647' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9645df23-bad2-4c6d-a960-0cb732e88647' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d4c60f3-301e-4d15-ad03-7c5327eb821d' class='xr-var-data-in' type='checkbox'><label for='data-0d4c60f3-301e-4d15-ad03-7c5327eb821d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-0f5c92b9-9188-44eb-ba19-ce2e5a1dd14b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f5c92b9-9188-44eb-ba19-ce2e5a1dd14b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b7601fc-379b-4492-b0a8-3f8fd53f6bc2' class='xr-var-data-in' type='checkbox'><label for='data-1b7601fc-379b-4492-b0a8-3f8fd53f6bc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-42a3afa1-9c6d-4ccd-a22c-256e7d68fc07' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-42a3afa1-9c6d-4ccd-a22c-256e7d68fc07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e1afea8-2dce-432c-8394-4e2dcbb3fdfa' class='xr-var-data-in' type='checkbox'><label for='data-1e1afea8-2dce-432c-8394-4e2dcbb3fdfa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-ec44337c-2e06-4397-9ce0-b4526add1a58' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec44337c-2e06-4397-9ce0-b4526add1a58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17208276-5ea3-4158-9409-40d5e27d8813' class='xr-var-data-in' type='checkbox'><label for='data-17208276-5ea3-4158-9409-40d5e27d8813' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-29220dd0-33ff-4c82-b738-18056fa56cbb' class='xr-section-summary-in' type='checkbox'  ><label for='section-29220dd0-33ff-4c82-b738-18056fa56cbb' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ea8c8caf-28bb-40bc-8751-650336ebfb88' class='xr-index-data-in' type='checkbox'/><label for='index-ea8c8caf-28bb-40bc-8751-650336ebfb88' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4ba464ea-daa1-4473-8db0-e2c31b6488b4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4ba464ea-daa1-4473-8db0-e2c31b6488b4' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>Next, we download the corresponding data from ERA5‚ÄìDrought.
Because of size limits on the CDS,
the time series must be downloaded in parts:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main request, based on template and example site</span>
<span class="n">request_era5drought_spei</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_evapotranspiration_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index</span> <span class="o">|</span> <span class="n">request_site</span>

<span class="c1"># Split into batches of up to 20 years each</span>
<span class="n">subrequests_era5drought_spei</span> <span class="o">=</span> <span class="n">batch_requests</span><span class="p">(</span><span class="n">request_era5drought_spei</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Download data and load into xarray</span>
<span class="n">spei_era5drought_site</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="o">*</span><span class="n">subrequests_era5drought_spei</span><span class="p">)</span>
<span class="n">spei_era5drought_site</span> <span class="o">=</span> <span class="n">spei_era5drought_site</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">spei_era5drought_site</span> <span class="o">=</span> <span class="n">spei_era5drought_site</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Full time series in one chunk</span>

<span class="c1"># Select only desired site (remove margins)</span>
<span class="n">spei_era5drought_site</span> <span class="o">=</span> <span class="n">spei_era5drought_site</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spei_era5drought_site</span> <span class="o">=</span> <span class="n">spei_era5drought_site</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spei_era5drought_site</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 65kB
Dimensions:  (time: 1020)
Coordinates:
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    lat      float64 8B 9.0
    lon      float64 8B 38.75
Data variables:
    SPEI12   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI1    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI24   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI36   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI3    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI48   (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    SPEI6    (time) float64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Attributes: (12/17)
    title:                   SPEI12
    description:             Drought Index: Standardized Drought Index calcul...
    Conventions:             CF-1.8
    history:                 Created 13/08/2024 14:50:12 using DRYFALL.
    institution:             European Centre for Medium-Range Weather Forecasts
    source:                  DRYFALL v1.0
    ...                      ...
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    ref_publication:         Keune, J., Di Giuseppe, F., Barnard, C., Damasio...
    cds_data_catalogue_url:  https://cds.climate.copernicus.eu/datasets/deriv...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-12bacfb4-7f7f-4ab1-93fc-2119f289a1fa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-12bacfb4-7f7f-4ab1-93fc-2119f289a1fa' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a7f3558a-1a7a-437e-ad05-0b55c1a59d06' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a7f3558a-1a7a-437e-ad05-0b55c1a59d06' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-b4fcaaf6-3c12-42c6-a232-7722c2ed8696' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b4fcaaf6-3c12-42c6-a232-7722c2ed8696' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-781d6d2f-a609-4a8b-9317-245cefd4c296' class='xr-var-data-in' type='checkbox'><label for='data-781d6d2f-a609-4a8b-9317-245cefd4c296' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-a1128545-c576-4737-95dd-5ad19d475c7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1128545-c576-4737-95dd-5ad19d475c7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df4a0726-7479-407c-a4b3-1d458db420d2' class='xr-var-data-in' type='checkbox'><label for='data-df4a0726-7479-407c-a4b3-1d458db420d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-19571384-9f10-4b8a-aefc-4b240776595b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19571384-9f10-4b8a-aefc-4b240776595b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8990db70-2d01-4f56-b29a-825d9c533105' class='xr-var-data-in' type='checkbox'><label for='data-8990db70-2d01-4f56-b29a-825d9c533105' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7ce3fe82-7864-4ff0-976d-104d4c871ec8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7ce3fe82-7864-4ff0-976d-104d4c871ec8' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-17bfa05d-2b41-43ef-9d50-215f92e148b4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-17bfa05d-2b41-43ef-9d50-215f92e148b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5080ea11-2320-44f6-8d7f-bdde0dab9577' class='xr-var-data-in' type='checkbox'><label for='data-5080ea11-2320-44f6-8d7f-bdde0dab9577' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI12)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-912530fd-b76c-4dbb-b52c-856c5fcaeff6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-912530fd-b76c-4dbb-b52c-856c5fcaeff6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9acab905-e891-43f0-a651-95cd228ec485' class='xr-var-data-in' type='checkbox'><label for='data-9acab905-e891-43f0-a651-95cd228ec485' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI1)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-64163c4b-ac4c-46dd-9a62-51dc2bf3242a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64163c4b-ac4c-46dd-9a62-51dc2bf3242a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a4956a0-902c-4bb7-88c3-f8d1801f2485' class='xr-var-data-in' type='checkbox'><label for='data-0a4956a0-902c-4bb7-88c3-f8d1801f2485' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI24)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-792f83e8-f12a-4ac8-a28e-d5f23ffad079' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-792f83e8-f12a-4ac8-a28e-d5f23ffad079' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a98d5cfa-ceb0-4946-9dad-10ce021b5301' class='xr-var-data-in' type='checkbox'><label for='data-a98d5cfa-ceb0-4946-9dad-10ce021b5301' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI36)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-46071697-fb7f-4346-9f25-bc70b92d85f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46071697-fb7f-4346-9f25-bc70b92d85f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1dc5bc08-f678-4101-a924-4e70f98183d5' class='xr-var-data-in' type='checkbox'><label for='data-1dc5bc08-f678-4101-a924-4e70f98183d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI3)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-13785ce6-5538-4dab-8cb7-50b880583113' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-13785ce6-5538-4dab-8cb7-50b880583113' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5820c78-428d-4301-8a03-cfec13961116' class='xr-var-data-in' type='checkbox'><label for='data-e5820c78-428d-4301-8a03-cfec13961116' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI48)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-da18f13e-022e-43ce-adcc-9c1415584713' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-da18f13e-022e-43ce-adcc-9c1415584713' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09d09de4-7d69-47ca-8cf8-2f6332740d28' class='xr-var-data-in' type='checkbox'><label for='data-09d09de4-7d69-47ca-8cf8-2f6332740d28' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI6)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-2ec60b36-1cd7-4a61-a0fc-352cc362d5f6' class='xr-section-summary-in' type='checkbox'  ><label for='section-2ec60b36-1cd7-4a61-a0fc-352cc362d5f6' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-17b1bc1e-7a32-4cb4-af84-354e1b3912a6' class='xr-index-data-in' type='checkbox'/><label for='index-17b1bc1e-7a32-4cb4-af84-354e1b3912a6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8615eb1e-cf81-4428-a5e5-e39780438136' class='xr-section-summary-in' type='checkbox'  ><label for='section-8615eb1e-cf81-4428-a5e5-e39780438136' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>SPEI12</dd><dt><span>description :</span></dt><dd>Drought Index: Standardized Drought Index calculated according to the WMO guidelines (see https://library.wmo.int/doc_num.php?explnum_id=7768).</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>history :</span></dt><dd>Created 13/08/2024 14:50:12 using DRYFALL.</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., Di Giuseppe, F., Barnard, C., Damasio da Costa, E., and Wetterhall, F. (2025): ERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis, Scientific Data 12, 616. https://doi.org/10.1038/s41597-025-04896-y</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://cds.climate.copernicus.eu/datasets/derived-drought-historical-monthly</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>Again, we examine the per-point difference in SPEI between ERA5‚ÄìDrought and the reproduction for each calendar month and each accumulation period.
We calculate the median difference MŒî and median absolute difference M|Œî|,
as well as the percentage of match-ups where |Œî| ‚â• 0.10:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPEI median differences</span>
<span class="n">spei_difference_site</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spei_era5drought_site</span><span class="p">,</span> <span class="n">spei_reproduced_site</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spei_difference_site</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_b59a8 th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_b59a8 th.col_heading {
  border-bottom: 0;
}
#T_b59a8 table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_b59a8 th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_b59a8_row0_col0, #T_b59a8_row0_col3, #T_b59a8_row0_col6, #T_b59a8_row0_col9, #T_b59a8_row0_col12, #T_b59a8_row0_col15, #T_b59a8_row0_col18, #T_b59a8_row1_col0, #T_b59a8_row1_col3, #T_b59a8_row1_col6, #T_b59a8_row1_col9, #T_b59a8_row1_col12, #T_b59a8_row1_col15, #T_b59a8_row1_col18, #T_b59a8_row2_col0, #T_b59a8_row2_col3, #T_b59a8_row2_col6, #T_b59a8_row2_col9, #T_b59a8_row2_col12, #T_b59a8_row2_col15, #T_b59a8_row2_col18, #T_b59a8_row3_col0, #T_b59a8_row3_col3, #T_b59a8_row3_col6, #T_b59a8_row3_col9, #T_b59a8_row3_col12, #T_b59a8_row3_col15, #T_b59a8_row3_col18, #T_b59a8_row4_col0, #T_b59a8_row4_col3, #T_b59a8_row4_col6, #T_b59a8_row4_col9, #T_b59a8_row4_col12, #T_b59a8_row4_col15, #T_b59a8_row4_col18, #T_b59a8_row5_col0, #T_b59a8_row5_col3, #T_b59a8_row5_col6, #T_b59a8_row5_col9, #T_b59a8_row5_col12, #T_b59a8_row5_col15, #T_b59a8_row5_col18, #T_b59a8_row6_col0, #T_b59a8_row6_col3, #T_b59a8_row6_col6, #T_b59a8_row6_col9, #T_b59a8_row6_col12, #T_b59a8_row6_col15, #T_b59a8_row6_col18, #T_b59a8_row7_col0, #T_b59a8_row7_col3, #T_b59a8_row7_col6, #T_b59a8_row7_col9, #T_b59a8_row7_col12, #T_b59a8_row7_col15, #T_b59a8_row7_col18, #T_b59a8_row8_col0, #T_b59a8_row8_col3, #T_b59a8_row8_col6, #T_b59a8_row8_col9, #T_b59a8_row8_col12, #T_b59a8_row8_col15, #T_b59a8_row8_col18, #T_b59a8_row9_col0, #T_b59a8_row9_col3, #T_b59a8_row9_col6, #T_b59a8_row9_col9, #T_b59a8_row9_col12, #T_b59a8_row9_col15, #T_b59a8_row9_col18, #T_b59a8_row10_col0, #T_b59a8_row10_col3, #T_b59a8_row10_col6, #T_b59a8_row10_col9, #T_b59a8_row10_col12, #T_b59a8_row10_col15, #T_b59a8_row10_col18, #T_b59a8_row11_col0, #T_b59a8_row11_col3, #T_b59a8_row11_col6, #T_b59a8_row11_col9, #T_b59a8_row11_col12, #T_b59a8_row11_col15, #T_b59a8_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_b59a8">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_b59a8_level0_col0" class="col_heading level0 col0" colspan="3">SPEI-1</th>
      <th id="T_b59a8_level0_col3" class="col_heading level0 col3" colspan="3">SPEI-3</th>
      <th id="T_b59a8_level0_col6" class="col_heading level0 col6" colspan="3">SPEI-6</th>
      <th id="T_b59a8_level0_col9" class="col_heading level0 col9" colspan="3">SPEI-12</th>
      <th id="T_b59a8_level0_col12" class="col_heading level0 col12" colspan="3">SPEI-24</th>
      <th id="T_b59a8_level0_col15" class="col_heading level0 col15" colspan="3">SPEI-36</th>
      <th id="T_b59a8_level0_col18" class="col_heading level0 col18" colspan="3">SPEI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_b59a8_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_b59a8_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_b59a8_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_b59a8_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_b59a8_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_b59a8_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_b59a8_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_b59a8_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_b59a8_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_b59a8_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_b59a8_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_b59a8_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_b59a8_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_b59a8_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_b59a8_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_b59a8_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_b59a8_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_b59a8_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_b59a8_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_b59a8_row0_col2" class="data row0 col2" >0.0000</td>
      <td id="T_b59a8_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_b59a8_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_b59a8_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_b59a8_row0_col6" class="data row0 col6" >-0.0000</td>
      <td id="T_b59a8_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_b59a8_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_b59a8_row0_col9" class="data row0 col9" >-0.0000</td>
      <td id="T_b59a8_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_b59a8_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_b59a8_row0_col12" class="data row0 col12" >-0.0000</td>
      <td id="T_b59a8_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_b59a8_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_b59a8_row0_col15" class="data row0 col15" >0.0000</td>
      <td id="T_b59a8_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_b59a8_row0_col17" class="data row0 col17" >0.0000</td>
      <td id="T_b59a8_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_b59a8_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_b59a8_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_b59a8_row1_col0" class="data row1 col0" >0.0135</td>
      <td id="T_b59a8_row1_col1" class="data row1 col1" >0.0162</td>
      <td id="T_b59a8_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_b59a8_row1_col3" class="data row1 col3" >0.0068</td>
      <td id="T_b59a8_row1_col4" class="data row1 col4" >0.0106</td>
      <td id="T_b59a8_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_b59a8_row1_col6" class="data row1 col6" >-0.0003</td>
      <td id="T_b59a8_row1_col7" class="data row1 col7" >0.0240</td>
      <td id="T_b59a8_row1_col8" class="data row1 col8" >0.0000</td>
      <td id="T_b59a8_row1_col9" class="data row1 col9" >0.0065</td>
      <td id="T_b59a8_row1_col10" class="data row1 col10" >0.0133</td>
      <td id="T_b59a8_row1_col11" class="data row1 col11" >1.1765</td>
      <td id="T_b59a8_row1_col12" class="data row1 col12" >-0.0429</td>
      <td id="T_b59a8_row1_col13" class="data row1 col13" >0.0439</td>
      <td id="T_b59a8_row1_col14" class="data row1 col14" >3.5294</td>
      <td id="T_b59a8_row1_col15" class="data row1 col15" >-0.0131</td>
      <td id="T_b59a8_row1_col16" class="data row1 col16" >0.0315</td>
      <td id="T_b59a8_row1_col17" class="data row1 col17" >0.0000</td>
      <td id="T_b59a8_row1_col18" class="data row1 col18" >0.0180</td>
      <td id="T_b59a8_row1_col19" class="data row1 col19" >0.0349</td>
      <td id="T_b59a8_row1_col20" class="data row1 col20" >11.7647</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_b59a8_row2_col0" class="data row2 col0" >0.0041</td>
      <td id="T_b59a8_row2_col1" class="data row2 col1" >0.0203</td>
      <td id="T_b59a8_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_b59a8_row2_col3" class="data row2 col3" >0.0223</td>
      <td id="T_b59a8_row2_col4" class="data row2 col4" >0.0319</td>
      <td id="T_b59a8_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_b59a8_row2_col6" class="data row2 col6" >0.0021</td>
      <td id="T_b59a8_row2_col7" class="data row2 col7" >0.0175</td>
      <td id="T_b59a8_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_b59a8_row2_col9" class="data row2 col9" >0.0070</td>
      <td id="T_b59a8_row2_col10" class="data row2 col10" >0.0287</td>
      <td id="T_b59a8_row2_col11" class="data row2 col11" >4.7059</td>
      <td id="T_b59a8_row2_col12" class="data row2 col12" >-0.0489</td>
      <td id="T_b59a8_row2_col13" class="data row2 col13" >0.0497</td>
      <td id="T_b59a8_row2_col14" class="data row2 col14" >3.5294</td>
      <td id="T_b59a8_row2_col15" class="data row2 col15" >-0.0083</td>
      <td id="T_b59a8_row2_col16" class="data row2 col16" >0.0356</td>
      <td id="T_b59a8_row2_col17" class="data row2 col17" >2.3529</td>
      <td id="T_b59a8_row2_col18" class="data row2 col18" >0.0120</td>
      <td id="T_b59a8_row2_col19" class="data row2 col19" >0.0334</td>
      <td id="T_b59a8_row2_col20" class="data row2 col20" >3.5294</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_b59a8_row3_col0" class="data row3 col0" >-0.0153</td>
      <td id="T_b59a8_row3_col1" class="data row3 col1" >0.0153</td>
      <td id="T_b59a8_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_b59a8_row3_col3" class="data row3 col3" >0.0042</td>
      <td id="T_b59a8_row3_col4" class="data row3 col4" >0.0226</td>
      <td id="T_b59a8_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_b59a8_row3_col6" class="data row3 col6" >-0.0026</td>
      <td id="T_b59a8_row3_col7" class="data row3 col7" >0.0252</td>
      <td id="T_b59a8_row3_col8" class="data row3 col8" >1.1765</td>
      <td id="T_b59a8_row3_col9" class="data row3 col9" >-0.0020</td>
      <td id="T_b59a8_row3_col10" class="data row3 col10" >0.0276</td>
      <td id="T_b59a8_row3_col11" class="data row3 col11" >3.5294</td>
      <td id="T_b59a8_row3_col12" class="data row3 col12" >-0.0102</td>
      <td id="T_b59a8_row3_col13" class="data row3 col13" >0.0326</td>
      <td id="T_b59a8_row3_col14" class="data row3 col14" >3.5294</td>
      <td id="T_b59a8_row3_col15" class="data row3 col15" >-0.0699</td>
      <td id="T_b59a8_row3_col16" class="data row3 col16" >0.0699</td>
      <td id="T_b59a8_row3_col17" class="data row3 col17" >18.8235</td>
      <td id="T_b59a8_row3_col18" class="data row3 col18" >0.0248</td>
      <td id="T_b59a8_row3_col19" class="data row3 col19" >0.0285</td>
      <td id="T_b59a8_row3_col20" class="data row3 col20" >11.7647</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_b59a8_row4_col0" class="data row4 col0" >-0.0380</td>
      <td id="T_b59a8_row4_col1" class="data row4 col1" >0.0380</td>
      <td id="T_b59a8_row4_col2" class="data row4 col2" >0.0000</td>
      <td id="T_b59a8_row4_col3" class="data row4 col3" >-0.0275</td>
      <td id="T_b59a8_row4_col4" class="data row4 col4" >0.0312</td>
      <td id="T_b59a8_row4_col5" class="data row4 col5" >2.3529</td>
      <td id="T_b59a8_row4_col6" class="data row4 col6" >-0.0248</td>
      <td id="T_b59a8_row4_col7" class="data row4 col7" >0.0255</td>
      <td id="T_b59a8_row4_col8" class="data row4 col8" >0.0000</td>
      <td id="T_b59a8_row4_col9" class="data row4 col9" >-0.0367</td>
      <td id="T_b59a8_row4_col10" class="data row4 col10" >0.0411</td>
      <td id="T_b59a8_row4_col11" class="data row4 col11" >2.3529</td>
      <td id="T_b59a8_row4_col12" class="data row4 col12" >0.0019</td>
      <td id="T_b59a8_row4_col13" class="data row4 col13" >0.0326</td>
      <td id="T_b59a8_row4_col14" class="data row4 col14" >5.8824</td>
      <td id="T_b59a8_row4_col15" class="data row4 col15" >-0.0558</td>
      <td id="T_b59a8_row4_col16" class="data row4 col16" >0.0558</td>
      <td id="T_b59a8_row4_col17" class="data row4 col17" >0.0000</td>
      <td id="T_b59a8_row4_col18" class="data row4 col18" >-0.0013</td>
      <td id="T_b59a8_row4_col19" class="data row4 col19" >0.0102</td>
      <td id="T_b59a8_row4_col20" class="data row4 col20" >4.7059</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_b59a8_row5_col0" class="data row5 col0" >-0.0249</td>
      <td id="T_b59a8_row5_col1" class="data row5 col1" >0.0280</td>
      <td id="T_b59a8_row5_col2" class="data row5 col2" >0.0000</td>
      <td id="T_b59a8_row5_col3" class="data row5 col3" >-0.0396</td>
      <td id="T_b59a8_row5_col4" class="data row5 col4" >0.0396</td>
      <td id="T_b59a8_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_b59a8_row5_col6" class="data row5 col6" >-0.0255</td>
      <td id="T_b59a8_row5_col7" class="data row5 col7" >0.0264</td>
      <td id="T_b59a8_row5_col8" class="data row5 col8" >0.0000</td>
      <td id="T_b59a8_row5_col9" class="data row5 col9" >-0.0250</td>
      <td id="T_b59a8_row5_col10" class="data row5 col10" >0.0250</td>
      <td id="T_b59a8_row5_col11" class="data row5 col11" >0.0000</td>
      <td id="T_b59a8_row5_col12" class="data row5 col12" >0.0137</td>
      <td id="T_b59a8_row5_col13" class="data row5 col13" >0.0248</td>
      <td id="T_b59a8_row5_col14" class="data row5 col14" >2.3529</td>
      <td id="T_b59a8_row5_col15" class="data row5 col15" >-0.1022</td>
      <td id="T_b59a8_row5_col16" class="data row5 col16" >0.1022</td>
      <td id="T_b59a8_row5_col17" class="data row5 col17" >49.4118</td>
      <td id="T_b59a8_row5_col18" class="data row5 col18" >0.0085</td>
      <td id="T_b59a8_row5_col19" class="data row5 col19" >0.0316</td>
      <td id="T_b59a8_row5_col20" class="data row5 col20" >20.0000</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_b59a8_row6_col0" class="data row6 col0" >-0.0334</td>
      <td id="T_b59a8_row6_col1" class="data row6 col1" >0.0354</td>
      <td id="T_b59a8_row6_col2" class="data row6 col2" >2.3529</td>
      <td id="T_b59a8_row6_col3" class="data row6 col3" >-0.0472</td>
      <td id="T_b59a8_row6_col4" class="data row6 col4" >0.0487</td>
      <td id="T_b59a8_row6_col5" class="data row6 col5" >2.3529</td>
      <td id="T_b59a8_row6_col6" class="data row6 col6" >-0.0346</td>
      <td id="T_b59a8_row6_col7" class="data row6 col7" >0.0355</td>
      <td id="T_b59a8_row6_col8" class="data row6 col8" >0.0000</td>
      <td id="T_b59a8_row6_col9" class="data row6 col9" >-0.0278</td>
      <td id="T_b59a8_row6_col10" class="data row6 col10" >0.0278</td>
      <td id="T_b59a8_row6_col11" class="data row6 col11" >0.0000</td>
      <td id="T_b59a8_row6_col12" class="data row6 col12" >-0.0094</td>
      <td id="T_b59a8_row6_col13" class="data row6 col13" >0.0547</td>
      <td id="T_b59a8_row6_col14" class="data row6 col14" >23.5294</td>
      <td id="T_b59a8_row6_col15" class="data row6 col15" >-0.1233</td>
      <td id="T_b59a8_row6_col16" class="data row6 col16" >0.1233</td>
      <td id="T_b59a8_row6_col17" class="data row6 col17" >49.4118</td>
      <td id="T_b59a8_row6_col18" class="data row6 col18" >0.0181</td>
      <td id="T_b59a8_row6_col19" class="data row6 col19" >0.0462</td>
      <td id="T_b59a8_row6_col20" class="data row6 col20" >23.5294</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_b59a8_row7_col0" class="data row7 col0" >-0.0228</td>
      <td id="T_b59a8_row7_col1" class="data row7 col1" >0.0288</td>
      <td id="T_b59a8_row7_col2" class="data row7 col2" >1.1765</td>
      <td id="T_b59a8_row7_col3" class="data row7 col3" >-0.0343</td>
      <td id="T_b59a8_row7_col4" class="data row7 col4" >0.0931</td>
      <td id="T_b59a8_row7_col5" class="data row7 col5" >48.2353</td>
      <td id="T_b59a8_row7_col6" class="data row7 col6" >-0.0384</td>
      <td id="T_b59a8_row7_col7" class="data row7 col7" >0.0387</td>
      <td id="T_b59a8_row7_col8" class="data row7 col8" >4.7059</td>
      <td id="T_b59a8_row7_col9" class="data row7 col9" >-0.0465</td>
      <td id="T_b59a8_row7_col10" class="data row7 col10" >0.0466</td>
      <td id="T_b59a8_row7_col11" class="data row7 col11" >1.1765</td>
      <td id="T_b59a8_row7_col12" class="data row7 col12" >-0.0015</td>
      <td id="T_b59a8_row7_col13" class="data row7 col13" >0.0403</td>
      <td id="T_b59a8_row7_col14" class="data row7 col14" >15.2941</td>
      <td id="T_b59a8_row7_col15" class="data row7 col15" >-0.1525</td>
      <td id="T_b59a8_row7_col16" class="data row7 col16" >0.1525</td>
      <td id="T_b59a8_row7_col17" class="data row7 col17" >57.6471</td>
      <td id="T_b59a8_row7_col18" class="data row7 col18" >0.0065</td>
      <td id="T_b59a8_row7_col19" class="data row7 col19" >0.0563</td>
      <td id="T_b59a8_row7_col20" class="data row7 col20" >21.1765</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_b59a8_row8_col0" class="data row8 col0" >-0.0050</td>
      <td id="T_b59a8_row8_col1" class="data row8 col1" >0.0238</td>
      <td id="T_b59a8_row8_col2" class="data row8 col2" >0.0000</td>
      <td id="T_b59a8_row8_col3" class="data row8 col3" >-0.0275</td>
      <td id="T_b59a8_row8_col4" class="data row8 col4" >0.0318</td>
      <td id="T_b59a8_row8_col5" class="data row8 col5" >0.0000</td>
      <td id="T_b59a8_row8_col6" class="data row8 col6" >-0.0498</td>
      <td id="T_b59a8_row8_col7" class="data row8 col7" >0.0498</td>
      <td id="T_b59a8_row8_col8" class="data row8 col8" >0.0000</td>
      <td id="T_b59a8_row8_col9" class="data row8 col9" >-0.0347</td>
      <td id="T_b59a8_row8_col10" class="data row8 col10" >0.0369</td>
      <td id="T_b59a8_row8_col11" class="data row8 col11" >3.5294</td>
      <td id="T_b59a8_row8_col12" class="data row8 col12" >0.0044</td>
      <td id="T_b59a8_row8_col13" class="data row8 col13" >0.0358</td>
      <td id="T_b59a8_row8_col14" class="data row8 col14" >16.4706</td>
      <td id="T_b59a8_row8_col15" class="data row8 col15" >-0.1424</td>
      <td id="T_b59a8_row8_col16" class="data row8 col16" >0.1424</td>
      <td id="T_b59a8_row8_col17" class="data row8 col17" >52.9412</td>
      <td id="T_b59a8_row8_col18" class="data row8 col18" >-0.0326</td>
      <td id="T_b59a8_row8_col19" class="data row8 col19" >0.0381</td>
      <td id="T_b59a8_row8_col20" class="data row8 col20" >1.1765</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_b59a8_row9_col0" class="data row9 col0" >0.0112</td>
      <td id="T_b59a8_row9_col1" class="data row9 col1" >0.0161</td>
      <td id="T_b59a8_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_b59a8_row9_col3" class="data row9 col3" >0.0019</td>
      <td id="T_b59a8_row9_col4" class="data row9 col4" >0.0426</td>
      <td id="T_b59a8_row9_col5" class="data row9 col5" >1.1765</td>
      <td id="T_b59a8_row9_col6" class="data row9 col6" >-0.0469</td>
      <td id="T_b59a8_row9_col7" class="data row9 col7" >0.0477</td>
      <td id="T_b59a8_row9_col8" class="data row9 col8" >0.0000</td>
      <td id="T_b59a8_row9_col9" class="data row9 col9" >-0.0347</td>
      <td id="T_b59a8_row9_col10" class="data row9 col10" >0.0348</td>
      <td id="T_b59a8_row9_col11" class="data row9 col11" >0.0000</td>
      <td id="T_b59a8_row9_col12" class="data row9 col12" >-0.0006</td>
      <td id="T_b59a8_row9_col13" class="data row9 col13" >0.0491</td>
      <td id="T_b59a8_row9_col14" class="data row9 col14" >21.1765</td>
      <td id="T_b59a8_row9_col15" class="data row9 col15" >-0.1220</td>
      <td id="T_b59a8_row9_col16" class="data row9 col16" >0.1220</td>
      <td id="T_b59a8_row9_col17" class="data row9 col17" >50.5882</td>
      <td id="T_b59a8_row9_col18" class="data row9 col18" >-0.0296</td>
      <td id="T_b59a8_row9_col19" class="data row9 col19" >0.0349</td>
      <td id="T_b59a8_row9_col20" class="data row9 col20" >1.1765</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_b59a8_row10_col0" class="data row10 col0" >0.0190</td>
      <td id="T_b59a8_row10_col1" class="data row10 col1" >0.0198</td>
      <td id="T_b59a8_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_b59a8_row10_col3" class="data row10 col3" >0.0080</td>
      <td id="T_b59a8_row10_col4" class="data row10 col4" >0.0228</td>
      <td id="T_b59a8_row10_col5" class="data row10 col5" >0.0000</td>
      <td id="T_b59a8_row10_col6" class="data row10 col6" >-0.0115</td>
      <td id="T_b59a8_row10_col7" class="data row10 col7" >0.0460</td>
      <td id="T_b59a8_row10_col8" class="data row10 col8" >4.7059</td>
      <td id="T_b59a8_row10_col9" class="data row10 col9" >-0.0255</td>
      <td id="T_b59a8_row10_col10" class="data row10 col10" >0.0264</td>
      <td id="T_b59a8_row10_col11" class="data row10 col11" >1.1765</td>
      <td id="T_b59a8_row10_col12" class="data row10 col12" >0.0065</td>
      <td id="T_b59a8_row10_col13" class="data row10 col13" >0.0362</td>
      <td id="T_b59a8_row10_col14" class="data row10 col14" >11.7647</td>
      <td id="T_b59a8_row10_col15" class="data row10 col15" >-0.1140</td>
      <td id="T_b59a8_row10_col16" class="data row10 col16" >0.1140</td>
      <td id="T_b59a8_row10_col17" class="data row10 col17" >52.9412</td>
      <td id="T_b59a8_row10_col18" class="data row10 col18" >-0.0238</td>
      <td id="T_b59a8_row10_col19" class="data row10 col19" >0.0396</td>
      <td id="T_b59a8_row10_col20" class="data row10 col20" >2.3529</td>
    </tr>
    <tr>
      <th id="T_b59a8_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_b59a8_row11_col0" class="data row11 col0" >0.0118</td>
      <td id="T_b59a8_row11_col1" class="data row11 col1" >0.0159</td>
      <td id="T_b59a8_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_b59a8_row11_col3" class="data row11 col3" >0.0307</td>
      <td id="T_b59a8_row11_col4" class="data row11 col4" >0.0307</td>
      <td id="T_b59a8_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_b59a8_row11_col6" class="data row11 col6" >-0.0107</td>
      <td id="T_b59a8_row11_col7" class="data row11 col7" >0.0475</td>
      <td id="T_b59a8_row11_col8" class="data row11 col8" >14.1176</td>
      <td id="T_b59a8_row11_col9" class="data row11 col9" >-0.0217</td>
      <td id="T_b59a8_row11_col10" class="data row11 col10" >0.0236</td>
      <td id="T_b59a8_row11_col11" class="data row11 col11" >4.7059</td>
      <td id="T_b59a8_row11_col12" class="data row11 col12" >0.0074</td>
      <td id="T_b59a8_row11_col13" class="data row11 col13" >0.0444</td>
      <td id="T_b59a8_row11_col14" class="data row11 col14" >21.1765</td>
      <td id="T_b59a8_row11_col15" class="data row11 col15" >-0.1287</td>
      <td id="T_b59a8_row11_col16" class="data row11 col16" >0.1287</td>
      <td id="T_b59a8_row11_col17" class="data row11 col17" >55.2941</td>
      <td id="T_b59a8_row11_col18" class="data row11 col18" >-0.0314</td>
      <td id="T_b59a8_row11_col19" class="data row11 col19" >0.0363</td>
      <td id="T_b59a8_row11_col20" class="data row11 col20" >2.3529</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>At first glance, agreement in SPEI is considerably worse than in SPI.
This shows in non-zero median and median absolute differences for most calendar month‚Äìaccumulation period pairs,
as well as larger percentages of match-ups that exceed the threshold of 0.10 difference.
These patterns are visible in the time series comparison
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries"><span class="std std-numref">6.1.11</span></a>)
in the form of noticeable scatter about the 0-line,
in addition to a few spikes like those seen in
Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries"><span class="std std-numref">6.1.2</span></a>.</p>
<p>However,
agreement is still good in general,
and the discrepancies seen above rarely lead to differences in classification
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion"><span class="std std-numref">6.1.12</span></a>).
This is particularly important for SPEI-36,
where differences in 1950‚Äì1970 are large but do not change the resulting classification.</p>
<p>The most likely cause for the increased difference is the choice of statistical distribution.
As noted above,
it is not entirely clear which distribution underpins ERA5‚ÄìDrought‚Äôs SPEI values,
and the
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.genlogistic.html" rel="noreferrer" target="_blank">scipy.stats.genlogistic</a>
implementation used in this notebook may not be the same one.
For example,
<a class="reference external" href="https://en.wikipedia.org/wiki/Generalized_logistic_distribution" rel="noreferrer" target="_blank">Wikipedia</a>
lists four different <em>generalised logistic</em> distributions.
If the distribution used in ERA5‚ÄìDrought is not equal to, but similar to, the implementation used in this notebook,
that may well result in consistent, small differences in the exact values but good agreement overall
‚Äì as seen in this analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot time series comparison (absolute values and differences)</span>
<span class="n">plot_time_series_comparison_spei</span><span class="p">(</span><span class="n">spei_era5drought_site</span><span class="p">,</span> <span class="n">spei_reproduced_site</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                 <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-timeseries&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot confusion matrix comparison</span>
<span class="c1"># e.g. are all &quot;extremely dry&quot; data in ERA5‚ÄìDrought also &quot;extremely dry&quot; in the reproduction?</span>
<span class="n">plot_confusion_matrices_spei</span><span class="p">(</span><span class="n">spei_era5drought_site</span><span class="p">,</span> <span class="n">spei_reproduced_site</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                             <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-confusion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-8">
Time series</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries">
<img alt="../_images/ffa28e0a9bd763cce6b29752788b33051d7b85450cc5d3322a92d6239bb62204.png" src="../_images/ffa28e0a9bd763cce6b29752788b33051d7b85450cc5d3322a92d6239bb62204.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.11 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-9" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="confusion" for="sd-tab-item-9">
Confusion matrix</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion">
<img alt="../_images/a83d22fb7ae4880572d5bcdbd67d01732503a3e11f3e00cef75bb2d99a261ed8.png" src="../_images/a83d22fb7ae4880572d5bcdbd67d01732503a3e11f3e00cef75bb2d99a261ed8.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.12 </span><span class="caption-text">Confusion matrices for SPEI categories from ERA5‚ÄìDrought vs. reproduced from ERA5, for the example site of Addis Ababa, Ethiopia, in 1940‚Äì2024.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="spei-comparison-regional-snapshot">
<h4>4.5 SPEI comparison: Regional snapshot<a class="headerlink" href="#spei-comparison-regional-snapshot" title="Link to this heading">#</a></h4>
<p>Next, we investigate spatial patterns in SPEI and the difference therein across a wider region around the example site.
This region is defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.
In this example, we look at part of the Horn of Africa using a box of 12¬∞ in all directions around Addis Ababa, Ethiopia.
To reduce computing requirements, the comparison is performed for one year only,
here 2024, again defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-general-setup"><span class="std std-ref">2. General setup</span></a>.</p>
<p>As in the time series comparison,
we subselect the desired data from ERA5 and calculate the corresponding SPEI
and
download SPEI from ERA5‚ÄìDrought for the desired region and time span:</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_waterbalance_region</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_region</span><span class="p">)</span>

<span class="c1"># Window in which to evaluate SPI</span>
<span class="n">evaluation_window</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">)}</span>  <span class="c1">#  Slice (2024-01-01, 2024-12-01)</span>

<span class="c1"># Calculate SPI</span>
<span class="n">spei_reproduced_region</span> <span class="o">=</span> <span class="n">calculate_spei_from_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_region</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">,</span>
                                                  <span class="n">evaluation_window</span><span class="o">=</span><span class="n">evaluation_window</span><span class="p">)</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spei_reproduced_region</span> <span class="o">=</span> <span class="n">spei_reproduced_region</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spei_reproduced_region</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 6MB
Dimensions:  (time: 12, lat: 97, lon: 97)
Coordinates:
    number   int64 8B 0
  * time     (time) datetime64[ns] 96B 2024-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
    expver   (time) &lt;U4 192B dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
    month    (time) int64 96B dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;
Data variables:
    SPEI1    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI3    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI6    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI12   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI24   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI36   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;
    SPEI48   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-90de86d9-712f-4b83-81aa-64d4abb060ef' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-90de86d9-712f-4b83-81aa-64d4abb060ef' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 12</li><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9832207e-1f15-4e88-b935-ffc7a173eedf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9832207e-1f15-4e88-b935-ffc7a173eedf' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-dcf87e88-f4ea-424d-b6d7-2643bdc8eadc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dcf87e88-f4ea-424d-b6d7-2643bdc8eadc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-56aa8678-5fab-4717-9262-04e7dd30152c' class='xr-var-data-in' type='checkbox'><label for='data-56aa8678-5fab-4717-9262-04e7dd30152c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-370f5d50-50d2-4bc5-bcf8-aaa761219409' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-370f5d50-50d2-4bc5-bcf8-aaa761219409' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b4e46a2a-3959-4963-a476-fbc58373290c' class='xr-var-data-in' type='checkbox'><label for='data-b4e46a2a-3959-4963-a476-fbc58373290c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-01-01T06:00:00.000000000&#x27;, &#x27;2024-02-01T06:00:00.000000000&#x27;,
       &#x27;2024-03-01T06:00:00.000000000&#x27;, &#x27;2024-04-01T06:00:00.000000000&#x27;,
       &#x27;2024-05-01T06:00:00.000000000&#x27;, &#x27;2024-06-01T06:00:00.000000000&#x27;,
       &#x27;2024-07-01T06:00:00.000000000&#x27;, &#x27;2024-08-01T06:00:00.000000000&#x27;,
       &#x27;2024-09-01T06:00:00.000000000&#x27;, &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-5d56b39b-845d-4ee5-8156-17fa70c4b227' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d56b39b-845d-4ee5-8156-17fa70c4b227' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f99ceb3-f238-453c-b228-bd5a6b6a9012' class='xr-var-data-in' type='checkbox'><label for='data-4f99ceb3-f238-453c-b228-bd5a6b6a9012' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;</div><input id='attrs-b2c8391e-2347-48cd-93ba-d93ae486f35b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b2c8391e-2347-48cd-93ba-d93ae486f35b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3260432c-82e9-4f2d-8610-fa3b47066eb7' class='xr-var-data-in' type='checkbox'><label for='data-3260432c-82e9-4f2d-8610-fa3b47066eb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 192 B </td>
                        <td> 192 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12,) </td>
                        <td> (12,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.56358655585696 0.0,37.56358655585696" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.563587" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.000000" y="18.781793" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.781793)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-4b01dce7-1ce5-48c3-a7f3-454b2af0bd54' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4b01dce7-1ce5-48c3-a7f3-454b2af0bd54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a6dfdd2-709e-48d4-93cf-81c718d128ae' class='xr-var-data-in' type='checkbox'><label for='data-3a6dfdd2-709e-48d4-93cf-81c718d128ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12,), meta=np.ndarray&gt;</div><input id='attrs-64c8774a-ec87-4f7c-a171-a0a6410451b0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64c8774a-ec87-4f7c-a171-a0a6410451b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b2358bf-b2d5-4346-93eb-afa0634ffcec' class='xr-var-data-in' type='checkbox'><label for='data-8b2358bf-b2d5-4346-93eb-afa0634ffcec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 96 B </td>
                        <td> 96 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12,) </td>
                        <td> (12,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="87" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="37" x2="120" y2="37" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="37" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="37" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,37.56358655585696 0.0,37.56358655585696" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="57.563587" font-size="1.0rem" font-weight="100" text-anchor="middle" >12</text>
  <text x="140.000000" y="18.781793" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.781793)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f3f4b86-5e34-4c55-a02b-fb4506bc06af' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1f3f4b86-5e34-4c55-a02b-fb4506bc06af' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-f699ce6c-8bd0-4839-a19f-700949880a44' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f699ce6c-8bd0-4839-a19f-700949880a44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f637412a-2954-4ae4-a606-dad8f1d978ff' class='xr-var-data-in' type='checkbox'><label for='data-f637412a-2954-4ae4-a606-dad8f1d978ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-cf582f57-bdcb-4365-8b53-8db504cfbf37' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf582f57-bdcb-4365-8b53-8db504cfbf37' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac8bfc99-efc8-4605-91ac-ae0102529222' class='xr-var-data-in' type='checkbox'><label for='data-ac8bfc99-efc8-4605-91ac-ae0102529222' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-ea73a273-e98a-4cf0-8c05-e0380698d9e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ea73a273-e98a-4cf0-8c05-e0380698d9e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e37be51-f9ac-45d3-b079-93dc06aa3748' class='xr-var-data-in' type='checkbox'><label for='data-5e37be51-f9ac-45d3-b079-93dc06aa3748' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-1137d768-1701-4e72-8a3b-0c6383b644a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1137d768-1701-4e72-8a3b-0c6383b644a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff76bd81-1020-42b2-b5fe-b2aae8d36314' class='xr-var-data-in' type='checkbox'><label for='data-ff76bd81-1020-42b2-b5fe-b2aae8d36314' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-d176541c-fa0d-4ea0-8826-c96b7b37258e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d176541c-fa0d-4ea0-8826-c96b7b37258e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3624e9a-b85a-45a1-93d0-2e134a5e16ab' class='xr-var-data-in' type='checkbox'><label for='data-b3624e9a-b85a-45a1-93d0-2e134a5e16ab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-bef993bf-06f1-4bb6-9b18-5f028f1314d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bef993bf-06f1-4bb6-9b18-5f028f1314d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52d67974-5610-47c9-877d-bd784f597659' class='xr-var-data-in' type='checkbox'><label for='data-52d67974-5610-47c9-877d-bd784f597659' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-408929c6-82df-4598-aaeb-f2ae325bafde' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-408929c6-82df-4598-aaeb-f2ae325bafde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f3772eb-78a2-4c71-b0c6-f3d6e44acf73' class='xr-var-data-in' type='checkbox'><label for='data-5f3772eb-78a2-4c71-b0c6-f3d6e44acf73' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 582.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 2 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-82f8a658-2d40-493f-b53a-ebe6857390ac' class='xr-section-summary-in' type='checkbox'  ><label for='section-82f8a658-2d40-493f-b53a-ebe6857390ac' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7fcf0c43-42aa-4a10-b490-52d5dc6df80a' class='xr-index-data-in' type='checkbox'/><label for='index-7fcf0c43-42aa-4a10-b490-52d5dc6df80a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-01-01 06:00:00&#x27;, &#x27;2024-02-01 06:00:00&#x27;,
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4bc52f19-76a0-40f0-a738-49bd653a8501' class='xr-index-data-in' type='checkbox'/><label for='index-4bc52f19-76a0-40f0-a738-49bd653a8501' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d32137b5-2aed-4055-98d9-3358a990b8c4' class='xr-index-data-in' type='checkbox'/><label for='index-d32137b5-2aed-4055-98d9-3358a990b8c4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5eee5f36-f700-4bf9-afc2-06a6798d60a9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5eee5f36-f700-4bf9-afc2-06a6798d60a9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main request, based on template and example region</span>
<span class="n">request_era5drought_spei</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_evapotranspiration_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index</span> <span class="o">|</span> <span class="n">request_region</span>

<span class="c1"># Select only desired year</span>
<span class="n">request_era5drought_spei</span> <span class="o">=</span> <span class="n">request_era5drought_spei</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],}</span>

<span class="c1"># Download data and load into xarray</span>
<span class="n">spei_era5drought_region</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="n">request_era5drought_spei</span><span class="p">)</span>
<span class="n">spei_era5drought_region</span> <span class="o">=</span> <span class="n">spei_era5drought_region</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">spei_era5drought_region</span> <span class="o">=</span> <span class="n">spei_era5drought_region</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>  <span class="c1"># Full time series in one chunk</span>

<span class="c1"># Persist in memory to speed up analysis ‚Äì this step may take a few minutes</span>
<span class="n">spei_era5drought_region</span> <span class="o">=</span> <span class="n">spei_era5drought_region</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Display result</span>
<span class="n">spei_era5drought_region</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 6MB
Dimensions:  (time: 12, lat: 97, lon: 97)
Coordinates:
  * time     (time) datetime64[ns] 96B 2024-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
Data variables:
    SPEI12   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI1    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI24   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI36   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI3    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI48   (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
    SPEI6    (time, lat, lon) float64 903kB dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;
Attributes: (12/17)
    title:                   SPEI12
    description:             Drought Index: Standardized Drought Index calcul...
    Conventions:             CF-1.8
    history:                 Created 30/10/2024 07:49:35 using DRYFALL.
    institution:             European Centre for Medium-Range Weather Forecasts
    source:                  DRYFALL v1.0
    ...                      ...
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    ref_publication:         Keune, J., Di Giuseppe, F., Barnard, C., Damasio...
    cds_data_catalogue_url:  https://cds.climate.copernicus.eu/datasets/deriv...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-702b99cc-13cd-483c-bc43-7311ea2fb908' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-702b99cc-13cd-483c-bc43-7311ea2fb908' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 12</li><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b354f18c-75ed-4dba-91ee-a03fa9336bce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b354f18c-75ed-4dba-91ee-a03fa9336bce' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2024-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-a42920b8-824b-4ef4-9a9b-8428e987f7ab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a42920b8-824b-4ef4-9a9b-8428e987f7ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d725a9af-45d2-427b-840f-0831ea1b4f6a' class='xr-var-data-in' type='checkbox'><label for='data-d725a9af-45d2-427b-840f-0831ea1b4f6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2024-01-01T06:00:00.000000000&#x27;, &#x27;2024-02-01T06:00:00.000000000&#x27;,
       &#x27;2024-03-01T06:00:00.000000000&#x27;, &#x27;2024-04-01T06:00:00.000000000&#x27;,
       &#x27;2024-05-01T06:00:00.000000000&#x27;, &#x27;2024-06-01T06:00:00.000000000&#x27;,
       &#x27;2024-07-01T06:00:00.000000000&#x27;, &#x27;2024-08-01T06:00:00.000000000&#x27;,
       &#x27;2024-09-01T06:00:00.000000000&#x27;, &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-3d77292c-555b-4c2d-a6e2-0adb32d7e444' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3d77292c-555b-4c2d-a6e2-0adb32d7e444' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd8c5a64-1068-40d5-b289-f6be6c9d4889' class='xr-var-data-in' type='checkbox'><label for='data-fd8c5a64-1068-40d5-b289-f6be6c9d4889' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-2425e1ac-71f9-4dec-bc70-24be4c0c0bcf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2425e1ac-71f9-4dec-bc70-24be4c0c0bcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea0b35a7-b6cb-4f3d-be82-aa542c59f05c' class='xr-var-data-in' type='checkbox'><label for='data-ea0b35a7-b6cb-4f3d-be82-aa542c59f05c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ee687458-e94c-4200-877a-f96aed219014' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ee687458-e94c-4200-877a-f96aed219014' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-18769112-8358-408a-bc8d-f87f29801aef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18769112-8358-408a-bc8d-f87f29801aef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7c098ce-240e-4281-ad98-cb041537fc1a' class='xr-var-data-in' type='checkbox'><label for='data-b7c098ce-240e-4281-ad98-cb041537fc1a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI12)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-339d9982-a2d4-4dde-bf53-b148940b6f06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-339d9982-a2d4-4dde-bf53-b148940b6f06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e90950c7-b10a-4c34-9b49-c8705d03e495' class='xr-var-data-in' type='checkbox'><label for='data-e90950c7-b10a-4c34-9b49-c8705d03e495' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI1)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-adee401c-c4df-4796-8621-e6b77bb244e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-adee401c-c4df-4796-8621-e6b77bb244e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-750a6706-a169-4924-995e-997288e7a2f3' class='xr-var-data-in' type='checkbox'><label for='data-750a6706-a169-4924-995e-997288e7a2f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI24)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-ca3e7b61-b5e7-4e2b-8620-54411ab2e32c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ca3e7b61-b5e7-4e2b-8620-54411ab2e32c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00d47f4d-3208-4c94-acf2-d45fbf3baabd' class='xr-var-data-in' type='checkbox'><label for='data-00d47f4d-3208-4c94-acf2-d45fbf3baabd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI36)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-bdd4b328-2db4-4dd5-ae70-d1d8cb992919' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdd4b328-2db4-4dd5-ae70-d1d8cb992919' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e35a668-6b28-4c10-af9a-fe4557f862aa' class='xr-var-data-in' type='checkbox'><label for='data-9e35a668-6b28-4c10-af9a-fe4557f862aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI3)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-0eda481e-57be-4d22-9db2-3e1afb1a23ed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0eda481e-57be-4d22-9db2-3e1afb1a23ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-468e6328-7633-402b-ab03-c1d7f2fc0e12' class='xr-var-data-in' type='checkbox'><label for='data-468e6328-7633-402b-ab03-c1d7f2fc0e12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI48)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(12, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-ba8d3f86-c0ba-418e-9d1b-c080650f5c61' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ba8d3f86-c0ba-418e-9d1b-c080650f5c61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a2e1719-7455-4ba2-8f0a-690b67c586e5' class='xr-var-data-in' type='checkbox'><label for='data-7a2e1719-7455-4ba2-8f0a-690b67c586e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Standardized Drought Index (SPEI6)</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 882.09 kiB </td>
                        <td> 882.09 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (12, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f9d183d-c647-41ba-97cc-c6805207538e' class='xr-section-summary-in' type='checkbox'  ><label for='section-6f9d183d-c647-41ba-97cc-c6805207538e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-eb4fdcc6-da39-4c52-9944-496cd0518779' class='xr-index-data-in' type='checkbox'/><label for='index-eb4fdcc6-da39-4c52-9944-496cd0518779' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2024-01-01 06:00:00&#x27;, &#x27;2024-02-01 06:00:00&#x27;,
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f40addb9-6fd9-452b-83a2-2e15b2ef1d64' class='xr-index-data-in' type='checkbox'/><label for='index-f40addb9-6fd9-452b-83a2-2e15b2ef1d64' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3e2df000-357d-4d9f-bcee-57b0e20175e6' class='xr-index-data-in' type='checkbox'/><label for='index-3e2df000-357d-4d9f-bcee-57b0e20175e6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-10305fec-870f-4e31-994d-ce6f6d2cf010' class='xr-section-summary-in' type='checkbox'  ><label for='section-10305fec-870f-4e31-994d-ce6f6d2cf010' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>SPEI12</dd><dt><span>description :</span></dt><dd>Drought Index: Standardized Drought Index calculated according to the WMO guidelines (see https://library.wmo.int/doc_num.php?explnum_id=7768).</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>history :</span></dt><dd>Created 30/10/2024 07:49:35 using DRYFALL.</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., Di Giuseppe, F., Barnard, C., Damasio da Costa, E., and Wetterhall, F. (2025): ERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis, Scientific Data 12, 616. https://doi.org/10.1038/s41597-025-04896-y</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://cds.climate.copernicus.eu/datasets/derived-drought-historical-monthly</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>As before,
we examine the per-point difference in SPI between ERA5‚ÄìDrought and the reproduction for each calendar month and each accumulation period:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPEI median differences</span>
<span class="n">spei_difference_region</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spei_era5drought_region</span><span class="p">,</span> <span class="n">spei_reproduced_region</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spei_difference_region</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_56b5f th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_56b5f th.col_heading {
  border-bottom: 0;
}
#T_56b5f table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_56b5f th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_56b5f_row0_col0, #T_56b5f_row0_col3, #T_56b5f_row0_col6, #T_56b5f_row0_col9, #T_56b5f_row0_col12, #T_56b5f_row0_col15, #T_56b5f_row0_col18, #T_56b5f_row1_col0, #T_56b5f_row1_col3, #T_56b5f_row1_col6, #T_56b5f_row1_col9, #T_56b5f_row1_col12, #T_56b5f_row1_col15, #T_56b5f_row1_col18, #T_56b5f_row2_col0, #T_56b5f_row2_col3, #T_56b5f_row2_col6, #T_56b5f_row2_col9, #T_56b5f_row2_col12, #T_56b5f_row2_col15, #T_56b5f_row2_col18, #T_56b5f_row3_col0, #T_56b5f_row3_col3, #T_56b5f_row3_col6, #T_56b5f_row3_col9, #T_56b5f_row3_col12, #T_56b5f_row3_col15, #T_56b5f_row3_col18, #T_56b5f_row4_col0, #T_56b5f_row4_col3, #T_56b5f_row4_col6, #T_56b5f_row4_col9, #T_56b5f_row4_col12, #T_56b5f_row4_col15, #T_56b5f_row4_col18, #T_56b5f_row5_col0, #T_56b5f_row5_col3, #T_56b5f_row5_col6, #T_56b5f_row5_col9, #T_56b5f_row5_col12, #T_56b5f_row5_col15, #T_56b5f_row5_col18, #T_56b5f_row6_col0, #T_56b5f_row6_col3, #T_56b5f_row6_col6, #T_56b5f_row6_col9, #T_56b5f_row6_col12, #T_56b5f_row6_col15, #T_56b5f_row6_col18, #T_56b5f_row7_col0, #T_56b5f_row7_col3, #T_56b5f_row7_col6, #T_56b5f_row7_col9, #T_56b5f_row7_col12, #T_56b5f_row7_col15, #T_56b5f_row7_col18, #T_56b5f_row8_col0, #T_56b5f_row8_col3, #T_56b5f_row8_col6, #T_56b5f_row8_col9, #T_56b5f_row8_col12, #T_56b5f_row8_col15, #T_56b5f_row8_col18, #T_56b5f_row9_col0, #T_56b5f_row9_col3, #T_56b5f_row9_col6, #T_56b5f_row9_col9, #T_56b5f_row9_col12, #T_56b5f_row9_col15, #T_56b5f_row9_col18, #T_56b5f_row10_col0, #T_56b5f_row10_col3, #T_56b5f_row10_col6, #T_56b5f_row10_col9, #T_56b5f_row10_col12, #T_56b5f_row10_col15, #T_56b5f_row10_col18, #T_56b5f_row11_col0, #T_56b5f_row11_col3, #T_56b5f_row11_col6, #T_56b5f_row11_col9, #T_56b5f_row11_col12, #T_56b5f_row11_col15, #T_56b5f_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_56b5f">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_56b5f_level0_col0" class="col_heading level0 col0" colspan="3">SPEI-1</th>
      <th id="T_56b5f_level0_col3" class="col_heading level0 col3" colspan="3">SPEI-3</th>
      <th id="T_56b5f_level0_col6" class="col_heading level0 col6" colspan="3">SPEI-6</th>
      <th id="T_56b5f_level0_col9" class="col_heading level0 col9" colspan="3">SPEI-12</th>
      <th id="T_56b5f_level0_col12" class="col_heading level0 col12" colspan="3">SPEI-24</th>
      <th id="T_56b5f_level0_col15" class="col_heading level0 col15" colspan="3">SPEI-36</th>
      <th id="T_56b5f_level0_col18" class="col_heading level0 col18" colspan="3">SPEI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_56b5f_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_56b5f_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_56b5f_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_56b5f_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_56b5f_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_56b5f_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_56b5f_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_56b5f_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_56b5f_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_56b5f_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_56b5f_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_56b5f_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_56b5f_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_56b5f_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_56b5f_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_56b5f_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_56b5f_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_56b5f_row0_col0" class="data row0 col0" >-0.0000</td>
      <td id="T_56b5f_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_56b5f_row0_col2" class="data row0 col2" >0.7333</td>
      <td id="T_56b5f_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_56b5f_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_56b5f_row0_col5" class="data row0 col5" >1.4561</td>
      <td id="T_56b5f_row0_col6" class="data row0 col6" >0.0000</td>
      <td id="T_56b5f_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_56b5f_row0_col8" class="data row0 col8" >0.1807</td>
      <td id="T_56b5f_row0_col9" class="data row0 col9" >0.0000</td>
      <td id="T_56b5f_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_56b5f_row0_col11" class="data row0 col11" >0.1594</td>
      <td id="T_56b5f_row0_col12" class="data row0 col12" >0.0000</td>
      <td id="T_56b5f_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_56b5f_row0_col14" class="data row0 col14" >16.6118</td>
      <td id="T_56b5f_row0_col15" class="data row0 col15" >-0.0000</td>
      <td id="T_56b5f_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_56b5f_row0_col17" class="data row0 col17" >0.2232</td>
      <td id="T_56b5f_row0_col18" class="data row0 col18" >-0.0000</td>
      <td id="T_56b5f_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_56b5f_row0_col20" class="data row0 col20" >0.2763</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_56b5f_row1_col0" class="data row1 col0" >-0.0046</td>
      <td id="T_56b5f_row1_col1" class="data row1 col1" >0.0294</td>
      <td id="T_56b5f_row1_col2" class="data row1 col2" >5.7817</td>
      <td id="T_56b5f_row1_col3" class="data row1 col3" >-0.0261</td>
      <td id="T_56b5f_row1_col4" class="data row1 col4" >0.0290</td>
      <td id="T_56b5f_row1_col5" class="data row1 col5" >5.7604</td>
      <td id="T_56b5f_row1_col6" class="data row1 col6" >-0.0358</td>
      <td id="T_56b5f_row1_col7" class="data row1 col7" >0.0417</td>
      <td id="T_56b5f_row1_col8" class="data row1 col8" >11.6909</td>
      <td id="T_56b5f_row1_col9" class="data row1 col9" >-0.0258</td>
      <td id="T_56b5f_row1_col10" class="data row1 col10" >0.0358</td>
      <td id="T_56b5f_row1_col11" class="data row1 col11" >9.9692</td>
      <td id="T_56b5f_row1_col12" class="data row1 col12" >-0.0190</td>
      <td id="T_56b5f_row1_col13" class="data row1 col13" >0.0376</td>
      <td id="T_56b5f_row1_col14" class="data row1 col14" >24.7104</td>
      <td id="T_56b5f_row1_col15" class="data row1 col15" >-0.0202</td>
      <td id="T_56b5f_row1_col16" class="data row1 col16" >0.0318</td>
      <td id="T_56b5f_row1_col17" class="data row1 col17" >11.1383</td>
      <td id="T_56b5f_row1_col18" class="data row1 col18" >-0.0105</td>
      <td id="T_56b5f_row1_col19" class="data row1 col19" >0.0288</td>
      <td id="T_56b5f_row1_col20" class="data row1 col20" >9.7247</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_56b5f_row2_col0" class="data row2 col0" >-0.0094</td>
      <td id="T_56b5f_row2_col1" class="data row2 col1" >0.0283</td>
      <td id="T_56b5f_row2_col2" class="data row2 col2" >4.1981</td>
      <td id="T_56b5f_row2_col3" class="data row2 col3" >-0.0179</td>
      <td id="T_56b5f_row2_col4" class="data row2 col4" >0.0283</td>
      <td id="T_56b5f_row2_col5" class="data row2 col5" >5.6223</td>
      <td id="T_56b5f_row2_col6" class="data row2 col6" >-0.0342</td>
      <td id="T_56b5f_row2_col7" class="data row2 col7" >0.0408</td>
      <td id="T_56b5f_row2_col8" class="data row2 col8" >11.2658</td>
      <td id="T_56b5f_row2_col9" class="data row2 col9" >-0.0303</td>
      <td id="T_56b5f_row2_col10" class="data row2 col10" >0.0381</td>
      <td id="T_56b5f_row2_col11" class="data row2 col11" >10.1180</td>
      <td id="T_56b5f_row2_col12" class="data row2 col12" >-0.0185</td>
      <td id="T_56b5f_row2_col13" class="data row2 col13" >0.0381</td>
      <td id="T_56b5f_row2_col14" class="data row2 col14" >24.2109</td>
      <td id="T_56b5f_row2_col15" class="data row2 col15" >-0.0208</td>
      <td id="T_56b5f_row2_col16" class="data row2 col16" >0.0325</td>
      <td id="T_56b5f_row2_col17" class="data row2 col17" >10.8194</td>
      <td id="T_56b5f_row2_col18" class="data row2 col18" >-0.0169</td>
      <td id="T_56b5f_row2_col19" class="data row2 col19" >0.0290</td>
      <td id="T_56b5f_row2_col20" class="data row2 col20" >9.4059</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_56b5f_row3_col0" class="data row3 col0" >-0.0078</td>
      <td id="T_56b5f_row3_col1" class="data row3 col1" >0.0322</td>
      <td id="T_56b5f_row3_col2" class="data row3 col2" >9.3315</td>
      <td id="T_56b5f_row3_col3" class="data row3 col3" >-0.0178</td>
      <td id="T_56b5f_row3_col4" class="data row3 col4" >0.0393</td>
      <td id="T_56b5f_row3_col5" class="data row3 col5" >14.4224</td>
      <td id="T_56b5f_row3_col6" class="data row3 col6" >-0.0252</td>
      <td id="T_56b5f_row3_col7" class="data row3 col7" >0.0387</td>
      <td id="T_56b5f_row3_col8" class="data row3 col8" >13.4871</td>
      <td id="T_56b5f_row3_col9" class="data row3 col9" >-0.0316</td>
      <td id="T_56b5f_row3_col10" class="data row3 col10" >0.0414</td>
      <td id="T_56b5f_row3_col11" class="data row3 col11" >14.7731</td>
      <td id="T_56b5f_row3_col12" class="data row3 col12" >-0.0169</td>
      <td id="T_56b5f_row3_col13" class="data row3 col13" >0.0392</td>
      <td id="T_56b5f_row3_col14" class="data row3 col14" >25.7307</td>
      <td id="T_56b5f_row3_col15" class="data row3 col15" >-0.0219</td>
      <td id="T_56b5f_row3_col16" class="data row3 col16" >0.0318</td>
      <td id="T_56b5f_row3_col17" class="data row3 col17" >10.6494</td>
      <td id="T_56b5f_row3_col18" class="data row3 col18" >-0.0121</td>
      <td id="T_56b5f_row3_col19" class="data row3 col19" >0.0302</td>
      <td id="T_56b5f_row3_col20" class="data row3 col20" >10.5112</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_56b5f_row4_col0" class="data row4 col0" >-0.0115</td>
      <td id="T_56b5f_row4_col1" class="data row4 col1" >0.0266</td>
      <td id="T_56b5f_row4_col2" class="data row4 col2" >5.8561</td>
      <td id="T_56b5f_row4_col3" class="data row4 col3" >-0.0213</td>
      <td id="T_56b5f_row4_col4" class="data row4 col4" >0.0344</td>
      <td id="T_56b5f_row4_col5" class="data row4 col5" >12.9982</td>
      <td id="T_56b5f_row4_col6" class="data row4 col6" >-0.0275</td>
      <td id="T_56b5f_row4_col7" class="data row4 col7" >0.0348</td>
      <td id="T_56b5f_row4_col8" class="data row4 col8" >15.6977</td>
      <td id="T_56b5f_row4_col9" class="data row4 col9" >-0.0301</td>
      <td id="T_56b5f_row4_col10" class="data row4 col10" >0.0401</td>
      <td id="T_56b5f_row4_col11" class="data row4 col11" >13.8591</td>
      <td id="T_56b5f_row4_col12" class="data row4 col12" >-0.0144</td>
      <td id="T_56b5f_row4_col13" class="data row4 col13" >0.0399</td>
      <td id="T_56b5f_row4_col14" class="data row4 col14" >25.5713</td>
      <td id="T_56b5f_row4_col15" class="data row4 col15" >-0.0218</td>
      <td id="T_56b5f_row4_col16" class="data row4 col16" >0.0328</td>
      <td id="T_56b5f_row4_col17" class="data row4 col17" >10.4687</td>
      <td id="T_56b5f_row4_col18" class="data row4 col18" >-0.0133</td>
      <td id="T_56b5f_row4_col19" class="data row4 col19" >0.0317</td>
      <td id="T_56b5f_row4_col20" class="data row4 col20" >12.0098</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_56b5f_row5_col0" class="data row5 col0" >-0.0086</td>
      <td id="T_56b5f_row5_col1" class="data row5 col1" >0.0323</td>
      <td id="T_56b5f_row5_col2" class="data row5 col2" >18.7374</td>
      <td id="T_56b5f_row5_col3" class="data row5 col3" >-0.0187</td>
      <td id="T_56b5f_row5_col4" class="data row5 col4" >0.0323</td>
      <td id="T_56b5f_row5_col5" class="data row5 col5" >15.9316</td>
      <td id="T_56b5f_row5_col6" class="data row5 col6" >-0.0228</td>
      <td id="T_56b5f_row5_col7" class="data row5 col7" >0.0345</td>
      <td id="T_56b5f_row5_col8" class="data row5 col8" >17.8659</td>
      <td id="T_56b5f_row5_col9" class="data row5 col9" >-0.0321</td>
      <td id="T_56b5f_row5_col10" class="data row5 col10" >0.0432</td>
      <td id="T_56b5f_row5_col11" class="data row5 col11" >16.5480</td>
      <td id="T_56b5f_row5_col12" class="data row5 col12" >-0.0158</td>
      <td id="T_56b5f_row5_col13" class="data row5 col13" >0.0397</td>
      <td id="T_56b5f_row5_col14" class="data row5 col14" >27.7500</td>
      <td id="T_56b5f_row5_col15" class="data row5 col15" >-0.0231</td>
      <td id="T_56b5f_row5_col16" class="data row5 col16" >0.0331</td>
      <td id="T_56b5f_row5_col17" class="data row5 col17" >12.6262</td>
      <td id="T_56b5f_row5_col18" class="data row5 col18" >-0.0155</td>
      <td id="T_56b5f_row5_col19" class="data row5 col19" >0.0311</td>
      <td id="T_56b5f_row5_col20" class="data row5 col20" >13.2958</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_56b5f_row6_col0" class="data row6 col0" >-0.0196</td>
      <td id="T_56b5f_row6_col1" class="data row6 col1" >0.0296</td>
      <td id="T_56b5f_row6_col2" class="data row6 col2" >9.3634</td>
      <td id="T_56b5f_row6_col3" class="data row6 col3" >-0.0169</td>
      <td id="T_56b5f_row6_col4" class="data row6 col4" >0.0324</td>
      <td id="T_56b5f_row6_col5" class="data row6 col5" >12.1692</td>
      <td id="T_56b5f_row6_col6" class="data row6 col6" >-0.0255</td>
      <td id="T_56b5f_row6_col7" class="data row6 col7" >0.0353</td>
      <td id="T_56b5f_row6_col8" class="data row6 col8" >17.2707</td>
      <td id="T_56b5f_row6_col9" class="data row6 col9" >-0.0378</td>
      <td id="T_56b5f_row6_col10" class="data row6 col10" >0.0451</td>
      <td id="T_56b5f_row6_col11" class="data row6 col11" >16.1547</td>
      <td id="T_56b5f_row6_col12" class="data row6 col12" >-0.0221</td>
      <td id="T_56b5f_row6_col13" class="data row6 col13" >0.0422</td>
      <td id="T_56b5f_row6_col14" class="data row6 col14" >28.3983</td>
      <td id="T_56b5f_row6_col15" class="data row6 col15" >-0.0246</td>
      <td id="T_56b5f_row6_col16" class="data row6 col16" >0.0337</td>
      <td id="T_56b5f_row6_col17" class="data row6 col17" >13.5402</td>
      <td id="T_56b5f_row6_col18" class="data row6 col18" >-0.0179</td>
      <td id="T_56b5f_row6_col19" class="data row6 col19" >0.0311</td>
      <td id="T_56b5f_row6_col20" class="data row6 col20" >13.6253</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_56b5f_row7_col0" class="data row7 col0" >-0.0169</td>
      <td id="T_56b5f_row7_col1" class="data row7 col1" >0.0367</td>
      <td id="T_56b5f_row7_col2" class="data row7 col2" >13.9547</td>
      <td id="T_56b5f_row7_col3" class="data row7 col3" >-0.0209</td>
      <td id="T_56b5f_row7_col4" class="data row7 col4" >0.0330</td>
      <td id="T_56b5f_row7_col5" class="data row7 col5" >9.5015</td>
      <td id="T_56b5f_row7_col6" class="data row7 col6" >-0.0279</td>
      <td id="T_56b5f_row7_col7" class="data row7 col7" >0.0355</td>
      <td id="T_56b5f_row7_col8" class="data row7 col8" >10.3305</td>
      <td id="T_56b5f_row7_col9" class="data row7 col9" >-0.0417</td>
      <td id="T_56b5f_row7_col10" class="data row7 col10" >0.0456</td>
      <td id="T_56b5f_row7_col11" class="data row7 col11" >12.8813</td>
      <td id="T_56b5f_row7_col12" class="data row7 col12" >-0.0256</td>
      <td id="T_56b5f_row7_col13" class="data row7 col13" >0.0450</td>
      <td id="T_56b5f_row7_col14" class="data row7 col14" >28.8872</td>
      <td id="T_56b5f_row7_col15" class="data row7 col15" >-0.0268</td>
      <td id="T_56b5f_row7_col16" class="data row7 col16" >0.0334</td>
      <td id="T_56b5f_row7_col17" class="data row7 col17" >12.6050</td>
      <td id="T_56b5f_row7_col18" class="data row7 col18" >-0.0194</td>
      <td id="T_56b5f_row7_col19" class="data row7 col19" >0.0305</td>
      <td id="T_56b5f_row7_col20" class="data row7 col20" >12.8281</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_56b5f_row8_col0" class="data row8 col0" >-0.0109</td>
      <td id="T_56b5f_row8_col1" class="data row8 col1" >0.0296</td>
      <td id="T_56b5f_row8_col2" class="data row8 col2" >5.5266</td>
      <td id="T_56b5f_row8_col3" class="data row8 col3" >-0.0224</td>
      <td id="T_56b5f_row8_col4" class="data row8 col4" >0.0317</td>
      <td id="T_56b5f_row8_col5" class="data row8 col5" >10.5962</td>
      <td id="T_56b5f_row8_col6" class="data row8 col6" >-0.0216</td>
      <td id="T_56b5f_row8_col7" class="data row8 col7" >0.0311</td>
      <td id="T_56b5f_row8_col8" class="data row8 col8" >8.4600</td>
      <td id="T_56b5f_row8_col9" class="data row8 col9" >-0.0404</td>
      <td id="T_56b5f_row8_col10" class="data row8 col10" >0.0429</td>
      <td id="T_56b5f_row8_col11" class="data row8 col11" >12.0310</td>
      <td id="T_56b5f_row8_col12" class="data row8 col12" >-0.0256</td>
      <td id="T_56b5f_row8_col13" class="data row8 col13" >0.0443</td>
      <td id="T_56b5f_row8_col14" class="data row8 col14" >28.2283</td>
      <td id="T_56b5f_row8_col15" class="data row8 col15" >-0.0264</td>
      <td id="T_56b5f_row8_col16" class="data row8 col16" >0.0333</td>
      <td id="T_56b5f_row8_col17" class="data row8 col17" >12.9876</td>
      <td id="T_56b5f_row8_col18" class="data row8 col18" >-0.0200</td>
      <td id="T_56b5f_row8_col19" class="data row8 col19" >0.0304</td>
      <td id="T_56b5f_row8_col20" class="data row8 col20" >12.2542</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_56b5f_row9_col0" class="data row9 col0" >0.0063</td>
      <td id="T_56b5f_row9_col1" class="data row9 col1" >0.0270</td>
      <td id="T_56b5f_row9_col2" class="data row9 col2" >2.3807</td>
      <td id="T_56b5f_row9_col3" class="data row9 col3" >-0.0064</td>
      <td id="T_56b5f_row9_col4" class="data row9 col4" >0.0302</td>
      <td id="T_56b5f_row9_col5" class="data row9 col5" >5.5798</td>
      <td id="T_56b5f_row9_col6" class="data row9 col6" >-0.0133</td>
      <td id="T_56b5f_row9_col7" class="data row9 col7" >0.0310</td>
      <td id="T_56b5f_row9_col8" class="data row9 col8" >8.4387</td>
      <td id="T_56b5f_row9_col9" class="data row9 col9" >-0.0279</td>
      <td id="T_56b5f_row9_col10" class="data row9 col10" >0.0372</td>
      <td id="T_56b5f_row9_col11" class="data row9 col11" >9.0445</td>
      <td id="T_56b5f_row9_col12" class="data row9 col12" >-0.0234</td>
      <td id="T_56b5f_row9_col13" class="data row9 col13" >0.0416</td>
      <td id="T_56b5f_row9_col14" class="data row9 col14" >27.6650</td>
      <td id="T_56b5f_row9_col15" class="data row9 col15" >-0.0271</td>
      <td id="T_56b5f_row9_col16" class="data row9 col16" >0.0322</td>
      <td id="T_56b5f_row9_col17" class="data row9 col17" >11.3189</td>
      <td id="T_56b5f_row9_col18" class="data row9 col18" >-0.0236</td>
      <td id="T_56b5f_row9_col19" class="data row9 col19" >0.0328</td>
      <td id="T_56b5f_row9_col20" class="data row9 col20" >12.1267</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_56b5f_row10_col0" class="data row10 col0" >0.0053</td>
      <td id="T_56b5f_row10_col1" class="data row10 col1" >0.0260</td>
      <td id="T_56b5f_row10_col2" class="data row10 col2" >4.2619</td>
      <td id="T_56b5f_row10_col3" class="data row10 col3" >0.0072</td>
      <td id="T_56b5f_row10_col4" class="data row10 col4" >0.0298</td>
      <td id="T_56b5f_row10_col5" class="data row10 col5" >4.7295</td>
      <td id="T_56b5f_row10_col6" class="data row10 col6" >-0.0094</td>
      <td id="T_56b5f_row10_col7" class="data row10 col7" >0.0290</td>
      <td id="T_56b5f_row10_col8" class="data row10 col8" >6.4088</td>
      <td id="T_56b5f_row10_col9" class="data row10 col9" >-0.0238</td>
      <td id="T_56b5f_row10_col10" class="data row10 col10" >0.0334</td>
      <td id="T_56b5f_row10_col11" class="data row10 col11" >9.6716</td>
      <td id="T_56b5f_row10_col12" class="data row10 col12" >-0.0230</td>
      <td id="T_56b5f_row10_col13" class="data row10 col13" >0.0421</td>
      <td id="T_56b5f_row10_col14" class="data row10 col14" >27.3143</td>
      <td id="T_56b5f_row10_col15" class="data row10 col15" >-0.0274</td>
      <td id="T_56b5f_row10_col16" class="data row10 col16" >0.0316</td>
      <td id="T_56b5f_row10_col17" class="data row10 col17" >11.3827</td>
      <td id="T_56b5f_row10_col18" class="data row10 col18" >-0.0251</td>
      <td id="T_56b5f_row10_col19" class="data row10 col19" >0.0334</td>
      <td id="T_56b5f_row10_col20" class="data row10 col20" >12.3392</td>
    </tr>
    <tr>
      <th id="T_56b5f_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_56b5f_row11_col0" class="data row11 col0" >0.0105</td>
      <td id="T_56b5f_row11_col1" class="data row11 col1" >0.0255</td>
      <td id="T_56b5f_row11_col2" class="data row11 col2" >8.0986</td>
      <td id="T_56b5f_row11_col3" class="data row11 col3" >0.0115</td>
      <td id="T_56b5f_row11_col4" class="data row11 col4" >0.0253</td>
      <td id="T_56b5f_row11_col5" class="data row11 col5" >4.6551</td>
      <td id="T_56b5f_row11_col6" class="data row11 col6" >-0.0055</td>
      <td id="T_56b5f_row11_col7" class="data row11 col7" >0.0260</td>
      <td id="T_56b5f_row11_col8" class="data row11 col8" >3.5392</td>
      <td id="T_56b5f_row11_col9" class="data row11 col9" >-0.0217</td>
      <td id="T_56b5f_row11_col10" class="data row11 col10" >0.0328</td>
      <td id="T_56b5f_row11_col11" class="data row11 col11" >8.8001</td>
      <td id="T_56b5f_row11_col12" class="data row11 col12" >-0.0220</td>
      <td id="T_56b5f_row11_col13" class="data row11 col13" >0.0406</td>
      <td id="T_56b5f_row11_col14" class="data row11 col14" >26.9742</td>
      <td id="T_56b5f_row11_col15" class="data row11 col15" >-0.0279</td>
      <td id="T_56b5f_row11_col16" class="data row11 col16" >0.0317</td>
      <td id="T_56b5f_row11_col17" class="data row11 col17" >11.5847</td>
      <td id="T_56b5f_row11_col18" class="data row11 col18" >-0.0253</td>
      <td id="T_56b5f_row11_col19" class="data row11 col19" >0.0330</td>
      <td id="T_56b5f_row11_col20" class="data row11 col20" >12.6475</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The regional comparison between ERA5‚ÄìDrought and reproduced SPEI largely shows the same patterns as the time series comparison.
Across most calendar months and accumulation periods,
the differences are bigger than for SPI,
although there are exceptions like January‚ÄìMarch in SPI/SPEI-1.
This may be related to the local dry season [<a class="reference external" href="https://doi.org/10.1038/s41598-019-47933-8" rel="noreferrer" target="_blank">Gebrechorkos+19</a>],
which would affect SPI more by introducting zero- or low-precipitation months,
or may be a coincidence.
Overall, agreement in SPEI is good.</p>
<p>Differences between the two datasets tend to concentrate in the same areas across accumulation periods,
particularly the Sudan‚ÄìSouth Sudan‚ÄìEthiopia tri-country area
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-geospatial"><span class="std std-numref">6.1.13</span></a>).
It is unclear whether this pattern is meaningful,
considering the potential difference in statistical distribution between the datasets.
The largest differences tend to occur in extremely wet or extremely dry conditions,
and tend not to affect the resulting classification
(Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion-region"><span class="std std-numref">6.1.14</span></a>).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_geospatial_comparison</span><span class="p">(</span><span class="n">spei_era5drought_region</span><span class="p">,</span> <span class="n">spei_reproduced_region</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s2">&quot;SPEI&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_snapshot</span><span class="si">}</span><span class="s2">-12-01&quot;</span><span class="p">,</span>
                           <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                           <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-geospatial&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot confusion matrix comparison</span>
<span class="c1"># e.g. are all &quot;extremely dry&quot; data in ERA5‚ÄìDrought also &quot;extremely dry&quot; in the reproduction?</span>
<span class="n">plot_confusion_matrices_spei</span><span class="p">(</span><span class="n">spei_era5drought_region</span><span class="p">,</span> <span class="n">spei_reproduced_region</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; in </span><span class="si">{</span><span class="n">label_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                             <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-confusion-region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-10" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-10">
Geospatial</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-geospatial">
<img alt="../_images/45c0757268652a05ced4a2f380c698302b1efaddc54ad022a9f1b8ef907d2570.png" src="../_images/45c0757268652a05ced4a2f380c698302b1efaddc54ad022a9f1b8ef907d2570.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.13 </span><span class="caption-text">SPEI downloaded from ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference between the two (right), for the region around the example site of Addis Ababa, Ethiopia.
Only one month (December 2024) is displayed.
Colours correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-geospatial" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-11" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="confusion" for="sd-tab-item-11">
Confusion matrix</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion-region">
<img alt="../_images/67e52dfce9d39f35bcbe1ac64c0bbe05d39f8210ee44acd025311d90a805a305.png" src="../_images/67e52dfce9d39f35bcbe1ac64c0bbe05d39f8210ee44acd025311d90a805a305.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.14 </span><span class="caption-text">Confusion matrices for SPEI categories from ERA5‚ÄìDrought vs. reproduced from ERA5, across the region around the example site of Addis Ababa, Ethiopia.
Combines data for all months within one year (2024).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-confusion-region" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
<section id="id1">
<h4>4.6 Quality flags: Shapiro‚ÄìWilk normality test<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>ERA5‚ÄìDrought includes one quality flag for SPEI, namely the normality <em>Œ±</em>,
derived using the Shapiro‚ÄìWilk test [<a class="reference external" href="https://doi.org/10.1093/biomet/52.3-4.591" rel="noreferrer" target="_blank">Shapiro+65</a>].
This <em>Œ±</em> quantifies how well the computed SPI or SPEI values
in the reference period
(1991‚Äì2020)
are described by a standard normal distribution.
As such, <em>Œ±</em> is provided for each combination of calendar month and accumulation window,
for each pixel.
The mask in ERA‚ÄìDrought uses a threshold of 0.05, meaning points where <em>Œ±</em> &lt; 0.05 are rejected.</p>
<p>In this subsection,
we reproduce the <em>Œ±</em> quality flag mask,
and compare its values to those provided in ERA5‚ÄìDrought.
Because this involves computing SPEI,
which is computationally expensive,
the evaluation is performed over the example region
(Horn of Africa)
rather than globally.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_waterbalance_region</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_region</span><span class="p">)</span>

<span class="c1"># Calculate SPEI</span>
<span class="n">spei_reproduced_region</span> <span class="o">=</span> <span class="n">calculate_spei_from_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_region</span><span class="p">,</span> <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">,</span>
                                                  <span class="n">evaluation_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Shapiro‚ÄìWilk normality test</span>
<span class="n">normality_reproduced</span> <span class="o">=</span> <span class="n">shapiro_wilk_normality</span><span class="p">(</span><span class="n">spei_reproduced_region</span><span class="p">)</span>

<span class="c1"># Retain in memory</span>
<span class="n">normality_reproduced</span> <span class="o">=</span> <span class="n">normality_reproduced</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>

<span class="c1"># Create mask from normality p-values</span>
<span class="c1"># True: above threshold, allowed</span>
<span class="c1"># False: below threshold, flagged</span>
<span class="n">normality_reproduced_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">normality_reproduced</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">normality_reproduced_mask</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 792kB
Dimensions:  (lat: 97, lon: 97, month: 12)
Coordinates:
    number   int64 8B 0
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    SPEI1    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI3    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI6    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI12   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI24   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI36   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;
    SPEI48   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-fba1d0ea-c249-4c9f-bead-9b7cbb5c2f0d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fba1d0ea-c249-4c9f-bead-9b7cbb5c2f0d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li><li><span class='xr-has-index'>month</span>: 12</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-be8916ca-d866-416f-aad0-31a673afa8ce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-be8916ca-d866-416f-aad0-31a673afa8ce' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-2c4bf11d-f92d-48b5-a4fa-4bade2a2bef5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c4bf11d-f92d-48b5-a4fa-4bade2a2bef5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5f19fcc-1a5a-4df6-8cee-b2b76d3f9c98' class='xr-var-data-in' type='checkbox'><label for='data-b5f19fcc-1a5a-4df6-8cee-b2b76d3f9c98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-1f78b5fd-0316-4779-923d-88802e8e4153' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1f78b5fd-0316-4779-923d-88802e8e4153' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f26a458-d0d9-4a81-a8ae-cc3551931036' class='xr-var-data-in' type='checkbox'><label for='data-1f26a458-d0d9-4a81-a8ae-cc3551931036' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-ccfb3cb5-284c-41ef-87ff-611f037766a9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ccfb3cb5-284c-41ef-87ff-611f037766a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a269dc57-8db6-4ede-a339-8e6887a99718' class='xr-var-data-in' type='checkbox'><label for='data-a269dc57-8db6-4ede-a339-8e6887a99718' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-919c270d-4c5d-4fac-a085-2e3366f880b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-919c270d-4c5d-4fac-a085-2e3366f880b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09907271-f52e-4653-b515-39cb61e1ebb7' class='xr-var-data-in' type='checkbox'><label for='data-09907271-f52e-4653-b515-39cb61e1ebb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-86895608-c999-4b50-8acb-0015a524b757' class='xr-section-summary-in' type='checkbox'  checked><label for='section-86895608-c999-4b50-8acb-0015a524b757' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-f8ec0133-ccc2-4ede-b162-70c8f87cf4cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8ec0133-ccc2-4ede-b162-70c8f87cf4cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20c84088-4f19-43c5-a90e-a8862e3f7c72' class='xr-var-data-in' type='checkbox'><label for='data-20c84088-4f19-43c5-a90e-a8862e3f7c72' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-5b66d10f-8945-4bf6-b1a9-76bb48e0d3ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b66d10f-8945-4bf6-b1a9-76bb48e0d3ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4058c7df-d296-408e-9955-874b38e2d0b7' class='xr-var-data-in' type='checkbox'><label for='data-4058c7df-d296-408e-9955-874b38e2d0b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-4d2fec97-c2e0-43ff-9ee1-21dbb1eeb4a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4d2fec97-c2e0-43ff-9ee1-21dbb1eeb4a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89b862cf-4d18-42fd-bbf6-c2c065e19f59' class='xr-var-data-in' type='checkbox'><label for='data-89b862cf-4d18-42fd-bbf6-c2c065e19f59' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-9b7316ee-0c75-4545-a472-80d866720a0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b7316ee-0c75-4545-a472-80d866720a0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60c12ace-ae3c-4307-a7e5-60828b65a9ca' class='xr-var-data-in' type='checkbox'><label for='data-60c12ace-ae3c-4307-a7e5-60828b65a9ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-33d81bbf-f8d5-4feb-a9dd-2f3f8c7e10c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-33d81bbf-f8d5-4feb-a9dd-2f3f8c7e10c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32a2fc83-13b8-4feb-ae2a-a216bcd30011' class='xr-var-data-in' type='checkbox'><label for='data-32a2fc83-13b8-4feb-ae2a-a216bcd30011' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-d567e1ef-394d-4d83-8325-7af051503f85' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d567e1ef-394d-4d83-8325-7af051503f85' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61f62407-b203-419c-b6be-4ef73ece1fa9' class='xr-var-data-in' type='checkbox'><label for='data-61f62407-b203-419c-b6be-4ef73ece1fa9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 33, 97), meta=np.ndarray&gt;</div><input id='attrs-ca4f4235-4738-4e68-8449-0ef2de7b54e7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca4f4235-4738-4e68-8449-0ef2de7b54e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b5a052f-424d-46e5-a7c1-53b70c2e45e4' class='xr-var-data-in' type='checkbox'><label for='data-1b5a052f-424d-46e5-a7c1-53b70c2e45e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 6.06 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 64, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 24 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="40" x2="33" y2="64" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="64" x2="153" y2="64" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-db447969-5704-4c11-8754-a74a40a89a5b' class='xr-section-summary-in' type='checkbox'  ><label for='section-db447969-5704-4c11-8754-a74a40a89a5b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e9449265-713b-4b47-86ed-a2d83858679f' class='xr-index-data-in' type='checkbox'/><label for='index-e9449265-713b-4b47-86ed-a2d83858679f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-65faa063-e5c3-4b5d-b178-77f098349d41' class='xr-index-data-in' type='checkbox'/><label for='index-65faa063-e5c3-4b5d-b178-77f098349d41' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3a488b04-c36d-47de-a89a-3d27125d8e4d' class='xr-index-data-in' type='checkbox'/><label for='index-3a488b04-c36d-47de-a89a-3d27125d8e4d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a3a678ec-6758-49e1-9c74-b5b6cb6dc7fd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a3a678ec-6758-49e1-9c74-b5b6cb6dc7fd' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>The CDS provides ERA5‚ÄìDrought‚Äôs <em>Œ±</em> flag for each accumulation period,
but does not distinguish between them in the variable name.
This means that <em>Œ±</em> must be downloaded separately for each accumulation period, renamed, and merged together,
rather than downloading it for all simultaneously.
Note that unlike for <em>p<sub>0</sub></em>,
ERA5‚ÄìDrought does not provide the value of <em>Œ±</em>, only the corresponding boolean mask.</p>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup: Request for each accumulation period</span>
<span class="n">request_normality</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;test_for_normality_spei&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_region</span> <span class="o">|</span> <span class="n">request_era5drought_flag</span>

<span class="n">requests_per_accumulation_period</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;accumulation_period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">period</span><span class="p">)],}</span>
                                    <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">ACCUMULATION_PERIODS</span><span class="p">}</span>

<span class="n">subrequests_era5drought_normality</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="p">(</span><span class="n">req</span> <span class="o">|</span> <span class="n">request_normality</span><span class="p">)</span>
                                       <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">requests_per_accumulation_period</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Download data in individual requests</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="p">{</span><span class="n">period</span><span class="p">:</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="n">subreq</span><span class="p">)</span>  <span class="c1"># Download as field lists</span>
                              <span class="k">for</span> <span class="n">period</span><span class="p">,</span> <span class="n">subreq</span> <span class="ow">in</span> <span class="n">subrequests_era5drought_normality</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="c1"># Pre-process: Convert to xarray, handle variable names, month dimension</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="n">preprocess_era5drought_qualityflag</span><span class="p">(</span><span class="n">normality_era5drought_mask</span><span class="p">,</span> <span class="s2">&quot;SPEI&quot;</span><span class="p">)</span>
<span class="n">normality_era5drought_mask</span> <span class="o">=</span> <span class="n">normality_era5drought_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># Convert to boolean array (values are only 0. or 1.)</span>

<span class="c1"># Display in notebook</span>
<span class="n">normality_era5drought_mask</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 792kB
Dimensions:  (month: 12, lat: 97, lon: 97)
Coordinates:
    time     (month) datetime64[ns] 96B 2020-01-01 2020-02-01 ... 2020-12-01
  * lon      (lon) float64 776B 26.75 27.0 27.25 27.5 ... 50.0 50.25 50.5 50.75
  * lat      (lat) float64 776B 21.0 20.75 20.5 20.25 ... -2.25 -2.5 -2.75 -3.0
  * month    (month) int64 96B 1 2 3 4 5 6 7 8 9 10 11 12
Data variables:
    SPEI1    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI3    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI6    (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI12   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI24   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI36   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
    SPEI48   (month, lat, lon) bool 113kB dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;
Attributes: (12/19)
    CDI:                     Climate Data Interface version 1.9.10 (https://m...
    Conventions:             CF-1.8
    source:                  DRYFALL v1.0
    institution:             European Centre for Medium-Range Weather Forecasts
    title:                   Quality criteria for the derived standardized dr...
    description:             Monthly quality criteria that define the reliabi...
    ...                      ...
    resolution:              0.25x0.25
    climate_start_date:      1991-01-01
    climate_end_date:        2020-12-31
    frequency:               Monthly
    contact_person:          support@ecmwf.int
    CDO:                     Climate Data Operators version 1.9.10 (https://m...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-fad9011b-da45-42be-9901-a9b67911db0e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fad9011b-da45-42be-9901-a9b67911db0e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>month</span>: 12</li><li><span class='xr-has-index'>lat</span>: 97</li><li><span class='xr-has-index'>lon</span>: 97</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-891968a9-1e34-4b9b-bb0d-bc20d34f53c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-891968a9-1e34-4b9b-bb0d-bc20d34f53c6' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-01-01 ... 2020-12-01</div><input id='attrs-7e6f3856-ac10-4067-b7c8-fc1bfc6587b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7e6f3856-ac10-4067-b7c8-fc1bfc6587b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9e72b68-35c1-41b9-8a25-6ef534f40af1' class='xr-var-data-in' type='checkbox'><label for='data-c9e72b68-35c1-41b9-8a25-6ef534f40af1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-01-01T00:00:00.000000000&#x27;, &#x27;2020-02-01T00:00:00.000000000&#x27;,
       &#x27;2020-03-01T00:00:00.000000000&#x27;, &#x27;2020-04-01T00:00:00.000000000&#x27;,
       &#x27;2020-05-01T00:00:00.000000000&#x27;, &#x27;2020-06-01T00:00:00.000000000&#x27;,
       &#x27;2020-07-01T00:00:00.000000000&#x27;, &#x27;2020-08-01T00:00:00.000000000&#x27;,
       &#x27;2020-09-01T00:00:00.000000000&#x27;, &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.75 27.0 27.25 ... 50.5 50.75</div><input id='attrs-9c6ba085-8687-44c1-a64d-ae26abae0064' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c6ba085-8687-44c1-a64d-ae26abae0064' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17c7ab11-37b8-41e4-b11d-8febcf039504' class='xr-var-data-in' type='checkbox'><label for='data-17c7ab11-37b8-41e4-b11d-8febcf039504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([26.75, 27.  , 27.25, 27.5 , 27.75, 28.  , 28.25, 28.5 , 28.75, 29.  ,
       29.25, 29.5 , 29.75, 30.  , 30.25, 30.5 , 30.75, 31.  , 31.25, 31.5 ,
       31.75, 32.  , 32.25, 32.5 , 32.75, 33.  , 33.25, 33.5 , 33.75, 34.  ,
       34.25, 34.5 , 34.75, 35.  , 35.25, 35.5 , 35.75, 36.  , 36.25, 36.5 ,
       36.75, 37.  , 37.25, 37.5 , 37.75, 38.  , 38.25, 38.5 , 38.75, 39.  ,
       39.25, 39.5 , 39.75, 40.  , 40.25, 40.5 , 40.75, 41.  , 41.25, 41.5 ,
       41.75, 42.  , 42.25, 42.5 , 42.75, 43.  , 43.25, 43.5 , 43.75, 44.  ,
       44.25, 44.5 , 44.75, 45.  , 45.25, 45.5 , 45.75, 46.  , 46.25, 46.5 ,
       46.75, 47.  , 47.25, 47.5 , 47.75, 48.  , 48.25, 48.5 , 48.75, 49.  ,
       49.25, 49.5 , 49.75, 50.  , 50.25, 50.5 , 50.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>21.0 20.75 20.5 ... -2.5 -2.75 -3.0</div><input id='attrs-a5e6d736-7741-49be-9a39-c319aae7f818' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5e6d736-7741-49be-9a39-c319aae7f818' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74994549-6abc-40d8-926f-21d42c494911' class='xr-var-data-in' type='checkbox'><label for='data-74994549-6abc-40d8-926f-21d42c494911' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([21.  , 20.75, 20.5 , 20.25, 20.  , 19.75, 19.5 , 19.25, 19.  , 18.75,
       18.5 , 18.25, 18.  , 17.75, 17.5 , 17.25, 17.  , 16.75, 16.5 , 16.25,
       16.  , 15.75, 15.5 , 15.25, 15.  , 14.75, 14.5 , 14.25, 14.  , 13.75,
       13.5 , 13.25, 13.  , 12.75, 12.5 , 12.25, 12.  , 11.75, 11.5 , 11.25,
       11.  , 10.75, 10.5 , 10.25, 10.  ,  9.75,  9.5 ,  9.25,  9.  ,  8.75,
        8.5 ,  8.25,  8.  ,  7.75,  7.5 ,  7.25,  7.  ,  6.75,  6.5 ,  6.25,
        6.  ,  5.75,  5.5 ,  5.25,  5.  ,  4.75,  4.5 ,  4.25,  4.  ,  3.75,
        3.5 ,  3.25,  3.  ,  2.75,  2.5 ,  2.25,  2.  ,  1.75,  1.5 ,  1.25,
        1.  ,  0.75,  0.5 ,  0.25,  0.  , -0.25, -0.5 , -0.75, -1.  , -1.25,
       -1.5 , -1.75, -2.  , -2.25, -2.5 , -2.75, -3.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>month</span></div><div class='xr-var-dims'>(month)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 7 8 9 10 11 12</div><input id='attrs-621291a5-76c7-49cf-b1b3-2320a609c387' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-621291a5-76c7-49cf-b1b3-2320a609c387' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0b8dc5e-5c50-4f4d-9e3b-5652ccb993f7' class='xr-var-data-in' type='checkbox'><label for='data-b0b8dc5e-5c50-4f4d-9e3b-5652ccb993f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-098cf777-82f7-4b0b-a4b3-521887735a92' class='xr-section-summary-in' type='checkbox'  checked><label for='section-098cf777-82f7-4b0b-a4b3-521887735a92' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-a90b78c3-28f9-4291-8a90-c8eb419cde03' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a90b78c3-28f9-4291-8a90-c8eb419cde03' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e694354b-21e4-4c49-b3ff-2bed64904973' class='xr-var-data-in' type='checkbox'><label for='data-e694354b-21e4-4c49-b3ff-2bed64904973' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-9ea1356d-f6f0-4769-884c-4aa0ae2b6be4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9ea1356d-f6f0-4769-884c-4aa0ae2b6be4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e19c39a-a43d-4ea4-ac79-786ed3b42570' class='xr-var-data-in' type='checkbox'><label for='data-7e19c39a-a43d-4ea4-ac79-786ed3b42570' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-17a6f8a2-2032-4d18-bc4c-8bb43fc7c62c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-17a6f8a2-2032-4d18-bc4c-8bb43fc7c62c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c54c224f-ec96-41a6-973a-4db975c9e18e' class='xr-var-data-in' type='checkbox'><label for='data-c54c224f-ec96-41a6-973a-4db975c9e18e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-e1114db7-8053-4bbd-89e6-e194d516d208' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e1114db7-8053-4bbd-89e6-e194d516d208' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f48f9c8-555c-43c2-8e60-2ccabef59c2e' class='xr-var-data-in' type='checkbox'><label for='data-1f48f9c8-555c-43c2-8e60-2ccabef59c2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-cd7fea7d-2f02-492b-8b07-8c8eac66d67d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd7fea7d-2f02-492b-8b07-8c8eac66d67d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3e9746b-b31e-4414-8029-2ebec05a1936' class='xr-var-data-in' type='checkbox'><label for='data-b3e9746b-b31e-4414-8029-2ebec05a1936' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-20d4d3bf-d961-4e7f-ab76-85fa75d9af71' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20d4d3bf-d961-4e7f-ab76-85fa75d9af71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5b4934d-b5be-4d51-b393-c19d337928ba' class='xr-var-data-in' type='checkbox'><label for='data-d5b4934d-b5be-4d51-b393-c19d337928ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(month, lat, lon)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 97, 97), meta=np.ndarray&gt;</div><input id='attrs-822904da-60ab-4354-8d70-4f1d86e8006d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-822904da-60ab-4354-8d70-4f1d86e8006d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a427cd51-54eb-495f-adff-6b5e62bdb637' class='xr-var-data-in' type='checkbox'><label for='data-a427cd51-54eb-495f-adff-6b5e62bdb637' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Quality flag that indicates the acceptance of a Shapiro-Wilks test for normality using the derived standardized indices during the reference period; 1 indicates significant values and 0 indicates non-significant values at the alpha=0.05 level.</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 110.26 kiB </td>
                        <td> 9.19 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (12, 97, 97) </td>
                        <td> (1, 97, 97) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 12 chunks in 26 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="203" height="193" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="10" y1="120" x2="33" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="120" style="stroke-width:2" />
  <line x1="11" y1="1" x2="11" y2="121" />
  <line x1="13" y1="3" x2="13" y2="123" />
  <line x1="15" y1="5" x2="15" y2="125" />
  <line x1="17" y1="7" x2="17" y2="127" />
  <line x1="19" y1="9" x2="19" y2="129" />
  <line x1="21" y1="11" x2="21" y2="131" />
  <line x1="23" y1="13" x2="23" y2="133" />
  <line x1="25" y1="15" x2="25" y2="135" />
  <line x1="27" y1="17" x2="27" y2="137" />
  <line x1="29" y1="19" x2="29" y2="139" />
  <line x1="31" y1="21" x2="31" y2="141" />
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 33.37659470013864,23.37659470013864 33.37659470013864,143.37659470013864 10.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="25" y1="15" x2="145" y2="15" />
  <line x1="27" y1="17" x2="147" y2="17" />
  <line x1="29" y1="19" x2="149" y2="19" />
  <line x1="31" y1="21" x2="151" y2="21" />
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="33" y2="23" style="stroke-width:2" />
  <line x1="130" y1="0" x2="153" y2="23" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 153.37659470013864,23.37659470013864 33.37659470013864,23.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="33" y1="23" x2="153" y2="23" style="stroke-width:2" />
  <line x1="33" y1="143" x2="153" y2="143" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="33" y1="23" x2="33" y2="143" style="stroke-width:2" />
  <line x1="153" y1="23" x2="153" y2="143" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="33.37659470013864,23.37659470013864 153.37659470013864,23.37659470013864 153.37659470013864,143.37659470013864 33.37659470013864,143.37659470013864" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.376595" y="163.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" >97</text>
  <text x="173.376595" y="83.376595" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,173.376595,83.376595)">97</text>
  <text x="11.688297" y="151.688297" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,11.688297,151.688297)">12</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-c2db344b-f424-436b-b18f-466f91aa9536' class='xr-section-summary-in' type='checkbox'  ><label for='section-c2db344b-f424-436b-b18f-466f91aa9536' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4a22cab6-d081-45a7-ad6b-30fafeeeadb6' class='xr-index-data-in' type='checkbox'/><label for='index-4a22cab6-d081-45a7-ad6b-30fafeeeadb6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([26.75,  27.0, 27.25,  27.5, 27.75,  28.0, 28.25,  28.5, 28.75,  29.0,
       29.25,  29.5, 29.75,  30.0, 30.25,  30.5, 30.75,  31.0, 31.25,  31.5,
       31.75,  32.0, 32.25,  32.5, 32.75,  33.0, 33.25,  33.5, 33.75,  34.0,
       34.25,  34.5, 34.75,  35.0, 35.25,  35.5, 35.75,  36.0, 36.25,  36.5,
       36.75,  37.0, 37.25,  37.5, 37.75,  38.0, 38.25,  38.5, 38.75,  39.0,
       39.25,  39.5, 39.75,  40.0, 40.25,  40.5, 40.75,  41.0, 41.25,  41.5,
       41.75,  42.0, 42.25,  42.5, 42.75,  43.0, 43.25,  43.5, 43.75,  44.0,
       44.25,  44.5, 44.75,  45.0, 45.25,  45.5, 45.75,  46.0, 46.25,  46.5,
       46.75,  47.0, 47.25,  47.5, 47.75,  48.0, 48.25,  48.5, 48.75,  49.0,
       49.25,  49.5, 49.75,  50.0, 50.25,  50.5, 50.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-16ba667d-1543-4831-8098-582e634eb38b' class='xr-index-data-in' type='checkbox'/><label for='index-16ba667d-1543-4831-8098-582e634eb38b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 21.0, 20.75,  20.5, 20.25,  20.0, 19.75,  19.5, 19.25,  19.0, 18.75,
        18.5, 18.25,  18.0, 17.75,  17.5, 17.25,  17.0, 16.75,  16.5, 16.25,
        16.0, 15.75,  15.5, 15.25,  15.0, 14.75,  14.5, 14.25,  14.0, 13.75,
        13.5, 13.25,  13.0, 12.75,  12.5, 12.25,  12.0, 11.75,  11.5, 11.25,
        11.0, 10.75,  10.5, 10.25,  10.0,  9.75,   9.5,  9.25,   9.0,  8.75,
         8.5,  8.25,   8.0,  7.75,   7.5,  7.25,   7.0,  6.75,   6.5,  6.25,
         6.0,  5.75,   5.5,  5.25,   5.0,  4.75,   4.5,  4.25,   4.0,  3.75,
         3.5,  3.25,   3.0,  2.75,   2.5,  2.25,   2.0,  1.75,   1.5,  1.25,
         1.0,  0.75,   0.5,  0.25,   0.0, -0.25,  -0.5, -0.75,  -1.0, -1.25,
        -1.5, -1.75,  -2.0, -2.25,  -2.5, -2.75,  -3.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>month</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8169067d-58e7-45a2-be82-3cdf17af0cf4' class='xr-index-data-in' type='checkbox'/><label for='index-8169067d-58e7-45a2-be82-3cdf17af0cf4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], dtype=&#x27;int64&#x27;, name=&#x27;month&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4cd439a1-ca0f-4683-836a-ece31ae6bd77' class='xr-section-summary-in' type='checkbox'  ><label for='section-4cd439a1-ca0f-4683-836a-ece31ae6bd77' class='xr-section-summary' >Attributes: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 1.9.10 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>source :</span></dt><dd>DRYFALL v1.0</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>title :</span></dt><dd>Quality criteria for the derived standardized drought indices</dd><dt><span>description :</span></dt><dd>Monthly quality criteria that define the reliability of the derived drought indices.</dd><dt><span>history :</span></dt><dd>Tue Aug 13 11:21:50 2024: cdo -selvar,significance -setdate,20200101 -seldate,19000101 /ec/ws4/tc/emos/work/cems/dryfall/emos/dryfall_monthly/generated_climate/parameters/SPEI1_genlogistic_global_era5_moda_ref1991to2020_params.nc SPEI1_speisignificance_genlogistic_global_era5_moda_ref1991to2020_01.nc
Created 13/08/2024 11:20:58 using DRYFALL.</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution v4</dd><dt><span>citation_statement :</span></dt><dd>Drought indicators derived from ERA5 reanalysis</dd><dt><span>ref_publication :</span></dt><dd>Keune, J., F. Di Giuseppe, C. Barnard, D. Damasio da Costa, and F. Wetterhall: ERA5‚ÄìDrought: Global drought indicators based on ECMWF reanalysis.</dd><dt><span>cds_data_catalogue_url :</span></dt><dd>https://ecds.climate.copernicus.eu/datasets/derived-drought-historical</dd><dt><span>data_srs :</span></dt><dd>EPSG:4326</dd><dt><span>extent :</span></dt><dd>-180,-90,180,90</dd><dt><span>resolution :</span></dt><dd>0.25x0.25</dd><dt><span>climate_start_date :</span></dt><dd>1991-01-01</dd><dt><span>climate_end_date :</span></dt><dd>2020-12-31</dd><dt><span>frequency :</span></dt><dd>Monthly</dd><dt><span>contact_person :</span></dt><dd>support@ecmwf.int</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 1.9.10 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>First,
we quantitatively compare how often the values of the normality mask desired from <em>Œ±</em> in ERA5‚ÄìDrought and the reproduction match:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package probability and masks into dictionary for table function; note use unicode symbols / HTML</span>
<span class="n">normality_flags</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Œ± &lt; 0.05 [%]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normality_reproduced_mask</span><span class="p">,</span> <span class="n">normality_era5drought_mask</span><span class="p">],</span>
                  <span class="p">}</span>
        
<span class="c1"># Compare probabilities per variable</span>
<span class="n">compare_quality_flags</span><span class="p">(</span><span class="n">normality_flags</span><span class="p">,</span> <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">domain_region</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_e1cfd">
  <caption>ERA5‚ÄìDrought vs. Reproduced
Quality flag matches (Horn of Africa)</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_e1cfd_level0_col0" class="col_heading level0 col0" >SPEI-1</th>
      <th id="T_e1cfd_level0_col1" class="col_heading level0 col1" >SPEI-3</th>
      <th id="T_e1cfd_level0_col2" class="col_heading level0 col2" >SPEI-6</th>
      <th id="T_e1cfd_level0_col3" class="col_heading level0 col3" >SPEI-12</th>
      <th id="T_e1cfd_level0_col4" class="col_heading level0 col4" >SPEI-24</th>
      <th id="T_e1cfd_level0_col5" class="col_heading level0 col5" >SPEI-36</th>
      <th id="T_e1cfd_level0_col6" class="col_heading level0 col6" >SPEI-48</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e1cfd_level0_row0" class="row_heading level0 row0" >Matching Œ± < 0.05 [%]</th>
      <td id="T_e1cfd_row0_col0" class="data row0 col0" >92.77</td>
      <td id="T_e1cfd_row0_col1" class="data row0 col1" >91.43</td>
      <td id="T_e1cfd_row0_col2" class="data row0 col2" >90.64</td>
      <td id="T_e1cfd_row0_col3" class="data row0 col3" >91.13</td>
      <td id="T_e1cfd_row0_col4" class="data row0 col4" >88.83</td>
      <td id="T_e1cfd_row0_col5" class="data row0 col5" >87.77</td>
      <td id="T_e1cfd_row0_col6" class="data row0 col6" >87.51</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Agreement in the SPEI normality flag is excellent
(‚â•87%)
across all accumulation periods.
The normality mask is applied much more rarely for SPEI than for SPI
and mismatched months appear randomly distributed across the Horn region
(Figures
<a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei1"><span class="std std-numref">6.1.15</span></a>
and
<a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei3"><span class="std std-numref">6.1.16</span></a>).
This result shows that while the fitted distributions themselves may differ between ERA5‚ÄìDrought and the reproduction,
they tend to either both pass or both fail the normality test.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Package masks into dictionary for plotting function; note use of LaTeX instead of unicode/HTML symbols</span>
<span class="n">masks</span> <span class="o">=</span> <span class="p">{</span><span class="sa">r</span><span class="s2">&quot;$\alpha &lt; 0.05$&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">normality_era5drought_mask</span><span class="p">,</span> <span class="n">normality_reproduced_mask</span><span class="p">],</span>
        <span class="p">}</span>

<span class="c1"># Display quality flags ‚Äì this step may take a few minutes</span>
<span class="c1"># SPI-1: Compare to table</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;SPEI1&quot;</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-normality-region-spei1&quot;</span><span class="p">)</span>

<span class="c1"># SPI-3: Compare to Keune+25 Fig 3.</span>
<span class="n">plot_geospatial_comparison_quality_flags</span><span class="p">(</span><span class="s2">&quot;SPEI3&quot;</span><span class="p">,</span> <span class="n">masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
                                         <span class="n">shared_mask</span><span class="o">=</span><span class="n">LAND</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain_region</span><span class="p">,</span>
                                         <span class="n">glue_label</span><span class="o">=</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-normality-region-spei3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-12" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="timeseries" for="sd-tab-item-12">
SPEI-1</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei1">
<img alt="../_images/cda4c718389ad012a415e4f16170ebc4dbdb0164911445eb0ee305e52db5d469.png" src="../_images/cda4c718389ad012a415e4f16170ebc4dbdb0164911445eb0ee305e52db5d469.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.15 </span><span class="caption-text">Shapiro‚ÄìWilk normality <em>Œ±</em> for SPEI-1 and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
The <em>Œ±</em> &lt; 0.05 mask is displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.
This figure displays only the example region (Horn of Africa).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-13" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="spi3" for="sd-tab-item-13">
SPEI-3</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei3">
<img alt="../_images/a24edf30d93d9ab69a239950e5d8c1b8102cd55a68a5bd24ced373bd85bd3862.png" src="../_images/a24edf30d93d9ab69a239950e5d8c1b8102cd55a68a5bd24ced373bd85bd3862.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.16 </span><span class="caption-text">Shapiro‚ÄìWilk normality <em>Œ±</em> for SPEI-3 and associated masks in ERA5‚ÄìDrought (left) vs. reproduced from ERA5 precipitation data (middle) and the difference or mismatch between the two (right).
The <em>Œ±</em> &lt; 0.05 mask is displayed as the number of calendar months that get flagged and the oceans are masked,
following [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] Fig. 3.
This figure displays only the example region (Horn of Africa).</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-normality-region-spei3" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="ensemble-comparison">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-ensemble"></span><h3>5. Ensemble comparison<a class="headerlink" href="#ensemble-comparison" title="Link to this heading">#</a></h3>
<p>One of the key strengths of ERA5‚ÄìDrought is its inclusion of 10 ensemble members,
propagated from ERA5,
which can be used to probe
(part of)
the uncertainty in SPI and SPEI values [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</p>
<p>Here, we briefly demonstrate the reproducibility of the ERA5‚ÄìDrought ensemble from the corresponding ERA5 ensemble members.
To avoid repetition
and
reduce computational cost
‚Äì since the ensemble dataset is 10√ó the size of the reanalysis ‚Äì
this section focuses on the case study of
SPI and SPEI in one site.
If you are keen to investigate the reproducibility of the ERA5‚ÄìDrought ensemble more,
the code provided in this notebook can easily be re-used to do so.</p>
<section id="compute-spi-and-spei-from-era5-ensemble">
<h4>5.1 Compute SPI and SPEI from ERA5 ensemble<a class="headerlink" href="#compute-spi-and-spei-from-era5-ensemble" title="Link to this heading">#</a></h4>
<p>As before,
precipitation and potential evaporation are downloaded from
the <a class="reference external" href="https://doi.org/10.24381/cds.143582cf" rel="noreferrer" target="_blank"><em>Complete ERA5 global atmospheric reanalysis</em></a> dataset,
but this time using the <code class="docutils literal notranslate"><span class="pre">edmo</span></code> (monthly ensemble) stream.
The ERA5 ensemble is provided at a coarser resolution than the main reanalysis;
ERA5‚ÄìDrought regrids both to the same 0.25¬∞ by 0.25¬∞ grid,
which we do here using MARS‚Äôs internal functionalities.
In code, this is implemented through the line
<code class="docutils literal notranslate"><span class="pre">&quot;grid&quot;:</span> <span class="pre">&quot;0.25/0.25&quot;,</span></code>
in the ERA5 request (<code class="docutils literal notranslate"><span class="pre">request_era5_template</span></code>).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_era5_precipitation_edmo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;param&quot;</span><span class="p">:</span> <span class="s2">&quot;228.128&quot;</span><span class="p">,</span>       <span class="c1"># Variable: Total precipitation</span>
    <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;edmo&quot;</span><span class="p">,</span>         <span class="c1"># Data stream: Monthly mean reanalysis</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5_template</span>

<span class="n">request_era5_evaporation_edmo</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;param&quot;</span><span class="p">:</span> <span class="s2">&quot;251.228&quot;</span><span class="p">,</span> <span class="c1"># Variable: Total potential evaporation.</span>
    <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;edmo&quot;</span><span class="p">,</span>  <span class="c1"># Data stream: Monthly mean reanalysis</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5_template</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data and load into xarray</span>
<span class="n">data_era5_waterbalance_ensemble_cds</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5</span><span class="p">,</span> <span class="n">request_era5_precipitation_edmo</span><span class="p">,</span>
                                                      <span class="n">request_era5_evaporation_edmo</span><span class="p">)</span>  <span class="c1"># Download as field list</span>

<span class="n">data_era5_waterbalance_ensemble_cds</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_ensemble_cds</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">compat</span><span class="o">=</span><span class="s2">&quot;equals&quot;</span><span class="p">)</span>  <span class="c1"># Convert to xarray dataset</span>

<span class="c1"># Pre-process to desired format</span>
<span class="c1"># Note the change in variable name</span>
<span class="n">data_era5_waterbalance_ensemble_preprocessed</span> <span class="o">=</span> <span class="n">preprocess_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_ensemble_cds</span><span class="p">)</span>

<span class="c1"># Display in notebook, both &quot;tp&quot; and &quot;pev&quot;.</span>
<span class="n">data_era5_waterbalance_ensemble_preprocessed</span> 
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 85GB
Dimensions:  (number: 10, time: 1020, lat: 721, lon: 1440)
Coordinates:
  * number   (number) int64 80B 0 1 2 3 4 5 6 7 8 9
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
  * lat      (lat) float64 6kB 90.0 89.75 89.5 89.25 ... -89.5 -89.75 -90.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
  * lon      (lon) float64 12kB -180.0 -179.8 -179.5 ... 179.2 179.5 179.8
Data variables:
    tp       (number, time, lat, lon) float32 42GB dask.array&lt;chunksize=(1, 1020, 103, 360), meta=np.ndarray&gt;
    pev      (number, time, lat, lon) float32 42GB dask.array&lt;chunksize=(1, 1020, 103, 360), meta=np.ndarray&gt;
Attributes:
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             European Centre for Medium-Range Weather Forecasts</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e607c4d6-7441-4a87-9fee-13cc73e5019d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e607c4d6-7441-4a87-9fee-13cc73e5019d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>number</span>: 10</li><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>lat</span>: 721</li><li><span class='xr-has-index'>lon</span>: 1440</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-13d39505-a2a8-44e1-b5c8-a07803bb8db0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-13d39505-a2a8-44e1-b5c8-a07803bb8db0' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>number</span></div><div class='xr-var-dims'>(number)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-918c0513-82c1-41e0-97ad-1b9ff0a0a9ca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-918c0513-82c1-41e0-97ad-1b9ff0a0a9ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b51ab3b6-cceb-42c6-b5a1-9c400aaae45a' class='xr-var-data-in' type='checkbox'><label for='data-b51ab3b6-cceb-42c6-b5a1-9c400aaae45a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-859f14b8-9da3-469d-bf1c-fc60d56b53b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-859f14b8-9da3-469d-bf1c-fc60d56b53b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27d7ea12-771b-4a5e-b6aa-fb872bb9ac5b' class='xr-var-data-in' type='checkbox'><label for='data-27d7ea12-771b-4a5e-b6aa-fb872bb9ac5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>90.0 89.75 89.5 ... -89.75 -90.0</div><input id='attrs-7c94657b-9208-46fb-8b01-fa312e177fc7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c94657b-9208-46fb-8b01-fa312e177fc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d8e294b-5103-43f3-ab1e-59455c0df9fa' class='xr-var-data-in' type='checkbox'><label for='data-5d8e294b-5103-43f3-ab1e-59455c0df9fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.75,  89.5 , ..., -89.5 , -89.75, -90.  ], shape=(721,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-4bfa5a7a-24a0-4b7b-8cf7-e736d28e4d6f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4bfa5a7a-24a0-4b7b-8cf7-e736d28e4d6f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de261d9a-0fa1-456f-9f9f-c43d849e01be' class='xr-var-data-in' type='checkbox'><label for='data-de261d9a-0fa1-456f-9f9f-c43d849e01be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-cd5271cc-f179-4f43-a00b-77c893317e55' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cd5271cc-f179-4f43-a00b-77c893317e55' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9364903f-a1c2-4d76-8ff4-d9b5b4a72f1e' class='xr-var-data-in' type='checkbox'><label for='data-9364903f-a1c2-4d76-8ff4-d9b5b4a72f1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75],
      shape=(1440,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a579a219-0775-42cb-98bd-540bb0125f07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a579a219-0775-42cb-98bd-540bb0125f07' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(number, time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-a8274a8e-8430-409e-b368-4efc32737b89' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a8274a8e-8430-409e-b368-4efc32737b89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98f5672f-e68c-4b60-bb80-041b968858c8' class='xr-var-data-in' type='checkbox'><label for='data-98f5672f-e68c-4b60-bb80-041b968858c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>228</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgad</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>359.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total precipitation</dd><dt><span>GRIB_shortName :</span></dt><dd>tp</dd><dt><span>GRIB_totalNumber :</span></dt><dd>10</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>units :</span></dt><dd>mm</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 39.45 GiB </td>
                        <td> 144.28 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020, 721, 1440) </td>
                        <td> (1, 1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 280 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="410" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >10</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="145" y2="50" style="stroke-width:2" />
  <line x1="95" y1="8" x2="145" y2="58" />
  <line x1="95" y1="17" x2="145" y2="67" />
  <line x1="95" y1="25" x2="145" y2="75" />
  <line x1="95" y1="34" x2="145" y2="84" />
  <line x1="95" y1="42" x2="145" y2="92" />
  <line x1="95" y1="51" x2="145" y2="101" />
  <line x1="95" y1="60" x2="145" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="60" style="stroke-width:2" />
  <line x1="145" y1="50" x2="145" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 145.0,50.0 145.0,110.08333333333334 95.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
  <line x1="145" y1="50" x2="265" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="145" y2="50" style="stroke-width:2" />
  <line x1="125" y1="0" x2="175" y2="50" />
  <line x1="155" y1="0" x2="205" y2="50" />
  <line x1="185" y1="0" x2="235" y2="50" />
  <line x1="215" y1="0" x2="265" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 215.0,0.0 265.0,50.0 145.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="145" y1="50" x2="265" y2="50" style="stroke-width:2" />
  <line x1="145" y1="58" x2="265" y2="58" />
  <line x1="145" y1="67" x2="265" y2="67" />
  <line x1="145" y1="75" x2="265" y2="75" />
  <line x1="145" y1="84" x2="265" y2="84" />
  <line x1="145" y1="92" x2="265" y2="92" />
  <line x1="145" y1="101" x2="265" y2="101" />
  <line x1="145" y1="110" x2="265" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="145" y1="50" x2="145" y2="110" style="stroke-width:2" />
  <line x1="175" y1="50" x2="175" y2="110" />
  <line x1="205" y1="50" x2="205" y2="110" />
  <line x1="235" y1="50" x2="235" y2="110" />
  <line x1="265" y1="50" x2="265" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="145.0,50.0 265.0,50.0 265.0,110.08333333333334 145.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="205.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="285.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,285.000000,80.041667)">721</text>
  <text x="110.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,110.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pev</span></div><div class='xr-var-dims'>(number, time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020, 103, 360), meta=np.ndarray&gt;</div><input id='attrs-91706226-eb49-4a03-8ea3-efd5e81d3397' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-91706226-eb49-4a03-8ea3-efd5e81d3397' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2cb5d5c1-2248-4df7-a611-18b7c114090b' class='xr-var-data-in' type='checkbox'><label for='data-2cb5d5c1-2248-4df7-a611-18b7c114090b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>GRIB_paramId :</span></dt><dd>228251</dd><dt><span>GRIB_dataType :</span></dt><dd>fc</dd><dt><span>GRIB_numberOfPoints :</span></dt><dd>1038240</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepUnits :</span></dt><dd>1</dd><dt><span>GRIB_stepType :</span></dt><dd>avgad</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_uvRelativeToGrid :</span></dt><dd>0</dd><dt><span>GRIB_NV :</span></dt><dd>0</dd><dt><span>GRIB_Nx :</span></dt><dd>1440</dd><dt><span>GRIB_Ny :</span></dt><dd>721</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>pev</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_iScansNegatively :</span></dt><dd>0</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jPointsAreConsecutive :</span></dt><dd>0</dd><dt><span>GRIB_jScansPositively :</span></dt><dd>0</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>90.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>-90.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>0.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>359.75</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Potential evaporation</dd><dt><span>GRIB_shortName :</span></dt><dd>pev</dd><dt><span>GRIB_totalNumber :</span></dt><dd>10</dd><dt><span>GRIB_units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Potential evaporation</dd><dt><span>units :</span></dt><dd>mm</dd><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 39.45 GiB </td>
                        <td> 144.28 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020, 721, 1440) </td>
                        <td> (1, 1020, 103, 360) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 280 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="410" height="160" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >10</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="145" y2="50" style="stroke-width:2" />
  <line x1="95" y1="8" x2="145" y2="58" />
  <line x1="95" y1="17" x2="145" y2="67" />
  <line x1="95" y1="25" x2="145" y2="75" />
  <line x1="95" y1="34" x2="145" y2="84" />
  <line x1="95" y1="42" x2="145" y2="92" />
  <line x1="95" y1="51" x2="145" y2="101" />
  <line x1="95" y1="60" x2="145" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="60" style="stroke-width:2" />
  <line x1="145" y1="50" x2="145" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 145.0,50.0 145.0,110.08333333333334 95.0,60.083333333333336" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
  <line x1="145" y1="50" x2="265" y2="50" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="145" y2="50" style="stroke-width:2" />
  <line x1="125" y1="0" x2="175" y2="50" />
  <line x1="155" y1="0" x2="205" y2="50" />
  <line x1="185" y1="0" x2="235" y2="50" />
  <line x1="215" y1="0" x2="265" y2="50" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 215.0,0.0 265.0,50.0 145.0,50.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="145" y1="50" x2="265" y2="50" style="stroke-width:2" />
  <line x1="145" y1="58" x2="265" y2="58" />
  <line x1="145" y1="67" x2="265" y2="67" />
  <line x1="145" y1="75" x2="265" y2="75" />
  <line x1="145" y1="84" x2="265" y2="84" />
  <line x1="145" y1="92" x2="265" y2="92" />
  <line x1="145" y1="101" x2="265" y2="101" />
  <line x1="145" y1="110" x2="265" y2="110" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="145" y1="50" x2="145" y2="110" style="stroke-width:2" />
  <line x1="175" y1="50" x2="175" y2="110" />
  <line x1="205" y1="50" x2="205" y2="110" />
  <line x1="235" y1="50" x2="235" y2="110" />
  <line x1="265" y1="50" x2="265" y2="110" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="145.0,50.0 265.0,50.0 265.0,110.08333333333334 145.0,110.08333333333334" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="205.000000" y="130.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" >1440</text>
  <text x="285.000000" y="80.041667" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,285.000000,80.041667)">721</text>
  <text x="110.000000" y="105.083333" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,110.000000,105.083333)">1020</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-093fc1d8-6920-402c-bc92-d4c1cea14736' class='xr-section-summary-in' type='checkbox'  ><label for='section-093fc1d8-6920-402c-bc92-d4c1cea14736' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>number</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f2a9a42f-be61-4413-9bad-305c516ad21a' class='xr-index-data-in' type='checkbox'/><label for='index-f2a9a42f-be61-4413-9bad-305c516ad21a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;number&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9f810e53-6ce1-4918-9f4f-a83a40b0842d' class='xr-index-data-in' type='checkbox'/><label for='index-9f810e53-6ce1-4918-9f4f-a83a40b0842d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8498b2a6-ce9b-427f-8177-0d2aef5ed5a5' class='xr-index-data-in' type='checkbox'/><label for='index-8498b2a6-ce9b-427f-8177-0d2aef5ed5a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.75,   89.5,  89.25,   89.0,  88.75,   88.5,  88.25,   88.0,
        87.75,
       ...
       -87.75,  -88.0, -88.25,  -88.5, -88.75,  -89.0, -89.25,  -89.5, -89.75,
        -90.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3ff58a18-0cfc-4d48-98f0-22e3828f3c1a' class='xr-index-data-in' type='checkbox'/><label for='index-3ff58a18-0cfc-4d48-98f0-22e3828f3c1a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -180.0, -179.75,  -179.5, -179.25,  -179.0, -178.75,  -178.5, -178.25,
        -178.0, -177.75,
       ...
         177.5,  177.75,   178.0,  178.25,   178.5,  178.75,   179.0,  179.25,
         179.5,  179.75],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=1440))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ac928c39-a18b-4155-aea0-b40228b2450d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ac928c39-a18b-4155-aea0-b40228b2450d' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>GRIB_subCentre :</span></dt><dd>0</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>institution :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd></dl></div></li></ul></div></div></div></div>
</details>
</div>
<p>SPI and SPEI are calculated using the
<code class="docutils literal notranslate"><span class="pre">calculate_spi_from_era5</span></code> and <code class="docutils literal notranslate"><span class="pre">calculate_spei_from_era5</span></code>
functions defined in <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-section-code-setup"><span class="std std-ref">1. Code setup</span></a>.
These functions handle the new <code class="docutils literal notranslate"><span class="pre">number</span></code> dimension by applying the full SPI / SPEI pipeline to each member independently,
just like in ERA5‚ÄìDrought.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only desired site</span>
<span class="n">data_era5_waterbalance_ensemble_preprocessed_site</span> <span class="o">=</span> <span class="n">data_era5_waterbalance_ensemble_preprocessed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Calculate SPI for example site, for all members</span>
<span class="n">spi_reproduced_site_ensemble</span> <span class="o">=</span> <span class="n">calculate_spi_from_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_ensemble_preprocessed_site</span><span class="p">,</span>
                                                       <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Calculate SPI for example site, for all members</span>
<span class="n">spei_reproduced_site_ensemble</span> <span class="o">=</span> <span class="n">calculate_spei_from_era5</span><span class="p">(</span><span class="n">data_era5_waterbalance_ensemble_preprocessed_site</span><span class="p">,</span>
                                                         <span class="n">reference_window</span><span class="o">=</span><span class="n">reference_window</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">spei_reproduced_site_ensemble</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 604kB
Dimensions:  (number: 10, time: 1020)
Coordinates:
  * number   (number) int64 80B 0 1 2 3 4 5 6 7 8 9
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    lat      float64 8B 9.0
    expver   (time) &lt;U4 16kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
    lon      float64 8B 38.75
    month    (time) int64 8kB dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;
Data variables:
    SPEI1    (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI3    (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI6    (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI12   (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI24   (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI36   (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;
    SPEI48   (number, time) float64 82kB dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ced469b1-a832-45d9-8183-a6ebe813a6cf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ced469b1-a832-45d9-8183-a6ebe813a6cf' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>number</span>: 10</li><li><span class='xr-has-index'>time</span>: 1020</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-50ff3cec-6c47-43f3-b144-07d47a894190' class='xr-section-summary-in' type='checkbox'  checked><label for='section-50ff3cec-6c47-43f3-b144-07d47a894190' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>number</span></div><div class='xr-var-dims'>(number)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-291df10c-611b-47be-aa10-f85d6fe5ad8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-291df10c-611b-47be-aa10-f85d6fe5ad8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89a4a483-e392-4c96-a5be-1495e73b3bb8' class='xr-var-data-in' type='checkbox'><label for='data-89a4a483-e392-4c96-a5be-1495e73b3bb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ensemble member numerical id</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>standard_name :</span></dt><dd>realization</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-12eaca2b-af8b-4ada-9e1c-f2cee3168998' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12eaca2b-af8b-4ada-9e1c-f2cee3168998' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6370eb86-0ced-468a-bbcd-06fc44aca854' class='xr-var-data-in' type='checkbox'><label for='data-6370eb86-0ced-468a-bbcd-06fc44aca854' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-19ebd906-598b-4f95-bca2-3166ba7aa7dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19ebd906-598b-4f95-bca2-3166ba7aa7dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf6123a1-9c0b-46f5-b2fd-4b2a956be23b' class='xr-var-data-in' type='checkbox'><label for='data-bf6123a1-9c0b-46f5-b2fd-4b2a956be23b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expver</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-c11595c8-3979-472d-a764-5068b3a6baa9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c11595c8-3979-472d-a764-5068b3a6baa9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd5b7b8e-b9b6-45cf-a76d-1c046c0bbd55' class='xr-var-data-in' type='checkbox'><label for='data-dd5b7b8e-b9b6-45cf-a76d-1c046c0bbd55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 15.94 kiB </td>
                        <td> 15.94 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U4 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-bacd2117-3b33-48b9-8568-49530cc1e8c3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bacd2117-3b33-48b9-8568-49530cc1e8c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6d368e9-0342-40e1-94eb-3c9324c53ced' class='xr-var-data-in' type='checkbox'><label for='data-e6d368e9-0342-40e1-94eb-3c9324c53ced' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>month</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1020,), meta=np.ndarray&gt;</div><input id='attrs-ae6be571-ee59-4ace-8918-96b0da76ac5b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ae6be571-ee59-4ace-8918-96b0da76ac5b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae4ac0ea-e1f0-4e2a-b838-136df293fd4b' class='xr-var-data-in' type='checkbox'><label for='data-ae4ac0ea-e1f0-4e2a-b838-136df293fd4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 7.97 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1020,) </td>
                        <td> (1020,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1 graph layer </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> int64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ca92bcf1-1b40-4560-9a35-fb4a8599efc2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ca92bcf1-1b40-4560-9a35-fb4a8599efc2' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-d7373bff-21f3-4642-87dd-73356ccfaf9a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d7373bff-21f3-4642-87dd-73356ccfaf9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38e19475-421d-4a37-9833-39482665cc0a' class='xr-var-data-in' type='checkbox'><label for='data-38e19475-421d-4a37-9833-39482665cc0a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 112 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-8f5d83cf-09f6-4b36-ba06-09066de49ad7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8f5d83cf-09f6-4b36-ba06-09066de49ad7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b0f2d87-77ab-4887-9131-65077bcc3cf2' class='xr-var-data-in' type='checkbox'><label for='data-7b0f2d87-77ab-4887-9131-65077bcc3cf2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-72ae625d-a40e-4246-86bf-e24e840b0dc2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72ae625d-a40e-4246-86bf-e24e840b0dc2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8eae3a12-0c6e-42da-b0b5-fae005698264' class='xr-var-data-in' type='checkbox'><label for='data-8eae3a12-0c6e-42da-b0b5-fae005698264' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-5c2a9150-d250-42c6-a587-989bce044128' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5c2a9150-d250-42c6-a587-989bce044128' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57751589-35dc-4f5c-a320-deda10aff7fd' class='xr-var-data-in' type='checkbox'><label for='data-57751589-35dc-4f5c-a320-deda10aff7fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-bf5fb4c8-92a6-4bb8-b22d-4c9c71d6850f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf5fb4c8-92a6-4bb8-b22d-4c9c71d6850f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c19aa47-8985-42c4-ab9c-0f784bb74582' class='xr-var-data-in' type='checkbox'><label for='data-0c19aa47-8985-42c4-ab9c-0f784bb74582' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-f074497a-52a4-4b6d-9b61-ed125073e6d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f074497a-52a4-4b6d-9b61-ed125073e6d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1767725-1e4a-46e8-8c1d-10b459040224' class='xr-var-data-in' type='checkbox'><label for='data-a1767725-1e4a-46e8-8c1d-10b459040224' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1020), meta=np.ndarray&gt;</div><input id='attrs-3e8eb0cd-a736-44a1-9242-d9635ec10c40' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3e8eb0cd-a736-44a1-9242-d9635ec10c40' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ca22609-52e4-4b87-a119-7202838ed671' class='xr-var-data-in' type='checkbox'><label for='data-1ca22609-52e4-4b87-a119-7202838ed671' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 7.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (1, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 10 chunks in 119 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="2" x2="120" y2="2" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="12" x2="120" y2="12" />
  <line x1="0" y1="15" x2="120" y2="15" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="22" x2="120" y2="22" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-820b9a4d-5da5-4ebf-9bc4-37c1e3c5d363' class='xr-section-summary-in' type='checkbox'  ><label for='section-820b9a4d-5da5-4ebf-9bc4-37c1e3c5d363' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>number</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1a959f42-5e16-4276-997c-9f4c37c62e75' class='xr-index-data-in' type='checkbox'/><label for='index-1a959f42-5e16-4276-997c-9f4c37c62e75' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;number&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fbdfb04f-4558-4535-ac44-da7c652d0329' class='xr-index-data-in' type='checkbox'/><label for='index-fbdfb04f-4558-4535-ac44-da7c652d0329' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5e8ccfd4-99c1-46e6-aadf-4618cd26a701' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5e8ccfd4-99c1-46e6-aadf-4618cd26a701' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="download-spi-and-spei-ensembles-from-era5drought">
<h4>5.2 Download SPI and SPEI ensembles from ERA5‚ÄìDrought<a class="headerlink" href="#download-spi-and-spei-ensembles-from-era5drought" title="Link to this heading">#</a></h4>
<p>Next, we download the SPI and SPEI ensemble data from ERA5‚ÄìDrought.
Unlike in ERA5,
the ensemble is not represented through a separate <code class="docutils literal notranslate"><span class="pre">number</span></code> dimension,
but instead using 10-duplicate entries in the <code class="docutils literal notranslate"><span class="pre">time</span></code> dimension.
To simplify the analysis,
we restructure the downloaded dataset to match ERA5‚Äôs setup:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Main request, based on template and example site</span>
<span class="n">request_era5drought_spi_ensemble</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index_ensemble</span> <span class="o">|</span> <span class="n">request_site</span>

<span class="n">request_era5drought_spei_ensemble</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;standardised_precipitation_evapotranspiration_index&quot;</span><span class="p">],</span>
<span class="p">}</span> <span class="o">|</span> <span class="n">request_era5drought_index_ensemble</span> <span class="o">|</span> <span class="n">request_site</span>

<span class="c1"># Split into batches per accumulation period</span>
<span class="n">subrequests_era5drought_spi_ensemble</span>  <span class="o">=</span> <span class="n">batch_requests</span><span class="p">(</span><span class="n">request_era5drought_spi_ensemble</span><span class="p">,</span>  <span class="n">batch_key</span><span class="o">=</span><span class="s2">&quot;accumulation_period&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">subrequests_era5drought_spei_ensemble</span> <span class="o">=</span> <span class="n">batch_requests</span><span class="p">(</span><span class="n">request_era5drought_spei_ensemble</span><span class="p">,</span> <span class="n">batch_key</span><span class="o">=</span><span class="s2">&quot;accumulation_period&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download SPI data and load into xarray</span>
<span class="n">spi_era5drought_site_ensemble</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="o">*</span><span class="n">subrequests_era5drought_spi_ensemble</span><span class="p">)</span>
<span class="n">spi_era5drought_site_ensemble</span> <span class="o">=</span> <span class="n">preprocess_era5drought_ensemble</span><span class="p">(</span><span class="n">spi_era5drought_site_ensemble</span><span class="p">)</span>  <span class="c1"># Handle number dimension, combine into one dataset</span>

<span class="c1"># Download SPEI data and load into xarray</span>
<span class="n">spei_era5drought_site_ensemble</span> <span class="o">=</span> <span class="n">ekd</span><span class="o">.</span><span class="n">from_source</span><span class="p">(</span><span class="s2">&quot;cds&quot;</span><span class="p">,</span> <span class="n">ID_ERA5_DROUGHT</span><span class="p">,</span> <span class="o">*</span><span class="n">subrequests_era5drought_spei_ensemble</span><span class="p">)</span>
<span class="n">spei_era5drought_site_ensemble</span> <span class="o">=</span> <span class="n">preprocess_era5drought_ensemble</span><span class="p">(</span><span class="n">spei_era5drought_site_ensemble</span><span class="p">)</span>  <span class="c1"># Handle number dimension, combine into one dataset</span>

<span class="c1"># Select only desired site (remove margins)</span>
<span class="n">spi_era5drought_site_ensemble</span>  <span class="o">=</span>  <span class="n">spi_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>
<span class="n">spei_era5drought_site_ensemble</span> <span class="o">=</span> <span class="n">spei_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">example_site</span><span class="p">)</span>

<span class="c1"># Display result</span>
<span class="n">spei_era5drought_site_ensemble</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 579kB
Dimensions:  (time: 1020, number: 10)
Coordinates:
  * time     (time) datetime64[ns] 8kB 1940-01-01T06:00:00 ... 2024-12-01T06:...
    lon      float64 8B 38.75
    lat      float64 8B 9.0
  * number   (number) int64 80B 0 1 2 3 4 5 6 7 8 9
Data variables:
    SPEI1    (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI3    (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI6    (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI12   (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI24   (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI36   (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;
    SPEI48   (number, time) float64 82kB dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0beed516-9b0a-4ba4-91c2-21eabc6c27d3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0beed516-9b0a-4ba4-91c2-21eabc6c27d3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1020</li><li><span class='xr-has-index'>number</span>: 10</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-edd997e8-872b-418c-8878-da747481b71b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-edd997e8-872b-418c-8878-da747481b71b' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1940-01-01T06:00:00 ... 2024-12-...</div><input id='attrs-9ad9dcda-691f-471c-aae2-127f62e4eaf7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9ad9dcda-691f-471c-aae2-127f62e4eaf7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa67ef9a-13f2-4b7f-b8e1-a542545dfb5b' class='xr-var-data-in' type='checkbox'><label for='data-aa67ef9a-13f2-4b7f-b8e1-a542545dfb5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1940-01-01T06:00:00.000000000&#x27;, &#x27;1940-02-01T06:00:00.000000000&#x27;,
       &#x27;1940-03-01T06:00:00.000000000&#x27;, ..., &#x27;2024-10-01T06:00:00.000000000&#x27;,
       &#x27;2024-11-01T06:00:00.000000000&#x27;, &#x27;2024-12-01T06:00:00.000000000&#x27;],
      shape=(1020,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>38.75</div><input id='attrs-956ec0c1-e1fe-4acf-8c0e-6852d48ddd21' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-956ec0c1-e1fe-4acf-8c0e-6852d48ddd21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a8669833-49a1-45e8-a407-9e37f5a19676' class='xr-var-data-in' type='checkbox'><label for='data-a8669833-49a1-45e8-a407-9e37f5a19676' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(38.75)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.0</div><input id='attrs-e34fa0ce-1a77-4dc3-872a-cdad72cfe67e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e34fa0ce-1a77-4dc3-872a-cdad72cfe67e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ce89344-4d89-48b7-9403-c1489ab6500b' class='xr-var-data-in' type='checkbox'><label for='data-5ce89344-4d89-48b7-9403-c1489ab6500b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(9.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>number</span></div><div class='xr-var-dims'>(number)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9</div><input id='attrs-6510946c-fd88-42ac-8650-4758a9877e7e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6510946c-fd88-42ac-8650-4758a9877e7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ca9e2d1-4de5-4e1d-b488-5e8ea7279cbb' class='xr-var-data-in' type='checkbox'><label for='data-9ca9e2d1-4de5-4e1d-b488-5e8ea7279cbb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f69d4624-a609-4bd1-8a2d-004b10dfc994' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f69d4624-a609-4bd1-8a2d-004b10dfc994' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>SPEI1</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-6f9d63ed-07e2-4cc9-b1bb-70897d432aba' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f9d63ed-07e2-4cc9-b1bb-70897d432aba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12f93797-579b-4c82-8547-0a0328b44ca3' class='xr-var-data-in' type='checkbox'><label for='data-12f93797-579b-4c82-8547-0a0328b44ca3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1023 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI3</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-df69ee57-a93a-4458-8176-80a62174e3d4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-df69ee57-a93a-4458-8176-80a62174e3d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8373df13-8001-4771-8aa0-e29c142dd365' class='xr-var-data-in' type='checkbox'><label for='data-8373df13-8001-4771-8aa0-e29c142dd365' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1035 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI6</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-86e5788a-00e0-442c-bd7c-8a301a6be75c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-86e5788a-00e0-442c-bd7c-8a301a6be75c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25c7254f-a22d-4433-ab13-d9587950ab92' class='xr-var-data-in' type='checkbox'><label for='data-25c7254f-a22d-4433-ab13-d9587950ab92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1032 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI12</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-75704d05-2ea3-477e-84ec-4ba78242afb3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-75704d05-2ea3-477e-84ec-4ba78242afb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d95a3f71-a1d6-4032-81b2-8ed1dffad04f' class='xr-var-data-in' type='checkbox'><label for='data-d95a3f71-a1d6-4032-81b2-8ed1dffad04f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1026 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI24</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-905af4f1-decd-4371-a64c-bda0644b6155' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-905af4f1-decd-4371-a64c-bda0644b6155' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c1fbba3a-d9ae-45b4-83b1-2682738dbc53' class='xr-var-data-in' type='checkbox'><label for='data-c1fbba3a-d9ae-45b4-83b1-2682738dbc53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1014 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI36</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-52dd0c23-d57f-4bd4-b164-a1ecbe2dc4dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-52dd0c23-d57f-4bd4-b164-a1ecbe2dc4dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7195585-18c0-43a9-8f76-46ca7f6c44fd' class='xr-var-data-in' type='checkbox'><label for='data-b7195585-18c0-43a9-8f76-46ca7f6c44fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 1002 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>SPEI48</span></div><div class='xr-var-dims'>(number, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(10, 1020), meta=np.ndarray&gt;</div><input id='attrs-c820b41d-01dc-4df8-a9a9-6cf9ee2e6545' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c820b41d-01dc-4df8-a9a9-6cf9ee2e6545' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bcee57b-2420-417c-be22-c44c6cfe7f6a' class='xr-var-data-in' type='checkbox'><label for='data-2bcee57b-2420-417c-be22-c44c6cfe7f6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 79.69 kiB </td>
                        <td> 79.69 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 1020) </td>
                        <td> (10, 1020) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 990 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >1020</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">10</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-8bfb944b-0d09-47ce-8f7a-f56ea3eea32d' class='xr-section-summary-in' type='checkbox'  ><label for='section-8bfb944b-0d09-47ce-8f7a-f56ea3eea32d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9098afa6-12ed-45a3-927e-b5e5ecd573bf' class='xr-index-data-in' type='checkbox'/><label for='index-9098afa6-12ed-45a3-927e-b5e5ecd573bf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1940-01-01 06:00:00&#x27;, &#x27;1940-02-01 06:00:00&#x27;,
               &#x27;1940-03-01 06:00:00&#x27;, &#x27;1940-04-01 06:00:00&#x27;,
               &#x27;1940-05-01 06:00:00&#x27;, &#x27;1940-06-01 06:00:00&#x27;,
               &#x27;1940-07-01 06:00:00&#x27;, &#x27;1940-08-01 06:00:00&#x27;,
               &#x27;1940-09-01 06:00:00&#x27;, &#x27;1940-10-01 06:00:00&#x27;,
               ...
               &#x27;2024-03-01 06:00:00&#x27;, &#x27;2024-04-01 06:00:00&#x27;,
               &#x27;2024-05-01 06:00:00&#x27;, &#x27;2024-06-01 06:00:00&#x27;,
               &#x27;2024-07-01 06:00:00&#x27;, &#x27;2024-08-01 06:00:00&#x27;,
               &#x27;2024-09-01 06:00:00&#x27;, &#x27;2024-10-01 06:00:00&#x27;,
               &#x27;2024-11-01 06:00:00&#x27;, &#x27;2024-12-01 06:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=1020, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>number</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-711c9c2c-335b-4819-bd0a-22d29ac80de2' class='xr-index-data-in' type='checkbox'/><label for='index-711c9c2c-335b-4819-bd0a-22d29ac80de2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=&#x27;int64&#x27;, name=&#x27;number&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38e4c11d-0114-4e69-b3b1-bb728e45a9d9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-38e4c11d-0114-4e69-b3b1-bb728e45a9d9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</details>
</div>
</section>
<section id="ensemble-comparison-time-series-in-example-site">
<h4>5.3 Ensemble comparison: Time series in example site<a class="headerlink" href="#ensemble-comparison-time-series-in-example-site" title="Link to this heading">#</a></h4>
<p>As before,
we examine the per-point difference in SPI and SPEI between ERA5‚ÄìDrought and the reproduction for each calendar month and each accumulation period.</p>
<section id="control-member">
<h5>Control member<a class="headerlink" href="#control-member" title="Link to this heading">#</a></h5>
<p>First, we compare ERA5‚ÄìDrought and the reproduction for the first ensemble member only.
This member is the control,
initialised with the same conditions as the main reanalysis
(which was analysed in the previous sections)
but run at the reduced resolution of the ERA5-EDA ensemble [<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>]
and then regridded to 0.25¬∞ by 0.25¬∞ in ERA5‚ÄìDrought [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI median differences</span>
<span class="n">spi_difference_site_onemember</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spi_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                                                              <span class="n">spi_reproduced_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spi_difference_site_onemember</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_612d4 th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_612d4 th.col_heading {
  border-bottom: 0;
}
#T_612d4 table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_612d4 th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_612d4_row0_col0, #T_612d4_row0_col3, #T_612d4_row0_col6, #T_612d4_row0_col9, #T_612d4_row0_col12, #T_612d4_row0_col15, #T_612d4_row0_col18, #T_612d4_row1_col0, #T_612d4_row1_col3, #T_612d4_row1_col6, #T_612d4_row1_col9, #T_612d4_row1_col12, #T_612d4_row1_col15, #T_612d4_row1_col18, #T_612d4_row2_col0, #T_612d4_row2_col3, #T_612d4_row2_col6, #T_612d4_row2_col9, #T_612d4_row2_col12, #T_612d4_row2_col15, #T_612d4_row2_col18, #T_612d4_row3_col0, #T_612d4_row3_col3, #T_612d4_row3_col6, #T_612d4_row3_col9, #T_612d4_row3_col12, #T_612d4_row3_col15, #T_612d4_row3_col18, #T_612d4_row4_col0, #T_612d4_row4_col3, #T_612d4_row4_col6, #T_612d4_row4_col9, #T_612d4_row4_col12, #T_612d4_row4_col15, #T_612d4_row4_col18, #T_612d4_row5_col0, #T_612d4_row5_col3, #T_612d4_row5_col6, #T_612d4_row5_col9, #T_612d4_row5_col12, #T_612d4_row5_col15, #T_612d4_row5_col18, #T_612d4_row6_col0, #T_612d4_row6_col3, #T_612d4_row6_col6, #T_612d4_row6_col9, #T_612d4_row6_col12, #T_612d4_row6_col15, #T_612d4_row6_col18, #T_612d4_row7_col0, #T_612d4_row7_col3, #T_612d4_row7_col6, #T_612d4_row7_col9, #T_612d4_row7_col12, #T_612d4_row7_col15, #T_612d4_row7_col18, #T_612d4_row8_col0, #T_612d4_row8_col3, #T_612d4_row8_col6, #T_612d4_row8_col9, #T_612d4_row8_col12, #T_612d4_row8_col15, #T_612d4_row8_col18, #T_612d4_row9_col0, #T_612d4_row9_col3, #T_612d4_row9_col6, #T_612d4_row9_col9, #T_612d4_row9_col12, #T_612d4_row9_col15, #T_612d4_row9_col18, #T_612d4_row10_col0, #T_612d4_row10_col3, #T_612d4_row10_col6, #T_612d4_row10_col9, #T_612d4_row10_col12, #T_612d4_row10_col15, #T_612d4_row10_col18, #T_612d4_row11_col0, #T_612d4_row11_col3, #T_612d4_row11_col6, #T_612d4_row11_col9, #T_612d4_row11_col12, #T_612d4_row11_col15, #T_612d4_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_612d4">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_612d4_level0_col0" class="col_heading level0 col0" colspan="3">SPI-1</th>
      <th id="T_612d4_level0_col3" class="col_heading level0 col3" colspan="3">SPI-3</th>
      <th id="T_612d4_level0_col6" class="col_heading level0 col6" colspan="3">SPI-6</th>
      <th id="T_612d4_level0_col9" class="col_heading level0 col9" colspan="3">SPI-12</th>
      <th id="T_612d4_level0_col12" class="col_heading level0 col12" colspan="3">SPI-24</th>
      <th id="T_612d4_level0_col15" class="col_heading level0 col15" colspan="3">SPI-36</th>
      <th id="T_612d4_level0_col18" class="col_heading level0 col18" colspan="3">SPI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_612d4_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_612d4_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_612d4_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_612d4_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_612d4_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_612d4_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_612d4_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_612d4_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_612d4_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_612d4_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_612d4_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_612d4_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_612d4_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_612d4_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_612d4_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_612d4_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_612d4_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_612d4_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_612d4_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_612d4_row0_col2" class="data row0 col2" >0.0000</td>
      <td id="T_612d4_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_612d4_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_612d4_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_612d4_row0_col6" class="data row0 col6" >0.0001</td>
      <td id="T_612d4_row0_col7" class="data row0 col7" >0.0001</td>
      <td id="T_612d4_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_612d4_row0_col9" class="data row0 col9" >0.0000</td>
      <td id="T_612d4_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_612d4_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_612d4_row0_col12" class="data row0 col12" >-0.0040</td>
      <td id="T_612d4_row0_col13" class="data row0 col13" >0.0040</td>
      <td id="T_612d4_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_612d4_row0_col15" class="data row0 col15" >-0.0002</td>
      <td id="T_612d4_row0_col16" class="data row0 col16" >0.0002</td>
      <td id="T_612d4_row0_col17" class="data row0 col17" >1.1765</td>
      <td id="T_612d4_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_612d4_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_612d4_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_612d4_row1_col0" class="data row1 col0" >0.0000</td>
      <td id="T_612d4_row1_col1" class="data row1 col1" >0.0000</td>
      <td id="T_612d4_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_612d4_row1_col3" class="data row1 col3" >0.0000</td>
      <td id="T_612d4_row1_col4" class="data row1 col4" >0.0000</td>
      <td id="T_612d4_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_612d4_row1_col6" class="data row1 col6" >0.0000</td>
      <td id="T_612d4_row1_col7" class="data row1 col7" >0.0000</td>
      <td id="T_612d4_row1_col8" class="data row1 col8" >0.0000</td>
      <td id="T_612d4_row1_col9" class="data row1 col9" >0.0000</td>
      <td id="T_612d4_row1_col10" class="data row1 col10" >0.0000</td>
      <td id="T_612d4_row1_col11" class="data row1 col11" >0.0000</td>
      <td id="T_612d4_row1_col12" class="data row1 col12" >0.0001</td>
      <td id="T_612d4_row1_col13" class="data row1 col13" >0.0001</td>
      <td id="T_612d4_row1_col14" class="data row1 col14" >1.1765</td>
      <td id="T_612d4_row1_col15" class="data row1 col15" >0.0000</td>
      <td id="T_612d4_row1_col16" class="data row1 col16" >0.0000</td>
      <td id="T_612d4_row1_col17" class="data row1 col17" >0.0000</td>
      <td id="T_612d4_row1_col18" class="data row1 col18" >0.0000</td>
      <td id="T_612d4_row1_col19" class="data row1 col19" >0.0000</td>
      <td id="T_612d4_row1_col20" class="data row1 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_612d4_row2_col0" class="data row2 col0" >0.0000</td>
      <td id="T_612d4_row2_col1" class="data row2 col1" >0.0000</td>
      <td id="T_612d4_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_612d4_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_612d4_row2_col4" class="data row2 col4" >0.0000</td>
      <td id="T_612d4_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_612d4_row2_col6" class="data row2 col6" >-0.0000</td>
      <td id="T_612d4_row2_col7" class="data row2 col7" >0.0000</td>
      <td id="T_612d4_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_612d4_row2_col9" class="data row2 col9" >0.0010</td>
      <td id="T_612d4_row2_col10" class="data row2 col10" >0.0021</td>
      <td id="T_612d4_row2_col11" class="data row2 col11" >0.0000</td>
      <td id="T_612d4_row2_col12" class="data row2 col12" >0.0000</td>
      <td id="T_612d4_row2_col13" class="data row2 col13" >0.0000</td>
      <td id="T_612d4_row2_col14" class="data row2 col14" >0.0000</td>
      <td id="T_612d4_row2_col15" class="data row2 col15" >0.0000</td>
      <td id="T_612d4_row2_col16" class="data row2 col16" >0.0000</td>
      <td id="T_612d4_row2_col17" class="data row2 col17" >0.0000</td>
      <td id="T_612d4_row2_col18" class="data row2 col18" >0.0000</td>
      <td id="T_612d4_row2_col19" class="data row2 col19" >0.0000</td>
      <td id="T_612d4_row2_col20" class="data row2 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_612d4_row3_col0" class="data row3 col0" >0.0000</td>
      <td id="T_612d4_row3_col1" class="data row3 col1" >0.0000</td>
      <td id="T_612d4_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_612d4_row3_col3" class="data row3 col3" >0.0000</td>
      <td id="T_612d4_row3_col4" class="data row3 col4" >0.0000</td>
      <td id="T_612d4_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_612d4_row3_col6" class="data row3 col6" >0.0048</td>
      <td id="T_612d4_row3_col7" class="data row3 col7" >0.0048</td>
      <td id="T_612d4_row3_col8" class="data row3 col8" >0.0000</td>
      <td id="T_612d4_row3_col9" class="data row3 col9" >0.0000</td>
      <td id="T_612d4_row3_col10" class="data row3 col10" >0.0000</td>
      <td id="T_612d4_row3_col11" class="data row3 col11" >0.0000</td>
      <td id="T_612d4_row3_col12" class="data row3 col12" >0.0000</td>
      <td id="T_612d4_row3_col13" class="data row3 col13" >0.0000</td>
      <td id="T_612d4_row3_col14" class="data row3 col14" >0.0000</td>
      <td id="T_612d4_row3_col15" class="data row3 col15" >0.0000</td>
      <td id="T_612d4_row3_col16" class="data row3 col16" >0.0000</td>
      <td id="T_612d4_row3_col17" class="data row3 col17" >1.1765</td>
      <td id="T_612d4_row3_col18" class="data row3 col18" >0.0000</td>
      <td id="T_612d4_row3_col19" class="data row3 col19" >0.0000</td>
      <td id="T_612d4_row3_col20" class="data row3 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_612d4_row4_col0" class="data row4 col0" >-0.0008</td>
      <td id="T_612d4_row4_col1" class="data row4 col1" >0.0027</td>
      <td id="T_612d4_row4_col2" class="data row4 col2" >0.0000</td>
      <td id="T_612d4_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_612d4_row4_col4" class="data row4 col4" >0.0000</td>
      <td id="T_612d4_row4_col5" class="data row4 col5" >0.0000</td>
      <td id="T_612d4_row4_col6" class="data row4 col6" >0.0000</td>
      <td id="T_612d4_row4_col7" class="data row4 col7" >0.0000</td>
      <td id="T_612d4_row4_col8" class="data row4 col8" >0.0000</td>
      <td id="T_612d4_row4_col9" class="data row4 col9" >0.0000</td>
      <td id="T_612d4_row4_col10" class="data row4 col10" >0.0000</td>
      <td id="T_612d4_row4_col11" class="data row4 col11" >0.0000</td>
      <td id="T_612d4_row4_col12" class="data row4 col12" >0.0000</td>
      <td id="T_612d4_row4_col13" class="data row4 col13" >0.0000</td>
      <td id="T_612d4_row4_col14" class="data row4 col14" >0.0000</td>
      <td id="T_612d4_row4_col15" class="data row4 col15" >0.0000</td>
      <td id="T_612d4_row4_col16" class="data row4 col16" >0.0000</td>
      <td id="T_612d4_row4_col17" class="data row4 col17" >0.0000</td>
      <td id="T_612d4_row4_col18" class="data row4 col18" >0.0000</td>
      <td id="T_612d4_row4_col19" class="data row4 col19" >0.0000</td>
      <td id="T_612d4_row4_col20" class="data row4 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_612d4_row5_col0" class="data row5 col0" >0.0000</td>
      <td id="T_612d4_row5_col1" class="data row5 col1" >0.0000</td>
      <td id="T_612d4_row5_col2" class="data row5 col2" >0.0000</td>
      <td id="T_612d4_row5_col3" class="data row5 col3" >-0.0018</td>
      <td id="T_612d4_row5_col4" class="data row5 col4" >0.0020</td>
      <td id="T_612d4_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_612d4_row5_col6" class="data row5 col6" >0.0000</td>
      <td id="T_612d4_row5_col7" class="data row5 col7" >0.0000</td>
      <td id="T_612d4_row5_col8" class="data row5 col8" >0.0000</td>
      <td id="T_612d4_row5_col9" class="data row5 col9" >0.0000</td>
      <td id="T_612d4_row5_col10" class="data row5 col10" >0.0000</td>
      <td id="T_612d4_row5_col11" class="data row5 col11" >0.0000</td>
      <td id="T_612d4_row5_col12" class="data row5 col12" >0.0000</td>
      <td id="T_612d4_row5_col13" class="data row5 col13" >0.0000</td>
      <td id="T_612d4_row5_col14" class="data row5 col14" >0.0000</td>
      <td id="T_612d4_row5_col15" class="data row5 col15" >0.0000</td>
      <td id="T_612d4_row5_col16" class="data row5 col16" >0.0000</td>
      <td id="T_612d4_row5_col17" class="data row5 col17" >0.0000</td>
      <td id="T_612d4_row5_col18" class="data row5 col18" >0.0000</td>
      <td id="T_612d4_row5_col19" class="data row5 col19" >0.0000</td>
      <td id="T_612d4_row5_col20" class="data row5 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_612d4_row6_col0" class="data row6 col0" >0.0000</td>
      <td id="T_612d4_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_612d4_row6_col2" class="data row6 col2" >1.1765</td>
      <td id="T_612d4_row6_col3" class="data row6 col3" >0.0089</td>
      <td id="T_612d4_row6_col4" class="data row6 col4" >0.0089</td>
      <td id="T_612d4_row6_col5" class="data row6 col5" >0.0000</td>
      <td id="T_612d4_row6_col6" class="data row6 col6" >0.0000</td>
      <td id="T_612d4_row6_col7" class="data row6 col7" >0.0000</td>
      <td id="T_612d4_row6_col8" class="data row6 col8" >0.0000</td>
      <td id="T_612d4_row6_col9" class="data row6 col9" >0.0000</td>
      <td id="T_612d4_row6_col10" class="data row6 col10" >0.0000</td>
      <td id="T_612d4_row6_col11" class="data row6 col11" >0.0000</td>
      <td id="T_612d4_row6_col12" class="data row6 col12" >0.0000</td>
      <td id="T_612d4_row6_col13" class="data row6 col13" >0.0000</td>
      <td id="T_612d4_row6_col14" class="data row6 col14" >0.0000</td>
      <td id="T_612d4_row6_col15" class="data row6 col15" >0.0000</td>
      <td id="T_612d4_row6_col16" class="data row6 col16" >0.0000</td>
      <td id="T_612d4_row6_col17" class="data row6 col17" >1.1765</td>
      <td id="T_612d4_row6_col18" class="data row6 col18" >0.0000</td>
      <td id="T_612d4_row6_col19" class="data row6 col19" >0.0000</td>
      <td id="T_612d4_row6_col20" class="data row6 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_612d4_row7_col0" class="data row7 col0" >0.0000</td>
      <td id="T_612d4_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_612d4_row7_col2" class="data row7 col2" >0.0000</td>
      <td id="T_612d4_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_612d4_row7_col4" class="data row7 col4" >0.0000</td>
      <td id="T_612d4_row7_col5" class="data row7 col5" >0.0000</td>
      <td id="T_612d4_row7_col6" class="data row7 col6" >0.0000</td>
      <td id="T_612d4_row7_col7" class="data row7 col7" >0.0000</td>
      <td id="T_612d4_row7_col8" class="data row7 col8" >0.0000</td>
      <td id="T_612d4_row7_col9" class="data row7 col9" >0.0000</td>
      <td id="T_612d4_row7_col10" class="data row7 col10" >0.0000</td>
      <td id="T_612d4_row7_col11" class="data row7 col11" >0.0000</td>
      <td id="T_612d4_row7_col12" class="data row7 col12" >0.0000</td>
      <td id="T_612d4_row7_col13" class="data row7 col13" >0.0000</td>
      <td id="T_612d4_row7_col14" class="data row7 col14" >0.0000</td>
      <td id="T_612d4_row7_col15" class="data row7 col15" >0.0000</td>
      <td id="T_612d4_row7_col16" class="data row7 col16" >0.0000</td>
      <td id="T_612d4_row7_col17" class="data row7 col17" >0.0000</td>
      <td id="T_612d4_row7_col18" class="data row7 col18" >0.0000</td>
      <td id="T_612d4_row7_col19" class="data row7 col19" >0.0000</td>
      <td id="T_612d4_row7_col20" class="data row7 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_612d4_row8_col0" class="data row8 col0" >0.0001</td>
      <td id="T_612d4_row8_col1" class="data row8 col1" >0.0001</td>
      <td id="T_612d4_row8_col2" class="data row8 col2" >0.0000</td>
      <td id="T_612d4_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_612d4_row8_col4" class="data row8 col4" >0.0000</td>
      <td id="T_612d4_row8_col5" class="data row8 col5" >0.0000</td>
      <td id="T_612d4_row8_col6" class="data row8 col6" >0.0000</td>
      <td id="T_612d4_row8_col7" class="data row8 col7" >0.0000</td>
      <td id="T_612d4_row8_col8" class="data row8 col8" >0.0000</td>
      <td id="T_612d4_row8_col9" class="data row8 col9" >-0.0004</td>
      <td id="T_612d4_row8_col10" class="data row8 col10" >0.0010</td>
      <td id="T_612d4_row8_col11" class="data row8 col11" >0.0000</td>
      <td id="T_612d4_row8_col12" class="data row8 col12" >0.0000</td>
      <td id="T_612d4_row8_col13" class="data row8 col13" >0.0000</td>
      <td id="T_612d4_row8_col14" class="data row8 col14" >0.0000</td>
      <td id="T_612d4_row8_col15" class="data row8 col15" >0.0000</td>
      <td id="T_612d4_row8_col16" class="data row8 col16" >0.0000</td>
      <td id="T_612d4_row8_col17" class="data row8 col17" >0.0000</td>
      <td id="T_612d4_row8_col18" class="data row8 col18" >0.0000</td>
      <td id="T_612d4_row8_col19" class="data row8 col19" >0.0000</td>
      <td id="T_612d4_row8_col20" class="data row8 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_612d4_row9_col0" class="data row9 col0" >0.0000</td>
      <td id="T_612d4_row9_col1" class="data row9 col1" >0.0000</td>
      <td id="T_612d4_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_612d4_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_612d4_row9_col4" class="data row9 col4" >0.0000</td>
      <td id="T_612d4_row9_col5" class="data row9 col5" >0.0000</td>
      <td id="T_612d4_row9_col6" class="data row9 col6" >0.0000</td>
      <td id="T_612d4_row9_col7" class="data row9 col7" >0.0000</td>
      <td id="T_612d4_row9_col8" class="data row9 col8" >0.0000</td>
      <td id="T_612d4_row9_col9" class="data row9 col9" >0.0000</td>
      <td id="T_612d4_row9_col10" class="data row9 col10" >0.0000</td>
      <td id="T_612d4_row9_col11" class="data row9 col11" >0.0000</td>
      <td id="T_612d4_row9_col12" class="data row9 col12" >0.0000</td>
      <td id="T_612d4_row9_col13" class="data row9 col13" >0.0000</td>
      <td id="T_612d4_row9_col14" class="data row9 col14" >0.0000</td>
      <td id="T_612d4_row9_col15" class="data row9 col15" >0.0000</td>
      <td id="T_612d4_row9_col16" class="data row9 col16" >0.0000</td>
      <td id="T_612d4_row9_col17" class="data row9 col17" >1.1765</td>
      <td id="T_612d4_row9_col18" class="data row9 col18" >0.0000</td>
      <td id="T_612d4_row9_col19" class="data row9 col19" >0.0000</td>
      <td id="T_612d4_row9_col20" class="data row9 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_612d4_row10_col0" class="data row10 col0" >0.0000</td>
      <td id="T_612d4_row10_col1" class="data row10 col1" >0.0000</td>
      <td id="T_612d4_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_612d4_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_612d4_row10_col4" class="data row10 col4" >0.0000</td>
      <td id="T_612d4_row10_col5" class="data row10 col5" >0.0000</td>
      <td id="T_612d4_row10_col6" class="data row10 col6" >0.0000</td>
      <td id="T_612d4_row10_col7" class="data row10 col7" >0.0000</td>
      <td id="T_612d4_row10_col8" class="data row10 col8" >0.0000</td>
      <td id="T_612d4_row10_col9" class="data row10 col9" >0.0029</td>
      <td id="T_612d4_row10_col10" class="data row10 col10" >0.0045</td>
      <td id="T_612d4_row10_col11" class="data row10 col11" >0.0000</td>
      <td id="T_612d4_row10_col12" class="data row10 col12" >0.0000</td>
      <td id="T_612d4_row10_col13" class="data row10 col13" >0.0000</td>
      <td id="T_612d4_row10_col14" class="data row10 col14" >0.0000</td>
      <td id="T_612d4_row10_col15" class="data row10 col15" >0.0000</td>
      <td id="T_612d4_row10_col16" class="data row10 col16" >0.0000</td>
      <td id="T_612d4_row10_col17" class="data row10 col17" >0.0000</td>
      <td id="T_612d4_row10_col18" class="data row10 col18" >0.0000</td>
      <td id="T_612d4_row10_col19" class="data row10 col19" >0.0000</td>
      <td id="T_612d4_row10_col20" class="data row10 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_612d4_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_612d4_row11_col0" class="data row11 col0" >0.0000</td>
      <td id="T_612d4_row11_col1" class="data row11 col1" >0.0000</td>
      <td id="T_612d4_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_612d4_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_612d4_row11_col4" class="data row11 col4" >0.0000</td>
      <td id="T_612d4_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_612d4_row11_col6" class="data row11 col6" >0.0000</td>
      <td id="T_612d4_row11_col7" class="data row11 col7" >0.0000</td>
      <td id="T_612d4_row11_col8" class="data row11 col8" >0.0000</td>
      <td id="T_612d4_row11_col9" class="data row11 col9" >0.0000</td>
      <td id="T_612d4_row11_col10" class="data row11 col10" >0.0000</td>
      <td id="T_612d4_row11_col11" class="data row11 col11" >0.0000</td>
      <td id="T_612d4_row11_col12" class="data row11 col12" >0.0000</td>
      <td id="T_612d4_row11_col13" class="data row11 col13" >0.0000</td>
      <td id="T_612d4_row11_col14" class="data row11 col14" >0.0000</td>
      <td id="T_612d4_row11_col15" class="data row11 col15" >0.0000</td>
      <td id="T_612d4_row11_col16" class="data row11 col16" >0.0000</td>
      <td id="T_612d4_row11_col17" class="data row11 col17" >0.0000</td>
      <td id="T_612d4_row11_col18" class="data row11 col18" >0.0000</td>
      <td id="T_612d4_row11_col19" class="data row11 col19" >0.0000</td>
      <td id="T_612d4_row11_col20" class="data row11 col20" >0.0000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPEI median differences</span>
<span class="n">spei_difference_site_onemember</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spei_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                                                               <span class="n">spei_reproduced_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spei_difference_site_onemember</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_3237b th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_3237b th.col_heading {
  border-bottom: 0;
}
#T_3237b table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_3237b th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_3237b_row0_col0, #T_3237b_row0_col3, #T_3237b_row0_col6, #T_3237b_row0_col9, #T_3237b_row0_col12, #T_3237b_row0_col15, #T_3237b_row0_col18, #T_3237b_row1_col0, #T_3237b_row1_col3, #T_3237b_row1_col6, #T_3237b_row1_col9, #T_3237b_row1_col12, #T_3237b_row1_col15, #T_3237b_row1_col18, #T_3237b_row2_col0, #T_3237b_row2_col3, #T_3237b_row2_col6, #T_3237b_row2_col9, #T_3237b_row2_col12, #T_3237b_row2_col15, #T_3237b_row2_col18, #T_3237b_row3_col0, #T_3237b_row3_col3, #T_3237b_row3_col6, #T_3237b_row3_col9, #T_3237b_row3_col12, #T_3237b_row3_col15, #T_3237b_row3_col18, #T_3237b_row4_col0, #T_3237b_row4_col3, #T_3237b_row4_col6, #T_3237b_row4_col9, #T_3237b_row4_col12, #T_3237b_row4_col15, #T_3237b_row4_col18, #T_3237b_row5_col0, #T_3237b_row5_col3, #T_3237b_row5_col6, #T_3237b_row5_col9, #T_3237b_row5_col12, #T_3237b_row5_col15, #T_3237b_row5_col18, #T_3237b_row6_col0, #T_3237b_row6_col3, #T_3237b_row6_col6, #T_3237b_row6_col9, #T_3237b_row6_col12, #T_3237b_row6_col15, #T_3237b_row6_col18, #T_3237b_row7_col0, #T_3237b_row7_col3, #T_3237b_row7_col6, #T_3237b_row7_col9, #T_3237b_row7_col12, #T_3237b_row7_col15, #T_3237b_row7_col18, #T_3237b_row8_col0, #T_3237b_row8_col3, #T_3237b_row8_col6, #T_3237b_row8_col9, #T_3237b_row8_col12, #T_3237b_row8_col15, #T_3237b_row8_col18, #T_3237b_row9_col0, #T_3237b_row9_col3, #T_3237b_row9_col6, #T_3237b_row9_col9, #T_3237b_row9_col12, #T_3237b_row9_col15, #T_3237b_row9_col18, #T_3237b_row10_col0, #T_3237b_row10_col3, #T_3237b_row10_col6, #T_3237b_row10_col9, #T_3237b_row10_col12, #T_3237b_row10_col15, #T_3237b_row10_col18, #T_3237b_row11_col0, #T_3237b_row11_col3, #T_3237b_row11_col6, #T_3237b_row11_col9, #T_3237b_row11_col12, #T_3237b_row11_col15, #T_3237b_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_3237b">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_3237b_level0_col0" class="col_heading level0 col0" colspan="3">SPEI-1</th>
      <th id="T_3237b_level0_col3" class="col_heading level0 col3" colspan="3">SPEI-3</th>
      <th id="T_3237b_level0_col6" class="col_heading level0 col6" colspan="3">SPEI-6</th>
      <th id="T_3237b_level0_col9" class="col_heading level0 col9" colspan="3">SPEI-12</th>
      <th id="T_3237b_level0_col12" class="col_heading level0 col12" colspan="3">SPEI-24</th>
      <th id="T_3237b_level0_col15" class="col_heading level0 col15" colspan="3">SPEI-36</th>
      <th id="T_3237b_level0_col18" class="col_heading level0 col18" colspan="3">SPEI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_3237b_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_3237b_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_3237b_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_3237b_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_3237b_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_3237b_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_3237b_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_3237b_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_3237b_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_3237b_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_3237b_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_3237b_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_3237b_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_3237b_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_3237b_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_3237b_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3237b_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_3237b_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_3237b_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_3237b_row0_col2" class="data row0 col2" >0.0000</td>
      <td id="T_3237b_row0_col3" class="data row0 col3" >0.0021</td>
      <td id="T_3237b_row0_col4" class="data row0 col4" >0.0021</td>
      <td id="T_3237b_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_3237b_row0_col6" class="data row0 col6" >-0.0000</td>
      <td id="T_3237b_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_3237b_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_3237b_row0_col9" class="data row0 col9" >-0.0000</td>
      <td id="T_3237b_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_3237b_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_3237b_row0_col12" class="data row0 col12" >-0.0000</td>
      <td id="T_3237b_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_3237b_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_3237b_row0_col15" class="data row0 col15" >-0.0000</td>
      <td id="T_3237b_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_3237b_row0_col17" class="data row0 col17" >0.0000</td>
      <td id="T_3237b_row0_col18" class="data row0 col18" >-0.0000</td>
      <td id="T_3237b_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_3237b_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_3237b_row1_col0" class="data row1 col0" >0.0082</td>
      <td id="T_3237b_row1_col1" class="data row1 col1" >0.0149</td>
      <td id="T_3237b_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_3237b_row1_col3" class="data row1 col3" >0.0049</td>
      <td id="T_3237b_row1_col4" class="data row1 col4" >0.0116</td>
      <td id="T_3237b_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_3237b_row1_col6" class="data row1 col6" >-0.0544</td>
      <td id="T_3237b_row1_col7" class="data row1 col7" >0.0544</td>
      <td id="T_3237b_row1_col8" class="data row1 col8" >0.0000</td>
      <td id="T_3237b_row1_col9" class="data row1 col9" >-0.0558</td>
      <td id="T_3237b_row1_col10" class="data row1 col10" >0.0565</td>
      <td id="T_3237b_row1_col11" class="data row1 col11" >1.1765</td>
      <td id="T_3237b_row1_col12" class="data row1 col12" >-0.0282</td>
      <td id="T_3237b_row1_col13" class="data row1 col13" >0.0422</td>
      <td id="T_3237b_row1_col14" class="data row1 col14" >0.0000</td>
      <td id="T_3237b_row1_col15" class="data row1 col15" >-0.0281</td>
      <td id="T_3237b_row1_col16" class="data row1 col16" >0.0314</td>
      <td id="T_3237b_row1_col17" class="data row1 col17" >1.1765</td>
      <td id="T_3237b_row1_col18" class="data row1 col18" >-0.1017</td>
      <td id="T_3237b_row1_col19" class="data row1 col19" >0.1017</td>
      <td id="T_3237b_row1_col20" class="data row1 col20" >48.2353</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_3237b_row2_col0" class="data row2 col0" >-0.0066</td>
      <td id="T_3237b_row2_col1" class="data row2 col1" >0.0208</td>
      <td id="T_3237b_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_3237b_row2_col3" class="data row2 col3" >0.0181</td>
      <td id="T_3237b_row2_col4" class="data row2 col4" >0.0214</td>
      <td id="T_3237b_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_3237b_row2_col6" class="data row2 col6" >-0.0111</td>
      <td id="T_3237b_row2_col7" class="data row2 col7" >0.0236</td>
      <td id="T_3237b_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_3237b_row2_col9" class="data row2 col9" >-0.0719</td>
      <td id="T_3237b_row2_col10" class="data row2 col10" >0.0719</td>
      <td id="T_3237b_row2_col11" class="data row2 col11" >32.9412</td>
      <td id="T_3237b_row2_col12" class="data row2 col12" >-0.0365</td>
      <td id="T_3237b_row2_col13" class="data row2 col13" >0.0370</td>
      <td id="T_3237b_row2_col14" class="data row2 col14" >2.3529</td>
      <td id="T_3237b_row2_col15" class="data row2 col15" >-0.0191</td>
      <td id="T_3237b_row2_col16" class="data row2 col16" >0.0407</td>
      <td id="T_3237b_row2_col17" class="data row2 col17" >1.1765</td>
      <td id="T_3237b_row2_col18" class="data row2 col18" >-0.0836</td>
      <td id="T_3237b_row2_col19" class="data row2 col19" >0.0879</td>
      <td id="T_3237b_row2_col20" class="data row2 col20" >34.1176</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_3237b_row3_col0" class="data row3 col0" >-0.0081</td>
      <td id="T_3237b_row3_col1" class="data row3 col1" >0.0228</td>
      <td id="T_3237b_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_3237b_row3_col3" class="data row3 col3" >0.0172</td>
      <td id="T_3237b_row3_col4" class="data row3 col4" >0.0201</td>
      <td id="T_3237b_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_3237b_row3_col6" class="data row3 col6" >0.0023</td>
      <td id="T_3237b_row3_col7" class="data row3 col7" >0.0219</td>
      <td id="T_3237b_row3_col8" class="data row3 col8" >0.0000</td>
      <td id="T_3237b_row3_col9" class="data row3 col9" >-0.0539</td>
      <td id="T_3237b_row3_col10" class="data row3 col10" >0.0539</td>
      <td id="T_3237b_row3_col11" class="data row3 col11" >0.0000</td>
      <td id="T_3237b_row3_col12" class="data row3 col12" >-0.0165</td>
      <td id="T_3237b_row3_col13" class="data row3 col13" >0.0540</td>
      <td id="T_3237b_row3_col14" class="data row3 col14" >15.2941</td>
      <td id="T_3237b_row3_col15" class="data row3 col15" >-0.0860</td>
      <td id="T_3237b_row3_col16" class="data row3 col16" >0.0860</td>
      <td id="T_3237b_row3_col17" class="data row3 col17" >37.6471</td>
      <td id="T_3237b_row3_col18" class="data row3 col18" >-0.1625</td>
      <td id="T_3237b_row3_col19" class="data row3 col19" >0.1625</td>
      <td id="T_3237b_row3_col20" class="data row3 col20" >52.9412</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_3237b_row4_col0" class="data row4 col0" >-0.0219</td>
      <td id="T_3237b_row4_col1" class="data row4 col1" >0.0344</td>
      <td id="T_3237b_row4_col2" class="data row4 col2" >5.8824</td>
      <td id="T_3237b_row4_col3" class="data row4 col3" >-0.0135</td>
      <td id="T_3237b_row4_col4" class="data row4 col4" >0.0254</td>
      <td id="T_3237b_row4_col5" class="data row4 col5" >0.0000</td>
      <td id="T_3237b_row4_col6" class="data row4 col6" >-0.0068</td>
      <td id="T_3237b_row4_col7" class="data row4 col7" >0.0381</td>
      <td id="T_3237b_row4_col8" class="data row4 col8" >2.3529</td>
      <td id="T_3237b_row4_col9" class="data row4 col9" >-0.0467</td>
      <td id="T_3237b_row4_col10" class="data row4 col10" >0.0467</td>
      <td id="T_3237b_row4_col11" class="data row4 col11" >0.0000</td>
      <td id="T_3237b_row4_col12" class="data row4 col12" >-0.0161</td>
      <td id="T_3237b_row4_col13" class="data row4 col13" >0.0475</td>
      <td id="T_3237b_row4_col14" class="data row4 col14" >14.1176</td>
      <td id="T_3237b_row4_col15" class="data row4 col15" >-0.0609</td>
      <td id="T_3237b_row4_col16" class="data row4 col16" >0.0609</td>
      <td id="T_3237b_row4_col17" class="data row4 col17" >0.0000</td>
      <td id="T_3237b_row4_col18" class="data row4 col18" >0.0693</td>
      <td id="T_3237b_row4_col19" class="data row4 col19" >0.1130</td>
      <td id="T_3237b_row4_col20" class="data row4 col20" >56.4706</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_3237b_row5_col0" class="data row5 col0" >-0.0414</td>
      <td id="T_3237b_row5_col1" class="data row5 col1" >0.0423</td>
      <td id="T_3237b_row5_col2" class="data row5 col2" >0.0000</td>
      <td id="T_3237b_row5_col3" class="data row5 col3" >-0.0279</td>
      <td id="T_3237b_row5_col4" class="data row5 col4" >0.0287</td>
      <td id="T_3237b_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_3237b_row5_col6" class="data row5 col6" >-0.0083</td>
      <td id="T_3237b_row5_col7" class="data row5 col7" >0.0259</td>
      <td id="T_3237b_row5_col8" class="data row5 col8" >2.3529</td>
      <td id="T_3237b_row5_col9" class="data row5 col9" >-0.0455</td>
      <td id="T_3237b_row5_col10" class="data row5 col10" >0.0455</td>
      <td id="T_3237b_row5_col11" class="data row5 col11" >0.0000</td>
      <td id="T_3237b_row5_col12" class="data row5 col12" >-0.0183</td>
      <td id="T_3237b_row5_col13" class="data row5 col13" >0.0381</td>
      <td id="T_3237b_row5_col14" class="data row5 col14" >12.9412</td>
      <td id="T_3237b_row5_col15" class="data row5 col15" >-0.0984</td>
      <td id="T_3237b_row5_col16" class="data row5 col16" >0.0984</td>
      <td id="T_3237b_row5_col17" class="data row5 col17" >48.2353</td>
      <td id="T_3237b_row5_col18" class="data row5 col18" >0.0131</td>
      <td id="T_3237b_row5_col19" class="data row5 col19" >0.0787</td>
      <td id="T_3237b_row5_col20" class="data row5 col20" >30.5882</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_3237b_row6_col0" class="data row6 col0" >-0.0806</td>
      <td id="T_3237b_row6_col1" class="data row6 col1" >0.0810</td>
      <td id="T_3237b_row6_col2" class="data row6 col2" >23.5294</td>
      <td id="T_3237b_row6_col3" class="data row6 col3" >-0.0398</td>
      <td id="T_3237b_row6_col4" class="data row6 col4" >0.0558</td>
      <td id="T_3237b_row6_col5" class="data row6 col5" >4.7059</td>
      <td id="T_3237b_row6_col6" class="data row6 col6" >-0.0207</td>
      <td id="T_3237b_row6_col7" class="data row6 col7" >0.0244</td>
      <td id="T_3237b_row6_col8" class="data row6 col8" >3.5294</td>
      <td id="T_3237b_row6_col9" class="data row6 col9" >-0.0565</td>
      <td id="T_3237b_row6_col10" class="data row6 col10" >0.0565</td>
      <td id="T_3237b_row6_col11" class="data row6 col11" >0.0000</td>
      <td id="T_3237b_row6_col12" class="data row6 col12" >-0.0228</td>
      <td id="T_3237b_row6_col13" class="data row6 col13" >0.0447</td>
      <td id="T_3237b_row6_col14" class="data row6 col14" >11.7647</td>
      <td id="T_3237b_row6_col15" class="data row6 col15" >-0.1005</td>
      <td id="T_3237b_row6_col16" class="data row6 col16" >0.1005</td>
      <td id="T_3237b_row6_col17" class="data row6 col17" >48.2353</td>
      <td id="T_3237b_row6_col18" class="data row6 col18" >0.0240</td>
      <td id="T_3237b_row6_col19" class="data row6 col19" >0.0939</td>
      <td id="T_3237b_row6_col20" class="data row6 col20" >44.7059</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_3237b_row7_col0" class="data row7 col0" >-0.1862</td>
      <td id="T_3237b_row7_col1" class="data row7 col1" >0.1862</td>
      <td id="T_3237b_row7_col2" class="data row7 col2" >57.6471</td>
      <td id="T_3237b_row7_col3" class="data row7 col3" >-0.1697</td>
      <td id="T_3237b_row7_col4" class="data row7 col4" >0.1697</td>
      <td id="T_3237b_row7_col5" class="data row7 col5" >68.2353</td>
      <td id="T_3237b_row7_col6" class="data row7 col6" >-0.0565</td>
      <td id="T_3237b_row7_col7" class="data row7 col7" >0.0565</td>
      <td id="T_3237b_row7_col8" class="data row7 col8" >0.0000</td>
      <td id="T_3237b_row7_col9" class="data row7 col9" >-0.0736</td>
      <td id="T_3237b_row7_col10" class="data row7 col10" >0.0736</td>
      <td id="T_3237b_row7_col11" class="data row7 col11" >18.8235</td>
      <td id="T_3237b_row7_col12" class="data row7 col12" >-0.1048</td>
      <td id="T_3237b_row7_col13" class="data row7 col13" >0.1048</td>
      <td id="T_3237b_row7_col14" class="data row7 col14" >49.4118</td>
      <td id="T_3237b_row7_col15" class="data row7 col15" >-0.1527</td>
      <td id="T_3237b_row7_col16" class="data row7 col16" >0.1527</td>
      <td id="T_3237b_row7_col17" class="data row7 col17" >62.3529</td>
      <td id="T_3237b_row7_col18" class="data row7 col18" >-0.0889</td>
      <td id="T_3237b_row7_col19" class="data row7 col19" >0.0889</td>
      <td id="T_3237b_row7_col20" class="data row7 col20" >43.5294</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_3237b_row8_col0" class="data row8 col0" >-0.0282</td>
      <td id="T_3237b_row8_col1" class="data row8 col1" >0.0329</td>
      <td id="T_3237b_row8_col2" class="data row8 col2" >0.0000</td>
      <td id="T_3237b_row8_col3" class="data row8 col3" >-0.1285</td>
      <td id="T_3237b_row8_col4" class="data row8 col4" >0.1285</td>
      <td id="T_3237b_row8_col5" class="data row8 col5" >51.7647</td>
      <td id="T_3237b_row8_col6" class="data row8 col6" >-0.0617</td>
      <td id="T_3237b_row8_col7" class="data row8 col7" >0.0617</td>
      <td id="T_3237b_row8_col8" class="data row8 col8" >29.4118</td>
      <td id="T_3237b_row8_col9" class="data row8 col9" >-0.0473</td>
      <td id="T_3237b_row8_col10" class="data row8 col10" >0.0475</td>
      <td id="T_3237b_row8_col11" class="data row8 col11" >1.1765</td>
      <td id="T_3237b_row8_col12" class="data row8 col12" >-0.0800</td>
      <td id="T_3237b_row8_col13" class="data row8 col13" >0.0800</td>
      <td id="T_3237b_row8_col14" class="data row8 col14" >43.5294</td>
      <td id="T_3237b_row8_col15" class="data row8 col15" >-0.1581</td>
      <td id="T_3237b_row8_col16" class="data row8 col16" >0.1581</td>
      <td id="T_3237b_row8_col17" class="data row8 col17" >56.4706</td>
      <td id="T_3237b_row8_col18" class="data row8 col18" >-0.0722</td>
      <td id="T_3237b_row8_col19" class="data row8 col19" >0.0722</td>
      <td id="T_3237b_row8_col20" class="data row8 col20" >14.1176</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_3237b_row9_col0" class="data row9 col0" >0.0004</td>
      <td id="T_3237b_row9_col1" class="data row9 col1" >0.0098</td>
      <td id="T_3237b_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_3237b_row9_col3" class="data row9 col3" >-0.0751</td>
      <td id="T_3237b_row9_col4" class="data row9 col4" >0.0751</td>
      <td id="T_3237b_row9_col5" class="data row9 col5" >37.6471</td>
      <td id="T_3237b_row9_col6" class="data row9 col6" >-0.0524</td>
      <td id="T_3237b_row9_col7" class="data row9 col7" >0.0524</td>
      <td id="T_3237b_row9_col8" class="data row9 col8" >35.2941</td>
      <td id="T_3237b_row9_col9" class="data row9 col9" >-0.0487</td>
      <td id="T_3237b_row9_col10" class="data row9 col10" >0.0487</td>
      <td id="T_3237b_row9_col11" class="data row9 col11" >0.0000</td>
      <td id="T_3237b_row9_col12" class="data row9 col12" >-0.0766</td>
      <td id="T_3237b_row9_col13" class="data row9 col13" >0.0766</td>
      <td id="T_3237b_row9_col14" class="data row9 col14" >43.5294</td>
      <td id="T_3237b_row9_col15" class="data row9 col15" >-0.1255</td>
      <td id="T_3237b_row9_col16" class="data row9 col16" >0.1255</td>
      <td id="T_3237b_row9_col17" class="data row9 col17" >52.9412</td>
      <td id="T_3237b_row9_col18" class="data row9 col18" >-0.0598</td>
      <td id="T_3237b_row9_col19" class="data row9 col19" >0.0600</td>
      <td id="T_3237b_row9_col20" class="data row9 col20" >1.1765</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_3237b_row10_col0" class="data row10 col0" >0.0058</td>
      <td id="T_3237b_row10_col1" class="data row10 col1" >0.0175</td>
      <td id="T_3237b_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_3237b_row10_col3" class="data row10 col3" >-0.0008</td>
      <td id="T_3237b_row10_col4" class="data row10 col4" >0.0257</td>
      <td id="T_3237b_row10_col5" class="data row10 col5" >0.0000</td>
      <td id="T_3237b_row10_col6" class="data row10 col6" >-0.0740</td>
      <td id="T_3237b_row10_col7" class="data row10 col7" >0.0740</td>
      <td id="T_3237b_row10_col8" class="data row10 col8" >42.3529</td>
      <td id="T_3237b_row10_col9" class="data row10 col9" >-0.0411</td>
      <td id="T_3237b_row10_col10" class="data row10 col10" >0.0411</td>
      <td id="T_3237b_row10_col11" class="data row10 col11" >0.0000</td>
      <td id="T_3237b_row10_col12" class="data row10 col12" >-0.0873</td>
      <td id="T_3237b_row10_col13" class="data row10 col13" >0.0873</td>
      <td id="T_3237b_row10_col14" class="data row10 col14" >41.1765</td>
      <td id="T_3237b_row10_col15" class="data row10 col15" >-0.1188</td>
      <td id="T_3237b_row10_col16" class="data row10 col16" >0.1188</td>
      <td id="T_3237b_row10_col17" class="data row10 col17" >54.1176</td>
      <td id="T_3237b_row10_col18" class="data row10 col18" >-0.0533</td>
      <td id="T_3237b_row10_col19" class="data row10 col19" >0.0536</td>
      <td id="T_3237b_row10_col20" class="data row10 col20" >2.3529</td>
    </tr>
    <tr>
      <th id="T_3237b_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_3237b_row11_col0" class="data row11 col0" >0.0251</td>
      <td id="T_3237b_row11_col1" class="data row11 col1" >0.0251</td>
      <td id="T_3237b_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_3237b_row11_col3" class="data row11 col3" >0.0160</td>
      <td id="T_3237b_row11_col4" class="data row11 col4" >0.0197</td>
      <td id="T_3237b_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_3237b_row11_col6" class="data row11 col6" >-0.0723</td>
      <td id="T_3237b_row11_col7" class="data row11 col7" >0.0754</td>
      <td id="T_3237b_row11_col8" class="data row11 col8" >9.4118</td>
      <td id="T_3237b_row11_col9" class="data row11 col9" >-0.0424</td>
      <td id="T_3237b_row11_col10" class="data row11 col10" >0.0426</td>
      <td id="T_3237b_row11_col11" class="data row11 col11" >0.0000</td>
      <td id="T_3237b_row11_col12" class="data row11 col12" >-0.0831</td>
      <td id="T_3237b_row11_col13" class="data row11 col13" >0.0831</td>
      <td id="T_3237b_row11_col14" class="data row11 col14" >43.5294</td>
      <td id="T_3237b_row11_col15" class="data row11 col15" >-0.1299</td>
      <td id="T_3237b_row11_col16" class="data row11 col16" >0.1299</td>
      <td id="T_3237b_row11_col17" class="data row11 col17" >58.8235</td>
      <td id="T_3237b_row11_col18" class="data row11 col18" >-0.0646</td>
      <td id="T_3237b_row11_col19" class="data row11 col19" >0.0650</td>
      <td id="T_3237b_row11_col20" class="data row11 col20" >7.0588</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The control-member comparisons for SPI and SPEI look very similar to the reanalysis comparisons from previous sections.
Given these similarities,
it is therefore fair to conclude that the ensemble and reanalysis components of ERA5‚ÄìDrought are equally reproducible from ERA5.</p>
</section>
<section id="full-ensemble">
<h5>Full ensemble<a class="headerlink" href="#full-ensemble" title="Link to this heading">#</a></h5>
<p>Next, we compare the full ensemble, including the control and the 9 perturbed members:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI median differences</span>
<span class="n">spi_difference_site_ensemble</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spi_era5drought_site_ensemble</span><span class="p">,</span> <span class="n">spi_reproduced_site_ensemble</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spi_difference_site_ensemble</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_59e3d th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_59e3d th.col_heading {
  border-bottom: 0;
}
#T_59e3d table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_59e3d th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_59e3d_row0_col0, #T_59e3d_row0_col3, #T_59e3d_row0_col6, #T_59e3d_row0_col9, #T_59e3d_row0_col12, #T_59e3d_row0_col15, #T_59e3d_row0_col18, #T_59e3d_row1_col0, #T_59e3d_row1_col3, #T_59e3d_row1_col6, #T_59e3d_row1_col9, #T_59e3d_row1_col12, #T_59e3d_row1_col15, #T_59e3d_row1_col18, #T_59e3d_row2_col0, #T_59e3d_row2_col3, #T_59e3d_row2_col6, #T_59e3d_row2_col9, #T_59e3d_row2_col12, #T_59e3d_row2_col15, #T_59e3d_row2_col18, #T_59e3d_row3_col0, #T_59e3d_row3_col3, #T_59e3d_row3_col6, #T_59e3d_row3_col9, #T_59e3d_row3_col12, #T_59e3d_row3_col15, #T_59e3d_row3_col18, #T_59e3d_row4_col0, #T_59e3d_row4_col3, #T_59e3d_row4_col6, #T_59e3d_row4_col9, #T_59e3d_row4_col12, #T_59e3d_row4_col15, #T_59e3d_row4_col18, #T_59e3d_row5_col0, #T_59e3d_row5_col3, #T_59e3d_row5_col6, #T_59e3d_row5_col9, #T_59e3d_row5_col12, #T_59e3d_row5_col15, #T_59e3d_row5_col18, #T_59e3d_row6_col0, #T_59e3d_row6_col3, #T_59e3d_row6_col6, #T_59e3d_row6_col9, #T_59e3d_row6_col12, #T_59e3d_row6_col15, #T_59e3d_row6_col18, #T_59e3d_row7_col0, #T_59e3d_row7_col3, #T_59e3d_row7_col6, #T_59e3d_row7_col9, #T_59e3d_row7_col12, #T_59e3d_row7_col15, #T_59e3d_row7_col18, #T_59e3d_row8_col0, #T_59e3d_row8_col3, #T_59e3d_row8_col6, #T_59e3d_row8_col9, #T_59e3d_row8_col12, #T_59e3d_row8_col15, #T_59e3d_row8_col18, #T_59e3d_row9_col0, #T_59e3d_row9_col3, #T_59e3d_row9_col6, #T_59e3d_row9_col9, #T_59e3d_row9_col12, #T_59e3d_row9_col15, #T_59e3d_row9_col18, #T_59e3d_row10_col0, #T_59e3d_row10_col3, #T_59e3d_row10_col6, #T_59e3d_row10_col9, #T_59e3d_row10_col12, #T_59e3d_row10_col15, #T_59e3d_row10_col18, #T_59e3d_row11_col0, #T_59e3d_row11_col3, #T_59e3d_row11_col6, #T_59e3d_row11_col9, #T_59e3d_row11_col12, #T_59e3d_row11_col15, #T_59e3d_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_59e3d">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_59e3d_level0_col0" class="col_heading level0 col0" colspan="3">SPI-1</th>
      <th id="T_59e3d_level0_col3" class="col_heading level0 col3" colspan="3">SPI-3</th>
      <th id="T_59e3d_level0_col6" class="col_heading level0 col6" colspan="3">SPI-6</th>
      <th id="T_59e3d_level0_col9" class="col_heading level0 col9" colspan="3">SPI-12</th>
      <th id="T_59e3d_level0_col12" class="col_heading level0 col12" colspan="3">SPI-24</th>
      <th id="T_59e3d_level0_col15" class="col_heading level0 col15" colspan="3">SPI-36</th>
      <th id="T_59e3d_level0_col18" class="col_heading level0 col18" colspan="3">SPI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_59e3d_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_59e3d_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_59e3d_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_59e3d_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_59e3d_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_59e3d_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_59e3d_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_59e3d_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_59e3d_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_59e3d_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_59e3d_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_59e3d_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_59e3d_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_59e3d_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_59e3d_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_59e3d_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_59e3d_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_59e3d_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_59e3d_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_59e3d_row0_col2" class="data row0 col2" >0.4706</td>
      <td id="T_59e3d_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_59e3d_row0_col4" class="data row0 col4" >0.0000</td>
      <td id="T_59e3d_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_59e3d_row0_col6" class="data row0 col6" >0.0000</td>
      <td id="T_59e3d_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_59e3d_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_59e3d_row0_col9" class="data row0 col9" >0.0000</td>
      <td id="T_59e3d_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_59e3d_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_59e3d_row0_col12" class="data row0 col12" >0.0000</td>
      <td id="T_59e3d_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_59e3d_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_59e3d_row0_col15" class="data row0 col15" >0.0000</td>
      <td id="T_59e3d_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_59e3d_row0_col17" class="data row0 col17" >0.5882</td>
      <td id="T_59e3d_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_59e3d_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_59e3d_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_59e3d_row1_col0" class="data row1 col0" >0.0000</td>
      <td id="T_59e3d_row1_col1" class="data row1 col1" >0.0000</td>
      <td id="T_59e3d_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_59e3d_row1_col3" class="data row1 col3" >0.0000</td>
      <td id="T_59e3d_row1_col4" class="data row1 col4" >0.0000</td>
      <td id="T_59e3d_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_59e3d_row1_col6" class="data row1 col6" >0.0000</td>
      <td id="T_59e3d_row1_col7" class="data row1 col7" >0.0000</td>
      <td id="T_59e3d_row1_col8" class="data row1 col8" >0.0000</td>
      <td id="T_59e3d_row1_col9" class="data row1 col9" >0.0000</td>
      <td id="T_59e3d_row1_col10" class="data row1 col10" >0.0000</td>
      <td id="T_59e3d_row1_col11" class="data row1 col11" >0.0000</td>
      <td id="T_59e3d_row1_col12" class="data row1 col12" >0.0000</td>
      <td id="T_59e3d_row1_col13" class="data row1 col13" >0.0000</td>
      <td id="T_59e3d_row1_col14" class="data row1 col14" >0.2353</td>
      <td id="T_59e3d_row1_col15" class="data row1 col15" >0.0000</td>
      <td id="T_59e3d_row1_col16" class="data row1 col16" >0.0000</td>
      <td id="T_59e3d_row1_col17" class="data row1 col17" >0.1176</td>
      <td id="T_59e3d_row1_col18" class="data row1 col18" >0.0000</td>
      <td id="T_59e3d_row1_col19" class="data row1 col19" >0.0000</td>
      <td id="T_59e3d_row1_col20" class="data row1 col20" >0.3529</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_59e3d_row2_col0" class="data row2 col0" >0.0000</td>
      <td id="T_59e3d_row2_col1" class="data row2 col1" >0.0000</td>
      <td id="T_59e3d_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_59e3d_row2_col3" class="data row2 col3" >0.0000</td>
      <td id="T_59e3d_row2_col4" class="data row2 col4" >0.0000</td>
      <td id="T_59e3d_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_59e3d_row2_col6" class="data row2 col6" >0.0000</td>
      <td id="T_59e3d_row2_col7" class="data row2 col7" >0.0000</td>
      <td id="T_59e3d_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_59e3d_row2_col9" class="data row2 col9" >0.0000</td>
      <td id="T_59e3d_row2_col10" class="data row2 col10" >0.0000</td>
      <td id="T_59e3d_row2_col11" class="data row2 col11" >0.0000</td>
      <td id="T_59e3d_row2_col12" class="data row2 col12" >0.0000</td>
      <td id="T_59e3d_row2_col13" class="data row2 col13" >0.0000</td>
      <td id="T_59e3d_row2_col14" class="data row2 col14" >0.2353</td>
      <td id="T_59e3d_row2_col15" class="data row2 col15" >0.0000</td>
      <td id="T_59e3d_row2_col16" class="data row2 col16" >0.0000</td>
      <td id="T_59e3d_row2_col17" class="data row2 col17" >0.2353</td>
      <td id="T_59e3d_row2_col18" class="data row2 col18" >0.0000</td>
      <td id="T_59e3d_row2_col19" class="data row2 col19" >0.0000</td>
      <td id="T_59e3d_row2_col20" class="data row2 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_59e3d_row3_col0" class="data row3 col0" >0.0000</td>
      <td id="T_59e3d_row3_col1" class="data row3 col1" >0.0000</td>
      <td id="T_59e3d_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_59e3d_row3_col3" class="data row3 col3" >0.0000</td>
      <td id="T_59e3d_row3_col4" class="data row3 col4" >0.0000</td>
      <td id="T_59e3d_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_59e3d_row3_col6" class="data row3 col6" >0.0000</td>
      <td id="T_59e3d_row3_col7" class="data row3 col7" >0.0000</td>
      <td id="T_59e3d_row3_col8" class="data row3 col8" >0.0000</td>
      <td id="T_59e3d_row3_col9" class="data row3 col9" >0.0000</td>
      <td id="T_59e3d_row3_col10" class="data row3 col10" >0.0000</td>
      <td id="T_59e3d_row3_col11" class="data row3 col11" >0.0000</td>
      <td id="T_59e3d_row3_col12" class="data row3 col12" >0.0000</td>
      <td id="T_59e3d_row3_col13" class="data row3 col13" >0.0000</td>
      <td id="T_59e3d_row3_col14" class="data row3 col14" >0.0000</td>
      <td id="T_59e3d_row3_col15" class="data row3 col15" >0.0000</td>
      <td id="T_59e3d_row3_col16" class="data row3 col16" >0.0000</td>
      <td id="T_59e3d_row3_col17" class="data row3 col17" >0.2353</td>
      <td id="T_59e3d_row3_col18" class="data row3 col18" >0.0000</td>
      <td id="T_59e3d_row3_col19" class="data row3 col19" >0.0000</td>
      <td id="T_59e3d_row3_col20" class="data row3 col20" >0.2353</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_59e3d_row4_col0" class="data row4 col0" >0.0000</td>
      <td id="T_59e3d_row4_col1" class="data row4 col1" >0.0000</td>
      <td id="T_59e3d_row4_col2" class="data row4 col2" >0.0000</td>
      <td id="T_59e3d_row4_col3" class="data row4 col3" >0.0000</td>
      <td id="T_59e3d_row4_col4" class="data row4 col4" >0.0000</td>
      <td id="T_59e3d_row4_col5" class="data row4 col5" >0.0000</td>
      <td id="T_59e3d_row4_col6" class="data row4 col6" >0.0000</td>
      <td id="T_59e3d_row4_col7" class="data row4 col7" >0.0000</td>
      <td id="T_59e3d_row4_col8" class="data row4 col8" >0.0000</td>
      <td id="T_59e3d_row4_col9" class="data row4 col9" >0.0000</td>
      <td id="T_59e3d_row4_col10" class="data row4 col10" >0.0000</td>
      <td id="T_59e3d_row4_col11" class="data row4 col11" >0.0000</td>
      <td id="T_59e3d_row4_col12" class="data row4 col12" >0.0000</td>
      <td id="T_59e3d_row4_col13" class="data row4 col13" >0.0000</td>
      <td id="T_59e3d_row4_col14" class="data row4 col14" >0.0000</td>
      <td id="T_59e3d_row4_col15" class="data row4 col15" >0.0000</td>
      <td id="T_59e3d_row4_col16" class="data row4 col16" >0.0000</td>
      <td id="T_59e3d_row4_col17" class="data row4 col17" >0.1176</td>
      <td id="T_59e3d_row4_col18" class="data row4 col18" >0.0000</td>
      <td id="T_59e3d_row4_col19" class="data row4 col19" >0.0000</td>
      <td id="T_59e3d_row4_col20" class="data row4 col20" >0.2353</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_59e3d_row5_col0" class="data row5 col0" >0.0000</td>
      <td id="T_59e3d_row5_col1" class="data row5 col1" >0.0000</td>
      <td id="T_59e3d_row5_col2" class="data row5 col2" >0.2353</td>
      <td id="T_59e3d_row5_col3" class="data row5 col3" >0.0000</td>
      <td id="T_59e3d_row5_col4" class="data row5 col4" >0.0000</td>
      <td id="T_59e3d_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_59e3d_row5_col6" class="data row5 col6" >0.0000</td>
      <td id="T_59e3d_row5_col7" class="data row5 col7" >0.0000</td>
      <td id="T_59e3d_row5_col8" class="data row5 col8" >0.0000</td>
      <td id="T_59e3d_row5_col9" class="data row5 col9" >0.0000</td>
      <td id="T_59e3d_row5_col10" class="data row5 col10" >0.0000</td>
      <td id="T_59e3d_row5_col11" class="data row5 col11" >0.0000</td>
      <td id="T_59e3d_row5_col12" class="data row5 col12" >0.0000</td>
      <td id="T_59e3d_row5_col13" class="data row5 col13" >0.0000</td>
      <td id="T_59e3d_row5_col14" class="data row5 col14" >0.0000</td>
      <td id="T_59e3d_row5_col15" class="data row5 col15" >0.0000</td>
      <td id="T_59e3d_row5_col16" class="data row5 col16" >0.0000</td>
      <td id="T_59e3d_row5_col17" class="data row5 col17" >0.1176</td>
      <td id="T_59e3d_row5_col18" class="data row5 col18" >0.0000</td>
      <td id="T_59e3d_row5_col19" class="data row5 col19" >0.0000</td>
      <td id="T_59e3d_row5_col20" class="data row5 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_59e3d_row6_col0" class="data row6 col0" >0.0000</td>
      <td id="T_59e3d_row6_col1" class="data row6 col1" >0.0000</td>
      <td id="T_59e3d_row6_col2" class="data row6 col2" >1.6471</td>
      <td id="T_59e3d_row6_col3" class="data row6 col3" >0.0000</td>
      <td id="T_59e3d_row6_col4" class="data row6 col4" >0.0007</td>
      <td id="T_59e3d_row6_col5" class="data row6 col5" >0.0000</td>
      <td id="T_59e3d_row6_col6" class="data row6 col6" >0.0000</td>
      <td id="T_59e3d_row6_col7" class="data row6 col7" >0.0000</td>
      <td id="T_59e3d_row6_col8" class="data row6 col8" >0.2353</td>
      <td id="T_59e3d_row6_col9" class="data row6 col9" >0.0000</td>
      <td id="T_59e3d_row6_col10" class="data row6 col10" >0.0000</td>
      <td id="T_59e3d_row6_col11" class="data row6 col11" >0.0000</td>
      <td id="T_59e3d_row6_col12" class="data row6 col12" >0.0000</td>
      <td id="T_59e3d_row6_col13" class="data row6 col13" >0.0000</td>
      <td id="T_59e3d_row6_col14" class="data row6 col14" >0.0000</td>
      <td id="T_59e3d_row6_col15" class="data row6 col15" >0.0000</td>
      <td id="T_59e3d_row6_col16" class="data row6 col16" >0.0000</td>
      <td id="T_59e3d_row6_col17" class="data row6 col17" >0.5882</td>
      <td id="T_59e3d_row6_col18" class="data row6 col18" >0.0000</td>
      <td id="T_59e3d_row6_col19" class="data row6 col19" >0.0000</td>
      <td id="T_59e3d_row6_col20" class="data row6 col20" >0.1176</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_59e3d_row7_col0" class="data row7 col0" >0.0000</td>
      <td id="T_59e3d_row7_col1" class="data row7 col1" >0.0000</td>
      <td id="T_59e3d_row7_col2" class="data row7 col2" >0.0000</td>
      <td id="T_59e3d_row7_col3" class="data row7 col3" >0.0000</td>
      <td id="T_59e3d_row7_col4" class="data row7 col4" >0.0000</td>
      <td id="T_59e3d_row7_col5" class="data row7 col5" >1.2941</td>
      <td id="T_59e3d_row7_col6" class="data row7 col6" >0.0000</td>
      <td id="T_59e3d_row7_col7" class="data row7 col7" >0.0000</td>
      <td id="T_59e3d_row7_col8" class="data row7 col8" >0.1176</td>
      <td id="T_59e3d_row7_col9" class="data row7 col9" >0.0000</td>
      <td id="T_59e3d_row7_col10" class="data row7 col10" >0.0000</td>
      <td id="T_59e3d_row7_col11" class="data row7 col11" >0.0000</td>
      <td id="T_59e3d_row7_col12" class="data row7 col12" >0.0000</td>
      <td id="T_59e3d_row7_col13" class="data row7 col13" >0.0000</td>
      <td id="T_59e3d_row7_col14" class="data row7 col14" >0.0000</td>
      <td id="T_59e3d_row7_col15" class="data row7 col15" >0.0000</td>
      <td id="T_59e3d_row7_col16" class="data row7 col16" >0.0000</td>
      <td id="T_59e3d_row7_col17" class="data row7 col17" >0.4706</td>
      <td id="T_59e3d_row7_col18" class="data row7 col18" >0.0000</td>
      <td id="T_59e3d_row7_col19" class="data row7 col19" >0.0000</td>
      <td id="T_59e3d_row7_col20" class="data row7 col20" >0.1176</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_59e3d_row8_col0" class="data row8 col0" >0.0000</td>
      <td id="T_59e3d_row8_col1" class="data row8 col1" >0.0000</td>
      <td id="T_59e3d_row8_col2" class="data row8 col2" >0.0000</td>
      <td id="T_59e3d_row8_col3" class="data row8 col3" >0.0000</td>
      <td id="T_59e3d_row8_col4" class="data row8 col4" >0.0000</td>
      <td id="T_59e3d_row8_col5" class="data row8 col5" >0.2353</td>
      <td id="T_59e3d_row8_col6" class="data row8 col6" >0.0000</td>
      <td id="T_59e3d_row8_col7" class="data row8 col7" >0.0000</td>
      <td id="T_59e3d_row8_col8" class="data row8 col8" >0.0000</td>
      <td id="T_59e3d_row8_col9" class="data row8 col9" >0.0000</td>
      <td id="T_59e3d_row8_col10" class="data row8 col10" >0.0000</td>
      <td id="T_59e3d_row8_col11" class="data row8 col11" >0.0000</td>
      <td id="T_59e3d_row8_col12" class="data row8 col12" >0.0000</td>
      <td id="T_59e3d_row8_col13" class="data row8 col13" >0.0000</td>
      <td id="T_59e3d_row8_col14" class="data row8 col14" >0.0000</td>
      <td id="T_59e3d_row8_col15" class="data row8 col15" >0.0000</td>
      <td id="T_59e3d_row8_col16" class="data row8 col16" >0.0000</td>
      <td id="T_59e3d_row8_col17" class="data row8 col17" >0.1176</td>
      <td id="T_59e3d_row8_col18" class="data row8 col18" >0.0000</td>
      <td id="T_59e3d_row8_col19" class="data row8 col19" >0.0000</td>
      <td id="T_59e3d_row8_col20" class="data row8 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_59e3d_row9_col0" class="data row9 col0" >0.0000</td>
      <td id="T_59e3d_row9_col1" class="data row9 col1" >0.0000</td>
      <td id="T_59e3d_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_59e3d_row9_col3" class="data row9 col3" >0.0000</td>
      <td id="T_59e3d_row9_col4" class="data row9 col4" >0.0000</td>
      <td id="T_59e3d_row9_col5" class="data row9 col5" >0.0000</td>
      <td id="T_59e3d_row9_col6" class="data row9 col6" >0.0000</td>
      <td id="T_59e3d_row9_col7" class="data row9 col7" >0.0000</td>
      <td id="T_59e3d_row9_col8" class="data row9 col8" >0.0000</td>
      <td id="T_59e3d_row9_col9" class="data row9 col9" >0.0000</td>
      <td id="T_59e3d_row9_col10" class="data row9 col10" >0.0000</td>
      <td id="T_59e3d_row9_col11" class="data row9 col11" >0.0000</td>
      <td id="T_59e3d_row9_col12" class="data row9 col12" >0.0000</td>
      <td id="T_59e3d_row9_col13" class="data row9 col13" >0.0000</td>
      <td id="T_59e3d_row9_col14" class="data row9 col14" >0.0000</td>
      <td id="T_59e3d_row9_col15" class="data row9 col15" >0.0000</td>
      <td id="T_59e3d_row9_col16" class="data row9 col16" >0.0000</td>
      <td id="T_59e3d_row9_col17" class="data row9 col17" >0.3529</td>
      <td id="T_59e3d_row9_col18" class="data row9 col18" >0.0000</td>
      <td id="T_59e3d_row9_col19" class="data row9 col19" >0.0000</td>
      <td id="T_59e3d_row9_col20" class="data row9 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_59e3d_row10_col0" class="data row10 col0" >0.0000</td>
      <td id="T_59e3d_row10_col1" class="data row10 col1" >0.0000</td>
      <td id="T_59e3d_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_59e3d_row10_col3" class="data row10 col3" >0.0000</td>
      <td id="T_59e3d_row10_col4" class="data row10 col4" >0.0000</td>
      <td id="T_59e3d_row10_col5" class="data row10 col5" >0.0000</td>
      <td id="T_59e3d_row10_col6" class="data row10 col6" >0.0000</td>
      <td id="T_59e3d_row10_col7" class="data row10 col7" >0.0000</td>
      <td id="T_59e3d_row10_col8" class="data row10 col8" >0.1176</td>
      <td id="T_59e3d_row10_col9" class="data row10 col9" >0.0000</td>
      <td id="T_59e3d_row10_col10" class="data row10 col10" >0.0000</td>
      <td id="T_59e3d_row10_col11" class="data row10 col11" >0.0000</td>
      <td id="T_59e3d_row10_col12" class="data row10 col12" >0.0000</td>
      <td id="T_59e3d_row10_col13" class="data row10 col13" >0.0000</td>
      <td id="T_59e3d_row10_col14" class="data row10 col14" >0.0000</td>
      <td id="T_59e3d_row10_col15" class="data row10 col15" >0.0000</td>
      <td id="T_59e3d_row10_col16" class="data row10 col16" >0.0000</td>
      <td id="T_59e3d_row10_col17" class="data row10 col17" >0.3529</td>
      <td id="T_59e3d_row10_col18" class="data row10 col18" >0.0000</td>
      <td id="T_59e3d_row10_col19" class="data row10 col19" >0.0000</td>
      <td id="T_59e3d_row10_col20" class="data row10 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_59e3d_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_59e3d_row11_col0" class="data row11 col0" >0.0000</td>
      <td id="T_59e3d_row11_col1" class="data row11 col1" >0.0000</td>
      <td id="T_59e3d_row11_col2" class="data row11 col2" >6.0000</td>
      <td id="T_59e3d_row11_col3" class="data row11 col3" >0.0000</td>
      <td id="T_59e3d_row11_col4" class="data row11 col4" >0.0000</td>
      <td id="T_59e3d_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_59e3d_row11_col6" class="data row11 col6" >0.0000</td>
      <td id="T_59e3d_row11_col7" class="data row11 col7" >0.0000</td>
      <td id="T_59e3d_row11_col8" class="data row11 col8" >0.1176</td>
      <td id="T_59e3d_row11_col9" class="data row11 col9" >0.0000</td>
      <td id="T_59e3d_row11_col10" class="data row11 col10" >0.0000</td>
      <td id="T_59e3d_row11_col11" class="data row11 col11" >0.0000</td>
      <td id="T_59e3d_row11_col12" class="data row11 col12" >0.0000</td>
      <td id="T_59e3d_row11_col13" class="data row11 col13" >0.0000</td>
      <td id="T_59e3d_row11_col14" class="data row11 col14" >0.0000</td>
      <td id="T_59e3d_row11_col15" class="data row11 col15" >0.0000</td>
      <td id="T_59e3d_row11_col16" class="data row11 col16" >0.0000</td>
      <td id="T_59e3d_row11_col17" class="data row11 col17" >0.3529</td>
      <td id="T_59e3d_row11_col18" class="data row11 col18" >0.0000</td>
      <td id="T_59e3d_row11_col19" class="data row11 col19" >0.0000</td>
      <td id="T_59e3d_row11_col20" class="data row11 col20" >0.1176</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate SPI median differences</span>
<span class="n">spei_difference_site_ensemble</span> <span class="o">=</span> <span class="n">comparison_monthly_statistics</span><span class="p">(</span><span class="n">spei_era5drought_site_ensemble</span><span class="p">,</span> <span class="n">spei_reproduced_site_ensemble</span><span class="p">)</span>

<span class="c1"># Display with style</span>
<span class="n">display_monthly_statistics</span><span class="p">(</span><span class="n">spei_difference_site_ensemble</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_5e7dd th.col_heading.level0.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col0 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col3 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col6 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col9 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col12 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col15 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level0.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading.level1.col18 {
  border-left: 1px solid #bbbbbb;
}
#T_5e7dd th.col_heading {
  border-bottom: 0;
}
#T_5e7dd table {
  border-collapse: separate;
  border-spacing: 0;
}
#T_5e7dd th.col_heading {
  text-align: center;
  vertical-align: bottom;
}
#T_5e7dd_row0_col0, #T_5e7dd_row0_col3, #T_5e7dd_row0_col6, #T_5e7dd_row0_col9, #T_5e7dd_row0_col12, #T_5e7dd_row0_col15, #T_5e7dd_row0_col18, #T_5e7dd_row1_col0, #T_5e7dd_row1_col3, #T_5e7dd_row1_col6, #T_5e7dd_row1_col9, #T_5e7dd_row1_col12, #T_5e7dd_row1_col15, #T_5e7dd_row1_col18, #T_5e7dd_row2_col0, #T_5e7dd_row2_col3, #T_5e7dd_row2_col6, #T_5e7dd_row2_col9, #T_5e7dd_row2_col12, #T_5e7dd_row2_col15, #T_5e7dd_row2_col18, #T_5e7dd_row3_col0, #T_5e7dd_row3_col3, #T_5e7dd_row3_col6, #T_5e7dd_row3_col9, #T_5e7dd_row3_col12, #T_5e7dd_row3_col15, #T_5e7dd_row3_col18, #T_5e7dd_row4_col0, #T_5e7dd_row4_col3, #T_5e7dd_row4_col6, #T_5e7dd_row4_col9, #T_5e7dd_row4_col12, #T_5e7dd_row4_col15, #T_5e7dd_row4_col18, #T_5e7dd_row5_col0, #T_5e7dd_row5_col3, #T_5e7dd_row5_col6, #T_5e7dd_row5_col9, #T_5e7dd_row5_col12, #T_5e7dd_row5_col15, #T_5e7dd_row5_col18, #T_5e7dd_row6_col0, #T_5e7dd_row6_col3, #T_5e7dd_row6_col6, #T_5e7dd_row6_col9, #T_5e7dd_row6_col12, #T_5e7dd_row6_col15, #T_5e7dd_row6_col18, #T_5e7dd_row7_col0, #T_5e7dd_row7_col3, #T_5e7dd_row7_col6, #T_5e7dd_row7_col9, #T_5e7dd_row7_col12, #T_5e7dd_row7_col15, #T_5e7dd_row7_col18, #T_5e7dd_row8_col0, #T_5e7dd_row8_col3, #T_5e7dd_row8_col6, #T_5e7dd_row8_col9, #T_5e7dd_row8_col12, #T_5e7dd_row8_col15, #T_5e7dd_row8_col18, #T_5e7dd_row9_col0, #T_5e7dd_row9_col3, #T_5e7dd_row9_col6, #T_5e7dd_row9_col9, #T_5e7dd_row9_col12, #T_5e7dd_row9_col15, #T_5e7dd_row9_col18, #T_5e7dd_row10_col0, #T_5e7dd_row10_col3, #T_5e7dd_row10_col6, #T_5e7dd_row10_col9, #T_5e7dd_row10_col12, #T_5e7dd_row10_col15, #T_5e7dd_row10_col18, #T_5e7dd_row11_col0, #T_5e7dd_row11_col3, #T_5e7dd_row11_col6, #T_5e7dd_row11_col9, #T_5e7dd_row11_col12, #T_5e7dd_row11_col15, #T_5e7dd_row11_col18 {
  border-left: 1px solid #bbbbbb;
}
</style>
<table id="T_5e7dd">
  <caption>Reproduced ‚Äì ERA5‚ÄìDrought</caption>
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_5e7dd_level0_col0" class="col_heading level0 col0" colspan="3">SPEI-1</th>
      <th id="T_5e7dd_level0_col3" class="col_heading level0 col3" colspan="3">SPEI-3</th>
      <th id="T_5e7dd_level0_col6" class="col_heading level0 col6" colspan="3">SPEI-6</th>
      <th id="T_5e7dd_level0_col9" class="col_heading level0 col9" colspan="3">SPEI-12</th>
      <th id="T_5e7dd_level0_col12" class="col_heading level0 col12" colspan="3">SPEI-24</th>
      <th id="T_5e7dd_level0_col15" class="col_heading level0 col15" colspan="3">SPEI-36</th>
      <th id="T_5e7dd_level0_col18" class="col_heading level0 col18" colspan="3">SPEI-48</th>
    </tr>
    <tr>
      <th class="blank level1" >&nbsp;</th>
      <th id="T_5e7dd_level1_col0" class="col_heading level1 col0" >MŒî</th>
      <th id="T_5e7dd_level1_col1" class="col_heading level1 col1" >M|Œî|</th>
      <th id="T_5e7dd_level1_col2" class="col_heading level1 col2" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col3" class="col_heading level1 col3" >MŒî</th>
      <th id="T_5e7dd_level1_col4" class="col_heading level1 col4" >M|Œî|</th>
      <th id="T_5e7dd_level1_col5" class="col_heading level1 col5" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col6" class="col_heading level1 col6" >MŒî</th>
      <th id="T_5e7dd_level1_col7" class="col_heading level1 col7" >M|Œî|</th>
      <th id="T_5e7dd_level1_col8" class="col_heading level1 col8" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col9" class="col_heading level1 col9" >MŒî</th>
      <th id="T_5e7dd_level1_col10" class="col_heading level1 col10" >M|Œî|</th>
      <th id="T_5e7dd_level1_col11" class="col_heading level1 col11" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col12" class="col_heading level1 col12" >MŒî</th>
      <th id="T_5e7dd_level1_col13" class="col_heading level1 col13" >M|Œî|</th>
      <th id="T_5e7dd_level1_col14" class="col_heading level1 col14" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col15" class="col_heading level1 col15" >MŒî</th>
      <th id="T_5e7dd_level1_col16" class="col_heading level1 col16" >M|Œî|</th>
      <th id="T_5e7dd_level1_col17" class="col_heading level1 col17" >|Œî| ‚â• 0.10</th>
      <th id="T_5e7dd_level1_col18" class="col_heading level1 col18" >MŒî</th>
      <th id="T_5e7dd_level1_col19" class="col_heading level1 col19" >M|Œî|</th>
      <th id="T_5e7dd_level1_col20" class="col_heading level1 col20" >|Œî| ‚â• 0.10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_5e7dd_level0_row0" class="row_heading level0 row0" >January</th>
      <td id="T_5e7dd_row0_col0" class="data row0 col0" >0.0000</td>
      <td id="T_5e7dd_row0_col1" class="data row0 col1" >0.0000</td>
      <td id="T_5e7dd_row0_col2" class="data row0 col2" >0.0000</td>
      <td id="T_5e7dd_row0_col3" class="data row0 col3" >0.0000</td>
      <td id="T_5e7dd_row0_col4" class="data row0 col4" >0.0004</td>
      <td id="T_5e7dd_row0_col5" class="data row0 col5" >0.0000</td>
      <td id="T_5e7dd_row0_col6" class="data row0 col6" >-0.0000</td>
      <td id="T_5e7dd_row0_col7" class="data row0 col7" >0.0000</td>
      <td id="T_5e7dd_row0_col8" class="data row0 col8" >0.0000</td>
      <td id="T_5e7dd_row0_col9" class="data row0 col9" >-0.0000</td>
      <td id="T_5e7dd_row0_col10" class="data row0 col10" >0.0000</td>
      <td id="T_5e7dd_row0_col11" class="data row0 col11" >0.0000</td>
      <td id="T_5e7dd_row0_col12" class="data row0 col12" >-0.0000</td>
      <td id="T_5e7dd_row0_col13" class="data row0 col13" >0.0000</td>
      <td id="T_5e7dd_row0_col14" class="data row0 col14" >0.0000</td>
      <td id="T_5e7dd_row0_col15" class="data row0 col15" >0.0000</td>
      <td id="T_5e7dd_row0_col16" class="data row0 col16" >0.0000</td>
      <td id="T_5e7dd_row0_col17" class="data row0 col17" >0.0000</td>
      <td id="T_5e7dd_row0_col18" class="data row0 col18" >0.0000</td>
      <td id="T_5e7dd_row0_col19" class="data row0 col19" >0.0000</td>
      <td id="T_5e7dd_row0_col20" class="data row0 col20" >0.0000</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row1" class="row_heading level0 row1" >February</th>
      <td id="T_5e7dd_row1_col0" class="data row1 col0" >0.0120</td>
      <td id="T_5e7dd_row1_col1" class="data row1 col1" >0.0160</td>
      <td id="T_5e7dd_row1_col2" class="data row1 col2" >0.0000</td>
      <td id="T_5e7dd_row1_col3" class="data row1 col3" >0.0051</td>
      <td id="T_5e7dd_row1_col4" class="data row1 col4" >0.0116</td>
      <td id="T_5e7dd_row1_col5" class="data row1 col5" >0.0000</td>
      <td id="T_5e7dd_row1_col6" class="data row1 col6" >-0.0447</td>
      <td id="T_5e7dd_row1_col7" class="data row1 col7" >0.0449</td>
      <td id="T_5e7dd_row1_col8" class="data row1 col8" >0.2353</td>
      <td id="T_5e7dd_row1_col9" class="data row1 col9" >-0.0353</td>
      <td id="T_5e7dd_row1_col10" class="data row1 col10" >0.0368</td>
      <td id="T_5e7dd_row1_col11" class="data row1 col11" >6.8235</td>
      <td id="T_5e7dd_row1_col12" class="data row1 col12" >-0.0371</td>
      <td id="T_5e7dd_row1_col13" class="data row1 col13" >0.0490</td>
      <td id="T_5e7dd_row1_col14" class="data row1 col14" >17.8824</td>
      <td id="T_5e7dd_row1_col15" class="data row1 col15" >-0.0444</td>
      <td id="T_5e7dd_row1_col16" class="data row1 col16" >0.0450</td>
      <td id="T_5e7dd_row1_col17" class="data row1 col17" >6.5882</td>
      <td id="T_5e7dd_row1_col18" class="data row1 col18" >-0.0704</td>
      <td id="T_5e7dd_row1_col19" class="data row1 col19" >0.0812</td>
      <td id="T_5e7dd_row1_col20" class="data row1 col20" >41.0588</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row2" class="row_heading level0 row2" >March</th>
      <td id="T_5e7dd_row2_col0" class="data row2 col0" >0.0006</td>
      <td id="T_5e7dd_row2_col1" class="data row2 col1" >0.0192</td>
      <td id="T_5e7dd_row2_col2" class="data row2 col2" >0.0000</td>
      <td id="T_5e7dd_row2_col3" class="data row2 col3" >0.0224</td>
      <td id="T_5e7dd_row2_col4" class="data row2 col4" >0.0245</td>
      <td id="T_5e7dd_row2_col5" class="data row2 col5" >0.0000</td>
      <td id="T_5e7dd_row2_col6" class="data row2 col6" >-0.0028</td>
      <td id="T_5e7dd_row2_col7" class="data row2 col7" >0.0220</td>
      <td id="T_5e7dd_row2_col8" class="data row2 col8" >0.0000</td>
      <td id="T_5e7dd_row2_col9" class="data row2 col9" >-0.0435</td>
      <td id="T_5e7dd_row2_col10" class="data row2 col10" >0.0574</td>
      <td id="T_5e7dd_row2_col11" class="data row2 col11" >28.4706</td>
      <td id="T_5e7dd_row2_col12" class="data row2 col12" >-0.0405</td>
      <td id="T_5e7dd_row2_col13" class="data row2 col13" >0.0486</td>
      <td id="T_5e7dd_row2_col14" class="data row2 col14" >8.9412</td>
      <td id="T_5e7dd_row2_col15" class="data row2 col15" >-0.0428</td>
      <td id="T_5e7dd_row2_col16" class="data row2 col16" >0.0464</td>
      <td id="T_5e7dd_row2_col17" class="data row2 col17" >2.5882</td>
      <td id="T_5e7dd_row2_col18" class="data row2 col18" >-0.0859</td>
      <td id="T_5e7dd_row2_col19" class="data row2 col19" >0.0920</td>
      <td id="T_5e7dd_row2_col20" class="data row2 col20" >44.8235</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row3" class="row_heading level0 row3" >April</th>
      <td id="T_5e7dd_row3_col0" class="data row3 col0" >-0.0100</td>
      <td id="T_5e7dd_row3_col1" class="data row3 col1" >0.0142</td>
      <td id="T_5e7dd_row3_col2" class="data row3 col2" >0.0000</td>
      <td id="T_5e7dd_row3_col3" class="data row3 col3" >0.0133</td>
      <td id="T_5e7dd_row3_col4" class="data row3 col4" >0.0221</td>
      <td id="T_5e7dd_row3_col5" class="data row3 col5" >0.0000</td>
      <td id="T_5e7dd_row3_col6" class="data row3 col6" >0.0005</td>
      <td id="T_5e7dd_row3_col7" class="data row3 col7" >0.0236</td>
      <td id="T_5e7dd_row3_col8" class="data row3 col8" >0.0000</td>
      <td id="T_5e7dd_row3_col9" class="data row3 col9" >-0.0355</td>
      <td id="T_5e7dd_row3_col10" class="data row3 col10" >0.0420</td>
      <td id="T_5e7dd_row3_col11" class="data row3 col11" >11.1765</td>
      <td id="T_5e7dd_row3_col12" class="data row3 col12" >-0.0186</td>
      <td id="T_5e7dd_row3_col13" class="data row3 col13" >0.0379</td>
      <td id="T_5e7dd_row3_col14" class="data row3 col14" >5.1765</td>
      <td id="T_5e7dd_row3_col15" class="data row3 col15" >-0.0743</td>
      <td id="T_5e7dd_row3_col16" class="data row3 col16" >0.0754</td>
      <td id="T_5e7dd_row3_col17" class="data row3 col17" >34.7059</td>
      <td id="T_5e7dd_row3_col18" class="data row3 col18" >-0.0664</td>
      <td id="T_5e7dd_row3_col19" class="data row3 col19" >0.0700</td>
      <td id="T_5e7dd_row3_col20" class="data row3 col20" >38.5882</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row4" class="row_heading level0 row4" >May</th>
      <td id="T_5e7dd_row4_col0" class="data row4 col0" >-0.0140</td>
      <td id="T_5e7dd_row4_col1" class="data row4 col1" >0.0273</td>
      <td id="T_5e7dd_row4_col2" class="data row4 col2" >1.4118</td>
      <td id="T_5e7dd_row4_col3" class="data row4 col3" >-0.0124</td>
      <td id="T_5e7dd_row4_col4" class="data row4 col4" >0.0233</td>
      <td id="T_5e7dd_row4_col5" class="data row4 col5" >0.1176</td>
      <td id="T_5e7dd_row4_col6" class="data row4 col6" >-0.0072</td>
      <td id="T_5e7dd_row4_col7" class="data row4 col7" >0.0177</td>
      <td id="T_5e7dd_row4_col8" class="data row4 col8" >0.3529</td>
      <td id="T_5e7dd_row4_col9" class="data row4 col9" >-0.0410</td>
      <td id="T_5e7dd_row4_col10" class="data row4 col10" >0.0421</td>
      <td id="T_5e7dd_row4_col11" class="data row4 col11" >2.4706</td>
      <td id="T_5e7dd_row4_col12" class="data row4 col12" >-0.0034</td>
      <td id="T_5e7dd_row4_col13" class="data row4 col13" >0.0274</td>
      <td id="T_5e7dd_row4_col14" class="data row4 col14" >13.1765</td>
      <td id="T_5e7dd_row4_col15" class="data row4 col15" >-0.0484</td>
      <td id="T_5e7dd_row4_col16" class="data row4 col16" >0.0497</td>
      <td id="T_5e7dd_row4_col17" class="data row4 col17" >11.5294</td>
      <td id="T_5e7dd_row4_col18" class="data row4 col18" >-0.0186</td>
      <td id="T_5e7dd_row4_col19" class="data row4 col19" >0.0405</td>
      <td id="T_5e7dd_row4_col20" class="data row4 col20" >15.2941</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row5" class="row_heading level0 row5" >June</th>
      <td id="T_5e7dd_row5_col0" class="data row5 col0" >-0.0245</td>
      <td id="T_5e7dd_row5_col1" class="data row5 col1" >0.0271</td>
      <td id="T_5e7dd_row5_col2" class="data row5 col2" >3.7647</td>
      <td id="T_5e7dd_row5_col3" class="data row5 col3" >-0.0232</td>
      <td id="T_5e7dd_row5_col4" class="data row5 col4" >0.0256</td>
      <td id="T_5e7dd_row5_col5" class="data row5 col5" >0.0000</td>
      <td id="T_5e7dd_row5_col6" class="data row5 col6" >-0.0092</td>
      <td id="T_5e7dd_row5_col7" class="data row5 col7" >0.0207</td>
      <td id="T_5e7dd_row5_col8" class="data row5 col8" >1.0588</td>
      <td id="T_5e7dd_row5_col9" class="data row5 col9" >-0.0366</td>
      <td id="T_5e7dd_row5_col10" class="data row5 col10" >0.0367</td>
      <td id="T_5e7dd_row5_col11" class="data row5 col11" >0.1176</td>
      <td id="T_5e7dd_row5_col12" class="data row5 col12" >-0.0005</td>
      <td id="T_5e7dd_row5_col13" class="data row5 col13" >0.0255</td>
      <td id="T_5e7dd_row5_col14" class="data row5 col14" >5.6471</td>
      <td id="T_5e7dd_row5_col15" class="data row5 col15" >-0.0661</td>
      <td id="T_5e7dd_row5_col16" class="data row5 col16" >0.0684</td>
      <td id="T_5e7dd_row5_col17" class="data row5 col17" >30.7059</td>
      <td id="T_5e7dd_row5_col18" class="data row5 col18" >-0.0168</td>
      <td id="T_5e7dd_row5_col19" class="data row5 col19" >0.0476</td>
      <td id="T_5e7dd_row5_col20" class="data row5 col20" >17.8824</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row6" class="row_heading level0 row6" >July</th>
      <td id="T_5e7dd_row6_col0" class="data row6 col0" >-0.0667</td>
      <td id="T_5e7dd_row6_col1" class="data row6 col1" >0.0781</td>
      <td id="T_5e7dd_row6_col2" class="data row6 col2" >36.5882</td>
      <td id="T_5e7dd_row6_col3" class="data row6 col3" >-0.0283</td>
      <td id="T_5e7dd_row6_col4" class="data row6 col4" >0.0322</td>
      <td id="T_5e7dd_row6_col5" class="data row6 col5" >6.1176</td>
      <td id="T_5e7dd_row6_col6" class="data row6 col6" >-0.0221</td>
      <td id="T_5e7dd_row6_col7" class="data row6 col7" >0.0265</td>
      <td id="T_5e7dd_row6_col8" class="data row6 col8" >1.8824</td>
      <td id="T_5e7dd_row6_col9" class="data row6 col9" >-0.0379</td>
      <td id="T_5e7dd_row6_col10" class="data row6 col10" >0.0383</td>
      <td id="T_5e7dd_row6_col11" class="data row6 col11" >0.2353</td>
      <td id="T_5e7dd_row6_col12" class="data row6 col12" >-0.0119</td>
      <td id="T_5e7dd_row6_col13" class="data row6 col13" >0.0294</td>
      <td id="T_5e7dd_row6_col14" class="data row6 col14" >10.9412</td>
      <td id="T_5e7dd_row6_col15" class="data row6 col15" >-0.0760</td>
      <td id="T_5e7dd_row6_col16" class="data row6 col16" >0.0760</td>
      <td id="T_5e7dd_row6_col17" class="data row6 col17" >36.7059</td>
      <td id="T_5e7dd_row6_col18" class="data row6 col18" >-0.0255</td>
      <td id="T_5e7dd_row6_col19" class="data row6 col19" >0.0488</td>
      <td id="T_5e7dd_row6_col20" class="data row6 col20" >21.2941</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row7" class="row_heading level0 row7" >August</th>
      <td id="T_5e7dd_row7_col0" class="data row7 col0" >-0.1216</td>
      <td id="T_5e7dd_row7_col1" class="data row7 col1" >0.1376</td>
      <td id="T_5e7dd_row7_col2" class="data row7 col2" >59.2941</td>
      <td id="T_5e7dd_row7_col3" class="data row7 col3" >-0.0707</td>
      <td id="T_5e7dd_row7_col4" class="data row7 col4" >0.0815</td>
      <td id="T_5e7dd_row7_col5" class="data row7 col5" >45.8824</td>
      <td id="T_5e7dd_row7_col6" class="data row7 col6" >-0.0411</td>
      <td id="T_5e7dd_row7_col7" class="data row7 col7" >0.0417</td>
      <td id="T_5e7dd_row7_col8" class="data row7 col8" >4.1176</td>
      <td id="T_5e7dd_row7_col9" class="data row7 col9" >-0.0474</td>
      <td id="T_5e7dd_row7_col10" class="data row7 col10" >0.0479</td>
      <td id="T_5e7dd_row7_col11" class="data row7 col11" >2.7059</td>
      <td id="T_5e7dd_row7_col12" class="data row7 col12" >-0.0270</td>
      <td id="T_5e7dd_row7_col13" class="data row7 col13" >0.0408</td>
      <td id="T_5e7dd_row7_col14" class="data row7 col14" >13.6471</td>
      <td id="T_5e7dd_row7_col15" class="data row7 col15" >-0.1055</td>
      <td id="T_5e7dd_row7_col16" class="data row7 col16" >0.1055</td>
      <td id="T_5e7dd_row7_col17" class="data row7 col17" >49.7647</td>
      <td id="T_5e7dd_row7_col18" class="data row7 col18" >-0.0506</td>
      <td id="T_5e7dd_row7_col19" class="data row7 col19" >0.0564</td>
      <td id="T_5e7dd_row7_col20" class="data row7 col20" >25.8824</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row8" class="row_heading level0 row8" >September</th>
      <td id="T_5e7dd_row8_col0" class="data row8 col0" >-0.0247</td>
      <td id="T_5e7dd_row8_col1" class="data row8 col1" >0.0316</td>
      <td id="T_5e7dd_row8_col2" class="data row8 col2" >4.1176</td>
      <td id="T_5e7dd_row8_col3" class="data row8 col3" >-0.0907</td>
      <td id="T_5e7dd_row8_col4" class="data row8 col4" >0.1038</td>
      <td id="T_5e7dd_row8_col5" class="data row8 col5" >50.7059</td>
      <td id="T_5e7dd_row8_col6" class="data row8 col6" >-0.0513</td>
      <td id="T_5e7dd_row8_col7" class="data row8 col7" >0.0519</td>
      <td id="T_5e7dd_row8_col8" class="data row8 col8" >10.9412</td>
      <td id="T_5e7dd_row8_col9" class="data row8 col9" >-0.0407</td>
      <td id="T_5e7dd_row8_col10" class="data row8 col10" >0.0417</td>
      <td id="T_5e7dd_row8_col11" class="data row8 col11" >0.3529</td>
      <td id="T_5e7dd_row8_col12" class="data row8 col12" >-0.0523</td>
      <td id="T_5e7dd_row8_col13" class="data row8 col13" >0.0538</td>
      <td id="T_5e7dd_row8_col14" class="data row8 col14" >14.9412</td>
      <td id="T_5e7dd_row8_col15" class="data row8 col15" >-0.0835</td>
      <td id="T_5e7dd_row8_col16" class="data row8 col16" >0.0835</td>
      <td id="T_5e7dd_row8_col17" class="data row8 col17" >42.8235</td>
      <td id="T_5e7dd_row8_col18" class="data row8 col18" >-0.0490</td>
      <td id="T_5e7dd_row8_col19" class="data row8 col19" >0.0502</td>
      <td id="T_5e7dd_row8_col20" class="data row8 col20" >18.9412</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row9" class="row_heading level0 row9" >October</th>
      <td id="T_5e7dd_row9_col0" class="data row9 col0" >0.0071</td>
      <td id="T_5e7dd_row9_col1" class="data row9 col1" >0.0136</td>
      <td id="T_5e7dd_row9_col2" class="data row9 col2" >0.0000</td>
      <td id="T_5e7dd_row9_col3" class="data row9 col3" >-0.0487</td>
      <td id="T_5e7dd_row9_col4" class="data row9 col4" >0.0493</td>
      <td id="T_5e7dd_row9_col5" class="data row9 col5" >6.7059</td>
      <td id="T_5e7dd_row9_col6" class="data row9 col6" >-0.0464</td>
      <td id="T_5e7dd_row9_col7" class="data row9 col7" >0.0502</td>
      <td id="T_5e7dd_row9_col8" class="data row9 col8" >14.5882</td>
      <td id="T_5e7dd_row9_col9" class="data row9 col9" >-0.0313</td>
      <td id="T_5e7dd_row9_col10" class="data row9 col10" >0.0319</td>
      <td id="T_5e7dd_row9_col11" class="data row9 col11" >0.1176</td>
      <td id="T_5e7dd_row9_col12" class="data row9 col12" >-0.0486</td>
      <td id="T_5e7dd_row9_col13" class="data row9 col13" >0.0604</td>
      <td id="T_5e7dd_row9_col14" class="data row9 col14" >26.0000</td>
      <td id="T_5e7dd_row9_col15" class="data row9 col15" >-0.0842</td>
      <td id="T_5e7dd_row9_col16" class="data row9 col16" >0.0842</td>
      <td id="T_5e7dd_row9_col17" class="data row9 col17" >41.4118</td>
      <td id="T_5e7dd_row9_col18" class="data row9 col18" >-0.0433</td>
      <td id="T_5e7dd_row9_col19" class="data row9 col19" >0.0445</td>
      <td id="T_5e7dd_row9_col20" class="data row9 col20" >9.6471</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row10" class="row_heading level0 row10" >November</th>
      <td id="T_5e7dd_row10_col0" class="data row10 col0" >0.0027</td>
      <td id="T_5e7dd_row10_col1" class="data row10 col1" >0.0139</td>
      <td id="T_5e7dd_row10_col2" class="data row10 col2" >0.0000</td>
      <td id="T_5e7dd_row10_col3" class="data row10 col3" >-0.0011</td>
      <td id="T_5e7dd_row10_col4" class="data row10 col4" >0.0202</td>
      <td id="T_5e7dd_row10_col5" class="data row10 col5" >0.9412</td>
      <td id="T_5e7dd_row10_col6" class="data row10 col6" >-0.0515</td>
      <td id="T_5e7dd_row10_col7" class="data row10 col7" >0.0516</td>
      <td id="T_5e7dd_row10_col8" class="data row10 col8" >16.5882</td>
      <td id="T_5e7dd_row10_col9" class="data row10 col9" >-0.0367</td>
      <td id="T_5e7dd_row10_col10" class="data row10 col10" >0.0409</td>
      <td id="T_5e7dd_row10_col11" class="data row10 col11" >0.9412</td>
      <td id="T_5e7dd_row10_col12" class="data row10 col12" >-0.0459</td>
      <td id="T_5e7dd_row10_col13" class="data row10 col13" >0.0576</td>
      <td id="T_5e7dd_row10_col14" class="data row10 col14" >19.5294</td>
      <td id="T_5e7dd_row10_col15" class="data row10 col15" >-0.0809</td>
      <td id="T_5e7dd_row10_col16" class="data row10 col16" >0.0809</td>
      <td id="T_5e7dd_row10_col17" class="data row10 col17" >39.8824</td>
      <td id="T_5e7dd_row10_col18" class="data row10 col18" >-0.0451</td>
      <td id="T_5e7dd_row10_col19" class="data row10 col19" >0.0465</td>
      <td id="T_5e7dd_row10_col20" class="data row10 col20" >10.7059</td>
    </tr>
    <tr>
      <th id="T_5e7dd_level0_row11" class="row_heading level0 row11" >December</th>
      <td id="T_5e7dd_row11_col0" class="data row11 col0" >0.0256</td>
      <td id="T_5e7dd_row11_col1" class="data row11 col1" >0.0256</td>
      <td id="T_5e7dd_row11_col2" class="data row11 col2" >0.0000</td>
      <td id="T_5e7dd_row11_col3" class="data row11 col3" >0.0211</td>
      <td id="T_5e7dd_row11_col4" class="data row11 col4" >0.0225</td>
      <td id="T_5e7dd_row11_col5" class="data row11 col5" >0.0000</td>
      <td id="T_5e7dd_row11_col6" class="data row11 col6" >-0.0514</td>
      <td id="T_5e7dd_row11_col7" class="data row11 col7" >0.0543</td>
      <td id="T_5e7dd_row11_col8" class="data row11 col8" >14.2353</td>
      <td id="T_5e7dd_row11_col9" class="data row11 col9" >-0.0313</td>
      <td id="T_5e7dd_row11_col10" class="data row11 col10" >0.0372</td>
      <td id="T_5e7dd_row11_col11" class="data row11 col11" >2.3529</td>
      <td id="T_5e7dd_row11_col12" class="data row11 col12" >-0.0490</td>
      <td id="T_5e7dd_row11_col13" class="data row11 col13" >0.0616</td>
      <td id="T_5e7dd_row11_col14" class="data row11 col14" >28.4706</td>
      <td id="T_5e7dd_row11_col15" class="data row11 col15" >-0.0919</td>
      <td id="T_5e7dd_row11_col16" class="data row11 col16" >0.0919</td>
      <td id="T_5e7dd_row11_col17" class="data row11 col17" >45.1765</td>
      <td id="T_5e7dd_row11_col18" class="data row11 col18" >-0.0488</td>
      <td id="T_5e7dd_row11_col19" class="data row11 col19" >0.0505</td>
      <td id="T_5e7dd_row11_col20" class="data row11 col20" >18.2353</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>These statistics are similar to those seen in the control member comparison as well as the reanalysis comparison,
as are the time series comparisons for SPI
(Figures <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-0"><span class="std std-numref">6.1.17</span></a>‚Äì<a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-9"><span class="std std-numref">6.1.26</span></a>;
compare Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries"><span class="std std-numref">6.1.2</span></a>)
and SPEI
(Figures <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-0"><span class="std std-numref">6.1.27</span></a>‚Äì<a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-9"><span class="std std-numref">6.1.36</span></a>;
compare Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries"><span class="std std-numref">6.1.11</span></a>).
As such, we can extend our conclusions on the reproducibility of ERA5‚ÄìDrought from ERA5 to the entire ensemble dataset.</p>
<p>Notably,
some of the perturbed members are much spikier than the reanalysis
(e.g. SPI-1 for member 7; Figure <a class="reference internal" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-7"><span class="std std-numref">6.1.24</span></a>)
with extreme values of and changes in SPI / SPEI for short accumulation periods.
These spikes are generally well-reproduced.
For further analysis of the behaviour of the ERA5‚ÄìDrought ensemble,
including the associated quality flags,
we refer the reader to
a forthcoming assessment on the uncertainty in ERA5‚ÄìDrought.</p>
<!-- Swap this in when both assessments have been merged into main.
[](./indicator_derived-drought-historical-monthly_uncertainty_q01).
--><div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># trange: range with tqdm progress bar</span>
    <span class="n">plot_time_series_comparison_spi</span><span class="p">(</span><span class="n">spi_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">m</span><span class="p">),</span>
                                    <span class="n">spi_reproduced_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">m</span><span class="p">),</span>
                                    <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2"> (ensemble member </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                                    <span class="n">glue_label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spi-timeseries_ens_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-14" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble0" for="sd-tab-item-14">
Member 0</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-0">
<img alt="../_images/f1ac17b13c31a55477d73dd275b9e1b3b3af7a0b469fff783c1760df4648a5d3.png" src="../_images/f1ac17b13c31a55477d73dd275b9e1b3b3af7a0b469fff783c1760df4648a5d3.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.17 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-0" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-15" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble1" for="sd-tab-item-15">
Member 1</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-1">
<img alt="../_images/f7828879d48e9916223d0df147e8ec370190c593470d765caf725e8d7f802712.png" src="../_images/f7828879d48e9916223d0df147e8ec370190c593470d765caf725e8d7f802712.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.18 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-16" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble2" for="sd-tab-item-16">
Member 2</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-2">
<img alt="../_images/c18bfb6d91328d038b497263316c00c20fee251223b0d1ee280db159bd715e25.png" src="../_images/c18bfb6d91328d038b497263316c00c20fee251223b0d1ee280db159bd715e25.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.19 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-17" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble3" for="sd-tab-item-17">
Member 3</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-3">
<img alt="../_images/b9e4f050ad44e0ab05796435c4cafefe72837b8031ac782268712402a9eb70dd.png" src="../_images/b9e4f050ad44e0ab05796435c4cafefe72837b8031ac782268712402a9eb70dd.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.20 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-3" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-18" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble4" for="sd-tab-item-18">
Member 4</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-4">
<img alt="../_images/16063bdc93891d9c124a04cf64e92a55601daefd3f550c852aa827d53d34dfaf.png" src="../_images/16063bdc93891d9c124a04cf64e92a55601daefd3f550c852aa827d53d34dfaf.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.21 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-19" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble5" for="sd-tab-item-19">
Member 5</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-5">
<img alt="../_images/54f84b57472c18e18f82022b5993987f66a618a7c4135706d37077e4bb2e7b32.png" src="../_images/54f84b57472c18e18f82022b5993987f66a618a7c4135706d37077e4bb2e7b32.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.22 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-5" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-20" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble6" for="sd-tab-item-20">
Member 6</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-6">
<img alt="../_images/21daa0de7eac4c6e8d1dd10286b74619a2275c569804eacb9d9bea95bb33f60f.png" src="../_images/21daa0de7eac4c6e8d1dd10286b74619a2275c569804eacb9d9bea95bb33f60f.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.23 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-21" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble8" for="sd-tab-item-21">
Member 7</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-7">
<img alt="../_images/b1b635bd63412290395cf8d3d78459a91afdb434f00f17bd77719e9463d083f4.png" src="../_images/b1b635bd63412290395cf8d3d78459a91afdb434f00f17bd77719e9463d083f4.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.24 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-7" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-22" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble8" for="sd-tab-item-22">
Member 8</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-8">
<img alt="../_images/79396d90ed3c5456a4a0148d4a2481d872bb26fc06f4a3685b66a6d9c17d4b97.png" src="../_images/79396d90ed3c5456a4a0148d4a2481d872bb26fc06f4a3685b66a6d9c17d4b97.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.25 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-8" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-23" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble9" for="sd-tab-item-23">
Member 9</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-9">
<img alt="../_images/5926975bc30ea223df39d17937481d54ef9a89c0128d28bd226eb720c9689409.png" src="../_images/5926975bc30ea223df39d17937481d54ef9a89c0128d28bd226eb720c9689409.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.26 </span><span class="caption-text">SPI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spi-timeseries-ens-9" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># trange: range with tqdm progress bar</span>
    <span class="n">plot_time_series_comparison_spei</span><span class="p">(</span><span class="n">spei_era5drought_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">m</span><span class="p">),</span>
                                     <span class="n">spei_reproduced_site_ensemble</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">m</span><span class="p">),</span>
                                     <span class="n">title_suffix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; at </span><span class="si">{</span><span class="n">label_site</span><span class="si">}</span><span class="s2"> (ensemble member </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                                     <span class="n">glue_label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;indicator_derived-drought-historical-monthly_consistency_q01_fig-spei-timeseries_ens_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-24" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble0" for="sd-tab-item-24">
Member 0</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-0">
<img alt="../_images/d471ae834098faa73123b01234678240cc6223ebb1e471b13a6fed908622d9de.png" src="../_images/d471ae834098faa73123b01234678240cc6223ebb1e471b13a6fed908622d9de.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.27 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-0" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-25" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble1" for="sd-tab-item-25">
Member 1</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-1">
<img alt="../_images/e1f82bf6d55184cdc424087c275b34cc4112ce4c4b75e40c9be4f1aa5da9a5c0.png" src="../_images/e1f82bf6d55184cdc424087c275b34cc4112ce4c4b75e40c9be4f1aa5da9a5c0.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.28 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-26" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble2" for="sd-tab-item-26">
Member 2</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-2">
<img alt="../_images/b96452f4ee076c2fdb156bf916da0e69e00db3fe8274d0628d465dd76b971b81.png" src="../_images/b96452f4ee076c2fdb156bf916da0e69e00db3fe8274d0628d465dd76b971b81.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.29 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-27" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble3" for="sd-tab-item-27">
Member 3</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-3">
<img alt="../_images/f31dc7b50033927a9ff4207a30ca7812604da70fea43427e4e865042e5d41684.png" src="../_images/f31dc7b50033927a9ff4207a30ca7812604da70fea43427e4e865042e5d41684.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.30 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-3" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-28" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble4" for="sd-tab-item-28">
Member 4</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-4">
<img alt="../_images/c699d40d87d59e2409ef9a44ab345359cc91a79aad352b2b10c2f43ee9829bc1.png" src="../_images/c699d40d87d59e2409ef9a44ab345359cc91a79aad352b2b10c2f43ee9829bc1.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.31 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-29" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble5" for="sd-tab-item-29">
Member 5</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-5">
<img alt="../_images/bc42a36106e290e6512c98c5bed7a44dcb9bcc356e1ef6813ab91c2176afccc5.png" src="../_images/bc42a36106e290e6512c98c5bed7a44dcb9bcc356e1ef6813ab91c2176afccc5.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.32 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-5" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-30" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble6" for="sd-tab-item-30">
Member 6</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-6">
<img alt="../_images/3a5380b293ffd85ac5b2783400c9c03fc950023c47b2d9890969295c484ee09a.png" src="../_images/3a5380b293ffd85ac5b2783400c9c03fc950023c47b2d9890969295c484ee09a.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.33 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-31" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble8" for="sd-tab-item-31">
Member 7</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-7">
<img alt="../_images/af48b74e37d8ba782d4318fe2266ceed53bcf495f34d7704d2c92ae1ebffc72c.png" src="../_images/af48b74e37d8ba782d4318fe2266ceed53bcf495f34d7704d2c92ae1ebffc72c.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.34 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-7" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-32" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble8" for="sd-tab-item-32">
Member 8</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-8">
<img alt="../_images/26a48c932b79b16d381e8024474382925b3271e332eba659d1aa5e5c5a150991.png" src="../_images/26a48c932b79b16d381e8024474382925b3271e332eba659d1aa5e5c5a150991.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.35 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-8" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<input id="sd-tab-item-33" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ensemble9" for="sd-tab-item-33">
Member 9</label><div class="sd-tab-content docutils">
<figure class="align-default" id="indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-9">
<img alt="../_images/705bdaacc0a686f2886e570503a4b1680afe26f281632437b42de3ee04d6b378.png" src="../_images/705bdaacc0a686f2886e570503a4b1680afe26f281632437b42de3ee04d6b378.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.1.36 </span><span class="caption-text">SPEI time series downloaded from ERA5‚ÄìDrought and reproduced from ERA5 precipitation data (left) and the difference between the two (right), for the example site of Addis Ababa, Ethiopia.
Colours in the left-hand column correspond to SPEI categories (e.g. ‚Äúextremely dry‚Äù) in [<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>].
This panel shows one member of the ensemble in either dataset.</span><a class="headerlink" href="#indicator-derived-drought-historical-monthly-consistency-q01-fig-spei-timeseries-ens-9" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</div>
</section>
</section>
</section>
<section id="conclusions">
<span id="indicator-derived-drought-historical-monthly-consistency-q01-section-conclusion"></span><h3>6. Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h3>
<p>In this notebook, we have assessed the reproducibility of drought indicators and associated quality flags in ERA5‚ÄìDrought based on the underpinning ERA5 data.
A pipeline for reproducing SPI and SPEI from ERA5 data was set up and applied to both the main reanalysis and the ensemble.
Comparisons were made in one example site
(Addis Ababa in Ethiopia)
and the surrounding region
(Horn of Africa);
this notebook can easily be downloaded and adapted to a different area or time span of interest.</p>
<p>We can conclude that ERA5‚ÄìDrought is highly reproducible.
For SPI, reproduced values were generally identical to values in ERA5‚ÄìDrought,
with discrepancies taking the form of isolated spikes or occurring in areas that would be quality-masked anyway.
The same was true for the probability of zero precipitation (<em>p<sub>0</sub></em>) quality flag,
which matched in ‚â•99% of match-ups.
Larger differences were seen in the SPI normality (<em>Œ±</em>) quality flag (‚â•74% agreement)
for reasons that are not entirely clear
but likely related to zero-precipitation months that are captured by the <em>p<sub>0</sub></em> quality flag.
For SPEI,
differences were larger,
which may be explained by differences in the processing pipeline
such as the exact choice of general logistic distribution used,
but still small and unlikely to impact common use cases for drought classification and monitoring.
The SPEI normality (<em>Œ±</em>) quality flag showed good agreement (‚â•87%),
especially considering the differences in the fitted distributions.</p>
<p>Users who intend to use ERA5‚ÄìDrought can do so confidently.
The included quality flags can be used to filter out low-quality data.
Some of the effects seen in this notebook,
such as slight differences in fitted parameters,
are an inherent source of uncertainty in indicators like SPI and SPEI in any dataset.
For a deeper exploration of the uncertainty in ERA5‚ÄìDrought
based on the included ensemble,
we refer the reader to
a forthcoming assessment on this subject.</p>
<!-- Swap this in when both assessments have been merged into main.
[](./indicator_derived-drought-historical-monthly_uncertainty_q01).
--></section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Complete ERA5 global atmospheric reanalysis: <a class="reference external" href="https://doi.org/10.24381/cds.143582cf" rel="noreferrer" target="_blank">reanalysis-era5-complete</a></p></li>
<li><p>ERA5 hourly data on single levels from 1940 to present: <a class="reference external" href="https://doi.org/10.24381/cds.adbb2d47" rel="noreferrer" target="_blank">reanalysis-era5-single-levels</a></p></li>
<li><p>Monthly drought indices from 1940 to present derived from ERA5 reanalysis: <a class="reference external" href="https://doi.org/10.24381/9bea5e16" rel="noreferrer" target="_blank">derived-drought-historical-monthly</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit" rel="noreferrer" target="_blank">earthkit</a></p>
<ul>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-data" rel="noreferrer" target="_blank">earthkit-data</a></p></li>
<li><p><a class="reference external" href="https://github.com/ecmwf/earthkit-plots" rel="noreferrer" target="_blank">earthkit-plots</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html" rel="noreferrer" target="_blank">scipy.stats</a></p></li>
</ul>
<p>More about drought indicators:</p>
<ul class="simple">
<li><p>SPI: <a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf" rel="noreferrer" target="_blank">The relationship of drought frequency and duration to time scales</a></p></li>
<li><p>SPEI: <a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1" rel="noreferrer" target="_blank">A Multiscalar Drought Index Sensitive to Global Warming: The Standardized Precipitation Evapotranspiration Index</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1002/joc.4267" rel="noreferrer" target="_blank">Candidate Distributions for Climatological Drought Indices (SPI and SPEI)</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">ERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis</a></p></li>
<li><p><a class="reference external" href="https://drought.emergency.copernicus.eu/" rel="noreferrer" target="_blank">The European and Global Drought Observatories (EDO, GDO)</a></p></li>
</ul>
<p>More about ERA5:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">The ERA5 global reanalysis</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1002/qj.4803" rel="noreferrer" target="_blank">The ERA5 global reanalysis from 1940 to 2022</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.21957/obke4k60" rel="noreferrer" target="_blank">Ensemble of data assimilations at ECMWF</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p>[<a class="reference external" href="https://eciu.net/analysis/reports/2025/estimated-financial-losses-faced-by-uk-farmers-due-dry-weather-impacts-on-key-arable-crops" rel="noreferrer" target="_blank">ECIU+25</a>] Energy &amp; Climate Intelligence Unit, ‚ÄòEstimated financial losses faced by UK farmers due dry weather impacts on key arable crops‚Äô, Energy &amp; Climate Intelligence Unit, London, United Kingdom, Dec. 2025.</p>
<p>[<a class="reference external" href="https://doi.org/10.59327/IPCC/AR6-9789291691647" rel="noreferrer" target="_blank">IPCC+23</a>] IPCC, ‚ÄòClimate Change 2023: Synthesis Report. Contribution of Working Groups I, II and III to the Sixth Assessment Report of the Intergovernmental Panel on Climate Change‚Äô, Intergovernmental Panel on Climate Change (IPCC), Geneva, Switzerland, Jul. 2023. doi: 10.59327/IPCC/AR6-9789291691647.</p>
<p>[<a class="reference external" href="https://reliefweb.int/node/4111326" rel="noreferrer" target="_blank">UNICEF+24</a>] UNICEF, ‚ÄòLatin America and Caribbean Region Flash Update No. 2 (Climate-related crisis in the Amazon Region)‚Äô, UNICEF, Nov. 2024.</p>
<p>[<a class="reference external" href="https://doi.org/10.48088/ejg.i.fra.16.2.286.297" rel="noreferrer" target="_blank">Franch-Pardo+25</a>] I. Franch-Pardo, P. A. F. Puig, and A. Cerd√†, ‚ÄòGeospatial Technologies in Crisis Response: Analyzing the 2024 Floods in Valencia, Spain‚Äô, European Journal of Geography, vol. 16, no. 2, pp. 286‚Äì297, Aug. 2025, doi: 10.48088/ejg.i.fra.16.2.286.297.</p>
<p>[<a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf" rel="noreferrer" target="_blank">McKee+93</a>] T. B. McKee, N. J. Doesken, and J. Kleist, ‚ÄòThe relationship of drought frequency and duration to time scales‚Äô, in Eighth Conference on Applied Climatology, Anaheim, California, USA, Jan. 1993.</p>
<p>[<a class="reference external" href="https://doi.org/10.1038/s41597-025-04896-y" rel="noreferrer" target="_blank">Keune+25</a>] J. Keune, F. Di Giuseppe, C. Barnard, E. Damasio da Costa, and F. Wetterhall, ‚ÄòERA5‚ÄìDrought: Global drought indices based on ECMWF reanalysis‚Äô, Scientific Data, vol. 12, p. 616, Apr. 2025, doi: 10.1038/s41597-025-04896-y.</p>
<p>[<a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_spi.pdf" rel="noreferrer" target="_blank">EDO+25</a>] EDO ‚Äì European Drought Observatory, ‚ÄòEDO and GDO indicator factsheet: <em>Standardized Precipitation Index (SPI)</em>‚Äô, Copernicus Emergency Management Service, Mar. 2025. Accessed: Feb. 09, 2026. [Online]. Available: <a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_spi.pdf" rel="noreferrer" target="_blank">https://drought.emergency.copernicus.eu/data/factsheets/factsheet_spi.pdf</a></p>
<p>[<a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1" rel="noreferrer" target="_blank">Vicente-Serrano+10</a>] S. M. Vicente-Serrano, S. Beguer√≠a, and J. I. L√≥pez-Moreno, ‚ÄòA Multiscalar Drought Index Sensitive to Global Warming: The Standardized Precipitation Evapotranspiration Index‚Äô, Journal of Climate, vol. 23, no. 7, pp. 1696‚Äì1718, Apr. 2010, doi: 10.1175/2009JCLI2909.1.</p>
<p>[<a class="reference external" href="https://doi.org/10.1002/qj.4803" rel="noreferrer" target="_blank">Soci+24</a>] C. Soci et al., ‚ÄòThe ERA5 global reanalysis from 1940 to 2022‚Äô, Quarterly Journal of the Royal Meteorological Society, vol. 150, no. 764, pp. 4014‚Äì4048, Jul. 2024, doi: 10.1002/qj.4803.</p>
<p>[<a class="reference external" href="https://doi.org/10.1002/qj.3803" rel="noreferrer" target="_blank">Hersbach+20</a>] H. Hersbach et al., ‚ÄòThe ERA5 global reanalysis‚Äô, Quarterly Journal of the Royal Meteorological Society, vol. 146, no. 730, pp. 1999‚Äì2049, May 2020, doi: 10.1002/qj.3803.</p>
<p>[<a class="reference external" href="https://doi.org/10.1002/joc.4267" rel="noreferrer" target="_blank">Stagge+15</a>] J. H. Stagge, L. M. Tallaksen, L. Gudmundsson, A. F. Van Loon, and K. Stahl, ‚ÄòCandidate Distributions for Climatological Drought Indices (SPI and SPEI)‚Äô, International Journal of Climatology, vol. 35, no. 13, pp. 4027‚Äì4040, Feb. 2015, doi: 10.1002/joc.4267.</p>
<p>[<a class="reference external" href="https://doi.org/10.1038/s41598-019-47933-8" rel="noreferrer" target="_blank">Gebrechorkos+19</a>] S. H. Gebrechorkos, S. H√ºlsmann, and C. Bernhofer, ‚ÄòLong-term trends in rainfall and temperature using high-resolution climate datasets in East Africa‚Äô, Sci Rep, vol. 9, no. 1, p. 11376, Aug. 2019, doi: 10.1038/s41598-019-47933-8.</p>
<p>[<a class="reference external" href="https://doi.org/10.1093/biomet/52.3-4.591" rel="noreferrer" target="_blank">Shapiro+65</a>] S. S. Shapiro and M. B. Wilk, ‚ÄòAn analysis of variance test for normality (complete samples)‚Äô, Biometrika, vol. 52, no. 3‚Äì4, pp. 591‚Äì611, Dec. 1965, doi: 10.1093/biomet/52.3-4.591.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Indicators"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="indicator.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Indicators</p>
      </div>
    </a>
    <a class="right-next"
       href="../Derived_Datasets/derived.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Derived Datasets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-retrieving-drought-indicators-from-the-era5drought-dataset">üåç Use case: Retrieving drought indicators from the ERA5‚ÄìDrought dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-setup">1. Code setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions">Helper functions</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-downloading-pre-processing">Data downloading &amp; (pre-)processing</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#accumulation-periods">Accumulation periods</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-spi-and-spei">Calculating SPI and SPEI</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#categorising-spi-and-spei">Categorising SPI and SPEI</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags">Quality flags</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisation">Visualisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-setup">2. General setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-setup">2.1 Analysis setup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cds-download-setup">2.2 CDS download setup</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#era5">ERA5</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#era5drought">ERA5‚ÄìDrought</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-land-sea-mask">2.3 Download land-sea mask</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison">3. SPI comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-monthly-precipitation-data-from-era5">3.1 Download monthly precipitation data from ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-total-precipitation-over-accumulation-periods">3.2 Calculate total precipitation over accumulation periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-gamma-distribution-by-calendar-month">3.3 Fit gamma distribution by calendar month</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-for-months-with-zero-precipitation">3.4 Adjust for months with zero precipitation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-spi">3.5 Compute SPI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison-time-series-in-example-site">3.6 SPI comparison: Time series in example site</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spi-comparison-regional-snapshot">3.7 SPI comparison: Regional snapshot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags-probability-of-zero-precipitation">3.8 Quality flags: Probability of zero precipitation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-flags-shapirowilk-normality-test">3.9 Quality flags: Shapiro‚ÄìWilk normality test</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison">4. SPEI comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-monthly-precipitation-and-potential-evaporation-data-from-era5">4.1 Download monthly precipitation and potential evaporation data from ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-water-balance-over-accumulation-periods">4.2 Calculate water balance over accumulation periods</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-logistic-distribution-and-compute-spei">4.3 Fit logistic distribution and compute SPEI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison-time-series-in-example-site">4.4 SPEI comparison: Time series in example site</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spei-comparison-regional-snapshot">4.5 SPEI comparison: Regional snapshot</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">4.6 Quality flags: Shapiro‚ÄìWilk normality test</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-comparison">5. Ensemble comparison</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-spi-and-spei-from-era5-ensemble">5.1 Compute SPI and SPEI from ERA5 ensemble</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-spi-and-spei-ensembles-from-era5drought">5.2 Download SPI and SPEI ensembles from ERA5‚ÄìDrought</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-comparison-time-series-in-example-site">5.3 Ensemble comparison: Time series in example site</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#control-member">Control member</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#full-ensemble">Full ensemble</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">6. Conclusions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>