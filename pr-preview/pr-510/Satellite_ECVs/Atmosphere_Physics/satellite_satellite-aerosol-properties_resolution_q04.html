
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1.1. Assessment of the resolution of SLSTR AOD and Fine_AOD (1¬∞) satellite data for monitoring Hunga Tonga volcanic eruption &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmosphere_Physics/satellite_satellite-aerosol-properties_resolution_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2. Atmospheric Composition" href="../Atmospheric_Composition/Atmospheric_Composition.html" />
    <link rel="prev" title="1.1. Atmosphere Physics" href="Atmosphere_Physics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.1.1. Assessment of the resolution of SLSTR AOD and Fine_AOD (1¬∞) satellite data for monitoring Hunga Tonga volcanic eruption</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmosphere_Physics/satellite_satellite-aerosol-properties_resolution_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmosphere_Physics/satellite_satellite-aerosol-properties_resolution_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessment of the resolution of SLSTR AOD and Fine_AOD (1¬∞) satellite data for monitoring Hunga Tonga volcanic eruption</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-volcanic-eruptions-using-satellite-observations">üåç Use case: Investigating volcanic eruptions using satellite observations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-required-libraries">Import all required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-the-datasets-used-in-the-study">Select the datasets used in the study</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-study-area-around-the-hunga-tonga-volcano-and-the-analysis-period">Define the study area around the Hunga Tonga volcano and the analysis period</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-and-preparation">Data loading and preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-daily-aod-data">Load daily AOD data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subset-aod550-and-fine-aod550-to-common-aoi-halfwin">Subset AOD550 and Fine_AOD550 to common AOI (¬±HALFWIN)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-data-for-9-panel-aod-mapping">Prepare data for 9-panel AOD mapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-generate-9-panel-daily-aod-maps">Function to generate 9-panel daily AOD maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">Plot and describe the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-availability-of-aod-retrievals-15-days-before-and-15-days-after-the-eruption">spatial availability of aod retrievals 15 days before and 15 days after the eruption</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-map-of-daily-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">9-panel map of daily AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-map-of-daily-fine-mode-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">9-panel map of daily Fine-mode AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-of-fine-and-coarse-mode-aerosol-fractions-before-and-after-the-eruption">comparison of fine- and coarse-mode aerosol fractions before and after the eruption</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="assessment-of-the-resolution-of-slstr-aod-and-fine-aod-1-satellite-data-for-monitoring-hunga-tonga-volcanic-eruption">
<h1><span class="section-number">1.1.1. </span>Assessment of the resolution of SLSTR AOD and Fine_AOD (1¬∞) satellite data for monitoring Hunga Tonga volcanic eruption<a class="headerlink" href="#assessment-of-the-resolution-of-slstr-aod-and-fine-aod-1-satellite-data-for-monitoring-hunga-tonga-volcanic-eruption" title="Link to this heading">#</a></h1>
<p>¬†</p>
<p>Production date: 30-09-2024</p>
<p>Produced by: University of Salerno (<a class="reference external" href="https://web.unisa.it/en/university" rel="noreferrer" target="_blank">UNISA</a>- Fabio Madonna and Faezeh Karimian)</p>
<section id="use-case-investigating-volcanic-eruptions-using-satellite-observations">
<h2>üåç Use case: Investigating volcanic eruptions using satellite observations<a class="headerlink" href="#use-case-investigating-volcanic-eruptions-using-satellite-observations" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>‚Ä¢ Is the resolution of satellite-derived AOD and Fine_AOD estimates sufficient to study the transport of aerosol particles from Hunga Tonga volcanic eruption?</strong></p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The daily AOD maps capture the onset and subsequent dispersion of the plume during the days following the eruption, clearly showing its expansion across the South Pacific and the gradual dilution of aerosol loading over time.</p></li>
<li><p>The fine-coarse fraction estimates show a physically coherent shift in aerosol size distribution: coarse particles increase immediately after the eruption.</p></li>
<li><p>Some AOD retrievals near the volcano are missing on certain days, likely because of cloud cover or intense volcanic ash concentrations.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The methodology adopted for the analysis of the Hunga Tonga eruption is split into the following steps:</p>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-resolution-q04-section-1"><span class="std std-ref">1. Choose the data to use and set up the code</span></a></p>
<ul class="simple">
<li><p>Import all required libraries</p></li>
<li><p>Select the datasets used in the study</p></li>
<li><p>Define the study area around the Hunga Tonga volcano and the analysis period</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-resolution-q04-section-2"><span class="std std-ref">Data loading and preparation</span></a></p>
<ul class="simple">
<li><p>Load daily AOD data</p></li>
<li><p>Subset AOD to common AOI (¬±HALFWIN)</p></li>
<li><p>Prepare data for 9-panel AOD mapping</p></li>
<li><p>Function to generate 9-panel daily AOD maps</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-resolution-q04-section-3"><span class="std std-ref">Plot and describe the results</span></a></p>
<ul class="simple">
<li><p>9-panel map of daily AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</p></li>
<li><p>9-panel map of daily Fine-mode AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</p></li>
<li><p>comparison of fine- and coarse-mode aerosol fractions before and after the eruption</p></li>
</ul>
<p><a class="reference internal" href="#satellite-satellite-aerosol-properties-resolution-q04-section-4"><span class="std std-ref">Take-home messages</span></a></p>
<ul class="simple">
<li><p>Take-Home Messages</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-aerosol-properties-resolution-q04-section-1"></span><h3>1. Choose the data to use and set up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-required-libraries">
<h4>Import all required libraries<a class="headerlink" href="#import-all-required-libraries" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages required to run the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">pearsonr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mticker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">LatitudeFormatter</span><span class="p">,</span> <span class="n">LongitudeFormatter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="select-the-datasets-used-in-the-study">
<h4>Select the datasets used in the study<a class="headerlink" href="#select-the-datasets-used-in-the-study" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AOD folder (daily files)</span>
<span class="n">AOD_FOLDER</span> <span class="o">=</span> <span class="s2">&quot;./aod_daily_data&quot;</span>

<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_average&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aerosol_optical_depth&quot;</span><span class="p">],</span>
    <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;slstr_on_sentinel_3a&quot;</span><span class="p">],</span> 
    <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;ens&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2_3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-the-study-area-around-the-hunga-tonga-volcano-and-the-analysis-period">
<h4>Define the study area around the Hunga Tonga volcano and the analysis period<a class="headerlink" href="#define-the-study-area-around-the-hunga-tonga-volcano-and-the-analysis-period" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VOLCANO</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">20.55</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">175.38</span><span class="p">}</span>
<span class="n">HALFWIN</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># e.g. ¬±3¬∞ around the volcano</span>
<span class="c1"># Analysis period</span>
<span class="n">START_DATE</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2022-01-13&quot;</span><span class="p">)</span>
<span class="n">END_DATE</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2022-01-21&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="data-loading-and-preparation">
<span id="satellite-satellite-aerosol-properties-resolution-q04-section-2"></span><h3>Data loading and preparation<a class="headerlink" href="#data-loading-and-preparation" title="Link to this heading">#</a></h3>
<section id="load-daily-aod-data">
<h4>Load daily AOD data<a class="headerlink" href="#load-daily-aod-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AOD_FOLDER</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">AOD_FOLDER</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.nc&quot;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="c1"># keep only the required variables</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="s2">&quot;FM_AOD550&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]]</span>
    <span class="c1"># timestamp from file name (YYYYMMDD)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">)[:</span><span class="mi">8</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">timestamp</span><span class="p">]})</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">aod_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">aod_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">999.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">aod_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">aod_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
<span class="n">aod_df</span> <span class="o">=</span> <span class="n">aod_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AOD dataframe loaded with shape:&quot;</span><span class="p">,</span> <span class="n">aod_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">aod_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AOD dataframe loaded with shape: (2268000, 5)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>AOD550</th>
      <th>FM_AOD550</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-01-01</td>
      <td>-89.5</td>
      <td>-179.5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>43192</th>
      <td>2022-01-01</td>
      <td>29.5</td>
      <td>172.5</td>
      <td>0.187939</td>
      <td>0.141549</td>
    </tr>
    <tr>
      <th>43193</th>
      <td>2022-01-01</td>
      <td>29.5</td>
      <td>173.5</td>
      <td>0.208070</td>
      <td>0.157441</td>
    </tr>
    <tr>
      <th>43194</th>
      <td>2022-01-01</td>
      <td>29.5</td>
      <td>174.5</td>
      <td>0.089787</td>
      <td>0.064093</td>
    </tr>
    <tr>
      <th>43195</th>
      <td>2022-01-01</td>
      <td>29.5</td>
      <td>175.5</td>
      <td>0.100026</td>
      <td>0.066048</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="subset-aod550-and-fine-aod550-to-common-aoi-halfwin">
<h4>Subset AOD550 and Fine_AOD550 to common AOI (¬±HALFWIN)<a class="headerlink" href="#subset-aod550-and-fine-aod550-to-common-aoi-halfwin" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">wrap180</span><span class="p">(</span><span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert longitude from [0, 360) to [-180, 180).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span>

<span class="k">def</span><span class="w"> </span><span class="nf">subset_aoi_antimeridian</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lat0</span><span class="p">,</span> <span class="n">lon0</span><span class="p">,</span> <span class="n">halfwin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subset df around (lat0, lon0) with width 2*halfwin, handling the antimeridian.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wrap180</span><span class="p">)</span>
    <span class="n">lon0</span> <span class="o">=</span> <span class="n">wrap180</span><span class="p">(</span><span class="n">lon0</span><span class="p">)</span>

    <span class="n">lat_mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">lat0</span> <span class="o">-</span> <span class="n">halfwin</span><span class="p">,</span> <span class="n">lat0</span> <span class="o">+</span> <span class="n">halfwin</span><span class="p">)</span>

    <span class="n">west</span><span class="p">,</span> <span class="n">east</span> <span class="o">=</span> <span class="n">lon0</span> <span class="o">-</span> <span class="n">halfwin</span><span class="p">,</span> <span class="n">lon0</span> <span class="o">+</span> <span class="n">halfwin</span>
    <span class="k">if</span> <span class="n">west</span> <span class="o">&lt;=</span> <span class="n">east</span><span class="p">:</span>
        <span class="n">lon_mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
     
        <span class="n">lon_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">west</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">east</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">lat_mask</span> <span class="o">&amp;</span> <span class="n">lon_mask</span><span class="p">]</span>

<span class="c1">#  subset around volcano for BOTH AOD and fine-mode AOD </span>
<span class="n">aod_aoi</span> <span class="o">=</span> <span class="n">subset_aoi_antimeridian</span><span class="p">(</span>
    <span class="n">aod_df</span><span class="p">,</span>
    <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span>
    <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span>
    <span class="n">HALFWIN</span>
<span class="p">)</span>

<span class="c1">#  daily mean over AOI for AOD550 and FM_AOD550 </span>
<span class="n">daily_aod</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">aod_aoi</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="s2">&quot;FM_AOD550&quot;</span><span class="p">])</span>   <span class="c1"># keep rows where both exist</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)[[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="s2">&quot;FM_AOD550&quot;</span><span class="p">]]</span> <span class="c1"># work on both columns</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Daily AOD and fine-mode AOD over AOI:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">daily_aod</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Daily AOD and fine-mode AOD over AOI:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AOD550</th>
      <th>FM_AOD550</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-01-01</th>
      <td>0.063557</td>
      <td>0.044091</td>
    </tr>
    <tr>
      <th>2022-01-13</th>
      <td>0.130747</td>
      <td>0.088537</td>
    </tr>
    <tr>
      <th>2022-01-16</th>
      <td>0.141580</td>
      <td>0.080177</td>
    </tr>
    <tr>
      <th>2022-01-17</th>
      <td>0.088671</td>
      <td>0.061638</td>
    </tr>
    <tr>
      <th>2022-01-20</th>
      <td>0.149817</td>
      <td>0.078330</td>
    </tr>
    <tr>
      <th>2022-01-24</th>
      <td>0.114521</td>
      <td>0.068941</td>
    </tr>
    <tr>
      <th>2022-02-01</th>
      <td>0.072149</td>
      <td>0.045140</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="prepare-data-for-9-panel-aod-mapping">
<h4>Prepare data for 9-panel AOD mapping<a class="headerlink" href="#prepare-data-for-9-panel-aod-mapping" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LAT_HW</span><span class="p">,</span> <span class="n">LON_HW</span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">15.0</span>          <span class="c1"># plotting window </span>

<span class="n">aod</span> <span class="o">=</span> <span class="n">aod_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
<span class="n">aod</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aod</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wrap180</span><span class="p">)</span>

<span class="n">aod_9</span> <span class="o">=</span> <span class="n">aod</span><span class="p">[(</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">START_DATE</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">END_DATE</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># list of days </span>
<span class="n">days_9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
    <span class="n">aod_9</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Days in 9-panel period:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">days_9</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="function-to-generate-9-panel-daily-aod-maps">
<h4>Function to generate 9-panel daily AOD maps<a class="headerlink" href="#function-to-generate-9-panel-daily-aod-maps" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_9panel_aod</span><span class="p">(</span><span class="n">aod_df</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlOrRd&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a 3√ó3 panel of daily maps for `varname` over the given days.</span>
<span class="sd">    aod_df:   dataframe with time, lat, lon, varname</span>
<span class="sd">    days:     list/array of 9 dates</span>
<span class="sd">    varname:  column name (&#39;AOD550&#39; or &#39;FM_AOD550&#39;)</span>
<span class="sd">    label:    used in title and colorbar label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">aod_df</span><span class="p">[</span><span class="n">aod_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">d</span><span class="p">][</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">allv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="k">if</span> <span class="n">vals</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
    <span class="n">allv</span> <span class="o">=</span> <span class="n">allv</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">allv</span><span class="p">)]</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">allv</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="k">if</span> <span class="n">allv</span><span class="o">.</span><span class="n">size</span> <span class="k">else</span> <span class="mf">0.0</span>
    <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vmin</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">allv</span><span class="p">,</span> <span class="mi">95</span><span class="p">))</span> <span class="k">if</span> <span class="n">allv</span><span class="o">.</span><span class="n">size</span> <span class="k">else</span> <span class="mf">0.5</span>

    <span class="n">central</span> <span class="o">=</span> <span class="n">wrap180</span><span class="p">(</span><span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">central</span><span class="p">)</span>
    <span class="n">crs_data</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">proj</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_bottom</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="k">return</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_left</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>   <span class="k">return</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="n">mesh</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">days</span><span class="p">)):</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">aod_df</span><span class="p">[</span><span class="n">aod_df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">day</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">varname</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="o">.</span><span class="n">date</span><span class="p">()),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># small extra padding</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

        <span class="n">west</span><span class="p">,</span> <span class="n">east</span> <span class="o">=</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">LON_HW</span><span class="p">,</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">LON_HW</span>
        <span class="n">south</span><span class="p">,</span> <span class="n">north</span> <span class="o">=</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">LAT_HW</span><span class="p">,</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">LAT_HW</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs_data</span><span class="p">)</span>

        <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
                          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s2">&quot;.1f&quot;</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">bottom_labels</span> <span class="o">=</span> <span class="n">is_bottom</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="n">is_left</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">sub</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;No data&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dimgray&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">grid</span> <span class="o">=</span> <span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span>
                                <span class="n">values</span><span class="o">=</span><span class="n">varname</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">lats</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
        <span class="n">lons</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
        <span class="n">dlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="n">dlon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lons</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="n">lat_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">lats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="p">(</span><span class="n">lats</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lats</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="p">[</span><span class="n">lats</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">lon_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">lons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="p">(</span><span class="n">lons</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lons</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="p">[</span><span class="n">lons</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>

        <span class="n">mesh</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">lon_edges</span><span class="p">,</span> <span class="n">lat_edges</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">crs_data</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs_data</span><span class="p">)</span>

    <span class="c1"># hide unused axes</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">days</span><span class="p">):]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

    <span class="c1"># shared colorbar</span>
    <span class="k">if</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Daily </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> maps (</span><span class="si">{</span><span class="n">days</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">days</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="c1"># increase space between panels (horizontal &amp; vertical)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                        <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.30</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="plot-and-describe-the-results">
<span id="satellite-satellite-aerosol-properties-resolution-q04-section-3"></span><h3>Plot and describe the results<a class="headerlink" href="#plot-and-describe-the-results" title="Link to this heading">#</a></h3>
<section id="spatial-availability-of-aod-retrievals-15-days-before-and-15-days-after-the-eruption">
<h4>spatial availability of aod retrievals 15 days before and 15 days after the eruption<a class="headerlink" href="#spatial-availability-of-aod-retrievals-15-days-before-and-15-days-after-the-eruption" title="Link to this heading">#</a></h4>
<p>This section shows, for each grid cell, how many days have valid AOD550 retrievals before and after the 15 January 2022 Hunga Tonga eruption, and visualises these counts as two maps. The comparison highlights where and how often the satellite product successfully retrieves AOD in the eruption region, revealing both pre-existing coverage patterns and changes associated with the volcanic plume and retrieval limitations near the source.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERUPTION</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;2022-01-15&quot;</span><span class="p">)</span>
<span class="n">VOLCANO</span>  <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">20.55</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">175.38</span><span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">wrap180</span><span class="p">(</span><span class="n">lon</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span>

<span class="n">aod</span> <span class="o">=</span> <span class="n">aod_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
<span class="n">aod</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aod</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">wrap180</span><span class="p">)</span>

<span class="c1"># split before / after eruption</span>
<span class="n">aod_before</span> <span class="o">=</span> <span class="n">aod</span><span class="p">[</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ERUPTION</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">])</span>
<span class="n">aod_after</span>  <span class="o">=</span> <span class="n">aod</span><span class="p">[</span><span class="n">aod</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">ERUPTION</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">])</span>

<span class="o">-</span>
<span class="k">def</span><span class="w"> </span><span class="nf">availability_grid</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># count valid pixels per (lat, lon)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">])[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">]</span>
          <span class="o">.</span><span class="n">count</span><span class="p">()</span>
          <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)</span>
    <span class="p">)</span>
 
    <span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">counts</span>

<span class="n">grid_before</span> <span class="o">=</span> <span class="n">availability_grid</span><span class="p">(</span><span class="n">aod_before</span><span class="p">)</span>
<span class="n">grid_after</span>  <span class="o">=</span> <span class="n">availability_grid</span><span class="p">(</span><span class="n">aod_after</span><span class="p">)</span>


<span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">grid_before</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">grid_after</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">cell_edges</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
    <span class="n">lats</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
    <span class="n">lons</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
    <span class="n">dlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">1.0</span>
    <span class="n">dlon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lons</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">1.0</span>
    <span class="n">lat_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">lats</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lats</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lats</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dlat</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">lon_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">lons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">lons</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lons</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lons</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dlon</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">lon_edges</span><span class="p">,</span> <span class="n">lat_edges</span>

<span class="n">lon_edges_b</span><span class="p">,</span> <span class="n">lat_edges_b</span> <span class="o">=</span> <span class="n">cell_edges</span><span class="p">(</span><span class="n">grid_before</span><span class="p">)</span>
<span class="n">lon_edges_a</span><span class="p">,</span> <span class="n">lat_edges_a</span> <span class="o">=</span> <span class="n">cell_edges</span><span class="p">(</span><span class="n">grid_after</span><span class="p">)</span>

<span class="n">central</span> <span class="o">=</span> <span class="n">wrap180</span><span class="p">(</span><span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">central</span><span class="p">)</span>
<span class="n">crs_data</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">proj</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AOD data availability BEFORE eruption&quot;</span><span class="p">,</span>
          <span class="s2">&quot;AOD data availability AFTER eruption&quot;</span><span class="p">]</span>
<span class="n">grids</span>  <span class="o">=</span> <span class="p">[</span><span class="n">grid_before</span><span class="p">,</span> <span class="n">grid_after</span><span class="p">]</span>
<span class="n">lon_edges_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">lon_edges_b</span><span class="p">,</span> <span class="n">lon_edges_a</span><span class="p">]</span>
<span class="n">lat_edges_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">lat_edges_b</span><span class="p">,</span> <span class="n">lat_edges_a</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">lon_edges</span><span class="p">,</span> <span class="n">lat_edges</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">axes</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">grids</span><span class="p">,</span> <span class="n">lon_edges_list</span><span class="p">,</span> <span class="n">lat_edges_list</span><span class="p">):</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

    <span class="c1"># optional: zoom around Tonga (adjust as you like)</span>
    <span class="n">west</span><span class="p">,</span> <span class="n">east</span> <span class="o">=</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span>
    <span class="n">south</span><span class="p">,</span> <span class="n">north</span> <span class="o">=</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">,</span> <span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs_data</span><span class="p">)</span>

    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
                      <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s2">&quot;.0f&quot;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">(</span><span class="n">number_format</span><span class="o">=</span><span class="s2">&quot;.1f&quot;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">mesh</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
        <span class="n">lon_edges</span><span class="p">,</span> <span class="n">lat_edges</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">crs_data</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlOrRd&quot;</span>
    <span class="p">)</span>


    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">crs_data</span><span class="p">)</span>

<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Number of days with valid AOD&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Spatial availability of AOD data before and after Hunga Tonga eruption&quot;</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/wp5/.tmp/ipykernel_2073273/2432905076.py:120: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout(rect=[0, 0.16, 1, 0.95])
</pre></div>
</div>
<img alt="../../_images/83716c58520e82c12bb8324f964a7c716a5ccddd7d48773443ba5b9f1a39bea6.png" src="../../_images/83716c58520e82c12bb8324f964a7c716a5ccddd7d48773443ba5b9f1a39bea6.png" />
</div>
</div>
<p><em>Figure 1.</em> Spatial availability of AOD retrievals before and after the Hunga Tonga eruption.
Maps show the number of days with valid AOD550 retrievals in the region surrounding the volcano for periods 2 weeks before (left) and 2 weeks after (right) the 15 January 2022 eruption.</p>
</section>
<section id="panel-map-of-daily-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">
<h4>9-panel map of daily AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)<a class="headerlink" href="#panel-map-of-daily-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022" title="Link to this heading">#</a></h4>
<p>To examine how the volcanic plume evolved in space during the days surrounding the Hunga Tonga eruption, a sequence of daily AOD550 maps was generated for the period 13‚Äì21 January 2022. This 9-day window includes both the final two days preceding the eruption and the first week of plume development. On 16 January, one day after the eruption, the strongest AOD enhancement appears east of the volcano, corresponding to the densest portion of the emerging volcanic plume. Over the following days (17‚Äì21 January), the plume spreads eastward and northeastward, forming a broad, elongated structure consistent with known transport patterns driven by prevailing winds in the region.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_9panel_aod</span><span class="p">(</span><span class="n">aod_9</span><span class="p">,</span> <span class="n">days_9</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;AOD550&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/2a86bb0190cc895f841b9f75492ad9af3106b36084d151f1486bdb7501ab263b.png" src="../../_images/2a86bb0190cc895f841b9f75492ad9af3106b36084d151f1486bdb7501ab263b.png" />
</div>
</div>
<p><em>Figure 2.</em> Daily AOD550 maps for the period 13‚Äì21 January 2022 in the Hunga Tonga region.
This 9-panel figure shows the spatial evolution of aerosol optical depth (AOD550) during the days immediately before and after the 15 January 2022 eruption of the Hunga Tonga‚ÄìHunga Ha ªapai volcano. Each panel represents one day, using a consistent colour scale to allow comparison of AOD magnitude across the sequence.</p>
</section>
<section id="panel-map-of-daily-fine-mode-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">
<h4>9-panel map of daily Fine-mode AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)<a class="headerlink" href="#panel-map-of-daily-fine-mode-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022" title="Link to this heading">#</a></h4>
<p>To complement the total AOD analysis, daily maps of the fine-mode aerosol optical depth (FM_AOD550) were generated for the same 9-day period spanning 13‚Äì21 January 2022. These maps isolate the contribution of fine particles allowing a direct comparison with the spatial patterns of total AOD. By examining the fine-mode component alongside the full aerosol load, it becomes possible to assess how much of the detected plume is driven by fine volcanic particles, and how these contributions evolve during the initial dispersion phase after the eruption.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_9panel_aod</span><span class="p">(</span><span class="n">aod_9</span><span class="p">,</span> <span class="n">days_9</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fine-mode AOD550 (FM_AOD550)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a48c182f43805cbee84add97578b269316cd24fa6ed65750eabd002ce567c500.png" src="../../_images/a48c182f43805cbee84add97578b269316cd24fa6ed65750eabd002ce567c500.png" />
</div>
</div>
<p><em>Figure 3.</em> Daily fine-mode AOD550 maps for the period 13‚Äì21 January 2022 in the Hunga Tonga region.
This 9-panel figure shows the spatial distribution of the fine-mode aerosol optical depth (FM_AOD550) during the days immediately before and after the 15 January 2022 eruption. Each panel corresponds to one day and uses a consistent colour scale to allow comparison of fine-particle abundance across the sequence.</p>
<p>Fine-mode AOD increases on 16 January near the volcano (marked with a star), reflecting the injection of fine ash and sulfate precursors into the atmosphere. Compared to total AOD, the fine-mode AOD is lower and show smaller horizontal gradients.</p>
</section>
<section id="comparison-of-fine-and-coarse-mode-aerosol-fractions-before-and-after-the-eruption">
<h4>comparison of fine- and coarse-mode aerosol fractions before and after the eruption<a class="headerlink" href="#comparison-of-fine-and-coarse-mode-aerosol-fractions-before-and-after-the-eruption" title="Link to this heading">#</a></h4>
<p>For the size-fraction analysis we use a smaller ¬±1¬∞ AOI around the volcano to better represent the near-vent plume. The mean fraction of fine- and coarse-mode aerosol was evaluated for periods immediately before and after the eruption.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AOI around the volcano</span>
<span class="n">HALFWIN</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Subset once</span>
<span class="n">aod_aoi</span> <span class="o">=</span> <span class="n">subset_aoi_antimeridian</span><span class="p">(</span><span class="n">aod_df</span><span class="p">,</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">VOLCANO</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">HALFWIN</span><span class="p">)</span>
<span class="n">aod_aoi</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">aod_aoi</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mean_size_fractions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute mean fine / coarse fractions for a given period.&quot;&quot;&quot;</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_date</span><span class="p">)</span>
    <span class="n">sub</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">,</span> <span class="s2">&quot;FM_AOD550&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;fine_frac&quot;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;FM_AOD550&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;AOD550&quot;</span><span class="p">]</span>
    <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;coarse_frac&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;fine_frac&quot;</span><span class="p">]</span>

    <span class="n">mean_fine</span>   <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;fine_frac&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">mean_coarse</span> <span class="o">=</span> <span class="n">sub</span><span class="p">[</span><span class="s2">&quot;coarse_frac&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean fine-mode fraction :   </span><span class="si">{</span><span class="n">mean_fine</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean coarse-mode fraction : </span><span class="si">{</span><span class="n">mean_coarse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># before eruption: 13‚Äì14 Jan </span>
<span class="n">mean_size_fractions</span><span class="p">(</span><span class="n">aod_aoi</span><span class="p">,</span> <span class="s2">&quot;2022-01-13&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-01-14&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Pre-eruption period (13‚Äì14 Jan)&quot;</span><span class="p">)</span>

<span class="c1">#  immediately after eruption: 16‚Äì18 Jan </span>
<span class="n">mean_size_fractions</span><span class="p">(</span><span class="n">aod_aoi</span><span class="p">,</span> <span class="s2">&quot;2022-01-16&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-01-18&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Post-eruption period (16‚Äì18 Jan)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre-eruption period (13‚Äì14 Jan):
  Mean fine-mode fraction :   0.68
  Mean coarse-mode fraction : 0.32

Post-eruption period (16‚Äì18 Jan):
  Mean fine-mode fraction :   0.59
  Mean coarse-mode fraction : 0.41
</pre></div>
</div>
</div>
</div>
<p>During the pre-eruption period (13‚Äì14 January), aerosols in the vicinity of the volcano were dominated by fine particles, with an average fine-mode fraction of 0.68 and a coarse-mode fraction of 0.32. These values are closer to the typical marine and regional aerosol conditions for the considered location, where fine particles (e.g., sulfates, sea-salt submicron modes, transport of other aerosol types at regional scale) represent the largest fraction of the optical depth.
In contrast, during the post-eruption period (16‚Äì18 January), the contribution of coarse particles increased. The fine-mode fraction decreased to 0.59, while the coarse-mode fraction increased to 0.41. This shift is consistent with the injection of large volcanic ash particles.
Overall, the comparison indicates a transition toward the increase of the coarser particles following the Hunga Tonga eruption, in line with the expected particle size of volcanic aerosol close to the volcano vent.</p>
</section>
</section>
<section id="take-home-messages">
<span id="satellite-satellite-aerosol-properties-resolution-q04-section-4"></span><h3>Take-home messages<a class="headerlink" href="#take-home-messages" title="Link to this heading">#</a></h3>
<p>‚Ä¢ The 9-panel AOD550 maps from 13‚Äì21 January show a transition to the preence of a volcanic plume. Low, relatively homogeneous AOD before 15 January is followed by a strong AOD enhancement near Hunga Tonga and subsequent eastward and northeastward transport over the South Pacific.</p>
<p>‚Ä¢ The fine-mode AOD550 (FM_AOD) maps exhibit an increase after the eruption, but with a more homogeneous spatial structure than total AOD.</p>
<p>‚Ä¢ The fine-coarse fraction analysis over a ¬±1¬∞ AOI shows a shift in particle size after the eruption. The fine-mode fraction decreases from 0.68 in the pre-eruption period (13‚Äì14 January) to 0.59 in the post-eruption period (16‚Äì18 January), while the coarse-mode fraction increases from 0.32 to 0.41.</p>
<p>‚Ä¢ The increase in coarse-mode fraction in the days immediately following the eruption is consistent with the injection of volcanic ash, which predominantly contributes to the coarse aerosol mode.</p>
<p>‚Ä¢ Despite retrieval limitations likely occurring near very optically thick regions, the combined analysis of AOD, fine-mode AOD, and size fractions demonstrates that satellite-derived aerosol products can be used to characterize both the spatial evolution and the fraction of aerosol particles related to volcanic eruptions in the days surrounding major eruptions.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.3390/rs15102661" rel="noreferrer" target="_blank">[1]</a> Liu, Q., Gui, L., Liu, J., Ventura, G., Yang, Q., Wang, Z., Tang, Z., Tao, M., &amp; Shen, X. (2023). <em>Multi-Satellite Detection of Long-Range Transport and Transformation of Atmospheric Emissions from the Hunga Tonga‚ÄìHunga Ha‚Äôapai Volcano</em>. <strong>Remote Sensing</strong>, 15(10), 2661.</p>
<p><a class="reference external" href="https://doi.org/10.1134/S0742046325700010" rel="noreferrer" target="_blank">[2]</a> Guo, M., Wang, C., Bai, J., Gao, Y., Zhang, H., Hou, R., Wang, Q., Zhang, W., Jin, Z., &amp; Huang, H. (2025). <em>Enlightenment of the Recent Explosive Eruption of Hunga Tonga‚ÄìHunga Ha‚Äôapai in Tonga</em>. <strong>Journal of Volcanology and Seismology</strong>, 19(2), 203‚Äì214.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-22-14957-2022" rel="noreferrer" target="_blank">[3]</a> Legras, B., Duchamp, C., Sellitto, P., Podglajen, A., Carboni, E., Siddans, R., Groo√ü, J.-U., Khaykin, S., &amp; Ploeger, F. (2022). <em>The evolution and dynamics of the Hunga Tonga‚ÄìHunga Ha‚Äôapai sulfate aerosol plume in the stratosphere</em>. <strong>Atmospheric Chemistry and Physics</strong>, 22(22), 14957‚Äì14970.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmosphere_Physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmosphere_Physics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.1. </span>Atmosphere Physics</p>
      </div>
    </a>
    <a class="right-next"
       href="../Atmospheric_Composition/Atmospheric_Composition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-volcanic-eruptions-using-satellite-observations">üåç Use case: Investigating volcanic eruptions using satellite observations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-required-libraries">Import all required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-the-datasets-used-in-the-study">Select the datasets used in the study</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-study-area-around-the-hunga-tonga-volcano-and-the-analysis-period">Define the study area around the Hunga Tonga volcano and the analysis period</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-loading-and-preparation">Data loading and preparation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-daily-aod-data">Load daily AOD data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subset-aod550-and-fine-aod550-to-common-aoi-halfwin">Subset AOD550 and Fine_AOD550 to common AOI (¬±HALFWIN)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-data-for-9-panel-aod-mapping">Prepare data for 9-panel AOD mapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-generate-9-panel-daily-aod-maps">Function to generate 9-panel daily AOD maps</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-the-results">Plot and describe the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-availability-of-aod-retrievals-15-days-before-and-15-days-after-the-eruption">spatial availability of aod retrievals 15 days before and 15 days after the eruption</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-map-of-daily-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">9-panel map of daily AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-map-of-daily-fine-mode-aod550-before-and-after-the-hunga-tonga-eruption-1321-january-2022">9-panel map of daily Fine-mode AOD550 before and after the Hunga Tonga eruption (13‚Äì21 January 2022)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-of-fine-and-coarse-mode-aerosol-fractions-before-and-after-the-eruption">comparison of fine- and coarse-mode aerosol fractions before and after the eruption</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-home-messages">Take-home messages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>