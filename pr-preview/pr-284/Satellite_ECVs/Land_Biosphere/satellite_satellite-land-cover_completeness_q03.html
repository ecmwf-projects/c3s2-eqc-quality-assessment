
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4.1. Satellite Land Cover trend assessment for Spatial Planning and Land Management &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_completeness_q03';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.5. Land Hydrology" href="../Land_Hydrology/Land_Hydrology.html" />
    <link rel="prev" title="1.4. Land Biosphere" href="Land_Biosphere.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Biosphere.html">1.4. Land Biosphere</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.4.1. Satellite Land Cover trend assessment for Spatial Planning and Land Management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_completeness_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Biosphere/satellite_satellite-land-cover_completeness_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite Land Cover trend assessment for Spatial Planning and Land Management</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-quantify-afforestation-deforestation-trends">🌍 Use case: Using land cover products to quantify afforestation/deforestation trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data"><strong>1. Define the AoI, search and download LC data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#install-cds-api">Install CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula"><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-land-cover-classes-area-coverage-for-each-nuts-2-region">Compute Land Cover classes area coverage for each NUTS 2 region</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-forest-classes-and-prepare-dataset">Select Forest Classes and Prepare Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-forest-area-per-region-and-year">Compute forest area per region and year</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-forest-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">Map forest percentage coverage over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-forest-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">Map forest percentage coverage change over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-analysis">Map Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-drivers-and-methodological-considerations-in-afforestation-deforestation-trends-in-the-iberian-peninsula-19922022"><strong>Potential Drivers and Methodological Considerations in Afforestation/Deforestation Trends in the Iberian Peninsula (1992–2022)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-detection"><strong>3. Breakpoint Detection</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-analysis">Breakpoint Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-assessment"><strong>4. Trend Assessment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis">Trend Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion"><strong>5. Discussion</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-land-cover-trend-assessment-for-spatial-planning-and-land-management">
<h1><span class="section-number">1.4.1. </span>Satellite Land Cover trend assessment for Spatial Planning and Land Management<a class="headerlink" href="#satellite-land-cover-trend-assessment-for-spatial-planning-and-land-management" title="Link to this heading">#</a></h1>
<p>Production date: 20-12-2024</p>
<p>Produced by: Inês Girão (+ATLANTIC)</p>
<section id="use-case-using-land-cover-products-to-quantify-afforestation-deforestation-trends">
<h2>🌍 Use case: Using land cover products to quantify afforestation/deforestation trends<a class="headerlink" href="#use-case-using-land-cover-products-to-quantify-afforestation-deforestation-trends" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the dataset accurate and consistent for the analysis of afforestation/deforestation trends in the Iberian Peninsula?</strong></p></li>
</ul>
<p>Land Cover data is an invaluable resource for a wide range of fields, from climate change research to forest management. Land Cover products that provide historical timelines enable scientists, policymakers, and planners to understand and analyse the transformation of land cover over recent decades (<a class="reference external" href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Forests,_forestry_and_logging">EUROSTAT,2022</a>; <a class="reference external" href="https://commission.europa.eu/document/cf3294e1-8358-4c93-8de4-3e1503b95201_en">New EU Forest Strategy for 2030</a>).</p>
<p>This notebook will access the <em><strong>Land cover classification gridded maps from 1992 to present derived from satellite observations</strong></em> (henceforth, LC) data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S), and analyse the spatial patterns of a specific LC type over a given Area of Interest (AoI) and time.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<p>The dataset maintains strong temporal continuity, with annual updates ensuring a smooth and reliable representation of forest land cover changes over time. While breakpoints were identified, they generally did not indicate major disruptions, reinforcing the dataset’s stability for long-term trend analysis.</p>
<p>The presence of breakpoints does not necessarily indicate abrupt landscape shifts but rather highlights the sensitivity of detection methods to gradual changes. This suggests that while breakpoints can help refine analysis, their impact on overall trends remains limited, emphasising the dataset’s resilience to minor variations.</p>
<p>For the specific land cover type analysed, the dataset exhibits a consistent ability to capture underlying trends. The similarity in results across segmented and total trends suggests that the data structure is well-calibrated, minimising distortions that could arise from classification inconsistencies or methodological biases.</p>
</div>
<p><img alt="Forest_Map_Series.png" src="../../_images/Forest_Map_Series.png" /></p>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p><strong>This Use Case comprises the following steps:</strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-completeness-q03-code-section-1"><span class="std std-ref">1. Define the AoI, search and download LC data</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-completeness-q03-code-section-2"><span class="std std-ref">2. Inspect and view data for the defined AoI (Iberian Peninsula)</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-completeness-q03-code-section-3"><span class="std std-ref">3. Breakpoint Detection</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-completeness-q03-code-section-4"><span class="std std-ref">4. Trend Assessment</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-land-cover-completeness-q03-code-section-5"><span class="std std-ref">5. Discussion</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="define-the-aoi-search-and-download-lc-data">
<span id="satellite-satellite-land-cover-completeness-q03-code-section-1"></span><h3><strong>1. Define the AoI, search and download LC data</strong><a class="headerlink" href="#define-the-aoi-search-and-download-lc-data" title="Link to this heading">#</a></h3>
<p>Before we begin we must prepare our environment. This includes installing the Application Programming Interface (API) of the CDS, and importing the various python libraries that we will need.</p>
<section id="install-cds-api">
<h4>Install CDS API<a class="headerlink" href="#install-cds-api" title="Link to this heading">#</a></h4>
<p>To install the CDS API, run the following command. We use an exclamation mark to pass the command to the shell (not to the Python interpreter).
If you already have the CDS API installed, you can skip or comment this step.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>cdsapi
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: cdsapi in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (0.7.5)
Requirement already satisfied: datapi in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (0.1.1)
Requirement already satisfied: requests&gt;=2.5.0 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (2.32.3)
Requirement already satisfied: tqdm in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from cdsapi) (4.67.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (3.4.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2024.8.30)
Requirement already satisfied: attrs in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (24.3.0)
Requirement already satisfied: multiurl&gt;=0.3.2 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (0.3.3)
Requirement already satisfied: typing-extensions in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from datapi-&gt;cdsapi) (4.12.2)
Requirement already satisfied: pytz in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (2024.2)
Requirement already satisfied: python-dateutil in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (2.9.0.post0)
Requirement already satisfied: six&gt;=1.5 in /home/inesvzgirao/miniconda3/envs/C3S/lib/python3.11/site-packages (from python-dateutil-&gt;multiurl&gt;=0.3.2-&gt;datapi-&gt;cdsapi) (1.17.0)
</pre></div>
</div>
</div>
</div>
<section id="import-all-the-libraries-packages">
<h5>Import all the libraries/packages<a class="headerlink" href="#import-all-the-libraries-packages" title="Link to this heading">#</a></h5>
<p>We will be working with data in NetCDF format. To best handle this type of data we will use libraries for working with multidimensional arrays, in particular Xarray.
We will also need libraries for plotting and viewing data.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  Import Standard Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1">#  Import Numerical &amp; Statistical Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">kendalltau</span><span class="p">,</span> <span class="n">theilslopes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="kn">import</span> <span class="n">OLS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.polynomial.polynomial</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polynomial</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ruptures</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rpt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">savgol_filter</span>

<span class="c1">#  Import Geospatial Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>  <span class="c1"># Import vector geospatial data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span>  <span class="c1"># Transform attributes and geometries into specific regions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">box</span><span class="p">,</span> <span class="n">Polygon</span>


<span class="c1">#  Import Visualization Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">colors</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">TwoSlopeNorm</span><span class="p">,</span> <span class="n">Normalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Patch</span>


<span class="c1">#  Import External Tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-overview">
<h5>Data Overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h5>
<p>To search for data, visit the CDS website: <a class="reference external" href="http://cds.climate.copernicus.eu">http://cds.climate.copernicus.eu</a> Here you can search for ‘Satellite observations’ using the search bar. The data we need for this tutorial is the <em><strong>Land cover classification gridded maps from 1992 to present derived from satellite observations</strong></em>. This catalogue entry provides global Land Cover Classification (LCC) maps with a very high spatial resolution, with a L4 processing level, on an annual basis with a one-year delay, following the <a class="reference external" href="https://library.wmo.int/records/item/58111-the-2022-gcos-ecvs-requirements-gcos-245">Global Climate Observing System (GCOS) convention requirements</a>. LULC maps correspond to a global classification scheme, encompassing 22 classes.</p>
<p>The dataset consists of 2 versions (v2.0.7 produced by the European Space Agency (ESA) Climate Change Initiative (CCI) and v2.1.1 produced by Copernicus Climate Change Service (C3S)).</p>
<p>Data specifications for this use case:</p>
<ul class="simple">
<li><p><strong>Years:</strong> 1992 to 2022</p></li>
<li><p><strong>Version:</strong> v2.0.7 before 1992 and v2.1.1 after 2016</p></li>
<li><p><strong>Format:</strong> Zip files</p></li>
</ul>
<p>At the end of the download form, select “<strong>Show API request</strong>”. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook. Having copied the API request, running it will retrieve and download the data you requested into your local directory. However, before you run it, the <strong>terms and conditions</strong> of this particular dataset need to have been accepted directly at the CDS website. The option to view and accept these conditions is given at the end of the download form, just above the “<strong>Show API request</strong>” option. In addition, it is also useful to define the time period and AoI parameters and edit the request accordingly, as exemplified in the cells below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Years to download</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1992</span><span class="p">,</span> <span class="mi">1993</span><span class="p">,</span> <span class="mi">1994</span><span class="p">,</span>
        <span class="mi">1995</span><span class="p">,</span> <span class="mi">1996</span><span class="p">,</span> <span class="mi">1997</span><span class="p">,</span>
        <span class="mi">1998</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span> <span class="mi">2003</span><span class="p">,</span>
        <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span>
        <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span>
        <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span>
        <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span>
        <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span>
        <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span>
        <span class="mi">2022</span><span class="p">,</span> <span class="mi">2022</span><span class="p">]</span>


<span class="c1"># List of requests to retrieve data</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-land-cover&quot;</span>
<span class="n">requests</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2_0_7cds&quot;</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">2016</span> <span class="k">else</span> <span class="s2">&quot;v2_1_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="c1"># Region of interest (Iberian Peninsula)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">requests</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 32/32 [00:00&lt;00:00, 122.07it/s]
/tmp/ipykernel_867327/1703755849.py:7: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  ds = ds.assign_coords(year=ds[&quot;time&quot;].dt.year).swap_dims(time=&quot;year&quot;).drop(&quot;time&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Inspect the database</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 7GB
Dimensions:              (year: 31, latitude: 3600, longitude: 5040, bounds: 2)
Coordinates:
    lat_bounds           (latitude, bounds) float64 58kB dask.array&lt;chunksize=(3600, 2), meta=np.ndarray&gt;
    lon_bounds           (longitude, bounds) float64 81kB dask.array&lt;chunksize=(5040, 2), meta=np.ndarray&gt;
    time_bounds          (year, bounds) datetime64[ns] 496B dask.array&lt;chunksize=(1, 2), meta=np.ndarray&gt;
  * latitude             (latitude) float64 29kB 45.0 45.0 44.99 ... 35.0 35.0
  * longitude            (longitude) float64 40kB -9.999 -9.996 ... 3.996 3.999
  * year                 (year) int64 248B 1992 1993 1994 ... 2020 2021 2022
Dimensions without coordinates: bounds
Data variables:
    lccs_class           (year, latitude, longitude) uint8 562MB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    processed_flag       (year, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    current_pixel_state  (year, latitude, longitude) float32 2GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    observation_count    (year, latitude, longitude) uint16 1GB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    change_count         (year, latitude, longitude) uint8 562MB dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;
    crs                  (year) int32 124B -2147483647 ... -2147483647
Attributes: (12/38)
    id:                         ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-v2.0.7cds
    title:                      Land Cover Map of ESA CCI brokered by CDS
    summary:                    This dataset characterizes the land cover of ...
    type:                       ESACCI-LC-L4-LCCS-Map-300m-P1Y
    project:                    Climate Change Initiative - European Space Ag...
    references:                 http://www.esa-landcover-cci.org/
    ...                         ...
    geospatial_lon_max:         180
    spatial_resolution:         300m
    geospatial_lat_units:       degrees_north
    geospatial_lat_resolution:  0.002778
    geospatial_lon_units:       degrees_east
    geospatial_lon_resolution:  0.002778</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2c232db8-b8b7-424c-a1ee-7806f1c6e573' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2c232db8-b8b7-424c-a1ee-7806f1c6e573' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 31</li><li><span class='xr-has-index'>latitude</span>: 3600</li><li><span class='xr-has-index'>longitude</span>: 5040</li><li><span>bounds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5fef550c-e068-4fa4-b83c-d882c68a7b59' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5fef550c-e068-4fa4-b83c-d882c68a7b59' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lat_bounds</span></div><div class='xr-var-dims'>(latitude, bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(3600, 2), meta=np.ndarray&gt;</div><input id='attrs-5a508bc3-0744-4a45-807f-04fc07bf658c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a508bc3-0744-4a45-807f-04fc07bf658c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d6f6931-6a95-480b-825d-c52243e6e014' class='xr-var-data-in' type='checkbox'><label for='data-3d6f6931-6a95-480b-825d-c52243e6e014' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 56.25 kiB </td>
                        <td> 56.25 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (3600, 2) </td>
                        <td> (3600, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 150 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">3600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bounds</span></div><div class='xr-var-dims'>(longitude, bounds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(5040, 2), meta=np.ndarray&gt;</div><input id='attrs-07f71807-5b84-4872-97a1-9f068c62345b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-07f71807-5b84-4872-97a1-9f068c62345b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c777396-7bf2-49d3-81a1-133dd1a365de' class='xr-var-data-in' type='checkbox'><label for='data-7c777396-7bf2-49d3-81a1-133dd1a365de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 78.75 kiB </td>
                        <td> 78.75 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (5040, 2) </td>
                        <td> (5040, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 150 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="75" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="25" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="25" y1="0" x2="25" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="45.412617" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,45.412617,60.000000)">5040</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bounds</span></div><div class='xr-var-dims'>(year, bounds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 2), meta=np.ndarray&gt;</div><input id='attrs-137bb296-1154-4148-9a25-fa2ad93c6391' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-137bb296-1154-4148-9a25-fa2ad93c6391' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac4364f1-28fa-4beb-9379-27a26f226571' class='xr-var-data-in' type='checkbox'><label for='data-ac4364f1-28fa-4beb-9379-27a26f226571' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 496 B </td>
                        <td> 16 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 2) </td>
                        <td> (1, 2) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 31 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> datetime64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="86" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="36" y2="0" style="stroke-width:2" />
  <line x1="0" y1="3" x2="36" y2="3" />
  <line x1="0" y1="11" x2="36" y2="11" />
  <line x1="0" y1="15" x2="36" y2="15" />
  <line x1="0" y1="23" x2="36" y2="23" />
  <line x1="0" y1="30" x2="36" y2="30" />
  <line x1="0" y1="34" x2="36" y2="34" />
  <line x1="0" y1="42" x2="36" y2="42" />
  <line x1="0" y1="50" x2="36" y2="50" />
  <line x1="0" y1="54" x2="36" y2="54" />
  <line x1="0" y1="61" x2="36" y2="61" />
  <line x1="0" y1="65" x2="36" y2="65" />
  <line x1="0" y1="73" x2="36" y2="73" />
  <line x1="0" y1="81" x2="36" y2="81" />
  <line x1="0" y1="85" x2="36" y2="85" />
  <line x1="0" y1="92" x2="36" y2="92" />
  <line x1="0" y1="100" x2="36" y2="100" />
  <line x1="0" y1="104" x2="36" y2="104" />
  <line x1="0" y1="112" x2="36" y2="112" />
  <line x1="0" y1="120" x2="36" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="36" y1="0" x2="36" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 36.05090363626093,0.0 36.05090363626093,120.0 0.0,120.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="18.025452" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >2</text>
  <text x="56.050904" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,56.050904,60.000000)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.0 45.0 44.99 ... 35.01 35.0 35.0</div><input id='attrs-eaac14c4-c66f-4c68-a526-35faa55ac750' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-eaac14c4-c66f-4c68-a526-35faa55ac750' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3ba9e98-4e00-4817-bcb6-4df792a0d54c' class='xr-var-data-in' type='checkbox'><label for='data-a3ba9e98-4e00-4817-bcb6-4df792a0d54c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>bounds :</span></dt><dd>lat_bounds</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>positive :</span></dt><dd>North</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>out_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([44.998611, 44.995833, 44.993056, ..., 35.006944, 35.004167, 35.001389])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.999 -9.996 ... 3.996 3.999</div><input id='attrs-3b3a3c30-c303-4c76-94f8-3828400497d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3b3a3c30-c303-4c76-94f8-3828400497d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbb095ae-4123-4485-bae3-b5077e1968fd' class='xr-var-data-in' type='checkbox'><label for='data-fbb095ae-4123-4485-bae3-b5077e1968fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>valid_max :</span></dt><dd>180.0</dd><dt><span>bounds :</span></dt><dd>lon_bounds</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>positive :</span></dt><dd>East</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>out_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-9.998611, -9.995833, -9.993056, ...,  3.993056,  3.995833,  3.998611])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1992 1993 1994 ... 2020 2021 2022</div><input id='attrs-4c8699df-b403-46ba-86c2-39b9ec4baf0e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c8699df-b403-46ba-86c2-39b9ec4baf0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c093b56-8fb9-43ee-823e-0ffdc543ac34' class='xr-var-data-in' type='checkbox'><label for='data-5c093b56-8fb9-43ee-823e-0ffdc543ac34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bounds</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>stored_direction :</span></dt><dd>increasing</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd></dd><dt><span>valid_min :</span></dt><dd></dd><dt><span>value :</span></dt><dd></dd><dt><span>z_bounds_factors :</span></dt><dd></dd><dt><span>z_factors :</span></dt><dd></dd><dt><span>bounds_values :</span></dt><dd></dd><dt><span>out_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019, 2020, 2021, 2022])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-052ac511-8a65-4df2-97af-8d79015bfcdf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-052ac511-8a65-4df2-97af-8d79015bfcdf' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lccs_class</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-34cf8aa7-dba4-42c1-8ccb-d9eb988a513c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34cf8aa7-dba4-42c1-8ccb-d9eb988a513c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eedf04ba-5a1e-48cf-9e92-3cc3435b4448' class='xr-var-data-in' type='checkbox'><label for='data-eedf04ba-5a1e-48cf-9e92-3cc3435b4448' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>land_cover_lccs</dd><dt><span>flag_colors :</span></dt><dd>#ffff64 #ffff64 #ffff00 #aaf0f0 #dcf064 #c8c864 #006400 #00a000 #00a000 #aac800 #003c00 #003c00 #005000 #285000 #285000 #286400 #788200 #8ca000 #be9600 #966400 #966400 #966400 #ffb432 #ffdcd2 #ffebaf #ffc864 #ffd278 #ffebaf #00785a #009678 #00dc82 #c31400 #fff5d7 #dcdcdc #fff5d7 #0046c8 #ffffff</dd><dt><span>long_name :</span></dt><dd>Land cover class defined in LCCS</dd><dt><span>valid_min :</span></dt><dd>1</dd><dt><span>valid_max :</span></dt><dd>220</dd><dt><span>ancillary_variables :</span></dt><dd>processed_flag current_pixel_state observation_count change_count</dd><dt><span>flag_meanings :</span></dt><dd>no_data cropland_rainfed cropland_rainfed_herbaceous_cover cropland_rainfed_tree_or_shrub_cover cropland_irrigated mosaic_cropland mosaic_natural_vegetation tree_broadleaved_evergreen_closed_to_open tree_broadleaved_deciduous_closed_to_open tree_broadleaved_deciduous_closed tree_broadleaved_deciduous_open tree_needleleaved_evergreen_closed_to_open tree_needleleaved_evergreen_closed tree_needleleaved_evergreen_open tree_needleleaved_deciduous_closed_to_open tree_needleleaved_deciduous_closed tree_needleleaved_deciduous_open tree_mixed mosaic_tree_and_shrub mosaic_herbaceous shrubland shrubland_evergreen shrubland_deciduous grassland lichens_and_mosses sparse_vegetation sparse_tree sparse_shrub sparse_herbaceous tree_cover_flooded_fresh_or_brakish_water tree_cover_flooded_saline_water shrub_or_herbaceous_cover_flooded urban bare_areas bare_areas_consolidated bare_areas_unconsolidated water snow_and_ice</dd><dt><span>flag_values :</span></dt><dd>[  0  10  11  12  20  30  40  50  60  61  62  70  71  72  80  81  82  90
 100 110 120 121 122 130 140 150 151 152 153 160 170 180 190 200 201 202
 210 220]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 536.41 MiB </td>
                        <td> 4.33 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>processed_flag</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-edebc957-fdfa-4c10-b9bf-c115d6fe3ab5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-edebc957-fdfa-4c10-b9bf-c115d6fe3ab5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cc54c8d-170c-4997-a92d-4cca510c1448' class='xr-var-data-in' type='checkbox'><label for='data-4cc54c8d-170c-4997-a92d-4cca510c1448' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>LC map processed area flag</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs status_flag</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>1</dd><dt><span>flag_meanings :</span></dt><dd>not_processed processed</dd><dt><span>flag_values :</span></dt><dd>[0 1]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.10 GiB </td>
                        <td> 17.30 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>current_pixel_state</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-29ed9316-e455-4f91-9f81-a3294e06e496' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29ed9316-e455-4f91-9f81-a3294e06e496' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82910674-c1dd-4437-94a7-21089a648618' class='xr-var-data-in' type='checkbox'><label for='data-82910674-c1dd-4437-94a7-21089a648618' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>LC pixel type mask</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs status_flag</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>5</dd><dt><span>flag_meanings :</span></dt><dd>invalid clear_land clear_water clear_snow_ice cloud cloud_shadow</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5]</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.10 GiB </td>
                        <td> 17.30 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>observation_count</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint16</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-8268e485-acc3-42d4-8793-843fda8a0bdc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8268e485-acc3-42d4-8793-843fda8a0bdc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3be136e8-029b-4bc3-a1d4-dab5f75b743d' class='xr-var-data-in' type='checkbox'><label for='data-3be136e8-029b-4bc3-a1d4-dab5f75b743d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>number of valid observations</dd><dt><span>standard_name :</span></dt><dd>land_cover_lccs number_of_observations</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>32767</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.05 GiB </td>
                        <td> 8.65 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint16 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>change_count</span></div><div class='xr-var-dims'>(year, latitude, longitude)</div><div class='xr-var-dtype'>uint8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1800, 2520), meta=np.ndarray&gt;</div><input id='attrs-d1404c78-b157-49fb-aacd-383ea1659b79' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1404c78-b157-49fb-aacd-383ea1659b79' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e48a042e-addf-449d-9609-d38f9bae6a95' class='xr-var-data-in' type='checkbox'><label for='data-e48a042e-addf-449d-9609-d38f9bae6a95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>number of class changes</dd><dt><span>valid_min :</span></dt><dd>0</dd><dt><span>valid_max :</span></dt><dd>100</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 536.41 MiB </td>
                        <td> 4.33 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (31, 3600, 5040) </td>
                        <td> (1, 1800, 2520) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 124 chunks in 63 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> uint8 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="194" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="10" y1="42" x2="24" y2="57" />
  <line x1="10" y1="85" x2="24" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="85" style="stroke-width:2" />
  <line x1="10" y1="0" x2="10" y2="86" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="11" y1="1" x2="11" y2="87" />
  <line x1="12" y1="2" x2="12" y2="88" />
  <line x1="13" y1="3" x2="13" y2="89" />
  <line x1="14" y1="4" x2="14" y2="90" />
  <line x1="15" y1="5" x2="15" y2="91" />
  <line x1="16" y1="6" x2="16" y2="91" />
  <line x1="16" y1="6" x2="16" y2="92" />
  <line x1="17" y1="7" x2="17" y2="93" />
  <line x1="18" y1="8" x2="18" y2="93" />
  <line x1="19" y1="9" x2="19" y2="94" />
  <line x1="20" y1="10" x2="20" y2="95" />
  <line x1="20" y1="10" x2="20" y2="96" />
  <line x1="21" y1="11" x2="21" y2="97" />
  <line x1="22" y1="12" x2="22" y2="98" />
  <line x1="23" y1="13" x2="23" y2="98" />
  <line x1="23" y1="13" x2="23" y2="99" />
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 24.9485979497544,14.948597949754403 24.9485979497544,100.66288366404012 10.0,85.71428571428572" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="10" y1="0" x2="130" y2="0" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="11" y1="1" x2="131" y2="1" />
  <line x1="12" y1="2" x2="132" y2="2" />
  <line x1="13" y1="3" x2="133" y2="3" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="15" y1="5" x2="135" y2="5" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="16" y1="6" x2="136" y2="6" />
  <line x1="17" y1="7" x2="137" y2="7" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="19" y1="9" x2="139" y2="9" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="20" y1="10" x2="140" y2="10" />
  <line x1="21" y1="11" x2="141" y2="11" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="23" y1="13" x2="143" y2="13" />
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="24" y2="14" style="stroke-width:2" />
  <line x1="70" y1="0" x2="84" y2="14" />
  <line x1="130" y1="0" x2="144" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 144.9485979497544,14.948597949754403 24.9485979497544,14.948597949754403" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="24" y1="14" x2="144" y2="14" style="stroke-width:2" />
  <line x1="24" y1="57" x2="144" y2="57" />
  <line x1="24" y1="100" x2="144" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="24" y1="14" x2="24" y2="100" style="stroke-width:2" />
  <line x1="84" y1="14" x2="84" y2="100" />
  <line x1="144" y1="14" x2="144" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="24.9485979497544,14.948597949754403 144.9485979497544,14.948597949754403 144.9485979497544,100.66288366404012 24.9485979497544,100.66288366404012" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="84.948598" y="120.662884" font-size="1.0rem" font-weight="100" text-anchor="middle" >5040</text>
  <text x="164.948598" y="57.805741" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,164.948598,57.805741)">3600</text>
  <text x="7.474299" y="113.188585" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.474299,113.188585)">31</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>crs</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>-2147483647 ... -2147483647</div><input id='attrs-bee9830b-802a-4347-8dab-7e0892eb6f32' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bee9830b-802a-4347-8dab-7e0892eb6f32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5098f060-9aef-42bb-95a4-2d53f8c4a279' class='xr-var-data-in' type='checkbox'><label for='data-5098f060-9aef-42bb-95a4-2d53f8c4a279' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;, 
  DATUM[&quot;World Geodetic System 1984&quot;, 
    SPHEROID[&quot;WGS 84&quot;, 6378137.0, 298.257223563, AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]], 
    AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]], 
  PRIMEM[&quot;Greenwich&quot;, 0.0, AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]], 
  UNIT[&quot;degree&quot;, 0.017453292519943295], 
  AXIS[&quot;Geodetic longitude&quot;, EAST], 
  AXIS[&quot;Geodetic latitude&quot;, NORTH], 
  AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>i2m :</span></dt><dd>0.002777777777778,0.0,0.0,-0.002777777777778,-180.0,90.0</dd></dl></div><div class='xr-var-data'><pre>array([-2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647, -2147483647, -2147483647, -2147483647, -2147483647,
       -2147483647], dtype=int32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6aabff66-4e7b-430f-80ba-b81ace301392' class='xr-section-summary-in' type='checkbox'  ><label for='section-6aabff66-4e7b-430f-80ba-b81ace301392' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c587e8ff-7db1-4859-b075-bd5e70540b17' class='xr-index-data-in' type='checkbox'/><label for='index-c587e8ff-7db1-4859-b075-bd5e70540b17' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  44.9986111111111,  44.99583333333334,  44.99305555555557,
        44.99027777777778,  44.98750000000001,  44.98472222222222,
        44.98194444444445, 44.979166666666686,  44.97638888888889,
       44.973611111111126,
       ...
        35.02638888888889,  35.02361111111112,  35.02083333333334,
        35.01805555555556,  35.01527777777778,            35.0125,
        35.00972222222222,  35.00694444444444,  35.00416666666668,
         35.0013888888889],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;, length=3600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-08abb076-0958-41d0-b72f-c16184a60279' class='xr-index-data-in' type='checkbox'/><label for='index-08abb076-0958-41d0-b72f-c16184a60279' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-9.998611111111103, -9.995833333333337, -9.993055555555543,
       -9.990277777777777, -9.987499999999983, -9.984722222222217,
       -9.981944444444451, -9.979166666666657, -9.976388888888891,
       -9.973611111111097,
       ...
       3.9736111111111256, 3.9763888888888914, 3.9791666666666856,
       3.9819444444444514,  3.984722222222217, 3.9875000000000114,
        3.990277777777777, 3.9930555555555713,  3.995833333333337,
       3.9986111111111313],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;, length=5040))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ae187004-b0c6-410e-9f7e-cc77c79ba817' class='xr-index-data-in' type='checkbox'/><label for='index-ae187004-b0c6-410e-9f7e-cc77c79ba817' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003,
       2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015,
       2016, 2017, 2018, 2019, 2020, 2021, 2022],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-84a5d77d-9de7-4e40-8e61-762a02bd09e3' class='xr-section-summary-in' type='checkbox'  ><label for='section-84a5d77d-9de7-4e40-8e61-762a02bd09e3' class='xr-section-summary' >Attributes: <span>(38)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>id :</span></dt><dd>ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-v2.0.7cds</dd><dt><span>title :</span></dt><dd>Land Cover Map of ESA CCI brokered by CDS</dd><dt><span>summary :</span></dt><dd>This dataset characterizes the land cover of a particular year (see time_coverage). The land cover was derived from the analysis of satellite data time series of the full period.</dd><dt><span>type :</span></dt><dd>ESACCI-LC-L4-LCCS-Map-300m-P1Y</dd><dt><span>project :</span></dt><dd>Climate Change Initiative - European Space Agency</dd><dt><span>references :</span></dt><dd>http://www.esa-landcover-cci.org/</dd><dt><span>institution :</span></dt><dd>UCLouvain</dd><dt><span>contact :</span></dt><dd>https://www.ecmwf.int/en/about/contact-us/get-support</dd><dt><span>comment :</span></dt><dd></dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>standard_name_vocabulary :</span></dt><dd>NetCDF Climate and Forecast (CF) Standard Names version 21</dd><dt><span>keywords :</span></dt><dd>land cover classification,satellite,observation</dd><dt><span>keywords_vocabulary :</span></dt><dd>NASA Global Change Master Directory (GCMD) Science Keywords</dd><dt><span>license :</span></dt><dd>ESA CCI Data Policy: free and open access</dd><dt><span>naming_authority :</span></dt><dd>org.esa-cci</dd><dt><span>cdm_data_type :</span></dt><dd>grid</dd><dt><span>TileSize :</span></dt><dd>2025:2025</dd><dt><span>tracking_id :</span></dt><dd>61b96fd7-42c3-4374-9de1-0dc3b0bcae2a</dd><dt><span>product_version :</span></dt><dd>2.0.7cds</dd><dt><span>creation_date :</span></dt><dd>20181130T095451Z</dd><dt><span>creator_name :</span></dt><dd>UCLouvain</dd><dt><span>creator_url :</span></dt><dd>http://www.uclouvain.be/</dd><dt><span>creator_email :</span></dt><dd>landcover-cci@uclouvain.be</dd><dt><span>source :</span></dt><dd>MERIS FR L1B version 5.05, MERIS RR L1B version 8.0, SPOT VGT P</dd><dt><span>history :</span></dt><dd>amorgos-4,0, lc-sdr-1.0, lc-sr-1.0, lc-classification-1.0,lc-user-tools-3.13,lc-user-tools-4.3</dd><dt><span>time_coverage_start :</span></dt><dd>19920101</dd><dt><span>time_coverage_end :</span></dt><dd>19921231</dd><dt><span>time_coverage_duration :</span></dt><dd>P1Y</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1Y</dd><dt><span>geospatial_lat_min :</span></dt><dd>-90.0</dd><dt><span>geospatial_lat_max :</span></dt><dd>90.0</dd><dt><span>geospatial_lon_min :</span></dt><dd>-180</dd><dt><span>geospatial_lon_max :</span></dt><dd>180</dd><dt><span>spatial_resolution :</span></dt><dd>300m</dd><dt><span>geospatial_lat_units :</span></dt><dd>degrees_north</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>0.002778</dd><dt><span>geospatial_lon_units :</span></dt><dd>degrees_east</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>0.002778</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
</section>
<section id="inspect-and-view-data-for-the-defined-aoi-iberian-peninsula">
<span id="satellite-satellite-land-cover-completeness-q03-code-section-2"></span><h3><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong><a class="headerlink" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula" title="Link to this heading">#</a></h3>
<section id="compute-land-cover-classes-area-coverage-for-each-nuts-2-region">
<h4>Compute Land Cover classes area coverage for each NUTS 2 region<a class="headerlink" href="#compute-land-cover-classes-area-coverage-for-each-nuts-2-region" title="Link to this heading">#</a></h4>
<p>To identify changes in LC patterns, by regions, NUTS 2 will be used, providing the information regarding the main regions of Iberian Peninsula.</p>
<p>The NUTS are a hierarchical system divided into 3 levels (<a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts">https://ec.europa.eu/eurostat/web/nuts</a>). NUTS 1 correspond to major socio-economic regions, NUTS 2 correspond to basic regions for the application of regional policies, and NUTS 3 correspond to small regions for specific diagnoses. Additionally a NUTS 0 level, usually co-incident with national boundaries is also available. The NUTS legislation is periodically amended; therefore multiple years are available for download.</p>
</section>
<section id="mask-regions">
<h4>Mask regions<a class="headerlink" href="#mask-regions" title="Link to this heading">#</a></h4>
<p>First, we need to establish the geometry of the NUTS region (level 2) in order to make the corresponding statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure Dask</span>
<span class="n">dask</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">scheduler</span><span class="o">=</span><span class="s1">&#39;threads&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;array.slicing.split_large_chunks&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Define CRS and bounding box for Iberian Peninsula</span>
<span class="n">crs_wgs84</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="n">iberian_bbox</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>

<span class="c1"># Load and filter GeoDataFrame</span>
<span class="n">shapefile_url</span> <span class="o">=</span> <span class="s2">&quot;https://gisco-services.ec.europa.eu/distribution/v2/nuts/shp/NUTS_RG_20M_2021_4326.shp.zip&quot;</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shapefile_url</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;LEVL_CODE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="p">[</span><span class="s2">&quot;NUTS_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;ES&quot;</span><span class="p">,</span> <span class="s2">&quot;PT&quot;</span><span class="p">))]</span>  <span class="c1"># Spain (ES) and Portugal (PT)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs_wgs84</span><span class="p">)</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">iberian_bbox</span><span class="p">)]</span>
<span class="n">gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">is_valid</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">is_empty</span><span class="p">]</span>

<span class="k">if</span> <span class="n">gdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid geometries found after filtering.&quot;</span><span class="p">)</span>

<span class="c1"># Ensure dataset CRS is set</span>
<span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Ensure dataset coordinates overlap with the filtered regions</span>
<span class="n">filtered_lon_min</span><span class="p">,</span> <span class="n">filtered_lat_min</span><span class="p">,</span> <span class="n">filtered_lon_max</span><span class="p">,</span> <span class="n">filtered_lat_max</span> <span class="o">=</span> <span class="n">gdf</span><span class="o">.</span><span class="n">total_bounds</span>
<span class="k">if</span> <span class="p">(</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">filtered_lon_max</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">filtered_lon_min</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">filtered_lat_max</span>
    <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">filtered_lat_min</span>
<span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="s2">&quot;Dataset coordinates do not overlap with the filtered regions. Check dataset and region alignment.&quot;</span>
    <span class="p">)</span>

<span class="c1"># Subset dataset to valid ranges</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">filtered_lon_min</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">filtered_lon_max</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span>
        <span class="nb">min</span><span class="p">(</span><span class="n">filtered_lat_max</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">filtered_lat_min</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Check subset dataset dimensions</span>
<span class="k">if</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Subset resulted in an empty dataset. Check the bounds and ensure overlap.&quot;</span><span class="p">)</span>

<span class="c1"># Create the regionmask</span>
<span class="n">regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">from_geopandas</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">)</span>

<span class="c1"># Create a 2D mask</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span>

<span class="n">ds</span><span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-cell-area">
<h4>Compute cell area<a class="headerlink" href="#compute-cell-area" title="Link to this heading">#</a></h4>
<p>Then, we can calculate the area of each pixel taking into consideration the curvature of the earth (i.e., weighted by the cosine of Latitude).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scaling factor for conversion (constant longitude resolution)</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">0.002778</span>  <span class="c1"># Degrees</span>
<span class="n">resolution_lon_km</span> <span class="o">=</span> <span class="n">scaling_factor</span> <span class="o">*</span> <span class="mf">111.195</span>  <span class="c1"># Longitude resolution in kilometres</span>

<span class="c1"># Use the latitude values directly from the dataset</span>
<span class="n">lats</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span>

<span class="c1"># Calculate the difference between consecutive latitude values</span>
<span class="n">lat_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">lats</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>  <span class="c1"># Absolute differences</span>
<span class="n">lat_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lat_diff</span><span class="p">,</span> <span class="n">lat_diff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Assume the last cell has the same size as the one before</span>

<span class="c1"># Convert latitude differences to kilometres</span>
<span class="n">resolution_lat_km</span> <span class="o">=</span> <span class="n">lat_diff</span> <span class="o">*</span> <span class="mf">111.195</span>  <span class="c1"># Latitude-dependent resolution</span>

<span class="c1"># Compute the grid cell area for each latitude</span>
<span class="n">grid_cell_area</span> <span class="o">=</span> <span class="n">resolution_lon_km</span> <span class="o">*</span> <span class="n">resolution_lat_km</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span>

<span class="c1"># Assign attributes to the grid cell area</span>
<span class="n">grid_cell_area</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;cell_area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Grid cell area&quot;</span><span class="p">,</span>
    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km²&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Add the grid cell area as a coordinate to the dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">cell_area</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># Use `.data` to extract the array</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="select-forest-classes-and-prepare-dataset">
<h4>Select Forest Classes and Prepare Dataset<a class="headerlink" href="#select-forest-classes-and-prepare-dataset" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define forest classes</span>
<span class="n">forest_classes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">]</span>

<span class="c1"># Create a mask for forested areas</span>
<span class="n">forest_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lccs_class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">forest_classes</span><span class="p">)</span>

<span class="c1"># Masked forest area using cell area</span>
<span class="n">ds_forest_area</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;cell_area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">forest_mask</span><span class="p">)</span>

<span class="c1"># Stack latitude and longitude into a single dimension</span>
<span class="n">ds_forest_area</span> <span class="o">=</span> <span class="n">ds_forest_area</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stacked_lat_lon</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>

<span class="c1"># Create a stacked mask and align dimensions</span>
<span class="n">stacked_mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stacked_lat_lon</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">))</span>
<span class="n">stacked_mask</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;stacked_mask&quot;</span>

<span class="c1"># Attach the stacked mask to the dataset</span>
<span class="n">ds_forest_area</span> <span class="o">=</span> <span class="n">ds_forest_area</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">stacked_mask</span><span class="o">=</span><span class="n">stacked_mask</span><span class="p">)</span>

<span class="c1"># Group by regions and compute forested area for each year</span>
<span class="n">forest_area_by_region</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ds_forest_area</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;stacked_mask&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;stacked_lat_lon&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="compute-forest-area-per-region-and-year">
<h4>Compute forest area per region and year<a class="headerlink" href="#compute-forest-area-per-region-and-year" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">growth</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">reg</span><span class="p">,</span> <span class="n">reg_area</span> <span class="ow">in</span> <span class="n">forest_area_by_region</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;stacked_mask&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>  <span class="c1"># Skip NaN regions</span>
        <span class="k">continue</span>

    <span class="c1"># Ensure valid region indexing and naming</span>
    <span class="n">region_name</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">reg</span><span class="p">)]</span><span class="o">.</span><span class="n">name</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">ds_forest_area</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">reg_area</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten in case of higher-dimensional arrays</span>

    <span class="c1"># Save growth data by year</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">growth</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">):</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">values</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">growth</span><span class="p">[</span><span class="n">region_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Handle regions with no data</span>

    <span class="c1"># Add results to the list</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region_name</span><span class="p">,</span>
            <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span>
            <span class="s2">&quot;Forest_Area&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="p">})</span>

<span class="c1"># Convert results to a DataFrame</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Add geometry to results_df</span>
<span class="k">if</span> <span class="s1">&#39;NUTS_NAME&#39;</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">gdf</span><span class="p">[[</span><span class="s1">&#39;NUTS_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Region&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;NUTS_NAME&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: NUTS_NAME column not found in gdf.&quot;</span><span class="p">)</span>

<span class="c1"># Ensure results_df is a GeoDataFrame</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]),</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="map-forest-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">
<h4>Map forest percentage coverage over-time by NUTS regions in the AoI<a class="headerlink" href="#map-forest-percentage-coverage-over-time-by-nuts-regions-in-the-aoi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reproject the GeoDataFrame to a projected CRS (EPSG:3035 is a good choice for Europe)</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:3035&quot;</span><span class="p">)</span>

<span class="c1"># Calculate the total area of each region (in square kilometers)</span>
<span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region_Total_Area&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>  <span class="c1"># Convert from m² to km²</span>

<span class="c1"># Ensure &#39;Year&#39; is converted to string if needed</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="c1">#Calculate Forest Percentage</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Area&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Region_Total_Area&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Pivot the data to have years as columns</span>
<span class="n">forest_pivot</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Forest_Percentage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Extract years for plotting</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">forest_pivot</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()]</span>

<span class="c1"># Normalize color scale across all maps based on percentage coverage</span>
<span class="n">norm_percentage</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Percentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Plot settings</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Plot each year in a separate subplot</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">years</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">results_df_year</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">results_df_year</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Forest_Percentage&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGn&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_percentage</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Forest Coverage (%) in </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Hide unused subplots</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">),</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Step 8: Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Allocate space for the color bar</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Create a new axes for color bar</span>

<span class="c1"># Create a single ScalarMappable object for the common colorbar</span>
<span class="n">sm_common</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGn&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_percentage</span><span class="p">)</span>
<span class="n">sm_common</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Dummy array for the scalar mappable</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm_common</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forest Coverage (%)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/52ab7bc5e833d5bfb1892d0529bf9efa297554fc026fa0717bd26d8a92996287.png" src="../../_images/52ab7bc5e833d5bfb1892d0529bf9efa297554fc026fa0717bd26d8a92996287.png" />
</div>
</div>
</section>
<section id="map-forest-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">
<h4>Map forest percentage coverage change over-time by NUTS regions in the AoI<a class="headerlink" href="#map-forest-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the year-over-year percentage differences for each region</span>
<span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Percentage_Diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Region&#39;</span><span class="p">)[</span><span class="s1">&#39;Forest_Percentage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="c1"># Automatically exclude the first year</span>
<span class="n">first_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>  <span class="c1"># Ensure the first year is an integer</span>
<span class="n">filtered_years</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>  <span class="c1"># Ensure years are integers</span>
<span class="n">filtered_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">filtered_years</span> <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">first_year</span><span class="p">]</span>  <span class="c1"># Exclude the first year</span>

<span class="c1"># Normalize color scale around zero (e.g., -6 to +6 with 0 as neutral)</span>
<span class="n">norm_diff</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Percentage_Diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Forest_Percentage_Diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Plot settings</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">4</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Improved color scale: Diverging with neutral at zero</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="s2">&quot;RdYlGn&quot;</span>

<span class="c1"># Plot each year in a separate subplot</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
    <span class="n">results_df_year</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="n">year</span><span class="p">]</span>
    <span class="n">previous_year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Ensure year is treated as an integer</span>
    <span class="n">results_df_year</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;Forest_Percentage_Diff&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_diff</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Change in Forest Coverage: </span><span class="si">{</span><span class="n">previous_year</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Hide unused subplots</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filtered_years</span><span class="p">),</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Allocate space for the color bar</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>  <span class="c1"># Create a new axes for the color bar</span>

<span class="c1"># Create a single ScalarMappable object for the common colorbar</span>
<span class="n">sm_common</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm_diff</span><span class="p">)</span>
<span class="n">sm_common</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Dummy array for the scalar mappable</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm_common</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forest Coverage Diff (%)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a0367988dc856602017a72ea2247ad5ded029067f3eaf44d896e628dc17d1f9d.png" src="../../_images/a0367988dc856602017a72ea2247ad5ded029067f3eaf44d896e628dc17d1f9d.png" />
</div>
</div>
</section>
<section id="map-analysis">
<h4>Map Analysis<a class="headerlink" href="#map-analysis" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Over the 28-year period, all regions maintain a consistent area of forest.</p></li>
<li><p>Regions such as Principado de Asturias, Cantabria, País Vasco, Galicia, and Centro (PT) consistently exhibit the highest levels of forest coverage.</p></li>
<li><p>Northern Spain (Galicia, Asturias, Cantabria, País Vasco) is often affected by negative fluctuations, particularly in 1998–2000 and 2003–2004. The classification models may have struggled with complex topography and mixed vegetation types <a class="reference external" href="https://www.mdpi.com/2072-4292/15/9/2285">(Zhao et al., 2023)</a>.</p></li>
<li><p>Southern Portugal &amp; Spain (Alentejo, Algarve, Andalucía), unlike northern Spain, experiences more positive fluctuations in area, particularly in 1998-2004.</p></li>
<li><p>From 2006–2007 onward the maps show more stable estimates.</p></li>
</ul>
</section>
<section id="potential-drivers-and-methodological-considerations-in-afforestation-deforestation-trends-in-the-iberian-peninsula-19922022">
<h4><strong>Potential Drivers and Methodological Considerations in Afforestation/Deforestation Trends in the Iberian Peninsula (1992–2022)</strong><a class="headerlink" href="#potential-drivers-and-methodological-considerations-in-afforestation-deforestation-trends-in-the-iberian-peninsula-19922022" title="Link to this heading">#</a></h4>
<p>Forest dynamics in the Iberian Peninsula over the last three decades have been shaped by a combination of <strong>natural events</strong>, <strong>human activities</strong>, and <strong>policy interventions</strong>. Before analysing trends in a land use and land cover (LULC) time series, it is crucial to account for abrupt shifts that may distort trend estimates. These shifts, often referred to as breakpoints, can result from:</p>
<p><strong>Natural Events</strong></p>
<ul class="simple">
<li><p>Wildfires:  The Iberian Peninsula experiences frequent and intense wildfires, particularly in <strong>Galicia, Catalonia, and central Portugal</strong>. Major fire seasons occurred in <strong>2003, 2005, and 2017</strong>, causing the destruction of vast areas of forest <a class="reference external" href="https://api.semanticscholar.org/CorpusID:265869582">(Mato et al., 2014)</a>. Wildfires have become a key driver of land cover change, especially in fire-prone regions of Portugal and Spain <a class="reference external" href="https://doi.org/10.1016/j.landurbplan.2011.03.001">(Silva et al., 2011)</a>.</p></li>
<li><p><strong>Droughts:</strong>  Recurrent droughts have exacerbated forest degradation, weakening tree resilience and delaying post-fire recovery <a class="reference external" href="https://nhess.copernicus.org/articles/12/3123/2012/">(Gouveia et al., 2012)</a>. The severe droughts of <strong>2005 and 2017</strong> significantly reduced vegetation cover, affecting Mediterranean pine and oak forests <a class="reference external" href="https://doi.org/10.1016/j.foreco.2017.10.011">(Vidal-Macua et al., 2017)</a>.</p></li>
</ul>
<p><strong>Human Activities</strong></p>
<ul class="simple">
<li><p>Farmland Abandonment: Rural depopulation since the 1990s has driven widespread farmland abandonment, leading to natural forest regeneration in regions like <strong>northern Portugal and Galicia</strong> <a class="reference external" href="https://api.semanticscholar.org/CorpusID:238829360">(Palmero-Iniesta et al., 2021)</a>.</p></li>
<li><p>Logging and Eucalyptus Plantations:  Logging activities and the expansion of eucalyptus plantations in <strong>Galicia and central Portugal</strong> have caused periodic forest loss and regrowth <a class="reference external" href="https://doi.org/10.1016/j.landurbplan.2011.03.001">(Silva et al., 2011)</a>.</p></li>
</ul>
<p><strong>Policy and Economic Influences</strong></p>
<ul class="simple">
<li><p>Afforestation and Reforestation: EU-funded afforestation programs under the <strong>Common Agricultural Policy (CAP)</strong> promoted the planting of trees on abandoned farmland, particularly in <strong>Castilla y León, Extremadura, and parts of Portugal</strong>, leading to abrupt increases in forest cover <a class="reference external" href="https://doi.org/10.1016/j.landusepol.2018.06.054">(Sevillano et al., 2018)</a>.</p></li>
<li><p>Natura 2000 Network and Conservation Policies: The <strong>Natura 2000 network</strong> has contributed to forest conservation efforts, particularly in regions like <strong>Sierra de Guadarrama (Madrid)</strong> and <strong>Peneda-Gerês National Park (Portugal)</strong> <a class="reference external" href="https://doi.org/10.1016/j.jag.2014.11.010">(Regos et al., 2015)</a>.</p></li>
<li><p>Economic Downturn (2008–2013):  The economic crisis reduced logging temporarily alleviating deforestation pressures (Mateus &amp; Fernandes, 2014).</p></li>
</ul>
<p><strong>Methodology</strong></p>
<ul class="simple">
<li><p>Certain shifts in forest cover may be related to data collection and processing rather than actual forest dynamics. For example, transitions between different satellite sensors—<strong>AVHRR (1992–1999), SPOT-VGT (1999–2013), and Sentinel-3 OLCI (2020–2022)</strong>—can introduce artificial breaks in the time series <a class="reference external" href="https://doi.org/10.3390/rs16203822">(Toté et al., 2015)</a>.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Global SR Composite Time Series</p></th>
<th class="head"><p>Reference Period</p></th>
<th class="head"><p>Satellite Data Source</p></th>
<th class="head"><p>Technical Specifications</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AVHRR global SR composite time series</p></td>
<td><p>1992-1999</p></td>
<td><p>AVHRR-2 on NOAA-11 and NOAA-14</p></td>
<td><p>1 km spatial resolution, 5 spectral bands in visible and infrared, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>SPOT-VGT global SR composites</p></td>
<td><p>1999-2013</p></td>
<td><p>SPOT 4, 5 Vegetation sensor</p></td>
<td><p>1 km spatial resolution, 4 spectral bands in visible, near-infrared (NIR), and shortwave infrared (SWIR), Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>MERIS global SR composite time series</p></td>
<td><p>2003-2012</p></td>
<td><p>Envisat MERIS FR &amp; RR</p></td>
<td><p>300 m or 1,000 m resolution full swath, 15 spectral bands in visible and NIR, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>PROBA-V global SR composite time series</p></td>
<td><p>2013-2019</p></td>
<td><p>PROBA-V</p></td>
<td><p>300 m spatial resolution, 4 spectral bands in visible, near-infrared, and SWIR, Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>Sentinel-3 OLCI global SR composite time series</p></td>
<td><p>2020</p></td>
<td><p>S3 OLCI</p></td>
<td><p>300 m resolution full swath, 15 spectral bands in visible and NIR, Global coverage</p></td>
</tr>
<tr class="row-odd"><td><p>Sentinel-3 global SR composite time series</p></td>
<td><p>2021-2022</p></td>
<td><p>S3 OLCI &amp; S3 SLSTR</p></td>
<td><p>300 m resolution full swath, 21 spectral bands in visible, NIR, and SWIR, Global coverage</p></td>
</tr>
<tr class="row-even"><td><p>Advanced Synthetic Aperture Radar - Wide Swath Mode (ASAR WSM) time series</p></td>
<td><p>2005-2012</p></td>
<td><p>Envisat ASAR WSM</p></td>
<td><p>150 m spatial resolution, Microwave band, Global coverage</p></td>
</tr>
</tbody>
</table>
</div>
<p>Ignoring such breakpoints can lead to inaccurate conclusions—either by introducing artificial trends or obscuring real changes.</p>
</section>
</section>
<section id="breakpoint-detection">
<span id="satellite-satellite-land-cover-completeness-q03-code-section-3"></span><h3><strong>3. Breakpoint Detection</strong><a class="headerlink" href="#breakpoint-detection" title="Link to this heading">#</a></h3>
<p>A good first step in assessing potential  impacts on land cover (LC) trends is to apply simple exploratory methods, such as analysing the rate of change (time series derivative). This will help identify sudden shifts in the data.</p>
<p>However, while these approaches highlight points of interest, they do not confirm whether the observed changes are truly structural. Percentage differences can be sensitive to random fluctuations, and derivative-based analyses may exaggerate year-to-year variations that do not necessarily indicate a breakpoint. To formally assess structural changes we apply a statistical breakpoint detection method.</p>
<p><strong>Rate of Change Calculation</strong></p>
<ul class="simple">
<li><p>The <strong>first derivative</strong> of the forest area time series is computed to identify <strong>years with significant year-to-year changes</strong>.</p></li>
<li><p>This highlights <strong>periods where the rate of change deviates substantially</strong> from surrounding years, signaling potential anomalies.</p></li>
</ul>
<p><strong>Statistical Thresholding of Derivative Spikes</strong></p>
<ul class="simple">
<li><p>A threshold is <strong>calculated dynamically</strong> as the <strong>mean absolute derivative plus 1.5 times the standard deviation (1.5σ)</strong>.</p></li>
<li><p>Years where the <strong>absolute rate of change</strong> exceeds this threshold are <strong>flagged as potential breakpoint candidates</strong>.</p></li>
<li><p>This <strong>reduces false positives</strong> by filtering out <strong>minor fluctuations</strong> and focusing on <strong>significant deviations</strong>.</p></li>
</ul>
<p><strong>Breakpoint Detection Using PELT Algorithm</strong></p>
<ul class="simple">
<li><p>The <strong>Pruned Exact Linear Time (PELT)</strong> algorithm is applied to <strong>detect structural changes</strong> in the dataset.</p></li>
<li><p>The algorithm is run using the <strong>L2 cost function</strong> (<code class="docutils literal notranslate"><span class="pre">model=&quot;l2&quot;</span></code>) to minimize segmentation errors.</p></li>
<li><p>The <strong>penalty parameter (<code class="docutils literal notranslate"><span class="pre">pen</span></code>) is dynamically set</strong> as <code class="docutils literal notranslate"><span class="pre">np.std(forest_area)</span> <span class="pre">*</span> <span class="pre">2.5</span></code> to balance <strong>false positives and meaningful breakpoints</strong>.</p></li>
<li><p>A <strong>minimum segment length (<code class="docutils literal notranslate"><span class="pre">min_size=2</span></code>)</strong> is used to prevent excessive segmentation.</p></li>
</ul>
<p><strong>Filtering Breakpoints Based on Derivative Spikes</strong></p>
<ul class="simple">
<li><p><strong>Only breakpoints that align closely (within ±2 years) with derivative spikes are retained.</strong></p></li>
<li><p>This <strong>ensures detected breakpoints correspond to actual shifts</strong> rather than <strong>random segmentation artifacts</strong>.</p></li>
<li><p>The breakpoints are then <strong>stored for further regional clustering analysis</strong>.</p></li>
</ul>
<p><strong>Application of Savitzky-Golay Filtering for Smoothing</strong></p>
<ul class="simple">
<li><p>To <strong>better visualize trends</strong>, the first derivative is <strong>smoothed</strong> using a <strong>Savitzky-Golay filter</strong> with <code class="docutils literal notranslate"><span class="pre">window_length=5</span></code> and <code class="docutils literal notranslate"><span class="pre">polyorder=2</span></code>.</p></li>
<li><p>This helps <strong>reduce noise while preserving significant trend changes</strong>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># **Store breakpoints across all regions for clustering analysis**</span>
<span class="n">breakpoint_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">breakpoint_storage</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to store breakpoints</span>

<span class="c1"># **Unique regions from dataset**</span>
<span class="n">unique_regions</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">n_regions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_regions</span><span class="p">)</span>

<span class="c1"># **Determine global y-axis limits for Forest Area**</span>
<span class="n">global_y_min</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">global_y_max</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># **Determine global y-axis limits for Rate of Change**</span>
<span class="n">global_derivative_min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<span class="n">global_derivative_max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>

<span class="c1"># **First Pass: Calculate global min/max for first derivative**</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">unique_regions</span><span class="p">:</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Forest_area</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Ensure there are at least two years for differentiation</span>
        <span class="n">delta_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="n">delta_Forest_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Forest_area</span><span class="p">)</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">delta_Forest_area</span> <span class="o">/</span> <span class="n">delta_years</span>  

        <span class="n">global_derivative_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">global_derivative_min</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span>
        <span class="n">global_derivative_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">global_derivative_max</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span>

<span class="c1"># **Dynamically set up subplot grid**</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Fixed columns for better visualization</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_regions</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>  <span class="c1"># Dynamically determine rows</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">n_cols</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="n">n_rows</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># Flatten to access easily</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_regions</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Forest_area</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># **Calculate the first derivative (rate of change)**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">delta_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
        <span class="n">delta_Forest_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Forest_area</span><span class="p">)</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">delta_Forest_area</span> <span class="o">/</span> <span class="n">delta_years</span>  
        <span class="n">derivative_years</span> <span class="o">=</span> <span class="p">(</span><span class="n">years</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">years</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_derivative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="n">derivative_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

    <span class="c1"># **Detect potential anomaly years from derivative spikes (Threshold: 1.5σ)**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">derivative_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span>
        <span class="n">spike_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">derivative_threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">spike_years</span> <span class="o">=</span> <span class="n">years</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="n">spike_years</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># **Apply PELT for breakpoint detection**</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="n">rpt</span><span class="o">.</span><span class="n">Pelt</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Forest_area</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">pen_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Forest_area</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.5</span>
    <span class="n">detected_breakpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">algo</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="n">pen_value</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>  

    <span class="c1"># **Filter breakpoints to keep only those close to derivative spikes**</span>
    <span class="n">confirmed_breakpoints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">detected_breakpoints</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">bp</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spike_indices</span><span class="p">):</span>
            <span class="n">confirmed_breakpoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span>
            <span class="n">breakpoint_counts</span><span class="p">[</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>  
            <span class="n">breakpoint_storage</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">])})</span>

    <span class="c1"># **Apply Savitzky-Golay filter for smoothing**</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>  
        <span class="n">first_derivative_smoothed</span> <span class="o">=</span> <span class="n">savgol_filter</span><span class="p">(</span><span class="n">first_derivative</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">polyorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">first_derivative_smoothed</span> <span class="o">=</span> <span class="n">first_derivative</span>  

    <span class="c1"># **Plot Forest area in grey**</span>
    <span class="n">line1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">Forest_area</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forest Area&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Forest Area (km²)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">global_y_min</span><span class="p">,</span> <span class="n">global_y_max</span><span class="p">)</span>

    <span class="c1"># **Overlay Detected Breakpoints in Red**</span>
    <span class="n">lines_bp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">confirmed_breakpoints</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="n">bp</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Confirmed Breakpoint&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">lines_bp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># **Mark Derivative-Based Potential Change Years in Yellow**</span>
    <span class="n">lines_spike</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spike_years</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">dy</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Derivative Spike&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">lines_spike</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="c1"># **Create a secondary y-axis for the first derivative**</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">line2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">derivative_years</span><span class="p">,</span> <span class="n">first_derivative_smoothed</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rate of Change&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Rate of Change (Δ Forest Area / Δ Year)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">global_derivative_min</span><span class="p">,</span> <span class="n">global_derivative_max</span><span class="p">)</span>

    <span class="c1"># **Customize subplot**</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">years</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> (Ruptures-Based Breakpoints)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="c1"># **Combine legend entries from both y-axes**</span>
    <span class="n">handles1</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">handles2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles1</span> <span class="o">+</span> <span class="n">handles2</span><span class="p">,</span> <span class="n">labels1</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="c1"># **Analyze Breakpoint Clusters Across Regions**</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">### Breakpoint Clusters Across Regions ###&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">breakpoint_counts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Year </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> regions detected a breakpoint&quot;</span><span class="p">)</span>

<span class="c1"># **Hide any unused subplot axes**</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_regions</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

<span class="c1"># **Adjust layout and display**</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>### Breakpoint Clusters Across Regions ###
Year 1996.0: 16 regions detected a breakpoint
Year 2001.0: 6 regions detected a breakpoint
Year 2016.0: 4 regions detected a breakpoint
</pre></div>
</div>
<img alt="../../_images/e48bc9c1479570840b75a9ce4fc98747524103313d278899db02e9d7533a01ee.png" src="../../_images/e48bc9c1479570840b75a9ce4fc98747524103313d278899db02e9d7533a01ee.png" />
</div>
</div>
<section id="breakpoint-analysis">
<h4>Breakpoint Analysis<a class="headerlink" href="#breakpoint-analysis" title="Link to this heading">#</a></h4>
<p><strong>🛑 Breakpoint [1996]</strong></p>
<ul class="simple">
<li><p>The 1996 breakpoint coincides with a period of methodological changes in preparation for the launch of SPOT-VGT (1998). These adjustments likely involved recalibrations in land cover classification, improved spectral band processing, and harmonization efforts across datasets. These refinements could have led to systematic shifts in detected forest areas, affecting reported trends in multiple regions.</p></li>
<li><p>Breakpoints were detected in 16 different regions, covering diverse landscapes across the Iberian Peninsula (Mediterranean, Atlantic, and continental climates). This broad spatial distribution suggests a system-wide change in classification methodologies rather than localised environmental drivers. Unlike breakpoints tied to specific ecological or anthropogenic events, a simultaneous shift across diverse regions strongly indicates a methodological cause.</p></li>
<li><p>While forest recovery due to land abandonment and early afforestation programs may have been ongoing, there is no single large-scale event (e.g., policy shifts, extreme wildfires) that would explain a consistent breakpoint across multiple regions. If a real environmental event caused this breakpoint, we would expect regional variability rather than near-universal detection across Iberia.</p></li>
</ul>
<p><em>Interpretation</em></p>
<ul class="simple">
<li><p>Primarily methodological → The 1996 breakpoint is most likely due to preparatory changes in land cover classification before SPOT-VGT, leading to apparent shifts in forest cover trends.</p></li>
<li><p>Minor real impacts → Some land abandonment and afforestation efforts may have contributed to real forest cover changes, but they do not explain the widespread breakpoint.</p></li>
</ul>
<hr class="docutils" />
<p><strong>🛑 Breakpoint [2001]</strong></p>
<ul class="simple">
<li><p>The shift from AVHRR (Advanced Very High-Resolution Radiometer) to SPOT-VGT (Vegetation Monitoring Satellite) in 1999 resulted in:</p>
<ul>
<li><p>Higher spectral resolution, improving vegetation classification.</p></li>
<li><p>Changes in classification thresholds, possibly altering the way forests were distinguished from shrublands or degraded areas.</p></li>
</ul>
</li>
</ul>
<p>If the new algorithm refined how forests were mapped, it may have caused some areas to show an increase (where vegetation was now classified as forest) and others to show a decrease (where previously overestimated forests were corrected).</p>
<ul class="simple">
<li><p>The Iberian Peninsula features diverse landscapes—from Mediterranean shrublands to Atlantic forests—which may have responded differently to classification changes:</p>
<ul>
<li><p>Densely forested regions (e.g., Galicia, Asturias) may have been more stable or even increased.</p></li>
<li><p>Semi-arid or mixed-use landscapes (e.g., Andalusia, Valencia) may have seen a decrease as improved classification separated forests from scrublands or agricultural areas.</p></li>
</ul>
</li>
</ul>
<p>Regional variability in land cover complexity could have amplified the mixed effects of the breakpoint.</p>
<ul class="simple">
<li><p>In 1990s-early 2000s the EU reforestation programs were expanding, but simultaneously, urban expansion and logging persisted. While afforestation policies may have caused increases in some areas, land-use change, fires, and agricultural expansion may have driven declines elsewhere. However, given that three regions increased and three decreased, this explanation alone is insufficient—a sensor-driven change remains the more likely factor.</p></li>
</ul>
<p><em>Interpretation</em></p>
<p>Mostly methodological → The SPOT-VGT transition likely led to regionally dependent classification adjustments, explaining the inconsistent increases and decreases.<br />
Some real effects → Local deforestation and afforestation trends may have reinforced or counteracted the methodological shift, but they are not the primary driver of the breakpoint.</p>
<p>Unlike 1996, which was a widespread methodological breakpoint, 2001 shows mixed behaviour across regions. This suggests a recalibration in classification methods rather than a universal environmental event.
Sensor shifts do not always affect all regions in the same way—differences in land cover complexity likely influenced how SPOT-VGT changes were perceived across the Iberian Peninsula.</p>
<hr class="docutils" />
<p><strong>🛑 Breakpoint [2016]</strong></p>
<ul class="simple">
<li><p>The transition to Sentinel-2 imagery with 10m spatial resolution significantly improved land cover classification, particularly in detecting small or fragmented forest patches. Enhanced classification algorithms further increased the ability to distinguish between forests, shrublands, and other vegetated areas, leading to adjustments in areas previously considered stable These changes affected both urban-periurban zones (e.g., Madrid, Lisbon Metropolitan Area) and rural regions (e.g., Castilla y León, Alentejo).</p></li>
<li><p>In urbanized areas, the higher resolution likely allowed for a clearer separation between forest patches and urban vegetation, resulting in some reclassification to shrubland or non-forest categories.</p></li>
<li><p>In rural landscapes, improved spectral discrimination refined forest boundaries, producing localised reclassifications—some areas appearing denser, others shifting categories.</p></li>
<li><p>The 2016 breakpoint differs from earlier ones, showing no consistent directional trend:</p>
<ul>
<li><p>Slight increases in forest cover are observed in regions such as Castilla y León and Alentejo.</p></li>
<li><p>Slight decreases occur in areas like Madrid and the Lisbon Metropolitan Area, likely due to the reclassification of fragmented vegetation.</p></li>
</ul>
</li>
</ul>
<p><em>Interpretation</em></p>
<p>Primarily methodological → The breakpoint in 2016 aligns with the introduction of Sentinel-2 and improved classification techniques, which enhanced forest differentiation.<br />
Possible minor real effects → While some localised land use changes may have contributed, there is no evidence of large-scale afforestation or deforestation corresponding to this year.</p>
<hr class="docutils" />
<p>📊 <strong>Summary Table</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Breakpoint Year</strong></p></th>
<th class="head"><p><strong>Main Cause</strong></p></th>
<th class="head"><p><strong>Possible reason</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>1996</strong></p></td>
<td><p>Pre-SPOT-VGT methodological adjustments and land cover classification refinements</p></td>
<td><p><strong>Mostly methodological</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>2001</strong></p></td>
<td><p>SPOT-VGT transition, EU reforestation efforts</p></td>
<td><p><strong>Partially real, partially sensor-driven</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>2016</strong></p></td>
<td><p>Sentinel-2 transition and improved classification, urban-periurban forest differentiation</p></td>
<td><p><strong>Mostly methodological</strong></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="trend-assessment">
<span id="satellite-satellite-land-cover-completeness-q03-code-section-4"></span><h3><strong>4. Trend Assessment</strong><a class="headerlink" href="#trend-assessment" title="Link to this heading">#</a></h3>
<p>The next and final step is to determine whether the trend should be computed for the entire period (total trend) or divided into segments based on detected breakpoints.</p>
<p>The decision between using the total trend or segmented trends is based on Sen’s Slope (Trend Magnitude) and Mann-Kendall p-values (Trend Significance). Sen’s Slope is a non-parametric estimator that calculates the median rate of change over time, making it robust to outliers and suitable for detecting monotonic trends. First, Sen’s Slope is computed for the total trend, capturing the overall rate of forest change. Then, Sen’s Slope is calculated for each segmented trend to assess whether breakpoints introduce significant shifts in trend magnitude. The Mann-Kendall test is a non-parametric statistical test used to assess the presence of a monotonic upward or downward trend in a time series without requiring the data to follow any particular distribution. In parallel, the Mann-Kendall p-value is evaluated for both the total and segmented trends to measure trend significance—lower p-values indicate stronger evidence of a significant trend.</p>
<p>The final decision is based on the following approach:</p>
<ul class="simple">
<li><p>If segmented trends show substantially different Sen’s Slopes compared to the total trend and exhibit stronger statistical significance (lower p-values), segmentation is preferred.</p></li>
<li><p>If segmented trends closely resemble the total trend or do not provide a clear statistical advantage, the total trend is used to maintain a simpler and more robust interpretation.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define breakpoints_df to store breakpoints across all regions</span>
<span class="n">breakpoints_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">breakpoint_storage</span><span class="p">)</span>

<span class="c1"># Ensure &quot;Year&quot; columns are numeric</span>
<span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add Sen&#39;s slope, rate of change, and significance to trends storage</span>
<span class="n">trends</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Iterate through each region</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">region_data</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>

    <span class="n">X_total</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_total</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y_total</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">continue</span>  

    <span class="c1"># Compute Sen’s Slope for Total Series</span>
    <span class="n">total_sen_slope</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">total_p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">theilslopes</span><span class="p">(</span><span class="n">y_total</span><span class="p">,</span> <span class="n">X_total</span><span class="p">)</span>
    
    <span class="c1"># Compute Rate of Change (Total)</span>
    <span class="n">mean_forest_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_total</span><span class="p">)</span>
    <span class="n">total_rate_of_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_sen_slope</span> <span class="o">/</span> <span class="n">mean_forest_area</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">mean_forest_area</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Store total trend</span>
    <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;Start_Year&quot;</span><span class="p">:</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
        <span class="s2">&quot;End_Year&quot;</span><span class="p">:</span> <span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="s2">&quot;Sen_Slope&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_sen_slope</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_rate_of_change</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Total&quot;</span><span class="p">,</span>
        <span class="s2">&quot;P_Value&quot;</span><span class="p">:</span> <span class="n">total_p_value</span><span class="p">,</span>
        <span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">:</span> <span class="n">total_p_value</span>  <span class="c1"># Assuming no correction here, but could be added if needed</span>
    <span class="p">})</span>

    <span class="c1"># Extract breakpoints for segmented trends</span>
    <span class="n">region_breakpoints</span> <span class="o">=</span> <span class="n">breakpoints_df</span><span class="p">[</span><span class="n">breakpoints_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">][</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">all_breakpoints</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">region_breakpoints</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]))</span>

    <span class="c1"># Calculate Sen&#39;s Slope for each segment</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_breakpoints</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="o">=</span> <span class="n">all_breakpoints</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">all_breakpoints</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">segment_data</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">start_year</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">end_year</span><span class="p">)]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">segment_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">X_segment</span> <span class="o">=</span> <span class="n">segment_data</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y_segment</span> <span class="o">=</span> <span class="n">segment_data</span><span class="p">[</span><span class="s2">&quot;Forest_Area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Compute Sen’s Slope for Segmented Series</span>
        <span class="n">segment_sen_slope</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">segment_p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">theilslopes</span><span class="p">(</span><span class="n">y_segment</span><span class="p">,</span> <span class="n">X_segment</span><span class="p">)</span>
        
        <span class="c1"># Compute Rate of Change (Segment)</span>
        <span class="n">mean_segment_forest_area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_segment</span><span class="p">)</span>
        <span class="n">segment_rate_of_change</span> <span class="o">=</span> <span class="p">(</span><span class="n">segment_sen_slope</span> <span class="o">/</span> <span class="n">mean_segment_forest_area</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">mean_segment_forest_area</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># Store segmented trend</span>
        <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="s2">&quot;Start_Year&quot;</span><span class="p">:</span> <span class="n">start_year</span><span class="p">,</span>
            <span class="s2">&quot;End_Year&quot;</span><span class="p">:</span> <span class="n">end_year</span><span class="p">,</span>
            <span class="s2">&quot;Sen_Slope&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">segment_sen_slope</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">segment_rate_of_change</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Segmented&quot;</span><span class="p">,</span>
            <span class="s2">&quot;P_Value&quot;</span><span class="p">:</span> <span class="n">segment_p_value</span><span class="p">,</span>
            <span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">:</span> <span class="n">segment_p_value</span>  <span class="c1"># Assuming no correction here, but could be added if needed</span>
        <span class="p">})</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">trends_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trends</span><span class="p">)</span>

<span class="c1"># Function to decide which trend to recommend (based on slope and rate of change)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">recommend_trend</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">total_row</span><span class="p">):</span>
    <span class="c1"># If the segmented trend is not significant, prefer the total trend</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Corrected_P_Value&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Total&quot;</span>
    
    <span class="c1"># If both are significant, compare the rate of change</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">total_row</span><span class="p">[</span><span class="s2">&quot;Rate_of_Change (%)&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s2">&quot;Segmented&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Total&quot;</span>

<span class="c1"># Creating the new column &#39;Recommended_Trend&#39;</span>
<span class="n">recommended_trends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">trends_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span>
    
    <span class="c1"># Find the corresponding total trend row for comparison</span>
    <span class="n">total_row</span> <span class="o">=</span> <span class="n">trends_df</span><span class="p">[(</span><span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Total&quot;</span><span class="p">)]</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">total_row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">total_row</span> <span class="o">=</span> <span class="n">total_row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Since there should be one Total row per region</span>
        
        <span class="c1"># Apply recommendation logic</span>
        <span class="n">recommended_trend</span> <span class="o">=</span> <span class="n">recommend_trend</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">total_row</span><span class="p">)</span>
        <span class="n">recommended_trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recommended_trend</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">recommended_trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Add the &#39;Recommended_Trend&#39; to the DataFrame</span>
<span class="n">trends_df</span><span class="p">[</span><span class="s2">&quot;Recommended_Trend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">recommended_trends</span>

<span class="c1"># Display the final DataFrame</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Show all rows</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_columns&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Show all columns</span>

<span class="n">display</span><span class="p">(</span><span class="n">trends_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Start_Year</th>
      <th>End_Year</th>
      <th>Sen_Slope</th>
      <th>Rate_of_Change (%)</th>
      <th>Type</th>
      <th>P_Value</th>
      <th>Corrected_P_Value</th>
      <th>Recommended_Trend</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cataluña</td>
      <td>1992</td>
      <td>2022</td>
      <td>-9.591</td>
      <td>-0.065</td>
      <td>Total</td>
      <td>-24.849171</td>
      <td>-24.849171</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cataluña</td>
      <td>1992</td>
      <td>1996</td>
      <td>-16.080</td>
      <td>-0.105</td>
      <td>Segmented</td>
      <td>-31.716522</td>
      <td>-31.716522</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cataluña</td>
      <td>1996</td>
      <td>2022</td>
      <td>-3.427</td>
      <td>-0.023</td>
      <td>Segmented</td>
      <td>-8.859400</td>
      <td>-8.859400</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Comunitat Valenciana</td>
      <td>1992</td>
      <td>2022</td>
      <td>5.448</td>
      <td>0.066</td>
      <td>Total</td>
      <td>-1.848921</td>
      <td>-1.848921</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Comunitat Valenciana</td>
      <td>1992</td>
      <td>1996</td>
      <td>-74.548</td>
      <td>-0.893</td>
      <td>Segmented</td>
      <td>-251.955888</td>
      <td>-251.955888</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Comunitat Valenciana</td>
      <td>1996</td>
      <td>2011</td>
      <td>20.747</td>
      <td>0.255</td>
      <td>Segmented</td>
      <td>9.675655</td>
      <td>9.675655</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Comunitat Valenciana</td>
      <td>2011</td>
      <td>2022</td>
      <td>14.063</td>
      <td>0.171</td>
      <td>Segmented</td>
      <td>9.950239</td>
      <td>9.950239</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Galicia</td>
      <td>1992</td>
      <td>2022</td>
      <td>-58.539</td>
      <td>-0.335</td>
      <td>Total</td>
      <td>-87.734035</td>
      <td>-87.734035</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Galicia</td>
      <td>1992</td>
      <td>1996</td>
      <td>-2.511</td>
      <td>-0.013</td>
      <td>Segmented</td>
      <td>-4.261990</td>
      <td>-4.261990</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Galicia</td>
      <td>1996</td>
      <td>2001</td>
      <td>-257.232</td>
      <td>-1.400</td>
      <td>Segmented</td>
      <td>-462.620868</td>
      <td>-462.620868</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Galicia</td>
      <td>2001</td>
      <td>2022</td>
      <td>-12.897</td>
      <td>-0.076</td>
      <td>Segmented</td>
      <td>-23.484554</td>
      <td>-23.484554</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Principado de Asturias</td>
      <td>1992</td>
      <td>2022</td>
      <td>-16.437</td>
      <td>-0.217</td>
      <td>Total</td>
      <td>-18.894854</td>
      <td>-18.894854</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Principado de Asturias</td>
      <td>1992</td>
      <td>1996</td>
      <td>-9.597</td>
      <td>-0.122</td>
      <td>Segmented</td>
      <td>-29.387804</td>
      <td>-29.387804</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Principado de Asturias</td>
      <td>1996</td>
      <td>2001</td>
      <td>-51.183</td>
      <td>-0.666</td>
      <td>Segmented</td>
      <td>-137.755837</td>
      <td>-137.755837</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Principado de Asturias</td>
      <td>2001</td>
      <td>2022</td>
      <td>-12.786</td>
      <td>-0.170</td>
      <td>Segmented</td>
      <td>-17.682364</td>
      <td>-17.682364</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Cantabria</td>
      <td>1992</td>
      <td>2022</td>
      <td>-18.113</td>
      <td>-0.630</td>
      <td>Total</td>
      <td>-27.489245</td>
      <td>-27.489245</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Cantabria</td>
      <td>1992</td>
      <td>1996</td>
      <td>-5.099</td>
      <td>-0.152</td>
      <td>Segmented</td>
      <td>-17.352445</td>
      <td>-17.352445</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Cantabria</td>
      <td>1996</td>
      <td>2001</td>
      <td>-97.287</td>
      <td>-3.099</td>
      <td>Segmented</td>
      <td>-178.428506</td>
      <td>-178.428506</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Cantabria</td>
      <td>2001</td>
      <td>2022</td>
      <td>-3.410</td>
      <td>-0.125</td>
      <td>Segmented</td>
      <td>-6.472652</td>
      <td>-6.472652</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>19</th>
      <td>País Vasco</td>
      <td>1992</td>
      <td>2022</td>
      <td>-10.886</td>
      <td>-0.261</td>
      <td>Total</td>
      <td>-16.218223</td>
      <td>-16.218223</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>20</th>
      <td>País Vasco</td>
      <td>1992</td>
      <td>1996</td>
      <td>-10.186</td>
      <td>-0.228</td>
      <td>Segmented</td>
      <td>-30.187959</td>
      <td>-30.187959</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>21</th>
      <td>País Vasco</td>
      <td>1996</td>
      <td>2022</td>
      <td>-3.634</td>
      <td>-0.088</td>
      <td>Segmented</td>
      <td>-10.980311</td>
      <td>-10.980311</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Comunidad Foral de Navarra</td>
      <td>1992</td>
      <td>2022</td>
      <td>-4.189</td>
      <td>-0.105</td>
      <td>Total</td>
      <td>-15.517424</td>
      <td>-15.517424</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Comunidad Foral de Navarra</td>
      <td>1992</td>
      <td>1996</td>
      <td>-18.267</td>
      <td>-0.422</td>
      <td>Segmented</td>
      <td>-57.908127</td>
      <td>-57.908127</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Comunidad Foral de Navarra</td>
      <td>1996</td>
      <td>2022</td>
      <td>0.488</td>
      <td>0.012</td>
      <td>Segmented</td>
      <td>-3.534189</td>
      <td>-3.534189</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>25</th>
      <td>La Rioja</td>
      <td>1992</td>
      <td>2022</td>
      <td>-0.524</td>
      <td>-0.027</td>
      <td>Total</td>
      <td>-3.533634</td>
      <td>-3.533634</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>26</th>
      <td>La Rioja</td>
      <td>1992</td>
      <td>1996</td>
      <td>-1.809</td>
      <td>-0.089</td>
      <td>Segmented</td>
      <td>-4.730234</td>
      <td>-4.730234</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>27</th>
      <td>La Rioja</td>
      <td>1996</td>
      <td>2022</td>
      <td>0.196</td>
      <td>0.010</td>
      <td>Segmented</td>
      <td>-0.397179</td>
      <td>-0.397179</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Aragón</td>
      <td>1992</td>
      <td>2022</td>
      <td>2.974</td>
      <td>0.021</td>
      <td>Total</td>
      <td>-12.429906</td>
      <td>-12.429906</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Aragón</td>
      <td>1992</td>
      <td>1996</td>
      <td>-60.688</td>
      <td>-0.417</td>
      <td>Segmented</td>
      <td>-190.802852</td>
      <td>-190.802852</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Aragón</td>
      <td>1996</td>
      <td>2022</td>
      <td>8.540</td>
      <td>0.061</td>
      <td>Segmented</td>
      <td>3.883854</td>
      <td>3.883854</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Comunidad de Madrid</td>
      <td>1992</td>
      <td>2022</td>
      <td>1.243</td>
      <td>0.056</td>
      <td>Total</td>
      <td>0.009148</td>
      <td>0.009148</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Comunidad de Madrid</td>
      <td>1992</td>
      <td>2016</td>
      <td>-0.336</td>
      <td>-0.015</td>
      <td>Segmented</td>
      <td>-1.176085</td>
      <td>-1.176085</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Comunidad de Madrid</td>
      <td>2016</td>
      <td>2022</td>
      <td>6.775</td>
      <td>0.301</td>
      <td>Segmented</td>
      <td>3.186480</td>
      <td>3.186480</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Castilla y León</td>
      <td>1992</td>
      <td>2022</td>
      <td>62.457</td>
      <td>0.244</td>
      <td>Total</td>
      <td>44.101753</td>
      <td>44.101753</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Castilla y León</td>
      <td>1992</td>
      <td>2016</td>
      <td>35.886</td>
      <td>0.142</td>
      <td>Segmented</td>
      <td>18.316178</td>
      <td>18.316178</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Castilla y León</td>
      <td>2016</td>
      <td>2022</td>
      <td>131.607</td>
      <td>0.497</td>
      <td>Segmented</td>
      <td>45.060662</td>
      <td>45.060662</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Castilla-La Mancha</td>
      <td>1992</td>
      <td>2022</td>
      <td>13.675</td>
      <td>0.062</td>
      <td>Total</td>
      <td>5.245844</td>
      <td>5.245844</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Castilla-La Mancha</td>
      <td>1992</td>
      <td>1996</td>
      <td>-43.353</td>
      <td>-0.195</td>
      <td>Segmented</td>
      <td>-140.431577</td>
      <td>-140.431577</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Castilla-La Mancha</td>
      <td>1996</td>
      <td>2022</td>
      <td>22.239</td>
      <td>0.100</td>
      <td>Segmented</td>
      <td>14.233227</td>
      <td>14.233227</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Extremadura</td>
      <td>1992</td>
      <td>2022</td>
      <td>27.076</td>
      <td>0.399</td>
      <td>Total</td>
      <td>24.348301</td>
      <td>24.348301</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Extremadura</td>
      <td>1992</td>
      <td>1996</td>
      <td>-11.930</td>
      <td>-0.185</td>
      <td>Segmented</td>
      <td>-27.159626</td>
      <td>-27.159626</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Extremadura</td>
      <td>1996</td>
      <td>2022</td>
      <td>28.753</td>
      <td>0.421</td>
      <td>Segmented</td>
      <td>25.000895</td>
      <td>25.000895</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Illes Balears</td>
      <td>1992</td>
      <td>2022</td>
      <td>5.467</td>
      <td>0.514</td>
      <td>Total</td>
      <td>4.350530</td>
      <td>4.350530</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Illes Balears</td>
      <td>1992</td>
      <td>1996</td>
      <td>3.759</td>
      <td>0.392</td>
      <td>Segmented</td>
      <td>-0.146922</td>
      <td>-0.146922</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Illes Balears</td>
      <td>1996</td>
      <td>2022</td>
      <td>4.530</td>
      <td>0.420</td>
      <td>Segmented</td>
      <td>3.638663</td>
      <td>3.638663</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Andalucía</td>
      <td>1992</td>
      <td>2022</td>
      <td>86.346</td>
      <td>0.423</td>
      <td>Total</td>
      <td>69.160400</td>
      <td>69.160400</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Andalucía</td>
      <td>1992</td>
      <td>1996</td>
      <td>-18.314</td>
      <td>-0.098</td>
      <td>Segmented</td>
      <td>-124.546170</td>
      <td>-124.546170</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Andalucía</td>
      <td>1996</td>
      <td>2022</td>
      <td>73.672</td>
      <td>0.356</td>
      <td>Segmented</td>
      <td>62.749458</td>
      <td>62.749458</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Región de Murcia</td>
      <td>1992</td>
      <td>2022</td>
      <td>11.139</td>
      <td>0.563</td>
      <td>Total</td>
      <td>9.385121</td>
      <td>9.385121</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Región de Murcia</td>
      <td>1992</td>
      <td>2001</td>
      <td>5.659</td>
      <td>0.308</td>
      <td>Segmented</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Región de Murcia</td>
      <td>2001</td>
      <td>2022</td>
      <td>6.831</td>
      <td>0.335</td>
      <td>Segmented</td>
      <td>4.525016</td>
      <td>4.525016</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Norte</td>
      <td>1992</td>
      <td>2022</td>
      <td>-30.974</td>
      <td>-0.284</td>
      <td>Total</td>
      <td>-40.801310</td>
      <td>-40.801310</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Norte</td>
      <td>1992</td>
      <td>2001</td>
      <td>-41.697</td>
      <td>-0.366</td>
      <td>Segmented</td>
      <td>-62.467018</td>
      <td>-62.467018</td>
      <td>Segmented</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Norte</td>
      <td>2001</td>
      <td>2022</td>
      <td>-4.268</td>
      <td>-0.040</td>
      <td>Segmented</td>
      <td>-12.234088</td>
      <td>-12.234088</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Algarve</td>
      <td>1992</td>
      <td>2022</td>
      <td>11.043</td>
      <td>0.540</td>
      <td>Total</td>
      <td>8.481125</td>
      <td>8.481125</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Algarve</td>
      <td>1992</td>
      <td>1996</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>Segmented</td>
      <td>-0.075834</td>
      <td>-0.075834</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Algarve</td>
      <td>1996</td>
      <td>2006</td>
      <td>24.933</td>
      <td>1.259</td>
      <td>Segmented</td>
      <td>9.487821</td>
      <td>9.487821</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Algarve</td>
      <td>2006</td>
      <td>2022</td>
      <td>3.784</td>
      <td>0.177</td>
      <td>Segmented</td>
      <td>1.412505</td>
      <td>1.412505</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Centro (PT)</td>
      <td>1992</td>
      <td>2022</td>
      <td>-23.570</td>
      <td>-0.157</td>
      <td>Total</td>
      <td>-28.304951</td>
      <td>-28.304951</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Centro (PT)</td>
      <td>1992</td>
      <td>2001</td>
      <td>-7.429</td>
      <td>-0.048</td>
      <td>Segmented</td>
      <td>-17.722804</td>
      <td>-17.722804</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Centro (PT)</td>
      <td>2001</td>
      <td>2022</td>
      <td>-10.967</td>
      <td>-0.074</td>
      <td>Segmented</td>
      <td>-19.335614</td>
      <td>-19.335614</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>1992</td>
      <td>2022</td>
      <td>1.503</td>
      <td>0.259</td>
      <td>Total</td>
      <td>1.313107</td>
      <td>1.313107</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>1992</td>
      <td>1996</td>
      <td>0.176</td>
      <td>0.032</td>
      <td>Segmented</td>
      <td>-0.670274</td>
      <td>-0.670274</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>1996</td>
      <td>2016</td>
      <td>1.032</td>
      <td>0.179</td>
      <td>Segmented</td>
      <td>0.637936</td>
      <td>0.637936</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Área Metropolitana de Lisboa</td>
      <td>2016</td>
      <td>2022</td>
      <td>3.279</td>
      <td>0.548</td>
      <td>Segmented</td>
      <td>2.086960</td>
      <td>2.086960</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Alentejo</td>
      <td>1992</td>
      <td>2022</td>
      <td>41.038</td>
      <td>0.493</td>
      <td>Total</td>
      <td>37.493162</td>
      <td>37.493162</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Alentejo</td>
      <td>1992</td>
      <td>1996</td>
      <td>-2.038</td>
      <td>-0.026</td>
      <td>Segmented</td>
      <td>-7.661352</td>
      <td>-7.661352</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Alentejo</td>
      <td>1996</td>
      <td>2016</td>
      <td>34.342</td>
      <td>0.416</td>
      <td>Segmented</td>
      <td>29.336373</td>
      <td>29.336373</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Alentejo</td>
      <td>2016</td>
      <td>2022</td>
      <td>65.577</td>
      <td>0.741</td>
      <td>Segmented</td>
      <td>53.884498</td>
      <td>53.884498</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="trend-analysis">
<h4>Trend Analysis<a class="headerlink" href="#trend-analysis" title="Link to this heading">#</a></h4>
<p>The results demonstrate that while breakpoints exist—whether driven by real environmental changes or influenced by sensor/methodological shifts—they do not necessarily require separate trend calculations. In most cases, the total trend provides a stable and reliable representation of forest evolution across the full dataset, reinforcing the idea that forest cover follows a largely continuous trajectory over time.</p>
<p>However, certain regions exhibit segmented trends that deviate significantly from the total trend. These cases merit special attention, as they may reflect actual shifts in forest dynamics due to land management, climate events, or localised disturbances. In some instances, breakpoints may correspond to sensor changes or classification inconsistencies rather than true environmental changes, emphasising the need for careful validation when interpreting deviations from the total trend.</p>
<p>Another key consideration is the geographical and ecological diversity of the Iberian Peninsula. Larger regions with varied landscapes may show more gradual changes in forest cover, making the total trend more representative. In contrast, smaller or ecologically distinct regions may experience more abrupt shifts that justify the use of segmented trends in specific cases.</p>
<p>While most segmented trends do not diverge enough to warrant replacing the total trend, some cases—such as Galicia (1996–2001)—stand out due to extreme rate changes. These cases could indicate significant localised environmental changes, policy interventions, or methodological anomalies that require attention when studying shorter time periods rather than overall long-term trends.</p>
<p>Ultimately, while breakpoints provide useful insights into short-term variations, they do not invalidate the overall trend. This analysis confirms that long-term forest trends in the Iberian Peninsula can be effectively assessed using the full dataset, with segmentation being relevant only when trends deviate sharply and are supported by contextual or statistical evidence.</p>
</section>
</section>
<section id="discussion">
<span id="satellite-satellite-land-cover-completeness-q03-code-section-5"></span><h3><strong>5. Discussion</strong><a class="headerlink" href="#discussion" title="Link to this heading">#</a></h3>
<p>The results of this analysis highlight the value of the dataset for monitoring forest dynamics in the Iberian Peninsula. The dataset proves robust for long-term trend detection, with methodological transitions and sensor shifts—while detectable—having limited impact on overarching patterns of forest change.</p>
<p>For applications in spatial planning and land management, this consistency is crucial. The ability to track forest evolution across decades allows regional planners and policymakers to evaluate the outcomes of afforestation policies, conservation efforts, and land abandonment. Even in the presence of minor reclassifications or local anomalies, the dataset supports confident assessments of broader land cover trends.</p>
<p>Nonetheless, the analysis also underscores the importance of methodological awareness. Breakpoints—particularly those associated with known sensor transitions (e.g., 1996, 2001, 2016)—can introduce artificial changes in the time series. These do not necessarily reflect ecological shifts but rather improvements in resolution, classification algorithms, or spectral capabilities. Users must remain cautious when interpreting abrupt changes without considering the underlying data lineage.</p>
<p>Geographic context further shapes interpretability. Larger, heterogeneous regions tend to smooth out classification noise, while smaller or fragmented areas may reflect sharper, localized breaks. This has direct implications for regional land management strategies, where scale and land use diversity influence the reliability of detected trends.</p>
<p>In practical terms, the dataset is well-suited for identifying general trends in forest cover, but users should:</p>
<ul class="simple">
<li><p>Complement statistical analysis with contextual information (e.g., known policy events, fire records),</p></li>
<li><p>Use segmentation carefully—reserving it for regions with strong evidence of structural change,</p></li>
<li><p>Remain cautious when interpreting data near known sensor transition years.</p></li>
</ul>
<p>In conclusion, the dataset provides a strong foundation for forest monitoring and planning. However, optimal use requires not just quantitative analysis, but also critical interpretation of when and why changes appear in the data. This fusion of methods and context is essential for informed decision-making in land and forest management.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key Resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The CDS catalogue entry for the data used was <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-land-cover?tab=overview">Land cover classification gridded maps from 1992 to present derived from satellite observations</a></p></li>
<li><p>Product User Guide and Specification of the dataset <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D5.3.1_PUGS_ICDR_LC_v2.1.x_PRODUCTS_v1.1.pdf">version 2.1</a> and <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-land-cover/D3.3.11-v1.0_PUGS_CDR_LC-CCI_v2.0.7cds_Products_v1.0.1_APPROVED_Ver1.pdf">version 2.0</a></p></li>
<li><p><a class="reference external" href="https://ec.europa.eu/eurostat/web/nuts">Eurostat NUTS</a> (Nomenclature of territorial units for statistics)</p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, c3s_eqc_automatic_quality_control, prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Forests,_forestry_and_logging">EUROSTAT: Forests, forestry and logging</a></p></li>
<li><p><a class="reference external" href="https://commission.europa.eu/document/cf3294e1-8358-4c93-8de4-3e1503b95201_en">New EU Forest Strategy for 2030</a></p></li>
<li><p><a class="reference external" href="https://api.semanticscholar.org/CorpusID:265869582">Mato, M.M., Legido, J.L., Miguez, E., Carballas, T., Jiménez, E., Caselles, V., &amp; Andrade, M.I. (2014). Analysis of burnt areas and number of forest fires in the Iberian Peninsula.</a></p></li>
<li><p><a class="reference external" href="https://api.semanticscholar.org/CorpusID:83540326">Silva, J., Vaz, P.G., Moreira, F., Catry, F.X., &amp; Rego, F.C. (2011). Wildfires as a major driver of landscape dynamics in three fire-prone areas of Portugal. <em>Landscape and Urban Planning, 101</em>, 349-358.</a></p></li>
<li><p><a class="reference external" href="https://nhess.copernicus.org/articles/12/3123/2012/">Gouveia, C.M., Bastos, A., Trigo, R.M., &amp; DaCamara, C.C. (2012). Drought impacts on vegetation in the pre- and post-fire events over Iberian Peninsula. <em>Natural Hazards and Earth System Sciences, 12</em>, 3123-3137.</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.foreco.2017.10.011">Vidal-Macua, J.J., Ninyerola, M., Zabala, A., Domingo‐Marimon, C., &amp; Pons, X. (2017). Factors affecting forest dynamics in the Iberian Peninsula from 1987 to 2012: the role of topography and drought. <em>Forest Ecology and Management, 406</em>, 290-306.</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.landusepol.2018.06.054">Sevillano, E.H., Contador, J.F., Schnabel, S., Pulido, M., &amp; Ibáñez, J.Q. (2018). Using spatial models of temporal tree dynamics to evaluate the implementation of EU afforestation policies in rangelands of SW Spain. <em>Land Use Policy.</em></a></p></li>
<li><p><a class="reference external" href="https://api.semanticscholar.org/CorpusID:238829360">Palmero-Iniesta, M., Espelta, J.M., Padial-Iglesias, M., González-Guerrero, Ó., Pesquer, L., Domingo‐Marimon, C., Ninyerola, M., Pons, X., &amp; Pino, J. (2021). The Role of Recent (1985–2014) Patterns of Land Abandonment and Environmental Factors in the Establishment and Growth of Secondary Forests in the Iberian Peninsula. <em>Land.</em></a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.landurbplan.2011.03.001">Silva, J., Vaz, P.G., Moreira, F., Catry, F.X., &amp; Rego, F.C. (2011). Wildfires as a major driver of landscape dynamics in three fire-prone areas of Portugal. <em>Landscape and Urban Planning, 101</em>, 349-358.</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.1016/j.jag.2014.11.010">Regos, A., Ninyerola, M., Moré, G., &amp; Pons, X. (2015). Linking land cover dynamics with driving forces in mountain landscapes of the Northwestern Iberian Peninsula. <em>Int. J. Appl. Earth Obs. Geoinformation, 38</em>, 1-14.</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.3390/rs16203822">Toté, C., Swinnen, E., &amp; Henocq, C. (2024). An Evaluation of Sentinel-3 SYN VGT Products in Comparison to the SPOT/VEGETATION and PROBA-V Archives. Remote Sensing, 16(20), 3822. https://doi.org/10.3390/rs16203822 </a></p></li>
<li><p><a class="reference external" href="https://www.mdpi.com/2072-4292/15/9/2285">Zhao, T., Zhang, X., Gao, Y., Mi, J., Liu, W., Wang, J., Jiang, M., &amp; Liu, L. (2023). Assessing the Accuracy and Consistency of Six Fine-Resolution Global Land Cover Products Using a Novel Stratified Random Sampling Validation Dataset. Remote Sensing, 15(9)</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Biosphere"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Biosphere.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.4. </span>Land Biosphere</p>
      </div>
    </a>
    <a class="right-next"
       href="../Land_Hydrology/Land_Hydrology.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-land-cover-products-to-quantify-afforestation-deforestation-trends">🌍 Use case: Using land cover products to quantify afforestation/deforestation trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-lc-data"><strong>1. Define the AoI, search and download LC data</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#install-cds-api">Install CDS API</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data-for-the-defined-aoi-iberian-peninsula"><strong>2. Inspect and view data for the defined AoI (Iberian Peninsula)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-land-cover-classes-area-coverage-for-each-nuts-2-region">Compute Land Cover classes area coverage for each NUTS 2 region</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mask-regions">Mask regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cell-area">Compute cell area</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#select-forest-classes-and-prepare-dataset">Select Forest Classes and Prepare Dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-forest-area-per-region-and-year">Compute forest area per region and year</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-forest-percentage-coverage-over-time-by-nuts-regions-in-the-aoi">Map forest percentage coverage over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-forest-percentage-coverage-change-over-time-by-nuts-regions-in-the-aoi">Map forest percentage coverage change over-time by NUTS regions in the AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-analysis">Map Analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-drivers-and-methodological-considerations-in-afforestation-deforestation-trends-in-the-iberian-peninsula-19922022"><strong>Potential Drivers and Methodological Considerations in Afforestation/Deforestation Trends in the Iberian Peninsula (1992–2022)</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-detection"><strong>3. Breakpoint Detection</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#breakpoint-analysis">Breakpoint Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-assessment"><strong>4. Trend Assessment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trend-analysis">Trend Analysis</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion"><strong>5. Discussion</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>