
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Reanalysis comparison with observations for agriculture and hydrology applications &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-era5-single-levels_extremes-detection_q01';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Reanalysis comparison with observations for agriculture and hydrology applications</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-era5-single-levels_extremes-detection_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-era5-single-levels_extremes-detection_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reanalysis comparison with observations for agriculture and hydrology applications</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-the-extremes-of-soil-moisture-deficit-in-europe-in-support-of-agriculture">üåç Use case: Investigating the extremes of soil moisture deficit in Europe in support of agriculture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">üì¢ Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-drier-than-normal-conditions">1. Detecting drier-than-normal conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries">Timeseries</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-metrics-and-comparing-datasets">2. Computing metrics and comparing datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude">Magnitude</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#severity">Severity</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="reanalysis-comparison-with-observations-for-agriculture-and-hydrology-applications">
<h1><span class="section-number">3.1. </span>Reanalysis comparison with observations for agriculture and hydrology applications<a class="headerlink" href="#reanalysis-comparison-with-observations-for-agriculture-and-hydrology-applications" title="Link to this heading">#</a></h1>
<p>Production date: 23-04-2025</p>
<p>Produced by: CNR-ISMAR</p>
<section id="use-case-investigating-the-extremes-of-soil-moisture-deficit-in-europe-in-support-of-agriculture">
<h2>üåç Use case: Investigating the extremes of soil moisture deficit in Europe in support of agriculture<a class="headerlink" href="#use-case-investigating-the-extremes-of-soil-moisture-deficit-in-europe-in-support-of-agriculture" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How accurate are drought indicators derived from modern global reanalysis?</strong></p></li>
</ul>
<p>By comparing model outputs with independent observational datasets, discrepancies between modelled and observed values can be identified and quantified. In this assessment, we assess the accuracy of detecting the 2022 European drought conditions using the Soil Moisture Anomaly indicator. This indicator is derived from ERA5, the most recent atmospheric reanalysis produced by the European Centre for Medium-Range Weather Forecasts (ECMWF), and is compared with the same indicator computed from satellite observations provided by the European Space Agency‚Äôs Climate Change Initiative (ESA CCI). Relevant literature is also referenced to support the analysis.</p>
<p>By design, reanalysis datasets are free from missing data. One of the main advantages of using reanalysis is their provision of consistent, long-term global coverage, whereas observational datasets are often sparse or discontinuous in both space and time, particularly over extended periods. This is a crucial consideration when working with satellite-based datasets. Such data may be affected by retrieval failures or temporal discontinuities associated with instrument changes. In particular, remotely sensed soil moisture estimates can become unreliable under certain conditions, such as when the ground is frozen or obscured by dense vegetation. Additionally, quality flags are provided for barren land surfaces; while data are available for these areas, their inclusion depends on the specific requirements of the intended application.</p>
</section>
<section id="quality-assessment-statements">
<h2>üì¢ Quality assessment statements<a class="headerlink" href="#quality-assessment-statements" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul>
<li><p>The comparison between reanalysis data (ERA5) and satellite observations (ESA CCI COMBINED) allows for the quantification of discrepancies in the representation of drought conditions, such as the 2022 European event;</p></li>
<li><p>In 2022, ERA5 and ESA CCI exhibit overall consistency in terms of drought magnitude and severity, although ERA5 tends to slightly overestimate the affected area;</p></li>
<li><p>ERA5 is well-suited for deriving meteorological drought indices (e.g., Standardised Precipitation Index (SPI), Standardised Precipitation and Evapotranspiration Index (SPEI</p>
<p>)) due to its accuracy in atmospheric variables;</p>
</li>
<li><p>For applications requiring higher spatial resolution and improved soil representation (e.g., agriculture), ERA5-Land is preferable to ERA5;</p></li>
<li><p>ESA CCI COMBINED remains the most reliable satellite-derived soil moisture dataset currently available, but it should be used with caution for periods prior to 2000.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The ESA CCI Soil Moisture COMBINED dataset integrates observations from both active and passive microwave sensors to provide consistent global estimates of surface soil moisture. Prior to July 1991, the dataset relies exclusively on passive sensors, resulting in more limited spatial and temporal coverage and greater uncertainty, particularly in regions affected by persistent cloud cover or dense vegetation. From 1991 onwards, the inclusion of active sensors has enhanced both spatio-temporal coverage and the reliability of the observations by combining data from different sensor types. Since 2000, the availability of multiple concurrent active and passive sensors has further improved data quality and completeness <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-soil-moisture?tab=documentation">[1]</a>. Nevertheless, despite improved consistency in recent product versions, residual sources of uncertainty persist due to the multiple merging steps in the ESA CCI processing chain, changes in the composition of the sensor constellation across product versions, and intrinsic differences between the active and passive input products that are propagated into the COMBINED dataset <a class="reference external" href="https://doi.org/10.5281/zenodo.8320930">[2]</a>.</p>
<p>Here we focus on the period 2000-2022 and the European domain bounded by 30¬∞N‚Äì58¬∞N latitude and 10¬∞W‚Äì36¬∞E longitude. Surface soil moisture data from both the ESA CCI COMBINED dataset and ERA5 reanalysis are retrieved in volumetric moisture content units (i.e. m<span class="math notranslate nohighlight">\(^3\)</span> m<span class="math notranslate nohighlight">\(^{-3}\)</span>). According to the World Meteorological Organization (WMO), 2016 <a class="reference external" href="https://unfccc.int/sites/default/files/gcos_ip_10oct2016.pdf">[3]</a>, the surface layer is generally defined as the top 0‚Äì5 cm of soil. For satellite products, this corresponds to an approximate depth of 2‚Äì5 cm, whereas reanalysis products typically represent the 0‚Äì7 cm soil layer.</p>
<p>The primary aim of this analysis is to evaluate the performance of the two datasets in capturing drought-related extreme events across Europe. This question is of growing relevance in the context of climate change and ongoing global warming (IPCC AR6 <a class="reference external" href="https://www.ipcc.ch/assessment-report/ar6/">[4]</a>). Following the WMO Guide <a class="reference external" href="https://community.wmo.int/en/guide-instruments-and-methods-observation-wmo-no-8">[5]</a>, extreme weather and climate events can be described using the following quantitative components:</p>
<ul class="simple">
<li><p>an index quantifying the anomaly from baseline or normal conditions (based on observations),</p></li>
<li><p>threshold(s) used to categorise the event (e.g. moderate or severe drought),</p></li>
<li><p>temporal information (including start date, end date, and duration),</p></li>
<li><p>spatial information (geographical extent of the affected area).</p></li>
</ul>
<p>In this assessment, the selected index is the Soil Moisture Anomaly (SMA), computed from both reanalysis and satellite-derived soil moisture. SMA is a standardised anomaly metric, designed to minimise discrepancies arising from differing assumptions in land surface models ‚Äî such as soil layer depths ‚Äî and from variations in underlying soil property datasets. This standardisation enables the production of comparable temporal anomalies across datasets (see e.g. <a class="reference external" href="https://doi.org/10.5194/hess-17-1765-2013">[6]</a>):</p>
<div class="math notranslate nohighlight">
\[
SMA_{y,d} = \frac{SM_{y,d} - \mu_{d}}{\sigma_{d}}
\]</div>
<p>Where <span class="math notranslate nohighlight">\(SM_{y,d}\)</span> denotes soil moisture at any year <span class="math notranslate nohighlight">\(y\)</span> and day <span class="math notranslate nohighlight">\(d\)</span>, while <span class="math notranslate nohighlight">\(\mu_{d}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{d}\)</span> denote the respective climatological mean and interannual standard deviation of soil moisture of day <span class="math notranslate nohighlight">\(d\)</span> calculated over the reference period.
A threshold value of ‚àí1.5 is adopted, whereby any SMA falling below this value is classified as an abnormal dryness condition. This threshold is informed by the classification scheme used in the Standardised Precipitation Index (SPI), in which values below ‚àí1.5 typically indicate severe to extreme drought conditions <a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_soilmoisture.pdf">[7]</a> <a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf">[8]</a>.</p>
<p>Results are shown for:</p>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-single-levels-extremes-detection-q01-reanalysis-era5-single-levels-validation-extremes-q01-section-1"><span class="std std-ref">1. Detecting drier-than-normal conditions</span></a></strong></p>
<ul class="simple">
<li><p>Timeseries</p></li>
</ul>
<p><strong><a class="reference internal" href="#reanalysis-reanalysis-era5-single-levels-extremes-detection-q01-reanalysis-era5-single-levels-validation-extremes-q01-section-2"><span class="std std-ref">2. Computing metrics and comparing datasets</span></a></strong></p>
<ul class="simple">
<li><p>Magnitude</p></li>
<li><p>Severity</p></li>
<li><p>Discussion</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<p>Pre-processing of the data is required to enable a meaningful comparison between datasets. Firstly, the surface soil moisture values provided by the reanalysis must be averaged to a daily temporal resolution, as they are originally available at hourly intervals. Furthermore, since the calculation of climatology and standard deviation is required, linear interpolation over time, combined with the application of a rolling mean, can be employed to fill data gaps and reduce high-frequency variability in the daily time series <a class="reference external" href="https://etrp.wmo.int/pluginfile.php/17441/mod_resource/content/0/49_I-2015-2017_en.pdf">[9]</a>. To compute biases between datasets, a first-order conservative remapping approach is used to regrid all products to a common spatial resolution of 0.25¬∞ √ó 0.25¬∞.</p>
<p><strong>Import libraries</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.gridliner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gridliner</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Set parameters</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2000-01&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="s2">&quot;2022-12&quot;</span>
<span class="n">index_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2022-06-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2022-09-30&quot;</span><span class="p">)</span>

<span class="c1"># Max value allowed</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>

<span class="c1"># Space</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Define requests</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">requests</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ERA5&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;derived-era5-single-levels-daily-statistics&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;volumetric_soil_water_layer_1&quot;</span><span class="p">,</span> <span class="s2">&quot;land_sea_mask&quot;</span><span class="p">],</span>
            <span class="s2">&quot;daily_statistic&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_mean&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time_zone&quot;</span><span class="p">:</span> <span class="s2">&quot;utc+00:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="s2">&quot;1_hourly&quot;</span><span class="p">,</span>
            <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">),</span>
    <span class="s2">&quot;ESA CCI COM&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;satellite-soil-moisture&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;volumetric_surface_soil_moisture&quot;</span><span class="p">],</span>
            <span class="s2">&quot;type_of_sensor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;combined_passive_and_active&quot;</span><span class="p">],</span>
            <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;day_average&quot;</span><span class="p">],</span>
            <span class="s2">&quot;type_of_record&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cdr&quot;</span><span class="p">],</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v202312&quot;</span><span class="p">],</span>
        <span class="p">},</span>
    <span class="p">),</span>
<span class="p">}</span>
<span class="n">target_grid_request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;reanalysis&quot;</span><span class="p">],</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;land_sea_mask&quot;</span><span class="p">],</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1940&quot;</span><span class="p">],</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">],</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">],</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
        <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;unarchived&quot;</span><span class="p">,</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Define functions to cache</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">interpolate_na</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_anomaly_drought_index</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">target_grid_request</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span><span class="p">):</span>
    <span class="c1"># Get raw data</span>
    <span class="p">(</span><span class="n">var_name</span><span class="p">,)</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s2">&quot;sm&quot;</span><span class="p">,</span> <span class="s2">&quot;swvl1&quot;</span><span class="p">}</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>

    <span class="c1"># Mask</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lsm</span> <span class="o">:=</span> <span class="n">ds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;lsm&quot;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">lsm</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>

    <span class="c1"># Interpolate</span>
    <span class="k">if</span> <span class="n">target_grid_request</span><span class="p">:</span>
        <span class="n">grid_out</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="o">*</span><span class="n">target_grid_request</span><span class="p">,</span> <span class="n">invalidate_cache</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">grid_out</span> <span class="o">=</span> <span class="n">grid_out</span><span class="p">[[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]]</span>
        <span class="n">grid_out</span> <span class="o">=</span> <span class="n">grid_out</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">dims</span><span class="p">))</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">xesmf_kwargs</span>

    <span class="c1"># Get time-varying index</span>
    <span class="n">group_dim</span> <span class="o">=</span> <span class="s2">&quot;time.dayofyear&quot;</span>
    <span class="n">smooth_data_grouped</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_dim</span><span class="p">)</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_dim</span><span class="p">)</span> <span class="o">-</span> <span class="n">smooth_data_grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">group_dim</span><span class="p">)</span> <span class="o">/</span> <span class="n">smooth_data_grouped</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">sma</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sma</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="n">sma</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Anomaly drought index&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">sma</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;sma&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_severity</span><span class="p">(</span><span class="n">sma</span><span class="p">):</span>
    <span class="n">severity</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">severity</span> <span class="o">=</span> <span class="n">severity</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">severity</span><span class="p">)</span>
    <span class="n">severity</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Severity&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">severity</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_area</span><span class="p">(</span><span class="n">sma</span><span class="p">):</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
    <span class="n">resolutions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">sma</span><span class="p">[</span><span class="n">coord</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="p">(</span><span class="n">resolution</span><span class="p">,)</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
        <span class="n">resolutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resolution</span> <span class="o">*</span> <span class="mi">111</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">sma</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])))</span>
    <span class="n">area</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">resolutions</span><span class="p">)))</span> <span class="o">*</span> <span class="n">weights</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">area</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sma</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">area</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km2&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">area</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;area&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_mean_and_area</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">target_grid_request</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span><span class="p">):</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">compute_anomaly_drought_index</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">target_grid_request</span><span class="o">=</span><span class="n">target_grid_request</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span>
    <span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">sma</span><span class="p">)</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">compute_area</span><span class="p">(</span><span class="n">sma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">mean</span><span class="p">,</span> <span class="n">area</span><span class="p">])</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_maps</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">index_slice</span><span class="p">,</span> <span class="n">target_grid_request</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span><span class="p">):</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">compute_anomaly_drought_index</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">target_grid_request</span><span class="p">,</span> <span class="o">**</span><span class="n">xesmf_kwargs</span>
    <span class="p">)</span>
    <span class="n">sma</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">index_slice</span><span class="p">)</span>
    <span class="n">severity</span> <span class="o">=</span> <span class="n">compute_severity</span><span class="p">(</span><span class="n">sma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">sma</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">severity</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Download and transform</strong></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets_maps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">datasets_timeseries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span> <span class="ow">in</span> <span class="n">requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">product</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="n">threshold</span><span class="p">,</span> <span class="s2">&quot;target_grid_request&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">collection_id</span> <span class="o">==</span> <span class="s2">&quot;satellite-soil-moisture&quot;</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;target_grid_request&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_grid_request</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;conservative&quot;</span>

    <span class="c1"># Map</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_maps</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;index_slice&quot;</span><span class="p">:</span> <span class="n">index_slice</span><span class="p">},</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets_maps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">]))</span>

    <span class="c1"># Timeseries</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">request</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_mean_and_area</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">datasets_timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="n">product</span><span class="p">]))</span>

<span class="n">ds_maps</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">combine_by_coords</span><span class="p">(</span><span class="n">datasets_maps</span><span class="p">)</span>
<span class="n">ds_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">combine_by_coords</span><span class="p">(</span><span class="n">datasets_timeseries</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>product = &#39;ERA5&#39;
product = &#39;ESA CCI COM&#39;
</pre></div>
</div>
</div>
</div>
<section id="detecting-drier-than-normal-conditions">
<span id="reanalysis-reanalysis-era5-single-levels-extremes-detection-q01-reanalysis-era5-single-levels-validation-extremes-q01-section-1"></span><h3>1. Detecting drier-than-normal conditions<a class="headerlink" href="#detecting-drier-than-normal-conditions" title="Link to this heading">#</a></h3>
<section id="timeseries">
<h4>Timeseries<a class="headerlink" href="#timeseries" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_timeseries_summer</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">ds_timeseries</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">if</span> <span class="s2">&quot;area&quot;</span> <span class="ow">in</span> <span class="n">ds_timeseries_summer</span><span class="p">:</span>
    <span class="n">ds_timeseries_summer</span><span class="p">[</span><span class="s2">&quot;area&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2022</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2023</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/587b0d9a8c7e9524a2d27da39a823c6fa2e658c8fc3cbce004f46ff2acc02afb.png" src="../_images/587b0d9a8c7e9524a2d27da39a823c6fa2e658c8fc3cbce004f46ff2acc02afb.png" />
</div>
</div>
<p><em>Spatial extent of standardised surface soil moisture anomalies below ‚àí1.5, expressed in square kilometres (km¬≤), for the years 2000 to 2022 across the European domain bounded by 30¬∞N‚Äì58¬∞N latitude and 10¬∞W‚Äì36¬∞E longitude.</em></p>
<p>The time series illustrates, for each year, the total area (in km¬≤) affected by anomalously dry conditions. Years characterised by the largest spatial extent ‚Äî such as 2003, 2015, and 2022 ‚Äî can be clearly identified. These events are well-documented in the scientific literature <a class="reference external" href="https://doi.org/10.1038/nature03972">[10]</a> <a class="reference external" href="https://doi.org/10.1175/BAMS-D-16-0140.1">[11]</a> <a class="reference external" href="https://doi.org/10.1088/1748-9326/acbc37">[12]</a>. Differences between the two datasets are also apparent, particularly prior to 2010.
Several factors may explain these discrepancies. Satellite data coverage and quality have improved considerably over time <a class="reference external" href="https://doi.org/10.1016/j.rse.2014.07.023">[13]</a> <a class="reference external" href="https://doi.org/10.5281/zenodo.8320930">[2]</a>, and it should be also noted that the reanalysis assimilates only a subset of the observations provided by ESA/EUMETSAT active sensors <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation">[14]</a>.
Section 2 presents results for the June-September 2022 drought in western‚Äìcentral Europe as a case study, with reference to the outcomes reported in Hirschi et al. (2025) <a class="reference external" href="https://doi.org/10.5194/hess-29-397-2025">[15]</a>.</p>
</section>
</section>
<section id="computing-metrics-and-comparing-datasets">
<span id="reanalysis-reanalysis-era5-single-levels-extremes-detection-q01-reanalysis-era5-single-levels-validation-extremes-q01-section-2"></span><h3>2. Computing metrics and comparing datasets<a class="headerlink" href="#computing-metrics-and-comparing-datasets" title="Link to this heading">#</a></h3>
<p>Various metrics may be employed to characterise the drought event. Here, we focus on magnitude and severity, which are respectively defined as the minimum standardised anomaly over time, and the time-accumulated standardised anomalies on days (both consecutive and non-consecutive) when the anomaly falls below the defined threshold. These metrics are computed at the grid-point scale.</p>
<p>As previously discussed, satellite data alone are not sufficient to validate the reanalysis. Therefore, in the following analysis, we limit ourselves to examining the relative behaviour of the two datasets, which will be further discussed in the final section.</p>
<section id="magnitude">
<h4>Magnitude<a class="headerlink" href="#magnitude" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">edit_gridliners</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">gridliners</span> <span class="o">=</span> <span class="p">[</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">artists</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">Gridliner</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">gl</span> <span class="ow">in</span> <span class="n">gridliners</span><span class="p">:</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">bottom_labels</span> <span class="o">=</span> <span class="kc">False</span>
        
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;sma&quot;</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds_maps</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#fe0000&quot;</span><span class="p">,</span> <span class="s2">&quot;#fc7f01&quot;</span><span class="p">,</span> <span class="s2">&quot;#ff9f00&quot;</span><span class="p">,</span> <span class="s2">&quot;#febd01&quot;</span><span class="p">,</span> <span class="s2">&quot;#fee819&quot;</span><span class="p">,</span> <span class="s2">&quot;#e4ff7a&quot;</span><span class="p">]</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Magnitude [1]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>    
    <span class="n">edit_gridliners</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/25c7d82fc29cc76b589bc07cab0f2d7c3ed16d458524ab44b7f40d2bdf27bfff.png" src="../_images/25c7d82fc29cc76b589bc07cab0f2d7c3ed16d458524ab44b7f40d2bdf27bfff.png" />
</div>
</div>
<p><em>Magnitude of the 2022 European drought event (expressed in units of standard deviation) based on the temporal minimum of the standardised
soil moisture anomalies in the surface layers. White areas feature values larger than -1.5.</em></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bias of &quot;</span> <span class="o">+</span> <span class="n">bias</span><span class="o">.</span><span class="n">long_name</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">bias</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Magnitude Error [1]&quot;</span><span class="p">)</span> 
<span class="n">edit_gridliners</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/2ab5ca87f7fb91fb847ba8be360e911d2f253ec5dd8a343974100423c95ab057.png" src="../_images/2ab5ca87f7fb91fb847ba8be360e911d2f253ec5dd8a343974100423c95ab057.png" />
</div>
</div>
<p><em>Bias in the ERA5 magnitude of the 2022 European drought event (expressed in units of standard deviation) relative to the ESA CCI COMBINED product in the surface soil layers. Positive values mean an underestimation by ERA5.</em></p>
</section>
<section id="severity">
<h4>Severity<a class="headerlink" href="#severity" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;severity&quot;</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">ds_maps</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#fe0000&quot;</span><span class="p">,</span> <span class="s2">&quot;#fc7f01&quot;</span><span class="p">,</span> <span class="s2">&quot;#ff9f00&quot;</span><span class="p">,</span> <span class="s2">&quot;#febd01&quot;</span><span class="p">,</span> <span class="s2">&quot;#fee819&quot;</span><span class="p">,</span> <span class="s2">&quot;#e4ff7a&quot;</span><span class="p">]</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Severity [1]&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">edit_gridliners</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/3ea024d03a8c933e21fcd79332e07dbf6be377661705b6bd578e8a5a2c4b9148.png" src="../_images/3ea024d03a8c933e21fcd79332e07dbf6be377661705b6bd578e8a5a2c4b9148.png" />
</div>
</div>
<p><em>Severity of the 2022 European drought event (expressed in units of standard deviation) based on the time-accumulated soil moisture anomalies
in the surface layers. White areas feature values larger than -1.5.</em></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">bias</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Bias of &quot;</span> <span class="o">+</span> <span class="n">da</span><span class="o">.</span><span class="n">long_name</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">bias</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Severity Error [1]&quot;</span><span class="p">)</span> 
<span class="n">edit_gridliners</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">requests</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/c3ff3326fa2feb82bf57a4e41204843bccfd5e42014cd01a2366ab287664b19f.png" src="../_images/c3ff3326fa2feb82bf57a4e41204843bccfd5e42014cd01a2366ab287664b19f.png" />
</div>
</div>
<p><em>Bias in the ERA5 severity of the 2022 European drought event (expressed in units of standard deviation) relative to the ESA CCI COMBINED product in the surface soil layers. Positive values mean an underestimation by ERA5.</em></p>
</section>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p>The magnitude of the drought event occurring between 1 June and 30 September 2022 in Europe, as estimated from reanalysis data, is comparable to that derived from satellite observations. The spatial extent of the areas showing values lower than -2 is substantially consistent between the two datasets, in line with the spatial extent time series showing very close affected areas for 2022, with a slight overestimation observed in the reanalysis. Nevertheless, the event appears more severe in the ESA CCI COMBINED dataset. Both findings are consistent with those presented in Figures 4 and 5 of <a class="reference external" href="https://doi.org/10.5194/hess-29-397-2025">[15]</a>.</p>
<p>It should be noted that satellite-based soil moisture data are affected by several limitations, even over short periods, due to assumptions made in the retrieval algorithm ‚Äî particularly the assumption that certain parameters remain stationary over time. These may not reflect changes in soil properties. One illustrative example includes abrupt changes in land cover, such as deforestation or urban expansion <a class="reference external" href="https://doi.org/10.5194/egusphere-egu23-16205">[16]</a>. Another issue relates for example to the vegetation correction applied to ASCAT-based soil moisture records, which is parameterised seasonally and thus does not account for interannual variability in vegetation <a class="reference external" href="https://doi.org/10.1109/Tgrs.2016.2519842">[17]</a>.</p>
<p>Similarly, limitations are also present in the land-surface models underpinning reanalysis products. It has been shown that precipitation and temperature, both of which influence evapotranspiration, are better represented in ERA5 than in other state-of-the-art reanalyses, such as MERRA-2, which does not assimilate near-surface air temperature at 2 metres <a class="reference external" href="https://doi.org/10.1002/qj.2949">[18]</a>. This makes ERA5 a suitable dataset for deriving drought indices based directly on meteorological variables, such as the widely used Standardised Precipitation Index (SPI) and the Standardised Precipitation and Evapotranspiration Index (SPEI) <a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1">[19]</a> <a class="reference external" href="https://doi.org/10.1038/s41598-024-69691-y">[20]</a>.</p>
<p>At the same time, ERA5-Land has demonstrated significant improvements over ERA5 when compared against a broad set of soil moisture observational data. Although both reanalyses use the same land-surface model (HTESSEL), ERA5-Land provides higher spatial resolution and, despite not assimilating remote-sensing soil moisture or other land variables, benefits from more homogeneous soil parameterisation <a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021">[21]</a> <a class="reference external" href="https://doi.org/10.1002/qj.3803">[22]</a>.</p>
<p>In conclusion, various studies have validated the ESA CCI COMBINED dataset against in situ observations, demonstrating that the COMBINED product outperforms the individual ESA CCI ACTIVE and PASSIVE datasets <a class="reference external" href="https://doi.org/10.5194/essd-11-717-2019">[23]</a> <a class="reference external" href="https://doi.org/10.5194/hess-25-17-2021">[24]</a>. Nevertheless, satellite-derived data may still be affected by data gaps, either due to limitations in remote sensing capabilities or due to the limited number of contributing sensors over time. ERA5 offers a reliable, global, and long-term representation of soil moisture; however, for applications that require high-resolution and highly accurate land surface data ‚Äî such as those in agriculture ‚Äî ERA5-Land may be the preferred choice.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://drought.emergency.copernicus.eu/">Drought Observatories of the Copernicus Emergency Management Service</a></p>
<p><a class="reference external" href="https://xds-preprod.ecmwf.int/datasets/derived-drought-historical-monthly?tab=overview">Monthly drought indices from 1940 to present derived from ERA5 reanalysis</a></p>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further readings were linked throughout this assessment.</p>
<p><a id='The_CDS_catalogue_entries_for_the_data_used_were:'></a>
The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>ERA5 hourly data on single levels from 1940 to present: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview">https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview</a></p></li>
<li><p>Soil moisture gridded data from 1978 to present: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-soil-moisture?tab=overview">https://cds.climate.copernicus.eu/datasets/satellite-soil-moisture?tab=overview</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-soil-moisture?tab=documentation">[1]</a> ESA CCI Soil Moisture Documentation</p>
<p><a class="reference external" href="https://doi.org/10.5281/zenodo.8320930">[2]</a> ESA Climate Change Initiative Plus - Soil Moisture Product Validation and Intercomparison Report (PVIR) Supporting Product version v08.1</p>
<p><a class="reference external" href="https://unfccc.int/sites/default/files/gcos_ip_10oct2016.pdf">[3]</a> The Global Observing System for Climate: Implementation Needs</p>
<p><a class="reference external" href="https://www.ipcc.ch/assessment-report/ar6/">[4]</a> IPCC Sixth Assessment Report</p>
<p><a class="reference external" href="https://community.wmo.int/en/guide-instruments-and-methods-observation-wmo-no-8">[5]</a> Guide to Instruments and Methods of Observation (WMO-No. 8)</p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-17-1765-2013">[6]</a> Orlowsky, B. and Seneviratne, S. I.: Elusive drought: uncertainty in observed trends and short- and long-term CMIP5 projections, Hydrol. Earth Syst. Sci., 17, 1765‚Äì1781, 2013</p>
<p><a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_soilmoisture.pdf">[7]</a> European Drought Observatory Soil Moisture Anomaly Factsheet</p>
<p><a class="reference external" href="https://climate.colostate.edu/pdfs/relationshipofdroughtfrequency.pdf">[8]</a> McKee, T. B., Doesken, N. J., and Kleist, J.: The relationship of
drought frequency and duration to time scales, in: Eighth Conference on Applied Climatology, 17‚Äì22 January 1993, Anaheim, California, USA, 179‚Äì184,1993</p>
<p><a class="reference external" href="https://etrp.wmo.int/pluginfile.php/17441/mod_resource/content/0/49_I-2015-2017_en.pdf">[9]</a> Volume I ‚Äì General Meteorological Standards and
Recommended Practices (WMO-No. 49)</p>
<p><a class="reference external" href="https://doi.org/10.1038/nature03972">[10]</a> Ciais, P., Reichstein, M., Viovy, N. et al. Europe-wide reduction in primary productivity caused by the heat and drought in 2003. Nature 437, 529‚Äì533 (2005)</p>
<p><a class="reference external" href="https://doi.org/10.1175/BAMS-D-16-0140.1">[11]</a> Dong, B., Sutton, R., Shaffrey, L., and Wilcox, L.: The 2015 European heat wave in ‚ÄúExplaining Extreme Events of 2015 from a Climate Perspective‚Äù, Bulletin of the American Meteorological Society, 97, S57-S62, 2016</p>
<p><a class="reference external" href="https://doi.org/10.1088/1748-9326/acbc37">[12]</a> Faranda, D., Pascale, S., &amp; Bulut, B. (2023). Persistent anticyclonic conditions and climate change exacerbated the exceptional 2022 European-Mediterranean drought. Environmental Research Letters, 18, 034030</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.rse.2014.07.023">[13]</a> Dorigo, W. A., Gruber, A., De Jeu, R. A. M., Wagner, W., Stacke, T., Loew, A., Albergel, C., Brocca, L., Chung, D., Parinussa, R. M., and Kidd, R.: Evaluation of the ESA CCI soil moisture product using ground-based observations, Remote Sens. Environ., 162, 380‚Äì395, 2015</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/display/CKB/ERA5%3A+data+documentation">[14]</a> ERA5: data documentation</p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-29-397-2025">[15]</a> Hirschi, M., Stradiotti, P., Crezee, B., Dorigo, W., and Seneviratne, S. I.: Potential of long-term satellite observations and reanalysis products for characterising soil drying: trends and drought events, Hydrol. Earth Syst. Sci., 29, 397‚Äì425, 2025</p>
<p><a class="reference external" href="https://doi.org/10.5194/egusphere-egu23-16205">[16]</a> Hahn, S., Wagner, W., Alves, O., Muguda Sanjeevamurthy, P., Vreugdenhil, M., and Melzer, T.: Metop ASCAT soil moisture trends: Mitigating the effects of long-term land cover changes, EGU General Assembly 2023, Vienna, Austria, 24‚Äì28 Apr 2023, EGU23-16205, 2023</p>
<p><a class="reference external" href="https://doi.org/10.1109/Tgrs.2016.2519842">[17]</a> Vreugdenhil, M., Dorigo, W. A., Wagner, W., de Jeu, R. A. M., Hahn, S., and van Marle, M. J. E.: Analyzing the Vegetation Parameterization in the TU-Wien ASCAT Soil Moisture Retrieval, IEEE T. Geosci. Remote, 54, 3513‚Äì3531, 2016</p>
<p><a class="reference external" href="https://doi.org/10.1002/qj.2949">[18]</a> Simmons, A. J., Berrisford, P., Dee, D. P., Hersbach, H., Hirahara, S., and Thepaut, J. N.: A reassessment of temperature variations and trends from global reanalyses and monthly surface climatological datasets, Q. J. Roy. Meteor. Soc., 143, 101‚Äì119, 2017</p>
<p><a class="reference external" href="https://doi.org/10.1175/2009JCLI2909.1">[19]</a> Vicente-Serrano, S. M., S. Beguer√≠a, and J. I. L√≥pez-Moreno, 2010: A Multiscalar Drought Index Sensitive to Global Warming: The Standardized Precipitation Evapotranspiration Index. J. Climate, 23, 1696‚Äì1718</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41598-024-69691-y">[20]</a> Santos, R., Russo, A. &amp; Gouveia, C.M. Co-occurrence of marine and atmospheric heatwaves with drought conditions and fire activity in the Mediterranean region. Sci Rep 14, 19233 (2024)</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-13-4349-2021">[21]</a> Mu√±oz-Sabater, J., Dutra, E., Agust√≠-Panareda, A., Albergel, C., Arduini, G., Balsamo, G., Boussetta, S., Choulga, M., Harrigan, S., Hersbach, H., Martens, B., Miralles, D. G., Piles, M., Rodr√≠guez-Fern√°ndez, N. J., Zsoter, E., Buontempo, C., and Th√©paut, J.-N.: ERA5-Land: a state-of-the-art global reanalysis dataset for land applications, Earth Syst. Sci. Data, 13, 4349‚Äì4383, 2021</p>
<p><a class="reference external" href="https://doi.org/10.1002/qj.3803">[22]</a> Hersbach, H., Bell, B., Berrisford, P., Hirahara, S., Hor√°nyi, A., Mu√±oz-Sabater, J., Nicolas, J., Peubey, C., Radu, R., Schepers, D., Simmons, A., Soci, C., Abdalla, S., Abellan, X., Balsamo, G., Bechtold, P., Biavati, G., Bidlot, J., Bonavita, M., De Chiara,
G., Dahlgren, P., Dee, D., Diamantakis, M., Dragani, R., Flemming, J., Forbes, R., Fuentes, M., Geer, A., Haimberger, L., Healy, S., Hogan, R. J., H√≥lm, E., Janiskov√°, M., Keeley, S., Laloyaux, P., Lopez, P., Lupu, C., Radnoti, G., de Rosnay, P., Rozum, I., Vamborg, F., Villaume, S., and Th√©paut, J.-N.: The ERA5 Global Reanalysis, Q. J. Roy. Meteor. Soc., 146, 1999‚Äì2049, 2020</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-11-717-2019">[23]</a> Gruber, A., Scanlon, T., van der Schalie, R., Wagner, W., and Dorigo, W.: Evolution of the ESA CCI Soil Moisture climate data records and their underlying merging methodology, Earth Syst. Sci. Data, 11, 717‚Äì739, 2019</p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-25-17-2021">[24]</a> Beck, H. E., Pan, M., Miralles, D. G., Reichle, R. H., Dorigo, W. A., Hahn, S., Sheffield, J., Karthikeyan, L., Balsamo, G., Parinussa, R. M., van Dijk, A. I. J. M., Du, J., Kimball, J. S., Vergopolan, N., and Wood, E. F.: Evaluation of 18 satellite- and model-based soil moisture products using in situ measurements from 826 sensors, Hydrol. Earth Syst. Sci., 25, 17‚Äì40, 2021</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-the-extremes-of-soil-moisture-deficit-in-europe-in-support-of-agriculture">üåç Use case: Investigating the extremes of soil moisture deficit in Europe in support of agriculture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">üì¢ Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-drier-than-normal-conditions">1. Detecting drier-than-normal conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries">Timeseries</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-metrics-and-comparing-datasets">2. Computing metrics and comparing datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude">Magnitude</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#severity">Severity</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>