
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.5.1. Satellite Soil Moisture Data for Drought Detection in Europe &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Hydrology/satellite_satellite-soil-moisture_extremes-detection_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. Ocean" href="../Ocean/Ocean.html" />
    <link rel="prev" title="1.5. Land Hydrology" href="Land_Hydrology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Hydrology.html">1.5. Land Hydrology</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.5.1. Satellite Soil Moisture Data for Drought Detection in Europe</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Hydrology/satellite_satellite-soil-moisture_extremes-detection_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Hydrology/satellite_satellite-soil-moisture_extremes-detection_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Satellite Soil Moisture Data for Drought Detection in Europe</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-drought-detection-and-monitoring-on-a-regional-level">üåç Use case: Drought detection and monitoring on a regional level</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-variables">Set variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-surface-soil-moisture-anomaly">2. Calculate Surface Soil Moisture Anomaly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssma-visualization">3. SSMA visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-europe-ssma">Map of Europe SSMA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-ssma-plots">Regional SSMA plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="satellite-soil-moisture-data-for-drought-detection-in-europe">
<h1><span class="section-number">1.5.1. </span>Satellite Soil Moisture Data for Drought Detection in Europe<a class="headerlink" href="#satellite-soil-moisture-data-for-drought-detection-in-europe" title="Link to this heading">#</a></h1>
<p>Production date: 16-June-2024</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-drought-detection-and-monitoring-on-a-regional-level">
<h2>üåç Use case: Drought detection and monitoring on a regional level<a class="headerlink" href="#use-case-drought-detection-and-monitoring-on-a-regional-level" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>‚ùì Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can satellite soil moisture data be used to detect the historically reported drought of 2023 in Europe?</strong></p></li>
</ul>
<p>Accurate soil moisture data is critical for monitoring droughts. The Copernicus Climate Change Service (C3S) provides the Combined Surface Soil Moisture (C3S-SM-COMBINED) product, which integrates active and passive microwave satellite observations to estimate surface (top few centimeters) soil moisture at a high temporal resolution (ICDR updated on a 10-day cycle). This study evaluates the usability of this dataset for tracking drought evolution across Europe in the warm season of 2023. The analysis focuses on dekadal anomalies of surface soil moisture (SSMA) from April to July 2023, highlighting regional differences, data coverage, and consistency with reported drought conditions.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The C3S surface soil moisture product is a valuable Essential Climate Variable (ECV) for tracking agricultural drought, especially when used alongside complementary indicators like root zone soil moisture, precipitation anomalies, and vegetation indices.</p></li>
<li><p>The COMBINED product successfully captures the intense drought in the Iberian Peninsula during spring 2023, consistent with observed heatwaves and low rainfall.</p></li>
<li><p>Coverage in Scandinavia and the Nordic region is still limited in spring due to snow, highlighting a known limitation of satellite-based soil moisture retrieval under frozen or snow-covered conditions.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-soil-moisture-extremes-detection-q02-section-1"><span class="std std-ref">1. Request and download data</span></a></strong></p>
<ul class="simple">
<li><p>Download the combined passive and active satellite soil moisture data from 1991 to 2023. Select the volumetric_surface_soil_moisture variable and choose the 10-day average as the time aggregation option.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-soil-moisture-extremes-detection-q02-section-2"><span class="std std-ref">2. Calculate Surface Soil Moisture Anomaly</span></a></strong></p>
<ul class="simple">
<li><p>Extract soil moisture data in Europe.</p></li>
<li><p>Calculate the dekad mean and standard deviation for the long-term period 1991 to 2020.</p></li>
<li><p>Extract 2023 data into a separate set.</p></li>
<li><p>Calculate the SSMA for 2023 in relation to the long-term period data.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-soil-moisture-extremes-detection-q02-section-3"><span class="std std-ref">3. SSMA visualization</span></a></strong></p>
<ul class="simple">
<li><p>Map the SSMA in Europe for Spring-Mid Summer 2023.</p></li>
<li><p>Plot the mean SSMA over time for specific regions.</p></li>
<li><p>Analyze the results.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="request-and-download-data">
<span id="satellite-satellite-soil-moisture-extremes-detection-q02-section-1"></span><h3>1. Request and download data<a class="headerlink" href="#request-and-download-data" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gridspec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely.geometry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiPolygon</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cfeature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">animation</span><span class="p">,</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rioxarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rxr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/trigoso_camila/.cdsapirc&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-variables">
<h4>Set variables<a class="headerlink" href="#set-variables" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shapefile_url</span> <span class="o">=</span> <span class="s2">&quot;https://figshare.com/ndownloader/files/23392280&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-the-data-request">
<h4>Set the data request<a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-soil-moisture&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;volumetric_surface_soil_moisture&quot;</span><span class="p">],</span>
    <span class="s2">&quot;type_of_sensor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;combined_passive_and_active&quot;</span><span class="p">],</span>
    <span class="s2">&quot;time_aggregation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;10_day_average&quot;</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;1991&quot;</span><span class="p">,</span> <span class="s2">&quot;1992&quot;</span><span class="p">,</span> <span class="s2">&quot;1993&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1994&quot;</span><span class="p">,</span> <span class="s2">&quot;1995&quot;</span><span class="p">,</span> <span class="s2">&quot;1996&quot;</span><span class="p">,</span>
        <span class="s2">&quot;1997&quot;</span><span class="p">,</span> <span class="s2">&quot;1998&quot;</span><span class="p">,</span> <span class="s2">&quot;1999&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2000&quot;</span><span class="p">,</span> <span class="s2">&quot;2001&quot;</span><span class="p">,</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2003&quot;</span><span class="p">,</span> <span class="s2">&quot;2004&quot;</span><span class="p">,</span> <span class="s2">&quot;2005&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2006&quot;</span><span class="p">,</span> <span class="s2">&quot;2007&quot;</span><span class="p">,</span> <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2009&quot;</span><span class="p">,</span> <span class="s2">&quot;2010&quot;</span><span class="p">,</span> <span class="s2">&quot;2011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2012&quot;</span><span class="p">,</span> <span class="s2">&quot;2013&quot;</span><span class="p">,</span> <span class="s2">&quot;2014&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2015&quot;</span><span class="p">,</span> <span class="s2">&quot;2016&quot;</span><span class="p">,</span> <span class="s2">&quot;2017&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2018&quot;</span><span class="p">,</span> <span class="s2">&quot;2019&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2021&quot;</span><span class="p">,</span> <span class="s2">&quot;2022&quot;</span><span class="p">,</span> <span class="s2">&quot;2023&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">],</span>
    <span class="s2">&quot;type_of_record&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cdr&quot;</span><span class="p">],</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v202312&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data">
<h4>Download data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataset</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Shapefile</span>
<span class="k">with</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simplecache::</span><span class="si">{</span><span class="n">shapefile_url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">world_shape</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/33 [00:00&lt;?, ?it/s]2025-05-30 13:58:16,664 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 13:58:16,859 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 13:58:17,533 INFO Request ID is 967eb086-6518-4236-90a7-8d566f97c596
2025-05-30 13:58:17,577 INFO status has been updated to accepted
2025-05-30 13:58:52,919 INFO status has been updated to running
2025-05-30 13:59:10,025 INFO status has been updated to successful

86ae92af8d0f26fa9731dcfbdac52901.zip:   0%|          | 0.00/23.6M [00:00&lt;?, ?B/s]
86ae92af8d0f26fa9731dcfbdac52901.zip:  17%|‚ñà‚ñã        | 4.00M/23.6M [00:00&lt;00:00, 39.8MB/s]
86ae92af8d0f26fa9731dcfbdac52901.zip:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 14.0M/23.6M [00:00&lt;00:00, 74.1MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
  3%|‚ñé         | 1/33 [00:55&lt;29:40, 55.63s/it]2025-05-30 13:59:12,509 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 13:59:12,529 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 13:59:12,878 INFO Request ID is 1d5a35a7-8be6-4175-ab7a-8c6276ec5db7
2025-05-30 13:59:12,966 INFO status has been updated to accepted
2025-05-30 14:00:03,061 INFO status has been updated to running
2025-05-30 14:00:28,770 INFO status has been updated to successful

9cb84068c0190fade02b3b9d5387ecfc.zip:   0%|          | 0.00/26.0M [00:00&lt;?, ?B/s]
9cb84068c0190fade02b3b9d5387ecfc.zip:  15%|‚ñà‚ñå        | 4.00M/26.0M [00:00&lt;00:00, 41.1MB/s]
9cb84068c0190fade02b3b9d5387ecfc.zip:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 13.0M/26.0M [00:00&lt;00:00, 68.9MB/s]
9cb84068c0190fade02b3b9d5387ecfc.zip:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 22.0M/26.0M [00:00&lt;00:00, 79.4MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
  6%|‚ñå         | 2/33 [02:13&lt;35:37, 68.95s/it]2025-05-30 14:00:31,102 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:00:31,157 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:00:31,376 INFO Request ID is d5a95d60-2043-4138-ad8d-250005f98a07
2025-05-30 14:00:31,415 INFO status has been updated to accepted
2025-05-30 14:00:45,337 INFO status has been updated to running
2025-05-30 14:01:21,898 INFO status has been updated to successful

8a4cb70ed14343bbd1573f68a252ed83.zip:   0%|          | 0.00/26.1M [00:00&lt;?, ?B/s]
8a4cb70ed14343bbd1573f68a252ed83.zip:  19%|‚ñà‚ñâ        | 5.00M/26.1M [00:00&lt;00:00, 50.2MB/s]
8a4cb70ed14343bbd1573f68a252ed83.zip:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 15.0M/26.1M [00:00&lt;00:00, 77.4MB/s]
8a4cb70ed14343bbd1573f68a252ed83.zip:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 24.0M/26.1M [00:00&lt;00:00, 84.8MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
  9%|‚ñâ         | 3/33 [03:07&lt;31:01, 62.06s/it]2025-05-30 14:01:24,585 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:01:24,606 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:01:25,751 INFO Request ID is bac30811-b400-49ce-91c2-40031921beab
2025-05-30 14:01:25,791 INFO status has been updated to accepted
2025-05-30 14:01:48,542 INFO status has been updated to running
2025-05-30 14:02:17,300 INFO status has been updated to successful

275a343c8f692cce5fed684ac383849f.zip:   0%|          | 0.00/26.2M [00:00&lt;?, ?B/s]
275a343c8f692cce5fed684ac383849f.zip:   8%|‚ñä         | 2.00M/26.2M [00:00&lt;00:01, 19.2MB/s]
275a343c8f692cce5fed684ac383849f.zip:  38%|‚ñà‚ñà‚ñà‚ñä      | 10.0M/26.2M [00:00&lt;00:00, 53.3MB/s]
275a343c8f692cce5fed684ac383849f.zip:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 20.0M/26.2M [00:00&lt;00:00, 72.5MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 12%|‚ñà‚ñè        | 4/33 [04:02&lt;28:33, 59.10s/it]2025-05-30 14:02:19,150 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:02:19,248 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:02:19,528 INFO Request ID is d5cf5bf0-78ef-4366-b9cd-de981f790ddb
2025-05-30 14:02:19,546 INFO status has been updated to accepted
2025-05-30 14:02:27,786 INFO status has been updated to running
2025-05-30 14:03:09,218 INFO status has been updated to successful

82aacc5742394dc259c508ad10c1aa79.zip:   0%|          | 0.00/26.6M [00:00&lt;?, ?B/s]
82aacc5742394dc259c508ad10c1aa79.zip:  11%|‚ñà‚ñè        | 3.00M/26.6M [00:00&lt;00:00, 30.9MB/s]
82aacc5742394dc259c508ad10c1aa79.zip:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 12.0M/26.6M [00:00&lt;00:00, 66.5MB/s]
82aacc5742394dc259c508ad10c1aa79.zip:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 22.0M/26.6M [00:00&lt;00:00, 83.5MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 15%|‚ñà‚ñå        | 5/33 [04:54&lt;26:20, 56.45s/it]2025-05-30 14:03:10,712 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:03:10,755 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:03:11,229 INFO Request ID is 1e44b1ed-e618-4f73-87c1-8d9cb3982e1b
2025-05-30 14:03:11,269 INFO status has been updated to accepted
2025-05-30 14:03:44,123 INFO status has been updated to running
2025-05-30 14:04:01,238 INFO status has been updated to successful

ba2522f33da81a879f84e729c093854b.zip:   0%|          | 0.00/26.2M [00:00&lt;?, ?B/s]
ba2522f33da81a879f84e729c093854b.zip:  23%|‚ñà‚ñà‚ñé       | 6.00M/26.2M [00:00&lt;00:00, 57.7MB/s]
ba2522f33da81a879f84e729c093854b.zip:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 14.0M/26.2M [00:00&lt;00:00, 71.5MB/s]
ba2522f33da81a879f84e729c093854b.zip:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 24.0M/26.2M [00:00&lt;00:00, 83.1MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 18%|‚ñà‚ñä        | 6/33 [05:46&lt;24:47, 55.08s/it]2025-05-30 14:04:03,245 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:04:03,328 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:04:03,630 INFO Request ID is 7939fad6-0848-4c05-946a-4eec7689339a
2025-05-30 14:04:03,669 INFO status has been updated to accepted
2025-05-30 14:04:25,019 INFO status has been updated to running
2025-05-30 14:04:53,667 INFO status has been updated to successful

e8e7e4a6c2e2963373d9a87c7fada1f9.zip:   0%|          | 0.00/26.6M [00:00&lt;?, ?B/s]
e8e7e4a6c2e2963373d9a87c7fada1f9.zip:  15%|‚ñà‚ñå        | 4.00M/26.6M [00:00&lt;00:00, 37.8MB/s]
e8e7e4a6c2e2963373d9a87c7fada1f9.zip:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 14.0M/26.6M [00:00&lt;00:00, 74.7MB/s]
e8e7e4a6c2e2963373d9a87c7fada1f9.zip:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 24.0M/26.6M [00:00&lt;00:00, 87.4MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 21%|‚ñà‚ñà        | 7/33 [06:38&lt;23:28, 54.19s/it]2025-05-30 14:04:55,489 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:04:55,515 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:04:55,802 INFO Request ID is 8303497f-ab10-46ba-ac0b-dc30693c56a1
2025-05-30 14:04:55,824 INFO status has been updated to accepted
2025-05-30 14:05:16,871 INFO status has been updated to running
2025-05-30 14:05:45,474 INFO status has been updated to successful

e9af2272cdaf443ae4ff9416f2469085.zip:   0%|          | 0.00/26.9M [00:00&lt;?, ?B/s]
e9af2272cdaf443ae4ff9416f2469085.zip:   4%|‚ñé         | 1.00M/26.9M [00:01&lt;00:26, 1.04MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  15%|‚ñà‚ñç        | 4.00M/26.9M [00:01&lt;00:05, 4.73MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  37%|‚ñà‚ñà‚ñà‚ñã      | 10.0M/26.9M [00:01&lt;00:01, 12.7MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 16.0M/26.9M [00:01&lt;00:00, 19.8MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 20.0M/26.9M [00:03&lt;00:01, 4.91MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 23.0M/26.9M [00:03&lt;00:00, 5.57MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 25.0M/26.9M [00:04&lt;00:00, 6.18MB/s]
e9af2272cdaf443ae4ff9416f2469085.zip: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 26.9M/26.9M [00:04&lt;00:00, 7.03MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 24%|‚ñà‚ñà‚ñç       | 8/33 [07:34&lt;22:50, 54.81s/it]2025-05-30 14:05:51,631 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:05:51,671 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:05:52,944 INFO Request ID is 271d15d1-27cb-4526-884f-0c294f4e6432
2025-05-30 14:05:53,322 INFO status has been updated to accepted
2025-05-30 14:06:15,136 INFO status has been updated to running
2025-05-30 14:07:09,950 INFO status has been updated to successful

f879ae8c8090bd5eff88e44e7d9aaece.zip:   0%|          | 0.00/26.9M [00:00&lt;?, ?B/s]
f879ae8c8090bd5eff88e44e7d9aaece.zip:  19%|‚ñà‚ñä        | 5.00M/26.9M [00:00&lt;00:00, 46.8MB/s]
f879ae8c8090bd5eff88e44e7d9aaece.zip:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 16.0M/26.9M [00:00&lt;00:00, 81.6MB/s]
f879ae8c8090bd5eff88e44e7d9aaece.zip: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 26.9M/26.9M [00:00&lt;00:00, 92.5MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 27%|‚ñà‚ñà‚ñã       | 9/33 [08:54&lt;25:04, 62.68s/it]2025-05-30 14:07:11,626 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:07:11,647 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:07:12,016 INFO Request ID is 1780221e-bfac-445f-ba16-ed802f2a0312
2025-05-30 14:07:12,059 INFO status has been updated to accepted
2025-05-30 14:08:02,071 INFO status has been updated to running
2025-05-30 14:09:06,583 INFO status has been updated to successful

97bd3e3007ba398739443bdb19520a84.zip:   0%|          | 0.00/26.8M [00:00&lt;?, ?B/s]
97bd3e3007ba398739443bdb19520a84.zip:  11%|‚ñà         | 3.00M/26.8M [00:00&lt;00:00, 28.7MB/s]
97bd3e3007ba398739443bdb19520a84.zip:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 13.0M/26.8M [00:00&lt;00:00, 68.4MB/s]
97bd3e3007ba398739443bdb19520a84.zip:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 24.0M/26.8M [00:00&lt;00:00, 84.8MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 27/33 [10:56&lt;00:03,  1.88it/s]2025-05-30 14:09:13,271 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:09:13,299 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:09:15,277 INFO Request ID is c4ce04d3-93c2-4a86-a6b8-9f619f7c0731
2025-05-30 14:09:15,314 INFO status has been updated to accepted
2025-05-30 14:10:05,592 INFO status has been updated to running
2025-05-30 14:10:31,269 INFO status has been updated to successful

ce48a37d9b3c52e10c40b3e5a2244f17.zip:   0%|          | 0.00/26.7M [00:00&lt;?, ?B/s]
ce48a37d9b3c52e10c40b3e5a2244f17.zip:   4%|‚ñé         | 1.00M/26.7M [00:00&lt;00:03, 7.44MB/s]
ce48a37d9b3c52e10c40b3e5a2244f17.zip:  37%|‚ñà‚ñà‚ñà‚ñã      | 10.0M/26.7M [00:00&lt;00:00, 49.9MB/s]
ce48a37d9b3c52e10c40b3e5a2244f17.zip:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 19.0M/26.7M [00:00&lt;00:00, 68.2MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 28/33 [12:16&lt;02:00, 24.18s/it]2025-05-30 14:10:33,116 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:10:33,139 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:10:33,719 INFO Request ID is ad9d438a-233c-4386-82c2-6bb25dbecbc8
2025-05-30 14:10:33,762 INFO status has been updated to accepted
2025-05-30 14:10:47,253 INFO status has been updated to running
2025-05-30 14:11:23,483 INFO status has been updated to successful

e3a5f999dfccd90b3177d7e8173dce8d.zip:   0%|          | 0.00/26.8M [00:00&lt;?, ?B/s]
e3a5f999dfccd90b3177d7e8173dce8d.zip:  11%|‚ñà         | 3.00M/26.8M [00:00&lt;00:00, 28.6MB/s]
e3a5f999dfccd90b3177d7e8173dce8d.zip:  49%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 13.0M/26.8M [00:00&lt;00:00, 67.8MB/s]
e3a5f999dfccd90b3177d7e8173dce8d.zip:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 23.0M/26.8M [00:00&lt;00:00, 81.0MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 29/33 [13:08&lt;02:10, 32.55s/it]2025-05-30 14:11:25,279 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:11:25,317 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:11:25,665 INFO Request ID is 6f05d4af-2fea-4d0c-9b46-64dab810a89e
2025-05-30 14:11:25,693 INFO status has been updated to accepted
2025-05-30 14:11:58,617 INFO status has been updated to running
2025-05-30 14:12:41,606 INFO status has been updated to successful

cd97b177a9fadf232130d4ab7601b3ca.zip:   0%|          | 0.00/27.2M [00:00&lt;?, ?B/s]
cd97b177a9fadf232130d4ab7601b3ca.zip:   4%|‚ñé         | 1.00M/27.2M [00:00&lt;00:03, 6.87MB/s]
cd97b177a9fadf232130d4ab7601b3ca.zip:  37%|‚ñà‚ñà‚ñà‚ñã      | 10.0M/27.2M [00:00&lt;00:00, 47.3MB/s]
cd97b177a9fadf232130d4ab7601b3ca.zip:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 19.0M/27.2M [00:00&lt;00:00, 65.3MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 30/33 [14:27&lt;02:18, 46.31s/it]2025-05-30 14:12:43,884 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:12:44,167 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:12:44,687 INFO Request ID is c98b0f91-4e2b-4676-9b8f-c495ac93ef46
2025-05-30 14:12:44,796 INFO status has been updated to accepted
2025-05-30 14:13:05,823 INFO status has been updated to running
2025-05-30 14:13:34,558 INFO status has been updated to successful

c886ef2b5cd4410517c8364fcfc842c0.zip:   0%|          | 0.00/27.4M [00:00&lt;?, ?B/s]
c886ef2b5cd4410517c8364fcfc842c0.zip:  15%|‚ñà‚ñç        | 4.00M/27.4M [00:00&lt;00:00, 39.0MB/s]
c886ef2b5cd4410517c8364fcfc842c0.zip:  40%|‚ñà‚ñà‚ñà‚ñà      | 11.0M/27.4M [00:00&lt;00:00, 57.2MB/s]
c886ef2b5cd4410517c8364fcfc842c0.zip:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 21.0M/27.4M [00:00&lt;00:00, 77.6MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 31/33 [15:19&lt;01:36, 48.09s/it]2025-05-30 14:13:36,101 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:13:36,126 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-05-30 14:13:37,050 INFO Request ID is 207a7e8c-d035-4ecb-acf4-81bcdb15d9c6
2025-05-30 14:13:37,073 INFO status has been updated to accepted
2025-05-30 14:13:45,866 INFO status has been updated to running
2025-05-30 14:14:10,083 INFO status has been updated to successful

b0e8b3b8145f8c1948e136442230a4e8.zip:   0%|          | 0.00/27.8M [00:00&lt;?, ?B/s]
b0e8b3b8145f8c1948e136442230a4e8.zip:  14%|‚ñà‚ñç        | 4.00M/27.8M [00:00&lt;00:00, 32.7MB/s]
b0e8b3b8145f8c1948e136442230a4e8.zip:  36%|‚ñà‚ñà‚ñà‚ñå      | 10.0M/27.8M [00:00&lt;00:00, 46.3MB/s]
b0e8b3b8145f8c1948e136442230a4e8.zip:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 15.0M/27.8M [00:00&lt;00:00, 44.8MB/s]
b0e8b3b8145f8c1948e136442230a4e8.zip:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 20.0M/27.8M [00:00&lt;00:00, 42.3MB/s]
b0e8b3b8145f8c1948e136442230a4e8.zip:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 25.0M/27.8M [00:00&lt;00:00, 43.1MB/s]
                                                                                          
  0%|          | 0/36 [00:00&lt;?, ?it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 33/33 [15:55&lt;00:00, 28.96s/it]
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/pyogrio/geopandas.py:275: UserWarning: More than one layer found in &#39;pyogrio_caa0acd978ca4858b07f80da53aa85ab.zip&#39;: &#39;Continents&#39; (default), &#39;Africa&#39;, &#39;North America&#39;, &#39;Europe&#39;, &#39;Oceania&#39;, &#39;South America&#39;, &#39;Asia&#39;, &#39;Antarctica&#39;, &#39;Australia&#39;. Specify layer parameter to avoid this warning.
  result = read_func(
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="calculate-surface-soil-moisture-anomaly">
<span id="satellite-satellite-soil-moisture-extremes-detection-q02-section-2"></span><h3>2. Calculate Surface Soil Moisture Anomaly<a class="headerlink" href="#calculate-surface-soil-moisture-anomaly" title="Link to this heading">#</a></h3>
<p>The Surface Soil Moisture Anomaly (referred to as SSMA hereafter) was calculated following a similar approach as the one explained by the European Drought Observatory (EDO) <a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_soilmoisture.pdf">[1]</a>. Surface soil moisture values for each pixel and each dekad from April to July 2023 were compared to the long-term climatological period (1991‚Äì2020, 30 years). The anomaly was computed using the following equation:</p>
<p><span class="math notranslate nohighlight">\(\text{SMA} = \frac{\text{SMI}_t - \overline{\text{SMI}}}{\delta_{\text{SMI}}}\)</span></p>
<p>where:</p>
<p><span class="math notranslate nohighlight">\(\text{SMI}_t\)</span> = Surface soil moisture 2023 for a specific dekad for that pixel</p>
<p><span class="math notranslate nohighlight">\(\overline{\text{SMI}}\)</span> = Mean surface soil moisture 1991-2020 for that same dekad for that pixel</p>
<p><span class="math notranslate nohighlight">\(\delta_{\text{SMI}}\)</span> = Standard deviation surface soil moisture 1991-2020 for that same dekad for that pixel</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Select soil mouisture variable</span>
<span class="n">da</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;sm&quot;</span><span class="p">]</span>
<span class="c1"># Filter the shapefile to keep only Europe</span>
<span class="n">europe_shape</span> <span class="o">=</span> <span class="n">world_shape</span><span class="p">[</span><span class="n">world_shape</span><span class="p">[</span><span class="s1">&#39;CONTINENT&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Europe&#39;</span><span class="p">]</span>
<span class="c1"># Ensure soil_moisture has CRS information compatible with europe_shape (e.g., EPSG:4326)</span>
<span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Clip soil moisture data to the Europe shape</span>
<span class="n">da_eu</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">europe_shape</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">europe_shape</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select data for the two time intervals.</span>
<span class="n">da_long_term</span> <span class="o">=</span> <span class="n">da_eu</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1991-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-12-21&quot;</span><span class="p">))</span>

<span class="c1">#Group by day of th year and them calculate the mean and standard deviation.</span>
<span class="c1">#The available days in each month are 1, 11 and 21, </span>
<span class="c1">#they correspont to the 1st, 2nd and 3rd dekad of the month.</span>
<span class="n">doy_long_term</span> <span class="o">=</span> <span class="n">da_long_term</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span>
<span class="n">mean_smi_long_term</span> <span class="o">=</span> <span class="n">doy_long_term</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">std_smi_long_term</span> <span class="o">=</span> <span class="n">doy_long_term</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Select the data of the year 2023 and calculate the mean same as before.</span>
<span class="n">da_2023</span> <span class="o">=</span> <span class="n">da_eu</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-12-21&quot;</span><span class="p">))</span>
<span class="n">doy_2023</span> <span class="o">=</span> <span class="n">da_2023</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span>
<span class="n">smi_2023</span> <span class="o">=</span> <span class="n">doy_2023</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Replace zeros in std with NaNs to avoid division by zero</span>
<span class="n">std_smi_long_term_safe</span> <span class="o">=</span> <span class="n">std_smi_long_term</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">std_smi_long_term</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate SMA safely</span>
<span class="n">sma</span> <span class="o">=</span> <span class="p">(</span><span class="n">smi_2023</span> <span class="o">-</span> <span class="n">mean_smi_long_term</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_smi_long_term_safe</span>

<span class="n">sma</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">sma</span><span class="p">))</span>  <span class="c1"># Replace inf/-inf with NaN</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="ssma-visualization">
<span id="satellite-satellite-soil-moisture-extremes-detection-q02-section-3"></span><h3>3. SSMA visualization<a class="headerlink" href="#ssma-visualization" title="Link to this heading">#</a></h3>
<section id="map-of-europe-ssma">
<h4>Map of Europe SSMA<a class="headerlink" href="#map-of-europe-ssma" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define custom colormap and boundaries</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;#b35806ff&quot;</span><span class="p">,</span>  <span class="c1"># &lt;-2</span>
    <span class="s2">&quot;#f1a340ff&quot;</span><span class="p">,</span>  <span class="c1"># -2 to -1.5</span>
    <span class="s2">&quot;#fee0b6ff&quot;</span><span class="p">,</span>  <span class="c1"># -1.5 to -1</span>
    <span class="s2">&quot;#ffffffff&quot;</span><span class="p">,</span>  <span class="c1"># -1 to 1</span>
    <span class="s2">&quot;#d1e5f0ff&quot;</span><span class="p">,</span>  <span class="c1"># 1 to 1.5</span>
    <span class="s2">&quot;#67a9cfff&quot;</span><span class="p">,</span>  <span class="c1"># 1.5 to 2</span>
    <span class="s2">&quot;#2166acff&quot;</span>   <span class="c1"># &gt;= 2</span>
<span class="p">]</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>  <span class="c1"># Define boundaries</span>

<span class="c1"># Create colormap and norm</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>  <span class="c1"># Gray for no data</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boxes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Iberian Peninsula&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span> 
        <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> 
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Great Britain and Ireland&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> 
        <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Southern Balkans and South Italy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
        <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Nordic and Baltic region&#39;</span><span class="p">,</span>
        <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mi">71</span><span class="p">,</span>
        <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Germany‚ÄìBenelux‚ÄìPoland&#39;</span><span class="p">,</span>
        <span class="s1">&#39;min_lat&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;max_lat&#39;</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span>
        <span class="s1">&#39;min_lon&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;max_lon&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dekad DOYs and labels</span>
<span class="n">dekad_days</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">91</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">111</span><span class="p">],</span>    <span class="c1"># April</span>
    <span class="p">[</span><span class="mi">121</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">141</span><span class="p">],</span>   <span class="c1"># May</span>
    <span class="p">[</span><span class="mi">152</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">172</span><span class="p">],</span>   <span class="c1"># June</span>
    <span class="p">[</span><span class="mi">182</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">202</span><span class="p">],</span>   <span class="c1"># July</span>
<span class="p">]</span>
<span class="n">month_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span> <span class="s1">&#39;July&#39;</span><span class="p">]</span>
<span class="n">dekad_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1st Dekad&#39;</span><span class="p">,</span> <span class="s1">&#39;2nd Dekad&#39;</span><span class="p">,</span> <span class="s1">&#39;3rd Dekad&#39;</span><span class="p">]</span>

<span class="c1"># Flatten DOYs and labels</span>
<span class="n">all_doys</span> <span class="o">=</span> <span class="p">[</span><span class="n">doy</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">dekad_days</span> <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
<span class="n">all_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">dekad</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">month_labels</span> <span class="k">for</span> <span class="n">dekad</span> <span class="ow">in</span> <span class="n">dekad_labels</span><span class="p">]</span>

<span class="c1"># === Create figure and axis ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">50</span><span class="p">)},</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">72</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>


<span class="c1"># === Add colored rectangles ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_rectangles</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="s1">&#39;max_lon&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lon&#39;</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">box</span><span class="p">[</span><span class="s1">&#39;max_lat&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lat&#39;</span><span class="p">]</span>
        <span class="n">rect</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lon&#39;</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lat&#39;</span><span class="p">]),</span>
            <span class="n">width</span><span class="p">,</span>
            <span class="n">height</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

<span class="n">add_rectangles</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># === Initial frame ===</span>
<span class="n">sm_init</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">all_doys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">all_doys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">sm_init</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># &lt;- disable auto colorbar</span>
<span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface Soil Moisture Anomaly</span><span class="se">\n</span><span class="si">{</span><span class="n">all_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Define bounds and ticks</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Add manual shared colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>          <span class="c1"># Make tick numbers smaller</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;SSMA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>   


<span class="c1"># === Animation update function ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame_idx</span><span class="p">):</span>
    <span class="n">doy</span> <span class="o">=</span> <span class="n">all_doys</span><span class="p">[</span><span class="n">frame_idx</span><span class="p">]</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">all_labels</span><span class="p">[</span><span class="n">frame_idx</span><span class="p">]</span>
    <span class="n">sm_doy</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">doy</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">sm_doy</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>  <span class="c1"># Update the image data</span>
    <span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface Soil Moisture Anomaly</span><span class="se">\n</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">im</span><span class="p">,</span>

<span class="c1"># === Create and save animation ===</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">all_doys</span><span class="p">),</span> <span class="n">blit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>

<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/SoilMoisture/fig/soil_moisture_animv2.gif&quot;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s1">&#39;pillow&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/83ca4a05e7ce9fb970ae183afa4b125b6d3baf5acfc167a4e54108de93c64dfe.png" src="../../_images/83ca4a05e7ce9fb970ae183afa4b125b6d3baf5acfc167a4e54108de93c64dfe.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-mapgif" style="width: 100%">
<img alt="../../_images/91445788-f349-461a-bdfe-33fcf271d6ba.gif" src="../../_images/91445788-f349-461a-bdfe-33fcf271d6ba.gif" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.1 </span><span class="caption-text">Surface soil moisture anomalies in Europe for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-mapgif" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="regional-ssma-plots">
<h4>Regional SSMA plots<a class="headerlink" href="#regional-ssma-plots" title="Link to this heading">#</a></h4>
<p>The mean SSMA of the regions marked by boxes in <a class="reference internal" href="#fig-mapgif"><span class="std std-numref">Fig. 1.5.1.1</span></a> were plotted over time.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_sma_mean_over_region</span><span class="p">(</span>
    <span class="n">sma_data</span><span class="p">,</span>
    <span class="n">min_lat</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span>
    <span class="n">max_lat</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">min_lon</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_lon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">start_doy</span><span class="o">=</span><span class="mi">91</span><span class="p">,</span>
    <span class="n">end_doy</span><span class="o">=</span><span class="mi">202</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Average Soil Moisture Anomaly over Iberian Peninsula&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="n">year</span><span class="o">=</span><span class="mi">2023</span>  <span class="c1"># specify year for converting DOY to date</span>
<span class="p">):</span>
    <span class="c1"># Subset by region</span>
    <span class="n">sma_subset</span> <span class="o">=</span> <span class="n">sma_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
        <span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lon</span><span class="p">),</span>
        <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">max_lat</span><span class="p">,</span> <span class="n">min_lat</span><span class="p">)</span>  <span class="c1"># decreasing lat</span>
    <span class="p">)</span>

    <span class="c1"># Ensure DOY values are valid</span>
    <span class="n">available_doys</span> <span class="o">=</span> <span class="n">sma_subset</span><span class="o">.</span><span class="n">dayofyear</span><span class="o">.</span><span class="n">values</span>
    <span class="n">target_doys</span> <span class="o">=</span> <span class="p">[</span><span class="n">doy</span> <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">available_doys</span> <span class="k">if</span> <span class="n">start_doy</span> <span class="o">&lt;=</span> <span class="n">doy</span> <span class="o">&lt;=</span> <span class="n">end_doy</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_doys</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No matching DOYs in range </span><span class="si">{</span><span class="n">start_doy</span><span class="si">}</span><span class="s2">‚Äì</span><span class="si">{</span><span class="n">end_doy</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Subset by DOY</span>
    <span class="n">sma_subset</span> <span class="o">=</span> <span class="n">sma_subset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">target_doys</span><span class="p">)</span>

    <span class="c1"># Mean over space</span>
    <span class="n">sma_mean</span> <span class="o">=</span> <span class="n">sma_subset</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Convert DOY to date</span>
    <span class="n">date_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">doy</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">doy</span> <span class="ow">in</span> <span class="n">sma_mean</span><span class="o">.</span><span class="n">dayofyear</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%j&quot;</span><span class="p">)</span>

    <span class="c1"># Plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">date_index</span><span class="p">,</span> <span class="n">sma_mean</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">date_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">date_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean SSMA&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Create custom ticks on 1st, 11th, 21st of each month</span>
    <span class="n">tick_days</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
    <span class="n">tick_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">date_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="n">date_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">custom_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">tick_dates</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">day</span> <span class="ow">in</span> <span class="n">tick_days</span><span class="p">]</span>
    
    <span class="c1"># Set custom ticks and labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">custom_ticks</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">custom_ticks</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

    <span class="c1"># Highlight 0 line</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal (SSMA=0)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/data/wp5/trigoso_camila/SoilMoisture/fig/sm_region_</span><span class="si">{</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
    <span class="n">plot_sma_mean_over_region</span><span class="p">(</span>
        <span class="n">sma_data</span><span class="o">=</span><span class="n">sma</span><span class="p">,</span>
        <span class="n">min_lat</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lat&#39;</span><span class="p">],</span>
        <span class="n">max_lat</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;max_lat&#39;</span><span class="p">],</span>
        <span class="n">min_lon</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;min_lon&#39;</span><span class="p">],</span>
        <span class="n">max_lon</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;max_lon&#39;</span><span class="p">],</span>
        <span class="n">start_doy</span><span class="o">=</span><span class="mi">91</span><span class="p">,</span>
        <span class="n">end_doy</span><span class="o">=</span><span class="mi">202</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;SSMA over </span><span class="si">{</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (Spring‚ÄìMid Summer 2023)&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">box</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/48134b5d70b5d00ff98f76260cc25834fd6ccc3c1a65093a24827a58259ba6ec.png" src="../../_images/48134b5d70b5d00ff98f76260cc25834fd6ccc3c1a65093a24827a58259ba6ec.png" />
<img alt="../../_images/e7891831c1ab1017c39d65c5f5da128928769596f7d45ea3318c971efd64a645.png" src="../../_images/e7891831c1ab1017c39d65c5f5da128928769596f7d45ea3318c971efd64a645.png" />
<img alt="../../_images/da1510e756cf468dec8410b4fdf0b86149fa1c2a3c8a6a930f5008d523b2ef25.png" src="../../_images/da1510e756cf468dec8410b4fdf0b86149fa1c2a3c8a6a930f5008d523b2ef25.png" />
<img alt="../../_images/2b9e1e45bfcec6f66e6b667c99bc3e0ad5e4c99042999f5d374adfba720ef01e.png" src="../../_images/2b9e1e45bfcec6f66e6b667c99bc3e0ad5e4c99042999f5d374adfba720ef01e.png" />
<img alt="../../_images/9bcb48c5d5dc5f742a0c34fb92dafc844c5c2932172e4f4af8e89f309a2dfa01.png" src="../../_images/9bcb48c5d5dc5f742a0c34fb92dafc844c5c2932172e4f4af8e89f309a2dfa01.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-iberian" style="width: 100%">
<img alt="../../_images/d81f09f9-b43a-42f8-a535-c124c00064a7.png" src="../../_images/d81f09f9-b43a-42f8-a535-c124c00064a7.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.2 </span><span class="caption-text">Surface soil moisture anomalies in the Iberian Peninsula for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-iberian" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-italy" style="width: 100%">
<img alt="../../_images/372ed1ff-109e-422d-a6da-f9ed7c3cce43.png" src="../../_images/372ed1ff-109e-422d-a6da-f9ed7c3cce43.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.3 </span><span class="caption-text">Surface soil moisture anomalies in the Southern Balkans and South Italy for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-italy" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>On top of low rainfall, a significant spring heatwave amplified drought conditions in the western Mediterranean in April 2023  <a class="reference external" href="https://www.nature.com/articles/s41612-024-00569-6">[2]</a>. According to the European Commission (2023) <a class="reference external" href="https://joint-research-centre.ec.europa.eu/jrc-news-and-updates/severe-drought-western-mediterranean-faces-low-river-flows-and-crop-yields-earlier-ever-2023-06-13_en">[3]</a> the Combined Drought Indicator (CDI) showed warning and alert conditions across much of the western Mediterranean by mid-May, with drought conditions worse than those observed at the same time of the year in 2022. This situation is reflected in the SSMA results for the Iberian Peninsula (see <a class="reference internal" href="#fig-iberian"><span class="std std-numref">Fig. 1.5.1.2</span></a>) The SSMA was notably negative, around -1.5 standard deviations, from April to mid-May. After late May, SSMA values increased, turning positive and gradually approaching normal conditions (near 0).</p>
<p>In contrast, crop-growing conditions improved in the Balkans, Italy, France, and Turkey during the same period <a class="reference external" href="https://joint-research-centre.ec.europa.eu/jrc-news-and-updates/severe-drought-western-mediterranean-faces-low-river-flows-and-crop-yields-earlier-ever-2023-06-13_en">[3]</a>. The European Commission also reported flooding in parts of Italy and the western Balkans in May 2023, caused by heavy precipitation <a class="reference external" href="https://climate.copernicus.eu/precipitation-relative-humidity-and-soil-moisture-may-2023">[5]</a>. This is consistent with observations in <a class="reference internal" href="#fig-italy"><span class="std std-numref">Fig. 1.5.1.3</span></a>, where the SSMA in southern Italy and the southern Balkans was strongly positive, reaching values above +1.5 standard deviations by mid-May.</p>
<figure class="align-default" id="fig-uk" style="width: 100%">
<img alt="../../_images/4821267f-756f-49e4-9dce-82925b64f704.png" src="../../_images/4821267f-756f-49e4-9dce-82925b64f704.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.4 </span><span class="caption-text">Surface soil moisture anomalies in Great Britain and Ireland for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-uk" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-central" style="width: 100%">
<img alt="../../_images/b983cb7f-b5d5-4990-b618-035b3e879822.png" src="../../_images/b983cb7f-b5d5-4990-b618-035b3e879822.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.5 </span><span class="caption-text">Surface soil moisture anomalies in Germany‚ÄìBenelux‚ÄìPoland for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-central" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Choose specific year and DOY ===</span>
<span class="n">chosen_year</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">chosen_doy</span> <span class="o">=</span> <span class="mi">152</span>  <span class="c1"># 1st Dekad of June</span>

<span class="c1"># === Extract data ===</span>
<span class="n">sm_single</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">chosen_doy</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">chosen_doy</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="p">)</span>
<span class="c1"># === Create figure and axis ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">50</span><span class="p">)},</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">72</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>

<span class="c1"># === Plot soil moisture ===</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">sm_single</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># === Add title ===</span>
<span class="n">month_idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dekad_days</span><span class="p">)</span> <span class="k">if</span> <span class="n">chosen_doy</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">)</span>
<span class="n">dekad_idx</span> <span class="o">=</span> <span class="n">dekad_days</span><span class="p">[</span><span class="n">month_idx</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">chosen_doy</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month_labels</span><span class="p">[</span><span class="n">month_idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">dekad_labels</span><span class="p">[</span><span class="n">dekad_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface Soil Moisture Anomaly</span><span class="se">\n</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">chosen_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># === Add colorbar ===</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;SSMA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># === Save the figure ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/data/wp5/trigoso_camila/SoilMoisture/fig/ssma_</span><span class="si">{</span><span class="n">chosen_year</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">chosen_doy</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/09c4cec525e3afbdd192171ed3d2ee6534b2164eb1c5d4997cc0399adb10ce65.png" src="../../_images/09c4cec525e3afbdd192171ed3d2ee6534b2164eb1c5d4997cc0399adb10ce65.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-june" style="width: 100%">
<img alt="../../_images/c01fcf81-aca2-4d01-a0d7-6f92db0a18d9.png" src="../../_images/c01fcf81-aca2-4d01-a0d7-6f92db0a18d9.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.6 </span><span class="caption-text">a) SSMA in early-June 2023 accoridng to the C3S-SM-COMBINED data. b) SMI Anomaly in early-June 2023 accoridng to the EDO, generated using Copernicus Emergency Management Service information (2025) <a class="reference external" href="https://drought.emergency.copernicus.eu/tumbo/edo/map/">[7]</a>.</span><a class="headerlink" href="#fig-june" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Great Britain, Ireland, and much of central Europe exhibited a notable negative SSMA peak at the beginning of June (see  <a class="reference internal" href="#fig-uk"><span class="std std-numref">Fig. 1.5.1.4</span></a> and <a class="reference internal" href="#fig-central"><span class="std std-numref">Fig. 1.5.1.5</span></a>). This pattern aligns with reports that much of central and northern Europe experienced drier-than-normal conditions in June 2023 <a class="reference external" href="https://op.europa.eu/en/publication-detail/-/publication/73bf18ea-2449-11ee-94cb-01aa75ed71a1/language-en">[6]</a>.</p>
<p><a class="reference internal" href="#fig-june"><span class="std std-numref">Fig. 1.5.1.6</span></a> (b) shows the Soil Moisture Index (SMI) Anomaly for early June, generated by the EDO  <a class="reference external" href="https://drought.emergency.copernicus.eu/tumbo/edo/map/">[7]</a>. This index is obtained using the LISFLOOD model, which ‚Äúsimulates soil moisture in two surface layers (skin layer and root zone) separately for forested and other layers. These four soil moisture layers are averaged daily to derive a single mean root zone soil moisture conditions to be successively standardized into SMI‚Äù <a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_soilmoisture.pdf">[1]</a>.</p>
<p>While both the LISFLOOD model and the satellite-derived C3S-SM-COMBINED product reflect general drought trends, differences emerge due to what each system measures. C3S observations represent only the top centimeters of the soil (surface layer), which respond more quickly to short-term precipitation events. LISFLOOD, on the other hand, also takes into account the deeper root zone, which changes more slowly and captures longer-term drought stress.</p>
<p>As a result, while the C3S product shows wetter-than-usual surface soil moisture anomalies in the Iberian Peninsula by early June, LISFLOOD still indicates drier-than-normal conditions due to lingering root-zone deficits. Conversely, in central Europe (e.g., Benelux and Germany), C3S data show negative anomalies whereas LISFLOOD depicts mostly normal conditions, with only some patches of dryness.</p>
<p>Surface soil moisture is particularly useful for monitoring rapid changes on a regional scale. However, for agricultural drought monitoring, it is important to also consider long-term and subsurface moisture conditions, as reflected in root-zone models like LISFLOOD.</p>
<figure class="align-default" id="fig-nordic" style="width: 100%">
<img alt="../../_images/372978d8-d7d9-4c4f-bfea-443e5f496eba.png" src="../../_images/372978d8-d7d9-4c4f-bfea-443e5f496eba.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.7 </span><span class="caption-text">Surface soil moisture anomalies in the Nordic and Baltic region for the period of Spring to Mid-Summer 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-nordic" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Choose specific year and DOY ===</span>
<span class="n">chosen_year</span> <span class="o">=</span> <span class="mi">2023</span>
<span class="n">chosen_doy</span> <span class="o">=</span> <span class="mi">91</span>  <span class="c1"># 1st Dekad of April</span>

<span class="c1"># === Extract data ===</span>
<span class="n">sm_single</span> <span class="o">=</span> <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">chosen_doy</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="n">sma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dayofyear</span><span class="o">=</span><span class="n">chosen_doy</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="p">)</span>
<span class="c1"># === Create figure and axis ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="mi">50</span><span class="p">)},</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">71</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>

<span class="c1"># === Plot soil moisture ===</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">sm_single</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># === Add title ===</span>
<span class="n">month_idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dekad_days</span><span class="p">)</span> <span class="k">if</span> <span class="n">chosen_doy</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">)</span>
<span class="n">dekad_idx</span> <span class="o">=</span> <span class="n">dekad_days</span><span class="p">[</span><span class="n">month_idx</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">chosen_doy</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month_labels</span><span class="p">[</span><span class="n">month_idx</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">dekad_labels</span><span class="p">[</span><span class="n">dekad_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surface Soil Moisture Anomaly</span><span class="se">\n</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">chosen_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># === Add colorbar ===</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.06</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span>
<span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;SSMA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># === Save the figure ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/data/wp5/trigoso_camila/SoilMoisture/fig/ssma_</span><span class="si">{</span><span class="n">chosen_year</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">chosen_doy</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/6ac248d4a6568f38c968cbfe65d173a628fa405bce66f03198bf0d37a9b13d3b.png" src="../../_images/6ac248d4a6568f38c968cbfe65d173a628fa405bce66f03198bf0d37a9b13d3b.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-nordicapril" style="width: 80%">
<img alt="../../_images/6c918ede-6757-4788-bd75-066f6a02e9db.png" src="../../_images/6c918ede-6757-4788-bd75-066f6a02e9db.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.8 </span><span class="caption-text">Surface soil moisture anomalies in the Nordic and Baltic region for the period in the first dekad of April 2023 accoridng to the C3S-SM-COMBINED data.</span><a class="headerlink" href="#fig-nordicapril" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-nordic"><span class="std std-numref">Fig. 1.5.1.7</span></a> shows that the Scandinavian Peninsula, as well as the Nordic and Baltic countries, were unusually dry during mid-spring and early summer 2023. However, the data for these regions in April is notably incomplete (see <a class="reference internal" href="#fig-nordicapril"><span class="std std-numref">Fig. 1.5.1.8</span></a>). During this period, valid soil moisture data are available only for the southernmost parts of the Scandinavian Peninsula. This lack of data can be attributed to the presence of snow cover and frozen soil still during spring. According to <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=445290955">PUGS</a>, the C3S Surface Soil Moisture v202312 product cannot retrieve meaningful data when the ground is snow-covered or frozen. Under such conditions, the dielectric properties of water change significantly, making satellite-based retrieval unreliable.</p>
<p>The results shown in this section are consistent with those presented in the European State of the Climate 2023 by Copernicus <a class="reference external" href="https://climate.copernicus.eu/esotc/2023/soil-moisture">[4]</a>. However, while that report presents monthly data using the C3S v202212 PASSIVE dataset, this analysis is based on a dekadal (10-day) data and uses the COMBINED v202312 product.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Markonis, Y., Kumar, R., Hanel, M., Rakovec, O., M√°ca, P., &amp; AghaKouchak, A. (2021). The rise of compound warm-season droughts in Europe. Science Advances, 7(6), eabb9668. <a class="reference external" href="https://doi.org/10.1126/sciadv.abb9668"></a></p></li>
<li><p>Ministerio para la Transici√≥n Ecol√≥gica y el Reto Demogr√°fico (2023). El 14,6% del territorio est√° en emergencia por escasez de agua y el 27,4%, en alerta. Nota de prensa. <a class="reference external" href="https://www.miteco.gob.es/es/prensa/ultimas-noticias/2023/09/el-14-6--del-territorio-esta-en-emergencia-por-escasez-de-agua-y.html"></a></p></li>
<li><p>Laguardia, G. &amp; Niemeyer, S. (2008). On the comparison between the LISFLOOD modelled and the ERS/SCAT derived soil moisture estimates. Hydrol. Earth Syst. Sci., 12, 1339‚Äì1351. <a class="reference external" href="https://hess.copernicus.org/articles/12/1339/2008/"></a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
<p>Dataset documentation:
<a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=355349314">SM v202212: Product User Guide and Specification (PUGS)</a></p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=453676750">SM v202312: Algorithm Theoretical Basis Document (ATBD)</a></p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=445290971">SM v202312: Product Quality Assurance Document (PQAD)</a></p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://drought.emergency.copernicus.eu/data/factsheets/factsheet_soilmoisture.pdf">[1]</a> European Commission (2019). EDO INDICATOR FACTSHEET Soil Moisture Anomaly (SMA). European Drought Observatory.</p>
<p><a class="reference external" href="https://www.nature.com/articles/s41612-024-00569-6">[2]</a> Lemus-Canovas, M., Insua-Costa, D., Trigo, R. &amp; Miralles, D. (2024). Record-shattering 2023 Spring heatwave in western Mediterranean amplified by long-term drought. npj Clim Atmos Sci 7, 25.</p>
<p><a class="reference external" href="https://joint-research-centre.ec.europa.eu/jrc-news-and-updates/severe-drought-western-mediterranean-faces-low-river-flows-and-crop-yields-earlier-ever-2023-06-13_en">[3]</a> European Commission (2023a). Severe drought: western Mediterranean faces low river flows and crop yields earlier than ever. European Drought Observatory. The Joint Research Centre: EU Science Hub.</p>
<p><a class="reference external" href="https://climate.copernicus.eu/esotc/2023/soil-moisture">[4]</a> European Commission (2023b). Europe in 2023 Soil Moisture.</p>
<p><a class="reference external" href="https://climate.copernicus.eu/precipitation-relative-humidity-and-soil-moisture-may-2023">[5]</a> European Commission (2023c). Precipitation, relative humidity and soil moisture for May 2023.</p>
<p><a class="reference external" href="https://op.europa.eu/en/publication-detail/-/publication/73bf18ea-2449-11ee-94cb-01aa75ed71a1/language-en">[6]</a> Toreti, A., Bavera, D., Acosta Navarro, J., Arias-Mu√±oz, C., Barbosa, P., De Jager, A., Di Ciollo, C., Fioravanti, G., Grimaldi, S., Hrast Essenfelder, A., Maetens, W., Magni, D., Masante, D., Mazzeschi, M., Mccormick, N. &amp; Salamon, P. (2023). Drought in Europe June 2023. Publications Office of the European Union, Luxembourg, 2023, doi:10.2760/575433, JRC134492.</p>
<p><a class="reference external" href="https://drought.emergency.copernicus.eu/tumbo/edo/map/">[7]</a> Copernicus Emergency Management Service (2025). European Drought Observatory map.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Hydrology"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Hydrology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
    </a>
    <a class="right-next"
       href="../Ocean/Ocean.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-drought-detection-and-monitoring-on-a-regional-level">üåç Use case: Drought detection and monitoring on a regional level</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and download data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-variables">Set variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request">Set the data request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-surface-soil-moisture-anomaly">2. Calculate Surface Soil Moisture Anomaly</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssma-visualization">3. SSMA visualization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-europe-ssma">Map of Europe SSMA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-ssma-plots">Regional SSMA plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>