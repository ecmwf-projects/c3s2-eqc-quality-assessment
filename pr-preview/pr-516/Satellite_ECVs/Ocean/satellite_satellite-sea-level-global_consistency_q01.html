
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.6.1. Long-term global Eddy Kinetic Energy trends from satellite observations &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_consistency_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Insitu Observations" href="../../In_Situ/insitu.html" />
    <link rel="prev" title="1.6. Ocean" href="Ocean.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Ocean.html">1.6. Ocean</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.6.1. Long-term global Eddy Kinetic Energy trends from satellite observations</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Ocean/satellite_satellite-sea-level-global_consistency_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_consistency_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Long-term global Eddy Kinetic Energy trends from satellite observations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-evaluation-of-long-term-eddy-kinetic-energy-trends">üåç Use case: Evaluation of long-term Eddy Kinetic Energy trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">‚ùì Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection-and-setup">1. Data selection and setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-startup-parameters">Define startup parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request-for-satellite-altimetry-vdt2021-and-vdt2024">Define data request for satellite altimetry (vDT2021 and vDT2024)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eddy-kinetic-energy-eke-computation">2. Eddy Kinetic Energy (EKE) computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-high-eke-regions">3. Definition of high EKE regions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eke-time-series-and-trends-computation">4. EKE time series and trends computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-and-discussion-of-results">5. Plotting and discussion of results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-eke-regions">High EKE regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#area-weighted-mean-eke-time-series">Area-weighted mean EKE time series</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#global-region">Global region</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mesoscale-high-activity-regions">Mesoscale High-Activity Regions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#eke-trends">EKE trends</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Global region</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Mesoscale High-Activity Regions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="long-term-global-eddy-kinetic-energy-trends-from-satellite-observations">
<h1><span class="section-number">1.6.1. </span>Long-term global Eddy Kinetic Energy trends from satellite observations<a class="headerlink" href="#long-term-global-eddy-kinetic-energy-trends-from-satellite-observations" title="Link to this heading">#</a></h1>
<p>Production date: 4-11-2025</p>
<p>Produced by: Joan Armajach and Blanca Fern√°ndez-√Ålvarez - IMEDEA (CSIC-UIB) <a class="reference external" href="https://imedea.uib-csic.es/" rel="noreferrer" target="_blank">[webpage]</a></p>
<section id="use-case-evaluation-of-long-term-eddy-kinetic-energy-trends">
<h2>üåç Use case: Evaluation of long-term Eddy Kinetic Energy trends<a class="headerlink" href="#use-case-evaluation-of-long-term-eddy-kinetic-energy-trends" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>‚ùì Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can we assess the long-term variability of global ocean Eddy Kinetic Energy using satellite altimetry?</strong></p></li>
</ul>
<p>Global ocean circulation is both a cause and consequence of fluid interactions occurring across a wide range of spatial scales, from millimetres to more than 10,000 km <a class="reference external" href="https://doi.org/10.1146/annurev.fluid.40.111406.102139" rel="noreferrer" target="_blank">[1]</a>. For ocean circulation, most of the available energy is expressed as kinetic energy (KE), which is a suitable index for measuring the intensity of ocean currents <a class="reference external" href="https://doi.org/10.1126/sciadv.aax7727" rel="noreferrer" target="_blank">[2]</a>. Mesoscale variability, which ranges from tens to hundreds of kilometers depending on latitude <a class="reference external" href="https://doi.org/10.1175/1520-0485%281998%29028%3C0433:GVOTFB%3E2.0.CO;2" rel="noreferrer" target="_blank">[3]</a>, contains nearly all of the ocean‚Äôs KE and represents the dominant signal in ocean circulation <a class="reference external" href="https://doi.org/10.1029/2005GL024633" rel="noreferrer" target="_blank">[4]</a>. About 90% of the total KE is associated with the mesoscale activity, called Eddy Kinetic Energy (EKE) [<a class="reference external" href="https://doi.org/10.1146/annurev.fluid.40.111406.102139" rel="noreferrer" target="_blank">1</a>, <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">5</a>]. Meanders, eddies, fronts and jets are examples of mesoscale features that contribute a large part of the transport of heat, mass and chemical constituents in seawater <a class="reference external" href="https://doi.org/10.1029/2007GL030812" rel="noreferrer" target="_blank">[6]</a>. Consequently, the dynamics of mesoscale features has a notable impact on the surface circulation and oceanic biogeochemistry, spanning local and global scales <a class="reference external" href="https://doi.org/10.1175/JTECH-D-17-0010.1" rel="noreferrer" target="_blank">[7]</a>. To study the evolution of the EKE, gridded satellite sea level anomaly (SLA) products are widely used <a class="reference external" href="https://doi.org/10.3389/fmars.2019.00703" rel="noreferrer" target="_blank">[8]</a>. Over the last two decades, satellite altimetry has significantly improved our ability to observe and understand ocean circulation at the mesoscale, providing global, high-resolution, and regular monitoring capabilities [<a class="reference external" href="https://doi.org/10.1016/j.asr.2021.01.022" rel="noreferrer" target="_blank">9</a>, <a class="reference external" href="https://doi.org/10.1016/j.asr.2011.09.033" rel="noreferrer" target="_blank">10</a>]. At present, a nearly 30-year time series of altimetric EKE is available, and several studies have reported a strengthening trend per decade in some energetic regions (e.g., [<a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">5</a>, <a class="reference external" href="https://doi.org/10.5194/egusphere-2025-4651" rel="noreferrer" target="_blank">11</a>, <a class="reference external" href="https://doi.org/10.1038/s41558-021-01006-9" rel="noreferrer" target="_blank">12</a>]). In long-term studies from satellite observations, we need to consider that gridded energy levels can vary depending on the data processing and the number of the altimeter missions <a class="reference external" href="https://doi.org/10.1007/s10712-023-09778-9" rel="noreferrer" target="_blank">[13]</a>. As highlighted in <a class="reference external" href="https://doi.org/10.1007/s10712-023-09778-9" rel="noreferrer" target="_blank">[13]</a>, a consistent sampling over time from the 2-satellite configuration is recommended for the evaluation of long-term EKE.</p>
<p>This notebook aims to assess the performance of sea level data from satellite observations to estimate the global EKE trends over the altimetric era (1993-2022), following <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a>.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>At the global level, mesoscale activity is intensifying, especially in the last decade. Most of this strengthening is concentrated in regional areas characterized by high Eddy Kinetic Energy (EKE). In these high-EKE regions, the Kuroshio Extension (KE) exhibits the largest EKE trends, followed by the Gulf Stream (GS). Over the altimetric era (1993-2022), EKE trends in the KE are 8.69 cm¬≤‚ÄØs‚Åª¬≤‚ÄØyear‚Åª¬π for vDT2021 and 8.23 cm¬≤‚ÄØs‚Åª¬≤‚ÄØyear‚Åª¬π for vDT2024. However, in the GS for the same period, these trends are 2.51 cm¬≤‚ÄØs‚Åª¬≤‚ÄØyear‚Åª¬π for vDT2021 and 2.12 cm¬≤‚ÄØs‚Åª¬≤‚ÄØyear‚Åª¬π for vDT2024, both statistically non-significant.</p></li>
<li><p>When comparing the sea level products distributed through the Climate Data Store (designed for climate applications), the vDT2021 dataset produces higher EKE both in the global ocean and in high-EKE regions throughout the studied period. Nevertheless, in regions such as the KE, these differences between versions are much smaller. This demonstrates that a two-satellite constellation can properly capture mesoscale activity. A constellation with a stable number of satellites ensures the long-term stability of the data record, as is the case for this product, making it a suitable tool for this type of study.</p></li>
<li><p>In general, we recommend using the vDT2024 version, as it incorporates new input L2P (Level-2 Plus) altimeter standards compared to the older version (vDT2021). The L2P products serve as the main input for the altimeter-derived sea level production system, providing the necessary information to compute the along-track Sea Level Anomalies (SLA), while applying the same updated corrections and models for the altimeter missions.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The altimetric sea level datasets are distributed by the <a class="reference external" href="https://marine.copernicus.eu/" rel="noreferrer" target="_blank">Copernicus Marine Environment Monitoring Service (CMEMS)</a> and the <a class="reference external" href="https://climate.copernicus.eu/" rel="noreferrer" target="_blank">Copernicus Climate Change Service (C3S)</a>. In this assessment, we use <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-level-global?tab=overview" rel="noreferrer" target="_blank">the Sea level gridded data from satellite observations</a> provided by the <a class="reference external" href="https://cds.climate.copernicus.eu/" rel="noreferrer" target="_blank">Copernicus Climate Data Store (CDS)</a>. The C3S product is designed for climate applications and is based on a consistent and stable altimeter constellation to ensure the long-term stability of the ocean observing system. To achieve this consistency, two satellites of the altimeters constellation are selected to collect observations. One of the satellites serves as the reference mission. Although there are changes over time, each replacement mission follows the same orbit, ensuring consistency. The other, known as the secondary mission, is a complementary satellite that provides significant information for estimating mesoscale signals. All the necessary information can be found in the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Sea+Level+version+DT2024%3A+Product+User+Guide+and+Specification#SeaLevelversionDT2024:ProductUserGuideandSpecification-section4.2.2" rel="noreferrer" target="_blank">Product User Guide and Specification (PUGS)</a>.</p>
<p>As previously mentioned, we follow the same methodology as in <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a> to estimate EKE time series and trends over the global ocean. In addition, we quantify EKE in regions of high mesoscale activity, as performed in that study. The authors used the vDT2018 and vDT2021 two-satellite products from C3S to compare them with the vDT2021 all-satellite product provided by CMEMS. The latter uses all available satellites in the constellation, ranging from 2 to 7 over the altimetric period.</p>
<p>In this study, the vDT2024 version of the satellite gridded sea level observations available in the Climate Data Store is compared with the vDT2021, in order to evaluate how the new version resolves the EKE relative to the previous one. The TOPEX-A instrument drift correction for 1993-1998, which has been quantified in many studies (e.g., <a class="reference external" href="https://doi.org/10.1038/NCLIMATE2635" rel="noreferrer" target="_blank">[14]</a>), has not yet been computed in the vDT2024 data. In contrast, the vDT2021 product implements this correction as a separate variable (not directly included in the SLA estimate).</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-level-global-consistency-q01-section-1"><span class="std std-ref">1. Data selection and setup</span></a></strong></p>
<ul class="simple">
<li><p>Set up the python environment and import required libraries</p></li>
<li><p>Define the startup parameters</p></li>
<li><p>Define request for satellite altimetry, using both vDT2021 and vDT2024 datasets available from CDS</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-level-global-consistency-q01-section-2"><span class="std std-ref">2. Eddy Kinetic Energy (EKE) computation</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-level-global-consistency-q01-section-3"><span class="std std-ref">3. Definition of high EKE regions</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-level-global-consistency-q01-section-4"><span class="std std-ref">4. EKE time series and trends computation</span></a></strong></p>
<p><strong><a class="reference internal" href="#satellite-satellite-sea-level-global-consistency-q01-section-5"><span class="std std-ref">5. Plotting and discussion of results</span></a></strong></p>
<ul class="simple">
<li><p>High EKE regions</p></li>
<li><p>Area-weighted mean EKE time series</p></li>
<li><p>EKE trends</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="data-selection-and-setup">
<span id="satellite-satellite-sea-level-global-consistency-q01-section-1"></span><h3>1. Data selection and setup<a class="headerlink" href="#data-selection-and-setup" title="Link to this heading">#</a></h3>
<section id="import-required-libraries">
<h4>Import required libraries<a class="headerlink" href="#import-required-libraries" title="Link to this heading">#</a></h4>
<p>First we import the necessary packages.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">ndimage</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mlines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Patch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.feature</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">feature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">add_cyclic_point</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mk</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-startup-parameters">
<h4>Define startup parameters<a class="headerlink" href="#define-startup-parameters" title="Link to this heading">#</a></h4>
<p>For this study, we select the period from 1993 to 2022 to cover the entire altimetric era. Moreover, we apply a mask to include only latitudes between 65¬∞S and 65¬∞N, ensuring that satellite observations remain consistent and are not affected by sea ice.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;1993-01&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="s2">&quot;2022-12&quot;</span>

<span class="c1"># Global region</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">65</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-data-request-for-satellite-altimetry-vdt2021-and-vdt2024">
<h4>Define data request for satellite altimetry (vDT2021 and vDT2024)<a class="headerlink" href="#define-data-request-for-satellite-altimetry-vdt2021-and-vdt2024" title="Link to this heading">#</a></h4>
<p>Here, we define the data request for the global gridded daily sea level products for each version (vDT2021 and vDT2024) using the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api" rel="noreferrer" target="_blank">CDS API client</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">versions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vdt2021&quot;</span><span class="p">,</span> <span class="s2">&quot;vdt2024&quot;</span><span class="p">]</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-level-global&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="eddy-kinetic-energy-eke-computation">
<span id="satellite-satellite-sea-level-global-consistency-q01-section-2"></span><h3>2. Eddy Kinetic Energy (EKE) computation<a class="headerlink" href="#eddy-kinetic-energy-eke-computation" title="Link to this heading">#</a></h3>
<p>To compute EKE, we apply the specific formula:</p>
<div class="math notranslate nohighlight">
\[
EKE = \frac{1}{2} (u_a^2 + v_a^2) \quad \text{(cm¬≤ s‚Åª¬≤)}
\]</div>
<p>where <span class="math notranslate nohighlight">\(u_a^2\)</span> and <span class="math notranslate nohighlight">\(v_a^2\)</span> refer to the zonal and meridional components of the geostrophic velocity anomalies, respectively. These variables are derived from the gridded SLA field. The computation is based on a 9-point stencil width <a class="reference external" href="https://doi.org/10.1029/2011JC007367" rel="noreferrer" target="_blank">[15]</a> for latitudes outside the ¬±5¬∞N band. In the equatorial band, the Lagerloef method <a class="reference external" href="https://doi.org/10.1029/1999JC900197" rel="noreferrer" target="_blank">[16]</a> is applied, using the Œ≤ plane approximation.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_eke</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="n">eke</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1.0e4</span> <span class="o">*</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;ugosa&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;vgosa&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> 
    <span class="n">eke</span> <span class="o">=</span> <span class="n">eke</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># monthly mean </span>
    <span class="n">eke</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Eddy Kinetic Energy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;cm^2 s^{-2}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Eddy Kinetic Energy from geostrophic velocity anomalies (ugosa, vgosa)&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">eke</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;EKE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>In this part, we download the datasets according to the request, integrating the function that computes EKE once all the data are available. Chunks are necessary to manage large volumes of information. Finally, we concatenate the EKE data along the dimension ‚Äúversion‚Äù.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">versions</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">version</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">requests</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">},</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span>
        <span class="n">requests</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_eke</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="p">[</span><span class="n">version</span><span class="p">]))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>version=&#39;vdt2021&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 360/360 [02:10&lt;00:00,  2.77it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>version=&#39;vdt2024&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 360/360 [01:55&lt;00:00,  3.13it/s]
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="definition-of-high-eke-regions">
<span id="satellite-satellite-sea-level-global-consistency-q01-section-3"></span><h3>3. Definition of high EKE regions<a class="headerlink" href="#definition-of-high-eke-regions" title="Link to this heading">#</a></h3>
<p>As described in <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a>, specific areas with high mesoscale activity due to their ocean dynamics are referred to as high EKE regions. To identify these high-intensity regions, the 90th spatial percentile of the mean EKE over the full period (1993-2022) is computed.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Temporal mean of EKE</span>
<span class="n">eke</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;EKE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span> <span class="c1"># version vDT2024</span>

<span class="c1"># Define high EKE regions (90th percentile)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">eke</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;quantile&quot;</span><span class="p">)</span>
<span class="n">high_eke</span> <span class="o">=</span> <span class="n">eke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">eke</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Once we have identified the areas with high EKE activity, we define these regions using the latitude and longitude bounds for each region. These regions are: Brazil-Malvinas Confluence (BMC), Loop Current (LC), Gulf Stream (GS), Great Whirl and Socotra Eddy (GWSE), Agulhas Current (AC), Kuroshio Extension (KE), and East Australian Current (EAC).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Regions</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;GWSE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">0.593297</span><span class="p">,</span> <span class="mf">21.390730</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">42.156397</span><span class="p">,</span> <span class="mf">65.139224</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;AC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">49.705567</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.668587</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">3.992485</span><span class="p">,</span> <span class="mf">88.354845</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;KE&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">27.214451</span><span class="p">,</span> <span class="mf">44.797421</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">126.707357</span><span class="p">,</span> <span class="mf">178.966069</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;GS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">24.655584</span><span class="p">,</span> <span class="mf">52.309994</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">79.479982</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.198502</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;LC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">17.631824</span><span class="p">,</span> <span class="mf">32.110687</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">98.185393</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.340371</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;BMC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">53.048704</span><span class="p">,</span> <span class="o">-</span><span class="mf">32.907111</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">59.082424</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.689903</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="s2">&quot;EAC&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">43.201439</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.725291</span><span class="p">),</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">143.651991</span><span class="p">,</span> <span class="mf">167.912370</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For the regions with high EKE, we apply a function that fills holes, removes small regions using a threshold, and smooths contours. This results in well-defined regions and the minimisation of the spurious inclusion of small patches.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">smooth_regions</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lim</span><span class="p">):</span>
    <span class="n">struct</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">struct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">label_da</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">label_da</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_features</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mask_sizes</span> <span class="o">=</span> <span class="n">sizes</span> <span class="o">&gt;</span> <span class="n">lim</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">mask_sizes</span><span class="p">[</span><span class="n">label_da</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">struct</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We create a dataset with the masks of all individual high EKE regions, previously defined as ‚Äúregions‚Äù. First, we generate a binary global mask based on the mean EKE, where values of 1 mean that the threshold (90th percentile) is exceeded, and values of 0 represent otherwise. Once done, we extract the high EKE regions and apply the smoothing function. Then, we concatenate all the regional masks along the dimension named ‚Äúregion‚Äù to differentiate each one.</p>
<p>Additionally, we integrate new masks, one composed of all high EKE regions combined (named ‚Äúhigh EKE‚Äù), another representing the global mask without NaN values of EKE (named ‚Äúno ice‚Äù), and finally a mask representing the tropical band (named ‚Äútropical‚Äù), excluding the regions that are already included in ‚Äúhigh EKE‚Äù mask.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global mask (1 for high EKE, 0)</span>
<span class="n">global_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">eke</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># All individual high EKE regions</span>
<span class="n">masks_list</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># mask</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">slices</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">global_mask</span><span class="p">,</span> <span class="o">**</span><span class="n">slices</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">smooth_regions</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s2">&quot;LC&quot;</span> <span class="k">else</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">masks_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">label</span><span class="p">]))</span>
<span class="n">masks</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">masks_list</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>

<span class="c1"># All high EKE regions combined (&#39;high EKE&#39;) and global (&#39;no ice&#39;)</span>
<span class="n">masks</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">masks</span><span class="p">,</span>
        <span class="n">masks</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;high EKE&quot;</span><span class="p">]),</span>  
        <span class="n">eke</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;no ice&quot;</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Tropical mask</span>
<span class="n">tropical_mask</span> <span class="o">=</span> <span class="n">high_eke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">high_eke</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">tropical_mask</span> <span class="o">=</span> <span class="n">tropical_mask</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tropical_mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">tropical_mask</span> <span class="o">=</span> <span class="n">tropical_mask</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;high EKE&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">tropical_mask</span> <span class="o">=</span> <span class="n">tropical_mask</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;tropical&quot;</span><span class="p">])</span>
<span class="n">masks</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">masks</span><span class="p">,</span> <span class="n">tropical_mask</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="eke-time-series-and-trends-computation">
<span id="satellite-satellite-sea-level-global-consistency-q01-section-4"></span><h3>4. EKE time series and trends computation<a class="headerlink" href="#eke-time-series-and-trends-computation" title="Link to this heading">#</a></h3>
<p>In this section, we calculate the area-weighted mean for the spatial averages using latitude weighting. This process is applied to all the masks.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute time series of EKE for all masks</span>
<span class="n">eke_timeseries</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;EKE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">masks</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Here, we define the regions used in the test (no ice, high EKE, KE, and GS) and the dictionaries to store the original time series and a 12-month rolling mean over a continuous period to smooth fluctuations in the data.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Regions for the test</span>
<span class="n">dic_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no ice&#39;</span><span class="p">,</span><span class="s1">&#39;high EKE&#39;</span><span class="p">,</span><span class="s1">&#39;KE&#39;</span><span class="p">,</span><span class="s1">&#39;GS&#39;</span><span class="p">]</span>

<span class="n">ts_raw_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">ts_roll_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">{}}</span>

<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">dic_keys</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------&#39;</span><span class="p">)</span> 
    <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
        <span class="c1"># Raw data</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">eke_timeseries</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># 12-month rolling mean </span>
        <span class="n">ts_roll</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  
                
        <span class="c1"># Store time series in dictionaries</span>
        <span class="n">ts_raw_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span>
        <span class="n">ts_roll_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_roll</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>----------------
no ice
----------------

----------------
high EKE
----------------

----------------
KE
----------------

----------------
GS
----------------
</pre></div>
</div>
</div>
</details>
</div>
<p>For the computation of EKE trends, we implement the Theil-Sen estimator, a non-parametric method for fitting a line to sample points. This regression algorithm is more robust to outliers compared to ordinary least-squares regression, which is sensitive to them. To assess the significance of trends, we use the Mann-Kendall test. However, the presence of serial correlation in time series can affect the results <a class="reference external" href="https://doi.org/10.1023/B:WARM.0000043140.61082.60" rel="noreferrer" target="_blank">[17]</a>. Therefore, we employ the modified Mann-Kendall test proposed by <a class="reference external" href="https://doi.org/10.1023/B:WARM.0000043140.61082.60" rel="noreferrer" target="_blank">[17]</a>, which accounts for this autocorrelation.</p>
<p>Furthermore, we convert the trends, initially in cm¬≤ s‚Åª¬≤ month‚Åª¬π to cm¬≤ s‚Åª¬≤ year‚Åª¬π using a factor to facilitate the comparison of the results.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to compute trends (Mann-Kendall test)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mk_test</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">mk</span><span class="o">.</span><span class="n">yue_wang_modification_test</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">p</span>
    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">p_value</span>

<span class="c1"># Multply by the factor 12 months to convert trends per month to trends per year </span>
<span class="n">factor</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>In this case, we calculate the trends over different periods of the EKE time series, starting each trend in a different year between 1993 and 2013 (inclusive) and ending in the last year of the study (2022). The MK test is applied to each EKE time series for every region and version. As before, we create new dictionaries to store all trends and p-values.</p>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Years for the test</span>
<span class="n">test_years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1993</span><span class="p">,</span> <span class="mi">2013</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Updated dictionary keys</span>
<span class="n">dic_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no ice&#39;</span><span class="p">,</span><span class="s1">&#39;high EKE&#39;</span><span class="p">,</span><span class="s1">&#39;KE&#39;</span><span class="p">,</span><span class="s1">&#39;GS&#39;</span><span class="p">]</span>

<span class="c1"># Lists to save results for high EKE regions, global ocean, Kuroshio Extension (KE) and Gulf Stream (GS) </span>
<span class="n">list_slope_global</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">list_slope_highEKE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">list_pval_global</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">list_pval_highEKE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">list_slope_KE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">list_slope_GS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">list_pval_KE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">list_pval_GS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">test_years</span><span class="p">:</span>

    <span class="n">cut_initial_date</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-01-01&quot;</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="n">list_slope_tmp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">list_pval_tmp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dic_keys</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
            <span class="c1"># Raw data</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">eke_timeseries</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">cut_initial_date</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Test MK</span>
            <span class="n">slope_raw</span><span class="p">,</span> <span class="n">pval_raw</span> <span class="o">=</span> <span class="n">mk_test</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
            
            <span class="n">list_slope_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope_raw</span> <span class="o">*</span> <span class="n">factor</span><span class="p">)</span> <span class="c1"># factor previously defined as 12 months</span>
            <span class="n">list_pval_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pval_raw</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>

        <span class="c1"># Global ocean </span>
        <span class="n">list_slope_global</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_slope_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">list_pval_global</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_pval_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="c1"># High EKE regions </span>
        <span class="n">list_slope_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_slope_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">list_pval_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_pval_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Kuroshio Extension</span>
        <span class="n">list_slope_KE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_slope_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">list_pval_KE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_pval_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># Gulf Stream</span>
        <span class="n">list_slope_GS</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_slope_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">list_pval_GS</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_pval_tmp</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1993 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1994 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1995 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1996 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1997 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1998 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 1999 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2000 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2001 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2002 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2003 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2004 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2005 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2006 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2007 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2008 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2009 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2010 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2011 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2012 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------

 2013 

----------------
no ice
----------------
----------------
high EKE
----------------
----------------
KE
----------------
----------------
GS
----------------
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plotting-and-discussion-of-results">
<span id="satellite-satellite-sea-level-global-consistency-q01-section-5"></span><h3>5. Plotting and discussion of results<a class="headerlink" href="#plotting-and-discussion-of-results" title="Link to this heading">#</a></h3>
<p>Before plotting and describing the results, we define a couple of functions to customise the graphs, including both their structure and style.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_text_bars</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope</span><span class="p">,</span> <span class="n">text_style</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">text_color</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_offset_neg</span><span class="o">=</span><span class="mf">0.055</span><span class="p">):</span>
    
    <span class="n">slopes</span> <span class="o">=</span> <span class="n">list_slope</span><span class="p">[</span><span class="n">version</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slopes</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;high EKE&#39;</span> <span class="ow">and</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">)</span> \
           <span class="ow">or</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;KE&#39;</span> <span class="ow">and</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">)</span> \
           <span class="ow">or</span> <span class="p">(</span><span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;GS&#39;</span> <span class="ow">and</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;lightblue&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">text_color</span>
            
        <span class="n">y_pos</span> <span class="o">=</span> <span class="o">-</span><span class="n">y_offset_neg</span> <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">y_offset</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">test_years</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">,</span> 
                <span class="n">num</span> <span class="o">+</span> <span class="n">y_pos</span><span class="p">,</span>              
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>  
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">text_style</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span> <span class="k">if</span> <span class="n">text_style</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;normal&#39;</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        
<span class="n">x_offset</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">y_offset</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">}</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="s1">&#39;cornflowerblue&#39;</span><span class="p">}</span>
<span class="n">edges</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="s1">&#39;indianred&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="s1">&#39;royalblue&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="high-eke-regions">
<h4>High EKE regions<a class="headerlink" href="#high-eke-regions" title="Link to this heading">#</a></h4>
<p>Here, we prepare the high EKE and tropical masks as binary masks for proper visualisation. For the tropical mask, we apply ‚Äúadd_cyclic_point‚Äù to avoid discontinuity at 180¬∞ longitude. We also exclude these masks when graphing to represent only the individual high EKE regions.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define high EKE regions</span>
<span class="n">high_eke</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;high EKE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;high EKE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">notnull</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># # Define tropical region (reindexing to avoid discontinuity at 180¬∞ when plotting)</span>
<span class="n">da_trop</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;tropical&quot;</span><span class="p">)</span>
<span class="n">da_trop</span> <span class="o">=</span> <span class="n">da_trop</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">da_trop</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span>
<span class="n">lon_idx</span> <span class="o">=</span> <span class="n">da_trop</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="n">wrap_data</span><span class="p">,</span> <span class="n">wrap_lon</span> <span class="o">=</span> <span class="n">add_cyclic_point</span><span class="p">(</span><span class="n">da_trop</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">lon_idx</span><span class="p">)</span>
<span class="n">tropical</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">wrap_data</span><span class="p">,</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">da_trop</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">],</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">wrap_lon</span><span class="p">},</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>

<span class="c1"># Define a mask with only the individual high EKE regions</span>
<span class="n">keys_excluded</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no ice&#39;</span><span class="p">,</span> <span class="s1">&#39;high EKE&#39;</span><span class="p">,</span> <span class="s1">&#39;tropical&#39;</span><span class="p">]</span>
<span class="n">ds_masks</span> <span class="o">=</span> <span class="n">masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">masks</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys_excluded</span><span class="p">])</span>
<span class="n">ds_masks</span> <span class="o">=</span> <span class="n">ds_masks</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_masks</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Once the masks have been treated, we display the corresponding graphs in a layout of two subplots.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General parameters</span>
<span class="n">fig_size</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">text_size</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">+</span> <span class="mf">0.1</span>
<span class="n">vmins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">vmaxs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3000</span><span class="p">]</span>
<span class="n">extends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
<span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;plasma&#39;</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;vDT2024 mean EKE (1993-2022)&#39;</span><span class="p">]</span>
<span class="n">label_unit</span> <span class="o">=</span> <span class="s2">&quot;(cm$^2$ s$^{-2}$)&quot;</span>
<span class="n">ccrs_land</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                        <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                                        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;navajowhite&#39;</span><span class="p">,</span>
                                        <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mf">3.2</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

<span class="c1"># Mean eke (Subplot A)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">ccrs_land</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Tropical band  </span>
<span class="n">tropical</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                       <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                       <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">),</span>
                       <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="c1"># High EKE regions</span>
<span class="n">high_eke</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                           <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                           <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.13</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">),</span>
                           <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                           <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="c1"># Map mean EKE</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">eke</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="n">cmaps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="n">vmins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmaxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                 <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                            <span class="n">extend</span><span class="o">=</span><span class="n">extends</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                            <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                            <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span>
                            <span class="n">location</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">text_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">))</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label_unit</span><span class="p">,</span>
                       <span class="n">fontsize</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">text_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">),</span>
                       <span class="n">labelpad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">))</span>   

<span class="c1"># High EKE regions (Subplot B)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">180</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">ccrs_land</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">ds_masks</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>  
    <span class="n">ds_masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
        <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
    
    <span class="n">masked_data</span> <span class="o">=</span> <span class="n">ds_masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_masks</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">centroid_lon</span> <span class="o">=</span> <span class="n">masked_data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">centroid_lat</span> <span class="o">=</span> <span class="n">masked_data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;AC&#39;</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">masked_data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> 
                        <span class="n">masked_data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> 
                        <span class="n">region</span><span class="p">,</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GWSE&#39;</span><span class="p">,</span> <span class="s1">&#39;BMC&#39;</span><span class="p">]:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">centroid_lon</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">centroid_lat</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  
    <span class="k">elif</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;GS&#39;</span><span class="p">:</span>   
        <span class="n">text</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">centroid_lon</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">centroid_lat</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>           
    <span class="k">elif</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;KE&#39;</span><span class="p">,</span> <span class="s1">&#39;EAC&#39;</span><span class="p">]:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">centroid_lon</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="n">centroid_lat</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>    
    <span class="k">else</span><span class="p">:</span>    
        <span class="n">text</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">centroid_lon</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="n">centroid_lat</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> 
                        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> 
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> 
                        <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
                        <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High EKE regions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">);</span>    
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/96528b6b8f6a42c79ee2f25b207bd0e77d69a93b4da3df9297c32ec28e1ba7bc.png" src="../../_images/96528b6b8f6a42c79ee2f25b207bd0e77d69a93b4da3df9297c32ec28e1ba7bc.png" />
</div>
</div>
<p>This figure shows a global map of the temporal mean EKE at each grid point over 1993-2022, using only the vDT2024 dataset. The green contours delimit the regions with high EKE activity (over the 90th percentile), and the blue line marks the tropical band. These areas contain most of the mesoscale activity, which averages zero in the remainder part of the globe.</p>
<p>In the other global map, we represent the exact high EKE regions (covering 5% of the global ocean) along with their corresponding acronyms. As a first observation, the largest regions (in terms of area) with high mesoscale activity occur in AC, KE, and GS. In contrast, LC and EAC are the smallest regions.</p>
</section>
<section id="area-weighted-mean-eke-time-series">
<h4>Area-weighted mean EKE time series<a class="headerlink" href="#area-weighted-mean-eke-time-series" title="Link to this heading">#</a></h4>
<p>In this section, we plot the EKE time series (in cm¬≤ s‚Åª¬≤) over the global ocean and the high EKE regions, including the Kuroshio Extension and the Gulf Stream, covering the altimeter period 1993 to 2022.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General parameters</span>
<span class="n">fig_size</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">text_size</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">lw</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fig_size</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span> <span class="s1">&#39;High EKE regions&#39;</span><span class="p">,</span> <span class="s1">&#39;Kuroshio Extension&#39;</span><span class="p">,</span> <span class="s1">&#39;Gulf Stream&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="global-region">
<h5>Global region<a class="headerlink" href="#global-region" title="Link to this heading">#</a></h5>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global ocean and high EKE</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span> 
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.015</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">*</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.15</span><span class="p">)</span>

    <span class="n">label</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
         <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">ts_raw_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">dic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="n">ts_roll</span> <span class="o">=</span> <span class="n">ts_roll_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">dic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="n">ts_roll</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="n">lw</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="n">lw</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;EKE (cm$^2$ s$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">*</span><span class="mf">1.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1993-01-01&#39;</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="c1"># Legend</span>
<span class="n">blue_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vDT2024&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">red_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vDT2021&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">blue_line</span><span class="p">,</span> <span class="n">red_line</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">));</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/81b337c0ce46b51feacd3081eac021d18c723ee847da091bd9d72595440d7062.png" src="../../_images/81b337c0ce46b51feacd3081eac021d18c723ee847da091bd9d72595440d7062.png" />
</div>
</div>
<p>The two subplots show the evolution of EKE in the global and high EKE regions. The color blue represents the vDT2024 version and the color red the vDT2021 version. The thinner lines show the raw (untreated) data, whilst the thicker lines indicate the data after applying an annual rolling mean. Regarding the results, notable differences are observed when comparing the two versions. For both the global ocean and high EKE regions, vDT2021 exhibits higher values throughout the entire period than vDT2024. One possible reason is the methodology used in producing each version, including the metrics, procedures, and equations implemented, resulting in more accurate data in the current version (vDT2024), as mentioned in the <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-level/vDT2024/C3S2-D312b-WP2-FDDP-SL-v3.0-202411-ATBD-of-vDT2024-v1_Final.pdf" rel="noreferrer" target="_blank">Algorithm Theoretical Basis Document</a>. For the global region, the rolling mean values are around 190-250 cm¬≤ s‚Åª¬≤ approximately. However, focusing on the high EKE regions, the values increase markedly, reaching up to 1150 cm¬≤ s‚Åª¬≤. These regions, as observed, demonstrate high mesoscale activity.</p>
</section>
<section id="mesoscale-high-activity-regions">
<h5>Mesoscale High-Activity Regions<a class="headerlink" href="#mesoscale-high-activity-regions" title="Link to this heading">#</a></h5>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Kuroshio Extension and Gulf Stream </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span> 
    <span class="n">ax_idx</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span>  
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax_idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.015</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">*</span><span class="mf">1.8</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="mf">0.15</span><span class="p">)</span>

    <span class="n">label</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">ax_idx</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                   <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">ts_raw_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">dic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="n">ts_roll</span> <span class="o">=</span> <span class="n">ts_roll_dict</span><span class="p">[</span><span class="n">version</span><span class="p">][</span><span class="n">dic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
        <span class="n">ts_roll</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="n">lw</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">])</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">fs</span><span class="o">*</span><span class="n">lw</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;EKE (cm$^2$ s$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">*</span><span class="mf">1.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1993-01-01&#39;</span><span class="p">),</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2021-12-31&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ax_idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="c1"># Legend</span>
<span class="n">blue_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vDT2024&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">red_line</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightcoral&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vDT2021&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">blue_line</span><span class="p">,</span> <span class="n">red_line</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">text_size</span><span class="o">*</span><span class="n">fs</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">));</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/8f6e185cb138a3e2523a22221612d89eb26380e6a9f51a0be83b1cc276457262.png" src="../../_images/8f6e185cb138a3e2523a22221612d89eb26380e6a9f51a0be83b1cc276457262.png" />
</div>
</div>
<p>Following <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a>, two specific areas were selected and compared: the KE and the GS. Similarly to the previous plot, we have two timeseries for each version (red for the vDT2021 and blue for the vDT2024), with the older version showing higher energy than the newer one. The difference is larger in the GS than in the KE. When we compare the energy in both areas, both versions point towards an increase in EKE in the KE. Both versions also capture the variability in the timeseries, with higher seasonal variability in the GS.</p>
</section>
</section>
<section id="eke-trends">
<h4>EKE trends<a class="headerlink" href="#eke-trends" title="Link to this heading">#</a></h4>
<p>For these plots, we first defined a specific marker and text style to distinguish non-significant trends in the bar plots. Non-significant trends are shown in italics, with oblique grey hatching.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># significance level </span>

<span class="n">mask_nonsig_global</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">mask_nonsig_highEKE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">text_style_global</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">text_style_highEKE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">mask_nonsig_KE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">mask_nonsig_GS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="n">text_style_KE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="n">text_style_GS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
    <span class="c1"># Marker (hatching) and text style (italic) for non-significant trends</span>
    <span class="c1"># Global ocean</span>
    <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">list_pval_global</span><span class="p">[</span><span class="n">version</span><span class="p">]:</span>
        <span class="n">mask_nonsig_global</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;////&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">text_style_global</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;italic&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span> 
        
    <span class="c1"># High EKE regions</span>
    <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">list_pval_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">]:</span>
        <span class="n">mask_nonsig_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;////&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">text_style_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;italic&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>

    <span class="c1"># Kuroshio Extension</span>
    <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">list_pval_KE</span><span class="p">[</span><span class="n">version</span><span class="p">]:</span>
        <span class="n">mask_nonsig_KE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;////&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">text_style_KE</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;italic&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>

    <span class="c1"># Gulf Stream</span>
    <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">list_pval_GS</span><span class="p">[</span><span class="n">version</span><span class="p">]:</span>
        <span class="n">mask_nonsig_GS</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;////&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">text_style_GS</span><span class="p">[</span><span class="n">version</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;italic&#39;</span> <span class="k">if</span> <span class="n">pval</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="s1">&#39;normal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="id1">
<h5>Global region<a class="headerlink" href="#id1" title="Link to this heading">#</a></h5>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">gs</span>  <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

<span class="c1"># Global ocean</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_global</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">mask_nonsig_global</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    
    <span class="n">add_text_bars</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_global</span><span class="p">,</span> <span class="n">text_style_global</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
                  <span class="n">version</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>  
                  <span class="n">y_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">[</span><span class="n">version</span><span class="p">])</span>    

<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EKE trends over the global ocean&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-2022&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;(cm$^2$ s$^{-2}$ y$^{-1}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">1.55</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span><span class="mi">2014</span><span class="p">)</span>

<span class="c1"># High EKE regions</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;hatch.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">mask_nonsig_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    
    <span class="n">add_text_bars</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_highEKE</span><span class="p">,</span> <span class="n">text_style_highEKE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
                  <span class="n">version</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>  
                  <span class="n">y_offset</span><span class="o">=</span><span class="n">y_offset</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
                  <span class="n">region</span><span class="o">=</span><span class="s1">&#39;high EKE&#39;</span><span class="p">,</span> <span class="n">y_offset_neg</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>      
    
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EKE trends over high EKE regions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-2022&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;(cm$^2$ s$^{-2}$ y$^{-1}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span><span class="mi">2014</span><span class="p">)</span>

<span class="c1"># Legend</span>
<span class="n">colors_legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;vdt2024&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">]]</span>
<span class="n">categories_legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vDT2024&#39;</span><span class="p">,</span> <span class="s1">&#39;vDT2021&#39;</span><span class="p">]</span>
<span class="n">legend_patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">category</span><span class="p">)</span> 
                  <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors_legend</span><span class="p">,</span> <span class="n">categories_legend</span><span class="p">)]</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d43295f286de49f43bd44025a87fd2540b3bf5a7f8fbf8c0e589e9168973da30.png" src="../../_images/d43295f286de49f43bd44025a87fd2540b3bf5a7f8fbf8c0e589e9168973da30.png" />
</div>
</div>
<p>In this case, we can observe the EKE trends over different periods, progressively shortening the intervals to study the trends. For the global ocean, the trends are larger over shorter timescales, reaching a maximum trend of 0.87 cm¬≤ s‚Åª¬≤ year‚Åª¬π (vDT2024) and 1.14 cm¬≤ s‚Åª¬≤ year‚Åª¬π (vDT2021) from 2012 to 2022. Looking in more detail, the initial trends computed with a starting year prior to 2000 show a slight decrease, resulting in non-significant trends for both datasets and even negative trends in the case of vDT2024, for which, if we consider the whole period, the EKE trend is not significant (whereas it is for vDT2021). This behaviour changes drastically after 2000, with a constant increase, revealing an intensification of the mesoscale activity globally.</p>
<p>For the high EKE regions, we can clearly see a substantial increase throughout the full period for both datasets. In this case, all trends are significant, although vDT2021 displays larger values than vDT2024. For the older version, the trend over 2012-2022 is 6.1 times larger than the trend during 1993-2022, increasing from 2.58 cm¬≤ s‚Åª¬≤ year‚Åª¬π to 15.75 cm¬≤ s‚Åª¬≤ year‚Åª¬π. However, for the latest version, the trend is 6.5 times larger, from 2.29 cm¬≤ s‚Åª¬≤ year‚Åª¬π to 14.89 cm¬≤ s‚Åª¬≤ year‚Åª¬π. This suggests that over the last two decades, EKE activity has become stronger and more energetic, especially in the high EKE regions, with a particularly high rate of increase in the most recent periods.</p>
<p>In <a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a>, the vDT2021 all-sat product from CMEMS is used to compare with the vDT2021 two-sat product from C3S. That study suggests that differences in trends between the two products are partly related to the number of satellites included in the all-sat product.</p>
</section>
<section id="id2">
<h5>Mesoscale High-Activity Regions<a class="headerlink" href="#id2" title="Link to this heading">#</a></h5>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">gs</span>  <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>

<span class="c1"># Kuroshio Extension</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_KE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">mask_nonsig_KE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    
    <span class="n">y_off</span> <span class="o">=</span> <span class="n">y_offset</span><span class="p">[</span><span class="n">version</span><span class="p">]</span>        
    <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">:</span>
        <span class="n">y_off</span> <span class="o">-=</span> <span class="mi">2</span>        

    <span class="n">add_text_bars</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_KE</span><span class="p">,</span> <span class="n">text_style_KE</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
                   <span class="n">version</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> 
                   <span class="n">y_offset</span><span class="o">=</span><span class="n">y_off</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
                   <span class="n">region</span><span class="o">=</span><span class="s1">&#39;KE&#39;</span><span class="p">,</span> <span class="n">y_offset_neg</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>   

<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EKE trends over the Kuroshio Extension&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-2022&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;(cm$^2$ s$^{-2}$ y$^{-1}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span><span class="mi">2014</span><span class="p">)</span>

<span class="c1"># Gulf Stream</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">,</span> <span class="s1">&#39;vdt2024&#39;</span><span class="p">]:</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_GS</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edges</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
            <span class="n">hatch</span><span class="o">=</span><span class="n">mask_nonsig_GS</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
    
    <span class="n">add_text_bars</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">test_years</span><span class="p">,</span> <span class="n">list_slope_GS</span><span class="p">,</span> <span class="n">text_style_GS</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
        <span class="n">version</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> 
        <span class="n">y_offset</span><span class="o">=</span><span class="n">y_offset</span><span class="p">[</span><span class="n">version</span><span class="p">],</span> <span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">[</span><span class="n">version</span><span class="p">],</span>
        <span class="n">region</span><span class="o">=</span><span class="s1">&#39;GS&#39;</span>                  
    <span class="p">)</span>
    
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EKE trends over the Gulf Stream&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-2022&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">test_years</span><span class="p">[::</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;(cm$^2$ s$^{-2}$ y$^{-1}$)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span><span class="mi">2014</span><span class="p">)</span>

<span class="c1"># Legend</span>
<span class="n">colors_legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="s1">&#39;vdt2024&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="p">[</span><span class="s1">&#39;vdt2021&#39;</span><span class="p">]]</span>
<span class="n">categories_legend</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vDT2024&#39;</span><span class="p">,</span> <span class="s1">&#39;vDT2021&#39;</span><span class="p">]</span>
<span class="n">legend_patches</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">category</span><span class="p">)</span> 
                  <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors_legend</span><span class="p">,</span> <span class="n">categories_legend</span><span class="p">)]</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ab0104f377be08cad3a917258d8b737e7eca41671f4cb2b32523e09e78cf03d1.png" src="../../_images/ab0104f377be08cad3a917258d8b737e7eca41671f4cb2b32523e09e78cf03d1.png" />
</div>
</div>
<p>Here, we focus on the regions where the mesoscale activity exhibits more significant positive EKE trends. This intensification is concentrated mainly in the Kuroshio Extension (KE) and the Gulf Stream (GS). Regarding the KE region, the computed trends show a progressive increase for both datasets. The vDT2021 presents higher values than vDT2024, but these differences are small compared with the other regions. Only the trend over 1999-2022 is not statistically significant for either version. As mentioned before, this fast increase occurs primarily in the last decade. For the period 2013-2022, the EKE trend for vDT2024 is 61.65 cm¬≤ s‚Åª¬≤ year‚Åª¬π and for vDT2021 is 61.99 cm¬≤ s‚Åª¬≤ year‚Åª¬π, while over the entire 30-year period the trends are 8.23 cm¬≤ s‚Åª¬≤ year‚Åª¬π and 8.69 cm¬≤ s‚Åª¬≤ year‚Åª¬π, respectively. This region is crucial for ocean circulation and mid-latitudes air-sea interactions and is one of the major western boundary currents <a class="reference external" href="https://doi.org/10.1016/j.dynatmoce.2024.101497" rel="noreferrer" target="_blank">[18]</a>. As reported by <a class="reference external" href="https://doi.org/10.1007/s10236-023-01565-9" rel="noreferrer" target="_blank">[19]</a>, the decadal variability of EKE in this region is linked to the Pacific Decadal Oscillation (PDO).</p>
<p>In the Gulf Stream (GS), the general trend shows a gradual increase. Over the 30 years, the EKE trends are 2.12 cm¬≤ s‚Åª¬≤ year‚Åª¬π for vDT2024 and 2.51 cm¬≤ s‚Åª¬≤ year‚Åª¬π for vDT2021, both of which are statistically non-significant. In the most recent decade, the trends have increased notably, reaching 18.09 cm¬≤ s‚Åª¬≤ year‚Åª¬π and 20.33 cm¬≤ s‚Åª¬≤ year‚Åª¬π, respectively. This corresponds to an increase in the EKE trend of 8.5 and 8.1 times faster than over the entire 30-year period. The GS plays an important role due to its contribution to the Atlantic Meridional Overturning Circulation (AMOC) <a class="reference external" href="https://doi.org/10.1002/2015RG000493" rel="noreferrer" target="_blank">[20]</a>. <a class="reference external" href="https://doi.org/10.1175/2010JCLI3310.1" rel="noreferrer" target="_blank">[21]</a> reported that the path of the GS is associated with the strength of the AMOC.</p>
</section>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a> Barcel√≥-Llull, B., Rossell√≥, P., Combes, V., S√°nchez-Rom√°n, A., Pujol, M. I., and Pascual, A. (2025). Kuroshio Extension and Gulf Stream dominate the Eddy Kinetic Energy intensification observed in the global ocean. Scientific Reports, 15(1), 21754. doi: 10.1038/s41598-025-06149-9</p></li>
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-level-global?tab=overview" rel="noreferrer" target="_blank">CDS entry</a>: Sea level gridded data from satellite observations for the global ocean from 1993 to present.</p></li>
<li><p>All the documentation for each version is available <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-level-global?tab=documentation" rel="noreferrer" target="_blank">here</a>.</p></li>
</ul>
<p>Further information:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a>.</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1146/annurev.fluid.40.111406.102139" rel="noreferrer" target="_blank">[1]</a> Ferrari, R., &amp; Wunsch, C. (2009). Ocean circulation kinetic energy: Reservoirs, sources, and sinks. Annual Review of Fluid Mechanics, 41(1), 253-282. doi: 10.1146/annurev.fluid.40.111406.102139</p>
<p><a class="reference external" href="https://doi.org/10.1126/sciadv.aax7727" rel="noreferrer" target="_blank">[2]</a> Hu, S., Sprintall, J., Guan, C., McPhaden, M. J., Wang, F., Hu, D., &amp; Cai, W. (2020). Deep-reaching acceleration of global mean ocean circulation over the past two decades. Science advances, 6(6), eaax7727. doi: 10.1126/sciadv.aax7727</p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0485%281998%29028%3C0433:GVOTFB%3E2.0.CO;2" rel="noreferrer" target="_blank">[3]</a> Chelton, D. B., DeSzoeke, R. A., Schlax, M. G., El Naggar, K., &amp; Siwertz, N. (1998). Geographical variability of the first baroclinic Rossby radius of deformation. Journal of Physical Oceanography, 28(3), 433-460. doi: 10.1175/1520-0485(1998)028&lt;0433:GVOTFB&gt;<a class="reference external" href="http://2.0.CO" rel="noreferrer" target="_blank">2.0.CO</a>;2</p>
<p><a class="reference external" href="https://doi.org/10.1029/2005GL024633" rel="noreferrer" target="_blank">[4]</a> Pascual, A., Faug√®re, Y., Larnicol, G., &amp; Le Traon, P. Y. (2006). Improved description of the ocean mesoscale variability by combining four satellite altimeters. Geophysical Research Letters, 33(2). doi: 10.1029/2005GL024633</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41598-025-06149-9" rel="noreferrer" target="_blank">[5]</a> Barcel√≥-Llull, B., Rossell√≥, P., Combes, V., S√°nchez-Rom√°n, A., Pujol, M. I., &amp; Pascual, A. (2025). Kuroshio Extension and Gulf Stream dominate the Eddy Kinetic Energy intensification observed in the global ocean. Scientific Reports, 15(1), 21754. doi: 10.1038/s41598-025-06149-9</p>
<p><a class="reference external" href="https://doi.org/10.1029/2007GL030812" rel="noreferrer" target="_blank">[6]</a> Chelton, D. B., Schlax, M. G., Samelson, R. M., &amp; de Szoeke, R. A. (2007). Global observations of large oceanic eddies. Geophysical Research Letters, 34(15). doi: 10.1029/2007GL030812</p>
<p><a class="reference external" href="https://doi.org/10.1175/JTECH-D-17-0010.1" rel="noreferrer" target="_blank">[7]</a> Le Vu, B., Stegner, A., &amp; Arsouze, T. (2018). Angular momentum eddy detection and tracking algorithm (AMEDA) and its application to coastal eddy formation. Journal of Atmospheric and Oceanic Technology, 35(4), 739-762. doi: 10.1175/JTECH-D-17-0010.1</p>
<p><a class="reference external" href="https://doi.org/10.3389/fmars.2019.00703" rel="noreferrer" target="_blank">[8]</a> Amores, A., Jord√†, G., &amp; Monserrat, S. (2019). Ocean eddies in the Mediterranean Sea from satellite altimetry: Sensitivity to satellite track location. Frontiers in Marine Science, 6, 703. doi: 10.3389/fmars.2019.00703</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.asr.2021.01.022" rel="noreferrer" target="_blank">[9]</a> Abdalla, S., Kolahchi, A. A., Ablain, M., Adusumilli, S., Bhowmick, S. A., Alou-Font, E., ‚Ä¶ &amp; Hamon, M. (2021). Altimetry for the future: Building on 25 years of progress. Advances in Space Research, 68(2), 319-363. doi: 10.1016/j.asr.2021.01.022</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.asr.2011.09.033" rel="noreferrer" target="_blank">[10]</a> Morrow, R., &amp; Le Traon, P. Y. (2012). Recent advances in observing mesoscale ocean dynamics with satellite altimetry. Advances in Space Research, 50(8), 1062-1076. doi: 10.1016/j.asr.2011.09.033</p>
<p><a class="reference external" href="https://doi.org/10.5194/egusphere-2025-4651" rel="noreferrer" target="_blank">[11]</a> Hargous, P., Combes, V., Barcel√≥-Llull, B., &amp; Pascual, A. (2025). Eddy Kinetic Energy Variability From 30 Years of Altimetry in the Mediterranean Sea. EGUsphere, 2025, 1-22. doi: 10.5194/egusphere-2025-4651</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41558-021-01006-9" rel="noreferrer" target="_blank">[12]</a> Mart√≠nez-Moreno, J., Hogg, A. M., England, M. H., Constantinou, N. C., Kiss, A. E., &amp; Morrison, A. K. (2021). Global changes in oceanic mesoscale currents over the satellite altimetry record. Nature Climate Change, 11(5), 397-403. doi: 10.1038/s41558-021-01006-9</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10712-023-09778-9" rel="noreferrer" target="_blank">[13]</a> Morrow, R., Fu, L. L., Rio, M. H., Ray, R., Prandi, P., Le Traon, P. Y., &amp; Benveniste, J. (2023). Ocean circulation from space. Surveys in Geophysics, 44(5), 1243-1286. doi: 10.1007/s10712-023-09778-9</p>
<p><a class="reference external" href="https://doi.org/10.1038/NCLIMATE2635" rel="noreferrer" target="_blank">[14]</a> Watson, C. S., White, N. J., Church, J. A., King, M. A., Burgette, R. J., &amp; Legresy, B. (2015). Unabated global mean sea-level rise over the satellite altimeter era. Nature Climate Change, 5(6), 565-568. doi: 10.1038/NCLIMATE2635</p>
<p><a class="reference external" href="https://doi.org/10.1029/2011JC007367" rel="noreferrer" target="_blank">[15]</a> Arbic, B. K., Scott, R. B., Chelton, D. B., Richman, J. G., &amp; Shriver, J. F. (2012). Effects of stencil width on surface ocean geostrophic velocity and vorticity estimation from gridded satellite altimeter data. Journal of Geophysical Research: Oceans, 117(C3). doi: 10.1029/2011JC007367</p>
<p><a class="reference external" href="https://doi.org/10.1029/1999JC900197" rel="noreferrer" target="_blank">[16]</a> Lagerloef, G. S., Mitchum, G. T., Lukas, R. B., &amp; Niiler, P. P. (1999). Tropical Pacific near‚Äêsurface currents estimated from altimeter, wind, and drifter data. Journal of Geophysical Research: Oceans, 104(C10), 23313-23326. doi: 10.1029/1999JC900197</p>
<p><a class="reference external" href="https://doi.org/10.1023/B:WARM.0000043140.61082.60" rel="noreferrer" target="_blank">[17]</a> Yue, S., &amp; Wang, C. (2004). The Mann-Kendall test modified by effective sample size to detect trend in serially correlated hydrological series. Water resources management, 18(3), 201-218. doi: 10.1023/B:WARM.0000043140.61082.60</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.dynatmoce.2024.101497" rel="noreferrer" target="_blank">[18]</a> Xiaodong, M., Lei, Z., Weishuai, X., Qinghong, L., &amp; Maolin, L. (2024). Analysis and prediction of mesoscale eddy kinetic energy variations in the Kuroshio extension. Dynamics of Atmospheres and Oceans, 108, 101497. doi: 10.1016/j.dynatmoce.2024.101497</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10236-023-01565-9" rel="noreferrer" target="_blank">[19]</a> Yang, C., Yang, H., Chen, Z., Gan, B., Liu, Y., &amp; Wu, L. (2023). Seasonal variability of eddy characteristics and energetics in the Kuroshio Extension. Ocean Dynamics, 73(8), 531-544. doi: 10.1007/s10236-023-01565-9</p>
<p><a class="reference external" href="https://doi.org/10.1002/2015RG000493" rel="noreferrer" target="_blank">[20]</a> Buckley, M. W., &amp; Marshall, J. (2016). Observations, inferences, and mechanisms of the Atlantic Meridional Overturning Circulation: A review. Reviews of Geophysics, 54(1), 5-63. doi: 10.1002/2015RG000493</p>
<p><a class="reference external" href="https://doi.org/10.1175/2010JCLI3310.1" rel="noreferrer" target="_blank">[21]</a> Joyce, T. M., &amp; Zhang, R. (2010). On the path of the Gulf Stream and the Atlantic meridional overturning circulation. Journal of Climate, 23(11), 3146-3154. doi: 10.1175/2010JCLI3310.1</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Ocean"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ocean.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
    </a>
    <a class="right-next"
       href="../../In_Situ/insitu.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Insitu Observations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-evaluation-of-long-term-eddy-kinetic-energy-trends">üåç Use case: Evaluation of long-term Eddy Kinetic Energy trends</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">‚ùì Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection-and-setup">1. Data selection and setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-startup-parameters">Define startup parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-request-for-satellite-altimetry-vdt2021-and-vdt2024">Define data request for satellite altimetry (vDT2021 and vDT2024)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eddy-kinetic-energy-eke-computation">2. Eddy Kinetic Energy (EKE) computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-high-eke-regions">3. Definition of high EKE regions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eke-time-series-and-trends-computation">4. EKE time series and trends computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-and-discussion-of-results">5. Plotting and discussion of results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-eke-regions">High EKE regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#area-weighted-mean-eke-time-series">Area-weighted mean EKE time series</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#global-region">Global region</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#mesoscale-high-activity-regions">Mesoscale High-Activity Regions</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#eke-trends">EKE trends</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Global region</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Mesoscale High-Activity Regions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>