
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.5.1. Assessing Lake Titicaca‚Äôs Water Levels in Support of Water Management &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_completeness_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.6. Ocean" href="../Ocean/Ocean.html" />
    <link rel="prev" title="1.5. Land Hydrology" href="Land_Hydrology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Land_Hydrology.html">1.5. Land Hydrology</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.5.1. Assessing Lake Titicaca‚Äôs Water Levels in Support of Water Management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_completeness_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_completeness_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Assessing Lake Titicaca‚Äôs Water Levels in Support of Water Management</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-utilizing-satellite-altimetry-to-support-integrated-water-resources-management-in-the-titicacadesaguaderopooposalar-de-coipasa-tdps-system">üåç Use case: Utilizing satellite altimetry to support integrated water resources management in the Titicaca‚ÄìDesaguadero‚ÄìPoop√≥‚ÄìSalar de Coipasa (TDPS) System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and Download Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import Packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-data-request">Set Data Request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-resolution-completeness">2. Temporal Resolution Completeness</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pqar-performance-indicators">PQAR Performance Indicators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#records-per-month">Records per month</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#satellite-missions-over-time">Satellite missions over time</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iwrm-applications">3. IWRM applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detect-seasonality-and-extreme-events">Detect seasonality and extreme events</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-enso">Relation to ENSO</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applicability-for-other-lakes">4. Applicability for other lakes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="assessing-lake-titicacas-water-levels-in-support-of-water-management">
<h1><span class="section-number">1.5.1. </span>Assessing Lake Titicaca‚Äôs Water Levels in Support of Water Management<a class="headerlink" href="#assessing-lake-titicacas-water-levels-in-support-of-water-management" title="Link to this heading">#</a></h1>
<p>Production date: 28-05-2025</p>
<p>Produced by: Amaya Camila Trigoso Barrientos (VUB)</p>
<section id="use-case-utilizing-satellite-altimetry-to-support-integrated-water-resources-management-in-the-titicacadesaguaderopooposalar-de-coipasa-tdps-system">
<h2>üåç Use case: Utilizing satellite altimetry to support integrated water resources management in the Titicaca‚ÄìDesaguadero‚ÄìPoop√≥‚ÄìSalar de Coipasa (TDPS) System<a class="headerlink" href="#use-case-utilizing-satellite-altimetry-to-support-integrated-water-resources-management-in-the-titicacadesaguaderopooposalar-de-coipasa-tdps-system" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question-s">
<h2>‚ùì Quality assessment question(s)<a class="headerlink" href="#quality-assessment-question-s" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the temporal completeness of the satellite-derived lake later level dataset for Lake Titicaca sufficient to support water resources management in the Titicaca‚ÄìDesaguadero‚ÄìPoop√≥‚ÄìSalar de Coipasa (TDPS) System?</strong></p></li>
</ul>
<p>The <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-lake-water-level?tab=overview">satellite-lake-water-level</a> (C3S-LWL v5.0) dataset provides long-term water level observations for numerous lakes worldwide. The Climate Data Record (CDR) of the C3S-LWL v5.0 dataset is updated annually. The dataset provides at least 10 years of temporal coverage. However, the specific temporal coverage and average time step vary by lake (time steps are irregular). The dataset provides one value of water level per time step. Interim Climate Data Records (ICDRs) are not yet available for this dataset.</p>
<p>This dataset can be useful for Integrated Water Resources Management (IWRM) applications such as understanding lake responses to seasonal dynamics, climate variability, and long-term climate change-factors which directly influence water availability for ecosystems and dependent human populations. To illustrate the potential applicability of the dataset, Lake Titicaca was selected as a case study. The lake forms part of the Titicaca‚ÄìDesaguadero‚ÄìPoop√≥‚ÄìSalar de Coipasa (TDPS) hydrological system, which spans Peru and Bolivia. This system provides critical freshwater resources to millions of people, supporting agriculture, domestic use, and ecosystem services across the Altiplano. Lake Titicaca feeds the Desaguadero River, which flows into Lake Poop√≥. This hydrological system is complex and subject to multiple drivers (e.g., climate variability, land use change, population growth), which exert pressures on water availability and quality. These pressures affect the state of the system, such as lake levels, which in turn have impacts on ecosystems and human livelihoods <a class="reference external" href="https://doi.org/10.3390/w8040144">[1]</a> <a class="reference external" href="https://doi.org/10.1016/j.ejrh.2021.100927">[2]</a>.</p>
<p>The objective of this assessment is to examine the temporal completeness of Lake Titicaca‚Äôs water level data in the C3S-LWL v5.0 dataset and assess its relevance for supporting Integrated Water Resources Management (IWRM) in the context of the TDPS system.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The temporal completeness of the C3S‚ÄìLWL v5.0 dataset improves significantly after 2016, following the deployment of Sentinel-3A and Jason-3, and is further enhanced by the launches of Sentinel-3B (2018) and Sentinel-6A (2020).</p></li>
<li><p>For Lake Titicaca, the dataset is sufficiently complete to capture seasonal water level patterns and major hydrological extremes (floods and droughts), supporting general analysis and long-term IWRM applications.</p></li>
<li><p>The current temporal span and gaps in the dataset limit its ability to reliably detect and analyze ENSO-related effects on Titicaca lake‚Äôs water levels.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-completeness-q02-section-1"><span class="std std-ref">1. Request and Download Data</span></a></strong></p>
<ul class="simple">
<li><p>Download all available C3S‚ÄìLWL v5.0 satellite-lake-water-level data for Lake Titicaca.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-completeness-q02-section-2"><span class="std std-ref">2. Temporal Resolution Completeness</span></a></strong></p>
<ul class="simple">
<li><p>Calculate performance indicators related to temporal resolution: median timestep and max. timestep for different periods of time.</p></li>
<li><p>Plot the number of water level records per month across the dataset‚Äôs full temporal span.</p></li>
<li><p>Analyze the causes of data gaps and changes in data availability over time using information from the dataset‚Äôs Documentation.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-completeness-q02-section-3"><span class="std std-ref">3. IWRM applications</span></a></strong></p>
<ul class="simple">
<li><p>Plot the time series of water levels, highlighting the upper 99% and lower 1% quantiles, and indicate seasonal patterns.</p></li>
<li><p>Evaluate whether the dataset captures seasonality and extreme events, and discuss the implications for IWRM.</p></li>
<li><p>Analyze the relationship between ENSO phases and Lake Titicaca‚Äôs water levels using an approach adapted from Gutierrez-Villarreal et al. (2024) <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>, and assess whether this relationship is evident in the C3S‚ÄìLWL v5.0 dataset.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-lake-water-level-completeness-q02-section-4"><span class="std std-ref">4. Applicability for other lakes</span></a></strong></p>
<ul class="simple">
<li><p>Calculate the percentile ranks of Lake Titicaca across key performance indicators to assess its relative data completeness within the dataset.</p></li>
<li><p>Analyzed the suitability of the dataset for applying similar assessments to other lakes in support of IWRM.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="request-and-download-data">
<span id="satellite-satellite-lake-water-level-completeness-q02-section-1"></span><h3>1. Request and Download Data<a class="headerlink" href="#request-and-download-data" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4>Import Packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tabulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cbook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/trigoso_camila/.cdsapirc&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-data-request">
<h4>Set Data Request<a class="headerlink" href="#set-data-request" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-lake-water-level&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="s2">&quot;southern_america&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lake&quot;</span><span class="p">:</span> <span class="s2">&quot;titicaca&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1">#varname = &quot;water_surface_height_above_reference_datum&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-data">
<h4>Download Data<a class="headerlink" href="#download-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">da_all</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00,  4.27it/s]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the DataArray for water_surface_height_above_reference_datum</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">da_all</span><span class="p">[</span><span class="s2">&quot;water_surface_height_above_reference_datum&quot;</span><span class="p">]</span>

<span class="c1"># Extract the DataArray for water_surface_height_uncertainty</span>
<span class="n">da_u</span> <span class="o">=</span> <span class="n">da_all</span><span class="p">[</span><span class="s2">&quot;water_surface_height_uncertainty&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="temporal-resolution-completeness">
<span id="satellite-satellite-lake-water-level-completeness-q02-section-2"></span><h3>2. Temporal Resolution Completeness<a class="headerlink" href="#temporal-resolution-completeness" title="Link to this heading">#</a></h3>
<section id="pqar-performance-indicators">
<h4>PQAR Performance Indicators<a class="headerlink" href="#pqar-performance-indicators" title="Link to this heading">#</a></h4>
<p>The performance indicators related to temporal resolution were calculated for the Titicaca Lake and compared to the results of the same indicators in the Product Quality Assessment Report (PQAR) for the dataset <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">[3]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate time differences</span>
<span class="n">time_diff</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>  <span class="c1"># Time differences remain in timedelta64[ns]</span>
<span class="n">median_timestep</span> <span class="o">=</span> <span class="n">time_diff</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># Convert to days</span>
<span class="n">max_timestep</span> <span class="o">=</span> <span class="n">time_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>        <span class="c1"># Convert to days</span>
<span class="n">timeseries_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># Total duration in days</span>

<span class="c1"># Subset for 2014 to 2023</span>
<span class="n">subset_da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-12-31&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Ensure subset is not empty</span>
    <span class="n">subset_time_diff</span> <span class="o">=</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All Data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Timestep (days): </span><span class="si">{</span><span class="n">median_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Timestep (days): </span><span class="si">{</span><span class="n">max_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Timeseries Duration (years): </span><span class="si">{</span><span class="n">timeseries_duration</span><span class="o">/</span><span class="mi">365</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Subset 2014-2023:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Timestep (days): </span><span class="si">{</span><span class="n">subset_median_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Timestep (days): </span><span class="si">{</span><span class="n">subset_max_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All Data:
Median Timestep (days): 28
Max Timestep (days): 142
Timeseries Duration (years): 28.5972602739726

Subset 2014-2023:
Median Timestep (days): 14
Max Timestep (days): 93
</pre></div>
</div>
</div>
</div>
<p>The integer part of the results are the same as the ones presented in the Report.</p>
</section>
<section id="records-per-month">
<h4>Records per month<a class="headerlink" href="#records-per-month" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resample to monthly frequency and count non-NaN values</span>
<span class="n">monthly_counts</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

<span class="c1"># Convert to Pandas for easier plotting</span>
<span class="n">monthly_counts_pd</span> <span class="o">=</span> <span class="n">monthly_counts</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Plot as bars</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">monthly_counts_pd</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Monthly Count of Available Data Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count of Available Values&quot;</span><span class="p">)</span>

<span class="c1"># Customize the x-axis labels to show only years</span>
<span class="n">xticks_positions</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">monthly_counts_pd</span><span class="p">),</span> <span class="mi">12</span><span class="p">)</span>  <span class="c1"># Tick at the start of each year</span>
<span class="n">xticks_labels</span> <span class="o">=</span> <span class="n">monthly_counts_pd</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span>  <span class="c1"># Format as year</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">xticks_positions</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">xticks_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/fig/completeness_titicaca.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/80133fe2b594fc9646b65cfeb558edfa3b2d511c3485795750f7eea0d8d26f04.png" src="../../_images/80133fe2b594fc9646b65cfeb558edfa3b2d511c3485795750f7eea0d8d26f04.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-completeness" style="width: 100%">
<img alt="../../_images/8905a4e6-9557-4466-8e9f-a2592f6789ee.png" src="../../_images/8905a4e6-9557-4466-8e9f-a2592f6789ee.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.1 </span><span class="caption-text">Count of values available in the CDS water level dataset per month over time.</span><a class="headerlink" href="#fig-completeness" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate time differences</span>
<span class="n">time_diff</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>  <span class="c1"># Time differences remain in timedelta64[ns]</span>
<span class="n">median_timestep</span> <span class="o">=</span> <span class="n">time_diff</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># Convert to days</span>
<span class="n">max_timestep</span> <span class="o">=</span> <span class="n">time_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>        <span class="c1"># Convert to days</span>
<span class="n">timeseries_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># Total duration in days</span>

<span class="c1"># Subset for 2014 to 2023</span>
<span class="n">subset_da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;1995-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-12-31&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Ensure subset is not empty</span>
    <span class="n">subset_time_diff</span> <span class="o">=</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="kc">None</span>
<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Subset 1995-2019:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Timestep (days): </span><span class="si">{</span><span class="n">subset_median_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Timestep (days): </span><span class="si">{</span><span class="n">subset_max_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Subset for 2014 to 2023</span>
<span class="n">subset_da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-12-31&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Ensure subset is not empty</span>
    <span class="n">subset_time_diff</span> <span class="o">=</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="n">subset_time_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">subset_da</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">subset_median_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_max_timestep</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">subset_timeseries_duration</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Subset 2020-2023:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median Timestep (days): </span><span class="si">{</span><span class="n">subset_median_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max Timestep (days): </span><span class="si">{</span><span class="n">subset_max_timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subset 1995-2019:
Median Timestep (days): 31
Max Timestep (days): 142

Subset 2020-2023:
Median Timestep (days): 12
Max Timestep (days): 93
</pre></div>
</div>
</div>
</div>
<p><a class="reference internal" href="#fig-completeness"><span class="std std-numref">Fig. 1.5.1.1</span></a> shows that for Lake Titicaca, from 1995 to 2019, there is approximately one measurement per month (median time step of 31 days). From 2020 onwards, the number of measurements per month increases to a median time step of 12 days.</p>
</section>
<section id="satellite-missions-over-time">
<h4>Satellite missions over time<a class="headerlink" href="#satellite-missions-over-time" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the satellite missions and their operational periods</span>
<span class="n">missions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;TOPEX/Poseidon&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;1992-08&quot;</span><span class="p">,</span> <span class="s2">&quot;2006-01&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Jason-1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2001-12&quot;</span><span class="p">,</span> <span class="s2">&quot;2013-07&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Envisat&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2002-03&quot;</span><span class="p">,</span> <span class="s2">&quot;2012-06&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Jason-2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2008-06&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-10&quot;</span><span class="p">),</span>
    <span class="s2">&quot;SARAL&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2013-02&quot;</span><span class="p">,</span> <span class="s2">&quot;2005&quot;</span><span class="p">),</span>
    <span class="s2">&quot;Jason-3&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2016-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2025-05&quot;</span><span class="p">),</span>  <span class="c1"># Adjust end date as needed</span>
    <span class="s2">&quot;Sentinel-3A&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2016-02&quot;</span><span class="p">,</span> <span class="s2">&quot;2025-05&quot;</span><span class="p">),</span>  <span class="c1"># Adjust end date as needed</span>
    <span class="s2">&quot;Sentinel-3B&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2018-04&quot;</span><span class="p">,</span> <span class="s2">&quot;2025-05&quot;</span><span class="p">),</span>  <span class="c1"># Adjust end date as needed</span>
    <span class="s2">&quot;Sentinel-6A&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;2020-11&quot;</span><span class="p">,</span> <span class="s2">&quot;2025-05&quot;</span><span class="p">),</span>  <span class="c1"># Adjust end date as needed</span>
<span class="p">}</span>

<span class="c1"># Convert the mission data into a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;Mission&quot;</span><span class="p">:</span> <span class="n">mission</span><span class="p">,</span> <span class="s2">&quot;Start&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end</span><span class="p">)}</span>
    <span class="k">for</span> <span class="n">mission</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">missions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">])</span>

<span class="c1"># Sort the DataFrame by start date</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Start&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Calculate durations in days</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Duration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;End&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>

<span class="c1"># Create the figure and axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
<span class="c1"># Plot the bars (same as before)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Duration&quot;</span><span class="p">],</span> <span class="n">left</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;Duration&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">idx</span><span class="p">,</span>
            <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Mission&quot;</span><span class="p">],</span>
            <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Create a range of years for ticks</span>
<span class="n">start_year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">end_year</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;End&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">end_year</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;YS&#39;</span><span class="p">)</span>

<span class="c1"># Set x-axis ticks to January of each year</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">years</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Enable grid for x-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Axis labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Operational Periods of Satellite Altimetry Missions&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>  <span class="c1"># Optional: Hide y-ticks if labels are in bars</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/fig/instruments.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/eb328dc3a490e93908ba410896510545b524f8dde74d6077916b118a5a7df8fc.png" src="../../_images/eb328dc3a490e93908ba410896510545b524f8dde74d6077916b118a5a7df8fc.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-missions" style="width: 100%">
<img alt="../../_images/62b16ee9-4b0e-4ef3-8d78-3583ec789ca0.png" src="../../_images/62b16ee9-4b0e-4ef3-8d78-3583ec789ca0.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.2 </span><span class="caption-text">Span of the satellite missions used to estimate water levels in the C3S‚ÄìLWL v5.0 dataset. The time periods reflect the operational availability of each mission as described in the Algorithm Theoretical Basis Document (ATBD)¬†<a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328942">[4]</a>. A correction was applied to the end year of the TOPEX/Poseidon mission to reflect its actual data availability.</span><a class="headerlink" href="#fig-missions" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>According to the PQAR, the median time step in the lake water level dataset decreases after 2016, indicating an increase in the number of recorded values. This improvement is attributed to the introduction of Sentinel-3A and Jason-3 missions, which provided more frequent overpasses with higher-quality sensors <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">[3]</a>.</p>
<p>For Lake Titicaca, this enhancement is evident post-2016, as months with two records became more common. Following the launch of Sentinel-3B and Sentinel-6A, a further increase in data frequency was observed, with most months after late 2019 containing two records, and some months even having three or four (see <a class="reference internal" href="#fig-completeness"><span class="std std-numref">Fig. 1.5.1.1</span></a>). This indicates a significant improvement in dataset completeness due to these newer missions.</p>
<p>Prior to 2016, the dataset exhibits more gaps, with several months lacking data. This can be explained by the limitations of earlier missions: TOPEX/Poseidon, Jason-1, Envisat, Jason-2, and SARAL. These missions had less precise instruments, making their measurements more susceptible to filtering. Although satellite coverage and sensor quality improved after 2016, a few gaps‚Äîsuch as those seen in 2021‚Äîmay still occur. As outlined in the Algorithm Theoretical Basis Document (ATBD), data filtering is based on two main criteria: (i) measurements with invalid (NaN) geophysical corrections, and (ii) the backscatter coefficient (sigma0), to eliminate measurements over land <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328942">[4]</a>.</p>
</section>
</section>
<section id="iwrm-applications">
<span id="satellite-satellite-lake-water-level-completeness-q02-section-3"></span><h3>3. IWRM applications<a class="headerlink" href="#iwrm-applications" title="Link to this heading">#</a></h3>
<p>Due to the characteristics of the C3S‚ÄìLWL v5.0 dataset, particularly its irregular time steps, annual updates, and lack of ICDRs, it is not well-suited for applications that require high-frequency or real-time monitoring, such as early warning systems for floods, or rapid drought response. However, its long temporal span makes it valuable for applications that benefit from historical context and trend analysis. This includes assessing interannual variability, long-term climate influences, and understanding hydrological responses to large-scale drivers such as ENSO.</p>
<section id="detect-seasonality-and-extreme-events">
<h4>Detect seasonality and extreme events<a class="headerlink" href="#detect-seasonality-and-extreme-events" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute quantiles</span>
<span class="n">da_qiles</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">])</span>

<span class="c1"># Extract April and December data</span>
<span class="n">april_values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">december_values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Convert DataArray time coordinate to a pandas datetime index</span>
<span class="n">time_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># Plot time series</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>  <span class="c1"># Set the display DPI for the figure</span>
<span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Add quantile lines with consistent color but different line styles</span>
<span class="n">quantile_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;-.&quot;</span><span class="p">]</span>
<span class="n">colors_styles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">qile</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">da_qiles</span><span class="p">,</span> <span class="n">quantile_styles</span><span class="p">,</span> <span class="n">colors_styles</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">qile</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Quantile </span><span class="si">{</span><span class="n">qile</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;quantile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.0%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Add points for April and December with subtler colors</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">april_values</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">april_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;April values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">december_values</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">december_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;December values&quot;</span><span class="p">)</span>

<span class="c1"># Remove duplicate labels in the legend</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">unique_handles_labels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>  <span class="c1"># Remove duplicates by keeping the first occurrence</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">unique_handles_labels</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">unique_handles_labels</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Add title and save plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lake </span><span class="si">{</span><span class="n">request</span><span class="p">[</span><span class="s1">&#39;lake&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2"> water level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/fig/level_timeseries_titicaca.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/b8d1caa02b655a78d6261f9f31c26f0d901c8f219310776e9f4e6744f1d36e74.png" src="../../_images/b8d1caa02b655a78d6261f9f31c26f0d901c8f219310776e9f4e6744f1d36e74.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-timeseries" style="width: 75%">
<img alt="../../_images/11de117c-b222-4ed1-9d0c-5119d3e1e724.png" src="../../_images/11de117c-b222-4ed1-9d0c-5119d3e1e724.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.3 </span><span class="caption-text">Water level in the Titicaca Lake in the period 1995-2023 according to the C3S‚ÄìLWL v5.0.</span><a class="headerlink" href="#fig-timeseries" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Seasonality:</strong> The annual cycle of rainfall over the TDPS system exhibits a marked seasonality, with a rainy season from December to March that accounts for over 75% of the annual precipitation, a dry season from May to August, and a pre-wet season from September to December <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>. Lake Titicaca‚Äôs level is primarily influenced by variations in precipitation and high evaporation rates <a class="reference external" href="https://doi.org/10.5194/hess-29-655-2025">[6]</a>. Consequently, December (just before the onset of the rainy season) typically corresponds to the lake‚Äôs lowest water level in the hydrological year, while the highest level usually occurs around April, at the end of the rainy season and the start of the dry season. This seasonal pattern is evident in <a class="reference internal" href="#fig-timeseries"><span class="std std-numref">Fig. 1.5.1.3</span></a>, which demonstrates that the dataset effectively captures seasonality despite the presence of data gaps. This information is useful for IWRM because it supports seasonal planning for water allocation, flood control, and agricultural scheduling, not only around Lake Titicaca but throughout the interconnected TDPS system. Moreover, Lake Titicaca regulates the outflow into the Desaguadero River, which in turn affects water availability downstream in Lake Poop√≥. Any significant deviation in seasonal rainfall or lake level delays can cascade through the system.</p></li>
<li><p><strong>Extreme events:</strong> <a class="reference internal" href="#fig-timeseries"><span class="std std-numref">Fig. 1.5.1.3</span></a> also shows that the time series captures extreme hydrological events. The upper 99% quantile reflects intense precipitation events that occurred in 2003 and 2004, leading to the overflow of rivers feeding into Lake Titicaca. These events caused a significant rise in the lake‚Äôs water level, leading to flooding in surrounding areas, as reported by Peruvian government agencies <a class="reference external" href="https://www.inei.gob.pe/media/MenuRecursivo/boletines/5340.pdf">[7]</a> <a class="reference external" href="https://portal.indeci.gob.pe/wp-content/uploads/2019/01/5_1_princ_emerg.pdf">[8]</a>. Conversely, the lower 1% quantile highlights the severe drought experienced in 2023 in the TDPS, which led to a substantial drop in lake levels, reaching a minimum by the end of the year <a class="reference external" href="https://www.copernicus.eu/fr/node/40141">[9]</a>. This event had system-wide consequences, in Puno (Peru) and La Paz (Bolivia), up to 80% of potato and sweet potato and 90% of Andean grains were lost due to water scarcity <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>. From an IWRM perspective, capturing and understanding these extremes is critical for investing in adapting infrastructure, and preparing multisectoral response strategies. It also underscores the need for transboundary coordination, as hydrological impacts in one part of the system inevitably propagate throughout the TDPS basin.</p></li>
</ul>
</section>
<section id="relation-to-enso">
<h4>Relation to ENSO<a class="headerlink" href="#relation-to-enso" title="Link to this heading">#</a></h4>
<p>In the TDPS region, El Ni√±o events are typically associated with drier conditions, while La Ni√±a events often bring increased rainfall, particularly during the wet season (December-March). These precipitation patterns directly influence Lake Titicaca‚Äôs hydrology. El Ni√±o years tend to reduce inflows and lower lake levels, whereas La Ni√±a years usually promote higher inflows and rising water levels. However, the 202-2023 drought illustrates that La Ni√±a can also be linked to severe dry conditions, particularly during the pre-wet season (September-November). Unlike its wet-season effects, La Ni√±a during this early period is associated with decreased precipitation, which can delay the onset of the rainy season and heighten the risk of drought. Gutierrez-Villarreal et al. (2024) explain that the 2022-23 pre-wet season was one of the driest on record, with November 2022 marking the driest month in 58 years. As a result, Lake Titicaca‚Äôs seasonal rise was significantly suppressed, its water level increased by only 0.09 meters between December and April, one of the weakest rises since 1940. Notably, the lake level even declined between December and January, a rare occurrence during a period when levels typically rise <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>.</p>
<figure class="align-default" id="fig-gutierrez" style="width: 100%">
<img alt="../../_images/6d5ef281-c7e9-41b5-aaa6-7866ca71d57e.jpg" src="../../_images/6d5ef281-c7e9-41b5-aaa6-7866ca71d57e.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.4 </span><span class="caption-text">Lake Titicaca‚Äôs geographical location and hydrograms. a) The Lake Titicaca, Desaguadero River, and Lake Poopo basins (TDPS system) boundary is delimited by a black line, and the lake area is represented by a black polygon. Red lines in the Andean cordillera denote altitudes of 3 000 m.a.s.l. Interannual increment of lake levels of b) April, c) February, and d) January, with respect to December. The dataset spans between 1914 and 2023. The purple horizontal lines represent the long-term (1914‚Äì2023) average of lake level differences. ‚Äún‚Äù refers to the calendar year. Selected El Ni√±o (La Ni√±a) years are tagged with red (blue) bars if the <a class="reference external" href="https://psl.noaa.gov/data/timeseries/month/Nino34/">El Ni√±o 3.4 index from the HadiSST</a> <a class="reference external" href="https://doi.org/10.1029/2002jd002670">[10]</a>. dataset is higher (lower) than 0.75 (‚àí0.75) during at least 4 months between October n-1 and April n. (For interpretation of the references to color in this figure legend, the reader is referred to the Web version of this article.)
Reproduced from Gutierrez-Villarreal et al. (2024), licensed under CC BY 4 <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>.</span><a class="headerlink" href="#fig-gutierrez" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The water levels used by Gutierrez-Villarreal et al. (2024) to make <a class="reference internal" href="#fig-gutierrez"><span class="std std-numref">Fig. 1.5.1.4</span></a> are monthly lake level data from 1914 to 2023, measured at the Muelle Enafer station (3,800 m a.s.l.) on the Peruvian side of Lake Titicaca, and provided by Peru‚Äôs National Meteorology and Hydrology Service (SENAMHI) <a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a>. The figure illustrates how water levels in Lake Titicaca can be a valuable indicator for analyzing the relationship between ENSO phases and extreme events in the TDPS system, an insight that is highly relevant for IWRM due to its implications for drought preparedness and long-term planning. A similar analysis was conducted here using the C3S‚ÄìLWL v5.0 dataset, to assess whether the patterns and anomalies described in the original study can also be detected with this alternative data source.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load Ni√±o 3.4 SST Index from the HadISST1.1 (https://psl.noaa.gov/data/timeseries/month/Nino34/) </span>
<span class="n">df_enso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/nino34.long.anom.csv&quot;</span><span class="p">)</span>
<span class="n">df_enso</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">df_enso</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="s1">&#39;nina34&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract April and December data</span>
<span class="n">feb_values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">jan_values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename ENSO column</span>
<span class="n">df_enso</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_enso</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">df_enso</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_enso</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mf">9999.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Function to compute differences and ENSO-colored bar data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_diffs</span><span class="p">(</span><span class="n">month_values</span><span class="p">,</span> <span class="n">dec_values</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="c1"># Mean per year</span>
    <span class="n">month_df</span> <span class="o">=</span> <span class="n">month_values</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">month_mean</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">dec_df</span> <span class="o">=</span> <span class="n">dec_values</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">dec_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">dec_mean</span> <span class="o">=</span> <span class="n">dec_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Calculate difference</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">2024</span><span class="p">):</span>  <span class="c1"># Full year range</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">month_mean</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">dec_mean</span><span class="p">:</span>
            <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">month_mean</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">dec_mean</span><span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">years</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="n">diff_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">years</span><span class="p">)</span>

    <span class="c1"># Compute ENSO-based bar colors</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">diff_series</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">-10-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-04-30&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span>
        <span class="n">nina_vals</span> <span class="o">=</span> <span class="n">df_enso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">months</span><span class="p">,</span> <span class="s1">&#39;nina34&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="n">nino_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">nina_vals</span> <span class="o">&gt;</span> <span class="mf">0.75</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">nina_count</span> <span class="o">=</span> <span class="p">(</span><span class="n">nina_vals</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">nino_count</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">nina_count</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Identify missing years</span>
    <span class="n">all_years</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1995</span><span class="p">,</span> <span class="mi">2024</span><span class="p">))</span>
    <span class="n">missing_years</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_years</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">diff_series</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">diff_series</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">missing_years</span>

<span class="c1"># Compute all three</span>
<span class="n">diff_apr</span><span class="p">,</span> <span class="n">colors_apr</span><span class="p">,</span> <span class="n">missing_apr</span> <span class="o">=</span> <span class="n">compute_diffs</span><span class="p">(</span><span class="n">april_values</span><span class="p">,</span> <span class="n">december_values</span><span class="p">,</span> <span class="s2">&quot;April&quot;</span><span class="p">)</span>
<span class="n">diff_feb</span><span class="p">,</span> <span class="n">colors_feb</span><span class="p">,</span> <span class="n">missing_feb</span> <span class="o">=</span> <span class="n">compute_diffs</span><span class="p">(</span><span class="n">feb_values</span><span class="p">,</span> <span class="n">december_values</span><span class="p">,</span> <span class="s2">&quot;February&quot;</span><span class="p">)</span>
<span class="n">diff_jan</span><span class="p">,</span> <span class="n">colors_jan</span><span class="p">,</span> <span class="n">missing_jan</span> <span class="o">=</span> <span class="n">compute_diffs</span><span class="p">(</span><span class="n">jan_values</span><span class="p">,</span> <span class="n">december_values</span><span class="p">,</span> <span class="s2">&quot;January&quot;</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_dpi</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># Set the display DPI for the figure</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> 
                                                  <span class="p">[</span><span class="n">diff_apr</span><span class="p">,</span> <span class="n">diff_feb</span><span class="p">,</span> <span class="n">diff_jan</span><span class="p">],</span>
                                                  <span class="p">[</span><span class="n">colors_apr</span><span class="p">,</span> <span class="n">colors_feb</span><span class="p">,</span> <span class="n">colors_jan</span><span class="p">],</span>
                                                  <span class="p">[</span><span class="s1">&#39;Apr(n) - Dec(n-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb(n) - Dec(n-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan(n) - Dec(n-1)&#39;</span><span class="p">])):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water Level Difference (m)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Only for the April plot, add marker and text</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mi">2023</span> <span class="ow">in</span> <span class="n">diff</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">y_val</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="mi">2023</span><span class="p">]</span>
        <span class="c1"># Horizontal line from y-axis to the bar at y_val</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_val</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">1994.5</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">2023</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="c1"># Add text above the 2023 bar</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">m&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Shared x-label</span>
<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Legend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Patch</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;El Ni√±o&#39;</span><span class="p">),</span>
                   <span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;La Ni√±a&#39;</span><span class="p">),</span>
                   <span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Neutral&#39;</span><span class="p">)]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/fig/dif_level_enso.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>  <span class="c1"># Save as PNG</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<img alt="../../_images/2ec4c37c925b2a070a98eec0374cf9fd2725a113ce5bd90074d6fbd53d15849b.png" src="../../_images/2ec4c37c925b2a070a98eec0374cf9fd2725a113ce5bd90074d6fbd53d15849b.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-enso" style="width: 100%">
<img alt="../../_images/ff4a1917-c803-4551-be24-ee5e6b4db0ca.png" src="../../_images/ff4a1917-c803-4551-be24-ee5e6b4db0ca.png" />
<figcaption>
<p><span class="caption-number">Fig. 1.5.1.5 </span><span class="caption-text">Yearly differences between water levels of the Titicaca Lake form the C3S-LWL v5.0 dataset in April, February, and January of year <em>n</em> and December of year <em>n-1</em>, for the period 1995-2023. Bars are color-coded based on ENSO conditions between October <em>n-1</em> and April <em>n</em>: red for El Ni√±o years (‚â• 4 months with Ni√±o 3.4 index &gt; 0.75), blue for La Ni√±a years (‚â• 4 months with index &lt; ‚àí0.75), and gray for neutral years. Missing bars indicate years where data was unavailable for the respective months.</span><a class="headerlink" href="#fig-enso" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print missing years for each</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing years (no data for Apr(n) or Dec(n-1)):&quot;</span><span class="p">,</span> <span class="n">missing_apr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing years (no data for Feb(n) or Dec(n-1)):&quot;</span><span class="p">,</span> <span class="n">missing_feb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing years (no data for Jan(n) or Dec(n-1)):&quot;</span><span class="p">,</span> <span class="n">missing_jan</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing years (no data for Apr(n) or Dec(n-1)): [1995, 1999, 2000, 2011, 2012, 2013, 2014]
Missing years (no data for Feb(n) or Dec(n-1)): [1995, 1996, 2000, 2007, 2011, 2013, 2014, 2022]
Missing years (no data for Jan(n) or Dec(n-1)): [1995, 1998, 2000, 2011, 2013, 2014]
</pre></div>
</div>
</div>
</div>
<p>In <a class="reference internal" href="#fig-gutierrez"><span class="std std-numref">Fig. 1.5.1.4</span></a>, it can be observed that the blue bars representing La Ni√±a years are generally taller than the red bars that represent El Ni√±o years. This suggests that water level gains during the wet season tend to be greater during La Ni√±a years. Such a trend is clearly visible thanks to the extensive temporal coverage of the SENAMHI dataset, which spans more than 100 years. In contrast, this pattern is not noticeable on <a class="reference internal" href="#fig-enso"><span class="std std-numref">Fig. 1.5.1.5</span></a>, which uses the C3S-LWL v5.0 dataset. This is likely due to the shorter time span of the C3S dataset and the presence of data gaps, resulting in missing values for several years.</p>
<p>Additionally, some inconsistencies between the two figures can be noted. For instance, in 2012, <a class="reference internal" href="#fig-enso"><span class="std std-numref">Fig. 1.5.1.5</span></a> shows slightly negative differences for both Jan(<em>n</em>)-Dec(<em>n-1</em>) and Feb(<em>n</em>)-Dec(<em>n-1</em>), while according to the SENAMHI dataset (see <a class="reference internal" href="#fig-gutierrez"><span class="std std-numref">Fig. 1.5.1.4</span></a>) these differences as clearly positive. This discrepancy indicates that the C3S-LWL v5.0 dataset may not be sufficiently accurate for these types of analysis, especially prior to 2016. As mentioned earlier, satellite instrument quality and measurement accuracy have improved significantly since 2016, which may explain some of the observed inconsistencies.</p>
<p>Despite these limitations, the C3S-LWL v5.0 dataset successfully captures the small negative difference in Jan(<em>n</em>)-Dec(<em>n-1</em>) for the year 2023, as well as the anomalously weak water level increase during the 2022-2023 wet season (see {numref}fig-enso). However, according to the C3S-LWL v5.0 dataset, the rise was 0.17 m, while the SENAMHI dataset recorded a lower value of 0.09 m. Although not identical, this similarity suggests that the C3S-LWL v5.0 dataset has some utility in identifying recent anomalies, even if it is not yet robust enough for long-term ENSO-related hydrological analysis in Lake Titicaca.</p>
</section>
</section>
<section id="applicability-for-other-lakes">
<span id="satellite-satellite-lake-water-level-completeness-q02-section-4"></span><h3>4. Applicability for other lakes<a class="headerlink" href="#applicability-for-other-lakes" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load PQAR table</span>
<span class="n">df_pqar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/data/wp5/trigoso_camila/LakeWaterLevel/PQAR.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pqar</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Unnamed: 0&quot;</span><span class="p">:</span> <span class="s2">&quot;Lake name&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_pqar</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lake name</th>
      <th>Dispersion 1992-2023 (cm)</th>
      <th>High Frequency variation 1992-2023 (cm)</th>
      <th>Median Timestep 1992-2023 (days)</th>
      <th>Max Timestep 1992-2023 (days)</th>
      <th>Timeseries duration 1992-2023</th>
      <th>Dispersion 2014-2023 (cm)</th>
      <th>High Frequency variation 2014-2023 (cm)</th>
      <th>Median Timestep 2014-2023 (days)</th>
      <th>Max Timestep 2014-2023 (days)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Albert</td>
      <td>8.0</td>
      <td>3.32</td>
      <td>26.47</td>
      <td>76.81</td>
      <td>28.5</td>
      <td>6.0</td>
      <td>3.24</td>
      <td>13.00</td>
      <td>76.81</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bagre</td>
      <td>20.0</td>
      <td>8.65</td>
      <td>9.98</td>
      <td>99.01</td>
      <td>15.3</td>
      <td>18.0</td>
      <td>8.71</td>
      <td>9.98</td>
      <td>89.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bankim</td>
      <td>39.0</td>
      <td>11.03</td>
      <td>9.41</td>
      <td>50.84</td>
      <td>15.5</td>
      <td>9.0</td>
      <td>12.29</td>
      <td>9.31</td>
      <td>50.84</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bogoria</td>
      <td>13.0</td>
      <td>0.26</td>
      <td>27.00</td>
      <td>55.78</td>
      <td>7.8</td>
      <td>13.0</td>
      <td>0.26</td>
      <td>27.00</td>
      <td>55.78</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Fitri</td>
      <td>10.0</td>
      <td>0.32</td>
      <td>27.00</td>
      <td>70.00</td>
      <td>10.6</td>
      <td>10.0</td>
      <td>0.33</td>
      <td>27.00</td>
      <td>70.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>246</th>
      <td>Sevan</td>
      <td>6.0</td>
      <td>3.40</td>
      <td>25.55</td>
      <td>124.39</td>
      <td>28.5</td>
      <td>5.0</td>
      <td>3.25</td>
      <td>6.54</td>
      <td>93.70</td>
    </tr>
    <tr>
      <th>247</th>
      <td>Srisailam</td>
      <td>68.0</td>
      <td>12.74</td>
      <td>27.00</td>
      <td>27.00</td>
      <td>4.8</td>
      <td>68.0</td>
      <td>12.74</td>
      <td>27.00</td>
      <td>27.00</td>
    </tr>
    <tr>
      <th>248</th>
      <td>Tharthar</td>
      <td>3.0</td>
      <td>18.20</td>
      <td>9.92</td>
      <td>63.87</td>
      <td>31.2</td>
      <td>2.0</td>
      <td>24.16</td>
      <td>9.92</td>
      <td>29.75</td>
    </tr>
    <tr>
      <th>249</th>
      <td>Toktogul</td>
      <td>14.0</td>
      <td>0.00</td>
      <td>34.44</td>
      <td>1006.73</td>
      <td>28.5</td>
      <td>8.0</td>
      <td>2.86</td>
      <td>27.00</td>
      <td>951.49</td>
    </tr>
    <tr>
      <th>250</th>
      <td>Van</td>
      <td>6.0</td>
      <td>3.39</td>
      <td>12.46</td>
      <td>73.00</td>
      <td>28.6</td>
      <td>5.0</td>
      <td>3.03</td>
      <td>10.00</td>
      <td>39.43</td>
    </tr>
  </tbody>
</table>
<p>251 rows √ó 10 columns</p>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the columns of interest</span>
<span class="n">columns_of_interest</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Median Timestep 1992-2023 (days)&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Max Timestep 1992-2023 (days)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Timeseries duration 1992-2023&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Median Timestep 2014-2023 (days)&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Max Timestep 2014-2023 (days)&#39;</span>
<span class="p">]</span>

<span class="c1"># Get the row for Lake Titicaca</span>
<span class="n">titicaca_row</span> <span class="o">=</span> <span class="n">df_pqar</span><span class="p">[</span><span class="n">df_pqar</span><span class="p">[</span><span class="s2">&quot;Lake name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Titicaca&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="c1"># Compute percentile ranks for Titicaca</span>
<span class="n">percentile_ranks</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns_of_interest</span><span class="p">:</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">df_pqar</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">titicaca_value</span> <span class="o">=</span> <span class="n">titicaca_row</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
    <span class="n">percentile</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">titicaca_value</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">percentile_ranks</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">percentile</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Create a DataFrame for display</span>
<span class="n">percentile_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">percentile_ranks</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Titicaca Percentile&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">percentile_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                  Titicaca Percentile
Median Timestep 1992-2023 (days)                95.22
Max Timestep 1992-2023 (days)                   76.89
Timeseries duration 1992-2023                   66.53
Median Timestep 2014-2023 (days)                45.42
Max Timestep 2014-2023 (days)                   73.31
</pre></div>
</div>
</div>
</div>
<p>Since the dataset has different median timestep, maximum timestep, and timeseries duration for each lake, it is recommended to consult Annex A: LWL Performance Indicators in the PQAR <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">3</a> for further interpretation when it comes to suitability for IWRM applications.</p>
<p>For Lake Titicaca, the median timestep for the full period (1992‚Äì2023) is among the highest, falling in the 95th percentile. This indicates that observations are relatively sparse, many other lakes have more frequent data. In the more recent period (2014‚Äì2023), Titicaca‚Äôs median timestep falls near the 45th percentile, suggesting that data coverage has improved and is closer to the dataset median.</p>
<p>The maximum timestep (which reflects the size of the largest gap in the timeseries) is in the 77th percentile for the full period, indicating that Titicaca has experienced longer gaps than most lakes. Similarly, the timeseries duration places Titicaca in the 67th percentile, meaning it has longer data coverage than average, but still not among the very longest.</p>
<p>This implies that if Lake Titicaca is considered suitable for applications like extreme event detection and seasonality analysis, then most other lakes in the dataset‚Äîmany of which have higher temporal resolution and fewer gaps‚Äîshould be equally or more suitable. However, users are encouraged to consult Annex A or rerun the code from previous sections to assess whether the temporal completeness of each individual lake meets their specific requirements.</p>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Autonomous Binational Authority of the Lake Titicaca, Desaguadero River, Lake Poop√≥, and Salar de Coipasa Hydrological System (ALT): <a class="reference external" href="https://alt-perubolivia.org/?page_id=2178">Publications IWRM-TDPS</a></p></li>
<li><p>National Meteorological and Hydrological Service of Bolivia (SENAMHI Bolivia): <a class="reference external" href="https://senamhi.gob.bo/index.php/thidrologico">Hydrological Lake Titicaca Level Reports</a></p></li>
<li><p>National Meteorological and Hydrological Service of Peru (SENAMHI Peru): <a class="reference external" href="https://www.senamhi.gob.pe/site/descarga-datos/">Download Meteorological Data</a></p></li>
<li><p>Messager, M., Lehner, B., Grill, G. et al. Estimating the volume and age of water stored in global lakes using a geo-statistical approach. Nat Commun 7, 13603 (2016). <a class="reference external" href="https://doi.org/10.1038/ncomms13603"></a></p></li>
</ul>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.3390/w8040144">[1]</a> Canedo, C., Pillco Zol√°, R., &amp; Berndtsson, R. (2016). Role of Hydrological Studies for the Development of the TDPS System. Water, 8(4), 144.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.ejrh.2021.100927">[2]</a> Lima-Quispe, N., Escobar, M., Wickel, A. J., von Kaenel, M., &amp; Purkey, D. (2021). Untangling the effects of climate variability and irrigation management on water levels in Lakes Titicaca and Poop√≥. Journal of Hydrology: Regional Studies, 37, 100927.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=428248112">[3]</a> Calmattes, B., Calassou, G., &amp; Taburet, N. (2024). LWL v5.0 and LWL-S v1.0: Product Quality Assessment Report (PQAR). ECMWF.</p>
<p><a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=425328942">[4]</a> Calmattes, B., Calassou, G., &amp; Taburet, N. (2024). LWL v5.0 and LWL-S v1.0: Algorithm Theoretical Basis Document (ATBD). ECMWF.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.wace.2024.100710">[5]</a> Gutierrez-Villarreal, R. A., Espinoza, J.-C., Lavado-Casimiro, W., Junquas, C., Molina-Carpio, J., Condom, T., &amp; Marengo, J. A. (2024). The 2022‚Äì23 drought in the South American Altiplano: ENSO effects on moisture flux in the western Amazon during the pre-wet season. Weather and Climate Extremes, 43, 100710.</p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-29-655-2025">[6]</a> Lima-Quispe, N., Ruelland, D., Rabatel, A., Lavado-Casimiro, W., &amp; Condom, T. (2025). Modeling Lake Titicaca‚Äôs water balance: The dominant roles of precipitation and evaporation. Hydrology and Earth System Sciences, 29, 655‚Äì675.</p>
<p><a class="reference external" href="https://www.inei.gob.pe/media/MenuRecursivo/boletines/5340.pdf">[7]</a> Instituto Nacional de Estad√≠stica e Inform√°tica del Per√∫ INE (2004) Estad√≠sticas Ambientales.</p>
<p><a class="reference external" href="https://portal.indeci.gob.pe/wp-content/uploads/2019/01/5_1_princ_emerg.pdf">[8]</a> Instituto Nacional de Defensa Civil del Per√∫ SINADECI (2004) COMPENDIO ESTAD√çSTICO, V SERIES CRONOL√ìGICAS Principales emergencias ocurridas en el Per√∫ durante los √∫ltimos 10 a√±os.</p>
<p><a class="reference external" href="https://www.copernicus.eu/fr/node/40141">[9]</a> Copernicus (2023) Drought in Lake Titicaca, South America.</p>
<p><a class="reference external" href="https://doi.org/10.1029/2002jd002670">[10]</a> Rayner N. A., Parker D. E., Horton E. B., Folland C. K., Alexander L. V., Rowell D. P., Kent E. C., &amp; Kaplan A. (2003) Global analyses of sea surface temperature, sea ice, and night marine air temperature since the late nineteenth century, J. Geophys. Res., 108 (D14), 4407.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Land_Hydrology"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Land_Hydrology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.5. </span>Land Hydrology</p>
      </div>
    </a>
    <a class="right-next"
       href="../Ocean/Ocean.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.6. </span>Ocean</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-utilizing-satellite-altimetry-to-support-integrated-water-resources-management-in-the-titicacadesaguaderopooposalar-de-coipasa-tdps-system">üåç Use case: Utilizing satellite altimetry to support integrated water resources management in the Titicaca‚ÄìDesaguadero‚ÄìPoop√≥‚ÄìSalar de Coipasa (TDPS) System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question-s">‚ùì Quality assessment question(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#request-and-download-data">1. Request and Download Data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">Import Packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-data-request">Set Data Request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-data">Download Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-resolution-completeness">2. Temporal Resolution Completeness</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pqar-performance-indicators">PQAR Performance Indicators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#records-per-month">Records per month</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#satellite-missions-over-time">Satellite missions over time</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iwrm-applications">3. IWRM applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#detect-seasonality-and-extreme-events">Detect seasonality and extreme events</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-enso">Relation to ENSO</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applicability-for-other-lakes">4. Applicability for other lakes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>