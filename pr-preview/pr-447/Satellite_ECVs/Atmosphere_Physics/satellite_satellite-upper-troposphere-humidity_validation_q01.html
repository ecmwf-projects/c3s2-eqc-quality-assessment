
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.1.1. Studying the influence of atmospheric circulation on upper tropospheric humidity &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmosphere_Physics/satellite_satellite-upper-troposphere-humidity_validation_q01';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2. Atmospheric Composition" href="../Atmospheric_Composition/Atmospheric_Composition.html" />
    <link rel="prev" title="1.1. Atmosphere Physics" href="Atmosphere_Physics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.1.1. Studying the influence of atmospheric circulation on upper tropospheric humidity</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmosphere_Physics/satellite_satellite-upper-troposphere-humidity_validation_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmosphere_Physics/satellite_satellite-upper-troposphere-humidity_validation_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Studying the influence of atmospheric circulation on upper tropospheric humidity</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-observing-the-moisture-content-of-the-atmosphere-and-making-the-link-with-large-scale-circulation-in-the-tropics">üåç Use case: observing the moisture content of the atmosphere and making the link with large scale circulation in the tropics.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-tropospheric-humidity">Upper Tropospheric Humidity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method">Method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages"><strong>Import packages</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters"><strong>Define parameters</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request"><strong>Set the data request</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-datasets-and-perform-space-time-aggregation">Download the datasets and perform space-time aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-and-spatial-aggregation"><strong>Temporal and spatial aggregation</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-of-unit-for-vertical-velocity"><strong>Change of unit for vertical velocity</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#organisation-of-the-data"><strong>Organisation of the data</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-the-geophysical-variables-of-interest">Overview of the geophysical variables of interest</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Upper Tropospheric Humidity</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atmospheric-vertical-velocity-at-500-hpa"><strong>Atmospheric vertical velocity at 500 hPa</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-description-of-the-results">Plot and description of the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variation-of-uth-with-the-vertical-velocity-at-500hpa">Variation of UTH with the vertical velocity at 500hPa</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="studying-the-influence-of-atmospheric-circulation-on-upper-tropospheric-humidity">
<h1><span class="section-number">1.1.1. </span>Studying the influence of atmospheric circulation on upper tropospheric humidity<a class="headerlink" href="#studying-the-influence-of-atmospheric-circulation-on-upper-tropospheric-humidity" title="Link to this heading">#</a></h1>
<p>Production date: 04-04-2025</p>
<p>Produced by: CNRS</p>
<section id="use-case-observing-the-moisture-content-of-the-atmosphere-and-making-the-link-with-large-scale-circulation-in-the-tropics">
<h2>üåç Use case: observing the moisture content of the atmosphere and making the link with large scale circulation in the tropics.<a class="headerlink" href="#use-case-observing-the-moisture-content-of-the-atmosphere-and-making-the-link-with-large-scale-circulation-in-the-tropics" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question:<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How well can satellite measurements reproduce the known relationship between large-scale circulation and upper tropospheric humidity (UTH)?</strong></p></li>
</ul>
<p>Water vapor in the mid- to upper troposphere, while representing a small fraction of the total column, has
a significant impact on the Earth‚Äôs radiative budget thanks to its radiative and thermodynamical properties.  In the tropics, the distribution of upper tropospheric humidity (UTH) is primarily controlled by large-scale transport, with influences by storm systems in the deep tropics <a class="reference external" href="https://doi.org/abs/10.1029/97GL03563" rel="noreferrer" target="_blank">[1]</a></p>
<p>The atmospheric circulation is the large-scale movement of air through the Earth‚Äôs atmosphere, driven by the uneven heating of the planet‚Äôs surface by the sun. This circulation is responsible for distributing heat and moisture around the globe, shaping weather patterns and climate.
The movement of the air masses influences the distribution of humidity in the upper troposphere. In regions where air rises, such as the  Inter Tropical Convergence Zone, moisture from the lower atmosphere is transported upward, increasing humidity in the upper troposphere.
Conversely, in regions where air sinks, the upper troposphere becomes drier.</p>
<p>This notebook aims to examine the dependency of upper tropospheric humidity on the global atmospheric circulation. Specifically, it seeks to verify if the UTH dataset can reproduce this dependency in agreement with <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>. The analysis will compare the dataset‚Äôs findings with established results to ensure consistency and reliability in representing the atmospheric dynamics.</p>
<p>The analysis is performed using the dataset <strong>Upper tropospheric humidity gridded data from 1999 to present derived from satellite observations</strong>  <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-upper-troposphere-humidity" rel="noreferrer" target="_blank">[described here]</a> available on the Climate Data Store of the Copernicus Climate Change Service.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The analysis is done with year 2001 using monthly data over the tropical regions. The UTH dataset reproduces the known relationship between the atmospheric moisture and the tropical large-scale atmospheric circulation: ascending motions moisten the upper troposphere, whereas subsiding motions dry it. The amplitude and frequency of moist and dry situations are consistent with the literature <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>.</p></li>
<li><p>The tested subset of the UTH dataset shows little month-to-month variability over the year, in agreement with the known link between atmospheric circulation regimes and UTH which is independent on the season.</p></li>
<li><p>Some slight discrepancies with the literature arise and can be explained :</p>
<ul>
<li><p>differences in the amplitude and frequency of the vertical velocity at 500hPa : the quality assessment uses ERA5 reanalyses while the literature relied on former versions of reanalysis (ERA40 and NCEP/NCAR reanalyses, see <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a> and <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>). Differences in the results may arise from differences in their horizontal resolutions, in their vertical description of the atmosphere, in the version of the assimilation system and in the atmospheric model.</p></li>
<li><p>differences in the amplitude of UTH : the retrieval method of the UTH of the CDS data record <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=288339045" rel="noreferrer" target="_blank">[see the ATBD]</a> is not strictly identical to the reference paper <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>.</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>The link between upper tropospheric humidity (UTH) and large-scale circulation is examined using only the vertical atmospheric motion in the mid-troposphere at 500hPa (noted <span class="math notranslate nohighlight">\(\omega_{500}\)</span>) available from the Climate Data Store and detailed below.</p>
<p>The UTH data over the <strong>tropics</strong> is downloaded for the full year 2001.</p>
<section id="upper-tropospheric-humidity">
<h3>Upper Tropospheric Humidity<a class="headerlink" href="#upper-tropospheric-humidity" title="Link to this heading">#</a></h3>
<p>The Upper Tropospheric Humidity (UTH) is a direct interpretation of the satellite measurements in strong water vapor absorption lines, such as those in the infra-red band at 6.2¬µm and in the micro-wave in the 183.31GHz line. Indeed, at these wavelengths, the emission to space is explained by water vapor concentration and temperature (see early studies by <a class="reference external" href="https://doi.org/10.1175/1520-0450%281988%29027%3C0889:EOTUTR%3E2.0.CO;2" rel="noreferrer" target="_blank">[4]</a> and <a class="reference external" href="https://doi.org/10.1029/93JD01283" rel="noreferrer" target="_blank">[5]</a>).
Upon some simple assumptions on the local vertical lapse rate of the troposphere and on the behaviour of the absorption spectral lines, the UTH is obtained via a log-linear equation from the satellite measurement (brightness temperature, <span class="math notranslate nohighlight">\(TB\)</span> in Kelvins):</p>
<div class="math notranslate nohighlight">
\[
  \text{ln}( \ UTH \ ) = a + b \cdot TB
  \]</div>
<p>Physically, the UTH is a vertical integration of the relative humidity, weighted by the vertical sensitivity of the measurement to water vapor distribution. It is therefore expressed in the unit of %, the S.I. unit of relative humidity, and, as such, is interpreted in the same way.</p>
<p>The computation of the regression parameters <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> is done thanks to a statistically representative dataset (see <a class="reference external" href="https://doi.org/10.1029/93JD01283" rel="noreferrer" target="_blank">[5]</a>, <a class="reference external" href="https://doi.org/10.1029/2007JD009314" rel="noreferrer" target="_blank">[6]</a>, <a class="reference external" href="https://doi.org/10.1175/2009JCLI2963.1" rel="noreferrer" target="_blank">[7]</a>, <a class="reference external" href="https://acp.copernicus.org/articles/14/11129/2014/" rel="noreferrer" target="_blank">[8]</a>), and the values depend on the definition of UTH itself. It also depends on the spectral domain (infra-red of microwave).</p>
<p>UTH may be prefered over vertically resolved relative humidity profiles, provided for example by reanalyses such as ERA5, when the vertical resolution is not a key parameter and when independence from a modeling framework is sought (<a class="reference external" href="https://acp.copernicus.org/articles/7/2489/2007/" rel="noreferrer" target="_blank">[9]</a>, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0046.1" rel="noreferrer" target="_blank">[10]</a>).</p>
</section>
<section id="method">
<h3>Method<a class="headerlink" href="#method" title="Link to this heading">#</a></h3>
<p>Both variables (UTH and <span class="math notranslate nohighlight">\(\omega_{500}\)</span>) are averaged monthly to smooth out short-term fluctuations caused by convection. The parameter <span class="math notranslate nohighlight">\(\omega_{500}\)</span> is extracted from ERA5 reanalyses (see below). ERA5 data resolution is reduced from 0.25 degree to 1 degree to match the resolution of the UTH data. After collocating the monthly values at this resolution, the UTH values are categorized into bins based on the vertical velocities. The distribution of UTH within each bin is presented as a boxplot profile, providing a clear visualization of how UTH varies with changes in vertical velocity.</p>
<p>The analysis comprises the following steps:</p>
<p><strong>1. <a class="reference internal" href="#satellite-satellite-upper-troposphere-humidity-validation-q01-data-section-1"><span class="std std-ref">Choose the parameters to use and setup code</span></a></strong></p>
<ul class="simple">
<li><p>Import the relevant packages.</p></li>
<li><p>Define the parameters of the analysis and set the dataset requests</p></li>
</ul>
<p><strong>2. <a class="reference internal" href="#satellite-satellite-upper-troposphere-humidity-validation-q01-data-section-2"><span class="std std-ref">Download the datasets and perform space-time aggregation</span></a></strong></p>
<ul class="simple">
<li><p>Download the variables of interest: Upper tropospheric Humidity is obtained from <strong>Upper tropospheric humidity gridded data from 1999 to present derived from satellite observations</strong>  <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-upper-troposphere-humidity" rel="noreferrer" target="_blank">[UTH]</a>, Vertical component of wind <span class="math notranslate nohighlight">\(\omega_{500}\)</span> is obtained from <strong>ERA5 hourly data on pressure levels from 1940 to present</strong> <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-pressure-levels?tab=overview" rel="noreferrer" target="_blank">[ERA5]</a>.</p></li>
<li><p>ERA5 <span class="math notranslate nohighlight">\(\omega_{500}\)</span> is regridded to align with the resolution of UTH and its unit is converted from hPa/s to hPa/day to be consistent with published references.</p></li>
<li><p>The datasets are colocated in space and time over the Tropics.</p></li>
<li><p>Monthly averages are used.</p></li>
</ul>
<p><strong>3. <a class="reference internal" href="#satellite-satellite-upper-troposphere-humidity-validation-q01-analysis-section-1"><span class="std std-ref">Overview of the geophysical variables of interest</span></a></strong></p>
<ul class="simple">
<li><p>Maps and histograms of UTH and <span class="math notranslate nohighlight">\(\omega_{500}\)</span> are described at the monthly scale for the whole year 2001.</p></li>
</ul>
<p><strong>4. <a class="reference internal" href="#satellite-satellite-upper-troposphere-humidity-validation-q01-plot-and-results"><span class="std std-ref">Plot and description of the results</span></a></strong></p>
<ul class="simple">
<li><p>The composite of UTH is shown as a function of <span class="math notranslate nohighlight">\(\omega_{500}\)</span>. The final results are compared with the appropriate references and the sources of differences are discussed.</p></li>
</ul>
</section>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-parameters-to-use-and-setup-code">
<span id="satellite-satellite-upper-troposphere-humidity-validation-q01-data-section-1"></span><h3>Choose the parameters to use and setup code<a class="headerlink" href="#choose-the-parameters-to-use-and-setup-code" title="Link to this heading">#</a></h3>
<section id="import-packages">
<h4><strong>Import packages</strong><a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xhistogram.xarray</span><span class="w"> </span><span class="kn">import</span> <span class="n">histogram</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> 
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/helene_brogniez/.cdsapirc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters">
<h4><strong>Define parameters</strong><a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h4>
<p>This use case is developed for one year of data (2001) and for the tropical belt, restricted to 30<span class="math notranslate nohighlight">\(^\circ\)</span>S-30<span class="math notranslate nohighlight">\(^\circ\)</span>N.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">start</span> <span class="o">=</span> <span class="s2">&quot;2001-01&quot;</span>
<span class="n">stop</span> <span class="o">=</span> <span class="s2">&quot;2001-12&quot;</span>

<span class="c1"># Region:</span>
<span class="n">lat_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
<span class="n">lat_max</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">lon_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span>
<span class="n">lon_max</span> <span class="o">=</span> <span class="mi">180</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-the-data-request">
<h4><strong>Set the data request</strong><a class="headerlink" href="#set-the-data-request" title="Link to this heading">#</a></h4>
<p>Two datasets are requested :</p>
<ul class="simple">
<li><p>Upper Tropospheric Humidity (UTH)</p></li>
<li><p>Vertical atmospheric velocity at 500hPa (<span class="math notranslate nohighlight">\(\omega_{500}\)</span>)</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># nb of years, nb of months</span>
<span class="n">requests</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;satellite-upper-troposphere-humidity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;sensor_on_satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;amsu_b_on_noaa_16&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2001&quot;</span><span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="s2">&quot;13&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="s2">&quot;17&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;19&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">,</span>
        <span class="s2">&quot;22&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;24&quot;</span><span class="p">,</span>
        <span class="s2">&quot;25&quot;</span><span class="p">,</span> <span class="s2">&quot;26&quot;</span><span class="p">,</span> <span class="s2">&quot;27&quot;</span><span class="p">,</span>
        <span class="s2">&quot;28&quot;</span><span class="p">,</span> <span class="s2">&quot;29&quot;</span><span class="p">,</span> <span class="s2">&quot;30&quot;</span><span class="p">,</span>
        <span class="s2">&quot;31&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">requests</span><span class="p">[</span><span class="s2">&quot;reanalysis-era5-pressure-levels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;reanalysis&quot;</span><span class="p">],</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vertical_velocity&quot;</span><span class="p">],</span>
    <span class="s2">&quot;pressure_level&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;500&quot;</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2001&quot;</span><span class="p">],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span>
        <span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;07&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span>
        <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="s2">&quot;13&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="s2">&quot;17&quot;</span><span class="p">,</span> <span class="s2">&quot;18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;19&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">,</span>
        <span class="s2">&quot;22&quot;</span><span class="p">,</span> <span class="s2">&quot;23&quot;</span><span class="p">,</span> <span class="s2">&quot;24&quot;</span><span class="p">,</span>
        <span class="s2">&quot;25&quot;</span><span class="p">,</span> <span class="s2">&quot;26&quot;</span><span class="p">,</span> <span class="s2">&quot;27&quot;</span><span class="p">,</span>
        <span class="s2">&quot;28&quot;</span><span class="p">,</span> <span class="s2">&quot;29&quot;</span><span class="p">,</span> <span class="s2">&quot;30&quot;</span><span class="p">,</span>
        <span class="s2">&quot;31&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;01:00&quot;</span><span class="p">,</span> <span class="s2">&quot;02:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;03:00&quot;</span><span class="p">,</span> <span class="s2">&quot;04:00&quot;</span><span class="p">,</span> <span class="s2">&quot;05:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;06:00&quot;</span><span class="p">,</span> <span class="s2">&quot;07:00&quot;</span><span class="p">,</span> <span class="s2">&quot;08:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;09:00&quot;</span><span class="p">,</span> <span class="s2">&quot;10:00&quot;</span><span class="p">,</span> <span class="s2">&quot;11:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;12:00&quot;</span><span class="p">,</span> <span class="s2">&quot;13:00&quot;</span><span class="p">,</span> <span class="s2">&quot;14:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;15:00&quot;</span><span class="p">,</span> <span class="s2">&quot;16:00&quot;</span><span class="p">,</span> <span class="s2">&quot;17:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;18:00&quot;</span><span class="p">,</span> <span class="s2">&quot;19:00&quot;</span><span class="p">,</span> <span class="s2">&quot;20:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;21:00&quot;</span><span class="p">,</span> <span class="s2">&quot;22:00&quot;</span><span class="p">,</span> <span class="s2">&quot;23:00&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;download_format&quot;</span><span class="p">:</span> <span class="s2">&quot;unarchived&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-the-datasets-and-perform-space-time-aggregation">
<span id="satellite-satellite-upper-troposphere-humidity-validation-q01-data-section-2"></span><h3>Download the datasets and perform space-time aggregation<a class="headerlink" href="#download-the-datasets-and-perform-space-time-aggregation" title="Link to this heading">#</a></h3>
<p>The datasets are now downloaded.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">collection_id</span> <span class="ow">in</span> <span class="n">requests</span> <span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">collection_id</span><span class="p">]</span> <span class="o">=</span>  <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                                    <span class="n">collection_id</span><span class="p">,</span>
                                    <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span><span class="n">request</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">lat_max</span><span class="p">,</span> <span class="n">lon_min</span><span class="p">,</span> <span class="n">lat_min</span><span class="p">,</span> <span class="n">lon_max</span><span class="p">]},</span> <span class="c1">#[N, W, S, E]</span>
                                                                 <span class="n">start</span><span class="p">,</span> 
                                                                 <span class="n">stop</span><span class="p">,</span> 
                                                                 <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
                                    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [00:06&lt;00:00,  1.73it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 12/12 [00:00&lt;00:00, 21.19it/s]
</pre></div>
</div>
</div>
</div>
<section id="temporal-and-spatial-aggregation">
<h4><strong>Temporal and spatial aggregation</strong><a class="headerlink" href="#temporal-and-spatial-aggregation" title="Link to this heading">#</a></h4>
<p>All data records are provided at different spatial and temporal resolutions :</p>
<ul class="simple">
<li><p>Upper Tropospheric Humidity : 1<span class="math notranslate nohighlight">\(^\circ\)</span> / 1-day</p></li>
<li><p>Vertical atmospheric velocity at 500hPa (<span class="math notranslate nohighlight">\(\omega_{500}\)</span>) : 0.25<span class="math notranslate nohighlight">\(^\circ\)</span> / 1-hour</p></li>
</ul>
<p>Since this is a cross-variable analysis, the study requires to process all the datasets at the same horizontal and temporal resolutions.</p>
<p>Note that for the UTH data record, two manipulations of the latitude <span class="math notranslate nohighlight">\(\times\)</span> longitude grid are done : first a reversal of the latitudes since the data is stored South-to-North (North-to-South for ERA5 <span class="math notranslate nohighlight">\(\omega_{500}\)</span>), and second a change of the longitude values since they range from 0¬∞ to 360¬∞ (-180¬∞ to 180¬∞ for ERA5 <span class="math notranslate nohighlight">\(\omega_{500}\)</span>) .</p>
<p>The common spatial aggregation is thus 1<span class="math notranslate nohighlight">\(^\circ\)</span> and the data records are processed at the monthly scale.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coarsen datasets to 1¬∞ grid / 1-month</span>
<span class="n">ds_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;satellite-upper-troposphere-humidity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">ds_uth</span>  <span class="o">=</span> <span class="n">ds_tmp</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">ds_tmp</span><span class="o">.</span><span class="n">latitude</span><span class="p">)))</span>  <span class="c1"># latitudes original stored from -90¬∞ to + 90¬∞</span>

<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">ds_uth</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span><span class="o">=</span> <span class="p">(</span><span class="n">ds_uth</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">-</span> <span class="mf">180.</span> <span class="c1"># change original 0-360 longitudes into -180 +180 longitudes</span>

<span class="n">ds_omega500</span> <span class="o">=</span> <span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;reanalysis-era5-pressure-levels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;pad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="change-of-unit-for-vertical-velocity">
<h4><strong>Change of unit for vertical velocity</strong><a class="headerlink" href="#change-of-unit-for-vertical-velocity" title="Link to this heading">#</a></h4>
<p>Most scientific studies focusing on the large-scale atmospheric circulation use <strong>hPa/day</strong> as the unit for the upward atmospheric wind (see <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>), since it offers a more meaningful unit at the considered time scale.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## from Pa/s to hPa/day</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">ds_omega500</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">36</span>

<span class="c1">## and the unit in the dataset is changed accordingly</span>
<span class="n">ds_omega500</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;hPa / day&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="organisation-of-the-data">
<h4><strong>Organisation of the data</strong><a class="headerlink" href="#organisation-of-the-data" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Creation of a dataframe that keeps also the information of each month to study the month-to-month variability</span>
<span class="n">series</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">months</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">ds_omega500</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">ds_uth</span><span class="p">[</span><span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">],</span> <span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">da</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
    <span class="c1"># sort and stack the data</span>
    <span class="n">stacked</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">))</span>
    <span class="c1"># convert into a serie</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">stacked</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># extraction of the month</span>
    <span class="n">s</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
    <span class="c1"># storage</span>
    <span class="n">series</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">months</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span>

<span class="c1"># Creation of the dataframe</span>
<span class="n">df_monthly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<span class="n">df_monthly</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">months</span><span class="o">.</span><span class="n">values</span>
<span class="c1"># Supression of missing values</span>
<span class="n">df_monthly</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="overview-of-the-geophysical-variables-of-interest">
<span id="satellite-satellite-upper-troposphere-humidity-validation-q01-analysis-section-1"></span><h3>Overview of the geophysical variables of interest<a class="headerlink" href="#overview-of-the-geophysical-variables-of-interest" title="Link to this heading">#</a></h3>
<section id="id1">
<h4><strong>Upper Tropospheric Humidity</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>The Upper Tropospheric Humidity (UTH, in %) is a single-layer geophysical variable provided by EUMETSAT on a 1¬∞<span class="math notranslate nohighlight">\(\times\)</span>1¬∞ regular grid.</p>
<p>The UTH data record of the CDS relies on measurements from the 183.31¬±1 GHz channels of the Advanced Microwave Sounding Unit-B (AMSU-B) and the Microwave Humidity Sounder (MHS) on board the NOAA- and MetOp- satellite series. The present use case analyses the AMSU-B data of the NOAA-16 satellite.</p>
<p>For the 183GHz microwave channel the UTH is retrieved under all situations, except where measurements are influenced by surface (high orography or extremely dry atmospheric conditions), or when there is a deep convective storm with large ice particules (see <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>, <a class="reference external" href="https://doi.org/10.1029/2007JD009314" rel="noreferrer" target="_blank">[6]</a>).</p>
<p>The map below shows the UTH for July 2001.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">ds_uth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()[</span><span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">],</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGnBu&quot;</span><span class="p">,</span>
    <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> 
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;UTH [%]&quot;</span>
    <span class="p">},</span>
    <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;July 2001 - monthly average&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b5b2a11b60b6bf8f85876115c2b2d47298ce8692178b1a8b98a6ff74a3e64700.png" src="../../_images/b5b2a11b60b6bf8f85876115c2b2d47298ce8692178b1a8b98a6ff74a3e64700.png" />
</div>
</div>
<p><em>Figure 1: Monthly average of UTH (in % of relative humidity) for July 2001.</em></p>
<p>As expected (see <a class="reference external" href="https://doi.org/10.1029/93JD01283" rel="noreferrer" target="_blank">[5]</a>, <a class="reference external" href="https://acp.copernicus.org/articles/14/11129/2014/" rel="noreferrer" target="_blank">[8]</a>) high UTH values are associated to monsoonal regions of strong storms that bring upward a high amount of moisture : in the Eastern Pacific, over West Africa and in the Indian Ocean and Indonesia (known as the Warm Pool).
On the other side of the UTH range, a drier atmosphere is visible in the continental desert regions, and more generally in both hemispheres, North and South of the Monsoonal regions.</p>
</section>
<section id="atmospheric-vertical-velocity-at-500-hpa">
<h4><strong>Atmospheric vertical velocity at 500 hPa</strong><a class="headerlink" href="#atmospheric-vertical-velocity-at-500-hpa" title="Link to this heading">#</a></h4>
<p>The map below shows the <span class="math notranslate nohighlight">\(\omega_{500}\)</span> for the same month of July 2001, overlayed with contours of UTH of the same month.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()))</span>

<span class="n">ds_omega500</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pressure_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;w&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span>
    <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=+</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;vertical velocity at 500hPa $</span><span class="se">\\</span><span class="s2">omega_</span><span class="si">{500}</span><span class="s2">$ [hPa/day]&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">line_c</span> <span class="o">=</span> <span class="n">ds_uth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)[</span><span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">line_c</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;July 2001 - monthly average&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;July 2001 - monthly average&#39;)
</pre></div>
</div>
<img alt="../../_images/081e8e6cafb3a016c6cc415618ce3d1e633d9f42ab6012a0a65657d6d4394f1e.png" src="../../_images/081e8e6cafb3a016c6cc415618ce3d1e633d9f42ab6012a0a65657d6d4394f1e.png" />
</div>
</div>
<p><em>Figure 2: Monthly average of the vertical velocity at 500hPa (in hPa/day) for July 2001, from the ERA5 reanalyses. The overlaid contours are UTH from Figure 1.</em></p>
<p>Negative values of <span class="math notranslate nohighlight">\(\omega_{500}\)</span> indicate ascending motions, while positive values indicate descending motions.</p>
<p>The contours of UTH, overlayed on the map, help to interpret the structures.</p>
<p>From the general atmospheric circulation, ascending motions (<span class="math notranslate nohighlight">\(\omega_{500}\)</span> &lt; 0) are regions where storms form by convection. These regions form the moist Inter-Tropical Convergence Zone (ITCZ), a region of strong convergence of the surface winds of the Hadley cells. The convective storms moisten the troposphere by bringing upward the moisture from the boundary layer.</p>
<p>Descending motions (<span class="math notranslate nohighlight">\(\omega_{500}\)</span> &gt; 0) are dry regions that are free of storm clouds and are mainly located over the subtropics (near 20¬∞S - 20¬∞S). In these subsidence regions, the air sinks and warms adiabatically without changing its water vapour content, thus decreasing the rate of relative humidity.</p>
<p>Therefore, <span class="math notranslate nohighlight">\(\omega_{500}\)</span> serves to define <strong>large-scale circulation regimes</strong>, as stated in <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>, extremely useful to decompose the dynamical structure of the tropical atmosphere and to analyze its properties (for the purpose of studying trends in precipitation <a class="reference external" href="https://doi.org/10.1256/qj.04.176" rel="noreferrer" target="_blank">[11]</a> or for the purpose of studying cloud radiative forcing <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>, among other applications). Many studies use this framework to assess global climate models (<a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>, <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>, <a class="reference external" href="https://doi.org/10.1256/qj.04.176" rel="noreferrer" target="_blank">[11]</a>).</p>
<p>The following density histogram illustrates the probability density function (PDF) of <span class="math notranslate nohighlight">\(\omega_{500}\)</span> for the full year 2001.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nb</span><span class="o">=</span><span class="mi">25</span> <span class="c1">## number of bins for the histogram</span>
<span class="n">nm</span><span class="o">=</span><span class="mi">12</span> <span class="c1">## number of months : 12 (1 year)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ds_omega500</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">pressure_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">entries</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">nb</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;skyblue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

<span class="n">pdf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
<span class="n">mean_pdf</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">## mean of monthly pdfs</span>
<span class="n">std_pdf</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">## standard deviation from monthly pdfs</span>
<span class="n">bin_centers</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">mean_pdf</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">bin_centers</span><span class="p">,</span> <span class="n">mean_pdf</span><span class="p">[</span><span class="mi">0</span><span class="p">,],</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">std_pdf</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;normalized density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;circulation regimes - $\omega_</span><span class="si">{500}</span><span class="s1">$ [hPa/day]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\o&#39;
&lt;&gt;:18: SyntaxWarning: invalid escape sequence &#39;\o&#39;
/data/wp5/.tmp/ipykernel_851463/2054132186.py:18: SyntaxWarning: invalid escape sequence &#39;\o&#39;
  plt.xlabel(&#39;circulation regimes - $\omega_{500}$ [hPa/day]&#39;)
</pre></div>
</div>
<img alt="../../_images/9f72713b63b1519ed048b69df138d9441bde2760dabd113e4addfc34fc90d2de.png" src="../../_images/9f72713b63b1519ed048b69df138d9441bde2760dabd113e4addfc34fc90d2de.png" />
</div>
</div>
<p><em>Figure 3: Probability density functions (PDF) of the monthly <span class="math notranslate nohighlight">\(\omega_{500}\)</span> for the year 2001 in the tropics (30¬∞N - 30¬∞S). Each light-blue PDF is for one given month. The red marks and vertical bars show the average PDF for year 2001 and the associated standard deviation, considered as the uncertainty, within each 10-hPa bin.</em></p>
<p>Overall the distribution of <span class="math notranslate nohighlight">\(\omega_{500}\)</span> is negatively skewed, with a peak around 20 hPa/day. This peak, compliant with <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>, shows that the tropics are dominated by a weak subsiding motion found in the subtropics and in the western parts of the ocean basins.
The negative tail reflects the magnitude of vertical motions within clouds.
The small vertical bars highlight the small temporal variability in the occurrence of each bins of <span class="math notranslate nohighlight">\(\omega_{500}\)</span> throughout the year.</p>
</section>
</section>
<section id="plot-and-description-of-the-results">
<span id="satellite-satellite-upper-troposphere-humidity-validation-q01-plot-and-results"></span><h3>Plot and description of the results<a class="headerlink" href="#plot-and-description-of-the-results" title="Link to this heading">#</a></h3>
<section id="variation-of-uth-with-the-vertical-velocity-at-500hpa">
<h4>Variation of UTH with the vertical velocity at 500hPa<a class="headerlink" href="#variation-of-uth-with-the-vertical-velocity-at-500hpa" title="Link to this heading">#</a></h4>
<p>For a given latitude<span class="math notranslate nohighlight">\(\times\)</span>longitude<span class="math notranslate nohighlight">\(\times\)</span>month the UTH is associated a value of <span class="math notranslate nohighlight">\(\omega_{500}\)</span>, defining a circulation regime, and each bin of <span class="math notranslate nohighlight">\(\omega_{500}\)</span> groups all UTH for this particular regime.</p>
<p>The entire year 2001 is considered, and month-to-month variability is presented.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">bin_centers</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">nm</span><span class="o">=</span><span class="mi">12</span> <span class="c1">## number of months : 1 year</span>
<span class="n">total_bin_means</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
    <span class="n">df_extract</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_monthly</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span>
    <span class="n">grouper</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_extract</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">)</span>
    <span class="c1">## mean within each bin</span>
    <span class="n">bin_means</span> <span class="o">=</span> <span class="n">df_extract</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">total_bin_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_means</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">df_extract</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouper</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span>
        <span class="n">subplots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">column</span><span class="o">=</span><span class="s2">&quot;uth_mean_ascend_descend&quot;</span><span class="p">,</span>
        <span class="n">showfliers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">patch_artist</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">},</span>
        <span class="n">meanprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;markeredgecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="s2">&quot;markerfacecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;markersize&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
        <span class="n">whiskerprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">},</span>
        <span class="n">capprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">},</span>
        <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span> <span class="s2">&quot;alpha&quot;</span><span class="p">:</span><span class="mf">0.3</span><span class="p">},</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;circulation regimes - $\omega_</span><span class="si">{500}</span><span class="s2">$ [hPa/day]&quot;</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;UTH [%]&quot;</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">positions</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_labels</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticklabels</span><span class="o">=</span><span class="p">[])</span>
    
<span class="n">df_total_bin_means</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">total_bin_means</span><span class="p">)</span>
<span class="n">mean_of_means</span> <span class="o">=</span> <span class="n">df_total_bin_means</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">_</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">_</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_labels</span><span class="p">)))</span>
<span class="n">_</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">bin_labels</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">mean_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mean_of_means</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">mean_val</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:25: SyntaxWarning: invalid escape sequence &#39;\o&#39;
&lt;&gt;:25: SyntaxWarning: invalid escape sequence &#39;\o&#39;
/data/wp5/.tmp/ipykernel_851463/1413871535.py:25: SyntaxWarning: invalid escape sequence &#39;\o&#39;
  xlabel=&quot;circulation regimes - $\omega_{500}$ [hPa/day]&quot;,
</pre></div>
</div>
<img alt="../../_images/b1273c4187d25cdb478009532e083b264e3f50bba6d51a0e9a9c57421df5c7da.png" src="../../_images/b1273c4187d25cdb478009532e083b264e3f50bba6d51a0e9a9c57421df5c7da.png" />
</div>
</div>
<p><em>Figure 4: Evolution of UTH upon different circulation regimes of the tropics, defined by 10-hPa bins of <span class="math notranslate nohighlight">\(\omega_{500}\)</span>, for each month of year 2001. For each bin of <span class="math notranslate nohighlight">\(\omega_{500}\)</span>, a box-and-whiskers diagram is used to show the month-to-month variability: the gray boxes are the interquartiles and the median are in grey. The green symbols represent the mean of the UTH of each bin of the given months. The red circles are the mean of the means (ie the annual mean) within each bin.</em></p>
<p>Overall the results are in agreement with Figure 1 of <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>, which associates the retrieved monthly UTH from NOAA-16 to the vertical velocity at 500hPa, but for only 2 months of data which are November and December 2001. In agreement with this study, the UTH shows a sharp transition from convergence regions to subsidence regions. The UTH value remains stable at around 20% over regions where <span class="math notranslate nohighlight">\(\omega_{500}\)</span> exceeds 30 hPa/day.</p>
<p>Figure 4 shows that there is little month-to-month variability within a given circulation regime, the largest variability being observed in the extreme ascending regimes, for <span class="math notranslate nohighlight">\(\omega_{500}\)</span> &gt; 55 hPa/day. This is essentially explained by the small occurrence of such regimes, as visible on Figure 1.</p>
<p>Caution must be taken though when comparing the occurence of circulation regimes between the present use case and the literature : the use case is based on ERA5 vertical velocity while the literature (<a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a> and <a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a>) rely on former versions of ECMWF reanalysis ERA40 (<a class="reference external" href="https://doi.org/10.1256/qj.04.176" rel="noreferrer" target="_blank">[11]</a>) and NCEP/NCAR reanalyses (<a class="reference external" href="https://doi.org/10.1175/1520-0477(1996%29077%3C0437:TNYRP%3E2.0.CO;2)" rel="noreferrer" target="_blank">[12]</a>. Therefore, differences in the present results and the literature may arise from differences in their horizontal resolutions, in their vertical description of the atmosphere, in the version of the assimilation system and in the atmospheric model</p>
<p>Here, the UTH reaches a plateau of maximum value of approximately 45-50% when upward motions reach -60 hPa/day. The reference reports slightly lower values, which still fall within the UTH distribution observed in this study. The discrepancies between these results and those presented in <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a> can arise from the following reasons:</p>
<ul>
<li><p>The retrieval method for UTH is similar, based on a simple linear equation (<a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>, <a class="reference external" href="https://doi.org/10.1175/1520-0450%281988%29027%3C0889:EOTUTR%3E2.0.CO;2" rel="noreferrer" target="_blank">[4]</a>) (see also the <strong>‚ÄúMethodology‚Äù</strong> section):</p>
<div class="math notranslate nohighlight">
\[
  \text{ln}(UTH) = a + b \cdot TB
  \]</div>
</li>
</ul>
<p>however, the regression coefficients <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> used to obtain the UTH from the TB measured by the instrument are not identical between the UTH dataset of the CDS <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=288339045" rel="noreferrer" target="_blank">[see the ATBD]</a> and the UTH of the reference paper <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>, which may explain some of the differences in the binned UTH per <span class="math notranslate nohighlight">\(\omega_{500}\)</span>. Firstly, those parameters are computed using offline radiative transfer codes that have some discrepancies in the water vapor absorption channels (see for instance [<a class="reference external" href="https://journals.ametsoc.org/view/journals/bams/81/4/1520-0477_2000_081_0797_aiorcf_2_3_co_2.xml" rel="noreferrer" target="_blank">[14]</a>, <a class="reference external" href="https://www.wcrp-climate.org/resources/wcrp-publications/1095-pub-2017" rel="noreferrer" target="_blank">[15]</a>). Secondly, the dataset used to compute the regression coefficients, and considered as a reference dataset, is built from different sources : a collection of 5000 representative profiles for the CDS dataset <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=288339045" rel="noreferrer" target="_blank">[see the ATBD, pages 9 and 10]</a>, and an extraction of profiles from ERA40 reanalyses (see explanations in <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a>).</p>
<ul class="simple">
<li><p>The results in <a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a> are based on only two months of data (November and December 2001) using  former versions of reanalyses (ERA40) for <span class="math notranslate nohighlight">\(\omega_{500}\)</span>, which can lead to discrepancies in the amplitudes and occurences when compared to our more comprehensive dataset, even if limited to only one year.</p></li>
</ul>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entries for the data used is:</p>
<ul class="simple">
<li><p>Upper tropospheric humidity gridded data from 1999 to present derived from satellite observations:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-upper-troposphere-humidity" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-upper-troposphere-humidity</a></p></li>
<li><p>ERA5 hourly data on pressure levels from 1940 to present:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-pressure-levels" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/reanalysis-era5-pressure-levels</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>, prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
<p>And more resources on tropical atmosphere, large-scale circulation and upper tropospheric humidity :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.nature.com/scitable/knowledge/library/tropical-weather-84224797/" rel="noreferrer" target="_blank">https://www.nature.com/scitable/knowledge/library/tropical-weather-84224797/</a></p></li>
<li><p>Additonal scientific articles on Upper Tropospheric Humidity :</p>
<ul>
<li><p>IPCC Assessment Report 4, 2007 : 3.4.2.2 Upper Tropospheric Water Vapor, in WG1: The Physical Science Basis, <a class="reference external" href="https://archive.ipcc.ch/publications_and_data/ar4/wg1/en/ch3s3-4-2-2.html" rel="noreferrer" target="_blank">https://archive.ipcc.ch/publications_and_data/ar4/wg1/en/ch3s3-4-2-2.html</a></p></li>
<li><p>Shi, L., Schreck III, C. J., John, V. O., Chung, E.-S., Lang, T., Buehler, S. A., and Soden, B. J., 2022: Assessing the consistency of satellite-derived upper tropospheric humidity measurements, Atmos. Meas. Tech., 15, 6949‚Äì6963, <a class="reference external" href="https://doi.org/10.5194/amt-15-6949-2022" rel="noreferrer" target="_blank">https://doi.org/10.5194/amt-15-6949-2022</a></p></li>
<li><p>Chung E., B. Soden, B.J. Sohn, and L. Shi, 2014: Upper-tropospheric moistening in response to anthropogenic warming, Proc. Natl. Acad. Sci. U.S.A. 111 (32) 11636-11641, <a class="reference external" href="https://doi.org/10.1073/pnas.1409659111" rel="noreferrer" target="_blank">https://doi.org/10.1073/pnas.1409659111</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/abs/10.1029/97GL03563" rel="noreferrer" target="_blank">[1]</a> Pierrehumbert R. T (1998), Lateral mixing as a source of subtropical water vapor, Geophys. Res. Lett., 25, 151-154, doi:10.1029/97GL03563</p>
<p><a class="reference external" href="https://doi.org/10.1029/2006GL029118" rel="noreferrer" target="_blank">[2]</a> Brogniez, H., and R. T. Pierrehumbert (2007), Intercomparison of tropical tropospheric humidity in GCMs with AMSU-B water vapor data, Geophys. Res. Lett., 34, L17812, doi:10.1029/2006GL029118.</p>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-003-0369-6" rel="noreferrer" target="_blank">[3]</a> Bony, S., Dufresne, JL., Le Treut, H. et al. (2004), On dynamic and thermodynamic components of cloud changes. Climate Dynamics 22, 71‚Äì86. doi:10.1007/s00382-003-0369-6</p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0450%281988%29027%3C0889:EOTUTR%3E2.0.CO;2" rel="noreferrer" target="_blank">[4]</a> Schmetz J. and O. Turpeinen (1988), Estimation of the Upper Tropospheric Relative Humidity Field from METEOSAT Water Vapor Image Data, J. Appl. Meteor. Clim., 27, 8, 889-899. doi:10.1175/1520-0450(1988)027%3C0889:EOTUTR%<a class="reference external" href="http://3E2.0.CO" rel="noreferrer" target="_blank">3E2.0.CO</a>;2.</p>
<p><a class="reference external" href="https://doi.org/10.1029/93JD01283" rel="noreferrer" target="_blank">[5]</a> Soden B. and F. Bretherton (1993), Upper tropospheric relative humidity from the GOES 6.7 Œºm channel: Method and climatology for July 1987, J. Geophys. Res, 98, D9, 16,669-16,688. doi:/10.1029/93JD01283.</p>
<p><a class="reference external" href="https://doi.org/10.1029/2007JD009314" rel="noreferrer" target="_blank">[6]</a> Buehler, S. A., M. Kuvatov, V. O. John, M. Milz, B. J. Soden, D. L. Jackson, and J. Notholt (2008), An upper tropospheric humidity data set from operational satellite microwave data, J. Geophys. Res., 113, D14110, doi:10.1029/2007JD009314.</p>
<p><a class="reference external" href="https://doi.org/10.1175/2009JCLI2963.1" rel="noreferrer" target="_blank">[7]</a> Brogniez H., R. Roca and L. Picon (2009), A study of the free tropospheric humidity interannual variability using Meteosat data and an advection‚Äìcondensation transport model, J. Clim., 22, 24, 6773‚Äì6787, doi:10.1175/2009JCLI2963.1.</p>
<p><a class="reference external" href="https://acp.copernicus.org/articles/14/11129/2014/" rel="noreferrer" target="_blank">[8]</a> Schr√∂der, M., R. Roca, L. Picon, A. Kniffka, and H. Brogniez (2014) Climatology of free tropospheric humidity: extension into the SEVIRI era, evaluation and exemplary analysis, Atmos. Chem. Phys., 14, 11129-11148, doi:10.5194/acp-14-11129-2014.</p>
<p><a class="reference external" href="https://acp.copernicus.org/articles/7/2489/2007/" rel="noreferrer" target="_blank">[9]</a> Chung E.S., B. J. Sohn, J. Schmetz and M. Koening (2007) Diurnal variation of upper tropospheric humidity and its relations to convective activities over tropical Africa, Atmos. Chem. Phys., 7, 2489‚Äì2502, doi:10.5194/acp-7-2489-2007.</p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0046.1" rel="noreferrer" target="_blank">[10]</a> Tivig M., V. Gr√ºtzun, V. O. John and S. Buehler (2020), Trends in upper-tropospheric humidity: expansion of the subtropical dry zones? J. Clim. 33, 6, 2149‚Äì2161, doi:10.1175/JCLI-D-19-0046.1.</p>
<p><a class="reference external" href="https://doi.org/10.1256/qj.04.176" rel="noreferrer" target="_blank">[11]</a> Uppala S. and co authors (2005), The ERA-40 re-analysis, Q. J. R. Meteorol. Soc., 31, 2961‚Äì 3012, doi: 10.1256/qj.04.176.</p>
<p>[[12]](<a class="reference external" href="https://doi.org/10.1175/1520-0477(1996%29077%3C0437:TNYRP%3E2.0.CO;2)" rel="noreferrer" target="_blank">https://doi.org/10.1175/1520-0477(1996)077&lt;0437:TNYRP&gt;2.0.CO;2)</a> Kalnay E and co authors (1996) The NCEP/NCAR 40-year reanalysis project. Bull. Am. Meteorol. Soc., 77, 437‚Äì471, doi:10.1175/1520-0477(1996)077&lt;0437:TNYRP&gt;<a class="reference external" href="http://2.0.CO" rel="noreferrer" target="_blank">2.0.CO</a>;2.</p>
<p><a class="reference external" href="https://iopscience.iop.org/article/10.1088/1748-9326/5/2/025205/meta" rel="noreferrer" target="_blank">[13]</a> Allan R., B. Soden, V. John, W. Ingram and P. Good (2010) Current changes in tropical precipitation, Environ. Res. Lett., 5, 025205, doi:10.1088/1748-9326/5/2/025205.</p>
<p><a class="reference external" href="https://journals.ametsoc.org/view/journals/bams/81/4/1520-0477_2000_081_0797_aiorcf_2_3_co_2.xml" rel="noreferrer" target="_blank">[14]</a> Soden, B., and coauthors (2000), An Intercomparison of Radiation Codes for Retrieving Upper-Tropospheric Humidity in the 6.3-Œºm Band: A Report from the First GVaP Workshop. Bull. Amer. Meteor. Soc., 81, 797‚Äì808. doi:10.1175/1520-0477%282000%29081&lt;0797:AIORCF&gt;<a class="reference external" href="http://2.3.CO" rel="noreferrer" target="_blank">2.3.CO</a>;2</p>
<p><a class="reference external" href="https://www.wcrp-climate.org/resources/wcrp-publications/1095-pub-2017" rel="noreferrer" target="_blank">[15]</a> Schroeder, M., M. Lockhoff, L. Shi, T. August, R. Bennartz, E. Borbas, H. Brogniez, X. Calbet, S. Crewell, S. Eikenberg, F. Fell, J. Forsythe, A. Gambacorta, K. Graw, S.-P. Ho, H. Hoeschen, J. Kinzel, E. R. Kursinski, A. Reale, J. Roman, N. Scott, S. Steinke, B. Sun, T. Trent, A. Walther, U. Willen, Q. Yang, 2017: GEWEX water vapor assessment (G-VAP). WCRP Report 16/2017, World Climate Research Programme, Geneva, Switzerland, 216 pp.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmosphere_Physics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmosphere_Physics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.1. </span>Atmosphere Physics</p>
      </div>
    </a>
    <a class="right-next"
       href="../Atmospheric_Composition/Atmospheric_Composition.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-observing-the-moisture-content-of-the-atmosphere-and-making-the-link-with-large-scale-circulation-in-the-tropics">üåç Use case: observing the moisture content of the atmosphere and making the link with large scale circulation in the tropics.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-tropospheric-humidity">Upper Tropospheric Humidity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method">Method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-parameters-to-use-and-setup-code">Choose the parameters to use and setup code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages"><strong>Import packages</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters"><strong>Define parameters</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-data-request"><strong>Set the data request</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-datasets-and-perform-space-time-aggregation">Download the datasets and perform space-time aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-and-spatial-aggregation"><strong>Temporal and spatial aggregation</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-of-unit-for-vertical-velocity"><strong>Change of unit for vertical velocity</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#organisation-of-the-data"><strong>Organisation of the data</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-the-geophysical-variables-of-interest">Overview of the geophysical variables of interest</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Upper Tropospheric Humidity</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#atmospheric-vertical-velocity-at-500-hpa"><strong>Atmospheric vertical velocity at 500 hPa</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-description-of-the-results">Plot and description of the results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variation-of-uth-with-the-vertical-velocity-at-500hpa">Variation of UTH with the vertical velocity at 500hPa</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>