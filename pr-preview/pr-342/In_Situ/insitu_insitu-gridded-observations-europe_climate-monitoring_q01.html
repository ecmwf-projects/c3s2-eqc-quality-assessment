
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.1. Insitu Air Temperature completeness for climate monitoring &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'In_Situ/insitu_insitu-gridded-observations-europe_climate-monitoring_q01';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Reanalysis" href="../Reanalyses/reanalysis.html" />
    <link rel="prev" title="2. Insitu Observations" href="insitu.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="insitu.html">2. Quality assessments for Insitu Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.1. Insitu Air Temperature completeness for climate monitoring</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FIn_Situ/insitu_insitu-gridded-observations-europe_climate-monitoring_q01.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/In_Situ/insitu_insitu-gridded-observations-europe_climate-monitoring_q01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Insitu Air Temperature completeness for climate monitoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessment-of-climate-change">üåç Use case: Assessment of Climate Change.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-e-obs">1. Define the AoI, search and download E-OBS</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data">2. Inspect and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-statistics">Basic statistics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-climatology-for-alternative-30-year-periods">3. Plot the climatology for alternative 30-year periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-climatological-mean">3.1. Calculation of the Climatological Mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-map-of-the-5-subsets-for-the-defined-aoi">Mean Map of the 5 subsets, for the defined AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tg-per-toi">3.2. Plot TG per ToI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tg-spread-per-toi">3.3. Plot TG Spread per ToI</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-probability-density-function-pdf-of-each-alternative-30-year-period">4. Calculate the probability density function (PDF) of each alternative 30-year period</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-pdf-and-pdf-per-toi-respectively">4.1. Plot PDF and PDF per TOI, respectively</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-seasonal-pdfs-and-the-climatological-season-maps">5. Calculate and plot seasonal PDFs and the climatological season maps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-seasonal-probability-density-function-of-each-alternative-30-year-period">6. Calculate seasonal probability density function of each alternative 30-year period</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">7. Main takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="insitu-air-temperature-completeness-for-climate-monitoring">
<h1><span class="section-number">2.1. </span>Insitu Air Temperature completeness for climate monitoring<a class="headerlink" href="#insitu-air-temperature-completeness-for-climate-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 10/10/2024</p>
<p>Produced by: Ana Oliveira (CoLAB +ATLANTIC)</p>
<section id="use-case-assessment-of-climate-change">
<h2>üåç Use case: Assessment of Climate Change.<a class="headerlink" href="#use-case-assessment-of-climate-change" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>User Question: How consistent is the 30-year air temperature climatology over time? How does this depend on the choice of reference period?</strong></p></li>
</ul>
<p>In this Use Case we will access the E-OBS daily gridded meteorological data for Europe from 1950 to present derived from in-situ observations (henceforth, E-OBS) data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S) and analyse the spatial consistency of the E-OBS air temperature climatology, and its ensemble, over a given Area of Interest (AoI), as a regional example of using E-OBS in the scope of the European State of Climate <a class="reference external" href="https://climate.copernicus.eu/esotc/2023">C3S, 2024</a>.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Mean daily air temperature (TG) from EOBS offers complete temporal-spatial coverage over the AoI, showing a climate change-driven warming rate consistent with those reported in the literature.</p></li>
<li><p>Furthermore, the observed asymmetry in the TG probability density function underscores the importance of assessing changes across the entire distribution, rather than focusing solely on mean values.</p></li>
<li><p>Nevertheless, TG ensemble spread shows inhomogeneous spatial patterns that arise from the irregular density of in-situ stations available, across the region. Indeed, this inhomogeneity indicates that EOBS accuracy is location-dependent.</p></li>
<li><p>As described in this dataset‚Äôs documentation, the usage of this dataset should be with caution in interpreting trends and extremes, considering the potential limitations in accuracy and completeness, especially in regions with sparse observational data <a class="reference external" href="https://doi.org/10.1029/2017JD028200">Cornes et al., 2018</a>.</p></li>
<li><p>Furthermore, potential biases should be considered from these techniques and consider the spatial variability in data density when interpreting results. For instance, it may also be influenced by factors such as changes in observational practices, station location shifts, or urbanization effects, which can introduce uncertainties in the interpretation of long-term trends.</p></li>
<li><p>As an indicator of the confidence intervals associated with individual grid cells, the ensemble spread may provide insights into the reliability of data in specific locations, aiding in the assessment of uncertainties <a class="reference external" href="https://doi.org/10.1007/s00382-020-05472-3">Carvalho, Cardoso Pereira, and Rocha, 2021</a>.</p></li>
</ul>
</div>
<p><img alt="EOBS_climatological_mean_v9.png" src="../_images/EOBS_climatological_mean_v9.png" /></p>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p><strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-1"><span class="std std-ref">1. Define the AoI, search and download E-OBS</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-2"><span class="std std-ref">2. Inspect and view data</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3"><span class="std std-ref">3. Plot the climatology for alternative 30-year periods</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-1"><span class="std std-ref">3.1. Calculation of the Climatological Mean</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-2"><span class="std std-ref">3.2. Plot TG per ToI</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-3"><span class="std std-ref">3.3. Plot TG Spread per ToI</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-4"><span class="std std-ref">4. Calculate the probability density function (PDF) of each alternative 30-year period</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-4-1"><span class="std std-ref">4.1. Plot PDF and PDF per TOI, respectively</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-5"><span class="std std-ref">5. Calculate and plot seasonal PDFs and the climatological season maps</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-6"><span class="std std-ref">6. Calculate seasonal probability density function of each alternative 30-year period</span></a></strong><br />
<strong><a class="reference internal" href="#insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-7"><span class="std std-ref">7. Main takeaways</span></a></strong></p>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="define-the-aoi-search-and-download-e-obs">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-1"></span><h3>1. Define the AoI, search and download E-OBS<a class="headerlink" href="#define-the-aoi-search-and-download-e-obs" title="Link to this heading">#</a></h3>
<section id="import-all-the-libraries-packages">
<h4>Import all the libraries/packages<a class="headerlink" href="#import-all-the-libraries-packages" title="Link to this heading">#</a></h4>
<p>We will be working with data in NetCDF format. To best handle this data we will use libraries for working with multidimensional arrays, in particular Xarray. We will also need libraries for plotting and viewing data, in this case we will use Matplotlib and Cartopy.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymannkendall</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="data-overview">
<h4>Data Overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h4>
<p>To search for data, visit the CDS website: <a class="reference external" href="http://cds.climate.copernicus.eu">http://cds.climate.copernicus.eu</a>. Here you can search for ‚Äòin-situ observations‚Äô using the search bar. The data we need for this tutorial is the <em><strong>E-OBS daily gridded meteorological data for Europe from 1950 to present derived from in-situ observations</strong></em>. This catalogue entry provides a daily gridded dataset of historical meteorological observations, covering Europe (land-only), from 1950 to the present. This data is derived from in-situ meteorological stations, made available through the European Climate Assessment &amp; Dataset (ECA&amp;D) project, as provided by National Meteorological and Hydrological Services (NMHSs) and other data-holding institutes.</p>
<p>E-OBS comprises a set of spatially continuous Essential Climate Variables (ECVs) from the Surface Atmosphere, following the Global Climate Observing System (GCOS) convention, provided as the mean and spread of the spatial prediction ensemble algorithm, at regular latitude-longitude grid intervals (at a 0.1¬∞ and 0.25¬∞ spatial resolution), and covering a long time-period, from 1 January 1950 to present-day. In addition to the land surface elevation, E-OBS includes daily air temperature (mean, maximum and minimum), precipitation amount, wind speed, sea-level pressure and shortwave downwelling radiation.</p>
<p>The latest E-OBS version, E-OBSv29.0e, was released in March 2024 and its main difference from the previous versions is the amount of input data used. Existing networks of synoptic, climatological and (manual) rain-gauge station data are updated with the latest measurements that are received directly from the national or regional meteorological services.</p>
<p>Having selected the correct dataset, we now need to specify what product type, variables, temporal and geographic coverage we are interested in. In this Use Case, the ensemble mean of air temperature (TG) will be used, considering the last version available. In addition, the ensemble spread of air temperature shall also be used as an indicator of data quality. These can all be selected in the ‚ÄúDownload data‚Äù tab from the CDS. In this tab a form appears in which we will select the following parameters to download, for example:</p>
<ul class="simple">
<li><p>Product Type: Ensemble mean  (Ensemble spread)</p></li>
<li><p>Variable: Mean temperature</p></li>
<li><p>Grid resolution: 0.25</p></li>
<li><p>Period: Full period</p></li>
<li><p>Version: 29.0e</p></li>
<li><p>Format: Zip file (.zip)</p></li>
</ul>
<p>At the end of the download form, select <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">API</span> <span class="pre">request</span></code>. This will reveal a block of code, which you can simply copy and paste into a cell of your Jupyter Notebook ‚Ä¶</p>
<p>Download data
‚Ä¶ having copied the API request to a Jupyter Notebook cell, running it will retrieve and download the data you requested into your local directory. However, before you run it, the <code class="docutils literal notranslate"><span class="pre">terms</span> <span class="pre">and</span> <span class="pre">conditions</span></code> of this particular dataset need to have been accepted directly at the CDS website. The option to view and accept these conditions is given at the end of the download form, just above the <code class="docutils literal notranslate"><span class="pre">Show</span> <span class="pre">API</span> <span class="pre">request</span></code> option. In addition, it is also useful to define the time period and AoI parameters and edit the request accordingly, as exemplified in the cells below.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define region - AoI</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span>

<span class="c1"># Define climatology periods - ToI</span>
<span class="n">years_start</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1951</span><span class="p">,</span> <span class="mi">1961</span><span class="p">,</span> <span class="mi">1971</span><span class="p">,</span> <span class="mi">1981</span><span class="p">,</span> <span class="mi">1991</span><span class="p">]</span>
<span class="n">years_stop</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">1990</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2020</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;deepskyblue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;gold&quot;</span><span class="p">,</span> <span class="s2">&quot;darkorange&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">years_start</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">years_stop</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

<span class="c1"># Variable name</span>
<span class="n">varname1</span> <span class="o">=</span> <span class="s2">&quot;tg&quot;</span>

<span class="n">varname2</span> <span class="o">=</span> <span class="s2">&quot;tg_spread&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define transform function to reduce downloaded data</span>

<span class="k">def</span><span class="w"> </span><span class="nf">regionalise_and_dayofyear_reindex</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="c1"># Select region</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>

    <span class="c1"># 15-day rolling mean</span>
    <span class="n">ds_rolled</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="c1"># Extract periods</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years_start</span><span class="p">,</span> <span class="n">years_stop</span><span class="p">):</span>
        <span class="n">period</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">ds_masked</span> <span class="o">=</span> <span class="n">ds_rolled</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="p">(</span><span class="n">ds_rolled</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="n">year_start</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds_rolled</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="n">year_stop</span><span class="p">),</span>
            <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ds_masked</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="p">[</span><span class="n">period</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="n">ds_dayofyear</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>

    <span class="c1"># Add season (pick any leap year)</span>
    <span class="n">season</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ds_dayofyear</span><span class="p">[</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;2000&quot;</span><span class="p">),</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">season</span>
    <span class="k">return</span> <span class="n">ds_dayofyear</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">,</span> <span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define request</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;insitu-gridded-observations-europe&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ensemble_mean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grid_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_25deg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="s2">&quot;full_period&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;30_0e&quot;</span><span class="p">,</span>

    <span class="p">},</span>
<span class="p">)</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">regionalise_and_dayofyear_reindex</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">},</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-04-24 16:15:20,957 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:15:20,957 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:15:23,104 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:15:23,104 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:15:23,647 INFO Request ID is 76748cec-46f5-4f5e-b93d-b60079d46304
2025-04-24 16:15:24,057 INFO status has been updated to accepted
2025-04-24 16:15:32,703 INFO status has been updated to running
2025-04-24 16:15:38,154 INFO status has been updated to successful
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [04:19&lt;00:00, 259.19s/it]                                           
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define request</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;insitu-gridded-observations-europe&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ensemble_mean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grid_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_25deg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="s2">&quot;full_period&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;30_0e&quot;</span><span class="p">,</span>
        <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">regionalise_and_dayofyear_reindex</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">},</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-04-24 16:22:59,534 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:22:59,534 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:22:59,721 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:22:59,721 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:23:00,117 INFO Request ID is 4d7e3e8e-f6ae-44df-96e6-960ff5402aab
2025-04-24 16:23:00,200 INFO status has been updated to accepted
2025-04-24 16:23:11,366 INFO status has been updated to running
2025-04-24 16:23:16,612 INFO status has been updated to successful
b12593a9246b7cf2db00fd5adb314e82.zip:  37%|‚ñà‚ñà‚ñà‚ñã      | 296M/810M [00:37&lt;01:06, 8.06MB/s] 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [04:17&lt;00:00, 257.10s/it]                                          
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define request</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;insitu-gridded-observations-europe&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ensemble_spread&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_temperature&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grid_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_25deg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="s2">&quot;full_period&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;30_0e&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">dss</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">regionalise_and_dayofyear_reindex</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">},</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-04-24 16:29:23,492 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:29:23,492 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:29:23,679 INFO [2024-09-26T00:00:00] Watch our [Forum](https://forum.ecmwf.int/) for Announcements, news and other discussed topics.
2025-04-24 16:29:23,680 WARNING [2024-06-16T00:00:00] CDS API syntax is changed and some keys or parameter names may have also changed. To avoid requests failing, please use the &quot;Show API request code&quot; tool on the dataset Download Form to check you are using the correct syntax for your API request.
2025-04-24 16:29:23,871 INFO Request ID is 3fd2ae4e-3408-4bd7-89d1-b8c01ae9f67a
2025-04-24 16:29:24,153 INFO status has been updated to accepted
2025-04-24 16:29:32,805 INFO status has been updated to successful
482753ff7de41dc56c38f30ec689970d.zip:  34%|‚ñà‚ñà‚ñà‚ñç      | 261M/759M [00:21&lt;00:39, 13.2MB/s] 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [04:24&lt;00:00, 264.18s/it]                                          
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="inspect-and-view-data">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-2"></span><h3>2. Inspect and view data<a class="headerlink" href="#inspect-and-view-data" title="Link to this heading">#</a></h3>
<p>Now that we have downloaded the data, we can inspect it. We have requested the data in NetCDF format. This is a commonly used format for array-oriented scientific data. To read and process this data we will make use of the Xarray library. Xarray is an open source project and Python package that makes working with labelled multi-dimensional arrays simple and efficient. We will read the data from our NetCDF file into an xarray.Dataset.</p>
<section id="basic-statistics">
<h4>Basic statistics<a class="headerlink" href="#basic-statistics" title="Link to this heading">#</a></h4>
<p>To understand better the E-OBS data structure and check the aggregated Daily Mean Temperature (TG), we will first need to retrieve the TG variable from the multidimensional netCDF data structure and calculate the descriptive statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the old variable name</span>
<span class="n">old_variable_name</span> <span class="o">=</span> <span class="s1">&#39;tg&#39;</span>

<span class="c1"># Specify the new variable name, long name and units</span>
<span class="n">new_variable_name</span> <span class="o">=</span> <span class="s1">&#39;TG&#39;</span>
<span class="n">new_long_name</span> <span class="o">=</span> <span class="s1">&#39;Daily Mean Temperature&#39;</span>
<span class="n">new_units</span> <span class="o">=</span> <span class="s1">&#39;¬∞C&#39;</span>

<span class="c1"># Specify the new variable units&gt;</span>

<span class="c1"># Change the variable name and long name</span>
<span class="n">ds</span>  <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">old_variable_name</span><span class="p">:</span> <span class="n">new_variable_name</span><span class="p">})</span>
<span class="n">ds</span><span class="p">[</span><span class="n">new_variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_long_name</span>
<span class="n">ds</span><span class="p">[</span><span class="n">new_variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_units</span>

<span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 10MB
Dimensions:    (latitude: 32, longitude: 44, dayofyear: 366, period: 5)
Coordinates:
  * latitude   (latitude) float64 256B 36.12 36.38 36.62 ... 43.38 43.62 43.88
  * longitude  (longitude) float64 352B -9.875 -9.625 -9.375 ... 0.625 0.875
  * dayofyear  (dayofyear) int64 3kB 1 2 3 4 5 6 7 ... 361 362 363 364 365 366
  * period     (period) &lt;U9 180B &#x27;1951-1980&#x27; &#x27;1961-1990&#x27; ... &#x27;1991-2020&#x27;
    season     (dayofyear) &lt;U3 4kB dask.array&lt;chunksize=(366,), meta=np.ndarray&gt;
Data variables:
    TG         (period, dayofyear, latitude, longitude) float32 10MB dask.array&lt;chunksize=(5, 366, 32, 44), meta=np.ndarray&gt;
Attributes:
    E-OBS_version:  30.0e
    Conventions:    CF-1.4
    References:     http://surfobs.climate.copernicus.eu/dataaccess/access_eo...
    history:        Fri Aug 30 12:35:42 2024: ncks --no-abc -d time,0,27209 /...
    NCO:            netCDF Operators version 5.1.8 (Homepage = http://nco.sf....</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b46c2eda-2161-4f15-91b0-32ccb9326417' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b46c2eda-2161-4f15-91b0-32ccb9326417' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 32</li><li><span class='xr-has-index'>longitude</span>: 44</li><li><span class='xr-has-index'>dayofyear</span>: 366</li><li><span class='xr-has-index'>period</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f440b289-8df9-49c7-be0b-4946d132d4a9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f440b289-8df9-49c7-be0b-4946d132d4a9' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>36.12 36.38 36.62 ... 43.62 43.88</div><input id='attrs-053597c8-1b81-4c19-92f3-754137d042de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-053597c8-1b81-4c19-92f3-754137d042de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2484a093-d1ba-4710-a3cc-2b7a8d3b1110' class='xr-var-data-in' type='checkbox'><label for='data-2484a093-d1ba-4710-a3cc-2b7a8d3b1110' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude values</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>positive :</span></dt><dd>North</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>out_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([36.125, 36.375, 36.625, 36.875, 37.125, 37.375, 37.625, 37.875, 38.125,
       38.375, 38.625, 38.875, 39.125, 39.375, 39.625, 39.875, 40.125, 40.375,
       40.625, 40.875, 41.125, 41.375, 41.625, 41.875, 42.125, 42.375, 42.625,
       42.875, 43.125, 43.375, 43.625, 43.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.875 -9.625 ... 0.625 0.875</div><input id='attrs-f33e5121-59c8-43f2-ba5b-4f251160db21' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f33e5121-59c8-43f2-ba5b-4f251160db21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73062990-019e-4c62-8f94-3c25458eccd9' class='xr-var-data-in' type='checkbox'><label for='data-73062990-019e-4c62-8f94-3c25458eccd9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude values</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>positive :</span></dt><dd>East</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>360.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>out_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-9.875, -9.625, -9.375, -9.125, -8.875, -8.625, -8.375, -8.125, -7.875,
       -7.625, -7.375, -7.125, -6.875, -6.625, -6.375, -6.125, -5.875, -5.625,
       -5.375, -5.125, -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375,
       -3.125, -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125,
       -0.875, -0.625, -0.375, -0.125,  0.125,  0.375,  0.625,  0.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 362 363 364 365 366</div><input id='attrs-9cbfb9e6-69a8-43f0-8c27-589796813600' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9cbfb9e6-69a8-43f0-8c27-589796813600' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-69931541-80e6-43ff-8004-63279eeffe2b' class='xr-var-data-in' type='checkbox'><label for='data-69931541-80e6-43ff-8004-63279eeffe2b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 364, 365, 366])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>period</span></div><div class='xr-var-dims'>(period)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;1951-1980&#x27; ... &#x27;1991-2020&#x27;</div><input id='attrs-37986e34-bbc0-4e30-a7a3-451daecbdb33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-37986e34-bbc0-4e30-a7a3-451daecbdb33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db415dfd-5e06-42ff-9d71-b976d72abea9' class='xr-var-data-in' type='checkbox'><label for='data-db415dfd-5e06-42ff-9d71-b976d72abea9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1951-1980&#x27;, &#x27;1961-1990&#x27;, &#x27;1971-2000&#x27;, &#x27;1981-2010&#x27;, &#x27;1991-2020&#x27;],
      dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>season</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(366,), meta=np.ndarray&gt;</div><input id='attrs-323669f1-3674-4ad6-8cc6-8e0ca42931b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-323669f1-3674-4ad6-8cc6-8e0ca42931b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0cb82570-dc14-4c43-8890-a460d9c55f89' class='xr-var-data-in' type='checkbox'><label for='data-0cb82570-dc14-4c43-8890-a460d9c55f89' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.29 kiB </td>
                        <td> 4.29 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (366,) </td>
                        <td> (366,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U3 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >366</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-1f38dc64-a771-4154-b400-662437ac82ed' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1f38dc64-a771-4154-b400-662437ac82ed' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>TG</span></div><div class='xr-var-dims'>(period, dayofyear, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(5, 366, 32, 44), meta=np.ndarray&gt;</div><input id='attrs-7a144618-dd3c-41a6-8961-9848051a9613' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7a144618-dd3c-41a6-8961-9848051a9613' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd5304f6-7d46-45ea-82ce-eae2c402c348' class='xr-var-data-in' type='checkbox'><label for='data-cd5304f6-7d46-45ea-82ce-eae2c402c348' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>long_name :</span></dt><dd>Daily Mean Temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 9.83 MiB </td>
                        <td> 9.83 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (5, 366, 32, 44) </td>
                        <td> (5, 366, 32, 44) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="352" height="158" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="26" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="26" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="26" y1="0" x2="26" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 26.968199403781718,0.0 26.968199403781718,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="13.484100" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >5</text>
  <text x="46.968199" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,46.968199,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="96" y1="0" x2="166" y2="70" style="stroke-width:2" />
  <line x1="96" y1="37" x2="166" y2="108" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="96" y1="0" x2="96" y2="37" style="stroke-width:2" />
  <line x1="166" y1="70" x2="166" y2="108" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="96.0,0.0 166.58823529411765,70.58823529411765 166.58823529411765,108.42808478616038 96.0,37.83984949204274" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="96" y1="0" x2="135" y2="0" style="stroke-width:2" />
  <line x1="166" y1="70" x2="206" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="96" y1="0" x2="166" y2="70" style="stroke-width:2" />
  <line x1="135" y1="0" x2="206" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="96.0,0.0 135.59074174702533,0.0 206.17897704114299,70.58823529411765 166.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="166" y1="70" x2="206" y2="70" style="stroke-width:2" />
  <line x1="166" y1="108" x2="206" y2="108" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="166" y1="70" x2="166" y2="108" style="stroke-width:2" />
  <line x1="206" y1="70" x2="206" y2="108" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="166.58823529411765,70.58823529411765 206.17897704114299,70.58823529411765 206.17897704114299,108.42808478616038 166.58823529411765,108.42808478616038" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="186.383606" y="128.428085" font-size="1.0rem" font-weight="100" text-anchor="middle" >44</text>
  <text x="226.178977" y="89.508160" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,226.178977,89.508160)">32</text>
  <text x="121.294118" y="93.133967" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,121.294118,93.133967)">366</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-a56e3f4e-4779-4c29-ad98-8044a8cd3a2b' class='xr-section-summary-in' type='checkbox'  ><label for='section-a56e3f4e-4779-4c29-ad98-8044a8cd3a2b' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8d1a6f62-183d-4d77-98c5-4c625fadcbe3' class='xr-index-data-in' type='checkbox'/><label for='index-8d1a6f62-183d-4d77-98c5-4c625fadcbe3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([36.125, 36.375, 36.625, 36.875, 37.125, 37.375, 37.625, 37.875, 38.125,
       38.375, 38.625, 38.875, 39.125, 39.375, 39.625, 39.875, 40.125, 40.375,
       40.625, 40.875, 41.125, 41.375, 41.625, 41.875, 42.125, 42.375, 42.625,
       42.875, 43.125, 43.375, 43.625, 43.875],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a4e370e0-c071-40cd-98a4-1ecd74bab99c' class='xr-index-data-in' type='checkbox'/><label for='index-a4e370e0-c071-40cd-98a4-1ecd74bab99c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-9.875, -9.625, -9.375, -9.125, -8.875, -8.625, -8.375, -8.125, -7.875,
       -7.625, -7.375, -7.125, -6.875, -6.625, -6.375, -6.125, -5.875, -5.625,
       -5.375, -5.125, -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375,
       -3.125, -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125,
       -0.875, -0.625, -0.375, -0.125,  0.125,  0.375,  0.625,  0.875],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>dayofyear</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2b6b7d0a-45c0-4468-b9ba-9b33ad5c24f6' class='xr-index-data-in' type='checkbox'/><label for='index-2b6b7d0a-45c0-4468-b9ba-9b33ad5c24f6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,
       ...
       357, 358, 359, 360, 361, 362, 363, 364, 365, 366],
      dtype=&#x27;int64&#x27;, name=&#x27;dayofyear&#x27;, length=366))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>period</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bc3a3a0a-8a89-452d-bbd9-bb96e97d32b7' class='xr-index-data-in' type='checkbox'/><label for='index-bc3a3a0a-8a89-452d-bbd9-bb96e97d32b7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;1951-1980&#x27;, &#x27;1961-1990&#x27;, &#x27;1971-2000&#x27;, &#x27;1981-2010&#x27;, &#x27;1991-2020&#x27;], dtype=&#x27;object&#x27;, name=&#x27;period&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6981101b-6309-42e6-8d59-eb4658082af9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6981101b-6309-42e6-8d59-eb4658082af9' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>E-OBS_version :</span></dt><dd>30.0e</dd><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>References :</span></dt><dd>http://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php</dd><dt><span>history :</span></dt><dd>Fri Aug 30 12:35:42 2024: ncks --no-abc -d time,0,27209 /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_ensmean_master_rectime.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_ens_mean_0.25deg_reg_v30.0e.nc
Fri Aug 30 12:29:02 2024: ncks --no-abc --mk_rec_dmn time /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_ensmean_master.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_ensmean_master_rectime.nc
Fri Aug 30 10:03:00 2024: ncks -O -d time,0,27209 /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg/tg_ensmean_master_untilJul2024.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg/tg_ensmean_master.nc</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 5.1.8 (Homepage = http://nco.sf.net, Code = http://github.com/nco/nco, Citation = 10.1016/j.envsoft.2008.03.004)</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the old variable name</span>
<span class="n">old_variable_name</span> <span class="o">=</span> <span class="s1">&#39;tg&#39;</span>

<span class="c1"># Specify the new variable name, long name and units</span>
<span class="n">new_variable_name</span> <span class="o">=</span> <span class="s1">&#39;TG Spread&#39;</span>
<span class="n">new_long_name</span> <span class="o">=</span> <span class="s1">&#39;Daily Mean Temperature Ensemble Spread&#39;</span>
<span class="n">new_units</span> <span class="o">=</span> <span class="s1">&#39;¬∞C&#39;</span>

<span class="c1"># Specify the new variable units&gt;</span>

<span class="c1"># Change the variable name and long name</span>
<span class="n">dss</span>  <span class="o">=</span> <span class="n">dss</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">old_variable_name</span><span class="p">:</span> <span class="n">new_variable_name</span><span class="p">})</span>
<span class="n">dss</span><span class="p">[</span><span class="n">new_variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_long_name</span>
<span class="n">dss</span><span class="p">[</span><span class="n">new_variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_units</span>

<span class="n">dss</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "‚ñ∫";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "‚ñº";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 10MB
Dimensions:    (latitude: 32, longitude: 44, dayofyear: 366, period: 5)
Coordinates:
  * latitude   (latitude) float64 256B 36.12 36.38 36.62 ... 43.38 43.62 43.88
  * longitude  (longitude) float64 352B -9.875 -9.625 -9.375 ... 0.625 0.875
  * dayofyear  (dayofyear) int64 3kB 1 2 3 4 5 6 7 ... 361 362 363 364 365 366
  * period     (period) &lt;U9 180B &#x27;1951-1980&#x27; &#x27;1961-1990&#x27; ... &#x27;1991-2020&#x27;
    season     (dayofyear) &lt;U3 4kB dask.array&lt;chunksize=(366,), meta=np.ndarray&gt;
Data variables:
    TG Spread  (period, dayofyear, latitude, longitude) float32 10MB dask.array&lt;chunksize=(5, 366, 32, 44), meta=np.ndarray&gt;
Attributes:
    E-OBS_version:  30.0e
    Conventions:    CF-1.4
    References:     http://surfobs.climate.copernicus.eu/dataaccess/access_eo...
    history:        Fri Aug 30 12:38:13 2024: ncks --no-abc -d time,0,27209 /...
    NCO:            netCDF Operators version 5.1.8 (Homepage = http://nco.sf....</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f6880173-8266-4877-8f67-5a742118f43f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f6880173-8266-4877-8f67-5a742118f43f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 32</li><li><span class='xr-has-index'>longitude</span>: 44</li><li><span class='xr-has-index'>dayofyear</span>: 366</li><li><span class='xr-has-index'>period</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4dd73a95-6ec3-4707-9481-fa7fe2931197' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4dd73a95-6ec3-4707-9481-fa7fe2931197' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>36.12 36.38 36.62 ... 43.62 43.88</div><input id='attrs-bb2f84f7-48c5-4016-8526-c63404686098' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb2f84f7-48c5-4016-8526-c63404686098' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c3e809f-2d4c-4999-8d2f-cf85c7fd43d8' class='xr-var-data-in' type='checkbox'><label for='data-0c3e809f-2d4c-4999-8d2f-cf85c7fd43d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>Latitude values</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>positive :</span></dt><dd>North</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>out_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([36.125, 36.375, 36.625, 36.875, 37.125, 37.375, 37.625, 37.875, 38.125,
       38.375, 38.625, 38.875, 39.125, 39.375, 39.625, 39.875, 40.125, 40.375,
       40.625, 40.875, 41.125, 41.375, 41.625, 41.875, 42.125, 42.375, 42.625,
       42.875, 43.125, 43.375, 43.625, 43.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.875 -9.625 ... 0.625 0.875</div><input id='attrs-fb704038-f72f-4ca1-a44d-f6bafc33f6b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb704038-f72f-4ca1-a44d-f6bafc33f6b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fbdd06fd-7080-4596-a522-a218d01e0f52' class='xr-var-data-in' type='checkbox'><label for='data-fbdd06fd-7080-4596-a522-a218d01e0f52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>Longitude values</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>positive :</span></dt><dd>East</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>360.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>out_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-9.875, -9.625, -9.375, -9.125, -8.875, -8.625, -8.375, -8.125, -7.875,
       -7.625, -7.375, -7.125, -6.875, -6.625, -6.375, -6.125, -5.875, -5.625,
       -5.375, -5.125, -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375,
       -3.125, -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125,
       -0.875, -0.625, -0.375, -0.125,  0.125,  0.375,  0.625,  0.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>dayofyear</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 362 363 364 365 366</div><input id='attrs-7b1f7a2c-7a06-4529-8e7a-18178884899d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b1f7a2c-7a06-4529-8e7a-18178884899d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d9c5910-fae8-47d4-97b9-64b0c2cdc005' class='xr-var-data-in' type='checkbox'><label for='data-4d9c5910-fae8-47d4-97b9-64b0c2cdc005' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 364, 365, 366])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>period</span></div><div class='xr-var-dims'>(period)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;1951-1980&#x27; ... &#x27;1991-2020&#x27;</div><input id='attrs-3c8e4fa3-330b-4989-b158-b07f8489bd8f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c8e4fa3-330b-4989-b158-b07f8489bd8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c247cbc-69ea-4a2b-b8f2-7cfd92b70e9f' class='xr-var-data-in' type='checkbox'><label for='data-9c247cbc-69ea-4a2b-b8f2-7cfd92b70e9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1951-1980&#x27;, &#x27;1961-1990&#x27;, &#x27;1971-2000&#x27;, &#x27;1981-2010&#x27;, &#x27;1991-2020&#x27;],
      dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>season</span></div><div class='xr-var-dims'>(dayofyear)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(366,), meta=np.ndarray&gt;</div><input id='attrs-9f27b94d-7daa-4296-9735-717ac972f3fa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f27b94d-7daa-4296-9735-717ac972f3fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e3b55c5-c3e1-4081-8897-9c4652f0303e' class='xr-var-data-in' type='checkbox'><label for='data-1e3b55c5-c3e1-4081-8897-9c4652f0303e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 4.29 kiB </td>
                        <td> 4.29 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (366,) </td>
                        <td> (366,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> <U3 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >366</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-12f66807-3bda-460a-8945-3d0e9b01a47a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12f66807-3bda-460a-8945-3d0e9b01a47a' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>TG Spread</span></div><div class='xr-var-dims'>(period, dayofyear, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(5, 366, 32, 44), meta=np.ndarray&gt;</div><input id='attrs-9ef46cd6-61ae-45c6-8462-b87ef97ead66' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9ef46cd6-61ae-45c6-8462-b87ef97ead66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cefd0491-084c-4ac4-9112-e2c68b32a397' class='xr-var-data-in' type='checkbox'><label for='data-cefd0491-084c-4ac4-9112-e2c68b32a397' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>¬∞C</dd><dt><span>long_name :</span></dt><dd>Daily Mean Temperature Ensemble Spread</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 9.83 MiB </td>
                        <td> 9.83 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (5, 366, 32, 44) </td>
                        <td> (5, 366, 32, 44) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="352" height="158" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="26" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="26" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="26" y1="0" x2="26" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 26.968199403781718,0.0 26.968199403781718,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="13.484100" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >5</text>
  <text x="46.968199" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,46.968199,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="96" y1="0" x2="166" y2="70" style="stroke-width:2" />
  <line x1="96" y1="37" x2="166" y2="108" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="96" y1="0" x2="96" y2="37" style="stroke-width:2" />
  <line x1="166" y1="70" x2="166" y2="108" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="96.0,0.0 166.58823529411765,70.58823529411765 166.58823529411765,108.42808478616038 96.0,37.83984949204274" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="96" y1="0" x2="135" y2="0" style="stroke-width:2" />
  <line x1="166" y1="70" x2="206" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="96" y1="0" x2="166" y2="70" style="stroke-width:2" />
  <line x1="135" y1="0" x2="206" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="96.0,0.0 135.59074174702533,0.0 206.17897704114299,70.58823529411765 166.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="166" y1="70" x2="206" y2="70" style="stroke-width:2" />
  <line x1="166" y1="108" x2="206" y2="108" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="166" y1="70" x2="166" y2="108" style="stroke-width:2" />
  <line x1="206" y1="70" x2="206" y2="108" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="166.58823529411765,70.58823529411765 206.17897704114299,70.58823529411765 206.17897704114299,108.42808478616038 166.58823529411765,108.42808478616038" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="186.383606" y="128.428085" font-size="1.0rem" font-weight="100" text-anchor="middle" >44</text>
  <text x="226.178977" y="89.508160" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,226.178977,89.508160)">32</text>
  <text x="121.294118" y="93.133967" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,121.294118,93.133967)">366</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ff855a27-38dd-4e18-86a2-a2a2ea65bdb1' class='xr-section-summary-in' type='checkbox'  ><label for='section-ff855a27-38dd-4e18-86a2-a2a2ea65bdb1' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c325800e-53ff-482d-9423-55c12759277c' class='xr-index-data-in' type='checkbox'/><label for='index-c325800e-53ff-482d-9423-55c12759277c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([36.125, 36.375, 36.625, 36.875, 37.125, 37.375, 37.625, 37.875, 38.125,
       38.375, 38.625, 38.875, 39.125, 39.375, 39.625, 39.875, 40.125, 40.375,
       40.625, 40.875, 41.125, 41.375, 41.625, 41.875, 42.125, 42.375, 42.625,
       42.875, 43.125, 43.375, 43.625, 43.875],
      dtype=&#x27;float64&#x27;, name=&#x27;latitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-de573c21-025b-4133-b839-362dbbdb2155' class='xr-index-data-in' type='checkbox'/><label for='index-de573c21-025b-4133-b839-362dbbdb2155' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-9.875, -9.625, -9.375, -9.125, -8.875, -8.625, -8.375, -8.125, -7.875,
       -7.625, -7.375, -7.125, -6.875, -6.625, -6.375, -6.125, -5.875, -5.625,
       -5.375, -5.125, -4.875, -4.625, -4.375, -4.125, -3.875, -3.625, -3.375,
       -3.125, -2.875, -2.625, -2.375, -2.125, -1.875, -1.625, -1.375, -1.125,
       -0.875, -0.625, -0.375, -0.125,  0.125,  0.375,  0.625,  0.875],
      dtype=&#x27;float64&#x27;, name=&#x27;longitude&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>dayofyear</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cfa189b5-10a0-4c1f-b312-9ca006bac1c8' class='xr-index-data-in' type='checkbox'/><label for='index-cfa189b5-10a0-4c1f-b312-9ca006bac1c8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,
       ...
       357, 358, 359, 360, 361, 362, 363, 364, 365, 366],
      dtype=&#x27;int64&#x27;, name=&#x27;dayofyear&#x27;, length=366))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>period</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-16c7794d-b385-4e67-9f4f-4f6d20a61d67' class='xr-index-data-in' type='checkbox'/><label for='index-16c7794d-b385-4e67-9f4f-4f6d20a61d67' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;1951-1980&#x27;, &#x27;1961-1990&#x27;, &#x27;1971-2000&#x27;, &#x27;1981-2010&#x27;, &#x27;1991-2020&#x27;], dtype=&#x27;object&#x27;, name=&#x27;period&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-95ce26af-7dcf-43aa-8ad8-9c0f3de5ddd2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-95ce26af-7dcf-43aa-8ad8-9c0f3de5ddd2' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>E-OBS_version :</span></dt><dd>30.0e</dd><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>References :</span></dt><dd>http://surfobs.climate.copernicus.eu/dataaccess/access_eobs.php</dd><dt><span>history :</span></dt><dd>Fri Aug 30 12:38:13 2024: ncks --no-abc -d time,0,27209 /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_se_master_rectime.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_ens_spread_0.25deg_reg_v30.0e.nc
Fri Aug 30 12:36:17 2024: ncks --no-abc --mk_rec_dmn time /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_se_master.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg//tg_se_master_rectime.nc
Fri Aug 30 10:03:40 2024: ncks -O -d time,0,27209 /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg/tg_se_master_untilJul2024.nc /nobackup_1/users/besselaa/Data/Gridding/EOBSv30.0e/Grid_0.25deg/tg/tg_se_master.nc</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 5.1.8 (Homepage = http://nco.sf.net, Code = http://github.com/nco/nco, Citation = 10.1016/j.envsoft.2008.03.004)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We can see from the data structure that our variable, ‚Äòtg‚Äô, is already stored in a four-dimensional array with dimensions: 5 time periods in ‚Äòperiod‚Äô, 366 days in ‚Äòdayofyear‚Äô, 36 steps in ‚Äòlatitude‚Äô, and 24 steps in ‚Äòlongitude‚Äô. This is because the toolbox provides an already post-processed output with the values calculated using the transformer function. In this use case, the following 30-years climatological periods are considered, as per the guidelines from the World Meteorological Organization (WMO):</p>
<ul class="simple">
<li><p>1951 to 1980</p></li>
<li><p>1961 to 1990</p></li>
<li><p>1971 to 2000</p></li>
<li><p>1981 to 2010</p></li>
<li><p>1991 to 2020</p></li>
</ul>
<p>This reduces the amount of data to be processed and stored locally, faclitating the next steps. Let‚Äôs inspect the data and compute the basic descriptive statistics of each period and print them in tabular form.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define ToI dictionary</span>
<span class="n">periods_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;1951-1980&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;1961-1990&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;1971-2000&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;1981-2010&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;1991-2020&#39;</span><span class="p">}</span>

<span class="c1"># Calculate descriptive statistics by ToI</span>

<span class="n">tg_nr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tg_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tg_max</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tg_min</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tg_std</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">periods_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    
    <span class="n">tg</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;TG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">tg</span> <span class="o">=</span> <span class="n">tg</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tg</span><span class="p">)]</span>
    
    <span class="n">tg_nr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span>
    <span class="n">tg_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">tg_max</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">tg_min</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">tg_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
    
<span class="c1"># Create a DataFrame from the dictionary and arrays</span>
<span class="n">tg_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">periods_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
    <span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="n">tg_nr</span><span class="p">,</span>
    <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">tg_mean</span><span class="p">,</span>
    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">tg_max</span><span class="p">,</span>
    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">tg_min</span><span class="p">,</span>
    <span class="s1">&#39;st.deviation&#39;</span><span class="p">:</span> <span class="n">tg_std</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">tg_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tg_data</span><span class="p">)</span>

<span class="n">tg_data</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1
2
3
4
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>number</th>
      <th>mean</th>
      <th>maximum</th>
      <th>minimum</th>
      <th>st.deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1951-1980</td>
      <td>363804</td>
      <td>13.012874</td>
      <td>27.751289</td>
      <td>-4.796083</td>
      <td>6.326315</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961-1990</td>
      <td>363804</td>
      <td>13.148788</td>
      <td>27.553490</td>
      <td>-5.267143</td>
      <td>6.340904</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1971-2000</td>
      <td>363804</td>
      <td>13.332286</td>
      <td>27.874889</td>
      <td>-4.063083</td>
      <td>6.288990</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1981-2010</td>
      <td>363804</td>
      <td>13.767691</td>
      <td>28.448269</td>
      <td>-4.169524</td>
      <td>6.446501</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1991-2020</td>
      <td>363804</td>
      <td>14.059449</td>
      <td>29.017223</td>
      <td>-2.867417</td>
      <td>6.506580</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define ToI dictionary</span>
<span class="n">periods_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;1951-1980&#39;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;1961-1990&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;1971-2000&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;1981-2010&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;1991-2020&#39;</span><span class="p">}</span>

<span class="c1"># Calculate descriptive statistics by ToI</span>

<span class="n">tgs_nr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tgs_mean</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tgs_max</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tgs_min</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">tgs_std</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">periods_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    
    <span class="n">tgs</span> <span class="o">=</span> <span class="n">dss</span><span class="p">[</span><span class="s1">&#39;TG Spread&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">tgs</span> <span class="o">=</span> <span class="n">tgs</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tgs</span><span class="p">)]</span>
    
    <span class="n">tgs_nr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tgs</span><span class="p">))</span>
    <span class="n">tgs_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tgs</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">tgs_max</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tgs</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">tgs_min</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tgs</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">tgs_std</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tgs</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
    
<span class="c1"># Create a DataFrame from the dictionary and arrays</span>
<span class="n">tgs_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">periods_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
    <span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="n">tgs_nr</span><span class="p">,</span>
    <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="n">tgs_mean</span><span class="p">,</span>
    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">tgs_max</span><span class="p">,</span>
    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">tgs_min</span><span class="p">,</span>
    <span class="s1">&#39;st.deviation&#39;</span><span class="p">:</span> <span class="n">tgs_std</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">tgs_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tgs_data</span><span class="p">)</span>

<span class="n">tgs_data</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>number</th>
      <th>mean</th>
      <th>maximum</th>
      <th>minimum</th>
      <th>st.deviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1951-1980</td>
      <td>363804</td>
      <td>1.890160</td>
      <td>3.782200</td>
      <td>0.533489</td>
      <td>0.458324</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961-1990</td>
      <td>363804</td>
      <td>1.851364</td>
      <td>3.974978</td>
      <td>0.483111</td>
      <td>0.480603</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1971-2000</td>
      <td>363804</td>
      <td>1.800041</td>
      <td>3.941917</td>
      <td>0.498867</td>
      <td>0.471629</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1981-2010</td>
      <td>363804</td>
      <td>1.759470</td>
      <td>3.885524</td>
      <td>0.509178</td>
      <td>0.494336</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1991-2020</td>
      <td>363804</td>
      <td>1.763770</td>
      <td>3.689417</td>
      <td>0.505667</td>
      <td>0.474165</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see from the descriptive statistics, the most recent climatological period is characterized by higher average temperatures - in the Iberian Peninsula, the mean annual TG between 1991 and 2020 is almost 1,0‚Å∞C above the equivalent in 1951 to 1980, while the annual maximum TG has a positive difference by more than 1,5‚Å∞C, and the annual minimum TG is characterized by a smaller, albeit positive, 0,5‚Å∞C difference. To further explore these findings, let‚Äôs print the spatial patterns of TG over the AoI.</p>
</section>
</section>
<section id="plot-the-climatology-for-alternative-30-year-periods">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3"></span><h3>3. Plot the climatology for alternative 30-year periods<a class="headerlink" href="#plot-the-climatology-for-alternative-30-year-periods" title="Link to this heading">#</a></h3>
<p>To evaluate the spatial patterns of E-OBS Daily Mean Temperatures, we will first need to define some helper functions to calculate the climatology and the probability density function.</p>
<section id="calculation-of-the-climatological-mean">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-1"></span><h4>3.1. Calculation of the Climatological Mean<a class="headerlink" href="#calculation-of-the-climatological-mean" title="Link to this heading">#</a></h4>
<p>With the subsets per period already created, now it is time to calculate the climatological mean for each one. Here, the calculation of the annual mean TG map for each day of the year (DOY) is done, while considering a 15-days Simple Moving Average (SMA), in  order to smooth the inter-days varibility.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define helper functions to plot maps</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span>
            <span class="p">[</span><span class="n">lon_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">.</span><span class="n">stop</span><span class="p">],</span>
            <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
   
    <span class="k">return</span> <span class="n">facet</span>

<span class="c1"># Define helper functions to plot PDF</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_pdf</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="n">da_subset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">)):</span>
        <span class="c1"># Save original attrs before converting to numpy</span>
        <span class="n">original_attrs</span> <span class="o">=</span> <span class="n">da_subset</span><span class="o">.</span><span class="n">attrs</span>

        <span class="c1"># Flatten and drop NaNs</span>
        <span class="n">da_flat</span> <span class="o">=</span> <span class="n">da_subset</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">da_flat</span> <span class="o">=</span> <span class="n">da_flat</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">da_flat</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">da_flat</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Compute histogram</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
            <span class="n">da_flat</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">da_flat</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">da_flat</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">50</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># Create DataArray</span>
        <span class="n">da_hist</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
            <span class="n">hist</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bins&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">da_hist</span><span class="p">[</span><span class="s2">&quot;bins&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">original_attrs</span>  <span class="c1"># Now this works</span>
        <span class="n">da_hist</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Probability Density&quot;</span>

        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da_hist</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;bins&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">period</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lines</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="mean-map-of-the-5-subsets-for-the-defined-aoi">
<h4>Mean Map of the 5 subsets, for the defined AoI<a class="headerlink" href="#mean-map-of-the-5-subsets-for-the-defined-aoi" title="Link to this heading">#</a></h4>
<p>‚Ä¶ having defined and calculated the climatological mean of each subset, we can now plot the annual mean TG map of the selected subsets.</p>
</section>
<section id="plot-tg-per-toi">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-2"></span><h4>3.2. Plot TG per ToI<a class="headerlink" href="#plot-tg-per-toi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;TG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">6</span>
<span class="p">)</span>

<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Yearly mean&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/f99ca139a8c98fa056f9f1708f38e4e7790d447e3dbff1d4c4d7702b5a32ca48.png" src="../_images/f99ca139a8c98fa056f9f1708f38e4e7790d447e3dbff1d4c4d7702b5a32ca48.png" />
</div>
</div>
</section>
<section id="plot-tg-spread-per-toi">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-3-3"></span><h4>3.3. Plot TG Spread per ToI<a class="headerlink" href="#plot-tg-spread-per-toi" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span>
    <span class="n">dss</span><span class="p">[</span><span class="s1">&#39;TG Spread&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">6</span>
<span class="p">)</span>

<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Yearly mean&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
<span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/5e5d30b06b4dcba6ee8b49a60a8ef0fc1017c0a81c5be6749961c554ef0975d6.png" src="../_images/5e5d30b06b4dcba6ee8b49a60a8ef0fc1017c0a81c5be6749961c554ef0975d6.png" />
</div>
</div>
<p>The results show already disclose some spatial patterns of the annual statistics summarised before: for instance, the increase of TG is more pronounced in southernmost part of the AoI, compared to the North. In addition, there is also a mean annual TG increase along the north-western coast of Portugal.</p>
</section>
</section>
<section id="calculate-the-probability-density-function-pdf-of-each-alternative-30-year-period">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-4"></span><h3>4. Calculate the probability density function (PDF) of each alternative 30-year period<a class="headerlink" href="#calculate-the-probability-density-function-pdf-of-each-alternative-30-year-period" title="Link to this heading">#</a></h3>
<p>To complement the statistics and the maps of the annual mean TG over the Iberian Peninsula, it is also useful to consider the full distribution of TG values which is a function of space and time. The PDF is useful to this effect, as is shows how frequent certain values are in a given period. In the following plot, we compare the PDF across the five climatology periods to emphasise how these frequencies have been changing.</p>
<section id="plot-pdf-and-pdf-per-toi-respectively">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-4-1"></span><h4>4.1. Plot PDF and PDF per TOI, respectively<a class="headerlink" href="#plot-pdf-and-pdf-per-toi-respectively" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot PDF per ToI</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;TG&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Plot PDF Spread per ToI</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">plot_pdf</span><span class="p">(</span><span class="n">dss</span><span class="p">[</span><span class="s1">&#39;TG Spread&#39;</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f06934a9110&gt;
</pre></div>
</div>
<img alt="../_images/4a9a1202ec5a174ff5943837511f4e8c6d085e1d0342a73b0899a3a487dd3b46.png" src="../_images/4a9a1202ec5a174ff5943837511f4e8c6d085e1d0342a73b0899a3a487dd3b46.png" />
<img alt="../_images/bf41590cf35e1e744983b165505ee479a19d597faa3529aa71cc71c1b772df31.png" src="../_images/bf41590cf35e1e744983b165505ee479a19d597faa3529aa71cc71c1b772df31.png" />
</div>
</div>
<p>From the plot, we can clearly see a shift in the distribution towards the right - i.e., mean annual TG values and increasing along the overall amplitude of TG observed, while the most extreme values seem to deviate more than the minimum. Interestingly, we see a suggestion of bi-modal pattern in TG. Conversely, the TG Spread shows larger values in earlier climatological periods - this agrees with the consistent increase of in-situ data available, along time.</p>
</section>
</section>
<section id="calculate-and-plot-seasonal-pdfs-and-the-climatological-season-maps">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-5"></span><h3>5. Calculate and plot seasonal PDFs and the climatological season maps<a class="headerlink" href="#calculate-and-plot-seasonal-pdfs-and-the-climatological-season-maps" title="Link to this heading">#</a></h3>
<p>To take the analysis further, it is also useful to proceed with the calculation of seasonal climatologies. In this case the Time of Interest (ToI) will consider only the coolest and warmer seasons of the year, i.e., Winter (December, January, and February - DJF) and Summer (June, July, and August - JJA). In both cases, we will plot their PDF and maps for all the five periods.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate and plot PDF and Maps per ToI and season</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">season</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;DJF&quot;</span><span class="p">,</span> <span class="s2">&quot;JJA&quot;</span><span class="p">],</span> <span class="n">axes</span><span class="p">)):</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;TG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">),</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">plot_pdf</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;TG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">),</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/b09168f69a013202f26066caa94b99b5823b1bd8e154abd5d0f607e337398fce.png" src="../_images/b09168f69a013202f26066caa94b99b5823b1bd8e154abd5d0f607e337398fce.png" />
<img alt="../_images/7697923523c9c5a2e6d8f8950c0043ce59c71f2bf11f7214f0a02e6daaa51406.png" src="../_images/7697923523c9c5a2e6d8f8950c0043ce59c71f2bf11f7214f0a02e6daaa51406.png" />
<img alt="../_images/951ff1f99ef540b7db295b596d6b063448eb993dda5bf716c9876bb05383cb6f.png" src="../_images/951ff1f99ef540b7db295b596d6b063448eb993dda5bf716c9876bb05383cb6f.png" />
</div>
</div>
</section>
<section id="calculate-seasonal-probability-density-function-of-each-alternative-30-year-period">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-6"></span><h3>6. Calculate seasonal probability density function of each alternative 30-year period<a class="headerlink" href="#calculate-seasonal-probability-density-function-of-each-alternative-30-year-period" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">season</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;DJF&quot;</span><span class="p">,</span> <span class="s2">&quot;JJA&quot;</span><span class="p">],</span> <span class="n">axes</span><span class="p">)):</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">dss</span><span class="p">[</span><span class="s1">&#39;TG Spread&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dss</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">),</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">col_wrap</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">plot_pdf</span><span class="p">(</span>
        <span class="n">dss</span><span class="p">[</span><span class="s1">&#39;TG Spread&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dss</span><span class="p">[</span><span class="s2">&quot;season&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">season</span><span class="p">),</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/823c9e67fee645eeade5ecee8828e5c62637e53d8ba52179aff29e8fb9a80f2e.png" src="../_images/823c9e67fee645eeade5ecee8828e5c62637e53d8ba52179aff29e8fb9a80f2e.png" />
<img alt="../_images/686cc783cfa8186ea01688c4f7184fed9fc1d8440fd2ce4832435b4ea56c559b.png" src="../_images/686cc783cfa8186ea01688c4f7184fed9fc1d8440fd2ce4832435b4ea56c559b.png" />
<img alt="../_images/b18a9ae70838e6199d07d6f0d7e13d23aabab5d24bd8ef54345c45ccc04b7adf.png" src="../_images/b18a9ae70838e6199d07d6f0d7e13d23aabab5d24bd8ef54345c45ccc04b7adf.png" />
</div>
</div>
<section id="discussion">
<h4>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h4>
<p>In the above plots, we can see a dissimilar spatial pattern between seasonal changes: in the Winter, the higher temperature changes are clustered along the Atlantic littoral zones, namely along the Portuguese western and the Spanish coasts; by contrast, in the Summer, the littoral does no increase as much and the hotspot for TG increase is shifted towards southern inland Spain. In complement, we can see here also contrasts: while the PDF results from the most recent periods show a positive TG change, this trend is much greater during the Summer when the full PDF is shifting upwards in the temperature range. By contrast, during Winter, the PDF has a lower shift that is significative over the higher temperature values only.</p>
<p>These findings show how the positive signal detected in the TG statistics over the Iberian Peninsula are, in fact, insufficient to disclose the full temporal and spatial variability of changes in the local and regional climate. This analysis successfully showcases the ability of using the E-OBS data to reveal such patterns and highlight where and when changes are greater, in more detail.</p>
<p>Nevertheless, TG ensemble spread shows inhomogeneous spatial patterns that arise from the irregular density of in-situ stations available, across the region. Indeed, this inhomogeneity indicates that EOBS accuracy is location-dependent. As described in this dataset‚Äôs documentation, the usage of this dataset should be with caution in interpreting trends and extremes, considering the potential limitations in accuracy and completeness, especially in regions with sparse observational data (Cornes et al., 2018). Furthermore, potential biases should be considered from these techniques and consider the spatial variability in data density when interpreting results. For instance, it may also be influenced by factors such as changes in observational practices, station location shifts, or urbanization effects, which can introduce uncertainties in the interpretation of long-term trends.</p>
<p>As an indicator of the confidence intervals associated with individual grid cells, the ensemble spread may provide insights into the reliability of data in specific locations, aiding in the assessment of uncertainties (Carvalho, Cardoso Pereira, and Rocha, 2021).</p>
</section>
</section>
<section id="main-takeaways">
<span id="insitu-insitu-gridded-observations-europe-climate-monitoring-q01-c3s2-d520-1-5-3-2-quality-assessment-user-questions-eobs-uq1-v1-10-code-section-7"></span><h3>7. Main takeaways<a class="headerlink" href="#main-takeaways" title="Link to this heading">#</a></h3>
<p>Observational-based gridded datasets, such as E-OBS, are relatively quick to download and analyse, due to its reduced dimensionallity (single surface level, daily values) and having a multi-decadal temporal coverage it offers an important source for climate change monitoring.
Being the result of spatial interpolation techniques, E-OBS is subject to the inherent limitations of having inhomogenous coverage of in situ stations.
As a result,</p>
<ul class="simple">
<li><p>There is a visible difference between air temperature climatologies from different periods, as the earliest 30-years subset (1951-1980) shows an overall ‚Äúcolder‚Äù annual mean air temperature, while the latest 30-years subset (1991-2020) shows the ‚Äúwarmest‚Äù one, over the Iberian Peninsula. <em>Carvalho, Cardoso Pereira, and Rocha (2021)</em> conclusion supports this alignment, in which the authors observed  significant increases in mean, maximum, and minimum surface temperatures for the medium-term (2046‚Äì2065) and long-term (2081‚Äì2100) futures.</p></li>
<li><p>In addition, these changes are progressive along the time dimension, i.e., each climatology reveals an increased mean annual temperature, compared to the 10-years previous one.</p></li>
<li><p>These deviations aren‚Äôt the same across all of the statistical distribution, i.e., there are greater upwards deviations in the upper values of the mean annual air temperature, when compared with the lowest ones. The Probability Density Function (PDF) graphs thus show that there is a shift towards the right but also changes in the simmetry with larger increase of warmer temperatures.</p></li>
<li><p>These changes are also visible at seasonal level, with less variance on the Winter Season  PDF (DJF) when compared with the Summer Season PDF (JJA).</p></li>
<li><p>Furthermore, there is an evident spatial pattern regarding the changes observed on the Climatological Mean Maps, with significant differences between the south and westernmost parts of the Iberia Peninsula (warmer), compared to the interior and northernmost regions (colder). These spatial variations, aligns with <em>Cornes et al. (2018)</em>, where was analysed the ensemble dataset‚Äôs spatial variation, influenced by station density, in which supports the observations of spatial patterns in temperature changes over the Iberian Peninsula.</p></li>
<li><p>Whenever using climatological data for their application, the user should carefully consider that the results are sensible to the chosen time of interest. This is especially true to applications which are highly sensitive to air temperature differences (e.g., estimation of energy needs, analysis of extreme events based on percentiles).</p></li>
</ul>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entry for the data used were:</p>
<ul class="simple">
<li><p>E-OBS daily gridded meteorological data for Europe from 1950 to present derived from in-situ observations:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/insitu-gridded-observations-europe?tab=overview">https://cds.climate.copernicus.eu/datasets/insitu-gridded-observations-europe?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/index.php?lvl=notice_display&amp;amp;id=20130">[1]</a> World Meteorological Organization (WMO) Guidelines on the Calculation of Climate Normals:</p>
<p><a class="reference external" href="https://doi.org/10.1029/2017JD028200">[2]</a> Cornes, R., G. van der Schrier, E.J.M. van den Besselaar, and P.D. Jones. 2018: An Ensemble Version of the E-OBS Temperature and Precipitation Datasets, J. Geophys. Res. (Atmospheres), 123.</p>
<p><a class="reference external" href="https://doi.org/10.1007/S00382-020-05472-3">[3]</a> Carvalho, D., S. Cardoso Pereira, and A. Rocha. 2021. ‚ÄúFuture Surface Temperature Changes for the Iberian Peninsula According to EURO-CORDEX Climate Projections.‚Äù Climate Dynamics 56 (1‚Äì2): 123‚Äì38. .</p>
<p><a class="reference external" href="https://climate.copernicus.eu/esotc/2023">[4]</a> Copernicus Climate Change Service (C3S), 2024.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./In_Situ"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="insitu.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Insitu Observations</p>
      </div>
    </a>
    <a class="right-next"
       href="../Reanalyses/reanalysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessment-of-climate-change">üåç Use case: Assessment of Climate Change.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-aoi-search-and-download-e-obs">1. Define the AoI, search and download E-OBS</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-the-libraries-packages">Import all the libraries/packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-and-view-data">2. Inspect and view data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-statistics">Basic statistics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-climatology-for-alternative-30-year-periods">3. Plot the climatology for alternative 30-year periods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-the-climatological-mean">3.1. Calculation of the Climatological Mean</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-map-of-the-5-subsets-for-the-defined-aoi">Mean Map of the 5 subsets, for the defined AoI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tg-per-toi">3.2. Plot TG per ToI</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-tg-spread-per-toi">3.3. Plot TG Spread per ToI</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-probability-density-function-pdf-of-each-alternative-30-year-period">4. Calculate the probability density function (PDF) of each alternative 30-year period</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-pdf-and-pdf-per-toi-respectively">4.1. Plot PDF and PDF per TOI, respectively</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-and-plot-seasonal-pdfs-and-the-climatological-season-maps">5. Calculate and plot seasonal PDFs and the climatological season maps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-seasonal-probability-density-function-of-each-alternative-30-year-period">6. Calculate seasonal probability density function of each alternative 30-year period</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-takeaways">7. Main takeaways</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>