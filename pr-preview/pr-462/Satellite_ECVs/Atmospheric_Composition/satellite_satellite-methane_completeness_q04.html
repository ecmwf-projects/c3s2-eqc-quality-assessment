
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.1. Methane satellite observations completeness assessment for greenhouse gas monitoring &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q04';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.3. Cryosphere" href="../Cryosphere/Cryosphere.html" />
    <link rel="prev" title="1.2. Atmospheric Composition" href="Atmospheric_Composition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.1. Methane satellite observations completeness assessment for greenhouse gas monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Methane satellite observations completeness assessment for greenhouse gas monitoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-column-averaged-xch-4-observations-for-investigating-global-and-zonal-methane-growth-rates">🌍 Use case: Using satellite column-averaged XCH<span class="math notranslate nohighlight">\(_4\)</span> observations for investigating global and zonal methane growth rates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">📢 Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-temporal-coverage">Choose the temporal coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-xch-4-data-emma-level-2">2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (EMMA, Level 2)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-annual-xch-4-increases">Global annual XCH<span class="math notranslate nohighlight">\(_4\)</span> increases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-growth-rates-of-xch-4">Zonal growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-growth-rate-anomalies-of-xch-4">Zonal growth rate anomalies of XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="methane-satellite-observations-completeness-assessment-for-greenhouse-gas-monitoring">
<h1><span class="section-number">1.2.1. </span>Methane satellite observations completeness assessment for greenhouse gas monitoring<a class="headerlink" href="#methane-satellite-observations-completeness-assessment-for-greenhouse-gas-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 30-09-2025</p>
<p>Produced by: CNR</p>
<section id="use-case-using-satellite-column-averaged-xch-4-observations-for-investigating-global-and-zonal-methane-growth-rates">
<h2>🌍 Use case: Using satellite column-averaged XCH<span class="math notranslate nohighlight">\(_4\)</span> observations for investigating global and zonal methane growth rates<a class="headerlink" href="#use-case-using-satellite-column-averaged-xch-4-observations-for-investigating-global-and-zonal-methane-growth-rates" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Is the spatial coverage of XCH<span class="math notranslate nohighlight">\(_4\)</span> EMMA Level 2 merged dataset suitable to calculate the methane annual global and zonal growth rates?</strong></p></li>
</ul>
<p>Methane (CH<span class="math notranslate nohighlight">\(_4\)</span>) is the second most important anthropogenic greenhouse gas after carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>), representing about 19% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://library.wmo.int/idurl/4/68532" rel="noreferrer" target="_blank">[1]</a>. Atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> also adversely affects human health as a precursor of tropospheric ozone <a class="reference external" href="https://doi.org/10.1073/pnas.0600201103" rel="noreferrer" target="_blank">[2]</a>. Monitoring the long-term CH<span class="math notranslate nohighlight">\(_4\)</span> variability is therefore crucial for tracking the emission reductions <a class="reference external" href="https://doi.org/10.5194/essd-17-1873-2025" rel="noreferrer" target="_blank">[3]</a>. Calculating growth rates is particularly important, as they provide a direct measure of how atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> responds to changing emissions and sinks, and help disentangle interannual variability from long-term trends (<a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1038/s41558-023-01629-0" rel="noreferrer" target="_blank">[5]</a>).</p>
<p>In this assessment, atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> global and zonal growth rates are derived from the XCH<span class="math notranslate nohighlight">\(_4\)</span> merged Ensemble Median Algorithm (EMMA) Level 2 dataset (version 4.5 <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a>), by adopting an approach similar to <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>.</p>
<p>The EMMA Level 2 data products comprise individual soundings retrieved by algorithms that can change from grid box to grid box and from month to month. For more details see <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>. By analyzing an ensemble of different Level 2 datasets from various retrieval algorithms, the EMMA algorithm generates a dataset containing XCH<span class="math notranslate nohighlight">\(_4\)</span> from individual retrievals. In particular, for each month and 10°<span class="math notranslate nohighlight">\(\times\)</span>10° grid box, the algorithm with the grid box mean closest to the median is selected. The list of the considered retrieval algorithms is available from <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a>. The various retrieval algorithms are optimized for different instruments (SCIAMACHY, GOSAT, GOSAT-2), which measure backscattered solar radiation in the near-infrared for O<span class="math notranslate nohighlight">\(_2\)</span> as well as the absorption bands of CO<span class="math notranslate nohighlight">\(_2\)</span> or CH<span class="math notranslate nohighlight">\(_4\)</span>.</p>
<p>The code is included for transparency and learning purposes, giving users the chance to adapt it for their own analyses. Users should always refer to the official reports for scientific assessments related to atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> variability (e.g., <a class="reference external" href="https://doi.org/10.24381/14j9-s541" rel="noreferrer" target="_blank">[8]</a>, <a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024" rel="noreferrer" target="_blank">[9]</a>).</p>
</section>
<section id="quality-assessment-statements">
<h2>📢 Quality assessment statements<a class="headerlink" href="#quality-assessment-statements" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The dataset “Methane data from 2002 to present derived from satellite observations” can be used to evaluate XCH<span class="math notranslate nohighlight">\(_4\)</span> global and zonal growth rates.</p></li>
<li><p>For the high-latitude zonal bands ([70 °N-90 °N] and  [90 °S-70 °S]), the few available data prevent a solid quantification of annual growth rates. In addition, for the latitude bands [70 °S-50 °S] and [50 °N-70 °N], the monthly growth rates before March 2009 should be treated with extreme caution, as they are affected by non-uniform data coverage and high uncertainties in the data.</p></li>
<li><p>Before 2009, the global annual growth rates are characterised by higher standard deviations and thus must be considered with caution.</p></li>
<li><p>The different averaging methods do not particularly affect the growth rate distributions and growth rate anomalies, both globally and zonally.</p></li>
<li><p>The reduction in the global XCH<span class="math notranslate nohighlight">\(_4\)</span> increases in 2022 with respect to 2021 can be attributed to decreased growth rates in the Northern Hemisphere, as growth rates in the Southern Hemisphere remained high.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>In this notebook, we investigate whether the merged EMMA Level 2 product is suitable for calculating XCH<span class="math notranslate nohighlight">\(_4\)</span> growth rates, over 2004-2022. The input data are the XCH<span class="math notranslate nohighlight">\(_4\)</span> merged EMMA Level 2 files (version 4.5, see <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a>). For the calculations, and following the approach presented in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, the merged EMMA Level 2 data were first regridded onto a daily regular 2°<span class="math notranslate nohighlight">\(\times\)</span>2° grid, using spatially weighted mean. A possible extension of this notebook could be the application of the inhomogeneity treatment to the input data (see <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>), which is not implemented here.</p>
<p>In this analysis, to estimate XCH<span class="math notranslate nohighlight">\(_4\)</span> global increases and zonal growth rates (in 20° latitude bands), we calculated the monthly growth rates as the centered rolling difference between the XCH<span class="math notranslate nohighlight">\(_4\)</span> value of month <span class="math notranslate nohighlight">\(i\)</span> and the XCH<span class="math notranslate nohighlight">\(_4\)</span> value of month <span class="math notranslate nohighlight">\(i\)</span>-12. As done in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, we also compare two different methods for calculating monthly averages, i.e.:</p>
<ul class="simple">
<li><p>the “standard averaging”, defined as the area-weighted mean of all grid cells in the region of interest;</p></li>
<li><p>the “zonal-first averaging”, which is computed by first evaluating the <span class="math notranslate nohighlight">\(m\)</span> averages for all 2° latitude bands, and then averaging these <span class="math notranslate nohighlight">\(m\)</span> zonal averages. <span class="math notranslate nohighlight">\(m\)</span> can be equal to 90 for global data, or, e.g., 10 for a 20° zonal band.</p></li>
</ul>
<p>The zonal-first average should ensure a consistent weighting of all the latitudes, regardless of their individual coverage (<a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>).</p>
<p>For better investigating the differences between the hemispheres concerning growth rates, we also computed growth rate anomalies, defined as the difference between the zonal and the global growth rates.</p>
<p>The analysis and results are organized in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q04-template-section-1"><span class="std std-ref">1. Choose the data to use and set-up the code</span></a></strong></p>
<ul class="simple">
<li><p>Import all the relevant packages.</p></li>
<li><p>Choose the temporal coverage for the analysis.</p></li>
<li><p>Cache needed functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q04-template-section-2"><span class="std std-ref">2. Retrieve XCH_4 data (EMMA, Level 2)</span></a></strong></p>
<ul class="simple">
<li><p>In this section, we define the data request to CDS.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q04-template-section-3"><span class="std std-ref">3. Data analysis</span></a></strong></p>
<p>This section presents several results for the XCH<span class="math notranslate nohighlight">\(_4\)</span> growth rates, i.e.:</p>
<ul class="simple">
<li><p>the calculation of global XCH<span class="math notranslate nohighlight">\(_4\)</span> increases</p></li>
<li><p>the calculation of the zonal XCH<span class="math notranslate nohighlight">\(_4\)</span> growth rates (into 20° latitude bands), to provide spatial information on the global CH<span class="math notranslate nohighlight">\(_4\)</span> increases</p></li>
<li><p>the computation of the zonal growth rate anomalies, defined as the differences between zonal and global growth rates</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-methane-completeness-q04-template-section-1"></span><h3>1. Choose the data to use and set-up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-relevant-packages">
<h4>Import all relevant packages<a class="headerlink" href="#import-all-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook and we define the style for plot appearance (“seaborn-v0_8-notebook”).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xarray.groupers</span><span class="w"> </span><span class="kn">import</span> <span class="n">BinGrouper</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="choose-the-temporal-coverage">
<h4>Choose the temporal coverage<a class="headerlink" href="#choose-the-temporal-coverage" title="Link to this heading">#</a></h4>
<p>In this section, we define the temporal period of the analysis, that can be customized by the user. For this notebook, we selected the 2004-2022 period.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_start</span> <span class="o">=</span> <span class="mi">2004</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2022</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="cache-needed-functions">
<h4>Cache needed functions<a class="headerlink" href="#cache-needed-functions" title="Link to this heading">#</a></h4>
<p>In this section, we cached a list of functions used in the analyses.</p>
<ul class="simple">
<li><p>The functions <code class="docutils literal notranslate"><span class="pre">spatial_weighted_mean</span></code> and <code class="docutils literal notranslate"><span class="pre">spatial_weighted_std</span></code>compute the spatial XCH<span class="math notranslate nohighlight">\(_4\)</span> mean and standard deviation, respectively, over the selected domain. Through the function named <code class="docutils literal notranslate"><span class="pre">weight_dataset</span></code>, they use spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids. This is a common approach, e.g., in the treatment of reanalysis and forecast model data.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">regrid</span></code> regrids the XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 2 data onto a regular <span class="math notranslate nohighlight">\(m \times n\)</span> grid, where <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span> can be customized by the user. It uses <code class="docutils literal notranslate"><span class="pre">spatial_weighted_mean</span></code> for grouping data onto the regular grid.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">daily_regrid</span></code> uses the aforementioned <code class="docutils literal notranslate"><span class="pre">regrid</span></code> function for regridding the XCH<span class="math notranslate nohighlight">\(_4\)</span> data onto a regular <span class="math notranslate nohighlight">\(m\)</span>°<span class="math notranslate nohighlight">\(\times\)</span><span class="math notranslate nohighlight">\(n\)</span>° grid, with a daily time resolution. Again, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(n\)</span> can be customized by the user.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">monthly_regrid_in_bands</span></code> resamples the input dataset into <span class="math notranslate nohighlight">\(n\)</span>° latitude bands, by using the <code class="docutils literal notranslate"><span class="pre">regrid</span></code> function and a monthly time resolution. <span class="math notranslate nohighlight">\(n\)</span> is a parameter that can be specified by the user within the function. If the option <code class="docutils literal notranslate"><span class="pre">zonal_first</span></code> is selected, then the zonal-first averaging is calculated, following the methodology presented in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a> and described above.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">compute_growth_rate</span></code> calculates the monthly resolved annual growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span>, computed as the centered rolling difference of the XCH<span class="math notranslate nohighlight">\(_4\)</span> value of month <span class="math notranslate nohighlight">\(i\)</span> minus the XCH<span class="math notranslate nohighlight">\(_4\)</span> value of month <span class="math notranslate nohighlight">\(i\)</span>-12.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">band_from_central_latitude</span></code> is used for explicitly specifying the latitude extremes rather than the central latitude for each band.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">weight_dataset</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">spatial_weighted_mean</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">weight_dataset</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">spatial_weighted_std</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">weight_dataset</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">d_lon</span><span class="p">,</span> <span class="n">d_lat</span><span class="p">,</span> <span class="n">lon1</span><span class="o">=</span><span class="mi">180</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lon1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lon1 must be 180 or 360. </span><span class="si">{</span><span class="n">lon1</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lon0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span> <span class="k">if</span> <span class="n">lon1</span> <span class="o">==</span> <span class="mi">180</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="n">lon1</span><span class="p">],</span>
        <span class="p">[</span><span class="n">d_lat</span><span class="p">,</span> <span class="n">d_lon</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">coords</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">BinGrouper</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span>
            <span class="n">include_lowest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">stop</span> <span class="o">+</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Groupby map does not work with dask</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="o">**</span><span class="n">coords</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">spatial_weighted_mean</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coord</span><span class="si">}</span><span class="s2">_bins&quot;</span><span class="p">:</span> <span class="n">coord</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">daily_regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[[</span><span class="s2">&quot;xch4&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]]</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">time</span><span class="p">,</span> <span class="n">ds_time</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)):</span>
        <span class="n">ds_time</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">ds_time</span><span class="p">,</span> <span class="n">d_lon</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">d_lat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_time</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">monthly_regrid_in_bands</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">zonal_first</span><span class="p">):</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">time</span><span class="p">,</span> <span class="n">ds_time</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1MS&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">zonal_first</span><span class="p">:</span>
            <span class="n">ds_time</span> <span class="o">=</span> <span class="n">ds_time</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ds_time</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">ds_time</span><span class="p">,</span> <span class="n">d_lat</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">d_lon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_time</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_growth_rate</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">zonal_first</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">monthly_regrid_in_bands</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">zonal_first</span><span class="p">)[</span><span class="s2">&quot;xch4&quot;</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">da</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;window_dim&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">window_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s2">&quot;window_dim&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;ppm/year&quot;</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Growth Rate&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">da</span>

<span class="k">def</span><span class="w"> </span><span class="nf">band_from_central_latitude</span><span class="p">(</span><span class="n">latitude</span><span class="p">):</span>
    <span class="n">latitudes</span> <span class="o">=</span> <span class="p">[</span><span class="n">latitude</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">latitude</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>
    <span class="k">return</span> <span class="s2">&quot; – &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="si">}</span><span class="s2">°</span><span class="si">{</span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">latitudes</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="retrieve-xch-4-data-emma-level-2">
<span id="satellite-satellite-methane-completeness-q04-template-section-2"></span><h3>2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (EMMA, Level 2)<a class="headerlink" href="#retrieve-xch-4-data-emma-level-2" title="Link to this heading">#</a></h3>
<p>In this section, we define the data request to CDS (merged EMMA data product, Level 2, version 4.5, XCH<span class="math notranslate nohighlight">\(_4\)</span>) and download the dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-methane&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="s2">&quot;level_2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;xch4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;merged_emma&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;4_5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">daily_regrid</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 19/19 [00:01&lt;00:00, 12.34it/s]
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-analysis">
<span id="satellite-satellite-methane-completeness-q04-template-section-3"></span><h3>3. Data analysis<a class="headerlink" href="#data-analysis" title="Link to this heading">#</a></h3>
<section id="global-annual-xch-4-increases">
<h4>Global annual XCH<span class="math notranslate nohighlight">\(_4\)</span> increases<a class="headerlink" href="#global-annual-xch-4-increases" title="Link to this heading">#</a></h4>
<p>In this section, we present the global annual growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span>, defined as the average of all monthly growth rates within each calendar year. For the calculation of growth rates, two different averaging methods were applied to the regridded (onto a daily regular 2°<span class="math notranslate nohighlight">\(\times\)</span>2° grid) Level 2 data, following the methodology presented in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>. The “standard averaging” is defined as the spatially weighted average of all grid cells in a given region. This was compared to the so-called “zonal-first averaging”, which is computed as follows: (i) first, the 90 averages for all 2° latitude bands are computed; then (ii) the average of these 90 zonal averages is calculated, yielding each monthly value of the global time series. As shown in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, the zonal-first averaging has the advantage of taking into account the inhomogeneous sampling at each latitude, which is influenced by both the distribution of land mass and the seasonal coverage of measurements.</p>
<p>In agreement with recent studies (e.g., <a class="reference external" href="https://doi.org/10.5194/acp-23-4863-2023" rel="noreferrer" target="_blank">[10]</a>), the behavior of the global XCH<span class="math notranslate nohighlight">\(_4\)</span> growth rate has shown a near-zero growth until 2007, followed by a clear acceleration in subsequent years due to increased emissions from wetlands in the tropics and from anthropogenic sources at the mid-latitudes of the Northern Hemisphere (<a class="reference external" href="https://library.wmo.int/idurl/4/68532" rel="noreferrer" target="_blank">[1]</a>), with maxima observed in the last three years of the time series. The highest global annual XCH<span class="math notranslate nohighlight">\(_4\)</span> increases were recorded in 2021, followed by 2022 and 2020. According to <a class="reference external" href="https://doi.org/10.5194/acp-23-4863-2023" rel="noreferrer" target="_blank">[10]</a>, most of the observed increase in atmospheric XCH<span class="math notranslate nohighlight">\(_4\)</span> during 2020 and 2021 was due to increased emissions, with a significant contribution from reduced levels of OH. A recent study (<a class="reference external" href="https://doi.org/10.5194/acp-25-6757-2025" rel="noreferrer" target="_blank">[11]</a>) suggests a prominent role of biogenic emissions in Asian regions for the persistent high growth rate observed during 2020–2022. The results obtained using the two different averaging methods are comparable for all years, indicating that the choice of the averaging method does not significantly affect the estimated growth rates.</p>
<p>In the plot, also uncertainties are reported, and these are computed as the annual standard deviation of all monthly growth rates within each calendar year. The most evident feature is the overall decrease in the uncertainties after 2009, likely due to the introduction of algorithms based on GOSAT observations used to calculate the median XCH<span class="math notranslate nohighlight">\(_4\)</span> data <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">zonal_first</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]:</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">compute_growth_rate</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">zonal_first</span><span class="o">=</span><span class="n">zonal_first</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Zonal-first&quot;</span> <span class="k">if</span> <span class="n">zonal_first</span> <span class="k">else</span> <span class="s2">&quot;Standard&quot;</span><span class="p">])</span>
    <span class="p">)</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span>
<span class="n">da_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">spatial_weighted_mean</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
<span class="n">da_std</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">spatial_weighted_std</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
<span class="n">df_mean</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">df_std</span> <span class="o">=</span> <span class="n">da_std</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df_mean</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">yerr</span><span class="o">=</span><span class="n">df_std</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_mean</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_mean</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># removes x-axis label</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/9ca2ee045b6c8fe9fa5596c44a05c80a1e32b4171567ab2cda9d6abf988e1858.png" src="../../_images/9ca2ee045b6c8fe9fa5596c44a05c80a1e32b4171567ab2cda9d6abf988e1858.png" />
</div>
</div>
<p><em>Global annual XCH<span class="math notranslate nohighlight">\(_4\)</span> increases over 2004-2022. The colors differentiate between the standard averaging (orange) and the zonal-first averaging (blue) methods. Bars indicate the uncertainties in the annual increases, computed as <span class="math notranslate nohighlight">\(\pm\)</span>1 standard deviation.</em></p>
</section>
<section id="zonal-growth-rates-of-xch-4">
<h4>Zonal growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span><a class="headerlink" href="#zonal-growth-rates-of-xch-4" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and report the monthly growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span>, divided into 20° latitude bands, to provide spatial context for the global growth rates presented above.</p>
<p>The figure shows the zonal growth rates for the nine 20° latitude bands, using the two different averaging methods described previously. Please note that the limits on the y-axis can be customized by the user.</p>
<p>For most latitude bands, the behavior is similar to that observed for the global growth rates. The [70 °N-90 °N] band, however, is characterized by almost no clear tendency throughout the years, and this is because the high-latitude regions are characterized by sparse sampling and higher uncertainties in the data. Data below 60 °S are only available until 2005, and this is the cause for almost completely missing data in the [70 °S-90 °S] latitude band (<a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a>). For the latitude bands [70 °S-50 °S] and [50 °N-70 °N], the monthly growth rates are characterised by a higher temporal variability before March 2009, as data over land is only available from the SCIAMACHY WFMD product in this period (<a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a>).</p>
<p>The two different averaging methods show better agreement after 2010, with nearly identical results across all zonal bands. Before 2010, the growth rates exhibit higher variability, with larger differences between standard and zonal-first averaging. This is likely due to the introduction, after 2009, of algorithms incorporating GOSAT observations to calculate median XCH<span class="math notranslate nohighlight">\(_4\)</span> values <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a>.</p>
<p>Interestingly, as also reported in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, the reduction in global XCH<span class="math notranslate nohighlight">\(_4\)</span> growth in 2022 with respect to 2021 can be attributed to decreased growth rates in the Northern Hemisphere (particularly evident in the [10 °N-30 °N] and [30 °N-50 °N] latitude bands), while growth rates in the Southern Hemisphere remain high.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">])</span>  <span class="c1"># set your desired limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>       <span class="c1"># removes the x-axis label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">band_from_central_latitude</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
        <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/801d868cccd834af607e22f80df865eb55e2606c060dfff476d44313f4cb876d.png" src="../../_images/801d868cccd834af607e22f80df865eb55e2606c060dfff476d44313f4cb876d.png" />
</div>
</div>
<p><em>Zonal growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span>, over 2004-2022. The panels indicate the 20° latitude bands selected for the analysis. The colors differentiate between the standard averaging (orange) and the zonal-first averaging (blue) methods.</em></p>
</section>
<section id="zonal-growth-rate-anomalies-of-xch-4">
<h4>Zonal growth rate anomalies of XCH<span class="math notranslate nohighlight">\(_4\)</span><a class="headerlink" href="#zonal-growth-rate-anomalies-of-xch-4" title="Link to this heading">#</a></h4>
<p>In this section, we calculate and report the zonal growth rate anomalies, defined as the difference between the zonal and global growth rates for each of the 20° latitude bands presented above. As also indicated in <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>, the zonal growth rate anomalies can help in better visualizing differences between the hemispheres. Moreover, the anomalies, together with the zonal growth rates, are important for better interpreting the changes in the global methane increases.</p>
<p>As already observed for the zonal growth rates presented above, the choice of the averaging method does not significantly affect the calculated anomalies.</p>
<p>From the heatmaps of the anomalies, several features are consistent with previous studies (e.g., <a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a>). In 2019, a slowdown in growth rates was observed in the Southern Hemisphere, while growth rates in the Northern Hemisphere remained positive. This was followed by predominantly positive anomalies until 2022. In that year, as already noted for the zonal growth rates, the Northern Hemisphere showed a marked slowdown in XCH<span class="math notranslate nohighlight">\(_4\)</span> increases, as reflected by the negative anomalies.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">anomaly</span> <span class="o">=</span> <span class="n">da</span> <span class="o">-</span> <span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
<span class="n">anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Δ&quot;</span> <span class="o">+</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">long_name</span>
<span class="n">yticks</span> <span class="o">=</span> <span class="n">anomaly</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">facet</span> <span class="o">=</span> <span class="n">anomaly</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">row</span><span class="o">=</span><span class="s2">&quot;method&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="n">yticks</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>   <span class="c1"># removes x-axis label</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">band_from_central_latitude</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="k">for</span> <span class="n">lat</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/ac32d35d069f0e696f7cc1f8d0307b1fca704d3054ada089628542909e01805c.png" src="../../_images/ac32d35d069f0e696f7cc1f8d0307b1fca704d3054ada089628542909e01805c.png" />
</div>
</div>
<p><em>Zonal growth rate anomalies of XCH<span class="math notranslate nohighlight">\(_4\)</span>, for the 20° latitude bands presented above, over 2004-2022. The anomalies are defined as the differences between zonal and global growth rates. The top panel is for the standard averaging, while the bottom panel is for the zonal-first averaging.</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Methane data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview</a></p></li>
</ul>
<p>Users interested in near-real time detection of hot-spot locations for methane emissions can consider to use the CAMS Methane Hotspot Explorer: <a class="reference external" href="https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;amp;utm_medium=referral&amp;amp;utm_campaign=CH4-app-2025" rel="noreferrer" target="_blank">https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;utm_medium=referral&amp;utm_campaign=CH4-app-2025</a></p>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/idurl/4/68532" rel="noreferrer" target="_blank">[1]</a> World Meteorological Organization (2023). WMO Greenhouse Gas Bulletin, No. 19, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.1073/pnas.0600201103" rel="noreferrer" target="_blank">[2]</a> West, J. J., Fiore, A. M., Horowitz, L. W., and Mauzerall, D. L. (2006). Global health benefits of mitigating ozone pollution with methane emission controls, Proceedings of the National Academy of Sciences USA, 103, 3988–3993.</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-17-1873-2025" rel="noreferrer" target="_blank">[3]</a> Saunois, M., Martinez, A., Poulter, B., Zhang, Z., Raymond, P. A., Regnier, P., Canadell, J. G., Jackson, R. B., Patra, P. K., Bousquet, P., Ciais, P., Dlugokencky, E. J., Lan, X., Allen, G. H., Bastviken, D., Beerling, D. J., Belikov, D. A., Blake, D. R., Castaldi, S., Crippa, M., Deemer, B. R., Dennison, F., Etiope, G., Gedney, N., Höglund-Isaksson, L., Holgerson, M. A., Hopcroft, P. O., Hugelius, G., Ito, A., Jain, A. K., Janardanan, R., Johnson, M. S., Kleinen, T., Krummel, P. B., Lauerwald, R., Li, T., Liu, X., McDonald, K. C., Melton, J. R., Mühle, J., Müller, J., Murguia-Flores, F., Niwa, Y., Noce, S., Pan, S., Parker, R. J., Peng, C., Ramonet, M., Riley, W. J., Rocher-Ros, G., Rosentreter, J. A., Sasakawa, M., Segers, A., Smith, S. J., Stanley, E. H., Thanwerdas, J., Tian, H., Tsuruta, A., Tubiello, F. N., Weber, T. S., van der Werf, G. R., Worthy, D. E. J., Xi, Y., Yoshida, Y., Zhang, W., Zheng, B., Zhu, Q., Zhu, Q., and Zhuang, Q. (2025). Global Methane Budget 2000–2020, Earth System Science Data, 17, 1873-1958.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-24-577-2024" rel="noreferrer" target="_blank">[4]</a> Hachmeister, J., Schneising, O., Buchwitz, M., Burrows, J. P., Notholt, J., and Buschmann, M. (2024). Zonal variability of methane trends derived from satellite data, Atmospheric Chemistry and Physics, 24, 577–595.</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41558-023-01629-0" rel="noreferrer" target="_blank">[5]</a> Zhang, Z., Poulter, B., Feldman, A.F., Ying, Q., Ciais, P., Peng, S., and Li, X. (2023). Recent intensification of wetland methane feedback, Nature Climate Change, 13, 430–433.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf" rel="noreferrer" target="_blank">[6]</a> Buchwitz, M. (2024). Product User Guide and Specification (PUGS) – Main document for Greenhouse Gas (GHG: CO<span class="math notranslate nohighlight">\(_2\)</span> &amp; CH<span class="math notranslate nohighlight">\(_4\)</span>) data set CDR7 (01.2003-12.2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.3.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf" rel="noreferrer" target="_blank">[7]</a> Reuter, M., and Buchwitz, M. (2024). Algorithm Theoretical Basis Document (ATBD) – ANNEX D for products XCO2_EMMA, XCH4_EMMA, XCO2_OBS4MIPS, XCH4_OBS4MIPS (v4.5, CDR7, 2003-2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.1b.</p>
<p><a class="reference external" href="https://doi.org/10.24381/14j9-s541" rel="noreferrer" target="_blank">[8]</a> Copernicus Climate Change Service (C3S) and World Meteorological Organization (WMO). (2025). European State of the Climate 2024.</p>
<p><a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024" rel="noreferrer" target="_blank">[9]</a> Copernicus Climate Change Service (C3S). (2025). Global Climate Highlights 2024.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-23-4863-2023" rel="noreferrer" target="_blank">[10]</a> Feng, L., Palmer, P. I., Parker, R. J., Lunt, M. F., and Bösch, H. (2023). Methane emissions are predominantly responsible for record-breaking atmospheric methane growth rates in 2020 and 2021, Atmospheric Chemistry and Physics, 23, 4863-4880.</p>
<p><a class="reference external" href="https://doi.org/10.5194/acp-25-6757-2025" rel="noreferrer" target="_blank">[11]</a> Niwa, Y., Tohjima, Y., Terao, Y., Saeki, T., Ito, A., Umezawa, T., Yamada, K., Sasakawa, M., Machida, T., Nakaoka, S.-I., Nara, H., Tanimoto, H., Mukai, H., Yoshida, Y., Morimoto, S., Takatsuji, S., Tsuboi, K., Sawa, Y., Matsueda, H., Ishijima, K., Fujita, R., Goto, D., Lan, X., Schuldt, K., Heliasz, M., Biermann, T., Chmura, L., Necki, J., Xueref-Remy, I., and Sferlazzo, D. (2025). Multi-observational estimation of regional and sectoral emission contributions to the persistent high growth rate of atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> for 2020–2022, Atmospheric Chemistry and Physics, 25, 6757–6785.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Atmospheric_Composition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2. </span>Atmospheric Composition</p>
      </div>
    </a>
    <a class="right-next"
       href="../Cryosphere/Cryosphere.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.3. </span>Cryosphere</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-column-averaged-xch-4-observations-for-investigating-global-and-zonal-methane-growth-rates">🌍 Use case: Using satellite column-averaged XCH<span class="math notranslate nohighlight">\(_4\)</span> observations for investigating global and zonal methane growth rates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">📢 Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-temporal-coverage">Choose the temporal coverage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cache-needed-functions">Cache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-xch-4-data-emma-level-2">2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (EMMA, Level 2)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analysis">3. Data analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-annual-xch-4-increases">Global annual XCH<span class="math notranslate nohighlight">\(_4\)</span> increases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-growth-rates-of-xch-4">Zonal growth rates of XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#zonal-growth-rate-anomalies-of-xch-4">Zonal growth rate anomalies of XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>