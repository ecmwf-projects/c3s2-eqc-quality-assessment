
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.1. Steric Sea Level Contribution from ORAS5 Reanalysis to Global Sea Level Observed by Satellite Altimetry &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reanalyses/reanalysis_reanalysis-oras5_validation_q05';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Seasonal forecasts" href="../Seasonal_Forecasts/seasonal.html" />
    <link rel="prev" title="3. Reanalysis" href="reanalysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="reanalysis.html">3. Quality assessments for Reanalysis</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Steric Sea Level Contribution from ORAS5 Reanalysis to Global Sea Level Observed by Satellite Altimetry</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FReanalyses/reanalysis_reanalysis-oras5_validation_q05.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Reanalyses/reanalysis_reanalysis-oras5_validation_q05.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Steric Sea Level Contribution from ORAS5 Reanalysis to Global Sea Level Observed by Satellite Altimetry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-studying-the-contribution-of-steric-sea-level-to-the-global-sea-level-budget">üåç Use case: Studying the Contribution of Steric Sea Level to the Global Sea Level Budget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">‚ùì Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection-and-setup">1. Data selection and setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-requests-for-oras5-reanalysis-and-satellite-altimetry">Define data requests for ORAS5 reanalysis and satellite altimetry</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steric-height-components">2. Define steric height components</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-absolute-salinity-sa-conservative-temperature-ct-and-density-rho">Compute Absolute Salinity (SA), Conservative Temperature (CT), and density (<span class="math notranslate nohighlight">\(\rho\)</span>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-density-field-and-anomalies">Reference Density Field and Anomalies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-sea-level-ssl">Steric Sea Level (SSL)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-thermosteric-and-halosteric-components-from-argo-based-data">Steric, thermosteric and halosteric components from Argo-based data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steric-sea-level-anomalies">3. Define steric sea level anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-regional-steric-sea-level-trends">4. Define regional steric sea level trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">5. Download and transform</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-oras5">For <strong>ORAS5</strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-argo">For <strong>Argo</strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-satellite-altimetry">For <strong>satellite altimetry</strong>:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-and-discussion-of-results">6. Plotting and discussion of results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-time-series">Steric time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-regional-trends">Steric regional trends</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-steric-trends-and-contribution-to-observed-gmsl-from-satellite-altimetry">Global steric trends and contribution to observed GMSL from satellite altimetry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<div class="alert alert-block alert-warning">
Please note that this repository is used for development and review, so quality assessments should be considered work in progress until they are merged into the main branch
</div><section class="tex2jax_ignore mathjax_ignore" id="steric-sea-level-contribution-from-oras5-reanalysis-to-global-sea-level-observed-by-satellite-altimetry">
<h1><span class="section-number">3.1. </span>Steric Sea Level Contribution from ORAS5 Reanalysis to Global Sea Level Observed by Satellite Altimetry<a class="headerlink" href="#steric-sea-level-contribution-from-oras5-reanalysis-to-global-sea-level-observed-by-satellite-altimetry" title="Link to this heading">#</a></h1>
<p>Production date: 30-09-2025</p>
<p>Produced by: Joan Armajach and Blanca Fern√°ndez-√Ålvarez - IMEDEA (CSIC-UIB) <a class="reference external" href="https://imedea.uib-csic.es/" rel="noreferrer" target="_blank">[webpage]</a></p>
<section id="use-case-studying-the-contribution-of-steric-sea-level-to-the-global-sea-level-budget">
<h2>üåç Use case: Studying the Contribution of Steric Sea Level to the Global Sea Level Budget<a class="headerlink" href="#use-case-studying-the-contribution-of-steric-sea-level-to-the-global-sea-level-budget" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>‚ùì Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Can the ORAS5 reanalysis system be used to monitor the long-term evolution of global steric sea level?</strong></p></li>
<li><p><strong>How does the steric component derived from ORAS5 reanalysis contribute to global sea level variability?</strong></p></li>
</ul>
<p>At present, sea level change has become a key issue in climate change, as global and regional variations can be regarded as important indicators for climate studies <a class="reference external" href="https://doi.org/10.1007/s00382-015-2554-9" rel="noreferrer" target="_blank">[1]</a>. Estimating global mean sea level (GMSL) in terms of its temporal variability and components is crucial for identifying and understanding the processes that contribute to GMSL rise <a class="reference external" href="https://doi.org/10.1007/s10712-016-9381-3" rel="noreferrer" target="_blank">[2]</a>. Present-day GMSL rise mainly reflects ocean warming and continental freshwater discharge from land ice melt, induced by anthropogenic activities <a class="reference external" href="https://doi.org/10.5194/essd-14-411-2022" rel="noreferrer" target="_blank">[3]</a>. Global steric sea level plays a critical role in contemporary sea level change. The contribution from steric component results from density changes due to temperature and salinity, leading to the expansion and contraction of water masses <a class="reference external" href="https://doi.org/10.5194/essd-10-1551-2018" rel="noreferrer" target="_blank">[4]</a>. The dominant steric effect is the thermosteric variation, which is closely correlated with changes in ocean heat content (OHC) <a class="reference external" href="https://doi.org/10.1007/s10712-016-9387-x" rel="noreferrer" target="_blank">[5]</a>. Long-term changes in ocean salinity (halosteric effects) have a negligible influence compared to the thermal expansion at a global scale <a class="reference external" href="https://doi.org/10.1029/2005JC003421" rel="noreferrer" target="_blank">[6]</a>, but they can play a significant role regionally, as they are associated with the addition or subtraction of water mass to the ocean <a class="reference external" href="https://doi.org/10.3390/w9070484" rel="noreferrer" target="_blank">[7]</a>. Ocean reanalyses have shown accuracy in determining sea level variability by combining observations from monitoring networks (profiles and surface) with ocean model dynamics and atmospheric forcing fluxes through data assimilation methods <a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">[8]</a>. Steric sea level changes have been studied using different reanalyses, as reported in <a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">[8]</a>, <a class="reference external" href="https://doi.org/10.1029/2004JC002817" rel="noreferrer" target="_blank">[9]</a> and <a class="reference external" href="https://doi.org/10.1007/s00382-018-4585-5" rel="noreferrer" target="_blank">[10]</a>. Even though there have been advances in estimating the sea-level budget and its closure, there are still inconsistencies to be resolved. In particular, the contribution of the deep ocean (below 2000 m) remains uncertain due to the lack of observational data at those depths, and several studies have attempted to quantify its impact on the overall sea-level budget <a class="reference external" href="https://doi.org/10.1029/2020JC016551" rel="noreferrer" target="_blank">[11]</a>.</p>
<p>This notebook aims to assess the performance of the ORAS5 global ocean reanalysis to estimate the contribution of steric sea level to GMSL derived from satellite observations over the period 2004-2023.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The Steric Sea Level (SSL) computed from ORAS5 reanalysis shows an upward trend of 0.69 mm/yr. When decomposed, the thermosteric component (driven by expansion and contraction due to temperature changes) contributes 1.07 mm/yr, while the halosteric component (driven by salinity variations) contributes ‚Äì0.38 mm/yr, partly offsetting the thermosteric rise. In contrast, Argo-derived SSL shows nearly identical steric and thermosteric trends (0.85 mm/yr and 0.86 mm/yr), reflecting the minimal influence of halosteric changes (&lt;0.01 mm/yr). Recent studies have shown that an ensemble of reanalyses can accurately represent the SSL, even though individual products may under- or overestimate the trends.</p></li>
<li><p>Regionally, the steric and thermosteric trends derived from ORAS5 and Argo show good spatial agreement. However, for the halosteric component, discrepancies in magnitude are observed in areas such as the Mediterranean and the northwestern Indian Ocean, where ORAS5 displays stronger negative values. This difference could be associated with the deeper layers, which are not being considered in Argo.</p></li>
<li><p>Global SSL from Argo contributes about 23.09% to Global Mean Sea Level (GMSL) obtained from satellite altimetry. For ORAS5, when considering only the thermosteric component (i.e., excluding the halosteric contribution), the SSL represents 28.91% of the GMSL, slightly higher than Argo. Following the salinity drift that has affected a series of Argo floats since 2015, estimating the real trend of salinity-driven changes has become more challenging for all datasets that include or assimilate Argo data.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This assessment quantifies the contribution of the steric component (thermosteric and halosteric) to global mean sea level (GMSL) using the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-oras5?tab=overview" rel="noreferrer" target="_blank">ORAS5  global ocean reanalysis from the Copernicus Climate Data Store (CDS)</a>. In addition, as an initial approach we use Argo-based estimates provided by the <a class="reference external" href="https://sio-argo.ucsd.edu/RG_Climatology.html" rel="noreferrer" target="_blank">Scripps Institution of Oceanography (SIO)</a>, following <a class="reference external" href="https://doi.org/10.5194/os-21-1425-2025" rel="noreferrer" target="_blank">[12]</a>, to compare the steric sea level from the ORAS5 reanalysis product. This is only one of many Argo and observation based products (APDRC, BOA, ISAS) and objective analyses (e.g. EN4, CORA, ICOADS) which are themselves not totally in agreement with one another <a class="reference external" href="https://doi.org/10.1029/2020JC016551" rel="noreferrer" target="_blank">[11]</a>. Therefore, this analysis should be regarded as a preliminary feasibility check rather than an independent validation of ORAS5.</p>
<p>The Argo data provide monthly gridded fields of salinity and temperature with a resolution of 1¬∞ x 1¬∞ and 58 depth levels. Argo only covers the 0-2000m depth of the ocean, so it cannot reflect the full column steric height effect, whereas ORAS5 covers up to 5000m (full depth). Although it is estimated to be small <a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">[8]</a>, the full extend of the deep-ocean contribution to the total steric sea level is still not well understood [<a class="reference external" href="https://doi.org/10.5194/essd-10-1551-2018" rel="noreferrer" target="_blank">4</a>, <a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">8</a>]. For example, <a class="reference external" href="https://doi.org/10.1029/2023GL107844" rel="noreferrer" target="_blank">[13]</a> reported a trend of 0.13 ¬± 0.16 mm/yr in the South Pacific Ocean, with an uncertainty larger than the trend itself.</p>
<p>The final step evaluates the steric contribution to the observed GMSL as measured by satellite altimetry from the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-level-global?tab=overview" rel="noreferrer" target="_blank">Sea level gridded data from satellite observations for the global ocean in the CDS</a>.</p>
<p>The GMSL is determined by the sum of the steric and the manometric contributions. The latter one can be estimated through gravimetric observations from GRACE satellite missions, which detect variations in the gravity field caused by changes in the distribution of water masses across the planet.</p>
<p>For all of these datasets, we select the study period from <strong>2004 to 2023</strong>, when observations from all sources are available.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong>1. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-1"><span class="std std-ref">1. Data selection and setup</span></a></strong></p>
<ul class="simple">
<li><p>Set up the python environment and import required libraries.</p></li>
<li><p>Define the startup parameters.</p></li>
<li><p>Define requests for ORAS5 reanalysis and satellite altimetry, both datasets available from CDS.</p></li>
</ul>
<p><strong>2. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-2"><span class="std std-ref">2. Define steric height components</span></a></strong></p>
<ul class="simple">
<li><p>Compute Absolute Salinity (SA), Conservative Temperature (CT), and density (<span class="math notranslate nohighlight">\(\rho\)</span>).</p></li>
<li><p>Compute Steric Sea Level (SSL).</p></li>
<li><p>Compute Thermosteric (temperature-only) and Halosteric (salinity-only) components.</p></li>
<li><p>Obtain Argo-based steric sea level and its components.</p></li>
</ul>
<p><strong>3. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-3"><span class="std std-ref">3. Define steric sea level anomalies</span></a></strong></p>
<p><strong>4. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-4"><span class="std std-ref">4. Define regional steric sea level trends</span></a></strong></p>
<p><strong>5. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-5"><span class="std std-ref">5. Download and transform</span></a></strong></p>
<ul class="simple">
<li><p>ORAS5</p></li>
<li><p>Argo</p></li>
<li><p>Satellite altimetry</p></li>
</ul>
<p><strong>6. <a class="reference internal" href="#reanalysis-reanalysis-oras5-validation-q05-section-6"><span class="std std-ref">6. Plotting and discussion of results</span></a></strong></p>
<ul class="simple">
<li><p>Time series of steric anomalies.</p></li>
<li><p>Regional steric trends.</p></li>
<li><p>Global steric trends and their contribution to observed GMSL from satellite altimetry.</p></li>
</ul>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>For density calculations, we use the <a class="reference external" href="https://www.teos-10.org/software.htm#1" rel="noreferrer" target="_blank">GSW toolbox for TEOS-10-compliant ocean thermodynamics</a>.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="data-selection-and-setup">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-1"></span><h3>1. Data selection and setup<a class="headerlink" href="#data-selection-and-setup" title="Link to this heading">#</a></h3>
<section id="import-required-libraries">
<h4>Import required libraries<a class="headerlink" href="#import-required-libraries" title="Link to this heading">#</a></h4>
<p>First we import the packages.</p>
<p>The documentation for installing the Thermodynamic Equation of Seawater 2010 (TEOS-10) library is available <a class="reference external" href="https://github.com/TEOS-10/GSW-Python" rel="noreferrer" target="_blank">here</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cacholote</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gsw_xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gsw</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pooch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters">
<h4>Define parameters<a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h4>
<p>We select the study period (2004-2023) and apply a mask between 60¬∞S and 60¬∞N to exclude the polar regions for consistency.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">2004</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2023</span>

<span class="c1"># Space</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-data-requests-for-oras5-reanalysis-and-satellite-altimetry">
<h4>Define data requests for ORAS5 reanalysis and satellite altimetry<a class="headerlink" href="#define-data-requests-for-oras5-reanalysis-and-satellite-altimetry" title="Link to this heading">#</a></h4>
<p>For ORAS5, we use monthly potential temperature and practical salinity fields at all depth levels to compute the steric sea level for the selected period.</p>
<p>For GMSL, we use monthly data derived from satellite altimetry and select the latest version of the product, vDT2024. Regarding the reliability of the altimetry data, the correction of TOPEX-A is not yet implemented.</p>
<p>Both datasets are downloaded using the <a class="reference external" href="https://cds.climate.copernicus.eu/how-to-api" rel="noreferrer" target="_blank">CDS API client</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
<span class="p">}</span>

<span class="c1"># ORAS5 request</span>
<span class="n">request_reanalysis</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;reanalysis-oras5&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;consolidated&quot;</span><span class="p">,</span> <span class="s2">&quot;operational&quot;</span><span class="p">],</span>
        <span class="s2">&quot;vertical_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;all_levels&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;potential_temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;salinity&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="o">|</span> <span class="n">time_request</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Satellite altimetry request </span>
<span class="n">request_satellite</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-sea-level-global&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;monthly_mean&quot;</span><span class="p">],</span> <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;vdt2024&quot;</span><span class="p">}</span> <span class="o">|</span> <span class="n">time_request</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">download_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;time_counter_bnds&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="define-steric-height-components">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-2"></span><h3>2. Define steric height components<a class="headerlink" href="#define-steric-height-components" title="Link to this heading">#</a></h3>
<section id="compute-absolute-salinity-sa-conservative-temperature-ct-and-density-rho">
<h4>Compute Absolute Salinity (SA), Conservative Temperature (CT), and density (<span class="math notranslate nohighlight">\(\rho\)</span>)<a class="headerlink" href="#compute-absolute-salinity-sa-conservative-temperature-ct-and-density-rho" title="Link to this heading">#</a></h4>
<p>To obtain physically consistent measures of seawater properties, ORAS5‚Äôs practical salinity and potential temperature are first converted into Absolute Salinity (SA) and Conservative Temperature (CT) using the <a class="reference external" href="https://www.teos-10.org/" rel="noreferrer" target="_blank">TEOS-10 from the Gibbs SeaWater (GSW) Oceanographic Toolbox</a>. This transformation ensures that salinity and temperature are expressed in thermodynamically appropriate variables, which are necessary for accurate estimates of in-situ seawater density (<span class="math notranslate nohighlight">\(\rho\)</span>).</p>
</section>
<section id="reference-density-field-and-anomalies">
<h4>Reference Density Field and Anomalies<a class="headerlink" href="#reference-density-field-and-anomalies" title="Link to this heading">#</a></h4>
<p>From the calculated densities, we derive the mean in-situ density as the reference density field (<span class="math notranslate nohighlight">\(\rho_{\text{ref}}\)</span>), which serves as the baseline period for steric sea level analyses. This is done by forming a monthly climatology of in-situ density, in which the mean for each month is computed over the chosen period (here, the full time span).</p>
<p>Density anomalies are then defined as departures from this baseline:</p>
<div class="math notranslate nohighlight">
\[
\Delta \rho = \rho - \rho_{\text{ref}}
\]</div>
</section>
<section id="steric-sea-level-ssl">
<h4>Steric Sea Level (SSL)<a class="headerlink" href="#steric-sea-level-ssl" title="Link to this heading">#</a></h4>
<p>In ocean reanalyses which use the Boussinesq approximation, as is the case of ORAS5 and many other reanalyses that use the NEMO model, the steric effect cannot be directly represented. Therefore, we need to compute it using the corresponding formulas.</p>
<p>Steric sea level variations are caused by changes in seawater density integrated through the water column. The steric contribution to sea level is obtained by vertically integrating density anomalies and scaling by a reference density (typically <span class="math notranslate nohighlight">\(\rho_0 = 1025 \,\mathrm{kg\,m^{-3}}\)</span>):</p>
<div class="math notranslate nohighlight">
\[
SSL = -\frac{1}{\rho_0} \int_{-h}^{0} \Delta \rho\,dz
\]</div>
<p>To isolate the respective effect of temperature and salinity, the steric signal is decomposed into <strong>thermosteric</strong> and <strong>halosteric</strong> components:</p>
<ul class="simple">
<li><p><strong>Thermosteric component:</strong></p></li>
</ul>
<p>Salinity is held fixed at its long-term climatological mean (<span class="math notranslate nohighlight">\(SA_{\rm fix}\)</span>), while temperature is allowed to vary. Density is then recomputed. First, we calculate a fixed salinity field (<span class="math notranslate nohighlight">\(SA_{\rm fix}\)</span>) as the long-term mean over the baseline period. Then, we compute Conservative Temperature (CT) from the actual temperature fields and calculate density using
$<span class="math notranslate nohighlight">\(
\rho = \rho(SA_{\text{fix}}, CT, p)
\)</span>$</p>
<p>This ensures that only variations in temperature contribute to the resulting thermosteric steric sea level (TSSL).</p>
<ul class="simple">
<li><p><strong>Halosteric component:</strong></p></li>
</ul>
<p>Temperature is fixed at its long-term climatological mean (<span class="math notranslate nohighlight">\(CT_{\rm fix}\)</span>), while salinity is allowed to vary:</p>
<div class="math notranslate nohighlight">
\[
\rho = \rho(SA, CT_{\rm fix}, p)
\]</div>
<p>This isolates the salinity fluctuations influence the resulting halosteric steric sea level (HSSL).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute p, SA, CT, and rho</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_gsw_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">p_from_z</span><span class="p">(</span><span class="o">-</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;deptht&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
    <span class="n">SA</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;vosaline&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;votemper&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
        <span class="n">CT</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_pt</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;votemper&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">CT</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">rho</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
                <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]:</span>
                <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="s2">&quot;deptht&quot;</span><span class="p">:</span>
                <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dim</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">da</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s2">&quot;chunksizes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="c1"># Compute steric sea level from density (SSL)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">rho0</span><span class="o">=</span><span class="mi">1025</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">grouped_rho</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span>
    <span class="n">delta_rho</span> <span class="o">=</span> <span class="n">grouped_rho</span> <span class="o">-</span> <span class="n">grouped_rho</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ssl</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">delta_rho</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho0</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="s2">&quot;deptht&quot;</span><span class="p">)</span>
    <span class="n">ssl</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">steric sea level&quot;</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">ssl</span>

<span class="c1"># Compute steric sea level components (TSSL, HSSL)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;thermo&quot;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;SA&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">),</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;CT&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;halo&quot;</span><span class="p">:</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">rho</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;SA&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;CT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">),</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_ssl_from_rho</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">ssl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="steric-thermosteric-and-halosteric-components-from-argo-based-data">
<h4>Steric, thermosteric and halosteric components from Argo-based data<a class="headerlink" href="#steric-thermosteric-and-halosteric-components-from-argo-based-data" title="Link to this heading">#</a></h4>
<p>In this section, we employ the new version of the Roemmich-Gilson Argo Climatology, which extends the analysis of Argo-only derived temperature and salinity fields. To cover the full period, we use two Argo datasets: one covering 2004-2018 and another 2019-2025. The web page to access the data is <a class="reference external" href="https://sio-argo.ucsd.edu/RG_Climatology.html" rel="noreferrer" target="_blank">here</a>.</p>
<p>Since Argo data are hosted outside the CDS, we use the URLs from SIO and store the data in cache. Monthly updates temporally extend the RG Argo Climatology (2004-2018). However, data from 2019 onwards are not included in determining the most recent RG Argo Climatology. In this case, the main variables of the fields are the anomalies and the means of T and S, which are added to obtain the in-situ T and S.</p>
<p>In addition, we preprocess the data to make them consistent for the computations of the steric level. Finally, we apply the same functions used for ORAS5 to compute steric levels.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">preprocess</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># Naming</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">var</span><span class="p">:</span> <span class="n">var</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">})</span>
    <span class="c1"># Time</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;calendar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;360_day&quot;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">decode_cf</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Depth</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">gsw</span><span class="o">.</span><span class="n">z_from_p</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;positive&quot;</span><span class="p">:</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Depth from pressure&quot;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">)</span>


<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_argo</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
    <span class="c1"># Get climatology</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;Salinity&quot;</span><span class="p">]:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://sio-argo.ucsd.edu/RG/RG_ArgoClim_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">_2019.nc.gz&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">Decompress</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">filenames</span><span class="p">,</span> <span class="n">preprocess</span><span class="o">=</span><span class="n">preprocess</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ds_clima</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

    <span class="c1"># Get anomalies</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ds</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://sio-argo.ucsd.edu/RG/RG_ArgoClim_</span><span class="si">{</span><span class="n">year</span><span class="si">}{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">_2019.nc.gz&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">Decompress</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">preprocess</span><span class="o">=</span><span class="n">preprocess</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="c1"># Compute values</span>
    <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;salinity&quot;</span><span class="p">,</span> <span class="s2">&quot;temperature&quot;</span><span class="p">]:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds_clima</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;argo_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">_mean&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;argo_</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2">_anomaly&quot;</span><span class="p">]</span>
        <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span>

    <span class="c1"># Compute gsw dataset</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="s2">&quot;deptht&quot;</span><span class="p">,</span> <span class="n">salinity</span><span class="o">=</span><span class="s2">&quot;vosaline&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">compute_gsw_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_all_argo</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_argo</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">))</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="define-steric-sea-level-anomalies">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-3"></span><h3>3. Define steric sea level anomalies<a class="headerlink" href="#define-steric-sea-level-anomalies" title="Link to this heading">#</a></h3>
<p>To obtain the time series of the anomalies, we calculate the weighted global mean by latitude for each steric variable, keeping the results in cache for both ORAS5 and Argo.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_timeseries_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ssl</span> <span class="o">=</span> <span class="n">compute_ssl_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ssl</span><span class="p">)</span>

<span class="c1"># ORAS5</span>
<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_timeseries</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">,</span>
    <span class="n">lon_slice</span><span class="p">,</span>
    <span class="n">lat_slice</span><span class="p">,</span>
    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_gsw_ds</span><span class="p">,</span> <span class="o">**</span><span class="n">download_kwargs</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_ssl_timeseries_from_ds</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span>
    <span class="p">)</span>

<span class="c1"># Argo</span>
<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_timeseries_argo</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">get_all_argo</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_ssl_timeseries_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-regional-steric-sea-level-trends">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-4"></span><h3>4. Define regional steric sea level trends<a class="headerlink" href="#define-regional-steric-sea-level-trends" title="Link to this heading">#</a></h3>
<p>In order to estimate the regional trends of each steric sea level component, we compute the slope at each point of the spatial grid. For this process, a least-squares fit is used. As with the time series, we store the trend results in cache to avoid recalculation.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_trend_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="n">ssl</span> <span class="o">=</span> <span class="n">compute_ssl_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span>
    <span class="n">ssl</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_linear_trend</span><span class="p">(</span><span class="n">ssl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ssl</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="c1"># ORAS5</span>
<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_trend</span><span class="p">(</span>
    <span class="n">collection_id</span><span class="p">,</span>
    <span class="n">request</span><span class="p">,</span>
    <span class="n">prefix</span><span class="p">,</span>
    <span class="n">lon_slice</span><span class="p">,</span>
    <span class="n">lat_slice</span><span class="p">,</span>
    <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_gsw_ds</span><span class="p">,</span> <span class="o">**</span><span class="n">download_kwargs</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_ssl_trend_from_ds</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span>
    <span class="p">)</span>

<span class="c1"># Argo</span>
<span class="nd">@cacholote</span><span class="o">.</span><span class="n">cacheable</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_ssl_trend_argo</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">get_all_argo</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_ssl_trend_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-5"></span><h3>5. Download and transform<a class="headerlink" href="#download-and-transform" title="Link to this heading">#</a></h3>
<p>In this section, we download the data applying previously defined initial parameters. Then, we calculate the time series and trends of steric sea level using the corresponding functions. To organise the results, we combine them into unified datasets.</p>
<section id="for-oras5">
<h4>For <strong>ORAS5</strong>:<a class="headerlink" href="#for-oras5" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;thermo&quot;</span><span class="p">,</span> <span class="s2">&quot;halo&quot;</span><span class="p">]</span>

<span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">trends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(([</span><span class="n">prefix</span><span class="p">]</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;ssl&quot;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">compute_ssl_timeseries</span><span class="p">(</span>
        <span class="o">*</span><span class="n">request_reanalysis</span><span class="p">,</span>
        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
        <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">compute_ssl_trend</span><span class="p">(</span>
        <span class="o">*</span><span class="n">request_reanalysis</span><span class="p">,</span>
        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
        <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
        <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;latitude&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Delete!&quot;</span><span class="p">)</span>
        <span class="n">cacholote</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">compute_ssl_trend</span><span class="p">,</span>
            <span class="o">*</span><span class="n">request_reanalysis</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
            <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">compute_ssl_trend</span><span class="p">(</span>
            <span class="o">*</span><span class="n">request_reanalysis</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
            <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
            <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
            <span class="o">**</span><span class="n">download_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    
<span class="n">ds_reanalysis_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
<span class="n">ds_reanalysis_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trends</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name = &#39;ssl&#39;
name = &#39;thermo_ssl&#39;
name = &#39;halo_ssl&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/wp5/.tmp/ipykernel_1871896/195805667.py:43: FutureWarning: In a future version of xarray the default value for compat will change from compat=&#39;no_conflicts&#39; to compat=&#39;override&#39;. This is likely to lead to different results when combining overlapping variables with the same name. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set compat explicitly.
  ds_reanalysis_timeseries = xr.merge(timeseries)
/data/wp5/.tmp/ipykernel_1871896/195805667.py:44: FutureWarning: In a future version of xarray the default value for compat will change from compat=&#39;no_conflicts&#39; to compat=&#39;override&#39;. This is likely to lead to different results when combining overlapping variables with the same name. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set compat explicitly.
  ds_reanalysis_trend = xr.merge(trends)
/data/wp5/.tmp/ipykernel_1871896/195805667.py:44: FutureWarning: In a future version of xarray the default value for compat will change from compat=&#39;no_conflicts&#39; to compat=&#39;override&#39;. This is likely to lead to different results when combining overlapping variables with the same name. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set compat explicitly.
  ds_reanalysis_trend = xr.merge(trends)
</pre></div>
</div>
</div>
</div>
</section>
<section id="for-argo">
<h4>For <strong>Argo</strong>:<a class="headerlink" href="#for-argo" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prefixes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;thermo&quot;</span><span class="p">,</span> <span class="s2">&quot;halo&quot;</span><span class="p">]</span>

<span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">trends</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(([</span><span class="n">prefix</span><span class="p">]</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;ssl&quot;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">compute_ssl_timeseries_argo</span><span class="p">(</span>
        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
        <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
        <span class="n">year_start</span><span class="o">=</span><span class="n">year_start</span><span class="p">,</span>
        <span class="n">year_stop</span><span class="o">=</span><span class="n">year_stop</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">compute_ssl_trend_argo</span><span class="p">(</span>
        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
        <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
        <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
        <span class="n">year_start</span><span class="o">=</span><span class="n">year_start</span><span class="p">,</span>
        <span class="n">year_stop</span><span class="o">=</span><span class="n">year_stop</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">trends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<span class="n">ds_argo_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
<span class="n">ds_argo_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trends</span><span class="p">)</span>

<span class="c1"># Align</span>
<span class="n">ds_argo_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_argo_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span>
    <span class="s2">&quot;proleptic_gregorian&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span>
<span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ds_argo_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ds_reanalysis_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="n">ds_argo_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_reanalysis_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name = &#39;ssl&#39;
name = &#39;thermo_ssl&#39;
name = &#39;halo_ssl&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/wp5/.tmp/ipykernel_1871896/2867248100.py:24: FutureWarning: In a future version of xarray the default value for compat will change from compat=&#39;no_conflicts&#39; to compat=&#39;override&#39;. This is likely to lead to different results when combining overlapping variables with the same name. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set compat explicitly.
  ds_argo_timeseries = xr.merge(timeseries)
</pre></div>
</div>
</div>
</div>
</section>
<section id="for-satellite-altimetry">
<h4>For <strong>satellite altimetry</strong>:<a class="headerlink" href="#for-satellite-altimetry" title="Link to this heading">#</a></h4>
<p>We employ the same process to download and calculate anomalies, but in this case, using the sea level gridded data from satellite observations for the global ocean from 1993 to the present. Thus, we are able to obtain the time series of GMSL for the selected period.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_satellite</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request_satellite</span><span class="p">,</span> <span class="o">**</span><span class="n">download_kwargs</span><span class="p">)</span>
<span class="n">ds_satellite</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds_satellite</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_sla_timeseries_from_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">):</span>
    <span class="n">grouped_sla</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;sla&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span>
    <span class="n">delta_sla</span> <span class="o">=</span> <span class="n">grouped_sla</span> <span class="o">-</span> <span class="n">grouped_sla</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">sla_anomaly</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">delta_sla</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">sla_anomaly</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;sla_anomaly&quot;</span><span class="p">)</span>

<span class="n">anomaly_sla</span> <span class="o">=</span> <span class="n">compute_sla_timeseries_from_ds</span><span class="p">(</span>
    <span class="n">ds_satellite</span><span class="p">,</span>
    <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">,</span>
    <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span>
    <span class="n">year_start</span><span class="o">=</span><span class="n">year_start</span><span class="p">,</span>
    <span class="n">year_stop</span><span class="o">=</span><span class="n">year_stop</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 240/240 [00:06&lt;00:00, 35.24it/s]
/data/common/miniforge3/envs/wp5/lib/python3.12/site-packages/earthkit/data/readers/netcdf/fieldlist.py:202: FutureWarning: In a future version of xarray the default value for data_vars will change from data_vars=&#39;all&#39; to data_vars=None. This is likely to lead to different results when multiple datasets have matching variables with overlapping values. To opt in to new defaults and get rid of these warnings now use `set_options(use_new_combine_kwarg_defaults=True) or set data_vars explicitly.
  return xr.open_mfdataset(
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plotting-and-discussion-of-results">
<span id="reanalysis-reanalysis-oras5-validation-q05-section-6"></span><h3>6. Plotting and discussion of results<a class="headerlink" href="#plotting-and-discussion-of-results" title="Link to this heading">#</a></h3>
<section id="steric-time-series">
<h4>Steric time series<a class="headerlink" href="#steric-time-series" title="Link to this heading">#</a></h4>
<p>For plotting the time series, we represent the spatial and temporal variability of steric, thermosteric, and halosteric anomalies (in mm) during the period 2004-2023.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">ds_reanalysis_timeseries</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">]),</span>
        <span class="n">ds_argo_timeseries</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ARGO&quot;</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">da_timeseries</span> <span class="o">=</span> <span class="n">ds_timeseries</span><span class="o">.</span><span class="n">to_dataarray</span><span class="p">()</span> 
<span class="n">da_mm</span> <span class="o">=</span> <span class="n">da_timeseries</span> <span class="o">*</span> <span class="mi">1000</span> 
<span class="n">da_mm</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mm&quot;</span>

<span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;maroon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;thermo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;halo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;navy&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">products</span> <span class="o">=</span> <span class="n">da_mm</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">n_products</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_products</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

<span class="n">time_years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">da_mm</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
<span class="n">start_year</span> <span class="o">=</span> <span class="n">time_years</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">years_to_show</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2024</span><span class="p">]</span>
<span class="n">all_years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;YS&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">products</span><span class="p">):</span>
    <span class="n">ds_prod</span> <span class="o">=</span> <span class="n">da_mm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds_prod</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="n">ds_prod</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">),</span> <span class="s2">&quot;black&quot;</span><span class="p">),</span>
            <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;[mm]&quot;</span> <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;ORAS5&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">all_years</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span>
        <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">year</span> <span class="ow">in</span> <span class="n">years_to_show</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">all_years</span><span class="p">],</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="p">)</span>
    
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">handles</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/3881600569726bc1cabe32abbc998d8fa2c79d373f6a70234e965cc249be0fb6.png" src="../_images/3881600569726bc1cabe32abbc998d8fa2c79d373f6a70234e965cc249be0fb6.png" />
</div>
</div>
<p>In these graphs, we can see steric sea level anomalies (mm) for each dataset. The first plot represents ORAS5 data, whose steric component (maroon line) generally shows an upward trend. More specifically, between 2015-2021 this variability remains nearly stable. From 2022 onwards, the trend shows a clear increase. Regarding the thermosteric component (orange line), its variability follows a pattern similar to the steric line, showing a slightly higher increase throughout the period. The halosteric effect (blue line) presents an unexpected behaviour, with an initial increase from 2004 to 2008, followed by a steady period, and a marked decrease after 2016. This is not physically possible, since the effect of salinity on the global scale should be around 0, and also since what we expect for recent decades is to slightly increase due to the redistribution of freshwater and mixing processes <a class="reference external" href="https://doi.org/10.5194/essd-10-1551-2018" rel="noreferrer" target="_blank">[4]</a>. One possible cause could be partly due to Argo salinity drift, which caused high quantities of Argo floats to report higher values of salinity starting in 2015 <a class="reference external" href="https://doi.org/10.1029/2021GL092824" rel="noreferrer" target="_blank">[14]</a>. ORAS5 could be affected since it integrates EN4 <a class="reference external" href="https://doi.org/10.5194/os-15-779-2019" rel="noreferrer" target="_blank">[15]</a>, a product based on Argo, XBT/MBT, CTD and other in-situ observations, which has been shown to be affected by this drift. However, this is not fully clear, since a series of observing system experiments (OSEs) were performed in order to evaluate the effects of Argo data quality control (QC) <a class="reference external" href="https://doi.org/10.3389/fmars.2024.1496409" rel="noreferrer" target="_blank">[16]</a>. In the ORAS5 system, rejecting the affected Argo float data had only a small impact on halosteric performance. Regarding the graph, since 2017 the steric level remains much lower than the thermosteric component due to the halosteric influence and its negative contribution.</p>
<p>On the other hand, the second plot shows Argo data from SIO, whose steric line presents height anomalies with strong fluctuations, with a notable increase between 2014 and 2023. The thermosteric component also shows large variability, with an upward trend beginning in 2014. Regarding the halosteric component, its pattern remains practically constant close to zero for the entire period. This occurs because the SIO dataset adjusts the T/S profiles by an offset, when necessary, to agree with the WOCE Global Hydrographic Climatology, thus correcting the drifted salinity [<a class="reference external" href="https://doi.org/10.1029/2021GL092824" rel="noreferrer" target="_blank">14</a>,<a class="reference external" href="https://doi.org/10.1016/j.pocean.2009.03.004" rel="noreferrer" target="_blank">17</a>]. Unlike ORAS5, the steric and thermosteric levels are nearly equal, indicating that the long-term halosteric impact is negligible for the global sea level budget.</p>
</section>
<section id="steric-regional-trends">
<h4>Steric regional trends<a class="headerlink" href="#steric-regional-trends" title="Link to this heading">#</a></h4>
<p>ORAS5 is provided on a tripolar grid, so we regrid it onto a regular lat-lon grid as an additional step to facilitate visualisation and avoid map clipping.</p>
<p>In this section, we use the regridded map for ORAS5 and the regular lat-lon grid for Argo to obtain the global spatial distribution of steric trends, ensuring both datasets have the same spatial resolution for comparison.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_reanalysis_trend_interp</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span>
    <span class="n">ds_reanalysis_trend</span><span class="p">,</span> <span class="n">ds_argo_trend</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest_s2d&quot;</span>
<span class="p">)</span>
<span class="n">ds_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">ds_reanalysis_trend_interp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">]),</span>
        <span class="n">ds_argo_trend</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ARGO&quot;</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">meters_to_millimeters</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">seconds_per_year</span> <span class="o">=</span> <span class="mi">365</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>

<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">da_trends</span> <span class="o">=</span> <span class="n">ds_trend</span><span class="o">.</span><span class="n">to_dataarray</span><span class="p">()</span> <span class="o">*</span> <span class="n">meters_to_millimeters</span> <span class="o">*</span> <span class="n">seconds_per_year</span>
    <span class="n">da_trends</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mm/yr&quot;</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colormaps</span><span class="p">[</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">with_extremes</span><span class="p">(</span><span class="n">bad</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">lon_name</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span> <span class="k">if</span> <span class="s2">&quot;longitude&quot;</span> <span class="ow">in</span> <span class="n">da_trends</span><span class="o">.</span><span class="n">coords</span> <span class="k">else</span> <span class="s2">&quot;x&quot;</span>
<span class="n">lat_name</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span> <span class="k">if</span> <span class="s2">&quot;latitude&quot;</span> <span class="ow">in</span> <span class="n">da_trends</span><span class="o">.</span><span class="n">coords</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>

<span class="n">variables</span> <span class="o">=</span> <span class="n">da_trends</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">products</span> <span class="o">=</span> <span class="n">da_trends</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">plot_arrays</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">da_trends</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span>
<span class="p">]</span>

<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">)</span> 
<span class="n">n_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
    <span class="n">n_rows</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
    <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hspace&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;wspace&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

<span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cols</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">plot_arrays</span><span class="p">[</span><span class="n">row</span> <span class="o">*</span> <span class="n">n_cols</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span>

        <span class="n">data_masked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">da_trends</span><span class="p">[</span><span class="n">lon_name</span><span class="p">],</span> <span class="n">da_trends</span><span class="p">[</span><span class="n">lat_name</span><span class="p">],</span> <span class="n">data_masked</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span> 
        <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_tick_params</span><span class="p">(</span><span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
            
        <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s2">&quot;110m&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">products</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">variables</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">im</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
    <span class="n">extend</span><span class="o">=</span><span class="s2">&quot;both&quot;</span>
<span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;mm/yr&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/60e7b7410f03ebd9433d18ed510b3cdf9401f5b1acc6a224a1cfc2929042dec1.png" src="../_images/60e7b7410f03ebd9433d18ed510b3cdf9401f5b1acc6a224a1cfc2929042dec1.png" />
</div>
</div>
<p>This figure shows the steric, thermosteric, and halosteric trends from both the ORAS5 reanalysis and Argo-derived datasets. For the steric component, the regions of strongest positive and negative trends are in good agreement between the two datasets. Two main areas of stronger positive trends are evident: one in the northwestern Atlantic and another in the northwestern Pacific. In contrast, lower trends are observed along the equator and in the Southern Ocean. The Mediterranean shows a positive signal in Argo but a negative one in ORAS5.</p>
<p>Similarly to the global anomalies, the thermosteric component largely explains the steric signal in both datasets, confirming that thermal expansion dominates steric sea level change. For this component, we find a good agreement between ORAS5 and Argo.</p>
<p>For the halosteric component, there are more pronounced differences. ORAS5 shows stronger magnitudes than Argo, with a very positive signal in the eastern North Atlantic and south of Australia, and negative values in the Mediterranean and the northwestern Indian Ocean, compared with Argo data. In the case of the Mediterranean, the steric height at full depth shows pronounced negative trends due to deep layers halosteric influence <a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">[8]</a>. This highlights the importance of the halosteric component at regional levels. Other discrepancies reflect the known difficulty in resolving the global halosteric signal, as has been noted in reanalyses intercomparisons (e.g. <a class="reference external" href="https://doi.org/10.1007/s00382-015-2554-9" rel="noreferrer" target="_blank">[1]</a>, where the spread in halosteric trend estimates exceeds their mean).</p>
</section>
<section id="global-steric-trends-and-contribution-to-observed-gmsl-from-satellite-altimetry">
<h4>Global steric trends and contribution to observed GMSL from satellite altimetry<a class="headerlink" href="#global-steric-trends-and-contribution-to-observed-gmsl-from-satellite-altimetry" title="Link to this heading">#</a></h4>
<p>Once all anomalies are calculated, we adjust them to start at 0 in 2004, using the values from that year as a reference. This process is applied to each product: sea level and ORAS5 from CDS, and Argo from SIO.</p>
<p>We visualise the total contribution of steric sea level and its components to the GMSL, with anomalies adjusted to zero in the initial year (2004).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ssl&quot;</span><span class="p">,</span> <span class="s2">&quot;thermo_ssl&quot;</span><span class="p">,</span> <span class="s2">&quot;halo_ssl&quot;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zero_anomaly</span><span class="p">(</span><span class="n">da_timeseries</span><span class="p">,</span> <span class="n">reference_date</span><span class="o">=</span><span class="s2">&quot;2004-01-01&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">):</span>
    <span class="n">da_mm</span> <span class="o">=</span> <span class="n">da_timeseries</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">da_mm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">reference_date</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da_mm</span> <span class="o">-</span> <span class="n">offset</span>

<span class="n">anomalies_zero</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ORAS5&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;ARGO&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;SLA&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

<span class="k">for</span> <span class="n">product_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">,</span> <span class="s2">&quot;ARGO&quot;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span> 
        <span class="n">da_var</span> <span class="o">=</span> <span class="n">da_timeseries</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="n">product_name</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">var_name</span><span class="p">)</span>
        <span class="n">anomalies_zero</span><span class="p">[</span><span class="n">product_name</span><span class="p">][</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">zero_anomaly</span><span class="p">(</span><span class="n">da_var</span><span class="p">)</span>
        
<span class="n">anomalies_zero</span><span class="p">[</span><span class="s1">&#39;SLA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zero_anomaly</span><span class="p">(</span><span class="n">anomaly_sla</span><span class="p">)</span>

<span class="n">color_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;SLA&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;maroon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;thermo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;halo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;navy&quot;</span>
<span class="p">}</span>

<span class="n">line_styles</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="s2">&quot;thermo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="s2">&quot;halo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span>
<span class="p">}</span>

<span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">,</span> <span class="s2">&quot;ARGO&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> 

<span class="n">time_coord</span> <span class="o">=</span> <span class="n">anomalies_zero</span><span class="p">[</span><span class="s1">&#39;SLA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
<span class="n">all_years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
    <span class="n">start</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">year</span><span class="p">),</span>
    <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;YS&quot;</span>
<span class="p">)</span>
<span class="n">years_to_show</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2024</span><span class="p">]</span>
<span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">year</span> <span class="ow">in</span> <span class="n">years_to_show</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">all_years</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">products</span><span class="p">):</span>
    <span class="c1"># SLA</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">anomalies_zero</span><span class="p">[</span><span class="s1">&#39;SLA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">anomalies_zero</span><span class="p">[</span><span class="s1">&#39;SLA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="p">[</span><span class="s1">&#39;SLA&#39;</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;GMSL&#39;</span>
    <span class="p">)</span>
    
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da_var</span> <span class="ow">in</span> <span class="n">anomalies_zero</span><span class="p">[</span><span class="n">product</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">da_var</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">da_var</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s2">&quot;gray&quot;</span><span class="p">),</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">line_styles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
            <span class="n">label</span><span class="o">=</span><span class="n">var</span>
        <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;[mm]&quot;</span> <span class="k">if</span> <span class="n">product</span> <span class="o">==</span> <span class="s2">&quot;ORAS5&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">all_years</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span>
    <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
    <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/ca4d954f6c782ce1f46a7ff18afeea40482c81b2cb80ec8ce8e64593115df81a.png" src="../_images/ca4d954f6c782ce1f46a7ff18afeea40482c81b2cb80ec8ce8e64593115df81a.png" />
</div>
</div>
<p>Finally, we calculate the global trends using linear least-squares regression. Additionally, we compute the contributions (%) of SSL to GMSL and of TSSL and HSSL to SSL.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">linear_trend</span><span class="p">(</span><span class="n">da_timeseries</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">da_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">da_timeseries</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">da_timeseries</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">da_timeseries</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># m/yr to mm/yr</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">,</span> <span class="s2">&quot;ARGO&quot;</span><span class="p">]</span>
<span class="n">var_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;SSL&quot;</span><span class="p">,</span> <span class="s2">&quot;thermo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;TSSL&quot;</span><span class="p">,</span> <span class="s2">&quot;halo_ssl&quot;</span><span class="p">:</span> <span class="s2">&quot;HSSL&quot;</span><span class="p">}</span>
<span class="n">variables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">var_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="n">anomalies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">prod</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
    <span class="n">anomalies</span><span class="p">[</span><span class="n">prod</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">var_map</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span> <span class="n">da_timeseries</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="n">prod</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">}</span>

<span class="n">anomalies</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">anomaly_sla</span>

<span class="c1"># Compute trends</span>
<span class="n">trends</span> <span class="o">=</span> <span class="p">{</span><span class="n">ds_name</span><span class="p">:</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">linear_trend</span><span class="p">(</span><span class="n">anomalies</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="n">v</span><span class="p">])</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;SSL&quot;</span><span class="p">,</span> <span class="s2">&quot;TSSL&quot;</span><span class="p">,</span> <span class="s2">&quot;HSSL&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">ds_name</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">}</span>
<span class="n">trends</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_trend</span><span class="p">(</span><span class="n">anomalies</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">])</span>

<span class="c1"># ORAS5 only with TSSL</span>
<span class="n">oras5</span> <span class="o">=</span> <span class="n">trends</span><span class="p">[</span><span class="s2">&quot;ORAS5&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">oras5_only_tssl</span> <span class="o">=</span> <span class="n">oras5</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;SSL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;TSSL&quot;</span><span class="p">]</span>
<span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;HSSL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Contribution SSL to GMSL</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ds_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ARGO&quot;</span><span class="p">,</span> <span class="s2">&quot;ORAS5&quot;</span><span class="p">]:</span>
    <span class="n">ssl</span> <span class="o">=</span> <span class="n">trends</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="s2">&quot;SSL&quot;</span><span class="p">]</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span> <span class="n">ds_name</span><span class="p">,</span>
        <span class="s2">&quot;SSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">ssl</span><span class="p">,</span>
        <span class="s2">&quot;TSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">trends</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="s2">&quot;TSSL&quot;</span><span class="p">],</span>
        <span class="s2">&quot;HSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">trends</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="s2">&quot;HSSL&quot;</span><span class="p">],</span>
        <span class="s2">&quot;GMSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
        <span class="s2">&quot;%_of_GMSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">ssl</span> <span class="o">/</span> <span class="n">trends</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">]</span>
    <span class="p">})</span>

<span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;ORAS5_only_TSSL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;SSL&quot;</span><span class="p">],</span>
    <span class="s2">&quot;TSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;TSSL&quot;</span><span class="p">],</span>
    <span class="s2">&quot;HSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;HSSL&quot;</span><span class="p">],</span>
    <span class="s2">&quot;GMSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;%_of_GMSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;SSL&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">trends</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;GMSL_total&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;TSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;HSSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
    <span class="s2">&quot;GMSL (mm/yr)&quot;</span><span class="p">:</span> <span class="n">trends</span><span class="p">[</span><span class="s2">&quot;SLA&quot;</span><span class="p">],</span>
    <span class="s2">&quot;%_of_GMSL&quot;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">df_contrib_GMSL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Dataset&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Contribution TSSL and HSSL to SSL</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ds_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ARGO&quot;</span><span class="p">,</span> <span class="s2">&quot;ORAS5&quot;</span><span class="p">]:</span>
    <span class="n">T</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">trends</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="s2">&quot;TSSL&quot;</span><span class="p">],</span> <span class="n">trends</span><span class="p">[</span><span class="n">ds_name</span><span class="p">][</span><span class="s2">&quot;HSSL&quot;</span><span class="p">]</span>
    <span class="n">tot</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span> <span class="n">ds_name</span><span class="p">,</span>
        <span class="s2">&quot;TSSL_%_of_SSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">tot</span> <span class="k">if</span> <span class="n">tot</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;HSSL_%_of_SSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">/</span><span class="n">tot</span> <span class="k">if</span> <span class="n">tot</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="p">})</span>

<span class="n">T</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;TSSL&quot;</span><span class="p">],</span> <span class="n">oras5_only_tssl</span><span class="p">[</span><span class="s2">&quot;HSSL&quot;</span><span class="p">]</span>
<span class="n">tot</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;ORAS5_only_TSSL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TSSL_%_of_SSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">tot</span> <span class="k">if</span> <span class="n">tot</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;HSSL_%_of_SSL&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">/</span><span class="n">tot</span> <span class="k">if</span> <span class="n">tot</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
<span class="p">})</span>

<span class="n">df_contrib_SSL</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Dataset&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Global trends and contribution to GMSL:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_contrib_GMSL</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">line_width</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Contribution of TSSL and HSSL to SSL (%):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_contrib_SSL</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">line_width</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Global trends and contribution to GMSL:
                 SSL (mm/yr)  TSSL (mm/yr)  HSSL (mm/yr)  GMSL (mm/yr)  %_of_GMSL
Dataset                                                                          
ARGO                    0.85          0.86         -0.00           NaN      23.09
ORAS5                   0.69          1.07         -0.38           NaN      18.61
ORAS5_only_TSSL         1.07          1.07          0.00           NaN      28.91
GMSL_total               NaN           NaN           NaN          3.69     100.00

Contribution of TSSL and HSSL to SSL (%):
                 TSSL_%_of_SSL  HSSL_%_of_SSL
Dataset                                      
ARGO                     99.47           0.53
ORAS5                    73.72          26.28
ORAS5_only_TSSL         100.00           0.00
</pre></div>
</div>
</div>
</div>
<p>Finally, examining the GMSL, we observe a steady increase of 3.69 mm/yr, which amounts to about 70 mm over the study period. Errors are not provided in the dataset, so although a 95% confidence interval for the slope can be computed, the error should also account for instrumental uncertainties, which is not possible in this case. The time series shows two marked jumps, in 2010 and 2015, which have been linked to ENSO-related variability <a class="reference external" href="https://doi.org/10.3390/rs16132466" rel="noreferrer" target="_blank">[18]</a>.</p>
<p>For ORAS5, as with the anomalies, the halosteric component clearly affects the steric sea level. It contributes positively at the beginning of the record and negatively after 2016, partly offsetting the thermosteric contribution. This results in a flatter steric trend across the period, with trend values of 0.69 mm/yr, 1.07 mm/yr, and ‚Äì0.38 mm/yr for steric, thermosteric, and halosteric components, respectively. Corresponding to the 73.72% of SSL for TSSL and 26.28% of SSL for HSSL.</p>
<p>For Argo, the steric and thermosteric components are nearly identical (0.85 mm/yr and 0.86 mm/yr, respectively), reflecting the very weak influence of the halosteric contribution (&lt;0.01 mm/yr), which corresponds to 99.47% and 0.53% of the SSL.</p>
<p>When assessing the sea level budget closure, many studies have addressed the uncertainties involved <a class="reference external" href="https://doi.org/10.1029/2020JC016551" rel="noreferrer" target="_blank">[11]</a>. In addition to differences derived from the products used and from still understudied areas such as the deep-ocean contributions, the method employed to estimate the trend from a time series represents another source of uncertainty <a class="reference external" href="https://doi.org/10.1029/2020JC016551" rel="noreferrer" target="_blank">[11]</a>.</p>
<p>To conclude, the steric sea level contribution to the GMSL is about 18.61% for ORAS5, including the thermosteric and halosteric components. To reflect a more accurate estimate of the steric level, we suggest considering only the thermosteric component (following <a class="reference external" href="https://doi.org/10.1029/2021GL092824" rel="noreferrer" target="_blank">[14]</a> and <a class="reference external" href="https://doi.org/10.5194/essd-10-1551-2018" rel="noreferrer" target="_blank">[4]</a>). This results in a contribution of 28.91%, which is comparable to the 23.09% obtained from Argo data.</p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-level-global?tab=overview" rel="noreferrer" target="_blank">CDS entry</a>: Sea level gridded data from satellite observations for the global ocean from 1993 to present.</p></li>
<li><p><a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-oras5?tab=overview" rel="noreferrer" target="_blank">CDS entry</a>: ORAS5 global ocean reanalysis monthly data from 1958 to present.</p></li>
<li><p><a class="reference external" href="https://sio-argo.ucsd.edu/RG_Climatology.html" rel="noreferrer" target="_blank">SIO entry</a>: Roemmich-Gilson Argo temperature and salinity climatology.</p></li>
</ul>
<p>Further information:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.teos-10.org/software.htm" rel="noreferrer" target="_blank">GSW library</a>, information and uses available from <a class="reference external" href="https://www.teos-10.org/" rel="noreferrer" target="_blank">[19]</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a>.</p></li>
<li><p>ORAS5 steric height data is also computed and saved in ECMWF‚Äôs File Storage system <a class="reference external" href="https://confluence.ecmwf.int/display/UDOC/ECFS+user+documentation" rel="noreferrer" target="_blank">(ECFS)</a>.</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-015-2554-9" rel="noreferrer" target="_blank">[1]</a> Storto, A., Masina, S., Balmaseda, M., Guinehut, S., Xue, Y., Szekely, T., et al. (2017). Steric sea level variability (1993‚Äì2010) in an ensemble of ocean reanalyses and objective analyses. Climate Dynamics, 49(3), 709-729. doi: 10.1007/s00382-015-2554-9</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10712-016-9381-3" rel="noreferrer" target="_blank">[2]</a> Chambers, D. P., Cazenave, A., Champollion, N., Dieng, H., Llovel, W., Forsberg, R., et al. (2017). Evaluation of the global mean sea level budget between 1993 and 2014. In Integrative study of the mean sea level and its components (pp. 315-333). Cham: Springer International Publishing. doi: 10.1007/s10712-016-9381-3</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-14-411-2022" rel="noreferrer" target="_blank">[3]</a> Horwath, M., Gutknecht, B. D., Cazenave, A., Palanisamy, H. K., Marti, F., Marzeion, B., et al. (2021). Global sea-level budget and ocean-mass budget, with focus on advanced data products and uncertainty characterisation. Earth System Science Data Discussions, 2021, 1-51. doi: 10.5194/essd-14-411-2022</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-10-1551-2018" rel="noreferrer" target="_blank">[4]</a> WCRP Global Sea Level Budget Group: Global sea-level budget 1993‚Äìpresent, Earth Syst. Sci. Data, 10, 1551‚Äì1590, 2018. doi: 10.5194/essd-10-1551-2018</p>
<p><a class="reference external" href="https://doi.org/10.1007/s10712-016-9387-x" rel="noreferrer" target="_blank">[5]</a> MacIntosh, C.R., Merchant, C.J., and von Schuckmann, K. Uncertainties in Steric Sea Level Change Estimation During the Satellite Altimeter Era: Concepts and Practices. Surv Geophys 38, 59‚Äì87 (2017). doi: 10.1007/s10712-016-9387-x</p>
<p><a class="reference external" href="https://doi.org/10.1029/2005JC003421" rel="noreferrer" target="_blank">[6]</a> Lowe, J. A., and Gregory, J. M. (2006). Understanding projections of sea level rise in a Hadley Centre coupled climate model. Journal of Geophysical Research: Oceans, 111(C11). doi: 10.1029/2005JC003421</p>
<p><a class="reference external" href="https://doi.org/10.3390/w9070484" rel="noreferrer" target="_blank">[7]</a> Wang, G., Cheng, L., Boyer, T., and Li, C. (2017). Halosteric sea level changes during the Argo era. Water, 9(7), 484. doi: 10.3390/w9070484</p>
<p><a class="reference external" href="https://doi.org/10.3390/w11101987" rel="noreferrer" target="_blank">[8]</a> Storto, A., Bonaduce, A., Feng, X., and Yang, C. (2019). Steric sea level changes from ocean reanalyses at global and regional scales. Water, 11(10), 1987. doi: 10.3390/w11101987</p>
<p><a class="reference external" href="https://doi.org/10.1029/2004JC002817" rel="noreferrer" target="_blank">[9]</a> Carton, J. A., Giese, B. S., and Grodsky, S. A. (2005). Sea level rise and the warming of the oceans in the Simple Ocean Data Assimilation (SODA) ocean reanalysis. Journal of Geophysical Research: Oceans, 110(C9). doi: 10.1029/2004JC002817</p>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-018-4585-5" rel="noreferrer" target="_blank">[10]</a> Storto, A., Masina, S., Simoncelli, S., Iovino, D., Cipollone, A., Drevillon, M., et al. (2019). The added value of the multi-system spread information for ocean heat content and steric sea level investigations in the CMEMS GREP ensemble reanalysis product. Climate dynamics, 53(1), 287-312. doi: 10.1007/s00382-018-4585-5</p>
<p><a class="reference external" href="https://doi.org/10.1029/2020JC016551" rel="noreferrer" target="_blank">[11]</a> Camargo, C. M., Riva, R. E., Hermans, T. H., and Slangen, A. B. (2020). Exploring sources of uncertainty in steric sea‚Äêlevel change estimates. Journal of Geophysical Research: Oceans, 125(10), e2020JC016551. doi: 10.1029/2020JC016551</p>
<p><a class="reference external" href="https://doi.org/10.5194/os-21-1425-2025" rel="noreferrer" target="_blank">[12]</a> Bouih, M., Barnoud, A., Yang, C., Storto, A., Blazquez, A., Llovel, W., et al. (2025). Regional sea level trend budget over 2004‚Äì2022. Ocean Science, 21(4), 1425-1440. doi: 10.5194/os-21-1425-2025</p>
<p><a class="reference external" href="https://doi.org/10.1029/2023GL107844" rel="noreferrer" target="_blank">[13]</a> Lele, R., and Purkey, S. G. (2024). Understanding full‚Äêdepth steric sea level change in the Southwest Pacific Basin using Deep Argo. Geophysical Research Letters, 51(12), e2023GL107844. doi: 10.1029/2023GL107844</p>
<p><a class="reference external" href="https://doi.org/10.1029/2021GL092824" rel="noreferrer" target="_blank">[14]</a> Barnoud, A., Pfeffer, J., Gu√©rou, A., Frery, M. L., Sim√©on, M., Cazenave, A., et al. (2021). Contributions of altimetry and Argo to non‚Äêclosure of the global mean sea level budget since 2016. Geophysical Research Letters, 48(14), e2021GL092824. doi: 10.1029/2021GL092824</p>
<p><a class="reference external" href="https://doi.org/10.5194/os-15-779-2019" rel="noreferrer" target="_blank">[15]</a> Zuo, H., Balmaseda, M. A., Tietsche, S., Mogensen, K., and Mayer, M. (2019). The ECMWF operational ensemble reanalysis‚Äìanalysis system for ocean and sea ice: a description of the system and assessment. Ocean science, 15(3), 779-808. doi: 10.5194/os-15-779-2019</p>
<p><a class="reference external" href="https://doi.org/10.3389/fmars.2024.1496409" rel="noreferrer" target="_blank">[16]</a> Ishikawa, I., Fujii, Y., De Boisseson, E., Wang, Y., and Zuo, H. (2024). Evaluation of the effects of Argo data quality control on global ocean data assimilation systems. Frontiers in Marine Science, 11, 1496409. doi: 10.3389/fmars.2024.1496409</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.pocean.2009.03.004" rel="noreferrer" target="_blank">[17]</a> Roemmich, D., and Gilson, J. (2009). The 2004‚Äì2008 mean and annual cycle of temperature, salinity, and steric height in the global ocean from the Argo Program. Progress in oceanography, 82(2), 81-100. doi: 10.1016/j.pocean.2009.03.004</p>
<p><a class="reference external" href="https://doi.org/10.3390/rs16132466" rel="noreferrer" target="_blank">[18]</a> Xie, J., Sun, Z., Zhou, S., Zhong, Y., Sun, P., Xiong, Y., et al. (2024). Significant Increase in Global Steric Sea Level Variations over the Past 40 Years. Remote Sensing, 16(13), 2466. doi: 10.3390/rs16132466</p>
<p><a class="reference external" href="https://www.teos-10.org/" rel="noreferrer" target="_blank">[19]</a> McDougall, T.J. and P.M. Barker, 2011: Getting started with TEOS-10 and the Gibbs Seawater (GSW) Oceanographic Toolbox, 28pp., SCOR/IAPSO WG127, ISBN 978-0-646-55621-5. Available from <a class="reference external" href="https://www.teos-10.org/" rel="noreferrer" target="_blank">www.TEOS-10.org</a> (this is the present document)</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Reanalyses"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="reanalysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Reanalysis</p>
      </div>
    </a>
    <a class="right-next"
       href="../Seasonal_Forecasts/seasonal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Seasonal forecasts</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-studying-the-contribution-of-steric-sea-level-to-the-global-sea-level-budget">üåç Use case: Studying the Contribution of Steric Sea Level to the Global Sea Level Budget</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">‚ùì Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection-and-setup">1. Data selection and setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-libraries">Import required libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-data-requests-for-oras5-reanalysis-and-satellite-altimetry">Define data requests for ORAS5 reanalysis and satellite altimetry</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steric-height-components">2. Define steric height components</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-absolute-salinity-sa-conservative-temperature-ct-and-density-rho">Compute Absolute Salinity (SA), Conservative Temperature (CT), and density (<span class="math notranslate nohighlight">\(\rho\)</span>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-density-field-and-anomalies">Reference Density Field and Anomalies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-sea-level-ssl">Steric Sea Level (SSL)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-thermosteric-and-halosteric-components-from-argo-based-data">Steric, thermosteric and halosteric components from Argo-based data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-steric-sea-level-anomalies">3. Define steric sea level anomalies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-regional-steric-sea-level-trends">4. Define regional steric sea level trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform">5. Download and transform</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-oras5">For <strong>ORAS5</strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-argo">For <strong>Argo</strong>:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#for-satellite-altimetry">For <strong>satellite altimetry</strong>:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-and-discussion-of-results">6. Plotting and discussion of results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-time-series">Steric time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#steric-regional-trends">Steric regional trends</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-steric-trends-and-contribution-to-observed-gmsl-from-satellite-altimetry">Global steric trends and contribution to observed GMSL from satellite altimetry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>