
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.2.6. CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6. Indicators" href="../../Indicators/indicator.html" />
    <link rel="prev" title="5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors." href="climate_projections-cordex-domains-single-levels_validation_q05.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/satellite_satellite-total-column-water-vapour-ocean_validation_q01.html">1.1.1. Water vapor amplification of Earth‚Äôs Greenhouse Effect</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01.html">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html">1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q03.html">1.2.4. Methane satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.5. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.6. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_derived-gridded-glacier-mass-change_trend-assessment_q02.html">1.3.2. Glacier mass change data from satellite and in-situ observations: resolution and coverage for trend analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-greenland-ice-sheet-velocity_trend-assessment_q01.html">1.3.3. Ice sheet velocity data from satellite observations: temporal and spatial coverage and data completeness for trend analysis in glaciological applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.4. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.5. Uncertainty of ice sheet surface elevation change¬†data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.6. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-mass-balance_uncertainty_q01.html">1.3.7. Gravimetric mass changes from satellite data: assessment of resolution and uncertainty of Greenland ice sheet mass changes for glaciological applications</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_climate-and-weather-extremes_q01.html">1.5.1. Lake Victoria‚Äôs 2020 Flood Event Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/satellite_satellite-lake-water-level_completeness_q02.html">1.5.2. Assessing Lake Titicaca‚Äôs water levels in support of water management</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_completeness_q01.html">1.6.1. Completeness of ocean colour observations for biogeochemical models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.2. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.3. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.4. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.5. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.6. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.7. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06.html">4.3. Assessing the impact of spatial scale and temporal trends on seasonal forecast quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.4. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../climate.html">5. Quality assessments for Climate Projections</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2¬∞C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2¬∞C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 experiment [climate (projections)]-[model-performance]-[scientific-study]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_validation_q12.html">5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CMIP6/climate_projections-cmip6_validation_q13.html">5.1.13. CMIP6 biases in the SPEI6 drought index over the Mediterranean region</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="CORDEX.html">5.2. CORDEX</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">5.2.6. CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q01.html">7.1. Consistency between the C3S Atlas dataset and its origins: Case study</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q02.html">7.2. Consistency between the C3S Atlas dataset and its origins: Multiple indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Derived_Datasets/derived_multi-origin-c3s-atlas_consistency_q03.html">7.3. Consistency between the C3S Atlas dataset and its origins: Multiple origin datasets</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_gttm_uncertainty_q01.html">8.1. Assessing global warming with the C3S Global Temperature Trend Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_pulse_extreme-events_q01.html">8.2. Visualisation of temperature during extreme weather events with Climate Pulse</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FClimate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-climate-biases-in-mountain-regions-to-inform-the-ski-and-hydrological-sectors">üåç Use case: Investigating climate biases in mountain regions to inform the ski and hydrological sectors.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1. Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">1.2. Define Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-models">1.3. Define models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-cerra-request">1.4. Define CERRA request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-e-obs-request">1.5. Define E-OBS request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-model-requests">1.6. Define model requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache">1.7. Functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-and-processing">2. Downloading and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-regridding-model">2.1. Download and transform the regridding model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cerra">2.2. Download and transform CERRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-e-obs">2.3. Download and transform E-OBS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-models">2.4. Download and transform models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-land-sea-mask">2.5. Apply land-sea mask</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-plotting-functions">3.1. Define plotting functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-biases-relative-to-e-obs">3.2.Elevation profiles of biases relative to E-OBS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-biases-after-applying-lapse-rate-correction">3.3. Elevation profiles of biases after applying lapse-rate correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-the-impact-of-lapse-rate-correction">3.4. Elevation profiles of the impact of lapse-rate correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results-summary">3.5. Results summary</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-the-users">3.6. Implications for the users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="cordex-temperature-biases-over-the-alpine-region-assessment-using-e-obs-and-cerra">
<h1><span class="section-number">5.2.6. </span>CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA<a class="headerlink" href="#cordex-temperature-biases-over-the-alpine-region-assessment-using-e-obs-and-cerra" title="Link to this heading">#</a></h1>
<p>Production date: 30-06-2025</p>
<p>Produced by: CMCC foundation - Euro-Mediterranean Center on Climate Change. Albert Martinez Boti and Lorenzo Sangelantoni.</p>
<section id="use-case-investigating-climate-biases-in-mountain-regions-to-inform-the-ski-and-hydrological-sectors">
<h2>üåç Use case: Investigating climate biases in mountain regions to inform the ski and hydrological sectors.<a class="headerlink" href="#use-case-investigating-climate-biases-in-mountain-regions-to-inform-the-ski-and-hydrological-sectors" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Are the cold biases commonly found in Regional Climate Models over the Alps apparent when evaluated against CERRA?</strong></p></li>
<li><p><strong>Does applying a lapse-rate correction reduce these biases?</strong></p></li>
</ul>
<p>Mountains, although covering a limited land area, are vital to the global water cycle, acting as key sources of freshwater for both ecological and human needs <a class="reference external" href="https://doi.org/10.1038/s41586-019-1822-y" rel="noreferrer" target="_blank">[1]</a>. In many mountainous regions, temperature is a critical driver of hydrometeorological processes such as the ratio of rain to snow, the timing of snowmelt, and the frequency of low-flow conditions <a class="reference external" href="https://doi.org/10.1175/BAMS-D-23-0082.1" rel="noreferrer" target="_blank">[2]</a>. These sensitivities make mountain regions key indicators of climate change. However, accurately representing temperature in complex terrain remains challenging for models due to factors like topographic variability, slope orientation, terrain shading, snow‚Äìalbedo feedbacks, and vegetation heterogeneity <a class="reference external" href="https://doi.org/10.1175/BAMS-D-23-0082.1" rel="noreferrer" target="_blank">[2]</a>).</p>
<p>A recent literature-based quality assessment, <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html" rel="noreferrer" target="_blank">CORDEX temperature biases over the Alpine region for the ski and hydrological sectors</a>, synthesised multiple studies and confirmed that Regional Climate Models (RCMs) exhibit persistent cold biases over the Alps despite their relatively high resolution and improved representation of physical processes in mountainous terrain. Given that bias estimates are sensitive to the choice of reference dataset -as highlighted in the quality assessment <a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">[3]</a><a class="reference external" href="https://doi.org/10.3390/cli11070154" rel="noreferrer" target="_blank">[4]</a>- here we evaluate RCM biases against E-OBS and include CERRA, a high-resolution (5.5 km) regional reanalysis produced using the HARMONIE-ALADIN limited-area numerical weather prediction and data assimilation system. The analysis includes a broad ensemble of EURO-CORDEX models and examines the altitude dependency of biases by evaluating results across different elevation bands. Finally, we apply a lapse-rate correction to place all datasets at a common elevation and investigate whether this influences the estimated biases.</p>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>CORDEX simulations exhibit biases relative to both reference datasets (E-OBS and CERRA).</p></li>
<li><p>RCMs‚Äô systematic cold biases above 1000‚Äì1500 m, reported in the literature, are evident when evaluated against E-OBS.</p></li>
<li><p>CORDEX biases relative to CERRA are weaker and show no systematic increase with altitude, unlike the case with E-OBS.</p></li>
<li><p>Large inter-model spread‚Äîespecially for winter cold extremes above 1500‚ÄØm‚Äîhighlights significant uncertainty in representing conditions critical for alpine risk assessments.</p></li>
<li><p>Lapse-rate correction might slightly reduce biases by ensuring no elevation differences exist between datasets, but it does not fundamentally change the shape of vertical bias profiles or address the underlying model or observational issues driving the biases.</p></li>
<li><p>The findings of this Alpine-focused assessment highlight the need for caution when interpreting future temperature projections from RCMs. A central concern is the potential for present-climate biases to persist or propagate into future warming scenarios‚Äîan aspect that remains largely underexplored.</p></li>
</ul>
</div>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/0eeb016f-678f-44d4-b821-4d782590b4f2.png"><img alt="Visual abstract" src="../../_images/0eeb016f-678f-44d4-b821-4d782590b4f2.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5.2.6.1 </span><span class="caption-text">Elevation profiles of biases relative to E-OBS. Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles. The ensemble median is represented by a solid black line, while individual EURO-CORDEX models appear as grey dashed lines. The model spread, calculated as the standard deviation across models, is shown as a grey shaded area. CERRA is depicted in orange. No lapse-rate correction is applied in this case, and data are grouped by the elevation of each model or reference dataset.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>A subset of 39 models from <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cordex-domains-single-levels?tab=quality_assurance_tab" rel="noreferrer" target="_blank">EURO-CORDEX</a> is compared to <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/insitu-gridded-observations-europe?tab=overview" rel="noreferrer" target="_blank">E-OBSv30.0e</a> to assess the elevation dependency of temperature biases. Following the approach of <a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">[3]</a>, we evaluate differences between the RCMs and E-OBS in representing the 5th, 50th, and 95th percentiles of temperature at various altitude ranges, for both summer and winter, across the Greater Alpine Region (GAR; 4‚Äì19¬∞E, 43‚Äì49¬∞N, 0‚Äì3500 m a.s.l.; <a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">[5]</a><a class="reference external" href="https://doi.org/10.1002/joc.1377" rel="noreferrer" target="_blank">[6]</a>). The extent of the GAR domain can be seen in <em>Figure .2 - GAR</em> reproduced from Haslinger et al., 2019 <a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">[5]</a> under the <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/" rel="noreferrer" target="_blank">CC BY 4.0</a>.</p>
<p>To assess consistency across reference datasets, CERRA‚Äîa high-resolution (5.5 km) regional reanalysis produced using the HARMONIE-ALADIN limited-area numerical weather prediction and data assimilation system‚Äîis also compared to E-OBS and the RCMs.</p>
<p>All datasets are regridded to a 0.11¬∞ grid corresponding to a selected RCM (user-defined). There is no clear consensus in the literature on the optimal regridding approach: regridding to a finer resolution can be useful for certain applications but risks introducing artificial spatial detail not supported by the underlying data, whereas regridding to a coarser grid preserves the original physical consistency. In this work, we have chosen to regrid to the coarser resolution, following the approach in <a class="reference external" href="https://doi.org/10.1002/joc.5249" rel="noreferrer" target="_blank">[7]</a>.</p>
<p>While regridding enables consistent spatial comparison, it does not inherently align the elevations of different datasets, which may still differ due to variations in underlying orography. To address this, a lapse-rate correction is applied to adjust all datasets to the same target elevation. CERRA‚Äôs elevation (regridded to 0.11¬∞) is used as the target, as CERRA originally has the highest spatial resolution. A spatially and temporally uniform lapse rate of 0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π is applied to all regridded datasets‚Äîincluding E-OBS and the RCMs‚Äîfollowing a procedure similar to <a class="reference external" href="https://doi.org/10.1002/joc.5249" rel="noreferrer" target="_blank">[7]</a>. Differences in temperatures before and after this correction are evaluated to determine whether the adjustment produces substantial changes.</p>
<p>The analysis and results follow the next outline:</p>
<p><strong><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1"><span class="std std-ref">1. Parameters, requests and functions definition</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-1"><span class="std std-ref">1.1. Import packages</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-2"><span class="std std-ref">1.2. Define Parameters</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-3"><span class="std std-ref">1.3. Define models</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-4"><span class="std std-ref">1.4. Define CERRA request</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-5"><span class="std std-ref">1.5. Define E-OBS request</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-6"><span class="std std-ref">1.6. Define model requests</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-7"><span class="std std-ref">1.7. Functions to cache</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2"><span class="std std-ref">2. Downloading and processing</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-1"><span class="std std-ref">2.1. Download and transform the regridding model</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-2"><span class="std std-ref">2.2. Download and transform CERRA</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-3"><span class="std std-ref">2.3. Download and transform E-OBS</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-4"><span class="std std-ref">2.4. Download and transform models</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-5"><span class="std std-ref">2.5. Apply land-sea mask</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3"><span class="std std-ref">3. Plot and describe results</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-1"><span class="std std-ref">3.1. Define plotting functions</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-2"><span class="std std-ref">3.2.Elevation profiles of biases relative to E-OBS</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-3"><span class="std std-ref">3.3. Elevation profiles of biases after applying lapse-rate correction</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-4"><span class="std std-ref">3.4. Elevation profiles of the impact of lapse-rate correction</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-5"><span class="std std-ref">3.5. Results summary</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-6"><span class="std std-ref">3.6. Implications for the users</span></a></p></li>
</ul>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../../_images/5fd0ab4f-7024-4560-8446-80e6664efd46.png"><img alt="figure 2" src="../../_images/5fd0ab4f-7024-4560-8446-80e6664efd46.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5.2.6.2 </span><span class="caption-text">Map of Central and Southern Europe. The broken line indicates the boundaries of the Greater Alpine Region; the solid line represents a generalized outline of the 1000 m a.s.l. isoline of the Alps which should help in locating the mountainous areas of the domain in the following figures. Image reproduced from <em>Figure 1</em> in Haslinger et al., 2019 <a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">[5]</a>, under the <a class="reference external" href="https://creativecommons.org/licenses/by/4.0/" rel="noreferrer" target="_blank">CC BY 4.0</a></span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="parameters-requests-and-functions-definition">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1"></span><h3>1. Parameters, requests and functions definition<a class="headerlink" href="#parameters-requests-and-functions-definition" title="Link to this heading">#</a></h3>
<section id="import-packages">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-1"></span><h4>1.1. Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xarrayMannKendall</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mann_Kendall_test</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.gridliner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gridliner</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">signal</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;hatch.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-2"></span><h4>1.2. Define Parameters<a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h4>
<p>In the ‚ÄúDefine Parameters‚Äù section, various customisable options for the notebook are specified:</p>
<ul class="simple">
<li><p>The start and end years of the historical period can be specified using the <code class="docutils literal notranslate"><span class="pre">year_start</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop</span></code> parameters. The default period, 1986‚Äì2005, is selected to maximise dataset availability while avoiding the need to include future projection data.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">chunk</span></code> selection allows the user to define if dividing into chunks when downloading the data on their local machine. Although it does not significantly affect the analysis, it is recommended to keep the default value for optimal performance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> and <code class="docutils literal notranslate"><span class="pre">collection_id</span></code> are not customisable for this assessment and are set to ‚Äòtemperture‚Äô and ‚ÄòCORDEX‚Äô. Expert users can use this notebook as a guide to create similar analyses for other variables or model sets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">area</span></code> defines the geographical domain over which the analysis will be performed. Note that this notebook is designed for the EURO-CORDEX domain, so the selected area must lie within its boundaries. The Greater Alpine Region (GAR; 4‚Äì19¬∞E, 43‚Äì49¬∞N, 0‚Äì3500 m a.s.l.; <a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">[5]</a><a class="reference external" href="https://doi.org/10.1002/joc.1377" rel="noreferrer" target="_blank">[6]</a>) is choosen for this assessment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rcm_model_regrid</span></code> and <code class="docutils literal notranslate"><span class="pre">gcm_driven_model_regrid</span></code> specify the EURO-CORDEX regional climate model and the driving global climate model, respectively, whose grid will be used as the target for remapping. Note that both models must be included in the matrix of RCM-GCM combinations defined by the <code class="docutils literal notranslate"><span class="pre">models_cordex</span></code> dictionary in Section 1.3.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time period</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1986</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2005</span>
<span class="k">assert</span> <span class="n">year_start</span> <span class="o">&gt;=</span> <span class="mi">1986</span>

<span class="c1"># Variable</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;temperature&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">)</span>

<span class="c1"># Choose CORDEX or CMIP6</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;CORDEX&quot;</span>
<span class="k">assert</span> <span class="n">collection_id</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;CORDEX&quot;</span><span class="p">)</span>

<span class="c1"># Area to show (Alpine Area)</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">49</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">19</span><span class="p">]</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">gcm_driven_model_regrid</span><span class="o">=</span><span class="s2">&quot;ichec_ec_earth&quot;</span> 
<span class="n">rcm_model_regrid</span><span class="o">=</span><span class="s2">&quot;smhi_rca4&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-models">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-3"></span><h4>1.3. Define models<a class="headerlink" href="#define-models" title="Link to this heading">#</a></h4>
<p>The following climate analyses are conducted using the EURO-CORDEX models available at the time of download, limited to those that include the orography variable in the Climate Data Store (<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cordex-domains-single-levels?tab=overview" rel="noreferrer" target="_blank">CDS</a>).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gcm_models</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;cccma_canesm2&quot;</span><span class="p">,</span><span class="s2">&quot;cnrm_cerfacs_cm5&quot;</span><span class="p">,</span><span class="s2">&quot;ichec_ec_earth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ipsl_cm5a_mr&quot;</span><span class="p">,</span><span class="s2">&quot;miroc_miroc5&quot;</span><span class="p">,</span> <span class="s2">&quot;mohc_hadgem2_es&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mpi_m_mpi_esm_lr&quot;</span><span class="p">,</span> <span class="s2">&quot;ncc_noresm1_m&quot;</span>
<span class="p">)</span>
<span class="n">model_regrid</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gcm_driven_model_regrid</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">rcm_model_regrid</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">models_cordex</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;cccma_canesm2&quot;</span><span class="p">:[</span><span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">],</span>
    <span class="s2">&quot;cnrm_cerfacs_cm5&quot;</span><span class="p">:(</span><span class="s2">&quot;clmcom_eth_cosmo_crclim&quot;</span><span class="p">,</span><span class="s2">&quot;cnrm_aladin63&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">,</span>                    
                        <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span><span class="s2">&quot;mohc_hadrem3_ga7_05&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ichec_ec_earth&quot;</span><span class="p">:(</span><span class="s2">&quot;clmcom_eth_cosmo_crclim&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span><span class="s2">&quot;smhi_rca4&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ipsl_cm5a_mr&quot;</span><span class="p">:(</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span><span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span><span class="s2">&quot;smhi_rca4&quot;</span><span class="p">),</span>
    <span class="s2">&quot;miroc_miroc5&quot;</span><span class="p">:(</span><span class="s2">&quot;clmcom_clm_cclm4_8_17&quot;</span><span class="p">,</span><span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">),</span>
    <span class="s2">&quot;mohc_hadgem2_es&quot;</span><span class="p">:(</span><span class="s2">&quot;clmcom_clm_cclm4_8_17&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;cnrm_aladin63&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span><span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;mohc_hadrem3_ga7_05&quot;</span><span class="p">,</span><span class="s2">&quot;smhi_rca4&quot;</span><span class="p">),</span>
    <span class="s2">&quot;mpi_m_mpi_esm_lr&quot;</span><span class="p">:(</span><span class="s2">&quot;clmcom_clm_cclm4_8_17&quot;</span><span class="p">,</span><span class="s2">&quot;clmcom_eth_cosmo_crclim&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;cnrm_aladin63&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span><span class="s2">&quot;mohc_hadrem3_ga7_05&quot;</span><span class="p">,</span> 
                       <span class="s2">&quot;mpi_csc_remo2009&quot;</span><span class="p">,</span><span class="s2">&quot;smhi_rca4&quot;</span><span class="p">,</span><span class="s2">&quot;uhoh_wrf361h&quot;</span><span class="p">),</span>
    <span class="s2">&quot;ncc_noresm1_m&quot;</span><span class="p">:(</span><span class="s2">&quot;cnrm_aladin63&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;gerics_remo2015&quot;</span><span class="p">,</span> 
                     <span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">,</span><span class="s2">&quot;mohc_hadrem3_ga7_05&quot;</span><span class="p">,</span><span class="s2">&quot;smhi_rca4&quot;</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">resample_reduction</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span>
<span class="n">cerra_variable</span> <span class="o">=</span> <span class="s2">&quot;2m_temperature&quot;</span>
<span class="n">eobs_variable</span><span class="o">=</span><span class="s2">&quot;mean_temperature&quot;</span>
<span class="n">cordex_variable</span> <span class="o">=</span> <span class="s2">&quot;2m_air_temperature&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-cerra-request">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-4"></span><h4>1.4. Define CERRA request<a class="headerlink" href="#define-cerra-request" title="Link to this heading">#</a></h4>
<p>Within this notebook, CERRA is also used to stress the sensitivity of results to the choice of reference dataset. In this section, we define the necessary parameters for the cds-api data request for CERRA.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_cerra</span> <span class="o">=</span> <span class="p">(</span>
    
    <span class="s2">&quot;reanalysis-cerra-single-levels&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;reanalysis&quot;</span><span class="p">],</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">cerra_variable</span><span class="p">],</span>
        <span class="s2">&quot;level_type&quot;</span><span class="p">:</span> <span class="s2">&quot;surface_or_atmosphere&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">],</span>  <span class="c1"># Include D(year-1)</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;00:00&quot;</span><span class="p">,</span> <span class="s2">&quot;03:00&quot;</span><span class="p">,</span> <span class="s2">&quot;06:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;09:00&quot;</span><span class="p">,</span> <span class="s2">&quot;12:00&quot;</span><span class="p">,</span> <span class="s2">&quot;15:00&quot;</span><span class="p">,</span>
            <span class="s2">&quot;18:00&quot;</span><span class="p">,</span> <span class="s2">&quot;21:00&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_orography_cerra</span><span class="o">=</span><span class="p">(</span>
    <span class="s2">&quot;reanalysis-cerra-single-levels&quot;</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;orography&quot;</span><span class="p">],</span>
            <span class="s2">&quot;level_type&quot;</span><span class="p">:</span> <span class="s2">&quot;surface_or_atmosphere&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;reanalysis&quot;</span><span class="p">],</span>
            <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1987&quot;</span><span class="p">],</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">],</span>
            <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">],</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;00:00&quot;</span><span class="p">],</span>
            <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-e-obs-request">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-5"></span><h4>1.5. Define E-OBS request<a class="headerlink" href="#define-e-obs-request" title="Link to this heading">#</a></h4>
<p>Within this notebook, E-OBS serves as the reference product. In this section, we set the required parameters for the cds-api data-request of E-OBS.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_eobs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;insitu-gridded-observations-europe&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;ensemble_mean&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">eobs_variable</span><span class="p">],</span>
        <span class="s2">&quot;grid_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_1deg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;period&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1980_1994&quot;</span><span class="p">,</span><span class="s2">&quot;1995_2010&quot;</span><span class="p">],</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;30_0e&quot;</span><span class="p">]</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_orography_eobs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;insitu-gridded-observations-europe&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;elevation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;land_surface_elevation&quot;</span><span class="p">],</span>
        <span class="s2">&quot;grid_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_1deg&quot;</span><span class="p">,</span>
        <span class="s2">&quot;period&quot;</span><span class="p">:</span><span class="s2">&quot;full_period&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;30_0e&quot;</span><span class="p">]</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_lsm</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">request_cerra</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">request_cerra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">|</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;1986&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;land_sea_mask&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-model-requests">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-6"></span><h4>1.6. Define model requests<a class="headerlink" href="#define-model-requests" title="Link to this heading">#</a></h4>
<p>In this section we set the required parameters for the cds-api data-request of EURO-CORDEX models.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models_r1i1p1_orog</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cnrm_aladin63&quot;</span><span class="p">,</span><span class="s2">&quot;dmi_hirham5&quot;</span><span class="p">,</span><span class="s2">&quot;mohc_hadrem3_ga7_05&quot;</span><span class="p">,</span><span class="s2">&quot;knmi_racmo22e&quot;</span><span class="p">]</span> 
<span class="n">request_cordex</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;europe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_11_degree_x_0_11_degree&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_mean&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">cordex_variable</span><span class="p">],</span>
    <span class="s2">&quot;ensemble_member&quot;</span><span class="p">:</span> <span class="s2">&quot;r1i1p1&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_cordex_years</span><span class="p">(</span>
    <span class="n">year_start</span><span class="p">,</span>
    <span class="n">year_stop</span><span class="p">,</span>
    <span class="n">start_years</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1951</span><span class="p">,</span> <span class="mi">2097</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
    <span class="n">end_years</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1955</span><span class="p">,</span> <span class="mi">2101</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="p">):</span>
    <span class="n">start_year</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">end_year</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">years</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_years</span><span class="p">,</span> <span class="n">end_years</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">years</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
            <span class="n">start_year</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
            <span class="n">end_year</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span>


<span class="n">model_requests</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">gcm_model</span> <span class="ow">in</span> <span class="n">gcm_models</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_cordex</span><span class="p">[</span><span class="n">gcm_model</span><span class="p">]:</span>
        <span class="n">start_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">end_years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">year_stop</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">model_requests</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gcm_model</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;projections-cordex-domains-single-levels&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;rcm_model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
                    <span class="s2">&quot;gcm_model&quot;</span><span class="p">:</span> <span class="n">gcm_model</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">request_cordex</span><span class="p">,</span>
                    <span class="s2">&quot;start_year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start_year</span><span class="p">)],</span>
                    <span class="s2">&quot;end_year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">end_year</span><span class="p">)],</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">start_year</span><span class="p">,</span> <span class="n">end_year</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="o">*</span><span class="n">get_cordex_years</span><span class="p">(</span>
                        <span class="n">year_start</span><span class="p">,</span>
                        <span class="n">year_stop</span><span class="p">,</span>
                        <span class="n">start_years</span><span class="o">=</span><span class="n">start_years</span><span class="p">,</span>
                        <span class="n">end_years</span><span class="o">=</span><span class="n">end_years</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">],</span>
        <span class="p">)</span>

<span class="n">request_grid_out</span> <span class="o">=</span> <span class="n">model_requests</span><span class="p">[</span><span class="n">model_regrid</span><span class="p">]</span>

<span class="n">model_requests_orography</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">gcm_model</span> <span class="ow">in</span> <span class="n">gcm_models</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_cordex</span><span class="p">[</span><span class="n">gcm_model</span><span class="p">]:</span>
        <span class="n">gcm_rcm_combination</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gcm_model</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">model_requests_orography</span><span class="p">[</span><span class="n">gcm_rcm_combination</span><span class="p">]</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;projections-cordex-domains-single-levels&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;europe&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;rcp_8_5&quot;</span> <span class="k">if</span> <span class="n">gcm_rcm_combination</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mpi_m_mpi_esm_lr_uhoh_wrf361h&quot;</span><span class="p">,</span><span class="s2">&quot;ncc_noresm1_m_cnrm_aladin63&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;horizontal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;0_11_degree_x_0_11_degree&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;fixed&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;orography&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;gcm_model&quot;</span><span class="p">:</span> <span class="n">gcm_model</span><span class="p">,</span>
                    <span class="s2">&quot;rcm_model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
                    <span class="s2">&quot;ensemble_member&quot;</span><span class="p">:</span><span class="s2">&quot;r1i1p1&quot;</span> <span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_r1i1p1_orog</span> <span class="k">else</span> <span class="s2">&quot;r0i0p0&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">)</span>

<span class="n">request_orography_grid_out</span><span class="o">=</span><span class="n">model_requests_orography</span><span class="p">[</span><span class="n">model_regrid</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-cache">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-1-7"></span><h4>1.7. Functions to cache<a class="headerlink" href="#functions-to-cache" title="Link to this heading">#</a></h4>
<p>In this section, functions that will be executed in the caching phase are defined. Caching is the process of storing copies of files in a temporary storage location, so that they can be accessed more quickly. This process also checks if the user has already downloaded a file, avoiding redundant downloads.</p>
<p>Description of the main functions:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">compute_percentiles</span></code></strong>: This function resamples data to daily frequency if needed (e.g., for hourly CERRA data), performs regridding to the target grid, selects the subregion of interest, and calculates the 5th, 50th, and 95th percentiles for summer and winter.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">orog_regrid</span></code></strong>: This function regrids the orography data from the models, E-OBS and CERRA onto the selected RCM grid (defined by the <code class="docutils literal notranslate"><span class="pre">model_regrid</span></code> parameter), enabling a subsequent point-by-point lapse-rate correction.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">select_timeseries</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">timeseries</span><span class="o">=</span><span class="s2">&quot;JJA&quot;</span><span class="p">,</span> <span class="n">year_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">year_stop</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">timeseries</span> <span class="o">==</span> <span class="s2">&quot;JJA&quot;</span><span class="p">:</span>
        <span class="n">season_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">timeseries</span> <span class="o">==</span> <span class="s2">&quot;DJF&quot;</span><span class="p">:</span>
        <span class="n">season_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported season: </span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Ensure time is datetime type</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
        <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">decode_cf</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">.</span><span class="n">time</span>

    <span class="c1"># Filter by years</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">-12-31&quot;</span><span class="p">))</span>

    <span class="c1"># Filter by season</span>
    <span class="n">ds_season</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time.month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">season_months</span><span class="p">),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_season</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_p</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">percentile</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">percentile</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_bounds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">}</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">bounds</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">add_bounds</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_grid_out</span><span class="p">(</span><span class="n">request_grid_out</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="n">ds_regrid</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request_grid_out</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conservative&quot;</span><span class="p">:</span>
        <span class="n">ds_regrid</span> <span class="o">=</span> <span class="n">add_bounds</span><span class="p">(</span><span class="n">ds_regrid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ds_regrid</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">coord</span><span class="p">])</span>
    <span class="n">grid_out</span> <span class="o">=</span> <span class="n">ds_regrid</span><span class="p">[</span><span class="n">coords</span><span class="p">]</span>
    <span class="n">coords_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">grid_out</span> <span class="o">=</span> <span class="n">ds_regrid</span><span class="p">[</span><span class="n">coords</span><span class="p">]</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">coords_to_drop</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">grid_out</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">return</span> <span class="n">grid_out</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_percentiles</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span>
    <span class="n">year_start</span><span class="p">,</span>
    <span class="n">year_stop</span><span class="p">,</span>
    <span class="n">area</span><span class="p">,</span>
    <span class="n">resample_reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">request_grid_out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">request_grid_out</span> <span class="ow">and</span> <span class="n">regrid_kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">request_grid_out</span> <span class="ow">or</span> <span class="n">regrid_kwargs</span>
    <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)]</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-01-01&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">-12-31&quot;</span><span class="p">))</span>

    <span class="c1"># Select a subdomain</span>
    <span class="n">regionalise_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="n">resample_reduction</span><span class="p">:</span>
        <span class="n">resampled</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resampled</span><span class="p">,</span> <span class="n">resample_reduction</span><span class="p">)(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Original bounds for conservative interpolation</span>
    <span class="k">if</span> <span class="n">regrid_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;conservative&quot;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">add_bounds</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">request_grid_out</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">merge</span><span class="p">({</span><span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">da</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">}),</span>
            <span class="n">grid_out</span><span class="o">=</span><span class="n">get_grid_out</span><span class="p">(</span><span class="n">request_grid_out</span><span class="p">,</span> <span class="n">regrid_kwargs</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]),</span>
            <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">regionalise_kwargs</span><span class="p">)</span>


    <span class="c1"># Compute percentiles </span>
    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;jja&quot;</span><span class="p">,</span> <span class="s2">&quot;djf&quot;</span><span class="p">]:</span>
        <span class="n">ds_season</span> <span class="o">=</span> <span class="n">select_timeseries</span><span class="p">(</span>
            <span class="n">ds</span><span class="p">,</span> <span class="n">timeseries</span><span class="o">=</span><span class="n">season</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">year_start</span><span class="o">=</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="o">=</span><span class="n">year_stop</span>
        <span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">95</span><span class="p">]:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;p</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">get_p</span><span class="p">(</span><span class="n">ds_season</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>


    <span class="n">ds</span><span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">})</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">compat</span><span class="o">=</span><span class="s2">&quot;override&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">orog_regrid</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span>
    <span class="n">area</span><span class="p">,</span>
    <span class="n">request_grid_out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># Select a subdomain</span>
    <span class="n">regionalise_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
        <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">}</span>
    <span class="c1"># Original bounds for conservative interpolation</span>
    <span class="k">if</span> <span class="n">regrid_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;method&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;conservative&quot;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">add_bounds</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">request_grid_out</span><span class="p">:</span>  
        <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span>
                <span class="n">ds</span><span class="o">.</span><span class="n">merge</span><span class="p">({</span><span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">da</span> <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">bounds</span><span class="p">}),</span>
                <span class="n">grid_out</span><span class="o">=</span><span class="n">get_grid_out</span><span class="p">(</span><span class="n">request_grid_out</span><span class="p">,</span> <span class="n">regrid_kwargs</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]),</span>
                <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">regionalise_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="downloading-and-processing">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2"></span><h3>2. Downloading and processing<a class="headerlink" href="#downloading-and-processing" title="Link to this heading">#</a></h3>
<section id="download-and-transform-the-regridding-model">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-1"></span><h4>2.1. Download and transform the regridding model<a class="headerlink" href="#download-and-transform-the-regridding-model" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> package is employed to download daily data from the selected EURO-CORDEX regridding model, select the subregion of interest, and calculate the 5th, 50th, and 95th percentiles for summer and winter over the period 1986‚Äì2005, caching the results to avoid redundant downloads and processing.</p>
<p>The regridding model here refers to the model whose grid is used as the target grid for remapping the other models, as well as CERRA5 and E-OBS. This ensures all datasets share a common grid, facilitating direct comparison at each grid cell. Within this notebook, the regridding model is set to <code class="docutils literal notranslate"><span class="pre">&quot;ichec_ec_earth_smhi_rca4&quot;</span></code> but it can be changed by modifying the <code class="docutils literal notranslate"><span class="pre">gcm_driven_model_regrid</span></code> and <code class="docutils literal notranslate"><span class="pre">rcm_model_regrid</span></code> parameters in Section 1.2. Note that both models must be included in the matrix of RCM-GCM combinations defined by the <code class="docutils literal notranslate"><span class="pre">models_cordex</span></code> dictionary in Section 1.3. It is important to highlight that the choice of the target grid can impact the analysis depending on the specific application.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;transform_chunks&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span> <span class="n">compute_percentiles</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span><span class="p">,</span>
    <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">ds_regrid</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_grid_out</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-cerra">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-2"></span><h4>2.2. Download and transform CERRA<a class="headerlink" href="#download-and-transform-cerra" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> package is used to download sub-daily data from CERRA, resample it to daily frequency, regrid to the target grid, select the subregion of interest, and compute the 5th, 50th, and 95th percentiles for summer and winter over the period 1986‚Äì2005. The results are cached to avoid redundant downloads and processing. Elevation data is also retrieved and regridded to the target grid (defined by the model_regrid parameter), as it is required to perform the lapse-rate correction.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span><span class="p">,</span>
    <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">transform_func_kwargs_orog</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;request_grid_out&quot;</span><span class="p">:</span> <span class="n">request_orography_grid_out</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">ds_cerra</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_cerra</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_percentiles</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span>
    <span class="o">|</span> <span class="p">{</span>
        <span class="s2">&quot;resample_reduction&quot;</span><span class="p">:</span> <span class="n">resample_reduction</span><span class="p">,</span>
        <span class="s2">&quot;request_grid_out&quot;</span><span class="p">:</span> <span class="n">request_grid_out</span><span class="p">,</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
        <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">ds_orog_cerra</span><span class="o">=</span><span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_orography_cerra</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">orog_regrid</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs_orog</span><span class="o">|</span>
        <span class="p">{</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
            <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>                         
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-e-obs">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-3"></span><h4>2.3. Download and transform E-OBS<a class="headerlink" href="#download-and-transform-e-obs" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> package is used to download daily data from E-OBS, regrid to the target grid, select the subregion of interest, and compute the 5th, 50th, and 95th percentiles for summer and winter over the period 1986‚Äì2005. The results are cached to avoid redundant downloads and processing. Elevation data is also retrieved and regridded to the target grid (defined by the model_regrid parameter), as it is required to perform the lapse-rate correction.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_eobs</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_eobs</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_percentiles</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span>
    <span class="o">|</span> <span class="p">{</span>
        <span class="s2">&quot;resample_reduction&quot;</span><span class="p">:</span> <span class="n">resample_reduction</span><span class="p">,</span>
        <span class="s2">&quot;request_grid_out&quot;</span><span class="p">:</span> <span class="n">request_grid_out</span><span class="p">,</span>
        <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
        <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">ds_orog_eobs</span><span class="o">=</span><span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_orography_eobs</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">orog_regrid</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs_orog</span><span class="o">|</span>
        <span class="p">{</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
            <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">}</span>
<span class="p">)</span>                       
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-models">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-4"></span><h4>2.4. Download and transform models<a class="headerlink" href="#download-and-transform-models" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code> package is used to download daily data from the selected EURO-CORDEX models, regrid to the target grid, select the subregion of interest, and compute the 5th, 50th, and 95th percentiles for summer and winter over the period 1986‚Äì2005. The results are cached to avoid redundant downloads and processing. Elevation data is also retrieved and regridded to the target grid (defined by the model_regrid parameter), as it is required to perform the lapse-rate correction.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">datasets_orog</span><span class="o">=</span><span class="p">[]</span>

<span class="n">model_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;transform_chunks&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span><span class="n">compute_percentiles</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">model_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="o">*</span><span class="n">requests</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="o">|</span> 
            <span class="p">{</span>
                <span class="s2">&quot;request_grid_out&quot;</span><span class="p">:</span> <span class="n">request_grid_out</span><span class="p">,</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
                <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">ds_orog</span><span class="o">=</span><span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="o">*</span><span class="n">model_requests_orography</span><span class="p">[</span><span class="n">model</span><span class="p">],</span>
        <span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">orog_regrid</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs_orog</span><span class="o">|</span>
            <span class="p">{</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
                <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>                          

    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">]))</span>
    <span class="n">datasets_orog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_orog</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">]))</span>

<span class="n">ds_models</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">,</span> <span class="n">compat</span><span class="o">=</span><span class="s1">&#39;override&#39;</span><span class="p">)</span>
<span class="n">ds_orog_models</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_orog</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">,</span> <span class="n">compat</span><span class="o">=</span><span class="s1">&#39;override&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model=&#39;cccma_canesm2_gerics_remo2015&#39;
model=&#39;cnrm_cerfacs_cm5_clmcom_eth_cosmo_crclim&#39;
model=&#39;cnrm_cerfacs_cm5_cnrm_aladin63&#39;
model=&#39;cnrm_cerfacs_cm5_dmi_hirham5&#39;
model=&#39;cnrm_cerfacs_cm5_gerics_remo2015&#39;
model=&#39;cnrm_cerfacs_cm5_knmi_racmo22e&#39;
model=&#39;cnrm_cerfacs_cm5_mohc_hadrem3_ga7_05&#39;
model=&#39;ichec_ec_earth_clmcom_eth_cosmo_crclim&#39;
model=&#39;ichec_ec_earth_dmi_hirham5&#39;
model=&#39;ichec_ec_earth_knmi_racmo22e&#39;
model=&#39;ichec_ec_earth_smhi_rca4&#39;
model=&#39;ipsl_cm5a_mr_dmi_hirham5&#39;
model=&#39;ipsl_cm5a_mr_gerics_remo2015&#39;
model=&#39;ipsl_cm5a_mr_knmi_racmo22e&#39;
model=&#39;ipsl_cm5a_mr_smhi_rca4&#39;
model=&#39;miroc_miroc5_clmcom_clm_cclm4_8_17&#39;
model=&#39;miroc_miroc5_gerics_remo2015&#39;
model=&#39;mohc_hadgem2_es_clmcom_clm_cclm4_8_17&#39;
model=&#39;mohc_hadgem2_es_cnrm_aladin63&#39;
model=&#39;mohc_hadgem2_es_dmi_hirham5&#39;
model=&#39;mohc_hadgem2_es_gerics_remo2015&#39;
model=&#39;mohc_hadgem2_es_knmi_racmo22e&#39;
model=&#39;mohc_hadgem2_es_mohc_hadrem3_ga7_05&#39;
model=&#39;mohc_hadgem2_es_smhi_rca4&#39;
model=&#39;mpi_m_mpi_esm_lr_clmcom_clm_cclm4_8_17&#39;
model=&#39;mpi_m_mpi_esm_lr_clmcom_eth_cosmo_crclim&#39;
model=&#39;mpi_m_mpi_esm_lr_cnrm_aladin63&#39;
model=&#39;mpi_m_mpi_esm_lr_dmi_hirham5&#39;
model=&#39;mpi_m_mpi_esm_lr_knmi_racmo22e&#39;
model=&#39;mpi_m_mpi_esm_lr_mohc_hadrem3_ga7_05&#39;
model=&#39;mpi_m_mpi_esm_lr_mpi_csc_remo2009&#39;
model=&#39;mpi_m_mpi_esm_lr_smhi_rca4&#39;
model=&#39;mpi_m_mpi_esm_lr_uhoh_wrf361h&#39;
model=&#39;ncc_noresm1_m_cnrm_aladin63&#39;
model=&#39;ncc_noresm1_m_dmi_hirham5&#39;
model=&#39;ncc_noresm1_m_gerics_remo2015&#39;
model=&#39;ncc_noresm1_m_knmi_racmo22e&#39;
model=&#39;ncc_noresm1_m_mohc_hadrem3_ga7_05&#39;
model=&#39;ncc_noresm1_m_smhi_rca4&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-land-sea-mask">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-2-5"></span><h4>2.5. Apply land-sea mask<a class="headerlink" href="#apply-land-sea-mask" title="Link to this heading">#</a></h4>
<p>This section applies a land‚Äìsea mask to all models, as well as to CERRA and E-OBS, to ensure consistency in the land-only analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsm</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request_lsm</span><span class="p">)[</span><span class="s2">&quot;lsm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Cutout</span>
<span class="n">regionalise_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
    <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<span class="p">}</span>
<span class="n">lsm</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">lsm</span><span class="p">,</span> <span class="o">**</span><span class="n">regionalise_kwargs</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ds_models&quot;</span><span class="p">:</span> <span class="n">ds_models</span><span class="p">,</span><span class="s2">&quot;ds_cerra&quot;</span><span class="p">:</span><span class="n">ds_cerra</span><span class="p">,</span><span class="s2">&quot;ds_eobs&quot;</span><span class="p">:</span><span class="n">ds_eobs</span><span class="p">,</span> 
    <span class="s2">&quot;ds_orog_models&quot;</span><span class="p">:</span> <span class="n">ds_orog_models</span><span class="p">,</span><span class="s2">&quot;ds_orog_cerra&quot;</span><span class="p">:</span> <span class="n">ds_orog_cerra</span><span class="p">,</span>
    <span class="s2">&quot;ds_orog_eobs&quot;</span><span class="p">:</span> <span class="n">ds_orog_eobs</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">lsm</span><span class="p">,</span> <span class="n">ds_orog_models</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_regrid</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">ds_models</span><span class="p">,</span> <span class="n">ds_cerra</span><span class="p">,</span> <span class="n">ds_eobs</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_models&quot;</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_cerra&quot;</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_eobs&quot;</span><span class="p">]</span>
<span class="n">ds_orog_models</span><span class="p">,</span> <span class="n">ds_orog_cerra</span><span class="p">,</span> <span class="n">ds_orog_eobs</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_orog_models&quot;</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_orog_cerra&quot;</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;ds_orog_eobs&quot;</span><span class="p">]</span>

<span class="c1"># Rename elevation variable in ds_orog_eobs</span>
<span class="n">ds_orog_eobs</span> <span class="o">=</span> <span class="n">ds_orog_eobs</span><span class="p">[[</span><span class="s2">&quot;elevation&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;elevation&quot;</span><span class="p">:</span> <span class="s2">&quot;orog&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:00&lt;00:00, 20.27it/s]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3"></span><h3>3. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<p>This section will display the following results:</p>
<ul class="simple">
<li><p><strong>Elevation profiles of biases relative to E-OBS</strong>: Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles.</p></li>
<li><p><strong>Elevation profiles of biases after applying lapse-rate correction</strong>: As above, this includes each EURO-CORDEX model, the ensemble median, the spread, and CERRA, for both seasons and selected percentiles, but with all datasets corrected to CERRA‚Äôs elevation (regridded to 0.11¬∞) using a uniform lapse rate.</p></li>
<li><p><strong>Elevation profiles of the impact of lapse-rate correction</strong>: This shows the difference between the corrected and uncorrected profiles for E-OBS, individual EURO-CORDEX models, the ensemble median, and the spread.</p></li>
</ul>
<section id="define-plotting-functions">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-1"></span><h4>3.1. Define plotting functions<a class="headerlink" href="#define-plotting-functions" title="Link to this heading">#</a></h4>
<p>The functions <strong><code class="docutils literal notranslate"><span class="pre">compute_elevation_profile</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">plot_differences_vs_eobs</span></code></strong>, <strong><code class="docutils literal notranslate"><span class="pre">plot_lapse_rate_impact</span></code></strong> and <strong><code class="docutils literal notranslate"><span class="pre">apply_lapse_rate_correction</span></code></strong> are used to generate and visualise the elevation-dependent biases of temperature. Specifically:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">compute_elevation_profile</span></code></strong> calculates the vertical (elevation-based) profiles of the 5th, 50th, and 95th percentiles for each dataset (EURO-CORDEX models, CERRA, and E-OBS), separately for winter (DJF) and summer (JJA).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">apply_lapse_rate_correction</span></code></strong> adjusts temperatures to account for differences in elevation by applying a uniform lapse rate (‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π), bringing the regridded models and E-OBS to the same elevation as CERRA (regridded to 0.11¬∞).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plot_differences_vs_eobs</span></code></strong> plots the differences (biases) between the elevation profiles of the EURO-CORDEX models and CERRA, relative to that of E-OBS, for each percentile and season.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plot_lapse_rate_impact</span></code></strong> highlights the change introduced by the lapse-rate correction, showing the difference between corrected and uncorrected profiles for each dataset.</p></li>
</ul>
<p>In the plots, the ensemble median is represented by a solid black line, while individual EURO-CORDEX models appear as grey dashed lines. The model spread, calculated as the standard deviation across models, is shown as a grey shaded area. CERRA is depicted in orange. Finally, E-OBS is shown in blue, but only in the plots that assess the impact of the lapse-rate correction.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_elevation_profile</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ds_orog</span><span class="p">,</span> <span class="n">elev_bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3050</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">kelvin_to_celsius</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">trend</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">trend</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kelvin_to_celsius</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span> <span class="o">-</span> <span class="mf">273.15</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">3.15576e17</span> 
        <span class="n">da</span><span class="o">=</span><span class="n">da</span><span class="o">*</span><span class="n">factor</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">elev</span> <span class="o">=</span> <span class="n">ds_orog</span><span class="p">[</span><span class="s2">&quot;orog&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">elev</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span>
    <span class="n">elev</span> <span class="o">=</span> <span class="n">elev</span><span class="p">[</span><span class="n">valid</span><span class="p">]</span>
    <span class="n">elev_labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">elev_bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">elev_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">,</span> <span class="s1">&#39;elev&#39;</span><span class="p">:</span> <span class="n">elev</span><span class="p">})</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;elev_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;elev&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">elev_bins</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">elev_labels</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;elev_bin&#39;</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_differences_vs_eobs</span><span class="p">(</span><span class="n">ds_models_interpolated</span><span class="p">,</span> <span class="n">ds_cerra</span><span class="p">,</span> <span class="n">ds_eobs</span><span class="p">,</span> <span class="n">corrected</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">ds_orog_models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_orog_cerra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">ds_orog_eobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ds_orog_target</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">ds_orog_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ds_orog_model</span> <span class="o">=</span> <span class="n">ds_orog_target</span>
        <span class="n">ds_orog_cerra</span> <span class="o">=</span> <span class="n">ds_orog_target</span> 
        <span class="n">ds_orog_eobs</span> <span class="o">=</span> <span class="n">ds_orog_target</span>
        
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">percentiles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;p5&quot;</span><span class="p">,</span> <span class="s2">&quot;p50&quot;</span><span class="p">,</span> <span class="s2">&quot;p95&quot;</span><span class="p">]</span>
    <span class="n">seasons</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;djf&quot;</span><span class="p">,</span> <span class="s2">&quot;jja&quot;</span><span class="p">]</span>

    <span class="n">model_names</span> <span class="o">=</span> <span class="n">ds_models_interpolated</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span>
    <span class="n">elev_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3050</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">elev_labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">elev_bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">elev_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seasons</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">percentiles</span><span class="p">):</span>
            <span class="n">varname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

            <span class="c1"># Compute E-OBS and CERRA profiles</span>
            <span class="n">profile_eobs</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span><span class="n">ds_eobs</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span> <span class="n">ds_orog_eobs</span><span class="p">,</span> <span class="n">kelvin_to_celsius</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">profile_cerra</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span><span class="n">ds_cerra</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span> <span class="n">ds_orog_cerra</span><span class="p">)</span>

            <span class="c1"># Store model differences</span>
            <span class="n">model_diffs</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
                <span class="n">da_model</span> <span class="o">=</span> <span class="n">ds_models_interpolated</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ds_orog_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ds_orog_model</span><span class="o">=</span><span class="n">ds_orog_models</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
                <span class="n">profile_model</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span><span class="n">da_model</span><span class="p">,</span> <span class="n">ds_orog_model</span><span class="p">)</span>
                <span class="n">diff_model</span> <span class="o">=</span> <span class="n">profile_model</span> <span class="o">-</span> <span class="n">profile_eobs</span>
                <span class="n">model_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_model</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">diff_model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">diff_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>

            <span class="c1"># Convert to DataFrame for ensemble stats</span>
            <span class="n">df_models</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model_diffs</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">model_names</span><span class="p">)</span>
            <span class="n">median_diff</span> <span class="o">=</span> <span class="n">df_models</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">std_diff</span> <span class="o">=</span> <span class="n">df_models</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


            <span class="c1"># Plot ensemble median</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">median_diff</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">median_diff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model ensemble median&quot;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
            <span class="c1"># Plot ensemble spread</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
                <span class="n">median_diff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                <span class="p">(</span><span class="n">median_diff</span> <span class="o">-</span> <span class="n">std_diff</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="p">(</span><span class="n">median_diff</span> <span class="o">+</span> <span class="n">std_diff</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model ¬±1œÉ&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>


            <span class="c1"># Plot CERRA </span>
            <span class="n">diff_cerra</span> <span class="o">=</span> <span class="n">profile_cerra</span> <span class="o">-</span> <span class="n">profile_eobs</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">diff_cerra</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">diff_cerra</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CERRA&quot;</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>

            <span class="c1"># Formatting</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">season</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Elevation (m)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Difference (¬∞C)&quot;</span><span class="p">)</span>
            <span class="c1"># Add gridlines</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Shared legend</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">apply_lapse_rate_correction</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_orog_native</span><span class="p">,</span> <span class="n">ds_orog_target</span><span class="p">,</span> <span class="n">lapse_rate</span><span class="o">=-</span><span class="mf">0.0065</span><span class="p">,</span> <span class="n">varnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">corrected</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">varnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">varnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>

    <span class="n">delta_z</span> <span class="o">=</span> <span class="n">ds_orog_target</span><span class="p">[</span><span class="s2">&quot;orog&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">ds_orog_native</span><span class="p">[</span><span class="s2">&quot;orog&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">varnames</span><span class="p">:</span>
        <span class="n">corrected</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">+</span> <span class="n">lapse_rate</span> <span class="o">*</span> <span class="n">delta_z</span>

    <span class="k">return</span> <span class="n">corrected</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_lapse_rate_impact</span><span class="p">(</span><span class="n">ds_models_interpolated</span><span class="p">,</span> <span class="n">ds_eobs</span><span class="p">,</span>
                                  <span class="n">ds_models_interpolated_corr</span><span class="p">,</span>
                                  <span class="n">ds_eobs_corr</span><span class="p">,</span> <span class="n">ds_orog</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="s2">&quot;p5_jja&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="n">model_names</span> <span class="o">=</span> <span class="n">ds_models_interpolated</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># --- Compute difference: corrected - original ---</span>
    <span class="c1"># E-OBS</span>
    <span class="n">profile_eobs_before</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span><span class="n">ds_eobs</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span> <span class="n">ds_orog</span><span class="p">,</span> <span class="n">kelvin_to_celsius</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">profile_eobs_after</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span><span class="n">ds_eobs_corr</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span> <span class="n">ds_orog</span><span class="p">,</span> <span class="n">kelvin_to_celsius</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">diff_eobs</span> <span class="o">=</span> <span class="n">profile_eobs_after</span> <span class="o">-</span> <span class="n">profile_eobs_before</span>

    <span class="c1"># Models</span>
    <span class="n">model_diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
        <span class="n">profile_model_before</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span>
            <span class="n">ds_models_interpolated</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span> <span class="n">ds_orog</span>
        <span class="p">)</span>
        <span class="n">profile_model_after</span> <span class="o">=</span> <span class="n">compute_elevation_profile</span><span class="p">(</span>
            <span class="n">ds_models_interpolated_corr</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span> <span class="n">ds_orog</span>
        <span class="p">)</span>
        <span class="n">diff_model</span> <span class="o">=</span> <span class="n">profile_model_after</span> <span class="o">-</span> <span class="n">profile_model_before</span>
        <span class="n">model_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_model</span><span class="p">)</span>

        <span class="c1"># Plot individual model differences</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">diff_model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">diff_model</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

    <span class="c1"># Ensemble statistics</span>
    <span class="n">df_models</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model_diffs</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">model_names</span><span class="p">)</span>
    <span class="n">median_diff</span> <span class="o">=</span> <span class="n">df_models</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">std_diff</span> <span class="o">=</span> <span class="n">df_models</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Plot ensemble median + spread</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">median_diff</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">median_diff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model ensemble median&quot;</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
        <span class="n">median_diff</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="p">(</span><span class="n">median_diff</span> <span class="o">-</span> <span class="n">std_diff</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="p">(</span><span class="n">median_diff</span> <span class="o">+</span> <span class="n">std_diff</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model ¬±1œÉ&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Plot E-OBS</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">diff_eobs</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">diff_eobs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E-OBS&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Formatting</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Elevation (m)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;ŒîT (¬∞C, lapse rate corrected ‚àí uncorrected)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Impact of lapse-rate correction on temperature profiles&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="elevation-profiles-of-biases-relative-to-e-obs">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-2"></span><h4>3.2.Elevation profiles of biases relative to E-OBS<a class="headerlink" href="#elevation-profiles-of-biases-relative-to-e-obs" title="Link to this heading">#</a></h4>
<p>Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles.</p>
<p>Note that no lapse-rate correction is applied in this case, and data are grouped by the elevation of each model or reference dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_differences_vs_eobs</span><span class="p">(</span><span class="n">ds_models</span><span class="p">,</span> <span class="n">ds_cerra</span><span class="p">,</span> <span class="n">ds_eobs</span><span class="p">,</span>
                         <span class="n">ds_orog_models</span><span class="o">=</span><span class="n">ds_orog_models</span><span class="p">,</span>
                         <span class="n">ds_orog_cerra</span><span class="o">=</span><span class="n">ds_orog_cerra</span><span class="p">,</span>
                         <span class="n">ds_orog_eobs</span><span class="o">=</span><span class="n">ds_orog_eobs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/efbd6f912b7e42058eaf6901523e2410b2eb13e794b0c3ecb1949483751f7998.png" src="../../_images/efbd6f912b7e42058eaf6901523e2410b2eb13e794b0c3ecb1949483751f7998.png" />
</div>
</div>
<div>
    <div style="max-width">
    <p><strong>Fig 3.</strong> 
        Elevation profiles of biases relative to E-OBS. Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles. The ensemble median is represented by a solid black line, while individual EURO-CORDEX models appear as grey dashed lines. The model spread, calculated as the standard deviation across models, is shown as a grey shaded area. CERRA is depicted in orange. No lapse-rate correction is applied in this case, and data are grouped by the elevation of each model or reference dataset.
</div></section>
<section id="elevation-profiles-of-biases-after-applying-lapse-rate-correction">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-3"></span><h4>3.3. Elevation profiles of biases after applying lapse-rate correction<a class="headerlink" href="#elevation-profiles-of-biases-after-applying-lapse-rate-correction" title="Link to this heading">#</a></h4>
<p>Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles.</p>
<p>Note that in this case, each dataset is adjusted to a common target elevation‚Äîthe CERRA orography regridded to 0.11¬∞‚Äîusing a uniform lapse-rate correction (‚àí0.0065 ¬∞C m‚Åª¬π) before computing the differences. For example, if a grid point in a model is 200‚ÄØm lower than the corresponding point in the target CERRA, the temperature at that point is corrected by 200‚ÄØm √ó ‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π = ‚àí1.3‚ÄØ¬∞C.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">varnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;p5_djf&quot;</span><span class="p">,</span> <span class="s2">&quot;p50_djf&quot;</span><span class="p">,</span> <span class="s2">&quot;p95_djf&quot;</span><span class="p">,</span> <span class="s2">&quot;p5_jja&quot;</span><span class="p">,</span> <span class="s2">&quot;p50_jja&quot;</span><span class="p">,</span> <span class="s2">&quot;p95_jja&quot;</span><span class="p">]</span>


<span class="c1"># Applying lapse-rate correction to align model elevations with CERRA&#39;s elevation</span>
<span class="n">ds_models_corrected</span> <span class="o">=</span> <span class="n">apply_lapse_rate_correction</span><span class="p">(</span>
    <span class="n">ds_models</span><span class="p">,</span>
    <span class="n">ds_orog_native</span><span class="o">=</span><span class="n">ds_orog_models</span><span class="p">,</span>
    <span class="n">ds_orog_target</span><span class="o">=</span><span class="n">ds_orog_cerra</span><span class="p">,</span>
    <span class="n">varnames</span><span class="o">=</span><span class="n">varnames</span>
<span class="p">)</span>

<span class="c1"># Applying lapse-rate correction to align E-OBS elevation with CERRA&#39;s elevation</span>
<span class="n">ds_eobs_corrected</span> <span class="o">=</span> <span class="n">apply_lapse_rate_correction</span><span class="p">(</span>
    <span class="n">ds_eobs</span><span class="p">,</span>
    <span class="n">ds_orog_native</span><span class="o">=</span><span class="n">ds_orog_eobs</span><span class="p">,</span>
    <span class="n">ds_orog_target</span><span class="o">=</span><span class="n">ds_orog_cerra</span><span class="p">,</span>
    <span class="n">varnames</span><span class="o">=</span><span class="n">varnames</span>
<span class="p">)</span>

<span class="n">plot_differences_vs_eobs</span><span class="p">(</span><span class="n">ds_models_corrected</span><span class="p">,</span>
                         <span class="n">ds_cerra</span><span class="p">,</span>
                         <span class="n">ds_eobs_corrected</span><span class="p">,</span>
                         <span class="n">ds_orog_target</span><span class="o">=</span><span class="n">ds_orog_cerra</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/4e3605c59f76aec2bc3813e68e9ba1abb50573ea450eb57ca0a7afcc8e54ff34.png" src="../../_images/4e3605c59f76aec2bc3813e68e9ba1abb50573ea450eb57ca0a7afcc8e54ff34.png" />
</div>
</div>
<div>
    <div style="max-width">
    <p><strong>Fig 4.</strong> 
        Elevation profiles of biases after applying lapse-rate correction. Differences compared to the E-OBS vertical profile are shown for each EURO-CORDEX model individually, the ensemble median, the spread (calculated as the standard deviation), and CERRA. Profiles are plotted separately for winter (DJF) and summer (JJA), and for the 5th, 50th, and 95th percentiles. The ensemble median is represented by a solid black line, while individual EURO-CORDEX models appear as grey dashed lines. The model spread, calculated as the standard deviation across models, is shown as a grey shaded area. CERRA is depicted in orange. Each dataset is adjusted to a common target elevation‚Äîthe CERRA orography regridded to 0.11¬∞‚Äîusing a uniform lapse-rate correction (‚àí0.0065 ¬∞C m‚Åª¬π) before computing the differences. For example, if a grid point in a model is 200‚ÄØm lower than the corresponding point in the target CERRA, the temperature at that point is corrected by 200‚ÄØm √ó ‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π = ‚àí1.3‚ÄØ¬∞C.
</div></section>
<section id="elevation-profiles-of-the-impact-of-lapse-rate-correction">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-4"></span><h4>3.4. Elevation profiles of the impact of lapse-rate correction<a class="headerlink" href="#elevation-profiles-of-the-impact-of-lapse-rate-correction" title="Link to this heading">#</a></h4>
<p>This section highlights the change introduced by the lapse-rate correction. The temperature at each grid point of every model has been previously adjusted using a uniform lapse rate of ‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π to align all datasets to the same target elevation, defined by the regridded CERRA orography (0.11¬∞ resolution). For example, if a grid point in a model is 200‚ÄØm lower than the corresponding point in the target CERRA, the temperature at that point is corrected by 200‚ÄØm √ó ‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π = ‚àí1.3‚ÄØ¬∞C. The plot below shows the vertical profiles of these differences, illustrating how the lapse-rate correction affects temperatures across elevation bands. In other words, it shows the difference between assuming that all models and reference datasets share the same elevation after regridding (as sometimes assumed in the literature) and applying a correction to account for residual elevation differences.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_lapse_rate_impact</span><span class="p">(</span><span class="n">ds_models</span><span class="p">,</span><span class="n">ds_eobs</span><span class="p">,</span><span class="n">ds_models_corrected</span><span class="p">,</span>
                       <span class="n">ds_eobs_corrected</span><span class="p">,</span><span class="n">ds_orog_cerra</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/437deb70ae23366ad92c7cd13632fe85d7e6b1a7541f66bb9ef22a461f265536.png" src="../../_images/437deb70ae23366ad92c7cd13632fe85d7e6b1a7541f66bb9ef22a461f265536.png" />
</div>
</div>
<div>
    <div style="max-width">
    <p><strong>Fig 5.</strong> 
        Elevation profiles of the impact of lapse-rate correction. The plot shows differences between lapse-rate corrected and uncorrected temperature profiles for E-OBS and EURO-CORDEX models. The correction adjusts temperatures to a common target elevation (that of regridded CERRA at 0.11¬∞) using a uniform lapse rate (‚àí0.0065‚ÄØ¬∞C‚ÄØm‚Åª¬π), ensuring consistent comparison across datasets. Negative values indicate that regridded model or E-OBS elevations are lower than CERRA. E-OBS is shown as a solid blue line, the ensemble median as a solid black line, individual models as grey dashed lines and the inter-model spread (standard deviation) as a grey shaded area. CERRA is not displayed since it defines the elevation target.
</div></section>
<section id="results-summary">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-5"></span><h4>3.5. Results summary<a class="headerlink" href="#results-summary" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Regional Climate Models (RCMs) show biases relative to both reference datasets (E-OBS and CERRA).</p></li>
<li><p>Systematic cold biases are observed in RCMs above 1000‚Äì1500‚ÄØm during winter across the 5th, 50th, and 95th percentiles when evaluated against E-OBS, consistent with findings from <a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">[3]</a>.</p></li>
<li><p>CORDEX biases relative to CERRA are smaller in magnitude and do not increase systematically with altitude, unlike the case with E-OBS.</p></li>
<li><p>Biases relative to E-OBS generally increase with elevation (becoming more negative), particularly for the 5th percentile in winter, where the ensemble median reaches its largest negative value.</p></li>
<li><p>Even in summer, models exhibit negative biases at higher elevations relative to E-OBS, notably for the 50th and 95th percentiles.</p></li>
<li><p>The greatest inter-model spread occurs for the 5th percentile in winter.</p></li>
<li><p>CERRA shows large cold differences relative to E-OBS; for the 50th and 95th percentiles in winter, it is colder than the CORDEX ensemble median above 2000‚Äì2500‚ÄØm.</p></li>
<li><p>Applying a lapse-rate correction to ensure all datasets are compared at the same elevation does not substantially alter the shape of the vertical bias profiles.</p></li>
<li><p>The lapse-rate correction introduces small (generally &lt;1 ¬∞C) negative differences that increase with elevation, reflecting that regridded model and E-OBS elevations are typically lower than those of regridded CERRA.</p></li>
</ul>
</section>
<section id="implications-for-the-users">
<span id="climate-projections-cordex-domains-single-levels-validation-q06-climate-projections-cordex-domains-single-levels-validation-q06-section-3-6"></span><h4>3.6. Implications for the users<a class="headerlink" href="#implications-for-the-users" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Elevation-dependent biases in RCM outputs are systematic and significant above 1000‚Äì1500‚ÄØm, particularly in winter, when evaluated against E-OBS, and affect all percentiles. Users working with climate data in mountainous regions should be aware that cold biases tend to intensify with elevation, especially for cold extremes (5th percentile), potentially influencing impact assessments and adaptation planning.</p></li>
<li><p>Bias magnitude and inter-model spread vary by season and percentile, with the greatest variability observed in winter cold tails (5th percentile). This highlights substantial uncertainty for extreme cold conditions at high elevations, which should be explicitly considered in risk and vulnerability evaluations.</p></li>
<li><p>CERRA exhibits strong cold differences when compared to E-OBS. This has two key implications: (1) caution is needed when using CERRA as a reference or input dataset for mountain climate analyses, and (2) despite its high resolution, the underlying model may not adequately represent complex high-altitude dynamics and processes.</p></li>
<li><p>A critical caveat lies in the inherent uncertainty and sparsity of observational data at high elevations, particularly in E-OBS. These limitations‚Äîstemming from sparse station coverage, complex topography, and measurement challenges‚Äîcan cause some of the apparent model biases to actually reflect deficiencies in the reference data.</p></li>
<li><p>Interpolation accuracy generally declines with reduced station density, performs worse for spatially variable parameters (e.g. precipitation), and deteriorates further in areas of complex terrain such as mountainous regions <a class="reference external" href="https://doi.org/10.1029/2009JD011799" rel="noreferrer" target="_blank">[8]</a>. Moreover, in some cases, E-OBS tends to report warmer values than national station datasets across the 5th, 50th, and 95th percentiles <a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">[3]</a>, and has been shown to overestimate temperatures in the distribution tails, even over moderately complex orography <a class="reference external" href="https://doi.org/10.1029/2010JD014123" rel="noreferrer" target="_blank">[9]</a>.</p></li>
<li><p>Lapse-rate correction may slightly reduce biases by adjusting for elevation differences between datasets but does not fundamentally change the shape of vertical bias profiles. While useful for harmonising datasets, it is not a solution to the underlying model or observational issues driving the biases.</p></li>
<li><p>Where feasible, users may benefit from complementing gridded analyses with station-based evaluations corrected for elevation. While the CDS does not currently provide access to raw station-level data, external sources may be used.</p></li>
<li><p>Altogether, the combination of systematic model biases, observational uncertainties, and limited high-elevation data availability underscores the need for caution when interpreting temperature extremes and climate signals in mountainous regions.</p></li>
<li><p>Bias-adjustment methods do not ensure that corrected future projections will more accurately reflect reality, as the underlying biases may change under evolving climate conditions <a class="reference external" href="https://doi.org/10.5194/hess-25-273-2021" rel="noreferrer" target="_blank">[10]</a>.</p></li>
</ul>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<ul class="simple">
<li><p>Regional climate models - CORDEX: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cordex-domains-single-levels?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/projections-cordex-domains-single-levels?tab=overview</a></p></li>
<li><p>Gridded observation dataset for Europe, E-OBS: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/insitu-gridded-observations-europe?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/insitu-gridded-observations-europe?tab=overview</a></p></li>
<li><p>CERRA sub-daily regional reanalysis data for Europe on single levels from 1984 to present: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-cerra-single-levels?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/reanalysis-cerra-single-levels?tab=overview</a></p></li>
<li><p>High-resolution global climate models: <a class="reference external" href="https://highresmip.org/" rel="noreferrer" target="_blank">https://highresmip.org/</a></p></li>
<li><p>Mountain tourism meteorological and snow indicators for Europe from 1950 to 2100 derived from reanalysis and climate projections: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/sis-tourism-snow-indicators?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/sis-tourism-snow-indicators?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1038/s41586-019-1822-y" rel="noreferrer" target="_blank">[1]</a> Immerzeel, W.W., Lutz, A.F., Andrade, M. et al., 2020. Importance and vulnerability of the world‚Äôs water towers. Nature 577, 364‚Äì369. <a class="reference external" href="https://doi.org/10.1038/s41586-019-1822-y" rel="noreferrer" target="_blank">https://doi.org/10.1038/s41586-019-1822-y</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/BAMS-D-23-0082.1" rel="noreferrer" target="_blank">[2]</a> Rudisill, W., Rhoades, A., Xu, Z., and Feldman, D. R.,2024. Are Atmospheric Models Too Cold in the Mountains? The State of Science and Insights from the SAIL Field Campaign. Bull. Amer. Meteor. Soc., 105, E1237‚ÄìE1264, <a class="reference external" href="https://doi.org/10.1175/BAMS-D-23-0082.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/BAMS-D-23-0082.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">[3]</a> Matiu, M., Napoli, A., Kotlarski, S. et al., 2024. Elevation-dependent biases of raw and bias-adjusted EURO-CORDEX regional climate models in the European Alps. Clim Dyn 62, 9013‚Äì9030. <a class="reference external" href="https://doi.org/10.1007/s00382-024-07376-y" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00382-024-07376-y</a></p>
<p><a class="reference external" href="https://doi.org/10.3390/cli11070154" rel="noreferrer" target="_blank">[4]</a> Shrestha, S., Zaramella, M., Callegari, M., Greifeneder, F., Borga, M., 2023. Scale Dependence of Errors in Snow Water Equivalent Simulations Using ERA5 Reanalysis over Alpine Basins. Climate, 11, 154. <a class="reference external" href="https://doi.org/10.3390/cli11070154" rel="noreferrer" target="_blank">https://doi.org/10.3390/cli11070154</a></p>
<p><a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">[5]</a> Haslinger, K., Holawe, F., and  Bl√∂schl, G., 2019. Spatial characteristics of precipitation shortfalls in the Greater Alpine Region‚Äîa data-based analysis from observations. Theor Appl Climatol 136, 717‚Äì731. <a class="reference external" href="https://doi.org/10.1007/s00704-018-2506-5" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00704-018-2506-5</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/joc.1377" rel="noreferrer" target="_blank">[6]</a> Auer, I., B√∂hm, R., Jurkovic, A., Lipa, W., Orlik, A., Potzmann, R., Sch√∂ner, W., Ungersb√∂ck, M., Matulla, C., Briffa, K., Jones, P., Efthymiadis, D., Brunetti, M., Nanni, T., Maugeri, M., Mercalli, L., Mestre, O., Moisselin, J.-M., Begert, M., M√ºller-Westermeier, G., Kveton, V., Bochnicek, O., Stastny, P., Lapin, M., Szalai, S., Szentimrey, T., Cegnar, T., Dolinar, M., Gajic-Capka, M., Zaninovic, K., Majstorovic, Z. and Nieplova, E., 2007. HISTALP‚Äîhistorical instrumental climatological surface time series of the Greater Alpine Region. Int. J. Climatol., 27: 17-46. <a class="reference external" href="https://doi.org/10.1002/joc.1377" rel="noreferrer" target="_blank">https://doi.org/10.1002/joc.1377</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/joc.5249" rel="noreferrer" target="_blank">[7]</a> Kotlarski, S., Szab√≥, P., Herrera S., et al., 2019. Observational uncertainty and regional climate model evaluation: A pan-European perspective. Int J Climatol. 39: 3730‚Äì3749. <a class="reference external" href="https://doi.org/10.1002/joc.5249" rel="noreferrer" target="_blank">https://doi.org/10.1002/joc.5249</a></p>
<p><a class="reference external" href="https://doi.org/10.1029/2009JD011799" rel="noreferrer" target="_blank">[8]</a> Hofstra, N., Haylock, M., New, M., and Jones, P. D., 2009. Testing E-OBS European high-resolution gridded data set of daily precipitation and surface temperature, J. Geophys. Res., 114, D21101. <a class="reference external" href="https://doi.org/10.1029/2009JD011799" rel="noreferrer" target="_blank">https://doi.org/10.1029/2009JD011799</a></p>
<p><a class="reference external" href="https://doi.org/10.1029/2010JD014123" rel="noreferrer" target="_blank">[9]</a> Kysel√Ω, J., and Plavcov√°, E., 2010. A critical remark on the applicability of E-OBS European gridded temperature data set for validating control climate simulations, J. Geophys. Res., 115, D23118. <a class="reference external" href="https://doi.org/10.1029/2010JD014123" rel="noreferrer" target="_blank">https://doi.org/10.1029/2010JD014123</a></p>
<p><a class="reference external" href="https://doi.org/10.5194/hess-25-273-2021" rel="noreferrer" target="_blank">[10]</a> Schmith, T., Thejll, P., Berg, P., Boberg, F., Christensen, O. B., Christiansen, B., Christensen, J. H., Madsen, M. S., and Steger, C., 2021. Identifying robust bias adjustment methods for European extreme precipitation in a multi-model pseudo-reality setting, Hydrol. Earth Syst. Sci., 25, 273‚Äì290, <a class="reference external" href="https://doi.org/10.5194/hess-25-273-2021" rel="noreferrer" target="_blank">https://doi.org/10.5194/hess-25-273-2021</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Climate_Projections/CORDEX"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="climate_projections-cordex-domains-single-levels_validation_q05.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.2.5. </span>CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</p>
      </div>
    </a>
    <a class="right-next"
       href="../../Indicators/indicator.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Indicators</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-investigating-climate-biases-in-mountain-regions-to-inform-the-ski-and-hydrological-sectors">üåç Use case: Investigating climate biases in mountain regions to inform the ski and hydrological sectors.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1. Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">1.2. Define Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-models">1.3. Define models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-cerra-request">1.4. Define CERRA request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-e-obs-request">1.5. Define E-OBS request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-model-requests">1.6. Define model requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache">1.7. Functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-and-processing">2. Downloading and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-regridding-model">2.1. Download and transform the regridding model</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cerra">2.2. Download and transform CERRA</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-e-obs">2.3. Download and transform E-OBS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-models">2.4. Download and transform models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-land-sea-mask">2.5. Apply land-sea mask</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-plotting-functions">3.1. Define plotting functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-biases-relative-to-e-obs">3.2.Elevation profiles of biases relative to E-OBS</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-biases-after-applying-lapse-rate-correction">3.3. Elevation profiles of biases after applying lapse-rate correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#elevation-profiles-of-the-impact-of-lapse-rate-correction">3.4. Elevation profiles of the impact of lapse-rate correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results-summary">3.5. Results summary</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-the-users">3.6. Implications for the users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>