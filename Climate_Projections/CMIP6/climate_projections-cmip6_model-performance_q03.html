
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability" href="climate_projections-cmip6_validation_q10.html" />
    <link rel="prev" title="5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections" href="climate_projections-cmip6_model-performance_q02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.2. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.3. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.1. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.3.2. Intercomparison of satellite multi-year sea ice extent estimates [Satellites - Intercomparison - Climate monitoring]</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.2. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.3. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.4. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.5. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../climate.html">5. Quality assessments for Climate Projections</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="CMIP6.html">5.1. CMIP6</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FClimate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-arctic-sea-ice-thickness-in-cmip6-to-inform-product-creation">🌍 Use case: Scientific assessment of Arctic sea ice thickness in CMIP6 to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-time-series">1.4 Functions to create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-plot-error-time-series">1.5 Function to plot error time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-climatologies-for-plotting">1.6 Functions to create climatologies for plotting</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatologies">1.7 Functions to plot climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">2. Download and transform the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-time-series">2.1 Create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-climatologies">2.2 Create the climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-evaluation-metrics">3.1 Time series of evaluation metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-distribution-of-errors">3.2 Spatial distribution of errors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-in-thickness-over-time">3.3 Change in thickness over time</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="evaluation-of-the-arctic-sea-ice-thickness-in-the-cmip6-historical-experiments">
<h1><span class="section-number">5.1.9. </span>Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments<a class="headerlink" href="#evaluation-of-the-arctic-sea-ice-thickness-in-the-cmip6-historical-experiments" title="Link to this heading">#</a></h1>
<p>Production date: 2024-05-31</p>
<p>Produced by: Timothy Williams, Nansen Environmental and Remote Sensing Center (NERSC)</p>
<section id="use-case-scientific-assessment-of-arctic-sea-ice-thickness-in-cmip6-to-inform-product-creation">
<h2>🌍 Use case: Scientific assessment of Arctic sea ice thickness in CMIP6 to inform product creation<a class="headerlink" href="#use-case-scientific-assessment-of-arctic-sea-ice-thickness-in-cmip6-to-inform-product-creation" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<p><strong>- How well does the Arctic sea ice thickness in the CMIP6 historical experiments compare to sea ice thickness estimates from altimetry?</strong></p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>On average the Arctic sea ice thickness (SIT) from the CMIP6 ensemble is fairly unbiased against the altimeter-based estimates, with the exception of October. However the bias starts to become negative towards the end of the historical experiment in 2013 and 2014.</p></li>
<li><p>There are some spatial differences between the CMIP6 models and their ensemble mean. This is shown by the RMSE staying relatively constant throughout the whole evaluation period despite the low bias, indicating that the spatial biases are cancelling each other out. It is also shown by spatial maps of climatologies of the bias, which show that in the ENVISAT period the Beaufort Sea has a strong positive bias, while the Laptev, Kara and Barents Seas have more of a negative bias. In the CryoSat-2 period, the spatial distribution of the bias changes with the Beafort, Laptev, Kara and Barents Seas all have a positive bias, while the Greenland Sea, and the area extending from the north of Greenland to the north pole have a strong negative bias, making the mean bias negative.</p></li>
<li><p>We also compared maps of the climatology of the ensemble mean of the CMIP6 models during the CryoSat-2 period (2010-2020) to the climatology of the ensemble mean in the ENVISAT period (2002-2010). Spatially, the CMIP6 model mean has a fairly uniform drop in thickness when we move from the earlier satellite period to the later one, while the difference in the altimeter climatologies is more variable spatially.</p></li>
<li><p>Other authors have also looked at evaluating CMIP6 models sea ice thickness or volume. <a class="reference external" href="https://doi.org/10.5194/gmd-2024-121">West &amp; Blockley (2024)</a> compared a subset of the models (those that output heat flux diagnostics) to ice mass-balance buoys, finding that the CMIP6 models they looked at overestimated heat fluxes and thus sea ice melt and growth. A number of authors (<a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">Davy &amp; Outten, 2020</a>;  <a class="reference external" href="https://doi.org/10.3389/fmars.2023.1223772">Xu et al. , 2023</a>; <a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0491.1">Watts et al. 2021</a>) found that the CMIP6 ensemble mean was similar to the PIOMAS (Pan-Arctic Ice-Ocean Modeling and Assimilation System) reanalysis, although the spread was quite large. <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">Davy &amp; Outten (2020)</a> also included CMIP5 models in their comparison, noting that both the bias and spread have improved in CMIP6. The spatial patterns in the differences between altimeter and the CMIP6 ensemble mean that we found have also been found by others (<a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0491.1">Watts et al., 2021</a>; <a class="reference external" href="https://doi.org/10.1080/15230430.2023.2271592">Henke et al (2023)</a>). In addition, <a class="reference external" href="https://doi.org/10.1016/j.accre.2024.06.008">Kuang et al (2024)</a> calculated sea ice volume fluxes through six Arctic gateways (the most important being the Fram Strait), finding the multi-model mean also gave a reasonable representation of this flux.</p></li>
<li><p>A number of authors have also used CMIP6 sea ice thickness and volume when considering projections of sea ice. An interesting example of this is the article by <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac9d4d">Zhou et al (2022)</a>, who found that subsetting the CMIP6 models according to how two thickness-based quantities (mean April SIT and the response of the minimum sea ice area to the mean April SIT) compared to the PIOMAS values substantially reduced the spread in projected sea ice extent and when the Arctic Ocean might become ice-free (depending on the warming scenario).</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>For our ensemble we include each model in the CMIP6 historical experiment that outputs sea ice thickness, although users should note that choosing a different subset of models could give different results.
Then, for each model in our ensemble, we calculate time series of bias and RMSE for the models compared to sea ice thickness estimates from altimetry - from the ENVISAT product between 2002 and April 2010, and from the CryoSat-2 product after October 2010. We then make plots of the time series showing the median and interquartile limits of the CMIP6 ensemble. There is a separate notebook which looks at these satellite products and addresses whether temporal trends can be seen in these data themselves.</p>
<p>We also calculate monthly thickness climatologies for the ENVISAT period and the CryoSat-2 period, and plot them to compare the spatial distribution of the thickness fields and the biases.</p>
<p>Finally we calculate the difference between the climatologies for the CryoSat-2 and ENVISAT periods, to compare the change in thickness over time for the model and the satellites.</p>
<p>The “Analysis and results” section is organised as follows:</p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-1"><span class="std std-ref">1. Import libraries, set parameters and definitions of functions</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-2"><span class="std std-ref">2. Download and transform the data</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-3"><span class="std std-ref">3. Results</span></a></strong></p>
<p>        <strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-3-1"><span class="std std-ref">3.1 Time series of evaluation metrics</span></a></strong></p>
<p>        Plot time series of the error metrics.</p>
<p>        <strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-3-2"><span class="std std-ref">3.2 Spatial distribution of errors</span></a></strong></p>
<p>        Plot maps of climatologies and their biases for each winter month (October-April).</p>
<p>        <strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q03-section-3-3"><span class="std std-ref">3.3 Change in thickness over time</span></a></strong></p>
<p>        Compare the change in thickness moving from the ENVISAT period to the CryoSat-2 period for both the satellites and the CMIP6 ensemble mean.</p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="import-libraries-set-parameters-and-definitions-of-functions">
<span id="climate-projections-cmip6-model-performance-q03-section-1"></span><h3>1. Import libraries, set parameters and definitions of functions<a class="headerlink" href="#import-libraries-set-parameters-and-definitions-of-functions" title="Link to this heading">#</a></h3>
<p>This section defines some functions used in the analysis and visualisation.</p>
<section id="import-libraries">
<h4>1.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Import the required libraries, including the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmocean</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;cf_xarray&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>1.2 Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Set the time period to be analysed with <code class="docutils literal notranslate"><span class="pre">year_start</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop</span></code>.</p></li>
<li><p>Set the models to be evaluated with the list <code class="docutils literal notranslate"><span class="pre">models</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year_start</span> <span class="o">=</span> <span class="mi">2002</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="k">assert</span> <span class="n">year_start</span> <span class="o">&gt;=</span> <span class="mi">2002</span> <span class="ow">and</span> <span class="n">year_stop</span> <span class="o">&lt;=</span> <span class="mi">2014</span>

<span class="c1"># Choose CMIP6 historical models</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;access_esm1_5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_esm2_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_1_eca&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_aerchem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ipsl_cm5a2_inca&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mpi_esm1_2_hr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;norcpm1&quot;</span><span class="p">,</span>
    <span class="c1"># &quot;taiesm1&quot;, # very high values</span>
    <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests-for-cds-data">
<h4>1.3 Define requests for CDS data<a class="headerlink" href="#define-requests-for-cds-data" title="Link to this heading">#</a></h4>
<p>Define the download requests in the format needed by the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">months</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
<span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">collection_id_cmip6</span> <span class="o">=</span> <span class="s2">&quot;projections-cmip6&quot;</span>
<span class="n">request_cmip6</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_thickness&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">months</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">year_ranges</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;envisat&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span> <span class="n">year_start</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s2">&quot;cryosat_2&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="n">year_start</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">}</span>
<span class="n">collection_id_satellite</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-thickness&quot;</span>
<span class="n">request_satellite</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">months</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">projection_satellite</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-create-the-time-series">
<h4>1.4 Functions to create the time series<a class="headerlink" href="#functions-to-create-the-time-series" title="Link to this heading">#</a></h4>
<p>These functions are all applied to a single CMIP6 model. They are all applied to the downloaded data before caching.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_satellite_data</span></code> downloads the monthly satellite data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regrid</span></code> interpolates the model to the satellite grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_interpolated_data</span></code> is applied to both the model and satellite data, to take the monthly mean (the satellite data is daily, but this also forces all the models to have the same time coordinate) and interpolate to the satellite grid (only for model data). It also calculates the RMS error (only for satellite data).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compare_model_vs_satellite</span></code> compares the sea ice thickness from a single CMIP6 model with satellite estimates, calculating error metrics like bias and RMSE in thickness.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_sea_ice_thickness_diagnostics</span></code> downloads the satellite and model data and calls <code class="docutils literal notranslate"><span class="pre">compare_model_vs_satellite</span></code> to get a time series of error metrics.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_satellite_data</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
    <span class="n">year_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">year_stop</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

    <span class="n">year_ranges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;envisat&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span> <span class="n">year_start</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s2">&quot;cryosat_2&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="n">year_start</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">year_range</span> <span class="ow">in</span> <span class="n">year_ranges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">year_range</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="s2">&quot;satellite-sea-ice-thickness&quot;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">,</span>
                <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">year_range</span><span class="p">)),</span>
                <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span>
            <span class="p">},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">regrid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">):</span>
    <span class="c1"># Remove nan columns</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">dim</span> <span class="ow">or</span> <span class="s2">&quot;lon&quot;</span> <span class="ow">in</span> <span class="n">dim</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop_isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_model_vs_satellite</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_satellite</span><span class="p">):</span>
    <span class="c1"># Homogenize time</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">))</span>
    <span class="n">ds_satellite</span> <span class="o">=</span> <span class="n">ds_satellite</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>

    <span class="c1"># Get variables</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">)</span>
    <span class="n">std_name</span> <span class="o">=</span> <span class="s2">&quot;sea_ice_thickness&quot;</span>
    <span class="n">sit</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="n">std_name</span><span class="p">]</span>
    <span class="n">sit_obs</span> <span class="o">=</span> <span class="n">ds_satellite</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="n">std_name</span><span class="p">]</span>
    <span class="n">sit_obs_err</span> <span class="o">=</span> <span class="n">ds_satellite</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">std_name</span><span class="si">}</span><span class="s2"> standard_error&quot;</span><span class="p">]</span>
    <span class="n">sit_model</span> <span class="o">=</span> <span class="n">sit</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">sit_obs</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>

    <span class="c1"># Compute useful variables</span>
    <span class="n">sit_diff</span> <span class="o">=</span> <span class="n">sit_model</span> <span class="o">-</span> <span class="n">sit_obs</span>

    <span class="c1"># Compute output</span>
    <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;sithick_bias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sit_diff</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;sithick_bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_thickness_bias&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice thickness bias&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;sithick_rmse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sit_diff</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;sithick_rmse&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_thickness_rmse&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice thickness root mean square error&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;rms_sit_obs_error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sit_obs_err</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;rms_sit_obs_error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;root_mean_square_sea_ice_thickness_observation_error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Root mean square sea ice thickness observation error&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_sea_ice_thickness_diagnostics</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">):</span>
    <span class="n">ds_satellite</span> <span class="o">=</span> <span class="n">get_satellite_data</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_satellite</span><span class="p">[[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]],</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compare_model_vs_satellite</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_satellite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="function-to-plot-error-time-series">
<h4>1.5 Function to plot error time series<a class="headerlink" href="#function-to-plot-error-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_error_time_series</span></code> plots the spread of the model errors (compared to the observed sea ice concentration), and also the root mean square observation error for comparison.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_error_time_series</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">):</span>
    <span class="n">err_name</span> <span class="o">=</span> <span class="s2">&quot;rms_sit_obs_error&quot;</span>
    <span class="n">rms_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_cmip6</span><span class="p">[</span><span class="n">err_name</span><span class="p">]</span>
                 <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span> <span class="c1"># independent of model</span>
                 <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># fills summer months with NaN</span>
                <span class="p">)</span>
    <span class="n">ds_quantiles</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_cmip6</span>
                    <span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">err_name</span><span class="p">])</span>
                    <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># fills summer months with NaN</span>
                    <span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                   <span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_quantiles</span><span class="o">.</span><span class="n">data_vars</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">da</span><span class="p">),</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ds_quantiles</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="c1"># da = da.resample(time=&quot;1MS&quot;).mean()</span>
        <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;quantile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
            <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IQL&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">if</span> <span class="s2">&quot;bias&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                <span class="n">rms_error</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
                <span class="o">-</span> <span class="n">rms_error</span><span class="p">,</span>
                <span class="n">rms_error</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Obs. error&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                <span class="n">rms_error</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
                <span class="n">rms_error</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">rms_error</span><span class="p">,</span> <span class="c1"># test if model error is &lt;= obs error</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Obs. error&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span>
            <span class="p">)</span>
            <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">.15</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="c1"># mark approximate time when CryoSat-2 becomes available</span>
        <span class="n">t_cs2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">t_cs2</span><span class="p">,</span> <span class="n">t_cs2</span><span class="p">],</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;--r&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-create-climatologies-for-plotting">
<h4>1.6 Functions to create climatologies for plotting<a class="headerlink" href="#functions-to-create-climatologies-for-plotting" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">regridded_monthly_weighted_mean</span></code> gets monthly climatologies and then regrids them to the satellite grid. This is applied to the downloaded data before caching.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_map_datasets</span></code> is applied after loading the cached data to rename some variables and dimensions in order to make them easier to use and plot.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">regridded_monthly_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># get monthly climatology</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">))</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">monthly_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="c1"># get satellite grid</span>
    <span class="n">ds_sat</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="s2">&quot;satellite-sea-ice-thickness&quot;</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="s2">&quot;envisat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2_0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span>
            <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span>
        <span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="c1"># interpolate the model data onto the satellite grid</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ds_sat</span><span class="p">[[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">postprocess_map_datasets</span><span class="p">(</span><span class="n">ds_satellite</span><span class="p">,</span> <span class="n">ds_cmip6</span><span class="p">):</span>
    <span class="n">keep</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;sithick&quot;</span><span class="p">]</span>
    <span class="n">da_satellite</span> <span class="o">=</span> <span class="n">ds_satellite</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">({</span><span class="s2">&quot;sea_ice_thickness&quot;</span><span class="p">:</span> <span class="s2">&quot;sithick&quot;</span><span class="p">})[</span><span class="s2">&quot;sithick&quot;</span><span class="p">]</span>
    <span class="n">da_cmip6</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">[</span><span class="s2">&quot;sithick&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ds_cmip6</span><span class="p">[</span><span class="s2">&quot;sithick&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">da_satellite</span><span class="p">,</span> <span class="n">da_cmip6</span><span class="p">],</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>

    <span class="c1"># reorder months</span>
    <span class="n">month_inds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_abbr</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">da</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">month_inds</span><span class="p">]]</span>
    <span class="n">da</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">values</span><span class="p">[:,:,</span><span class="n">month_inds</span><span class="p">,:,:]</span>

    <span class="c1"># zoom in</span>
    <span class="n">ix0</span> <span class="o">=</span> <span class="mi">69</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">ix0</span><span class="p">,</span> <span class="n">ix0</span> <span class="o">+</span> <span class="mi">294</span><span class="p">)</span>
    <span class="n">iy0</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">ix0</span><span class="p">,</span> <span class="n">ix0</span> <span class="o">+</span> <span class="mi">312</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="p">[:,:,:,</span><span class="n">sy</span><span class="p">,</span><span class="n">sx</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">da</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-plot-climatologies">
<h4>1.7 Functions to plot climatologies<a class="headerlink" href="#functions-to-plot-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_maps</span></code> plots a general climatology.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_sithick_maps</span></code> plots thickness climatologies.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_bias_maps</span></code> plots differences between the climatologies of the satellites and the CMIP6 ensemble mean.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_change_maps</span></code> plots the difference between a climatology for the Cryosat-2 period (2010-2014) and the Envisat period (2002-2010).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">.095</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="n">pad</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.35</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.011</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">.4</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_sithick_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">satellite</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">sit</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="n">satellite</span><span class="p">)</span>
    <span class="n">sit</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;envisat&quot;</span><span class="p">:</span> <span class="s2">&quot;ENVISAT&quot;</span><span class="p">,</span> <span class="s2">&quot;cryosat_2&quot;</span><span class="p">:</span> <span class="s2">&quot;CryoSat-2&quot;</span><span class="p">}[</span><span class="n">satellite</span><span class="p">],</span> <span class="s2">&quot;CMIP6&quot;</span><span class="p">]</span>
    <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">sit</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_bias_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;cmip6&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="s2">&quot;satellite&quot;</span><span class="p">)</span>
    <span class="n">bias</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bias in s</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bias_in_</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">bias</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
        <span class="n">pad</span><span class="o">=</span><span class="mf">.125</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_change_maps</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">change</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;cryosat_2&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;envisat&quot;</span><span class="p">)</span>
    <span class="n">change</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Change in s</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;change_in_</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">change</span><span class="p">[</span><span class="s2">&quot;product&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Satellite&quot;</span><span class="p">,</span> <span class="s2">&quot;CMIP6&quot;</span><span class="p">]</span>
    <span class="n">plot_maps</span><span class="p">(</span>
        <span class="n">change</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mf">.5</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-the-data">
<span id="climate-projections-cmip6-model-performance-q03-section-2"></span><h3>2. Download and transform the data<a class="headerlink" href="#download-and-transform-the-data" title="Link to this heading">#</a></h3>
<p>We download and process the data to make the time series and climatologies.</p>
<section id="create-the-time-series">
<h4>2.1 Create the time series<a class="headerlink" href="#create-the-time-series" title="Link to this heading">#</a></h4>
<p>We loop over all the models we are considering and apply <code class="docutils literal notranslate"><span class="pre">compute_sea_ice_diagnostics</span></code> to create the time series of error metrics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id_cmip6</span><span class="p">,</span>
        <span class="n">request_cmip6</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span>  <span class="n">years</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_sea_ice_thickness_diagnostics</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;nearest_s2d&quot;</span><span class="p">,</span>
            <span class="s2">&quot;periodic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;ignore_degenerate&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">compute</span><span class="p">())</span>
<span class="n">ds_cmip6</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="create-the-climatologies">
<h4>2.2 Create the climatologies<a class="headerlink" href="#create-the-climatologies" title="Link to this heading">#</a></h4>
<p>We first save monthly climatologies for the satellite data.
Then we loop over all the models we are considering and apply <code class="docutils literal notranslate"><span class="pre">regridded_monthly_weighted_mean</span></code> to create climatologies, before taking their ensemble mean.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">datasets_satellite</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">datasets_cmip6</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">year_range</span> <span class="ow">in</span> <span class="n">year_ranges</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">satellite</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">years</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">year_range</span><span class="p">))</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">collection_id_satellite</span><span class="p">,</span>
        <span class="n">request_satellite</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;satellite&quot;</span><span class="p">:</span> <span class="n">satellite</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">years</span><span class="p">},</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">monthly_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">datasets_satellite</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="p">[</span><span class="n">satellite</span><span class="p">],</span> <span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;satellite&quot;</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="n">model_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id_cmip6</span><span class="p">,</span>
            <span class="n">request_cmip6</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">years</span><span class="p">},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
            <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">regridded_monthly_weighted_mean</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">times</span><span class="p">,</span>
                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;nearest_s2d&quot;</span><span class="p">,</span>
                <span class="s2">&quot;periodic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;ignore_degenerate&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="n">model_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">satellite</span><span class="o">=</span><span class="p">[</span><span class="n">satellite</span><span class="p">],</span> <span class="n">product</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cmip6&quot;</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="n">datasets_cmip6</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">model_datasets</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">da_maps</span> <span class="o">=</span> <span class="n">postprocess_map_datasets</span><span class="p">(</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_satellite</span><span class="p">,</span> <span class="s2">&quot;satellite&quot;</span><span class="p">),</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets_cmip6</span><span class="p">,</span> <span class="s2">&quot;satellite&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="k">del</span><span class="p">(</span><span class="n">datasets_satellite</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="results">
<span id="climate-projections-cmip6-model-performance-q03-section-3"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<section id="time-series-of-evaluation-metrics">
<span id="climate-projections-cmip6-model-performance-q03-section-3-1"></span><h4>3.1 Time series of evaluation metrics<a class="headerlink" href="#time-series-of-evaluation-metrics" title="Link to this heading">#</a></h4>
<p>Below we plot time series of the bias and RMSE in the sea ice thickness of the CMIP6 models compared to the altimetry data.
We have taken an ensemble of models (all those that output sea ice thickness), interpolated them to the altimeter grid, and calculated time series of area-weighted error metrics for each model. We have then plotted the median and the inter-quartile limits for the ensemble for each metric. Also note that the altimeter data is only available in the winter months (October - April), which is why the time series have gaps. The vertical red lines (mid-2010) divide the ENVISAT period (2002-2010) from the CryoSat-2 one (2010-2020 for the CDR, but the historical CMIP6 experiments finish in 2014).</p>
<p>The bias in the models are generally about the same level as the observation error level (<span class="math notranslate nohighlight">\(\pm\sigma_{\rm obs}\)</span>, where <span class="math notranslate nohighlight">\(\sigma_{\rm obs}\)</span> is the RMS error in the observations), and the ensemble median is close to zero for most of the time interval considered. Around 2014, however, the bias drops to about -0.25m compared to CryoSat-2.</p>
<p>Within each winter the bias is generally highest in October -  about 0.3m - 0.5m for ENVISAT and also in the 2011 winter. The intra-winter variability in the bias seems to reduce after this however.</p>
<p>It is worth remembering that ENVISAT has its own bias which has been estimated to be about -0.6m so the models are probably also underestimating the thickness by that amount in the ENVISAT period <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">(CDS SIT Quality Assessment Report)</a>. The bias in CryoSat-2 has been estimated to be about -0.11m <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">(CDS SIT Quality Assessment Report)</a> so it is a little surprising that the model bias does not become negative immediately upon the change in satellite but instead stays around zero from 2010 to 2013. However, the validation data which was used to estimate the bias was limited in space to 3 or 4 drilling sites in the Beafort Sea and some airborne electromagnetic tracks in the Beafort Sea and north of Greenland <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">(CDS SIT Quality Assessment Report)</a>, so the satellite biases may not apply to the whole Arctic.</p>
<p>The RMSE is also relatively constant over the entire period and can be about 50% above the plotted error range which is taken to be <span class="math notranslate nohighlight">\((\sigma_{\rm obs}, \sqrt{2}\sigma_{\rm obs})\)</span>. (This approximate error level comes from considering uncorrelated errors in the model and the observation time series when going through the calculation of the MSE - then the MSE is comparable to the error level if it is around <span class="math notranslate nohighlight">\(\sigma_{\rm obs}^2 + \sigma_{\rm mod}^2\)</span>, which becomes <span class="math notranslate nohighlight">\(2\sigma_{\rm obs}^2\)</span> if we assume the model and observation errors are similar.) However in some years the median is near the error range and there is decent overlap between the IQL from the models and the error range. There is not such a clear intra-winter variability in this statistic as in the bias.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_error_time_series</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a63a5a12e0768b68b6fd7a0a5b80a6afc7b4a7485a6627599c251cada705bbc1.png" src="../../_images/a63a5a12e0768b68b6fd7a0a5b80a6afc7b4a7485a6627599c251cada705bbc1.png" />
</div>
</div>
</section>
<section id="spatial-distribution-of-errors">
<span id="climate-projections-cmip6-model-performance-q03-section-3-2"></span><h4>3.2 Spatial distribution of errors<a class="headerlink" href="#spatial-distribution-of-errors" title="Link to this heading">#</a></h4>
<p>Below we plot monthly climatologies calculated from 2002 to 2010, of the thicknesses from ENVISAT and CMIP6 (the ensemble mean over all models), and the bias (model - observations) in the CMIP6 mean. The ice in the Canadian Archipelago is consistently very thick in the models for all months. In October there is a strong positive bias in the Beaufort sea, which, while present in all other months, is slightly reduced. This bias also extends spatially into the Siberian Sea for all months, although it is not as strong there. In the Eastern Arctic (the Laptev, Kara and Barents Seas), the Labrador Sea and Hudson Bay there are consistent negative biases. In the Greenland Sea the thickness is mostly negatively biased but in October there is a reasonably sized region of positive bias as well. In other months there is some positive bias there as well but the regions are smaller. Bear in mind, however, that considering such a dynamic region on a monthly time-scale may limit the conclusions that can be made about the Greenland Sea.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sithick_maps</span><span class="p">(</span><span class="n">da_maps</span><span class="p">,</span> <span class="n">projection_satellite</span><span class="p">,</span> <span class="s2">&quot;envisat&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2002-2010 climatologies&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/efcfc48c4b1f6eeeb11fb82f37918499a66cf0d175b322a5d1397e8d6e2d3d32.png" src="../../_images/efcfc48c4b1f6eeeb11fb82f37918499a66cf0d175b322a5d1397e8d6e2d3d32.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">da_maps</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;envisat&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">projection_satellite</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2002-2010 climatology&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/62cf550dc0e23428db832243754f4b14d425644c529ade6839e18d8042c71632.png" src="../../_images/62cf550dc0e23428db832243754f4b14d425644c529ade6839e18d8042c71632.png" />
</div>
</div>
<p>Below we plot monthly climatologies calculated from 2010 to 2020, of the thicknesses from CryoSat-2 and CMIP6 (the ensemble mean over all models), and the bias (model - observations) in the CMIP6 mean. The ice in the Canadian Archipelago is still very thick in the models for all months. In October, there is a region of positive bias in the Beaufort, Siberian and Laptev seas. The extent of this region decreases as the months progress. There is a region of negative bias to the north of Greenland and the Canadian Archipelago, since the thicker ice off these coasts extends to the north pole in CryoSat-2 but is quite localised at the coasts in the models.</p>
<p>The ice in the Hudson Bay has a moderate negative bias, while the bias in the northern part of the Labrador Sea grows from around zero in November to about 25-50cm in April. Further south in the Labrador Sea there is a slight negative bias.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_sithick_maps</span><span class="p">(</span><span class="n">da_maps</span><span class="p">,</span> <span class="n">projection_satellite</span><span class="p">,</span> <span class="s2">&quot;cryosat_2&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2010-2014 climatologies&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/37544aa17f4448343dd4e942e0b3cb689f49f5cdecc0b7d6c4e810e743c99c7f.png" src="../../_images/37544aa17f4448343dd4e942e0b3cb689f49f5cdecc0b7d6c4e810e743c99c7f.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bias_maps</span><span class="p">(</span><span class="n">da_maps</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">satellite</span><span class="o">=</span><span class="s2">&quot;cryosat_2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">projection_satellite</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;2010-2014 climatology&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c7afd50e9b687248ed68b4ca12333bf2d520feaa27ec98b26b2ccbb6f3d3b9e9.png" src="../../_images/c7afd50e9b687248ed68b4ca12333bf2d520feaa27ec98b26b2ccbb6f3d3b9e9.png" />
</div>
</div>
</section>
<section id="change-in-thickness-over-time">
<span id="climate-projections-cmip6-model-performance-q03-section-3-3"></span><h4>3.3 Change in thickness over time<a class="headerlink" href="#change-in-thickness-over-time" title="Link to this heading">#</a></h4>
<p>Below we compare the differences (later - earlier) in the two climatologies for the ENVISAT period (2002-2010) and the overlap between the CryoSat-2 period and the historical experiment (2010-2024). The satellite products show a general decrease, with the exception of the Beaufort Sea in October, while the CMIP6 models show a near-uniform drop between the two periods. The magnitude of the drop is higher for the satellites however.
If we follow the estimated biases for each satellite, the change in the satellite thickness should drop by about 40cm, since ENVISAT has a larger negative bias than CryoSat-2. Hence we can theoretically trust decreases in the satellite thickness more than increases. However, as mentioned earlier, the validation data which was used to estimate the satellite biases was quite limited spatially <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">(CDS SIT Quality Assessment Report)</a>.</p>
<p>The short length of the time periods makes it difficult to see trends, which is also the conclusion of the notebook about the satellite sea ice thickness data, and the advice in the <a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">CDS SIT Quality Assessment Report</a>. This is also why many authors use the PIOMAS reanalysis as a reference sea ice thickness product. <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">Davy &amp; Outten (2020)</a> found that the CMIP6 ensemble mean had a similar trend to PIOMAS, showing thinning of sea ice and calculated over longer time intervals.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_change_maps</span><span class="p">(</span><span class="n">da_maps</span><span class="p">,</span> <span class="n">projection_satellite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/82bd0b47d6bbad43d94d84b055cc833b1532b4a95498352cf06d3a87d63cae0b.png" src="../../_images/82bd0b47d6bbad43d94d84b055cc833b1532b4a95498352cf06d3a87d63cae0b.png" />
</div>
</div>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Introductory sea ice materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.epa.gov/climate-indicators/climate-change-indicators-arctic-sea-ice">Role of sea ice in the climate</a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure">Observing sea ice with satellites</a></p></li>
</ul>
<p>Introductory CMIP6 materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.wcrp-climate.org/wgcm-cmip/cmip-video">A short introduction to CMIP and CMIP6</a></p></li>
<li><p><a class="reference external" href="https://www.carbonbrief.org/cmip6-the-next-generation-of-climate-models-explained/">CMIP6: the next generation of climate models explained</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://dast.copernicus-climate.eu/documents/satellite-sea-ice-thickness/v3.0/WP2-FDDP-2022-09_C3S2-Lot3_PQAR-of-v3.0-SeaIceThickness-products_v3.2_Final.pdf">CDS Satellite Sea Ice Thickness Product Quality Assessment Report</a></p></li>
<li><p>Davy, R., and S. Outten (2020). The Arctic Surface Climate in CMIP6: Status and Developments since CMIP5. J. Climate, 33, 8047–8068, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">https://doi.org/10.1175/JCLI-D-19-0990.1</a></p></li>
<li><p>Henke, M., F. Cassalho, T. Miesse, C. M. Ferreira, J. Zhang and T. M. Ravens (2023). Assessment of Arctic sea ice and surface climate conditions in nine CMIP6 climate models. Arctic, Antarctic, and Alpine Research, 55(1), <a class="reference external" href="https://doi.org/10.1080/15230430.2023.2271592">https://doi.org/10.1080/15230430.2023.2271592</a></p></li>
<li><p>Kuang, H. Y., Sun, S. Z., Ye, Y. F., Wang, S. Y., Bi, H. B., Chen, Z. Q., &amp; Cheng, X. (2024). An assessment of the CMIP6 performance in simulating Arctic sea ice volume flux via Fram Strait. Advances in Climate Change Research, 15(4), 584-595, <a class="reference external" href="https://doi.org/10.1016/j.accre.2024.06.008">https://doi.org/10.1016/j.accre.2024.06.008</a></p></li>
<li><p>Watts, M., W. Maslowski, Y. J. Lee, J. C. Kinney, and R. Osinski (2021). A Spatial Evaluation of Arctic Sea Ice and Regional Limitations in CMIP6 Historical Simulations. J. Climate, 34, 6399–6420, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0491.1">https://doi.org/10.1175/JCLI-D-20-0491.1</a></p></li>
<li><p>West, A. E., &amp; Blockley, E. W. (2024). CMIP6 models overestimate sea ice melt, growth &amp; conduction relative to ice mass balance buoy estimates. Geoscientific Model Development Discussions, 2024, 1-33, <a class="reference external" href="https://doi.org/10.5194/gmd-2024-121">https://doi.org/10.5194/gmd-2024-121</a></p></li>
<li><p>Xu, M., &amp; Li, J. (2023). Assessment of sea ice thickness simulations in the CMIP6 models with CICE components. Frontiers in Marine Science, 10, 1223772, <a class="reference external" href="https://doi.org/10.3389/fmars.2023.1223772">https://doi.org/10.3389/fmars.2023.1223772</a></p></li>
<li><p>Zhou, X., Wang, B., &amp; Huang, F. (2022). Evaluating sea ice thickness simulation is critical for projecting a summer ice-free Arctic Ocean. Environmental Research Letters, 17(11), 114033, <a class="reference external" href="https://doi.org/10.1088/1748-9326/ac9d4d">https://doi.org/10.1088/1748-9326/ac9d4d</a></p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Climate_Projections/CMIP6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="climate_projections-cmip6_model-performance_q02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.1.8. </span>Historical accuracy of sea ice extent in the CMIP6 projections</p>
      </div>
    </a>
    <a class="right-next"
       href="climate_projections-cmip6_validation_q10.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.1.10. </span>Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-arctic-sea-ice-thickness-in-cmip6-to-inform-product-creation">🌍 Use case: Scientific assessment of Arctic sea ice thickness in CMIP6 to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-time-series">1.4 Functions to create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-plot-error-time-series">1.5 Function to plot error time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-climatologies-for-plotting">1.6 Functions to create climatologies for plotting</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-plot-climatologies">1.7 Functions to plot climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-the-data">2. Download and transform the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-time-series">2.1 Create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-climatologies">2.2 Create the climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-evaluation-metrics">3.1 Time series of evaluation metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-distribution-of-errors">3.2 Spatial distribution of errors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-in-thickness-over-time">3.3 Change in thickness over time</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>