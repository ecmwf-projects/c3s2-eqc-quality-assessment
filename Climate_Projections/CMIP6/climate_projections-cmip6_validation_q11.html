
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11';</script>
    <link rel="icon" href="../../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands" href="climate_projections-cmip6_validation_q12.html" />
    <link rel="prev" title="5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability" href="climate_projections-cmip6_validation_q10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">‚ö†Ô∏èThis is under development!‚ö†Ô∏è</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S‚ÄìPOS‚ÄìLINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01.html">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html">1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.4. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.5. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.2. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.3. Uncertainty of ice sheet surface elevation change¬†data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.4. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-mass-balance_uncertainty_q01.html">1.3.5. Gravimetric mass changes from satellite data: assessment of resolution and uncertainty of Greenland ice sheet mass changes for glaciological applications</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_resolution_q06.html">4.3. Assessing the impact of spatial scale and temporal trends on seasonal forecast quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.4. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Projections</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../climate.html">5. Quality assessments for Climate Projections</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="CMIP6.html">5.1. CMIP6</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2¬∞C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2¬∞C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q12.html">5.1.12. Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_validation_q06.html">5.2.6. CORDEX temperature biases over the Alpine region ‚Äî assessment using E-OBS and CERRA</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">‚û°Ô∏è Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_gttm_uncertainty_q01.html">8.1. Assessing global warming with the C3S Global Temperature Trend Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Applications/application_pulse_extreme-events_q01.html">8.2. Visualisation of temperature during extreme weather events with Climate Pulse</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FClimate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-potential-impacts-of-climate-change-on-precipitation-variability-over-india">üåç Use case: Assessing the potential impacts of climate change on precipitation variability over India</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1. Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">1.2. Define Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-input-models-and-output-parameters">1.3. Define input models and output parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-era5-request">1.4. Define ERA5 request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-model-requests">1.5. Define model requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache">1.6. Functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-and-processing">2. Downloading and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-era5">2.1. Download and transform ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-models">2.2. Download and transform models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-some-attributes">2.3. Change some attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-plotting-functions">3.1. Define plotting functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ensemble-maps">3.2. Plot ensemble maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-model-maps">3.3. Plot model maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-bias-maps">3.4. Plot bias maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries-of-the-coefficient-of-variation">3.5. Timeseries of the coefficient of variation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results-summary-and-discussion">3.6. Results summary and discussion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-the-users">3.7. Implications for the users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="testing-the-capability-of-cmip6-gcms-to-represent-precipitation-intra-seasonal-variability">
<h1><span class="section-number">5.1.11. </span>Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability<a class="headerlink" href="#testing-the-capability-of-cmip6-gcms-to-represent-precipitation-intra-seasonal-variability" title="Link to this heading">#</a></h1>
<p>Production date: 31-03-2025</p>
<p>Produced by: CMCC foundation - Euro-Mediterranean Center on Climate Change. Albert Martinez Boti.</p>
<p>Most research has focused on projected long-term changes in mean climate and extremes, while changes in variability have received less attention. However, understanding the evolution of precipitation variability is crucial for accurately modelling climate phenomena and quantifying the impacts of climate change, particularly on water resources and related socioeconomic factors <a class="reference external" href="https://doi.org/10.1111/gcb.12581" rel="noreferrer" target="_blank">[1]</a>, <a class="reference external" href="https://doi.org/10.1016/j.wace.2020.100277" rel="noreferrer" target="_blank">[2]</a>. This notebook evaluates the capability of a subset of 16 <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cmip6?tab=overview" rel="noreferrer" target="_blank">CMIP6</a> Global Climate Models (GCMs) to represent monsoon intra-seasonal variability over the Indian subcontinent. Specifically, it evaluates the High-Frequency Intra-Seasonal Oscillations (HFISOs) with a characteristic period of 10‚Äì20 days, generally associated with the Quasi-Biweekly Oscillation (QBWO) <a class="reference external" href="https://doi.org/10.1111/j.2153-3490.1980.tb01717.x" rel="noreferrer" target="_blank">[3]</a>, <a class="reference external" href="https://doi.org/10.1175/2007MWR1991.1" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1175/2011JCLI3916.1" rel="noreferrer" target="_blank">[5]</a>. The Low-Frequency Intra-Seasonal Oscillations (LFISOs) ‚Äî which have a characteristic period of 30‚Äì60 days <a class="reference external" href="https://doi.org/10.1175/1520-0469%281971%29028%3C0702:DOADOI%3E2.0.CO;2" rel="noreferrer" target="_blank">[6]</a>, <a class="reference external" href="https://doi.org/10.1175/1520-0469%281972%29029%3C1109:DOGSCC%3E2.0.CO;2" rel="noreferrer" target="_blank">[7]</a> and are usually linked to the well-known Madden-Julian Oscillation (MJO) mode ‚Äî are also studied.</p>
<p>Systematic errors are obtained by comparing LFISOs and HFISOs ‚Äî calculated from model daily outputs ‚Äî with those from the ERA5 reanalysis, which serves as the reference dataset. These oscillations are extracted by applying a pass-band filter (10‚Äì20 days for HFISOs and 30‚Äì60 days for LFISOs) to daily precipitation anomalies. To assess the intensity of these oscillations <a class="reference external" href="https://doi.org/10.1038/s41612-022-00253-7" rel="noreferrer" target="_blank">[8]</a> , variance and the coefficient of variation of the filtered data are calculated for the summer monsoon period (JJAS) from 1940 to 2014. This assessment presents the spatial patterns of the variance and coefficient of variation of LFISOs and HFISOs, as well as their evolution. The latter is evaluated through time series of spatially averaged variance and coefficient of variation of the filtered data using 30-year moving windows.</p>
<p>Biases and future changes in LFISOs and HFISOs are highly relevant to users, as these modes are often associated with: (1) active-break cycles (i.e., alternating ‚Äòactive‚Äô phases of heavy rainfall and quiescent phases during the peak monsoon season in July and August <a class="reference external" href="https://doi.org/10.1002/jgrd.50422" rel="noreferrer" target="_blank">[9]</a>, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">[10]</a>), (2) the activity of synoptic systems such as monsoon lows (e.g., <a class="reference external" href="https://doi.org/10.1175/JCLI-D-16-0360.1" rel="noreferrer" target="_blank">[11]</a>) and (3) late monsoon rainfall <a class="reference external" href="https://doi.org/10.1007/s00382-019-04946-3" rel="noreferrer" target="_blank">[12]</a>. This evaluation complements another <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html#" rel="noreferrer" target="_blank">assessment</a> that examined the representation of historic inter-annual precipitation variability across the Indian subcontinent.</p>
<section id="use-case-assessing-the-potential-impacts-of-climate-change-on-precipitation-variability-over-india">
<h2>üåç Use case: Assessing the potential impacts of climate change on precipitation variability over India<a class="headerlink" href="#use-case-assessing-the-potential-impacts-of-climate-change-on-precipitation-variability-over-india" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>‚ùì Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How well do CMIP6 projections represent historical intra-seasonal variability of Monsoon precipitation across the Indian subcontinent? Are there trends affecting the intra-seasonal variability of Monsoon precipitation?‚Äã</strong></p></li>
</ul>
</section>
<section id="quality-assessment-statement">
<h2>üì¢ Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>This assessment complements a previous analysis of <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html#" rel="noreferrer" target="_blank">historical inter-annual precipitation variability across the Indian subcontinent</a>.</p></li>
<li><p>Intra-seasonal and inter-annual variability assessments show similar spatial patterns, suggesting a connection between the two <a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">[10]</a></p></li>
<li><p>Variability formulation matters: the two metrics used highlight different spatial features of intra-seasonal variability.</p></li>
<li><p>Variance shows model-dependent biases linked to orography and wet regions. The Coefficient of Variation (CV) normalises for mean precipitation but can lead to artificially high values in extremely dry areas.</p></li>
<li><p>CV differences between models are smaller than those for variance. Most models underestimate CV in dry inland regions.</p></li>
<li><p>HFISOs and LFISOs variance and CV exhibit similar spatial patterns.</p></li>
<li><p>CMIP6 models poorly capture observed trends in HFISO and LFISO variability. ERA5 shows decreasing variance and increasing CV, which are not reproduced by the ensemble median.</p></li>
<li><p>Bias correction may be necessary before using CMIP6 precipitation projections in water management applications. Similarities in inter-annual and intra-seasonal variability biases suggest corrections may be required at the daily level.</p></li>
</ul>
</div>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../_images/8aac0bed-aa00-4ba0-9343-cbc722fc0ca8.png"><img alt="Mean Bias variance" src="../../_images/8aac0bed-aa00-4ba0-9343-cbc722fc0ca8.png" style="width: 900px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5.1.11.1 </span><span class="caption-text">Fig A. i. Variance of HFISOs in daily precipitation anomalies over the historical period (1940‚Äì2014). The layout includes data corresponding to: (a) ERA5, (b) the ensemble median (defined as the median of the Variance of HFISOs values for the selected subset of models, calculated for each grid cell), (c) the bias of the ensemble median, and (d) the ensemble spread (calculated as the standard deviation of the Variance of HFISOs values for the selected subset of models). Before calculating the variance, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs). Fig A.ii. Same as Fig. A.i. but for the coefficient of variation of HFISOs.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="methodology">
<h2>üìã Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>A subset of 16 models from the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cmip6?tab=overview" rel="noreferrer" target="_blank">CMIP6</a> project is used to evaluate the representation of intra-seasonal precipitation variability over the Indian subcontinent. The analysis focuses on two intra-seasonal timescales: High-Frequency Intra-Seasonal Oscillations (HFISOs) with periods of 10‚Äì20 days and Low-Frequency Intra-Seasonal Oscillations (LFISOs) with periods of 30‚Äì60 days. LFISOs and HFISOs are identified using a pass-band filter (10‚Äì20 days for HFISOs and 30‚Äì60 days for LFISOs) applied to daily precipitation anomalies, computed relative to the climatological precipitation for each day of the year. The intensity of these intra-seasonal oscillations is assessed by calculating the variance and Coefficient of Variation (CV) of the filtered data, following the approach in <a class="reference external" href="https://doi.org/10.1038/s41612-022-00253-7" rel="noreferrer" target="_blank">[8]</a>, for the summer monsoon period (JJAS) from 1940 to 2014.</p>
<p>The analyses performed within this notebook examine the spatial patterns of variance and the Coefficient of Variation for LFISOs and HFISOs, along with the associated biases for each model and the ensemble median (per grid cell). <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-complete?tab=doc" rel="noreferrer" target="_blank">ERA5</a> serves as the reference dataset. Note that although HFISOs are generally associated with the Quasi-Biweekly Oscillation (QBWO) <a class="reference external" href="https://doi.org/10.1111/j.2153-3490.1980.tb01717.x" rel="noreferrer" target="_blank">[3]</a>, <a class="reference external" href="https://doi.org/10.1175/2007MWR1991.1" rel="noreferrer" target="_blank">[4]</a>, <a class="reference external" href="https://doi.org/10.1175/2011JCLI3916.1" rel="noreferrer" target="_blank">[5]</a>, and LFISOs are typically linked to the Madden‚ÄìJulian Oscillation (MJO) <a class="reference external" href="https://doi.org/10.1175/1520-0469%281971%29028%3C0702:DOADOI%3E2.0.CO;2" rel="noreferrer" target="_blank">[6]</a>, <a class="reference external" href="https://doi.org/10.1175/1520-0469%281972%29029%3C1109:DOGSCC%3E2.0.CO;2" rel="noreferrer" target="_blank">[7]</a>, the filtering method is subject to limitations, including signal contamination and overlap. Therefore, the variability captured in each band is not exclusively attributable to the QBWO or MJO.</p>
<p>Finally, the temporal evolution of spatially averaged intra-seasonal variability is analysed using time series of variance and the coefficient of variation, computed with a 30-year moving window. This approach allows for assessing long-term changes in the intensity of HFISOs and LFISOs over the historical period from 1940 to 2014.</p>
<p>The analysis focuses on the JJAS period, traditionally regarded as the Indian Summer Monsoon season, but the methodology can be adapted for other seasonal or annual periods.</p>
<p>The analysis and results follow the next outline:</p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1"><span class="std std-ref">1. Parameters, requests and functions definition</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-1"><span class="std std-ref">1.1. Import packages</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-2"><span class="std std-ref">1.2. Define Parameters</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-3"><span class="std std-ref">1.3. Define input models and output parameters</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-4"><span class="std std-ref">1.4. Define ERA5 request</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-5"><span class="std std-ref">1.5. Define model requests</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-6"><span class="std std-ref">1.6. Functions to cache</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2"><span class="std std-ref">2. Downloading and processing</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-1"><span class="std std-ref">2.1. Download and transform ERA5</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-2"><span class="std std-ref">2.2. Download and transform models</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-3"><span class="std std-ref">2.3. Change some attributes</span></a></p></li>
</ul>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3"><span class="std std-ref">3. Plot and describe results</span></a></strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-1"><span class="std std-ref">3.1. Define plotting functions</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-2"><span class="std std-ref">3.2. Plot ensemble maps</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-3"><span class="std std-ref">3.3. Plot model maps</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-4"><span class="std std-ref">3.4. Plot bias maps</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-5"><span class="std std-ref">3.5. Timeseries of the coefficient of variation</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-6"><span class="std std-ref">3.6. Results summary and discussion</span></a></p></li>
<li><p><a class="reference internal" href="#climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-7"><span class="std std-ref">3.7. Implications for the users</span></a></p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>üìà Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="parameters-requests-and-functions-definition">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1"></span><h3>1. Parameters, requests and functions definition<a class="headerlink" href="#parameters-requests-and-functions-definition" title="Link to this heading">#</a></h3>
<section id="import-packages">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-1"></span><h4>1.1. Import packages<a class="headerlink" href="#import-packages" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xarrayMannKendall</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mann_Kendall_test</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cartopy.mpl.gridliner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gridliner</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">signal</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;hatch.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-2"></span><h4>1.2. Define Parameters<a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h4>
<p>In the ‚ÄúDefine Parameters‚Äù section, various customisable options for the notebook are specified:</p>
<ul class="simple">
<li><p>The initial and ending year used for the historical period can be specified by changing the parameters <code class="docutils literal notranslate"><span class="pre">year_start</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop</span></code> (1940-2014 is chosen).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeseries</span></code> sets the temporal period. For instance, selecting ‚ÄúJJAS‚Äù implies considering only the June, July, August, September season.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">area</span></code> allows specifying the geographical domain of interest (NWSE). A domain including the Indian sub-continent has been selected.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">area_timeseries</span></code> specifies the region of interest when displaying the timeseries. We have chosen the Indian Peninsula for this assessment. This domain should be equal or smaller than <code class="docutils literal notranslate"><span class="pre">area</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">interpolation_method</span></code> parameter allows selecting the interpolation method when regridding is performed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">chunk</span></code> selection allows the user to define if dividing into chunks when downloading the data on their local machine. Although it does not significantly affect the analysis, it is recommended to keep the default value for optimal performance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> and <code class="docutils literal notranslate"><span class="pre">collection_id</span></code> are not customisable for this assessment and are set to ‚Äòprecipitation‚Äô and ‚ÄòCMIP6‚Äô. Expert users can use this notebook as a guide to create similar analyses for other variables or model sets (such as CORDEX).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time period</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1940</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="k">assert</span> <span class="n">year_start</span> <span class="o">&gt;=</span> <span class="mi">1940</span>

<span class="c1"># Choose annual or seasonal timeseries</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="s2">&quot;JJAS&quot;</span>
<span class="k">assert</span> <span class="n">timeseries</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;annual&quot;</span><span class="p">,</span> <span class="s2">&quot;DJF&quot;</span><span class="p">,</span> <span class="s2">&quot;MAM&quot;</span><span class="p">,</span> <span class="s2">&quot;JJA&quot;</span><span class="p">,</span> <span class="s2">&quot;SON&quot;</span><span class="p">,</span> <span class="s2">&quot;JJAS&quot;</span><span class="p">)</span>

<span class="c1"># Interpolation method</span>
<span class="n">interpolation_method</span> <span class="o">=</span> <span class="s2">&quot;bilinear&quot;</span>

<span class="c1"># Area to show (NWSE)</span>
<span class="n">area</span> <span class="o">=</span> <span class="p">[</span><span class="mi">38</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">98</span><span class="p">]</span>

<span class="c1"># Area for the timeseries analysis (equal or smaller than area)</span>
<span class="n">area_timeseries</span><span class="o">=</span><span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">98</span><span class="p">]</span>

<span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span>
    <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> 
    <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> 
    <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">or</span> 
    <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Error: area_timeseries values are outside the allowed range: </span><span class="si">{</span><span class="n">area_timeseries</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">area</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="c1"># Chunks for download</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="c1"># Variable</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;precipitation&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;precipitation&quot;</span><span class="p">)</span> 

<span class="c1">#Collection id</span>
<span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;CMIP6&quot;</span>
<span class="k">assert</span> <span class="n">collection_id</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-input-models-and-output-parameters">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-3"></span><h4>1.3. Define input models and output parameters<a class="headerlink" href="#define-input-models-and-output-parameters" title="Link to this heading">#</a></h4>
<p>The following climate analyses are performed considering a subset of GCMs from CMIP6.</p>
<p>The selected CMIP6 models have available both the historical and SSP5-8.5 experiments.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">match</span> <span class="n">variable</span><span class="p">:</span>
    <span class="k">case</span> <span class="s2">&quot;precipitation&quot;</span><span class="p">:</span>
        <span class="n">resample_reduction</span> <span class="o">=</span> <span class="s2">&quot;sum&quot;</span>
        <span class="n">era5_variable</span> <span class="o">=</span> <span class="s2">&quot;total_precipitation&quot;</span> 
        <span class="n">era5_variable_short</span> <span class="o">=</span> <span class="s2">&quot;tp&quot;</span> 
        <span class="n">cmip6_variable</span> <span class="o">=</span> <span class="s2">&quot;precipitation&quot;</span>
        <span class="n">cmip6_variable_short</span><span class="o">=</span><span class="s2">&quot;pr&quot;</span>
        <span class="c1"># Ranges of the bands used to filter and get the ISOs (Intra-Seasonal Oscillations)</span>
        <span class="n">filter_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">filter_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LFISOs_30_60&quot;</span><span class="p">,</span> <span class="s2">&quot;HFISOs_10_20&quot;</span><span class="p">]</span>
        <span class="n">models_cmip6</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bcc_csm2_mr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cnrm_esm2_1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gfdl_esm4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;noresm2_mm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">variance_window</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="n">year_stop</span><span class="o">-</span><span class="n">year_start</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">mode_var_variable</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pr&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient_of_variation&quot;</span><span class="p">]</span>
        <span class="n">cbars</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cmap_divergent&quot;</span><span class="p">:</span> <span class="s2">&quot;RdBu&quot;</span><span class="p">,</span> <span class="s2">&quot;cmap_sequential&quot;</span><span class="p">:</span> <span class="s2">&quot;viridis_r&quot;</span><span class="p">}</span>
        <span class="n">mode_var_string</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">:</span> <span class="s2">&quot;Variance of LFISOs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">:</span><span class="s2">&quot;Coefficient of variation of LFISOs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">:</span><span class="s2">&quot;Variance of HFISOs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">:</span><span class="s2">&quot;Coefficient of variation of HFISOs&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-era5-request">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-4"></span><h4>1.4. Define ERA5 request<a class="headerlink" href="#define-era5-request" title="Link to this heading">#</a></h4>
<p>Within this notebook, ERA5 serves as the reference product. In this section, we set the required parameters for the cds-api data-request of ERA5.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_era</span> <span class="o">=</span> <span class="p">(</span>
    
    <span class="s2">&quot;reanalysis-era5-single-levels&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;reanalysis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_format&quot;</span><span class="p">:</span> <span class="s2">&quot;netcdf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hour</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:00&quot;</span> <span class="k">for</span> <span class="n">hour</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)],</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">era5_variable</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeseries</span> <span class="o">==</span> <span class="s2">&quot;DJF&quot;</span><span class="p">),</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">],</span>  <span class="c1"># Include D(year-1)</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
        <span class="s2">&quot;area&quot;</span><span class="p">:</span><span class="n">area</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_lsm</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">request_era</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">request_era</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">|</span> <span class="p">{</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;1940&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;land_sea_mask&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-model-requests">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-5"></span><h4>1.5. Define model requests<a class="headerlink" href="#define-model-requests" title="Link to this heading">#</a></h4>
<p>In this section we set the required parameters for the cds-api data-request.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request_cmip6</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
    <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">cmip6_variable</span><span class="p">,</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">],</span>  <span class="c1"># Include D(year-1)</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)],</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">model_requests</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">collection_id</span> <span class="o">==</span> <span class="s2">&quot;CMIP6&quot;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models_cmip6</span><span class="p">:</span>
        <span class="n">model_requests</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;projections-cmip6&quot;</span><span class="p">,</span>
            <span class="n">download</span><span class="o">.</span><span class="n">split_request</span><span class="p">(</span><span class="n">request_cmip6</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">},</span> <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">),</span>
        <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-cache">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-1-6"></span><h4>1.6. Functions to cache<a class="headerlink" href="#functions-to-cache" title="Link to this heading">#</a></h4>
<p>In this section, functions that will be executed in the caching phase are defined. Caching is the process of storing copies of files in a temporary storage location, so that they can be accessed more quickly. This process also checks if the user has already downloaded a file, avoiding redundant downloads.</p>
<p>Functions description:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_grid_out</span></code> and <code class="docutils literal notranslate"><span class="pre">add_bounds</span></code> ensure the regrid is performed properly.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">select_timeseries</span></code> function subsets the dataset based on the chosen <code class="docutils literal notranslate"><span class="pre">timeseries</span></code> parameter.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">lanczos_bandpass_filter</span></code> uses the band-pass filter Lanczos to isolate the 10‚Äì20-day (30-60 day for the LFISOs) component of the precipitation.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_rolling_variance</span></code> function calculates the rolling variance and coefficient of variation of the filtered data using a 30-year window (which are needed when displaying the time series afterwards). It also computes the variance and coefficient of variation for the entire period.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_intraseasonal_variance</span></code> function calculates daily anomalies, filters the low and high frequency intra seasonal oscillations (by calling <code class="docutils literal notranslate"><span class="pre">lanczos_bandpass_filter</span></code>) and selects the season using the <code class="docutils literal notranslate"><span class="pre">select_timeseries</span></code> function. It then computes the rolling variance (and coefficient of variation) of the filtered data over the historical period (1940‚Äì2014) by calling <code class="docutils literal notranslate"><span class="pre">compute_rolling_variance</span></code>. The window width is 30 years, with a step size of one year. The variance and coefficient of variation is also calculated for the whole historical period.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_month_info</span><span class="p">(</span><span class="n">season_abbreviation</span><span class="p">):</span>
    <span class="n">season_to_month</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;DJF&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;DEC&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span>
        <span class="s2">&quot;MAM&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;MAR&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;03&quot;</span><span class="p">,</span> <span class="s2">&quot;05&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
        <span class="s2">&quot;JJA&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;JUN&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span> <span class="s2">&quot;08&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
        <span class="s2">&quot;SON&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;SEP&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]),</span>
        <span class="s2">&quot;JJAS&quot;</span><span class="p">:(</span><span class="s2">&quot;JUN&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span> <span class="s2">&quot;09&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]),</span>    
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">season_to_month</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">season_abbreviation</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">select_timeseries</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">timeseries</span> <span class="o">==</span> <span class="s2">&quot;annual&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">)))</span>
    <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">get_month_info</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">get_month_info</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">get_month_info</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)[</span><span class="mi">4</span><span class="p">]))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">lanczos_bandpass_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numtaps</span><span class="o">=</span><span class="mi">37</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a Lanczos bandpass filter to 1D data.&quot;&quot;&quot;</span>
    <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">lowcut</span> <span class="o">/</span> <span class="n">nyquist</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">highcut</span> <span class="o">/</span> <span class="n">nyquist</span>

    <span class="c1"># Design FIR filter using `firwin`</span>
    <span class="n">fir_coeff</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

    <span class="c1"># Apply the filter using filtfilt for zero-phase distortion</span>
    <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">fir_coeff</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_rolling_variance</span><span class="p">(</span><span class="n">ds_filtered</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">window_years</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">,</span>
                             <span class="n">resample_reduction</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">):</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">group_rolling</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">da</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">days_in_window</span> <span class="k">if</span> <span class="n">freq</span> <span class="o">==</span> <span class="s2">&quot;day&quot;</span> <span class="k">else</span> <span class="n">window_years</span><span class="p">)</span>
            <span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="s2">&quot;window_dim&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">last</span><span class="p">()</span>
            <span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
            <span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        
    <span class="n">last_year</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">time_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time.year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">last_year</span>  <span class="c1"># Mask to select only the last year</span>
    
    <span class="n">days_in_window</span> <span class="o">=</span> <span class="p">(</span><span class="mi">360</span> <span class="k">if</span> <span class="n">timeseries</span> <span class="o">==</span> <span class="s2">&quot;annual&quot;</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span> <span class="o">*</span> <span class="n">window_years</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
    <span class="p">(</span><span class="n">da_pr</span><span class="p">,)</span><span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds_filtered</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">window_years</span><span class="o">==</span><span class="n">year_stop</span><span class="o">-</span><span class="n">year_start</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> 
            <span class="n">coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">var</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">da_pr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">group_rolling</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s2">&quot;window_dim&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">var</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">group_rolling</span><span class="p">(</span><span class="n">da_pr</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;window_dim&quot;</span><span class="p">)</span> 
        
        <span class="c1"># Store results with unique names</span>
        <span class="n">results</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">_variance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span>
        <span class="n">results</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">_coefficient_of_variation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeff</span>

    <span class="c1"># Merge into a Dataset</span>
    <span class="n">ds_out</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds_out</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="p">[</span><span class="n">window_years</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_bounds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">}</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">bounds</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">add_bounds</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_grid_out</span><span class="p">(</span><span class="n">request_grid_out</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
    <span class="n">ds_regrid</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="o">*</span><span class="n">request_grid_out</span><span class="p">)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conservative&quot;</span><span class="p">:</span>
        <span class="n">ds_regrid</span> <span class="o">=</span> <span class="n">add_bounds</span><span class="p">(</span><span class="n">ds_regrid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">coords</span><span class="p">):</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ds_regrid</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">coord</span><span class="p">])</span>
    <span class="n">grid_out</span> <span class="o">=</span> <span class="n">ds_regrid</span><span class="p">[</span><span class="n">coords</span><span class="p">]</span>
    <span class="n">coords_to_drop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">grid_out</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">grid_out</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">coords_to_drop</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_intraseasonal_variance</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">,</span> <span class="n">variance_window</span><span class="p">,</span>
    <span class="n">filter_pairs</span><span class="p">,</span> <span class="n">filter_names</span><span class="p">,</span> <span class="n">resample_reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">request_grid_out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span>
<span class="p">):</span>
    <span class="c1"># Apply resample reduction if specified</span>
    <span class="k">if</span> <span class="n">resample_reduction</span><span class="p">:</span>
        <span class="n">resampled</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resampled</span><span class="p">,</span> <span class="n">resample_reduction</span><span class="p">)(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                       
        
    <span class="c1">#Change units</span>
    <span class="k">if</span> <span class="n">resample_reduction</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;resample_reduction&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">*=</span><span class="mi">1000</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no_resample_reduction&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">*=</span><span class="mi">86400</span>
    
    <span class="c1">#get the anomalies</span>
    <span class="n">anomalies</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.dayofyear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">drop_coords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dayofyear&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;realization&quot;</span> <span class="ow">in</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="n">drop_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>
    <span class="n">anomalies</span> <span class="o">=</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop_coords</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="c1">#get the filtered data</span>
    <span class="n">filtered_vars</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">lanczos_bandpass_filter</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">),</span> 
        <span class="n">coords</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> 
        <span class="n">dims</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">dims</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">),</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">filter_pairs</span><span class="p">,</span> <span class="n">filter_names</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">ds_filtered</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filtered_vars</span><span class="p">)</span>

    <span class="c1"># Select the time series for both ds and ds_filtered</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">select_timeseries</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s1">&#39;360_day&#39;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                           <span class="n">timeseries</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">ds_filtered</span> <span class="o">=</span> <span class="n">select_timeseries</span><span class="p">(</span><span class="n">ds_filtered</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s1">&#39;360_day&#39;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                    <span class="n">timeseries</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>

    <span class="c1">#Compute the variance and coefficient of variation</span>
    <span class="n">datasets</span> <span class="o">=</span><span class="p">[</span>
        <span class="n">compute_rolling_variance</span><span class="p">(</span>
            <span class="n">ds_filtered</span><span class="p">,</span>
            <span class="n">ds</span><span class="p">,</span>
            <span class="n">window_years</span><span class="o">=</span><span class="n">variance</span><span class="p">,</span>
            <span class="n">timeseries</span><span class="o">=</span><span class="n">timeseries</span><span class="p">,</span>
            <span class="n">resample_reduction</span><span class="o">=</span><span class="n">resample_reduction</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">variance</span> <span class="ow">in</span> <span class="n">variance_window</span>
    <span class="p">]</span>
    
    <span class="c1"># Create the new dataset with NaN values for the calculating the variance and CV for the whole period</span>
    <span class="n">ds_whole</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
        <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">var</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data_vars</span><span class="p">},</span>
        <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="s2">&quot;variance&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;variance&quot;</span><span class="p">],</span> <span class="n">year_stop</span><span class="o">-</span><span class="n">year_start</span><span class="o">+</span><span class="mi">1</span><span class="p">)},</span>
        <span class="n">attrs</span><span class="o">=</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
    <span class="p">)</span>

    <span class="n">ds_whole</span> <span class="o">=</span> <span class="n">ds_whole</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="n">var_name</span><span class="p">:</span> <span class="n">ds_whole</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">ds_whole</span><span class="o">.</span><span class="n">time</span> <span class="o">!=</span> <span class="n">ds_whole</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">var_name</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data_vars</span>
        <span class="p">}</span>
    <span class="p">)</span>

    
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_whole</span><span class="p">],</span> <span class="s2">&quot;variance&quot;</span><span class="p">)</span>
    
    <span class="c1"># Handle grid output if requested</span>
    <span class="k">if</span> <span class="n">request_grid_out</span><span class="p">:</span>
        <span class="n">grid_out</span> <span class="o">=</span> <span class="n">get_grid_out</span><span class="p">(</span><span class="n">request_grid_out</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">regrid_kwargs</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">])</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">grid_out</span><span class="o">=</span><span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s1">&#39;proleptic_gregorian&#39;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="downloading-and-processing">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2"></span><h3>2. Downloading and processing<a class="headerlink" href="#downloading-and-processing" title="Link to this heading">#</a></h3>
<section id="download-and-transform-era5">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-1"></span><h4>2.1. Download and transform ERA5<a class="headerlink" href="#download-and-transform-era5" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the ‚Äòc3s_eqc_automatic_quality_control‚Äô package is used to download ERA5 reference dailly data, calculate daily anomalies, filter the low and high fequency intra seasonal oscillations, select the season (e.g., ‚ÄúJJAS‚Äù in this case), and compute the variance and coefficient of variation of the filtered data for the entire historical period, as well as for a 30-year rolling window. The results are then cached to prevent redundant downloads and processing.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;timeseries&quot;</span><span class="p">:</span> <span class="n">timeseries</span><span class="p">,</span>
    <span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span><span class="p">,</span>
    <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">,</span>
    <span class="s2">&quot;variance_window&quot;</span><span class="p">:</span> <span class="n">variance_window</span><span class="p">,</span>
    <span class="s2">&quot;filter_pairs&quot;</span><span class="p">:</span> <span class="n">filter_pairs</span><span class="p">,</span>
    <span class="s2">&quot;filter_names&quot;</span><span class="p">:</span><span class="n">filter_names</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">ds_era5</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request_era</span><span class="p">,</span>
    <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_intraseasonal_variance</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="o">|</span> 
        <span class="p">{</span><span class="s2">&quot;resample_reduction&quot;</span><span class="p">:</span> <span class="n">resample_reduction</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-models">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-2"></span><h4>2.2. Download and transform models<a class="headerlink" href="#download-and-transform-models" title="Link to this heading">#</a></h4>
<p>In this section, the <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> function from the ‚Äòc3s_eqc_automatic_quality_control‚Äô package is employed to download daily data from the CMIP6 models, calculate daily anomalies, filter the low and high fequency intra seasonal oscillations, select the season (‚ÄúJJAS‚Äù in this example), compute the variance and coefficient of variation of the filtered data for the entire historical period (as well as for a 30-year rolling windows), interpolate to the ERA5 grid (only when specified; otherwise, the original model grid is maintained), and cache the results to avoid redundant downloads and processing.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interpolated_datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">model_datasets</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">model_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="n">chunks</span> <span class="k">if</span> <span class="n">collection_id</span> <span class="o">==</span> <span class="s2">&quot;CMIP6&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s2">&quot;transform_chunks&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span>  <span class="n">compute_intraseasonal_variance</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">model_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Original model</span>
    <span class="n">model_datasets</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="o">*</span><span class="n">requests</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Interpolated model</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="o">*</span><span class="n">requests</span><span class="p">,</span>
        <span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span>
        <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;request_grid_out&quot;</span><span class="p">:</span> <span class="n">request_lsm</span><span class="p">,</span>
            <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="n">interpolation_method</span><span class="p">,</span>
            <span class="s2">&quot;skipna&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="n">interpolated_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">]))</span>

<span class="n">ds_interpolated</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">interpolated_datasets</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">,</span> <span class="n">compat</span><span class="o">=</span><span class="s1">&#39;override&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model=&#39;access_cm2&#39;
model=&#39;bcc_csm2_mr&#39;
model=&#39;canesm5&#39;
model=&#39;cmcc_esm2&#39;
model=&#39;cnrm_cm6_1_hr&#39;
model=&#39;cnrm_esm2_1&#39;
model=&#39;ec_earth3_cc&#39;
model=&#39;gfdl_esm4&#39;
model=&#39;inm_cm4_8&#39;
model=&#39;inm_cm5_0&#39;
model=&#39;mpi_esm1_2_lr&#39;
model=&#39;miroc6&#39;
model=&#39;miroc_es2l&#39;
model=&#39;mri_esm2_0&#39;
model=&#39;noresm2_mm&#39;
model=&#39;nesm3&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="change-some-attributes">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-2-3"></span><h4>2.3. Change some attributes<a class="headerlink" href="#change-some-attributes" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop &#39;bnds&#39; dimension if it exists for each dataset and for the interpolated dataset</span>
<span class="n">model_datasets</span> <span class="o">=</span> <span class="p">{</span><span class="n">model</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s1">&#39;bnds&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;bnds&#39;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span> <span class="k">else</span> <span class="n">ds</span> 
                  <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">model_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ds_era5</span><span class="p">,</span> <span class="n">ds_interpolated</span><span class="p">,</span> <span class="o">*</span><span class="n">model_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;(mm/day)¬≤&quot;</span><span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;(mm/day)¬≤&quot;</span><span class="p">}</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3"></span><h3>3. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<p>This section will display the following results:</p>
<ul class="simple">
<li><p>Maps showing the spatial distribution of the <strong>variance of filtered daily precipitation anomalies</strong>, calculated for the historical period 1940‚Äì2014. The results compare ERA5 and the ensemble median, defined as the median of the variance values for the selected subset of models, calculated for each grid cell. The layout includes ERA5, the ensemble median, the ensemble median bias, and the ensemble spread (derived as the standard deviation of the variance for the selected subset of models). The same layout is displayed for the coefficient of variation.</p></li>
<li><p>Maps showing the spatial distribution of the <strong>variance of filtered daily precipitation anomalies</strong>, calculated for the historical period 1940‚Äì2014 for each model. The same layout is displayed for the coefficient of variation.</p></li>
<li><p><strong>Bias maps of the variance of filtered daily precipitation anomalies</strong>, calculated for the historical period 1940‚Äì2014 for each model. The same layout is displayed for the coefficient of variation.</p></li>
<li><p><strong>Time series</strong> showing the evolution of the 30-year variance and coefficient of variation (standard deviation divided by the mean) of filtered daily precipitation anomalies over the historical period, including trends and inter-model spread.</p></li>
</ul>
<p><strong>Note</strong>: A Lanczos band-pass filter is applied to isolate the 10‚Äì20-day (HFISOs) and 30‚Äì60-day (LFISOs) components of daily precipitation anomalies. The seasonal period is JJAS.</p>
<section id="define-plotting-functions">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-1"></span><h4>3.1. Define plotting functions<a class="headerlink" href="#define-plotting-functions" title="Link to this heading">#</a></h4>
<p>The functions presented here are used to plot layouts of the variance and coefficient of variation of filtered daily precipitation anomalies over the whole historical period.</p>
<p>Three layout types can be displayed, depending on the chosen function:</p>
<ol class="arabic simple">
<li><p>Layout including the reference ERA5 product, the ensemble median, the bias of the ensemble median, and the ensemble spread: <code class="docutils literal notranslate"><span class="pre">plot_ensemble()</span></code> is used.</p></li>
<li><p>Layout including every model: <code class="docutils literal notranslate"><span class="pre">plot_models()</span></code> is employed.</p></li>
<li><p>Layout including the bias of every model: <code class="docutils literal notranslate"><span class="pre">plot_models()</span></code> is used again.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Define function to plot the caption of the figures (for the ensemble case)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_caption_ensemble</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">mode_var</span><span class="o">=</span><span class="s2">&quot;Variance&quot;</span><span class="p">):</span>

    <span class="n">caption_text</span><span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Fig </span><span class="si">{</span><span class="n">fig_number</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">mode_var</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;over the </span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> period (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">‚Äì</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;The layout includes data corresponding to: (a) ERA5, (b) the ensemble median &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(defined as the median of the </span><span class="si">{</span><span class="n">mode_var</span><span class="si">}</span><span class="s2"> values for the selected &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;subset of models, calculated for each grid cell), &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(c) the bias of the ensemble median, and (d) the ensemble spread &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(calculated as the standard deviation of the </span><span class="si">{</span><span class="n">mode_var</span><span class="si">}</span><span class="s2"> values &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for the selected subset of models). Before calculating the variance and coefficient of variation, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the &quot;</span> 
            <span class="sa">f</span><span class="s2">&quot;10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;intraseasonal oscillations (LFISOs)&quot;</span>
    <span class="p">)</span>

            
    <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">caption_text</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">105</span><span class="p">)</span>
    <span class="c1"># Add each line to the figure</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wrapped_lines</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span>  <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#end captioning</span>


<span class="c1">#Define function to plot the caption of the figures (for the individual models case)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_caption_models</span><span class="p">(</span><span class="n">bias</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span> <span class="n">mode_var</span><span class="o">=</span><span class="s2">&quot;Variance&quot;</span><span class="p">):</span>
    <span class="c1">#Add caption to the figure</span>
    <span class="k">if</span> <span class="n">bias</span><span class="p">:</span> 
        <span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Fig </span><span class="si">{</span><span class="n">fig_number</span><span class="si">}</span><span class="s2">. Bias of the </span><span class="si">{</span><span class="n">mode_var</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;over the </span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> period (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">‚Äì</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">). &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;The layout displays each &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;individual </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> model. Before calculating the variance and coefficient of variation, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the &quot;</span> 
                <span class="sa">f</span><span class="s2">&quot;10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;intraseasonal oscillations (LFISOs)&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>       
        <span class="n">caption_text</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Fig </span><span class="si">{</span><span class="n">fig_number</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">mode_var</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;over the </span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s2"> period (</span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">‚Äì</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">). &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;The layout displays each individual &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> model.Before calculating the variance and coefficient of variation, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the &quot;</span> 
                <span class="sa">f</span><span class="s2">&quot;10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;intraseasonal oscillations (LFISOs)&quot;</span>
        <span class="p">)</span>

    <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">caption_text</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">110</span><span class="p">)</span>
    <span class="c1"># Add each line to the figure</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wrapped_lines</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span>  <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">set_extent</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">area</span><span class="p">):</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">area</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extent</span><span class="p">):</span>
        <span class="n">extent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">2</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="o">+</span><span class="mi">2</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
        <span class="c1"># Grid</span>
        <span class="n">subplotspec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span>
        <span class="n">gridliners</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">artists</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Gridliner</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">gl</span> <span class="ow">in</span> <span class="n">gridliners</span><span class="p">:</span>
            <span class="n">gl</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
            <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">gl</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_first_col</span><span class="p">()</span>
            <span class="n">gl</span><span class="o">.</span><span class="n">bottom_labels</span> <span class="o">=</span> <span class="n">subplotspec</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">()</span>
        <span class="c1"># Extent</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_models</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">da_for_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
    <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span>
    <span class="n">flip_cmaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">da_for_kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">model_dataarrays</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">da_for_kwargs</span> <span class="o">=</span> <span class="n">da_for_kwargs</span> <span class="ow">or</span> <span class="n">data</span>
        <span class="n">model_dataarrays</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">))</span>

    <span class="c1"># Get kwargs</span>
    <span class="n">default_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;robust&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">default_kwargs</span> <span class="o">|</span> <span class="n">kwargs</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_determine_cmap_params</span><span class="p">(</span><span class="n">da_for_kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="o">*</span><span class="p">(</span><span class="n">col_wrap</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_dataarrays</span><span class="p">)</span> <span class="o">/</span> <span class="n">col_wrap</span><span class="p">)),</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="n">subplot_kw</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">da</span><span class="p">),</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_dataarrays</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">axs</span><span class="p">):</span>
        <span class="n">pcm</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
            <span class="n">da</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">set_extent</span><span class="p">(</span><span class="n">da_for_kwargs</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
        <span class="n">pcm</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">extend</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;extend&quot;</span><span class="p">],</span>
        <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_for_kwargs</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">da_for_kwargs</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>




<span class="k">def</span><span class="w"> </span><span class="nf">plot_ensemble</span><span class="p">(</span>
    <span class="n">da_models</span><span class="p">,</span>
    <span class="n">da_era5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
    <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span>
    <span class="n">flip_cmaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap_params_era5</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap_params_median</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap_params_bias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cmap_params_std</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

    <span class="c1"># Default behaviour</span>
    <span class="n">default_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;robust&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span> <span class="s2">&quot;both&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cbar_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cbar_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">}</span>

    <span class="c1"># Create figure and axes</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">subplot_kw</span><span class="o">=</span><span class="n">subplot_kw</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">axs_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span>

    <span class="c1"># --- ERA5 plot ---</span>
    <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">axs_iter</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">cmap_params_era5</span> <span class="ow">or</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_determine_cmap_params</span><span class="p">(</span>
            <span class="n">da_era5</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">default_kwargs</span>
        <span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
            <span class="n">da_era5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(a) ERA5&quot;</span><span class="p">)</span>

    <span class="c1"># --- Ensemble Median ---</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">axs_iter</span><span class="p">)</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">da_models</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">cmap_params_median</span> <span class="ow">or</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_determine_cmap_params</span><span class="p">(</span>
        <span class="n">da_era5</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">default_kwargs</span>
    <span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">median</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(b) Ensemble Median&quot;</span> <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;(a) Ensemble Median&quot;</span><span class="p">)</span>

    <span class="c1"># --- Ensemble Bias (Median - ERA5) ---</span>
    <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">axs_iter</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">bias</span> <span class="o">=</span> <span class="n">median</span> <span class="o">-</span> <span class="n">da_era5</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">cmap_params_bias</span> <span class="ow">or</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_determine_cmap_params</span><span class="p">(</span>
            <span class="n">bias</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">default_kwargs</span>
        <span class="p">)</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
            <span class="n">bias</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(c) Ensemble Median Bias&quot;</span><span class="p">)</span>

    <span class="c1"># --- Ensemble Standard Deviation ---</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">axs_iter</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">da_models</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">cmap_params_std</span> <span class="ow">or</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">_determine_cmap_params</span><span class="p">(</span>
        <span class="n">std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="o">**</span><span class="n">default_kwargs</span>
    <span class="p">)</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">std</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span>
        <span class="o">**</span><span class="n">params</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;(d) Ensemble Standard Deviation&quot;</span> <span class="k">if</span> <span class="n">da_era5</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;(b) Ensemble Standard Deviation&quot;</span><span class="p">)</span>

    <span class="c1"># Set extent</span>
    <span class="n">set_extent</span><span class="p">(</span><span class="n">da_models</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-ensemble-maps">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-2"></span><h4>3.2. Plot ensemble maps<a class="headerlink" href="#plot-ensemble-maps" title="Link to this heading">#</a></h4>
<p>In this section, we invoke the <code class="docutils literal notranslate"><span class="pre">plot_ensemble()</span></code> function to visualise the variance values of filtered daily precipitation anomalies over the period 1940‚Äì2014 for the following: (a) the reference ERA5 product, (b) the ensemble median (defined as the median of the variance values for the selected subset of models, calculated for each grid cell), (c) the bias of the ensemble median, and (d) the ensemble spread (calculated as the standard deviation of the variance for the selected subset of models). The same layout of maps is displayed for the coefficient of variation. As mentioned throughout this notebook, before calculating the variance and coefficient of variation, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency intraseasonal oscillations (LFISOs).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change default colorbars</span>
<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="o">**</span><span class="n">cbars</span><span class="p">)</span>

<span class="c1"># Colourbar limits</span>
<span class="n">vmax_era5</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">vmax_era5_bias</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Fig number counter</span>
<span class="n">fig_number</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Common title</span>
<span class="n">common_title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Historical period: </span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">.&quot;</span>

<span class="c1"># Colourbar kwargs for coefficient of variation</span>
<span class="n">cmap_kwargs_cv</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cmap_params_era5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5</span><span class="p">},</span>
    <span class="s2">&quot;cmap_params_median&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5</span><span class="p">},</span>
    <span class="s2">&quot;cmap_params_bias&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">vmax_era5_bias</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5_bias</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="s2">&quot;RdBu&quot;</span><span class="p">},</span>
    <span class="s2">&quot;cmap_params_std&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5</span><span class="p">},</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">var_mode</span> <span class="ow">in</span> <span class="p">(</span>
    <span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">]</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies (</span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Comparison of ERA5 and </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> Ensemble | </span><span class="si">{</span><span class="n">common_title</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds_interpolated</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="n">var_mode</span><span class="p">]</span>
    <span class="n">da_era5</span> <span class="o">=</span> <span class="n">ds_era5</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="n">var_mode</span><span class="p">]</span>

    <span class="c1"># Select colourbar kwargs based on variable type</span>
    <span class="n">cmap_kwargs</span> <span class="o">=</span> <span class="n">cmap_kwargs_cv</span> <span class="k">if</span> <span class="s2">&quot;coefficient_of_variation&quot;</span> <span class="ow">in</span> <span class="n">var_mode</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_ensemble</span><span class="p">(</span>
        <span class="n">da_models</span><span class="o">=</span><span class="n">da</span><span class="p">,</span>
        <span class="n">da_era5</span><span class="o">=</span><span class="n">da_era5</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
        <span class="o">**</span><span class="n">cmap_kwargs</span><span class="p">,</span>
    <span class="p">)</span>


    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">add_caption_ensemble</span><span class="p">(</span><span class="n">exp</span><span class="o">=</span><span class="s2">&quot;historical&quot;</span><span class="p">,</span> <span class="n">mode_var</span><span class="o">=</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">fig_number</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/4ea689bc5c2bcef83f3c84dbd6729daf1f2fd2224885f5dedd1a48166e4cc569.png" src="../../_images/4ea689bc5c2bcef83f3c84dbd6729daf1f2fd2224885f5dedd1a48166e4cc569.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/a62fd7ad2734cac1e5cc50af7b304816cc5e7729e0b25fe0bb06729dcaef1e92.png" src="../../_images/a62fd7ad2734cac1e5cc50af7b304816cc5e7729e0b25fe0bb06729dcaef1e92.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/1df883f16aeeea583927f76f6a47a132199d105ae409a4bc6b36439777deabf2.png" src="../../_images/1df883f16aeeea583927f76f6a47a132199d105ae409a4bc6b36439777deabf2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/1fef48c1d95f4e61846b13b7832e375c474c6259108bac65c0560ec2835d32a2.png" src="../../_images/1fef48c1d95f4e61846b13b7832e375c474c6259108bac65c0560ec2835d32a2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-model-maps">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-3"></span><h4>3.3. Plot model maps<a class="headerlink" href="#plot-model-maps" title="Link to this heading">#</a></h4>
<p>In this section, we invoke the <code class="docutils literal notranslate"><span class="pre">plot_models()</span></code> function to visualise the variance and the coefficient of variation of filtered daily precipitation anomalies over the period 1940‚Äì201, for every model individually. As mentioned throughout this notebook, before calculating the variance and coefficient of variation, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency intraseasonal oscillations (LFISOs). Note that the model data used in this section maintains its original grid.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_mode</span> <span class="ow">in</span> <span class="p">(</span>
    <span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span>
<span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">]</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies (</span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> individual members | </span><span class="si">{</span><span class="n">common_title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">da_for_kwargs</span> <span class="o">=</span> <span class="n">ds_era5</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_era5</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_era5</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="n">var_mode</span><span class="p">]</span>

    <span class="n">data_to_plot</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="n">var_mode</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">model_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">cmap_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5</span><span class="p">,</span> <span class="s2">&quot;extend&quot;</span><span class="p">:</span><span class="s2">&quot;max&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="s2">&quot;coefficient_of_variation&quot;</span> <span class="ow">in</span> <span class="n">var_mode</span> <span class="k">else</span> <span class="p">{}</span>
           
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_models</span><span class="p">(</span>
        <span class="n">data_to_plot</span><span class="p">,</span>
        <span class="n">da_for_kwargs</span><span class="o">=</span><span class="n">da_for_kwargs</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="o">**</span><span class="n">cmap_params</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="n">add_caption_models</span><span class="p">(</span>
        <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">exp</span><span class="o">=</span><span class="s2">&quot;historical&quot;</span><span class="p">,</span>
        <span class="n">mode_var</span><span class="o">=</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">fig_number</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/adb91441b452e18b914d4b48c1a7c0809e0f9ff6459d76cd271b9bee4d6cd6f4.png" src="../../_images/adb91441b452e18b914d4b48c1a7c0809e0f9ff6459d76cd271b9bee4d6cd6f4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/e15a6927991cba886faa039257cb84a24a120e197da8e519845d378ea02c1ad8.png" src="../../_images/e15a6927991cba886faa039257cb84a24a120e197da8e519845d378ea02c1ad8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/8ff53a66064517b02e1f3062550b3c205544b05ba31e5841baa21975f31f645e.png" src="../../_images/8ff53a66064517b02e1f3062550b3c205544b05ba31e5841baa21975f31f645e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/4cf2d5288893124b5118c2c414697ed061437975ae1d2015f92e058a0abd03d7.png" src="../../_images/4cf2d5288893124b5118c2c414697ed061437975ae1d2015f92e058a0abd03d7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-bias-maps">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-4"></span><h4>3.4. Plot bias maps<a class="headerlink" href="#plot-bias-maps" title="Link to this heading">#</a></h4>
<p>In this section, we invoke the <code class="docutils literal notranslate"><span class="pre">plot_models()</span></code> function to visualise the bias of the variance and the coefficient of variation for filtered daily precipitation anomalies over the period 1940‚Äì2014, for every model individually. As mentioned throughout this notebook, before calculating the variance and coefficient of variation, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency intraseasonal oscillations (LFISOs). Note that the model data used in this section has previously been interpolated to the ERA5 grid.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">,</span> <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bias of the </span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">]</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies (</span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2"> individual members | </span><span class="si">{</span><span class="n">common_title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">dataset</span><span class="p">,</span> <span class="n">dataset_era</span> <span class="o">=</span> <span class="n">ds_interpolated</span><span class="p">,</span> <span class="n">ds_era5</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">dataset_era</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_era</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_era</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">bias</span><span class="p">[</span><span class="n">var_mode</span><span class="p">]</span>
    <span class="n">cmap_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="o">-</span><span class="n">vmax_era5_bias</span><span class="p">,</span> <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax_era5_bias</span><span class="p">,</span> <span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <span class="s2">&quot;RdBu&quot;</span><span class="p">}</span> <span class="k">if</span> <span class="s2">&quot;coefficient_of_variation&quot;</span> <span class="ow">in</span> <span class="n">var_mode</span> <span class="k">else</span> <span class="p">{}</span>

        
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_models</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="o">**</span><span class="n">cmap_params</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">add_caption_models</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s2">&quot;historical&quot;</span><span class="p">,</span> 
                       <span class="n">mode_var</span><span class="o">=</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var_mode</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">fig_number</span><span class="o">=</span><span class="n">fig_number</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/971e631d8207ae3356a3e4c8a1493edf9c9e45cce26b21947869fb654d576cfe.png" src="../../_images/971e631d8207ae3356a3e4c8a1493edf9c9e45cce26b21947869fb654d576cfe.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/c4118d2bef11e65c60afb1b15a2c32e1de58ce264e03d12c373a340856ab2f38.png" src="../../_images/c4118d2bef11e65c60afb1b15a2c32e1de58ce264e03d12c373a340856ab2f38.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/c42b2d9577c67dcc20ad6a6d48df29d1329d72a1b85d11b0d6c289017c24003e.png" src="../../_images/c42b2d9577c67dcc20ad6a6d48df29d1329d72a1b85d11b0d6c289017c24003e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/eeb877df3dadc043a3f7e8319d0cb4ca42ceca71af21c67aaecc4a5f9a6ff1c8.png" src="../../_images/eeb877df3dadc043a3f7e8319d0cb4ca42ceca71af21c67aaecc4a5f9a6ff1c8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="timeseries-of-the-coefficient-of-variation">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-5"></span><h4>3.5. Timeseries of the coefficient of variation<a class="headerlink" href="#timeseries-of-the-coefficient-of-variation" title="Link to this heading">#</a></h4>
<p>This section examines the time series of spatially averaged variance and coefficient of variation, calculated from filtered daily precipitation anomalies over the historical period using a 30-year window. The analysis compares the CMIP6 ensemble median, ERA5, and individual models, highlighting trends for both the CMIP6 ensemble median and ERA5. It also displays the ensemble spread, along with the slope values of the trends for ERA5 and the CMIP6 ensemble median.</p>
<p>As mentioned throughout this notebook, before calculating the variance and coefficient of variation, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency intraseasonal oscillations (LFISOs).</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the colors</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;ERA5&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">}</span>

<span class="c1"># Cutout region</span>
<span class="n">regionalise_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
    <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area_timeseries</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_trend</span><span class="p">(</span><span class="n">time_series</span><span class="p">,</span> <span class="n">var_values</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="n">time_numeric</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">time_series</span><span class="o">.</span><span class="n">to_series</span><span class="p">())</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">time_numeric</span><span class="p">,</span> <span class="n">var_values</span><span class="p">)</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">time_numeric</span>
    <span class="n">slope_per_decade</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mf">365.25</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span>  <span class="c1"># nanoseconds to decade</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_series</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">slope_per_decade</span><span class="p">,</span> <span class="n">p_value</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">,</span> <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">]:</span>
    <span class="c1"># Get the spatial mean for ERA5</span>
    <span class="n">era5_mean</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds_era5</span><span class="p">,</span> <span class="o">**</span><span class="n">regionalise_kwargs</span><span class="p">))[</span><span class="n">var</span><span class="p">]</span>

    <span class="c1"># Get the spatial mean for CMIP6, preserving each model</span>
    <span class="n">cmip6_means</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">]),</span> <span class="o">**</span><span class="n">regionalise_kwargs</span><span class="p">)</span>
        <span class="p">)[</span><span class="n">var</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">model_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="c1"># Calculate the median, ensemble mean, and standard deviation</span>
    <span class="n">cmip6_mean_median</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">cmip6_means</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cmip6_mean_ens_mean</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">cmip6_means</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cmip6_mean_std</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">cmip6_means</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Initialize list to store trend information</span>
    <span class="n">trend_info</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">era5_var</span> <span class="o">=</span> <span class="n">era5_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">cmip6_var</span> <span class="o">=</span> <span class="n">cmip6_mean_median</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">cmip6_var_ens_mean</span> <span class="o">=</span> <span class="n">cmip6_mean_ens_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">cmip6_mean_std_sel</span> <span class="o">=</span> <span class="n">cmip6_mean_std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
    <span class="c1"># Plotting</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Plot individual model series for each variance</span>
    <span class="k">for</span> <span class="n">model_data</span> <span class="ow">in</span> <span class="n">cmip6_means</span><span class="p">:</span>
        <span class="n">model_var</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">variance</span><span class="o">=</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">model_var_values</span> <span class="o">=</span> <span class="n">model_var</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="k">if</span> <span class="n">model_var</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">model_var</span><span class="o">.</span><span class="n">values</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_var</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">model_var_values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Individual Models&#39;</span><span class="p">)</span>

    <span class="n">era5_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ERA5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">])</span>
    <span class="n">cmip6_var</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">cmip6_var_ens_mean</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">cmip6_var_ens_mean</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">cmip6_mean_std_sel</span><span class="p">,</span>
        <span class="n">cmip6_var_ens_mean</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">cmip6_mean_std_sel</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;CMIP6 Spread&#39;</span>
    <span class="p">)</span>

    <span class="n">slope_era5</span><span class="p">,</span> <span class="n">p_value_era5</span> <span class="o">=</span> <span class="n">plot_trend</span><span class="p">(</span><span class="n">era5_var</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">era5_var</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span>
                                          <span class="n">era5_var</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">era5_var</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> 
                                          <span class="sa">f</span><span class="s2">&quot;ERA5 Trend&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="s2">&quot;ERA5&quot;</span><span class="p">])</span>

    <span class="n">slope_cmip6</span><span class="p">,</span> <span class="n">p_value_cmip6</span> <span class="o">=</span> <span class="n">plot_trend</span><span class="p">(</span><span class="n">cmip6_var</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cmip6_var</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span>
                                            <span class="n">cmip6_var</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">cmip6_var</span><span class="o">.</span><span class="n">values</span><span class="p">)],</span> 
                                            <span class="sa">f</span><span class="s2">&quot;CMIP6 Median Trend&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">])</span>

    <span class="n">trend_info</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERA5 </span><span class="si">{</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-year </span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">slope_era5</span><span class="p">,</span> <span class="n">p_value_era5</span><span class="p">),</span>
        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CMIP6 Median </span><span class="si">{</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-year </span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">slope_cmip6</span><span class="p">,</span> <span class="n">p_value_cmip6</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;End year of the moving window&#39;</span><span class="p">)</span>
    <span class="n">string_freq</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(from </span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cmip6_variable_short</span><span class="si">}</span><span class="s2"> means)&quot;</span>
    <span class="n">title_numb</span> <span class="o">=</span> <span class="s2">&quot;(a)&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;HFISOs_10_20_variance&quot;</span> <span class="k">else</span> \
             <span class="s2">&quot;(b)&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;LFISOs_30_60_variance&quot;</span> <span class="k">else</span> \
             <span class="s2">&quot;(c)&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span> <span class="k">else</span> \
             <span class="s2">&quot;(d)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title_numb</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mode_var_string</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="si">}</span><span class="s2"> in daily precipitation anomalies . &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Width of the moving window: </span><span class="si">{</span><span class="n">variance_window</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-year. </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Region: lon [</span><span class="si">{</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">E, </span><span class="si">{</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">E] x lat [</span><span class="si">{</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">N, </span><span class="si">{</span><span class="n">area_timeseries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">N] </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Period: </span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">. Season: </span><span class="si">{</span><span class="n">timeseries</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>

    <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(mm/day)¬≤&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span><span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;(mm/day)¬≤&quot;</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;LFISOs_30_60_variance&quot;</span><span class="p">,</span><span class="s2">&quot;HFISOs_10_20_variance&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;1&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.015</span><span class="p">,</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> Trend: </span><span class="si">{</span><span class="n">trend</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">units</span><span class="si">}</span><span class="s2">/decade), p-value: </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span>
                                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">trend</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">trend_info</span><span class="p">]),</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;square,pad=0.5&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;HFISOs_10_20_coefficient_of_variation&quot;</span><span class="p">,</span> <span class="s2">&quot;LFISOs_30_60_coefficient_of_variation&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7d48e83295b1503d3e529b4716da9034937c4d59e4e7f88dcabd973462dc6aae.png" src="../../_images/7d48e83295b1503d3e529b4716da9034937c4d59e4e7f88dcabd973462dc6aae.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/5e2ebed9ea53018556d7019b117a4c8b625c83e351cad0f34b8fdc21c1bb1f8a.png" src="../../_images/5e2ebed9ea53018556d7019b117a4c8b625c83e351cad0f34b8fdc21c1bb1f8a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/a42dc77dc21959125e81adfae17b8de6a0ff2fdbc5a6cf96673d809ad5adf5a4.png" src="../../_images/a42dc77dc21959125e81adfae17b8de6a0ff2fdbc5a6cf96673d809ad5adf5a4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="../../_images/8f1f255d120ccc589384e96e0c62ff4340d7aa25786b21e69da809c3d73299f2.png" src="../../_images/8f1f255d120ccc589384e96e0c62ff4340d7aa25786b21e69da809c3d73299f2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div>
    <div style="max-width: 800px;">
    <p><strong>Fig 13.</strong> Time series of the spatially averaged values for the chosen variability formulations: (a) variance and (b) coefficient of variation, for filtered daily precipitation anomalies over the period 1940‚Äì2014. The variance and coefficient of variation have been calculated using a 30-year window. Each time series displays the CMIP6 ensemble median (green), ERA5 (black), and individual models (grey), with dashed lines indicating the trend for the CMIP6 ensemble median and ERA5. The shaded area represents the ensemble spread. A grey box at the bottom displays the trend slope. Before calculating the variance and coefficient of variation, a Lanczos band-pass filter has been applied to the daily precipitation anomalies to isolate the 10‚Äì20-day high-frequency intraseasonal oscillations (HFISOs) and the 30‚Äì60-day low-frequency intraseasonal oscillations (LFISOs).</p>
</div></section>
<section id="results-summary-and-discussion">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-6"></span><h4>3.6. Results summary and discussion<a class="headerlink" href="#results-summary-and-discussion" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>An assessment evaluating the <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html#" rel="noreferrer" target="_blank">capability of CMIP6 GCMs to represent inter-annual precipitation variability</a> complements the results presented in this notebook.</p></li>
<li><p>Intra-seasonal variability during the Monsoon season (JJAS) shows substantial differences in spatial patterns depending on the formulation used‚Äîvariance or the coefficient of variation (standard deviation divided by the mean). As detailed throughout, a Lanczos band-pass filter is applied to daily precipitation anomalies to isolate 10‚Äì20-day high-frequency (HFISOs) and 30‚Äì60-day low-frequency (LFISOs) oscillations. Anomalies are computed relative to the daily climatology to remove the seasonal cycle.</p></li>
<li><p>Using variance to assess inter-annual variability reveals large differences in bias sign, magnitude, and spatial distribution. Despite model differences, biases are consistently influenced by orography and high-precipitation regions. These regions show high absolute biases due to high JJAS precipitation, though not necessarily large relative to the mean. The coefficient of variation (CV) normalises this effect, offering a potentially more meaningful measure of variability‚Äîthough it can yield high values where climatological means are near zero.</p></li>
<li><p>Differences between models are smaller when using CV compared to variance. Inland north-western regions (with near-zero or very low seasonal averages) show strong negative biases and high inter-model spread. One hypothesis to explain this may be that unusually wet spells are underestimated in comparison to ERA5.</p></li>
<li><p>The spatial patterns of variance and CV for HFISOs and LFISOs are largely similar.</p></li>
<li><p>Intra-seasonal variability patterns strongly resemble those seen in the inter-annual assessment, suggesting intra-seasonal timescales may influence inter-annual variability  <a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">[10]</a>.</p></li>
<li><p>CMIP6 ensemble median does not accurately capture the temporal evolution of variance and coefficient of variation in filtered daily anomalies averaged over India (HFISOs and LFISOs). While ERA5 shows a decreasing trend in variance and increasing trend in coefficient of variation, CMIP6 models indicate opposite trends, highlighting discrepancies in temporal representation. The trends for the selection region are statistically significant with p-values below 0.05.</p></li>
</ul>
</section>
<section id="implications-for-the-users">
<span id="climate-projections-cmip6-validation-q11-climate-projections-cmip6-validation-q11-section-3-7"></span><h4>3.7. Implications for the users<a class="headerlink" href="#implications-for-the-users" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>The selection of the variability formulation matters</strong>. The Coefficient of Variation (CV) reduces orographic influence by normalising variability by the mean, and shows smaller inter-model differences than variance. However, it can produce artefactually high values in north-western inland regions where mean precipitation is very low.</p></li>
<li><p><strong>ERA5 has biases</strong> <a class="reference external" href="https://doi.org/10.1002/qj.3616" rel="noreferrer" target="_blank">[13]</a><a class="reference external" href="https://doi.org/10.3390/atmos12111462" rel="noreferrer" target="_blank">[14]</a>. While ERA5 is used for its temporal coverage, it has known biases. Users may consider alternative references like the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-precipitation?tab=overview" rel="noreferrer" target="_blank">GPCP</a> dataset, which may yield different results.</p></li>
<li><p>Unlike the <a class="reference external" href="https://ecmwf-projects.github.io/c3s2-eqc-quality-assessment/Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html#" rel="noreferrer" target="_blank">inter-annual assessment</a>, CV and variance show opposite trends over time. ERA5 indicates a decline in variance and a rise in the coefficient of variation, while CMIP6 models show the reverse.</p></li>
<li><p>It is <strong>important to consider a larger ensemble and acknowledge that the time series in this assessment represent spatially averaged values</strong>, which may lead to different results when focusing on specific sub-regions.</p></li>
<li><p><strong>Frequency component consistency</strong>: No significant differences are seen in the spatial or temporal patterns between the low-frequency (LFISOs) and high-frequency (HFISOs) components of intra-seasonal oscillations.</p></li>
<li><p>Given the challenges in replicating the spatial patterns of variance and the coefficient of variation, as well as the difficulties in capturing their temporal evolution, <strong>bias correction of CMIP6 projections may be essential for effectively using future projections of intra-seasonal precipitation variability. Such improvements could facilitate the adoption of CMIP6 future projections in the water management sector, aiding in the design of strategies to adapt to projected changes in precipitation.</strong></p></li>
<li><p><strong>Intra-seasonal and inter-annual links.</strong> The spatial patterns of intra-seasonal variability closely resemble those found in the inter-annual variability assessment. Intra-seasonal variability may influence inter-annual variability <a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">[10]</a> and, therefore, it may be important to bias correct data at the daily timescale.</p></li>
<li><p><strong>Assessments using regional climate models (RCMs) may produce different results</strong> (not necessarily better) due to their higher spatial resolution, better representation of local processes, and more detailed treatment of orography and land-atmosphere interactions.</p></li>
</ul>
<p><a id='RESULTS NOTE'></a></p>
<div class="alert alert-block alert-warning">  
<b>RESULTS NOTE</b>:<br> 
It is important to note that the results presented are specific to the 16 models chosen, and users should aim to assess as wide a range of models as possible before making a sub-selection.</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>‚ÑπÔ∏è If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Some key resources and further reading were linked throughout this assessment.</p>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>CMIP6 climate projections (Daily - Precipitation): <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cmip6?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/projections-cmip6?tab=overview</a></p></li>
<li><p>ERA5 hourly data on single levels from 1940 to present (total precipitation): <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1111/gcb.12581" rel="noreferrer" target="_blank">[1]</a> Thornton, P. K., Ericksen, P. J., Herrero, M., and Challinor, A. J., 2014. Climate variability and vulnerability to climate change: A review. Global Change Biol. 20, <a class="reference external" href="https://doi.org/10.1111/gcb.12581" rel="noreferrer" target="_blank">https://doi.org/10.1111/gcb.12581</a></p>
<p><a class="reference external" href="https://doi.org/10.1016/j.wace.2020.100277" rel="noreferrer" target="_blank">[2]</a> Masroor, M., Rehman, S., Avtar, R., Sahana, M., Ahmed, R., Sajjad, H., 2020. Exploring climate variability and its impact on drought occurrence: evidence from Godavari Middle sub-basin, India. Weather and Climate Extremes. 30, 100277. <a class="reference external" href="https://doi.org/10.1016/j.wace.2020.100277" rel="noreferrer" target="_blank">https://doi.org/10.1016/j.wace.2020.100277</a></p>
<p><a class="reference external" href="https://doi.org/10.1111/j.2153-3490.1980.tb01717.x" rel="noreferrer" target="_blank">[3]</a> Krishnamurti, T. N. and Ardanuy, P., 1980. 10 to 20-day westward propagating mode and ‚Äúbreaks in the monsoons‚Äù. Tellus, 32, 15‚Äì26. <a class="reference external" href="https://doi.org/10.1111/j.2153-3490.1980.tb01717.x" rel="noreferrer" target="_blank">https://doi.org/10.1111/j.2153-3490.1980.tb01717.x</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/2007MWR1991.1" rel="noreferrer" target="_blank">[4]</a> Wen, M. and Zhang, R., 2007. Role of the quasi-biweekly oscillation in the onset of convection over the Indochina Peninsula, Q. J. R. Meteor. Soc., 133, 433‚Äì444. <a class="reference external" href="https://doi.org/10.1002/qj.38" rel="noreferrer" target="_blank">https://doi.org/10.1002/qj.38</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/2011JCLI3916.1" rel="noreferrer" target="_blank">[5]</a> Wen, M., Yang, S., Higgins, R. W., Zhang, R., 2011. Characteristics of the dominant modes of atmospheric quasi-biweekly oscillation over tropical-subtropical Americas, J. Climate, 24, 3956‚Äì3970. <a class="reference external" href="https://doi.org/10.1175/2011JCLI3916.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/2011JCLI3916.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0469%281971%29028%3C0702:DOADOI%3E2.0.CO;2" rel="noreferrer" target="_blank">[6]</a> Madden, R. A. and Julian P. R., 1971. Detection of a 40‚Äì50 day oscillation in the zonal wind in the tropical Pacific, J. Atmos. Sci., 28, 702‚Äì708. <a class="reference external" href="https://doi.org/10.1175/1520-0469%281971%29028%3C0702:DOADOI%3E2.0.CO;2" rel="noreferrer" target="_blank">https://doi.org/10.1175/1520-0469(1971)028&lt;0702:DOADOI&gt;2.0.CO;2</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/1520-0469%281972%29029%3C1109:DOGSCC%3E2.0.CO;2" rel="noreferrer" target="_blank">[7]</a> Madden, R. A. and Julian P. R., 1972. Description of global scale circulation cells in the tropics with 40‚Äì50 day period, J. Atmos. Sci., 29, 1109‚Äì1123. <a class="reference external" href="https://doi.org/10.1175/1520-0469%281972%29029" rel="noreferrer" target="_blank">https://doi.org/10.1175/1520-0469(1972)029</a>&lt;1109:DOGSCC&gt;<a class="reference external" href="http://2.0.CO" rel="noreferrer" target="_blank">2.0.CO</a>;2</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41612-022-00253-7" rel="noreferrer" target="_blank">[8]</a> Liu, F., Wang, B., Ouyang, Y., Wang, H., Qiao,S., Chen, G., Dong, W., 2022. Intraseasonal variability of global land monsoon precipitation and its recent trend. npj Clim Atmos Sci 5, 30. <a class="reference external" href="https://doi.org/10.1038/s41612-022-00253-7" rel="noreferrer" target="_blank">https://doi.org/10.1038/s41612-022-00253-7</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/jgrd.50422" rel="noreferrer" target="_blank">[9]</a>, Jia, X. and Yang, S., 2013. Impact of the quasi-biweekly oscillation over the western North Pacific on East Asian subtropical monsoon during early summer, J. Geophys. Res. Atmos., 118, 4421‚Äì4434, <a class="reference external" href="https://doi.org/10.1002/jgrd.50422" rel="noreferrer" target="_blank">https://doi.org/10.1002/jgrd.50422</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">[10]</a> Jiang, X. and Ting, M., 2019. Intraseasonal Variability of Rainfall and Its Effect on Interannual Variability across the Indian Subcontinent and the Tibetan Plateau. J. Climate, 32, 2227‚Äì2245, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-18-0319.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JCLI-D-18-0319.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1175/JCLI-D-16-0360.1" rel="noreferrer" target="_blank">[11]</a> Hatsuzuka, D., and Fujinami, H., 2017. Effects of the South Asian Monsoon Intraseasonal Modes on Genesis of Low Pressure Systems over Bangladesh. J. Climate, 30, 2481‚Äì2499, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-16-0360.1" rel="noreferrer" target="_blank">https://doi.org/10.1175/JCLI-D-16-0360.1</a></p>
<p><a class="reference external" href="https://doi.org/10.1007/s00382-019-04946-3" rel="noreferrer" target="_blank">[12]</a> Yan, X., Yang, S., Wang, T., Maloney, E.D., Dong, S., Wei, W., He, S., 2019. Quasi-biweekly oscillation of the Asian monsoon rainfall in late summer and autumn: different types of structure and propagation. Clim Dyn 53, 6611‚Äì6628. <a class="reference external" href="https://doi.org/10.1007/s00382-019-04946-3" rel="noreferrer" target="_blank">https://doi.org/10.1007/s00382-019-04946-3</a></p>
<p><a class="reference external" href="https://doi.org/10.1002/qj.3616" rel="noreferrer" target="_blank">[13]</a> Ramon, J., Lled√≥ L., Torralba, V., Soret, A., Doblas-Reyes, F.J., 2019. What global reanalysis best represents near-surface winds?. Q J R Meteorol Soc. 2019; 145: 3236‚Äì3251. <a class="reference external" href="https://doi.org/10.1002/qj.3616" rel="noreferrer" target="_blank">https://doi.org/10.1002/qj.3616</a></p>
<p><a class="reference external" href="https://doi.org/10.3390/atmos12111462" rel="noreferrer" target="_blank">[14]</a> Hassler, B., and Lauer, A., 2021. Comparison of Reanalysis and Observational Precipitation Datasets Including ERA5 and WFDE5. Atmosphere, 12, 1462. <a class="reference external" href="https://doi.org/10.3390/atmos12111462" rel="noreferrer" target="_blank">https://doi.org/10.3390/atmos12111462</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Climate_Projections/CMIP6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="climate_projections-cmip6_validation_q10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.1.10. </span>Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</p>
      </div>
    </a>
    <a class="right-next"
       href="climate_projections-cmip6_validation_q12.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.1.12. </span>Biases in temperature trends at different pressure levels using CMIP6 across latitudinal bands</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-assessing-the-potential-impacts-of-climate-change-on-precipitation-variability-over-india">üåç Use case: Assessing the potential impacts of climate change on precipitation variability over India</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">‚ùì Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">üì¢ Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">üìã Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">üìà Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-requests-and-functions-definition">1. Parameters, requests and functions definition</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-packages">1.1. Import packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">1.2. Define Parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-input-models-and-output-parameters">1.3. Define input models and output parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-era5-request">1.4. Define ERA5 request</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-model-requests">1.5. Define model requests</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-cache">1.6. Functions to cache</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-and-processing">2. Downloading and processing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-era5">2.1. Download and transform ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-models">2.2. Download and transform models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#change-some-attributes">2.3. Change some attributes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">3. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-plotting-functions">3.1. Define plotting functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ensemble-maps">3.2. Plot ensemble maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-model-maps">3.3. Plot model maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-bias-maps">3.4. Plot bias maps</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#timeseries-of-the-coefficient-of-variation">3.5. Timeseries of the coefficient of variation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#results-summary-and-discussion">3.6. Results summary and discussion</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implications-for-the-users">3.7. Implications for the users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">‚ÑπÔ∏è If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>