
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments" href="climate_projections-cmip6_model-performance_q03.html" />
    <link rel="prev" title="5.1.7. Projections of future ice-free periods for the Arctic and Antarctic" href="climate_projections-cmip6_climate-impact-indicators_q04.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.2. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.3. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.1. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../climate.html">5. Quality assessments for Climate Projections</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="CMIP6.html">5.1. CMIP6</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FClimate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Historical accuracy of sea ice extent in the CMIP6 projections</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-sea-ice-extent-in-cmip6-models-to-inform-product-creation">🌍 Use case: Scientific assessment of sea ice extent in CMIP6 models to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-time-series">1.4 Functions to create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-and-plotting-of-the-time-series">1.5 Post-processing and plotting of the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-compute-the-climatologies">1.6 Functions to compute the climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-and-plotting-of-climatologies">1.7 Post-processing and plotting of climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-parameters-for-downloading">2.1 Set some parameters for downloading</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cmip6-data-for-time-series">2.2 Download and transform CMIP6 data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-eumetsat-osi-saf-climatology">2.3 Download EUMETSAT OSI-SAF climatology</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-mean-climatology-for-the-historical-cmip6-experiment">2.4 Download the mean climatology for the historical CMIP6 experiment</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-evaluation-metrics">3.1 Time series of evaluation metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-distribution-of-errors">3.2 Spatial distribution of errors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-minimum">3.2.1 Arctic minimum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-maximum">3.2.2 Arctic maximum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-minimum">3.2.3 Antarctic minimum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-maximum">3.2.4 Antarctic maximum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-december-relevant-to-the-arctic-shipping-route-assessment">3.2.5 Arctic December (relevant to the Arctic shipping route assessment)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="historical-accuracy-of-sea-ice-extent-in-the-cmip6-projections">
<h1><span class="section-number">5.1.8. </span>Historical accuracy of sea ice extent in the CMIP6 projections<a class="headerlink" href="#historical-accuracy-of-sea-ice-extent-in-the-cmip6-projections" title="Link to this heading">#</a></h1>
<p>Production date: 2024-05-31</p>
<p>Produced by: Timothy Williams, Nansen Environmental and Remote Sensing Center (NERSC)</p>
<section id="use-case-scientific-assessment-of-sea-ice-extent-in-cmip6-models-to-inform-product-creation">
<h2>🌍 Use case: Scientific assessment of sea ice extent in CMIP6 models to inform product creation<a class="headerlink" href="#use-case-scientific-assessment-of-sea-ice-extent-in-cmip6-models-to-inform-product-creation" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-question">
<h2>❓ Quality assessment question<a class="headerlink" href="#quality-assessment-question" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How reliable are the historical estimates of the Arctic and Antarctic sea ice concentration and extent from the CMIP6 models?</strong></p></li>
</ul>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>Bearing in mind that sea ice concentration estimates from passive microwave observations themselves are quite uncertain, we find that the errors between them and the CMIP6 models in the historical experiment can have significant biases and also have quite a large spread, so should be treated with some caution.</p></li>
<li><p>We find that the CMIP6 models generally underestimate the sea ice extent and area. Errors for the Antarctic are approximately double those in the Arctic. While the Arctic sea ice minima are generally quite accurate, the Arctic maxima are consistently underestimated, as are the Antarctic extrema.</p></li>
<li><p>At the time of the Arctic minimum, there is a general underestimation in the pack ice, but an overestimation in the marginal ice zone (MIZ) and near the coasts.</p></li>
<li><p>At the time of the Arctic maximum, the concentration in the pack is relatively unbiased, but there are some areas where there is strong underestimation (Bering Sea, Sea of Okhotsk)and overestimation (Greenland Sea, Labrador Sea).</p></li>
<li><p>Arctic December: one of the other CMIP6 quality assessments looks at projections of accessibility of Arctic shipping routes, where sea ice in December is particularly interesting. Therefore we also check the reliability of the December concentrations in the CMIP6 models. We find that the concentration in the pack is quite similar to the observations, although there is significant underestimation in Hudson Bay, and less pronounced underestimation in the Bering Sea. In later years, there is also slight underestimation off the Russian coast. The ice extent in the Greenland and Barents Sea is consistently overestimated.</p></li>
<li><p>At the time of the Antarctic minimum, there is strong underestimation in the Weddell, Bellingshausen and Amundsen Seas, while south of the Pacific and Indian Oceans, there is less bias. However, there there is too little ice at the coast and too much away from it.</p></li>
<li><p>At the time of the Antarctic maximum, there is in general too little ice everywhere, with the region away from the coast at longitude about 140W south of the Atlantic Ocean, and in the region south of the Indian Ocean having the most pronounced underestimation. The underestimation on those areas is also increasing with time, while the concentration from satellite is staying relatively constant in this month as well.</p></li>
<li><p>These results are generally consistent with analyses from other authors - for the Arctic by the <a class="reference external" href="https://doi.org/10.1029/2019GL086749">SIMIP community (2020)</a>, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">Davy and Outten (2020)</a>, <a class="reference external" href="https://doi.org/10.1029/2020GL087965">Shu et al (2020)</a>, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0491.1">Watts et al (2021)</a>, <a class="reference external" href="https://doi.org/10.1080/15230430.2023.2271592">Henke et al (2023)</a> and <a class="reference external" href="https://doi.org/10.1175/JCLI-D-23-0452.1">Frankignoul et al (2024)</a>; for the Antarctic by <a class="reference external" href="https://doi.org/10.1029/2019GL086729">Roach et al (2020)</a>, <a class="reference external" href="https://doi.org/10.1029/2020GL087965">Shu et al (2020)</a>, <a class="reference external" href="https://doi.org/10.1029/2023GL105265">Nie et al (2023)</a> and <a class="reference external" href="https://doi.org/10.3390/rs15082048">Li et al (2023)</a>.</p></li>
<li><p>We ourselves don’t consider time series of the sea ice minima themselves, but only plot climatologies of the multi-model mean to see how the differences between the models and the observations are distributed spatially. However, this has been done by a few others, e.g. <a class="reference external" href="https://doi.org/10.1029/2020GL087965">Shu et al (2020)</a>, who found the observed Arctic September sea ice extent (SIE) declining trend between 1979 and 2014 is slightly underestimated in CMIP6 models, while the observed weak but significant upward trend of the Antarctic SIE is not captured.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>We compare sea ice concentrations from the <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/projections-cmip6?tab=overview">CMIP6</a> historical experiment with that obtained from <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-sea-ice-concentration?tab=overview">passive microwave satellite products from EUMETSAT OSI- SAF and ESA CCI</a>.  Time series of the evaluation metrics Integrated Ice Edge Error (IIEE) (<a class="reference external" href="https://doi.org/10.1002/2015GL067232">Goessling et al, 2016</a>; <a class="reference external" href="https://doi.org/10.1080/15230430.2023.2271592">Henke et al, 2023)</a>, bias in extent and area, and the root mean square error (RMSE) in sea ice concentration are produced and plotted. All of these statistics are area-weighted averages. We consider all the CMIP6 models that output sea ice concentration in the historical experiment, but remove outliers by only plotting the interquartile limits (IQLs). Other authors have chosen different subsetting approaches - e.g. by scoring the models and only retaining the top-performing ones. We recommend users test as many models as possible, before deciding if a subset adequately represents the uncertainty for their application.</p>
<p>Decadal climatologies for both the models and observations are also produced and compared, for the months March, September and December.</p>
<p>The “Analysis and results” section is organised as follows:</p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-1"><span class="std std-ref">1. Import libraries, set parameters and definitions of functions</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-2"><span class="std std-ref">2. Download and transform data</span></a></strong></p>
<p><strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3"><span class="std std-ref">3. Results</span></a></strong></p>
<p>        <strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-1"><span class="std std-ref">3.1 Time series of evaluation metrics</span></a></strong></p>
<p>        Plot time series of the error metrics.</p>
<p>        <strong><a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2"><span class="std std-ref">3.2 Spatial distribution of errors</span></a></strong></p>
<p>        This section has maps of climatologies and their biases for the <a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2-1"><span class="std std-ref">3.2.1 Arctic minimum</span></a>, <a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2-2"><span class="std std-ref">3.2.2 Arctic maximum</span></a>, <a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2-3"><span class="std std-ref">3.2.3 Antarctic minimum</span></a>, <a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2-4"><span class="std std-ref">3.2.4 Antarctic maximum</span></a>. We also plot maps for the <a class="reference internal" href="#climate-projections-cmip6-model-performance-q02-section-3-2-5"><span class="std std-ref">3.2.5 Arctic December (relevant to the Arctic shipping route assessment)</span></a> since this was an interesting month for the climate projections.</p>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="import-libraries-set-parameters-and-definitions-of-functions">
<span id="climate-projections-cmip6-model-performance-q02-section-1"></span><h3>1. Import libraries, set parameters and definitions of functions<a class="headerlink" href="#import-libraries-set-parameters-and-definitions-of-functions" title="Link to this heading">#</a></h3>
<section id="import-libraries">
<h4>1.1 Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h4>
<p>Import the required libraries, including the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">calendar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmocean</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;cf_xarray&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="set-parameters">
<h4>1.2 Set parameters<a class="headerlink" href="#set-parameters" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Set the time period to be analysed with <code class="docutils literal notranslate"><span class="pre">year_start</span></code> and <code class="docutils literal notranslate"><span class="pre">year_stop</span></code>.</p></li>
<li><p>Set the concentration threshold <code class="docutils literal notranslate"><span class="pre">sic_threshold</span></code> for determining sea ice extent (we use 30% to be consistent with the ice edge product).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clim_months</span></code> is a list of the months to plot the climatologies for.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decades_historical</span></code> of starting years of decades to calculate climatologies for.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">projections</span></code> is a dictionary of projections to plot the climatology maps in.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map_slices</span></code> is a dictionary of slices in the x and y directions (on observation grid) to zoom in on the climatology maps.</p></li>
<li><p>Set the regions to be analysed with the list <code class="docutils literal notranslate"><span class="pre">regions</span></code>.</p></li>
<li><p>Set the models to be evaluated with the list <code class="docutils literal notranslate"><span class="pre">models</span></code>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">1970</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2019</span>
<span class="k">assert</span> <span class="n">year_start</span> <span class="o">&gt;=</span> <span class="mi">1970</span> <span class="ow">and</span> <span class="n">year_stop</span> <span class="o">&lt;=</span> <span class="mi">2019</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">year_start</span> <span class="o">%</span> <span class="mi">10</span> <span class="ow">or</span> <span class="p">(</span><span class="n">year_stop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Sea Ice Concentration Threshold</span>
<span class="n">sic_threshold</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># %</span>

<span class="c1"># months to plot the climatologies for</span>
<span class="n">clim_months</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>

<span class="c1"># starting years of decades to calculate climatologies for</span>
<span class="n">decades_historical</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># projections to plot the climatology maps in</span>
<span class="n">projections</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Arctic&quot;</span> <span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mf">90.</span><span class="p">),</span>
    <span class="s2">&quot;Antarctic&quot;</span> <span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=-</span><span class="mf">90.</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># slices in x and y directions (on observation grid) to zoom in on the climatology maps</span>
<span class="n">map_slices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Arctic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;yc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)},</span>
    <span class="s2">&quot;Antarctic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;xc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">),</span> <span class="s1">&#39;yc&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">)},</span>
<span class="p">}</span>

<span class="c1"># Select regions</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">,</span> <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">{</span>
    <span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">,</span>
    <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Choose CMIP6 historical models</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;access_cm2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;access_esm1_5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cams_csm1_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;canesm5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;canesm5_canoe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cmcc_cm2_hr4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cmcc_cm2_sr5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cmcc_esm2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_cm6_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_cm6_1_hr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cnrm_esm2_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;e3sm_1_1_eca&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_aerchem&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_cc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ec_earth3_veg_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fgoals_f3_l&quot;</span><span class="p">,</span>
    <span class="s2">&quot;giss_e2_1_h&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hadgem3_gc31_ll&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hadgem3_gc31_mm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inm_cm4_8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;inm_cm5_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ipsl_cm5a2_inca&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ipsl_cm6a_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;miroc6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;miroc_es2l&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mpi_esm1_2_hr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mpi_esm1_2_lr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;mri_esm2_0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nesm3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;norcpm1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;taiesm1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ukesm1_0_ll&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-requests-for-cds-data">
<h4>1.3 Define requests for CDS data<a class="headerlink" href="#define-requests-for-cds-data" title="Link to this heading">#</a></h4>
<p>Define the download requests in the format needed by the EQC toolbox.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_months</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>

<span class="n">request_cmip6_historical</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;projections-cmip6&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal_resolution&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
        <span class="s2">&quot;experiment&quot;</span><span class="p">:</span> <span class="s2">&quot;historical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_area_percentage_on_ocean_grid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="mi">1850</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span> <span class="mi">2014</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">all_months</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="n">request_eumetsat</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span><span class="p">,</span>
    <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;EUMETSAT OSI SAF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;ssmis&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span><span class="w"> </span><span class="mi">1979</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
        <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-create-the-time-series">
<h4>1.4 Functions to create the time series<a class="headerlink" href="#functions-to-create-the-time-series" title="Link to this heading">#</a></h4>
<p>These functions are all applied to a single CMIP6 model.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interpolate_to_satellite_grid</span></code> interpolates the model to the satellite grid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_interpolated_data</span></code> is applied to both the model and satellite data, to take the monthly mean (the satellite data is daily, but this also forces all the models to have the same time coordinate) and interpolate to the satellite grid (only for model data). It also calculates the RMS error (only for satellite data).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_satellite_data</span></code> downloads the daily satellite data and applies <code class="docutils literal notranslate"><span class="pre">get_monthly_interpolated_data</span></code> to get the monthly mean and the RMS error in the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compare_model_vs_obs</span></code> compares the sea ice concentration from a single CMIP6 model with satellite estimates, calculating error metrics like biases in concentration and extent, RMSE, and IIEE.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_sea_ice_evaluation_diagnostics</span></code> downloads the satellite and model data and calls <code class="docutils literal notranslate"><span class="pre">compare_model_vs_obs</span></code> to get a time series of error metrics.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">):</span>
    <span class="c1"># Remove nan columns</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">dim</span> <span class="ow">or</span> <span class="s2">&quot;lon&quot;</span> <span class="ow">in</span> <span class="n">dim</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">drop_isel</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">i</span><span class="p">})</span>

    <span class="n">collection_id</span> <span class="o">=</span> <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span>
    <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;ESA CCI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;amsr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="s2">&quot;2002&quot;</span><span class="p">,</span>
        <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;06&quot;</span><span class="p">,</span>
        <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">grid_out</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span><span class="n">collection_id</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">regrid</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">grid_out</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_interpolated_data</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">add_stde</span><span class="p">,</span> <span class="n">check_values</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">add_stde</span><span class="p">:</span>
        <span class="n">stde</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction standard_error&quot;</span><span class="p">]</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[[</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s2">&quot;vertices&quot;</span><span class="p">,</span> <span class="s2">&quot;bnds&quot;</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">regrid_kwargs</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span><span class="p">)</span>

    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span>

    <span class="k">if</span> <span class="n">add_stde</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">merge</span><span class="p">((</span><span class="n">stde</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">check_values</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">}))</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_satellite_data</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
    <span class="n">year_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">year_stop</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

    <span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cdr_type&quot;</span><span class="p">:</span> <span class="s2">&quot;cdr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">satellite_requests</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ESA-CCI&quot;</span><span class="p">:</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
            <span class="n">common_request</span>
            <span class="o">|</span> <span class="p">{</span>
                <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;ESA CCI&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;amsr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span><span class="w"> </span><span class="mi">2002</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span><span class="w"> </span><span class="mi">2017</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
            <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s2">&quot;EUMETSAT-OSI-SAF&quot;</span><span class="p">:</span> <span class="n">download</span><span class="o">.</span><span class="n">update_request_date</span><span class="p">(</span>
            <span class="n">common_request</span>
            <span class="o">|</span> <span class="p">{</span>
                <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="s2">&quot;EUMETSAT OSI SAF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sensor&quot;</span><span class="p">:</span> <span class="s2">&quot;ssmis&quot;</span><span class="p">,</span>
                <span class="s2">&quot;temporal_aggregation&quot;</span><span class="p">:</span> <span class="s2">&quot;daily&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span><span class="w"> </span><span class="mi">1979</span><span class="p">)</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
            <span class="n">stop</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">year_stop</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="p">)</span><span class="si">}</span><span class="s2">-12&quot;</span><span class="p">,</span>
            <span class="n">stringify_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">}</span>

    <span class="n">datasets_satellite</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">requests</span> <span class="ow">in</span> <span class="n">satellite_requests</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">requests</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">datasets_satellite</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="s2">&quot;satellite-sea-ice-concentration&quot;</span><span class="p">,</span>
            <span class="n">requests</span><span class="p">,</span>
            <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">get_monthly_interpolated_data</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;add_stde&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;check_values&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">datasets_satellite</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_model_vs_obs</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">datasets_sat</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
    <span class="n">datasets_sat</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">convert_calendar</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">,</span> <span class="n">align_on</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets_sat</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">grid_cell_area</span> <span class="o">*=</span> <span class="mf">1.0e-6</span>  <span class="c1"># 10^6 km2</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;(0 - 1)&quot;</span><span class="p">:</span>
        <span class="n">sic</span> <span class="o">*=</span> <span class="mi">100</span>

    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;xc&quot;</span><span class="p">,</span> <span class="s2">&quot;yc&quot;</span><span class="p">)</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">origin</span><span class="p">,</span> <span class="n">ds_sat</span> <span class="ow">in</span> <span class="n">datasets_sat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Get variables</span>
        <span class="n">sic_obs</span> <span class="o">=</span> <span class="n">ds_sat</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>
        <span class="n">sic_obs_err</span> <span class="o">=</span> <span class="n">ds_sat</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction standard_error&quot;</span><span class="p">]</span>
        <span class="n">sic_model</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">sic_obs</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>

        <span class="c1"># Compute useful variables</span>
        <span class="n">sic_diff</span> <span class="o">=</span> <span class="n">sic_model</span> <span class="o">-</span> <span class="n">sic_obs</span>
        <span class="n">over</span> <span class="o">=</span> <span class="p">((</span><span class="n">sic_model</span> <span class="o">&gt;</span> <span class="n">sic_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sic_obs</span> <span class="o">&lt;=</span> <span class="n">sic_threshold</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
        <span class="n">under</span> <span class="o">=</span> <span class="p">((</span><span class="n">sic_model</span> <span class="o">&lt;=</span> <span class="n">sic_threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sic_obs</span> <span class="o">&gt;</span> <span class="n">sic_threshold</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>

        <span class="c1"># Compute output</span>
        <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siconc_bias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sic_diff</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siconc_bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_concentration_bias&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice concentration bias&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siconc_rmse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dims</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siconc_rmse&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_concentration_rmse&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice concentration root mean square error&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;rms_sic_obs_error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_obs_err</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;rms_sic_obs_error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;root_mean_square_sea_ice_concentration_observation_error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Root mean square sea ice concentration observation error&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;iiee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">over</span> <span class="o">+</span> <span class="n">under</span><span class="p">)</span> <span class="o">*</span> <span class="n">grid_cell_area</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;iiee&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;integrated_ice_edge_error&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Integrated ice edge error&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siextent_bias&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">over</span> <span class="o">-</span> <span class="n">under</span><span class="p">)</span> <span class="o">*</span> <span class="n">grid_cell_area</span>
        <span class="n">dataarrays</span><span class="p">[</span><span class="s2">&quot;siextent_bias&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;standard_name&quot;</span><span class="p">:</span> <span class="s2">&quot;sea_ice_extent_bias&quot;</span><span class="p">,</span>
            <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;$10^6$km$^2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Sea ice extent bias&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="n">origin</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">datasets</span> <span class="k">else</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    

<span class="k">def</span><span class="w"> </span><span class="nf">compute_sea_ice_evaluation_diagnostics</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span>
<span class="p">):</span>
    <span class="n">datasets_sat</span> <span class="o">=</span> <span class="n">get_satellite_data</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">region</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">get_monthly_interpolated_data</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">add_stde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">regrid_kwargs</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">compare_model_vs_obs</span><span class="p">(</span>
        <span class="n">ds</span><span class="p">,</span> <span class="n">datasets_sat</span><span class="p">,</span> <span class="n">sic_threshold</span><span class="p">,</span> <span class="n">grid_cell_area</span><span class="o">=</span><span class="mi">25</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="post-processing-and-plotting-of-the-time-series">
<h4>1.5 Post-processing and plotting of the time series<a class="headerlink" href="#post-processing-and-plotting-of-the-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code> is applied after loading from the cache and renames some variables and dimensions for easier use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_timeseries</span></code> plots time series for each error metric (sea ice concentration bias and RMSE, sea ice extent bias and IIEE), and for each region (Arctic or Antarctic).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">postprocess_dataset</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;siconc_bias&quot;</span><span class="p">:</span> <span class="s2">&quot;Bias in concentration&quot;</span><span class="p">,</span>
            <span class="s2">&quot;siconc_rmse&quot;</span><span class="p">:</span> <span class="s2">&quot;RMSE in concentration&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rms_sic_obs_error&quot;</span><span class="p">:</span> <span class="s2">&quot;RMS obs error in concentration&quot;</span><span class="p">,</span>
            <span class="s2">&quot;iiee&quot;</span><span class="p">:</span> <span class="s2">&quot;IIEE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;siextent_bias&quot;</span><span class="p">:</span> <span class="s2">&quot;Extent bias&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;northern_hemisphere&quot;</span><span class="p">:</span> <span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="s2">&quot;southern_hemisphere&quot;</span><span class="p">:</span> <span class="s2">&quot;Antarctic&quot;</span><span class="p">}[</span><span class="n">region</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">func</span><span class="p">:</span>
        <span class="n">ds_cmip6</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="si">=}</span><span class="s2"> but </span><span class="si">{</span><span class="n">kwargs</span><span class="si">=}</span><span class="s2">&quot;</span>
    <span class="c1"># err_name = &quot;RMS obs error&quot;</span>
    <span class="n">err_name</span> <span class="o">=</span> <span class="s2">&quot;RMS obs error in concentration&quot;</span>
    <span class="n">err_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="s2">&quot;darkgray&quot;</span><span class="p">]</span>
    <span class="n">ds_error</span> <span class="o">=</span> <span class="n">ds_cmip6</span><span class="p">[[</span><span class="n">err_name</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span><span class="c1">#should be the same for all models</span>
    <span class="n">da_cmip6</span> <span class="o">=</span> <span class="n">ds_cmip6</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">err_name</span><span class="p">])</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span>

    <span class="c1"># get median and interquartile limits to show the spread of the models</span>
    <span class="n">da_median</span> <span class="o">=</span> <span class="n">da_cmip6</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
    <span class="n">da_iql</span> <span class="o">=</span> <span class="n">da_cmip6</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>

    <span class="c1"># plot the median</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">da_median</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">)):</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;CMIP6 vs </span><span class="si">{</span><span class="n">origin</span><span class="si">}</span><span class="s2"> median&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            <span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Plot spread and add observation errors</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
            
            <span class="n">da2</span> <span class="o">=</span> <span class="n">da_iql</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="n">origin</span><span class="p">})</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                <span class="n">da2</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
                <span class="n">da2</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">da2</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;CMIP6 vs </span><span class="si">{</span><span class="n">origin</span><span class="si">}</span><span class="s2"> IQL&quot;</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Bias in concentration&quot;</span><span class="p">:</span>
                <span class="c1"># add obs errors to plots</span>
                <span class="n">da_err</span> <span class="o">=</span> <span class="n">ds_error</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="n">origin</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]})[</span><span class="n">err_name</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                    <span class="n">da_err</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
                    <span class="o">-</span> <span class="n">da_err</span><span class="p">,</span>
                    <span class="n">da_err</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;RMS obs. error (</span><span class="si">{</span><span class="n">origin</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">zorder</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">err_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;RMSE in concentration&quot;</span><span class="p">:</span>
                <span class="c1"># add obs errors to plots</span>
                <span class="n">da_err</span> <span class="o">=</span> <span class="n">ds_error</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="n">origin</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]})[</span><span class="n">err_name</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
                    <span class="n">da_err</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">da_err</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;RMS obs. error (</span><span class="si">{</span><span class="n">origin</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="n">zorder</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">err_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">sel_dict</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Extent bias&quot;</span><span class="p">:</span>
                <span class="c1"># fix time labels for last variable</span>
                <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span><span class="mi">2016</span><span class="p">,</span><span class="mi">5</span><span class="p">)]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
                <span class="n">xtick_labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xtick_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">rotation_mode</span><span class="o">=</span><span class="s2">&quot;anchor&quot;</span><span class="p">,</span>
                                   <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

    <span class="c1"># Edit axs</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>
        <span class="n">variable</span> <span class="o">=</span> <span class="n">sel_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;variable&quot;</span><span class="p">)</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds_cmip6</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">facet</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="functions-to-compute-the-climatologies">
<h4>1.6 Functions to compute the climatologies<a class="headerlink" href="#functions-to-compute-the-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">compute_monthly_climatology</span></code> transforms a dataset (which can contain model or observation data) by sorting according to month, taking the time average, and interpolating to the satellite grid (model data only).</p></li>
<li><p>For a specified time interval, <code class="docutils literal notranslate"><span class="pre">get_monthly_climatology_eumetsat</span></code> downloads the satellite data and calculates the climatology for the selected region and months.</p></li>
<li><p>For a specified time interval, <code class="docutils literal notranslate"><span class="pre">get_monthly_climatology_model</span></code> downloads and calculates the climatology for the selected region, months and model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_monthly_climatologies_cmip6</span></code> calls <code class="docutils literal notranslate"><span class="pre">get_monthly_climatology_model</span></code> once for each model and calculates the climatology of the ensemble mean.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_monthly_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">year</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">year1</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">year2</span> <span class="o">=</span> <span class="n">get_year</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">ds</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">year1</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">year2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">interpolate_to_satellite_grid</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_climatology_eumetsat</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">=</span> <span class="n">request</span>
    <span class="n">ndays</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">year1</span><span class="p">,</span> <span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span><span class="p">])</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">cid</span><span class="p">,</span>
        <span class="n">req</span> <span class="o">|</span> <span class="p">{</span>
            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year1</span><span class="p">,</span> <span class="n">year2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
            <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span><span class="p">],</span>
            <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">day</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ndays</span><span class="p">)],</span>
        <span class="p">},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">postprocess_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_climatology_model</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">=</span> <span class="n">request</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="n">cid</span><span class="p">,</span>
        <span class="n">req</span> <span class="o">|</span> <span class="p">{</span>
            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year1</span><span class="p">,</span> <span class="n">year2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
            <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">postprocess_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_monthly_climatologies_cmip6</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loops over models and call get_monthly_climatology_model inside this function.</span>
<span class="sd">    Only returns the ensemble mean climatology to save memory.</span>
<span class="sd">    Also cleans the output as some models produce extra variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">=</span> <span class="n">request</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="w"> </span><span class="si">= }</span><span class="s2">, (</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="n">get_monthly_climatology_model</span><span class="p">(</span>
                <span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">}),</span>
                <span class="n">year1</span><span class="p">,</span> <span class="n">year2</span><span class="p">,</span> <span class="n">months</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">])]</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># some models produce extra variables so drop any that are not needed</span>
    <span class="n">vars_to_keep</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;xc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;yc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;years&#39;</span><span class="p">,</span>
        <span class="s1">&#39;month&#39;</span><span class="p">,</span>
        <span class="s1">&#39;model&#39;</span><span class="p">,</span>
        <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
        <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sea ice concentration&#39;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">vars_to_keep</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="post-processing-and-plotting-of-climatologies">
<h4>1.7 Post-processing and plotting of climatologies<a class="headerlink" href="#post-processing-and-plotting-of-climatologies" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_climatology</span></code> is applied after loading a climatology from the cache. It makes the name and units of the sea ice concentration variable consistent between datasets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_sic_maps</span></code> plots the climatology of the CMIP6 ensemble mean next to the observed climatology for the three decades considered (1985-1994, 1995-2004, 2005-2014), which are shown in rows.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_sic_bias_maps</span></code> plots the bias (CMIP6 ensemble mean minus the observations) for the same decades.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compare_sic_maps</span></code> is a wrapper for those functions.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">postprocess_climatology</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># rename month</span>
    <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    
    <span class="c1"># rename SIC and convert to %</span>
    <span class="n">sic</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_ice_area_fraction&quot;</span><span class="p">]</span>
    <span class="n">old_name</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">name</span>
    <span class="n">new_name</span> <span class="o">=</span> <span class="s2">&quot;Sea ice concentration&quot;</span>
    <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
    <span class="n">sic_is_normalized</span> <span class="o">=</span> <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;(0 - 1)&quot;</span>
    <span class="n">sic</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span>
    <span class="n">ds</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">sic</span> <span class="k">if</span> <span class="n">sic_is_normalized</span> <span class="k">else</span> <span class="n">sic</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">old_name</span><span class="p">:</span> <span class="n">new_name</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_sic_maps</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">,</span> <span class="n">ds_cmip6</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">sel_dict</span><span class="p">,</span> <span class="n">isel_dict</span><span class="p">):</span>
    <span class="n">get_sic</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ds</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">isel_dict</span><span class="p">)[</span><span class="s2">&quot;Sea ice concentration&quot;</span><span class="p">]</span>
    <span class="n">sic_eumetsat</span> <span class="o">=</span> <span class="n">get_sic</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">)</span>
    <span class="n">sic_cmip6</span> <span class="o">=</span> <span class="n">get_sic</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sic_eumetsat</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">sic_cmip6</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CMIP6 ens. mean&quot;</span><span class="p">]),</span>
        <span class="n">sic_eumetsat</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;EUMETSAT OSI-SAF&quot;</span><span class="p">]),</span>
    <span class="p">]</span>
    <span class="n">ds_compare_obs</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">)</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">ds_compare_obs</span><span class="p">[</span><span class="s2">&quot;Sea ice concentration&quot;</span><span class="p">],</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
        <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;years&quot;</span><span class="p">),</span>
        <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">ice</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mf">.065</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.6</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_sic_bias_maps</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">,</span> <span class="n">ds_cmip6</span><span class="p">,</span> <span class="n">proj</span><span class="p">,</span> <span class="n">sel_dict</span><span class="p">,</span> <span class="n">isel_dict</span><span class="p">):</span>
    <span class="n">get_sic</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ds</span><span class="p">:</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="o">**</span><span class="n">isel_dict</span><span class="p">)[</span><span class="s2">&quot;Sea ice concentration&quot;</span><span class="p">]</span>
    <span class="n">sic_obs</span> <span class="o">=</span> <span class="n">get_sic</span><span class="p">(</span><span class="n">ds_eumetsat</span><span class="p">)</span>
    <span class="n">get_bias</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sic</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">sic</span> <span class="o">-</span> <span class="n">sic_obs</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;Sea ice concentration bias&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>
        <span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="p">[</span><span class="n">source</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">ds_bias</span> <span class="o">=</span> <span class="n">get_bias</span><span class="p">(</span><span class="n">get_sic</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">),</span> <span class="s2">&quot;CMIP6 ens. mean&quot;</span><span class="p">)</span>
    <span class="n">facet_grid</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
        <span class="n">ds_bias</span><span class="p">[</span><span class="s2">&quot;Sea ice concentration bias&quot;</span><span class="p">],</span>
        <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span>
        <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;years&quot;</span><span class="p">),</span>
        <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pad&quot;</span> <span class="p">:</span> <span class="mf">.13</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">.6</span><span class="p">,</span> <span class="s1">&#39;extend&#39;</span><span class="p">:</span> <span class="s1">&#39;both&#39;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">facet_grid</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{value}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compare_sic_maps</span><span class="p">(</span><span class="n">datasets_eumetsat</span><span class="p">,</span> <span class="n">datasets_cmip6</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">sel_dict</span><span class="p">,</span> <span class="n">projections</span><span class="p">,</span> <span class="n">map_slices</span><span class="p">,</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_maps</span><span class="p">):</span>
    <span class="n">plot_func</span><span class="p">(</span>
        <span class="n">ds_eumetsat</span><span class="o">=</span><span class="n">datasets_eumetsat</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
        <span class="n">ds_cmip6</span><span class="o">=</span><span class="n">datasets_cmip6</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
        <span class="n">proj</span><span class="o">=</span><span class="n">projections</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
        <span class="n">sel_dict</span><span class="o">=</span><span class="n">sel_dict</span><span class="p">,</span>
        <span class="n">isel_dict</span><span class="o">=</span><span class="n">map_slices</span><span class="p">[</span><span class="n">region</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-transform-data">
<span id="climate-projections-cmip6-model-performance-q02-section-2"></span><h3>2. Download and transform data<a class="headerlink" href="#download-and-transform-data" title="Link to this heading">#</a></h3>
<p>Download and transform the data and save it to disk. The second time <code class="docutils literal notranslate"><span class="pre">download_and_transform</span></code> is run it will save time by loading the transformed data from the disk.</p>
<section id="set-some-parameters-for-downloading">
<h4>2.1 Set some parameters for downloading<a class="headerlink" href="#set-some-parameters-for-downloading" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interpolation_kwargs</span></code> sets some interpolation options.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">io_kwargs</span></code> sets some parameters to speed up the download process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eval_kwargs</span></code> contains all the options that will be passed to <code class="docutils literal notranslate"><span class="pre">download.download_and_transform</span></code> when creating the time series of evaluation metrics.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interpolation_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;nearest_s2d&quot;</span><span class="p">,</span>
    <span class="s2">&quot;periodic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;ignore_degenerate&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Parameters to speed up IO</span>
<span class="n">io_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;concat_dim&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
    <span class="s2">&quot;combine&quot;</span><span class="p">:</span> <span class="s2">&quot;nested&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data_vars&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coords&quot;</span><span class="p">:</span> <span class="s2">&quot;minimal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;compat&quot;</span><span class="p">:</span> <span class="s2">&quot;override&quot;</span><span class="p">,</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,),</span>
<span class="p">}</span>

<span class="n">eval_kwargs</span> <span class="o">=</span> <span class="n">io_kwargs</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span> <span class="n">compute_sea_ice_evaluation_diagnostics</span><span class="p">,</span>
    <span class="s2">&quot;chunks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">region_name_mapper</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;northern_hemisphere&#39;</span> <span class="p">:</span> <span class="s1">&#39;Arctic&#39;</span><span class="p">,</span> <span class="s1">&#39;southern_hemisphere&#39;</span><span class="p">:</span> <span class="s1">&#39;Antarctic&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-transform-cmip6-data-for-time-series">
<h4>2.2 Download and transform CMIP6 data for time series<a class="headerlink" href="#download-and-transform-cmip6-data-for-time-series" title="Link to this heading">#</a></h4>
<p>For each model and region, we download the data, transform it with <code class="docutils literal notranslate"><span class="pre">compute_sea_ice_evaluation_diagnostics</span></code>, save it to disk and post-process with <code class="docutils literal notranslate"><span class="pre">postprocess_dataset</span></code>. The time series are then combined into one dataset with extra dimensions <code class="docutils literal notranslate"><span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">region</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">model</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">models</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="w"> </span><span class="si">= }</span><span class="s2"> (</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span><span class="si">}</span><span class="s2">), </span><span class="si">{</span><span class="n">region</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># options to be passed to compute_sea_ice_evaluation_diagnostics</span>
        <span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="n">interpolation_kwargs</span> <span class="o">|</span> <span class="p">{</span>
            <span class="s2">&quot;sic_threshold&quot;</span><span class="p">:</span> <span class="n">sic_threshold</span><span class="p">,</span>
            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">request_cmip6_historical</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">request_cmip6_historical</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">},</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">eval_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">postprocess_dataset</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="p">[</span><span class="n">model</span><span class="p">]))</span>
        <span class="p">)</span>
<span class="n">ds_cmip6</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="k">del</span> <span class="n">datasets</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-eumetsat-osi-saf-climatology">
<h4>2.3 Download EUMETSAT OSI-SAF climatology<a class="headerlink" href="#download-eumetsat-osi-saf-climatology" title="Link to this heading">#</a></h4>
<p>For each region and decade, we download the climatology of satellite sea ice concentration (EUMETSAT OSI-SAF product).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">cid</span><span class="p">,</span> <span class="p">(</span><span class="n">req</span><span class="p">,)</span> <span class="o">=</span> <span class="n">request_eumetsat</span>
<span class="n">eumetsat_clim_kwargs</span> <span class="o">=</span> <span class="n">io_kwargs</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;drop_variables&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="s2">&quot;type&quot;</span><span class="p">,</span>
        <span class="s1">&#39;total_standard_error&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Lambert_Azimuthal_Grid&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status_flag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;raw_ice_conc_values&#39;</span><span class="p">,</span>
        <span class="s1">&#39;smearing_standard_error&#39;</span><span class="p">,</span>
        <span class="s1">&#39;algorithm_standard_error&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;transform_func&quot;</span><span class="p">:</span> <span class="n">compute_monthly_climatology</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">datasets_eumetsat</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">year1</span> <span class="ow">in</span> <span class="n">decades_historical</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">year1</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_monthly_climatology_eumetsat</span><span class="p">(</span>
            <span class="p">(</span><span class="n">cid</span><span class="p">,</span> <span class="n">req</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">}),</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year1</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">clim_months</span><span class="p">,</span> <span class="o">**</span><span class="n">eumetsat_clim_kwargs</span><span class="p">,</span>
        <span class="p">)]</span>
    <span class="n">datasets_eumetsat</span><span class="p">[</span><span class="n">region_name_mapper</span><span class="p">[</span><span class="n">region</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-the-mean-climatology-for-the-historical-cmip6-experiment">
<h4>2.4 Download the mean climatology for the historical CMIP6 experiment<a class="headerlink" href="#download-the-mean-climatology-for-the-historical-cmip6-experiment" title="Link to this heading">#</a></h4>
<p>We use all models in the historical experiment to get the ensemble mean and get the climatology for one region and decade at a time to see the spatial distribution of the bias when compared to satellite estimates, and to see how the bias develops with time.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hide-output</span>
<span class="n">datasets_cmip6</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="n">cmip6_clim_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="o">**</span><span class="n">io_kwargs</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_monthly_climatology</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="o">**</span><span class="n">interpolation_kwargs</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">year1</span> <span class="ow">in</span> <span class="n">decades_historical</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="w"> </span><span class="si">= }</span><span class="s2">, </span><span class="si">{</span><span class="n">year1</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">tmp_datasets</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_monthly_climatologies_cmip6</span><span class="p">(</span>
            <span class="n">models</span><span class="p">,</span> <span class="n">request_cmip6_historical</span><span class="p">,</span> <span class="n">year1</span><span class="p">,</span> <span class="n">year1</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">clim_months</span><span class="p">,</span> <span class="o">**</span><span class="n">cmip6_clim_kwargs</span><span class="p">,</span>
        <span class="p">)]</span>
    <span class="n">datasets_cmip6</span><span class="p">[</span><span class="n">region_name_mapper</span><span class="p">[</span><span class="n">region</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tmp_datasets</span><span class="p">)</span>
    <span class="n">tmp_datasets</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># set some options for plotting the climatologies</span>
<span class="n">map_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;datasets_eumetsat&quot;</span><span class="p">:</span> <span class="n">datasets_eumetsat</span><span class="p">,</span>
    <span class="s2">&quot;datasets_cmip6&quot;</span><span class="p">:</span> <span class="n">datasets_cmip6</span><span class="p">,</span>
    <span class="s2">&quot;projections&quot;</span><span class="p">:</span> <span class="n">projections</span><span class="p">,</span>
    <span class="s2">&quot;map_slices&quot;</span><span class="p">:</span> <span class="n">map_slices</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="results">
<span id="climate-projections-cmip6-model-performance-q02-section-3"></span><h3>3. Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<section id="time-series-of-evaluation-metrics">
<span id="climate-projections-cmip6-model-performance-q02-section-3-1"></span><h4>3.1 Time series of evaluation metrics<a class="headerlink" href="#time-series-of-evaluation-metrics" title="Link to this heading">#</a></h4>
<p>The evalution metrics that will be the most important here are the IIEE and the bias in extent, as the determination of the presence or absence of ice from passive microwave is more reliable than the actual value of the concentration derived from it. In particular, there is systematic underestimation of the concentration. This is especially true in summer due to meltponds for example, but it is also true in winter where the EUMETSAT OSI-SAF product usually estimates about 90% concentration in the Arctic pack (when it is very close to 100%, as can be seen from SAR images for example). The ESA CCI product which has a smaller footprint usually estimates a higher concentration than EUMETSAF OSI-SAF in the Arctic pack. Nevertheless it is still interesting to look at the area-weighted bias and RMSE in concentration itself - for example an underestimation of concentration would generally be undesirable for a model. The plots show the median and inter-quartile limits (IQL) to show the spread of our ensemble of CMIP6 models (all those that output sea ice concentration in the historical experiment).</p>
<p>The IIEE for the CMIP6 models is quite high, being about <span class="math notranslate nohighlight">\(2\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in the Arctic and twice this in the Antarctic. (Refer to the sea ice diagnostics notebook which shows the historical Arctic minimum extent is about <span class="math notranslate nohighlight">\(8\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span>.) The bias in Arctic extent is not too high, although it is quite variable. For Antarctica however it is quite high, underestimating it by about <span class="math notranslate nohighlight">\(4\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> by 2015 (growing from around <span class="math notranslate nohighlight">\(1\times10^6\)</span>km<span class="math notranslate nohighlight">\(^2\)</span> in 1980).</p>
<p>The bias for the concentration itself is quite low for CMIP6, being well within the limits of the observation error. There is a clear tendency for underestimation by CMIP6 in Antarctica though, with the bias dropping linearly. The RMS error for CMIP6 is also very high, indicating a different spatial distribution to the satellite data, since the bias was not too high.</p>
<p>We will take a look at the spatial distribution more closely in the next section.</p>
<p>Finally we note that when the ESA-CCI and EUMETSAT OSI-SAF products overlap in time (after 2002), the metrics for CMIP6 are quite similar.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">plot_timeseries</span><span class="p">(</span><span class="n">ds_cmip6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/c160f065d0e7bd1e04b85f8a9b45720381063c56e37ac567722edf49db53df99.png" src="../../_images/c160f065d0e7bd1e04b85f8a9b45720381063c56e37ac567722edf49db53df99.png" />
</div>
</div>
</section>
<section id="spatial-distribution-of-errors">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2"></span><h4>3.2 Spatial distribution of errors<a class="headerlink" href="#spatial-distribution-of-errors" title="Link to this heading">#</a></h4>
<p>We compare 10-year-averaged maps from 1985-2015 which is roughly the overlap period between the historical experiment and the EUMETSAT OSI-SAF product. In the Arctic, the mean concentration is quite close to the mean from observations, but there is disagreement in the seas with seaonal ice - e.g. Greenland, Barents, Labrador, Bering and Okhotsk Seas and Hudson Bay, and (in the summer) off the Russian and Alaskan coasts. For the Antarctic there is systematic underestimation of concentration.</p>
</section>
<section id="arctic-minimum">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2-1"></span><h4>3.2.1 Arctic minimum<a class="headerlink" href="#arctic-minimum" title="Link to this heading">#</a></h4>
<p>Looking at the maps below for September, we can see there is a general underestimation in the pack ice and an overestimation in the MIZ and near the coasts. This pattern persists with time although the locations move as the Arctic ice cover shrinks with time. This may be a resolution effect, since roughly the same amount of ice (low bias in sea ice concentration) may just be being spread out over a larger area.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/3d5a4c515550bc4d1530f9f6f3bd555af94476a7e4aeef2a38aa3f950b3c39b9.png" src="../../_images/3d5a4c515550bc4d1530f9f6f3bd555af94476a7e4aeef2a38aa3f950b3c39b9.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_bias_maps</span><span class="p">,</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7518d79e6921062e84f688e99a2276b2dce5477f9ef36e609bc02f8c6283a6df.png" src="../../_images/7518d79e6921062e84f688e99a2276b2dce5477f9ef36e609bc02f8c6283a6df.png" />
</div>
</div>
</section>
<section id="arctic-maximum">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2-2"></span><h4>3.2.2 Arctic maximum<a class="headerlink" href="#arctic-maximum" title="Link to this heading">#</a></h4>
<p>Looking at the maps below for March, we can see the ice in the central Arctic is generally unbiased, but there are some areas where there is strong underestimation - the Bering Sea and the Sea of Okhotsk - and there is strong overestimation in the Greenland Sea and the North Atlantic Ocean near the entrance to Hudson Bay. Overall, the total ice area is roughly the same in CMIP6 and the satellite observations.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/f5334cce5d76da89b11f1cf6b77db271e1ee2e4627d60dcf646eb2f3b32d4421.png" src="../../_images/f5334cce5d76da89b11f1cf6b77db271e1ee2e4627d60dcf646eb2f3b32d4421.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_bias_maps</span><span class="p">,</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/a0fcff5fc6ab519f155fe44f5248069dc33590d0069ddce710cd217dff7bfe14.png" src="../../_images/a0fcff5fc6ab519f155fe44f5248069dc33590d0069ddce710cd217dff7bfe14.png" />
</div>
</div>
</section>
<section id="antarctic-minimum">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2-3"></span><h4>3.2.3 Antarctic minimum<a class="headerlink" href="#antarctic-minimum" title="Link to this heading">#</a></h4>
<p>There is consistently too little ice on the Atlantic side of Antarctica (in the Weddell, Bellingshausen and Amundsen Seas). The amount of sea ice in those areas is also decreasing with time, while the concentration from satellite is staying relatively constant. On the Pacific and Indian ocean sides there is more of a dipole pattern (too little at the coast and too much away from it), probably due to the effect of low resolution in the CMIP6 models.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/4eaac4ec8a3d220c6b5368e3a8259af8b1dbaa26fda747e25b92d91d44de83fc.png" src="../../_images/4eaac4ec8a3d220c6b5368e3a8259af8b1dbaa26fda747e25b92d91d44de83fc.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;March&quot;</span><span class="p">},</span> <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_bias_maps</span><span class="p">,</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/019b8cb68bf16e359d3002843a965b0807b46f09d60c4dbd191ea907f47ab387.png" src="../../_images/019b8cb68bf16e359d3002843a965b0807b46f09d60c4dbd191ea907f47ab387.png" />
</div>
</div>
</section>
<section id="antarctic-maximum">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2-4"></span><h4>3.2.4 Antarctic maximum<a class="headerlink" href="#antarctic-maximum" title="Link to this heading">#</a></h4>
<p>For the month of September there is in general too little ice everywhere, although away from the coast at longitude about 140<span class="math notranslate nohighlight">\(^\circ\)</span>W in the Atlantic Ocean, and in the Indian Ocean the underestimation is most pronounced. The underestimation on those areas is also increasing with time, while the concentration from satellite is staying relatively constant in this month as well.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/d9ca018e52892bfd45c86e018f364f42afe22112caa3fcf0079320923a6f2a7d.png" src="../../_images/d9ca018e52892bfd45c86e018f364f42afe22112caa3fcf0079320923a6f2a7d.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Antarctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;September&quot;</span><span class="p">},</span>
                 <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_bias_maps</span><span class="p">,</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b242f0841221a4332dcc668ca1e0f0c7c4fa6130e5ecb7714838c8fa95fab246.png" src="../../_images/b242f0841221a4332dcc668ca1e0f0c7c4fa6130e5ecb7714838c8fa95fab246.png" />
</div>
</div>
</section>
<section id="arctic-december-relevant-to-the-arctic-shipping-route-assessment">
<span id="climate-projections-cmip6-model-performance-q02-section-3-2-5"></span><h4>3.2.5 Arctic December (relevant to the Arctic shipping route assessment)<a class="headerlink" href="#arctic-december-relevant-to-the-arctic-shipping-route-assessment" title="Link to this heading">#</a></h4>
<p>One of the other CMIP6 quality assessments looks at projections of accessibility of Arctic shipping routes, where sea ice in December is particularly interesting. Hence we also plot some maps for this month here. The CMIP6 ensemble mean is quite close to the satellite data in the Arctic Ocean, with the main feature of the bias maps being the underestimation in the Hudson Bay. Note that not all models that provide  sea ice concentration in the historical experiment also provide it in the different projection experiments, so that adds some additional uncertainty to these conclusions.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;December&quot;</span><span class="p">},</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b2036f324b045e87da9aaeeab8a3436a464305e62a88276f353cf3f87279e4dc.png" src="../../_images/b2036f324b045e87da9aaeeab8a3436a464305e62a88276f353cf3f87279e4dc.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compare_sic_maps</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;Arctic&quot;</span><span class="p">,</span> <span class="n">sel_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="s2">&quot;December&quot;</span><span class="p">},</span>
                 <span class="n">plot_func</span><span class="o">=</span><span class="n">make_sic_bias_maps</span><span class="p">,</span> <span class="o">**</span><span class="n">map_kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/7eca8b6a4c52646f84853a874c9e60a3c1941c99f4ccdf272e5446a5e90371fe.png" src="../../_images/7eca8b6a4c52646f84853a874c9e60a3c1941c99f4ccdf272e5446a5e90371fe.png" />
</div>
</div>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>Introductory sea ice materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.epa.gov/climate-indicators/climate-change-indicators-arctic-sea-ice">Role of sea ice in the climate</a></p></li>
<li><p><a class="reference external" href="https://www.metoffice.gov.uk/research/climate/cryosphere-oceans/sea-ice/measure">Observing sea ice with satellites</a></p></li>
</ul>
<p>Introductory CMIP6 materials:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.wcrp-climate.org/wgcm-cmip/cmip-video">A short introduction to CMIP and CMIP6</a></p></li>
<li><p><a class="reference external" href="https://www.carbonbrief.org/cmip6-the-next-generation-of-climate-models-explained/">CMIP6: the next generation of climate models explained</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a> developed by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Davy, R., and S. Outten (2020). The Arctic Surface Climate in CMIP6: Status and Developments since CMIP5. J. Climate, 33, 8047–8068, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-19-0990.1">https://doi.org/10.1175/JCLI-D-19-0990.1</a></p></li>
<li><p>Frankignoul, C., L. Raillard, B. Ferster, and Y. Kwon (2024). Arctic September sea ice concentration biases in CMIP6 models and their relationships with other model variables. J. Climate, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-23-0452.1">https://doi.org/10.1175/JCLI-D-23-0452.1</a>, in press.</p></li>
<li><p>Goessling, H. F., S. Tietsche, J. J. Day, E. Hawkins, and T. Jung (2016). Predictability of the Arctic sea ice edge, Geophys. Res. Lett., 43, 1642–1650, <a class="reference external" href="https://doi.org/10.1002/2015GL067232">https://doi.org/10.1002/2015GL067232</a></p></li>
<li><p>Henke, M., F. Cassalho, T. Miesse, C. M. Ferreira, J. Zhang and T. M. Ravens (2023). Assessment of Arctic sea ice and surface climate conditions in nine CMIP6 climate models. Arctic, Antarctic, and Alpine Research, 55(1). <a class="reference external" href="https://doi.org/10.1080/15230430.2023.2271592">https://doi.org/10.1080/15230430.2023.2271592</a></p></li>
<li><p>Nie, Y., X. Lin,  Q. Yang, J. Liu, D. Chen and P. Uotila (2023). Differences between the CMIP5 and CMIP6 Antarctic sea ice concentration budgets. Geophysical Research Letters, 50, e2023GL105265. <a class="reference external" href="https://doi.org/10.1029/2023GL105265">https://doi.org/10.1029/2023GL105265</a></p></li>
<li><p>Li, S., Y. Zhang, C. Chen, Y. Zhang, D. Xu, and S. Hu (2023). Assessment of Antarctic Sea Ice Cover in CMIP6 Prediction with Comparison to AMSR2 during 2015–2021. Remote Sensing 15(8): 2048. <a class="reference external" href="https://doi.org/10.3390/rs15082048">https://doi.org/10.3390/rs15082048</a></p></li>
<li><p>Roach, L. A., J. Dörr, C. R. Holmes, F. Massonnet, E. W. Blockley, D. Notz, T. Rackow, M. N. Raphael, S. P. O’Farrell, D. A. Bailey, and C. M. Bitz (2020). Antarctic sea ice area in CMIP6. Geophysical Research Letters, 47, e2019GL086729. <a class="reference external" href="https://doi.org/10.1029/2019GL086729">https://doi.org/10.1029/2019GL086729</a></p></li>
<li><p>Shu, Q., Q. Wang, Z. Song, F. Qiao, J. Zhao, M. Chu and X. Li (2020). Assessment of sea ice extent in CMIP6 with comparison to observations and CMIP5. Geophysical Research Letters, 47, e2020GL087965, <a class="reference external" href="https://doi.org/10.1029/2020GL087965">https://doi.org/10.1029/2020GL087965</a></p></li>
<li><p>SIMIP Community (2020). Arctic sea ice in CMIP6. Geophysical Research Letters, 47, e2019GL086749. <a class="reference external" href="https://doi.org/10.1029/2019GL086749">https://doi.org/10.1029/2019GL086749</a></p></li>
<li><p>Watts, M., W. Maslowski, Y. J. Lee, J. C. Kinney, and R. Osinski (2021). A Spatial Evaluation of Arctic Sea Ice and Regional Limitations in CMIP6 Historical Simulations. J. Climate, 34, 6399–6420, <a class="reference external" href="https://doi.org/10.1175/JCLI-D-20-0491.1">https://doi.org/10.1175/JCLI-D-20-0491.1</a></p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Climate_Projections/CMIP6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="climate_projections-cmip6_climate-impact-indicators_q04.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.1.7. </span>Projections of future ice-free periods for the Arctic and Antarctic</p>
      </div>
    </a>
    <a class="right-next"
       href="climate_projections-cmip6_model-performance_q03.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.1.9. </span>Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-scientific-assessment-of-sea-ice-extent-in-cmip6-models-to-inform-product-creation">🌍 Use case: Scientific assessment of sea ice extent in CMIP6 models to inform product creation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-question">❓ Quality assessment question</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-set-parameters-and-definitions-of-functions">1. Import libraries, set parameters and definitions of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1.1 Import libraries</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-parameters">1.2 Set parameters</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-requests-for-cds-data">1.3 Define requests for CDS data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-create-the-time-series">1.4 Functions to create the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-and-plotting-of-the-time-series">1.5 Post-processing and plotting of the time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-to-compute-the-climatologies">1.6 Functions to compute the climatologies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#post-processing-and-plotting-of-climatologies">1.7 Post-processing and plotting of climatologies</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-data">2. Download and transform data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-parameters-for-downloading">2.1 Set some parameters for downloading</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-transform-cmip6-data-for-time-series">2.2 Download and transform CMIP6 data for time series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-eumetsat-osi-saf-climatology">2.3 Download EUMETSAT OSI-SAF climatology</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-mean-climatology-for-the-historical-cmip6-experiment">2.4 Download the mean climatology for the historical CMIP6 experiment</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">3. Results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-of-evaluation-metrics">3.1 Time series of evaluation metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-distribution-of-errors">3.2 Spatial distribution of errors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-minimum">3.2.1 Arctic minimum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-maximum">3.2.2 Arctic maximum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-minimum">3.2.3 Antarctic minimum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#antarctic-maximum">3.2.4 Antarctic maximum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#arctic-december-relevant-to-the-arctic-shipping-route-assessment">3.2.5 Arctic December (relevant to the Arctic shipping route assessment)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>