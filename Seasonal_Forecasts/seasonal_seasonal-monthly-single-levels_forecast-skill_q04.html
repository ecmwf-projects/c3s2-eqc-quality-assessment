
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04';</script>
    <link rel="icon" href="../_static/C3S_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.3. Assessing possible outcomes of seasonal temperature forecast" href="seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html" />
    <link rel="prev" title="4.1. Seasonal forecasts bias assessment for impact models" href="seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="eqcbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Satellite_ECVs/satellite.html">1. Quality assessments for Satellite Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-aerosol-properties_consistency_q01.html">1.2.1. Assessment of Seasonal Variability and Completeness of Aerosol Optical Depth from SLSTR Satellite Data (2017-2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.2. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-carbon-dioxide_uncertainty-quality-flags_q02.html">1.2.3. Spatial and temporal completeness and uncertainties of carbon dioxide satellite observations for quantifying atmospheric greenhouse gas variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_uncertainty_q01.html">1.2.4. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Atmospheric_Composition/satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.5. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/satellite_derived-gridded-glacier-mass-change_data-completeness_q01.html">1.3.1. Glacier mass change data from satellite and in-situ observations: uncertainty analysis for glaciological and climate change monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_consistency-assessment_q02.html">1.3.2. Spatio-temporal data completeness and consistency of remote sensing-derived ice sheet surface elevation changes over Antarctica</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.3. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Cryosphere/satellite_satellite-ice-sheet-mass-balance_trend-assessment_q02.html">1.3.4. Gravimetric mass balance data from satellite observations: utility analysis for mass change monitoring of the ice sheets</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Satellite_ECVs/Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.6.2. Intercomparison of satellite multi-year sea ice extent estimates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.3. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.4. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.5. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Satellite_ECVs/Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.6. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Indicators</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Indicators/indicator.html">6. Quality assessments for Climate Indicators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Derived Datasets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Derived_Datasets/derived.html">7. Quality assessments for Derived Datasets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Applications/application.html">8. Quality assessments for C3S Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSeasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-a-national-hydro-met-service-informing-decisions-in-agricultural-or-energy-applications">🌍 Use case: A national hydro-met service informing decisions in agricultural or energy applications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters-describing-regions-variables-and-data">Define parameters describing regions, variables, and data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-chosen-regions">Plot the chosen regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-required-functions">Define the required functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-data">2. Download and process data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-era5">Download and process ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-seasonal-forecasts">Download and process seasonal forecasts</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-score-analysis">3. Hit-score analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-terciles">Analysis of terciles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-hit-score-and-show-a-sample-plot">Compute hit-score and show a sample plot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">4. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-rate-for-2-m-temperature">Hit-rate for 2 m temperature</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-rate-for-other-variables">Hit-rate for other variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="evaluation-of-the-hit-rate-of-seasonal-forecasts-for-tercile-categories-of-monthly-anomalies">
<h1><span class="section-number">4.2. </span>Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies<a class="headerlink" href="#evaluation-of-the-hit-rate-of-seasonal-forecasts-for-tercile-categories-of-monthly-anomalies" title="Link to this heading">#</a></h1>
<p>Production date: 30/05/2024</p>
<p>Produced by: Sandro Calmanti (ENEA), Alessandro Dell’Aquila (ENEA)</p>
<section id="use-case-a-national-hydro-met-service-informing-decisions-in-agricultural-or-energy-applications">
<h2>🌍 Use case: A national hydro-met service informing decisions in agricultural or energy applications<a class="headerlink" href="#use-case-a-national-hydro-met-service-informing-decisions-in-agricultural-or-energy-applications" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>❓ Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>What are the hit-rates for terciles categories in seasonal forecasts for anomalies above/below normal?</strong></p></li>
<li><p><strong>Can I use information from seasonal forecasts of monthly anomalies to make decisions?</strong></p></li>
</ul>
<p>Seasonal forecasts are not deterministic: they are not expected to provide quantitative information on the value of climate parameters with an attached error bar.</p>
<p>Instead, <strong>seasonal forecasts are probabilistic</strong>: they provide information on how climate parameters are expected to change over the coming months, compared to climatology, in terms of their main statistical aspects, given the current state of the climate system.</p>
<p>A key issue regarding the usability of seasonal forecasts is that end-users do not always have a way to incorporate a probability distribution function (PDF) related to a climate variability in their decision workflow. Many practical decisions, for which seasonal forecast might be beneficial require some form of binary choice <a class="reference external" href="https://doi.org/10.1016/j.cliser.2024.100496" rel="noreferrer" target="_blank">[1]</a>, for example:</p>
<ul class="simple">
<li><p>Do I have to plan for an anticipated harvest?</p></li>
<li><p>Do I have to choose the long-cycle or short-cycle maize variety for the coming season?</p></li>
<li><p>Will the coming season allow a reduced number of treatments for my crops?</p></li>
<li><p>Do I have to purchase in advance, and at a lower price, an extra stock of dispatchable energy for air conditioning?</p></li>
</ul>
<p>This notebook focuses on the <strong>hit-rate</strong> for terciles categories in seasonal forecasts, a simple yet fundamental building block for measuring the quality, and potential value, of seasonal forecasts.</p>
<p>The hit-rate (also mentioned sometimes as <em>hit-score</em>) addresses the key question: how often did the forecasted category with the highest probability actually occur? As such, the hit-rate for terciles categories describes a basic attribute of probabilistic forecasts, i.e. that the outcome of a given season is expected to differ from the normal if the forecast differs from the normal. This characteristic of probabilistic forecasts is called <strong>resolution</strong>.</p>
<p>A complementary aspect in describing the quality of seasonal forecasts is <strong>discrimination</strong>, which is the answer to the opposite question: do the forecasts differ when the outcome differ? As an example if, on average, a forecasting system issues always the same forecast, regardless of the expected outcome, there can be some <em>hits</em> in the forecast but, at the same time, the forecast would not be able to discriminate the occurrence of an event from a non-event. Discrimination is best measured by <strong>Relative Operating Characteristic (ROC)</strong> scores.</p>
<p>As long as there is some resolution or discrimination, there is a potential to extract some valuable information from the forecasts.</p>
<p>Indeed, the WMO <a class="reference external" href="https://library.wmo.int/idurl/4/56227" rel="noreferrer" target="_blank">Guidance on Verification of Operational Seasonal Climate Forecasts</a> highlights how the use of generalised methodologies for the assessment of seasonal forecasts sometimes represent limited attraction for new users. Therefore, the <a class="reference external" href="https://library.wmo.int/idurl/4/56227" rel="noreferrer" target="_blank">Guidance</a> recommends a range of methodologies of increasing complexity, including very simple ones like the hit-rate, which are particularly useful for introducing the potential value of seasonal forecasts to non-specialists.</p>
</section>
<section id="quality-assessment-statement">
<h2>📢 Quality assessment statement<a class="headerlink" href="#quality-assessment-statement" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The hit-rate for terciles cetegories of seasonal forecasts in predicting anomalies at a monthly time-scale depends significantly on the variable and on the region of interest.</p></li>
<li><p>The hit-rates for terciles of different variables do not depend significantly on the forecasting system.</p></li>
<li><p>The larger hit-rates for terciles of monthly anomalies (above 70%) are for 2m temperatures in regions surrounding the Pacific, under the direct influence of El Niño <a class="reference external" href="https://doi.org/10.1038/s41612-023-00519-8" rel="noreferrer" target="_blank">[2]</a>.</p></li>
<li><p>The usability and value of seasonal forecasts must be assessed on a case-by-case basis, by explicitly accounting for the impact on the decision at stake <a class="reference external" href="https://doi.org/10.1002/wcc.523" rel="noreferrer" target="_blank">[3]</a>.</p></li>
</ul>
</div>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/a684544d-7232-4092-82a5-7ec01184a99a.png"><img alt="../_images/a684544d-7232-4092-82a5-7ec01184a99a.png" src="../_images/a684544d-7232-4092-82a5-7ec01184a99a.png" style="height: 500px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.2.1 </span><span class="caption-text">The figure shows a sample  of the hit-rate for terciles of ECMWF monthly anomalies for 2m temperature over South East Asia as a function of the starting month and of the valid month of the forecast. More details on how to interpret the results are available below in the notebook.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>This notebook provides a comprehensive assessment of the hit-rates for terciles on monthly anomalies of selected ECVs of the forecast systems by comparing the model predictions with the ERA5 reanalysis. The analysis is carried out for eight regions selected from those used in the IPCC-AR6 (see figure below) <a class="reference external" href="https://doi.org/10.1017/CBO9781139177245.006" rel="noreferrer" target="_blank">[4]</a>.</p>
<p>The computation of the hit-score is straightforward: the monthly values of the selected ECV (e.g. temperature)  are firstly divided in terciles (below normal, normal, above normal). Then, the hit-score is computed by counting the number of events when the most populated tercile derived from the distribution of the seasonal forecasts corresponds to the observed tercile of the target month.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-1"><span class="std std-ref">1. Choose the data to use and setup the code</span></a>:</strong></p>
<ul class="simple">
<li><p>Import required packages</p></li>
<li><p>Define parameters describing regions, variables, and data</p></li>
<li><p>Plot the chosen regions</p></li>
<li><p>Define functions for the tercile analysis</p></li>
<li><p>Define plot function</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-2"><span class="std std-ref">2. Download and process data</span></a>:</strong></p>
<ul class="simple">
<li><p>Download and process ERA5</p></li>
<li><p>Download and process seasonal forecast data</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-3"><span class="std std-ref">3. Hit-score analysis</span></a></strong></p>
<ul class="simple">
<li><p>Analysis of terciles</p></li>
<li><p>Compute hit-score and show a sample plot</p></li>
</ul>
<p><strong><a class="reference internal" href="#seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-4"><span class="std std-ref">4. Plot and describe results</span></a>:</strong></p>
<ul class="simple">
<li><p>Hit-rate for terciles of 2m temperature</p></li>
<li><p>Hit-rate for terciles of other variables</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-setup-the-code">
<span id="seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-1"></span><h3>1. Choose the data to use and setup the code<a class="headerlink" href="#choose-the-data-to-use-and-setup-the-code" title="Link to this heading">#</a></h3>
<section id="import-required-packages">
<h4>Import required packages<a class="headerlink" href="#import-required-packages" title="Link to this heading">#</a></h4>
<p>The package <code class="docutils literal notranslate"><span class="pre">regionmask</span></code> is used to mask out the SREX regions selected for the analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">plotly.figure_factory</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ff</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">regionmask</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">ListedColormap</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="define-parameters-describing-regions-variables-and-data">
<h4>Define parameters describing regions, variables, and data<a class="headerlink" href="#define-parameters-describing-regions-variables-and-data" title="Link to this heading">#</a></h4>
<p>The analysis of hit-scores is conducted over 5 different variables  for the 8 originating centres. The AR6 regions selected for the analysis are.</p>
<ul class="simple">
<li><p>NEAF: Northern-East Africa</p></li>
<li><p>ENA: Eastern North America</p></li>
<li><p>MED: Southern Europe/Mediterranean</p></li>
<li><p>NES: Eastern Coast of South America</p></li>
<li><p>SAS: Southern Asia</p></li>
<li><p>SEA: South-Eastern Asia</p></li>
<li><p>WNA: Western North America</p></li>
<li><p>NWS: Western Coast of South America</p></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">common_request</span></code> is defined to cover the entire global domain and the entire hindcast period from 1993 to 2016. Specific data requests are then defined for the reanalysis and for the seasonal forecasts, so that all available months and lead times are retrieved for the analysis.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time</span>
<span class="n">year_start_hindcast</span> <span class="o">=</span> <span class="mi">1993</span>
<span class="n">year_stop_hindcast</span> <span class="o">=</span> <span class="mi">2016</span>

<span class="c1"># Detrend timeseries</span>
<span class="n">detrend</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">detrend</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>

<span class="c1"># Variable</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;2m_temperature&quot;</span><span class="p">,</span>
    <span class="s2">&quot;total_precipitation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;surface_solar_radiation_downwards&quot;</span><span class="p">,</span>
    <span class="s2">&quot;10m_wind_speed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2m_dewpoint_temperature&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Define centres with missing variables</span>
<span class="n">missing_variables</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;eccc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2m_dewpoint_temperature&quot;</span><span class="p">]}</span>

<span class="c1"># Centres</span>
<span class="n">centres</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cmcc&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;35&quot;</span><span class="p">},</span>
    <span class="s2">&quot;dwd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;21&quot;</span><span class="p">},</span>
    <span class="s2">&quot;eccc&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
    <span class="s2">&quot;ecmwf&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;51&quot;</span><span class="p">},</span>
    <span class="s2">&quot;jma&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">},</span>
    <span class="s2">&quot;meteo_france&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span><span class="p">},</span>
    <span class="s2">&quot;ncep&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">},</span>
    <span class="s2">&quot;ukmo&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;system&quot;</span><span class="p">:</span> <span class="s2">&quot;601&quot;</span><span class="p">},</span>
<span class="p">}</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="s2">&quot;system&quot;</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">centres</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">centres</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">{</span>
    <span class="s2">&quot;cmcc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dwd&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eccc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ecmwf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;jma&quot;</span><span class="p">,</span>
    <span class="s2">&quot;meteo_france&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ncep&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ukmo&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Regions</span>
<span class="n">defined_regions_module_name</span> <span class="o">=</span> <span class="s2">&quot;ar6.land&quot;</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;ENA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MED&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NEAF&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NES&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NWS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SAS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SEA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;WNA&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="c1"># Define data requests</span>
<span class="n">chunks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">common_request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;grib&quot;</span><span class="p">,</span>
    <span class="s2">&quot;area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">89.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">179.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.5</span><span class="p">,</span> <span class="mf">179.5</span><span class="p">],</span>
    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">year_start_hindcast</span><span class="p">,</span> <span class="n">year_stop_hindcast</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<span class="p">}</span>

<span class="n">collection_id_reanalysis</span> <span class="o">=</span> <span class="s2">&quot;reanalysis-era5-single-levels-monthly-means&quot;</span>
<span class="n">request_reanalysis</span> <span class="o">=</span> <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_averaged_reanalysis&quot;</span><span class="p">,</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;00:00&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">collection_id_seasonal</span> <span class="o">=</span> <span class="s2">&quot;seasonal-monthly-single-levels&quot;</span>
<span class="n">request_seasonal</span> <span class="o">=</span> <span class="n">common_request</span> <span class="o">|</span> <span class="p">{</span>
    <span class="s2">&quot;product_type&quot;</span><span class="p">:</span> <span class="s2">&quot;monthly_mean&quot;</span><span class="p">,</span>
    <span class="s2">&quot;leadtime_month&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">))),</span>
    <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">month</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)],</span>
    <span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="s2">&quot;1/1&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="plot-the-chosen-regions">
<h4>Plot the chosen regions<a class="headerlink" href="#plot-the-chosen-regions" title="Link to this heading">#</a></h4>
<p>For the bias analysis we use 8 out of the 46 AR6 regions defined in the <code class="docutils literal notranslate"><span class="pre">regionmask</span></code> package in order to assess the systematic errors of the modelling systems under different climatic regimes (tropical, extratropical, continental, maritime) with a number of cases manageable within the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_defined_regions</span><span class="p">(</span><span class="n">defined_regions_module_name</span><span class="p">):</span>
    <span class="n">defined_regions</span> <span class="o">=</span> <span class="n">regionmask</span><span class="o">.</span><span class="n">defined_regions</span>
    <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">defined_regions_module_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
        <span class="n">defined_regions</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">defined_regions</span><span class="p">,</span> <span class="n">module</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">defined_regions</span>


<span class="n">defined_regions</span> <span class="o">=</span> <span class="n">get_defined_regions</span><span class="p">(</span><span class="n">defined_regions_module_name</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">defined_regions</span><span class="o">.</span><span class="n">abbrevs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">defined_regions</span><span class="p">[</span><span class="n">regions</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;abbrev&quot;</span><span class="p">,</span>
    <span class="n">add_ocean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/9080e79adaa73940aaae64eb0cc72061f6f643c7c2ac9bdca7d0497afe1299c0.png" src="../_images/9080e79adaa73940aaae64eb0cc72061f6f643c7c2ac9bdca7d0497afe1299c0.png" />
</div>
</div>
</section>
<section id="define-the-required-functions">
<h4>Define the required functions<a class="headerlink" href="#define-the-required-functions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>The function <code class="docutils literal notranslate"><span class="pre">reindex_seasonal_forecast</span></code> is necessary in the tercile analysis to align the valid time of the forecast to the corresponding date in the reanalysis.</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">tercile_analysis</span></code> converts the value of both ERA5 data and seasonal forecast data into the corresponding tercile value, which corresponds to below normal, normal, and above normal. The processing of ERA5 and of seasonal forecasts is detailed below.</p></li>
</ul>
<p><strong>Processing of ERA5</strong></p>
<ol class="arabic simple">
<li><p>Compute the mean monthly temperature from the reanalysis over the selected AR6 regions.</p></li>
<li><p>If required, remove the linear trend to emphasise hit-scores associated to natural climate variability rather than to long-term tendencies. This step may be of interest for the analysis of hit-scores for temperature. By default, detrending is not applied in the analysis presented in this notebook. However, the code cell shows how to implement the detrending procedure.</p></li>
<li><p>For each month, and for each region, compute the values associated to the 33-th and 66-th percentile of the corresponding monthly distribution</p></li>
<li><p>Convert the series of mean monthly temperature anomalies over each region into the corresponding terciles, using the following conversion table:</p></li>
</ol>
<ul class="simple">
<li><p>-1 = below normal, values below the 33-th percentile</p></li>
<li><p>0 , values between the 33-th and the 66-th percentile</p></li>
<li><p>1 = above normal, values above the 33-th percentile</p></li>
</ul>
<p><strong>Processing of seasonal forecasts</strong></p>
<ol class="arabic simple">
<li><p>Apply step 1. as for ERA5 for each seasonal forecasting system. In this case there is a different temperature anomaly for each originating centre, starting time and valid time for the forecast.</p></li>
<li><p>If required, apply step 2. as for ERA5 to remove linear trends.</p></li>
<li><p>Apply step 3. as for ERA5 to obtain the position of the terciles for each originating centre and for each starting time and valid time. In this case, the underlying distribution for the computation of the terciles includes all years in the hindcast as well as all ensemble members. The 33-th and 66-th percentiles depend on the lead-time, i.e. the difference between valid time and starting time, so that the analysis accounts for potential model drifts. In the present analysis, we consider a maximum lead-time of six months.</p></li>
<li><p>Apply step 4. as for ERA5 to convert temperature anomalies into the corresponding terciles for all regions, for all time months and valid time, and for each member of the ensemble forecast.</p></li>
<li><p>For seasonal forecasts the most likely tercile in the forecast is derived by computing the mode of the terciles (step 3) over all the ensemble members. The most likely terciles is an array whose dimensions are the originating centres, the region, the starting time and the valid time.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">mode</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">mode</span>


<span class="k">def</span><span class="w"> </span><span class="nf">reindex_seasonal_forecast</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># Stack starting_time and leading_month</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;starting_time&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
        <span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;starting_time&quot;</span><span class="p">,</span> <span class="s2">&quot;leadtime_month&quot;</span><span class="p">),</span>
        <span class="n">create_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Shift valid_time</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">&quot;starting_time&quot;</span><span class="p">)</span>
    <span class="n">valid_time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;leadtime_month&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">shifted</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">shift</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;MS&quot;</span><span class="p">)</span>
        <span class="n">valid_time</span> <span class="o">=</span> <span class="n">valid_time</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;leadtime_month&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">shift</span><span class="p">,</span> <span class="n">shifted</span><span class="p">)</span>

    <span class="c1"># Reindex: valid_time and starting_month</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;valid_time&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">valid_time</span><span class="p">),</span>
        <span class="s2">&quot;starting_month&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">)})</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_tercile_analysis</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span> <span class="s2">&quot;RdYlBu_r&quot;</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">cbar_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">]}</span>

    <span class="n">plot_obj</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">plot_obj</span><span class="o">.</span><span class="n">cbar</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plot_obj</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">facetgrid</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">plot_obj</span><span class="o">.</span><span class="n">colorbar</span>
    <span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;Below normal&quot;</span><span class="p">,</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span> <span class="s2">&quot;Above Normal&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">plot_obj</span>

<span class="k">def</span><span class="w"> </span><span class="nf">tercile_analysis</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">defined_regions_module_name</span><span class="p">,</span> <span class="n">detrend</span><span class="p">):</span>
    <span class="c1"># Mask region</span>
    <span class="n">defined_regions</span> <span class="o">=</span> <span class="n">get_defined_regions</span><span class="p">(</span><span class="n">defined_regions_module_name</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">defined_regions</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">defined_regions</span><span class="o">.</span><span class="n">map_keys</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">mask</span> <span class="o">==</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">])</span>

    <span class="c1"># Spatial mean</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;leadtime_month&quot;</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">reindex_seasonal_forecast</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">forecast_reference_time</span><span class="o">=</span><span class="s2">&quot;valid_time&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">detrend</span><span class="p">:</span>
        <span class="c1"># Detrend timeseries</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;valid_time&quot;</span><span class="p">]</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days_in_month</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">var</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_polyfit_coefficients&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">fit</span><span class="o">.</span><span class="n">data_vars</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">ds</span> <span class="o">-=</span> <span class="n">xr</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">fit</span><span class="p">)</span>

    <span class="c1"># Compute anomaly</span>
    <span class="n">climatology</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">time_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="s2">&quot;valid_time&quot;</span><span class="p">)</span>
    <span class="n">climatology</span> <span class="o">=</span> <span class="n">climatology</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">climatology</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s2">&quot;realization&quot;</span><span class="p">})</span>
    <span class="n">ds</span> <span class="o">-=</span> <span class="n">climatology</span>

    <span class="c1"># Reindex using valid year/month month</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;valid_time&quot;</span><span class="p">]</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;valid_year&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
        <span class="s2">&quot;valid_month&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">set_index</span><span class="p">({</span><span class="n">time</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">coords</span><span class="p">)})</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Get quantiles</span>
    <span class="n">quantiles</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">valid_year</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;valid_year&quot;</span><span class="p">)</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">quantiles</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">quantile</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">ds</span> <span class="o">&gt;=</span> <span class="n">low</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span> <span class="o">&gt;</span> <span class="n">high</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;realization&quot;</span> <span class="ow">in</span> <span class="n">mask</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="c1"># Get mode</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;realization&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mask</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="download-and-process-data">
<span id="seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-2"></span><h3>2. Download and process data<a class="headerlink" href="#download-and-process-data" title="Link to this heading">#</a></h3>
<section id="download-and-process-era5">
<h4>Download and process ERA5<a class="headerlink" href="#download-and-process-era5" title="Link to this heading">#</a></h4>
<p>ERA5 data are converted to tercile values by applying the function <code class="docutils literal notranslate"><span class="pre">tercile_analysis</span></code>. The outcome of the download and transform process is a three-dimensional array containing tercile values, i.e. (-1, 0, 1) for (”<em>Below normal</em>, <em>Normal</em>, <em>Above Normal</em>”) respectively, for each of the 8 regions, for 25 years and 12 months each year.</p>
<p>The final outcome of the tercile analysis for each variable is an array with the following dimensions:</p>
<blockquote>
<div><ul class="simple">
<li><p>valid_year: 25</p></li>
<li><p>valid_month: 12</p></li>
<li><p>region: 8</p></li>
</ul>
</div></blockquote>
<p>A separate array is created for each of the 5 selected variables. All arrays are assembled into a single <code class="docutils literal notranslate"><span class="pre">xarray</span></code> dataset for the following computation and visualisations steps.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the reanalysis data</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
    <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">variable</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
            <span class="n">collection_id_reanalysis</span><span class="p">,</span>
            <span class="n">request_reanalysis</span> <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">},</span>
            <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
            <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">transform_func</span><span class="o">=</span><span class="n">tercile_analysis</span><span class="p">,</span>
            <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
                <span class="s2">&quot;defined_regions_module_name&quot;</span><span class="p">:</span> <span class="n">defined_regions_module_name</span><span class="p">,</span>
                <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span>
    <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">ds_reanalysis</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
<span class="k">del</span> <span class="n">datasets</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="download-and-process-seasonal-forecasts">
<h4>Download and process seasonal forecasts<a class="headerlink" href="#download-and-process-seasonal-forecasts" title="Link to this heading">#</a></h4>
<p>Similarly to ERA5 data, seasonal forecast data are converted to tercile values by applying the function <code class="docutils literal notranslate"><span class="pre">tercile_analysis</span></code>. However, in this case the outcome of the download and transform process is a five-dimensional array: besides the 8 regions, 25 years and 12 months corresponding to the valid time of the forecasts, two additional dimensions are necessary to account for the 8 originating centres and for the 12 possible starting months of the forecast. For each starting month, there are 6 tercile values that correspond to the length of the forecast taken into account, whereas the tercile values for the other six months are set to Not-a-Number.</p>
<p>The final outcome of the tercile analysis for each variable is an array with the following dimensions:</p>
<blockquote>
<div><ul class="simple">
<li><p>valid_year: 25</p></li>
<li><p>valid_month: 12</p></li>
<li><p>starting_month: 12</p></li>
<li><p>region: 8</p></li>
<li><p>centre: 8</p></li>
</ul>
</div></blockquote>
<p>All arrays are assembled into a single <code class="docutils literal notranslate"><span class="pre">xarray</span></code> dataset containing all variables for the following computation and visualisations steps.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the seasonal forecast data - DETREND</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">centre</span><span class="p">,</span> <span class="n">request_kwargs</span> <span class="ow">in</span> <span class="n">centres</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
        <span class="n">dataarrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">centre</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">variable</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">missing_variables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">centre</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SKIP&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">TMPDIR</span><span class="p">:</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
                    <span class="n">collection_id_seasonal</span><span class="p">,</span>
                    <span class="n">request_seasonal</span>
                    <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;originating_centre&quot;</span><span class="p">:</span> <span class="n">centre</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">}</span>
                    <span class="o">|</span> <span class="n">request_kwargs</span><span class="p">,</span>
                    <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
                    <span class="n">transform_chunks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">transform_func</span><span class="o">=</span><span class="n">tercile_analysis</span><span class="p">,</span>
                    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
                        <span class="s2">&quot;defined_regions_module_name&quot;</span><span class="p">:</span> <span class="n">defined_regions_module_name</span><span class="p">,</span>
                        <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="n">backend_kwargs</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;time_dims&quot;</span><span class="p">:</span> <span class="p">(</span>
                            <span class="s2">&quot;forecastMonth&quot;</span><span class="p">,</span>
                            <span class="p">(</span>
                                <span class="s2">&quot;indexing_time&quot;</span>
                                <span class="k">if</span> <span class="n">centre</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ukmo&quot;</span><span class="p">,</span> <span class="s2">&quot;jma&quot;</span><span class="p">,</span> <span class="s2">&quot;ncep&quot;</span><span class="p">]</span>
                                <span class="k">else</span> <span class="s2">&quot;time&quot;</span>
                            <span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">},</span>
                <span class="p">)</span>
            <span class="p">(</span><span class="n">da</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="n">dataarrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataarrays</span><span class="p">)</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">centre</span><span class="o">=</span><span class="p">[</span><span class="n">centre</span><span class="p">]))</span>
<span class="n">ds_seasonal</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span>
<span class="k">del</span> <span class="n">datasets</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="hit-score-analysis">
<span id="seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-3"></span><h3>3. Hit-score analysis<a class="headerlink" href="#hit-score-analysis" title="Link to this heading">#</a></h3>
<section id="analysis-of-terciles">
<h4>Analysis of terciles<a class="headerlink" href="#analysis-of-terciles" title="Link to this heading">#</a></h4>
<p>Splitting the distribution of climate parameters into terciles is a simple way of converting probabilistic forecasts into binary information that a user of climate information can consult to make decisions.</p>
<p>For example, a user may ask whether the coming months will be warmer (or colder) than normal, and the answer would be “likely yes” or “likely no” depending on which is the most likely anomaly in the forecast. As a working hypothesis, it is reasonable to assume that specific actions are undertaken when a significant deviation from the norm is expected, for example planting a drought resistant but less productive maize variety if less rainfall than normal is expected, or purchasing in advance, and at a lower price, an extra stock of dispatchable energy for air conditioning systems if warmer than normal conditions are expected during summer.</p>
<p>For the analysis presented in this notebook, the forecasting system scores a hit if the observed monthly anomaly matches the corresponding forecast.</p>
<p>To illustrate how the hit-score analysis works, the three figures below show an example mean 2m temperature over South East Asia, using ECMWF System 5.1 as a sample seasonal forecast.</p>
<ul class="simple">
<li><p>The first figure shows a complete series of the terciles derived from ERA5 as a function of year and month. For example, the year 1998, during which a strong El Niño event has been registered, is characterised by a sequence of temperature anomalies above normal, starting from December 1997 to October 1998. Instead, the year 2008, a strong La Niña year, shows a sequence of below normal anomalies.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;2m_temperature&#39;</span>
<span class="n">centre</span><span class="o">=</span><span class="s1">&#39;ecmwf&#39;</span>
<span class="n">region</span><span class="o">=</span><span class="s1">&#39;SEA&#39;</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">region</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">centre</span> <span class="ow">in</span> <span class="n">centres</span><span class="p">)</span>

<span class="n">plot_tercile_analysis</span><span class="p">(</span>
    <span class="n">ds_reanalysis</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">xticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;ERA5&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/fd294214f5084bd296dbad62094b36fcf1b1e95dd23589c442b265acd1d726ce.png" src="../_images/fd294214f5084bd296dbad62094b36fcf1b1e95dd23589c442b265acd1d726ce.png" />
</div>
</div>
<ul class="simple">
<li><p>The second figure shows, read from below to the top, the tercile analysis for the seasonal forecasts issued during 1998. Each row in the panel corresponds to a single six-month forecast issued at the corresponding starting month on the vertical axis. For the year 1998 most of the forecast starts with a temperature anomaly above normal and persists in this status until the end of the six-month period. Forecasts starting at the end of the previous year, which are represented in the top-left corner of the panel, also start with a warm anomaly that persists throughout the forecast. Since 1998 was a warm year in this region, most of the monthly anomalies of 1998 count as a hit for the forecasts issued in 1998 at all lead times.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">year</span><span class="o">=</span><span class="mi">1998</span>
<span class="n">plot_tercile_analysis</span><span class="p">(</span>
    <span class="n">ds_seasonal</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span><span class="n">centre</span><span class="o">=</span><span class="n">centre</span><span class="p">,</span><span class="n">valid_year</span><span class="o">=</span><span class="n">year</span><span class="p">),</span>
    <span class="n">xticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
<span class="p">)</span>
<span class="c1">#plt.suptitle(&quot;ERA5&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/eee592d7dd4d22309b46a9528d2f09ac5e736b1a8cb896bcd6e11c0ba39ac9df.png" src="../_images/eee592d7dd4d22309b46a9528d2f09ac5e736b1a8cb896bcd6e11c0ba39ac9df.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/common/miniforge3/envs/wp3/lib/python3.11/site-packages/dask/core.py:127: RuntimeWarning: divide by zero encountered in divide
  return func(*(_execute_task(a, cache) for a in args))
/data/common/miniforge3/envs/wp3/lib/python3.11/site-packages/dask/core.py:127: RuntimeWarning: invalid value encountered in multiply
  return func(*(_execute_task(a, cache) for a in args))
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-hit-score-and-show-a-sample-plot">
<h4>Compute hit-score and show a sample plot<a class="headerlink" href="#compute-hit-score-and-show-a-sample-plot" title="Link to this heading">#</a></h4>
<p>By counting the number of hits for all available hindcasts and considering the hits on anomalies both above and below normal, it is possible to obtain a systematic assessment of the hit-rates for terciles on monthly anomalies. Similar hit-scores may also be considered, but for the categories with second- and third- highest probabilities. Other adjustments to the scores may be considered, as suggested by the <a class="reference external" href="https://library.wmo.int/idurl/4/56227" rel="noreferrer" target="_blank">WMO Guidance</a>, by assigning for example a half hit if one of two categories with tied highest probability verifies.</p>
<p>In this assessment we consider the simplest possible definition:</p>
<p><span class="math notranslate nohighlight">\(Hit \: rate = 100 * \frac{Number \: of \: hits}{Number \: of \: forecasts}\)</span></p>
<p>The figure below, which should be read from the bottom to the top, shows in each row the hit rate on monthly anomalies of the forecast starting from the corresponding month indicated on the vertical axis.</p>
<p>For example, the forecasts starting in June (month 6) have a hit-rate above 90% for the first month of the forecast, which is reduced to a value between 80% and 90% for the second month (July). During the following months (August to November) the hit-rate decreases further but remains mostly above 70%.</p>
<p>Note that the horizontal axis is periodic and the tiles in the top left corner of the panel represent the hit-rates for terciles of the forecasts started in August or later during the year.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute hit rates</span>
<span class="n">mask_threshold</span> <span class="o">=</span> <span class="mf">50.</span>
<span class="n">masked_ds_seasonal</span> <span class="o">=</span> <span class="n">ds_seasonal</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_seasonal</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">hit_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">masked_ds_seasonal</span> <span class="o">==</span> <span class="n">ds_reanalysis</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;valid_year&quot;</span><span class="p">)</span>
<span class="n">hit_rate</span> <span class="o">*=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">masked_ds_seasonal</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;valid_year&quot;</span><span class="p">)</span>

<span class="n">hit_rate_mask</span> <span class="o">=</span> <span class="n">hit_rate</span>
<span class="n">hit_rate_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">hit_rate</span> <span class="o">&lt;</span> <span class="n">mask_threshold</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hit_rate</span><span class="p">)</span>


<span class="c1"># Define the custom colormap</span>
<span class="n">hr_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#eeeeee&#39;</span><span class="p">,</span><span class="s1">&#39;#fcc5c0&#39;</span><span class="p">,</span><span class="s1">&#39;#fa9fb5&#39;</span><span class="p">,</span><span class="s1">&#39;#f768a1&#39;</span><span class="p">,</span><span class="s1">&#39;#c51b8a&#39;</span><span class="p">,</span><span class="s1">&#39;#7a0177&#39;</span><span class="p">,</span><span class="s1">&#39;#7a0177&#39;</span><span class="p">]</span>
<span class="n">custom_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">hr_cmap</span><span class="p">)</span>


<span class="c1">#This adjustment allow maz hit-rate values to be correctly represented with the color palette</span>
<span class="c1">#hit_rate_mask = xr.where(hit_rate == 100., 99.9, hit_rate)</span>

<span class="n">hit_rate_mask</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Hit-Rate&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">hit_rate_mask</span><span class="p">[</span><span class="s2">&quot;2m_temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">centre</span><span class="o">=</span><span class="n">centre</span><span class="p">,</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;valid_month&quot;</span><span class="p">,</span>
                                                                           <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span> 
                                                                           <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mask_threshold</span><span class="p">,</span><span class="mf">110.</span><span class="p">,</span><span class="mf">10.</span><span class="p">),</span>
                                                                           <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">hit_rate_mask</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;variable: </span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s2"> - centre: </span><span class="si">{</span><span class="n">centre</span><span class="si">}</span><span class="s2"> - region: </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/97b2be052688d5bd1adf15cd5af979951dc48e35e01671e1f3336489b658d655.png" src="../_images/97b2be052688d5bd1adf15cd5af979951dc48e35e01671e1f3336489b658d655.png" />
</div>
</div>
</section>
</section>
<section id="plot-and-describe-results">
<span id="seasonal-seasonal-monthly-single-levels-forecast-skill-q04-section-4"></span><h3>4. Plot and describe results<a class="headerlink" href="#plot-and-describe-results" title="Link to this heading">#</a></h3>
<section id="hit-rate-for-2-m-temperature">
<h4>Hit-rate for 2 m temperature<a class="headerlink" href="#hit-rate-for-2-m-temperature" title="Link to this heading">#</a></h4>
<p>The same analysis described in section 3 above. can be replicated for all forecasting systems and for all the selected sample regions.</p>
<p>Overall, the seasonal forecasts of 2m temperature have a significant, and potentially usable, hit-rate for terciles in regions closer to the tropics and under the direct influence of El Niño. The further away from the tropics, the lower the expected hit-rate on monthly anomalies.</p>
<p>Hit-rates smaller than 50% have been masked out, with the assumption that lower hit-rates would be of limited use for most practical applications. Although this working hypothesis can not be assumed to be strictly true for all purposes, it is a useful assumption for a discussion on the general characteristics of seasonal forecasts <a class="reference external" href="https://doi.org/10.1002/wcc.523" rel="noreferrer" target="_blank">[3]</a> <a class="reference external" href="https://doi.org/10.1016/j.crm.2021.100375" rel="noreferrer" target="_blank">[5]</a> <a class="reference external" href="https://doi.org/10.1016/j.cliser.2023.100347" rel="noreferrer" target="_blank">[6]</a> <a class="reference external" href="https://doi.org/10.1016/j.cliser.2023.100346" rel="noreferrer" target="_blank">[7]</a>.</p>
<p>The figure below shows that, among the sample regions considered in this analysis, those with the higher and more persistent hit-rate are South East Asia (SEA) and North West South America (NWS). These areas are under the direct influence of ENSO and are expected to benefit from a significantly higher degree of predictability compared to other regions. Other areas with significant, and potentially usable, in practical applications are Northern-East Africa (NEAF) and (North East South America) NES. Other areas like Southern Asia (SAS) and Souther Europe/Mediterranean (MED) have a moderate hit-rate, limited mostly to short lead times, whereas NWS shows only scattered cases of hit-rate above 50% <a class="reference external" href="https://doi.org/10.1038/s41612-023-00519-8" rel="noreferrer" target="_blank">[2]</a> <a class="reference external" href="https://doi.org/10.1175/BAMS-D-19-0019.1" rel="noreferrer" target="_blank">[8]</a> <a class="reference external" href="https://doi.org/10.1175/WAF-D-19-0106.1" rel="noreferrer" target="_blank">[9]</a> <a class="reference external" href="https://doi.org/10.1007/s00704-018-2421-9" rel="noreferrer" target="_blank">[10]</a>.</p>
<p>Compared to the similar assessment conducted (<a class="reference internal" href="seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html"><span class="std std-doc">Seasonal forecasts bias assessment for impact models</span></a>), a significant aspect of the hit-rates for terciles is their weak dependence on the originating centre. Although minor differences exist in the performance of the different forecasting systems, the overall patterns of significant hit-rates and even their seasonality is very similar, e.g. higher hit-rates in North West South America during the period October-December associated to El Niño.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cbar_width</span> <span class="o">=</span> <span class="n">cbar_pad</span> <span class="o">=</span> <span class="mf">0.02</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">hit_rate_mask</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;2m_temperature&#39;</span><span class="p">:</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Hit-Rate&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;valid_month&quot;</span><span class="p">,</span>
        <span class="n">xticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="n">yticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">60.</span><span class="p">,</span><span class="mf">110.</span><span class="p">,</span><span class="mf">10.</span><span class="p">),</span>
        <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Create a colorbar for each row</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">cbar_pad</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">cbar_width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/77476b46dc0c640b941c6c7d769c2f346d7d115e6a5eb7e62488c588da7c0ea9.png" src="../_images/77476b46dc0c640b941c6c7d769c2f346d7d115e6a5eb7e62488c588da7c0ea9.png" />
</div>
</div>
</section>
<section id="hit-rate-for-other-variables">
<h4>Hit-rate for other variables<a class="headerlink" href="#hit-rate-for-other-variables" title="Link to this heading">#</a></h4>
<p>A similar analysis can be conducted for other variables such as monthly accumulated rainfall, wind speed, solar radiation and dew point temperature.</p>
<ul class="simple">
<li><p>For <strong>total precipitation</strong> the hit-rate for terciles of monthly anomalies is mostly very small, except for the NES and SEA. Notably, the window of predictability is concentrated in specific seasons: March-May for NES and June-November for SEA <a class="reference external" href="https://doi.org/10.1175/JHM-D-19-0095.1" rel="noreferrer" target="_blank">[11]</a></p></li>
<li><p>For <strong>surface solar radiation downwards</strong> the only region with potentially exploitables hit-rates is South East Asia (SEA);  limited hit-rate reported over Europe. <a class="reference external" href="https://doi.org/10.5194/essd-13-2701-2021" rel="noreferrer" target="_blank">[12]</a> <a class="reference external" href="https://doi.org/10.1016/j.renene.2019.03.134" rel="noreferrer" target="_blank">[13]</a>.</p></li>
<li><p>For <strong>10m wind speed</strong> seasonal forecasts produce only limited cases of hit-rates above 60% and only at very short lead times. <a class="reference external" href="https://doi.org/10.1016/j.renene.2019.04.135" rel="noreferrer" target="_blank">[14]</a>.</p></li>
<li><p>For <strong>2m dew point temperature</strong> the pattern of significant hit-rates is clearly linked to the hit-rates of <strong>2m temperature</strong> coherently with an approximately constant pattern of relative humidity whereby the dewpoint temperature is directly related to local temperature by the Clausius-Clapeyron relation <a class="reference external" href="https://doi.org/10.1175/JHM-D-19-0095.1" rel="noreferrer" target="_blank">[11]</a>.</p></li>
</ul>
<p>Similarly to <strong>2m temperature</strong> hit-rates for terciles of seasonal forecasts for other variables have a weak dependence on the originating centres.</p>
<p>The analysis highlights how seasonal forecasts provide a significant hit-rate for terciles of anomalies observed at a monthly time scale mainly for some specific areas and variables.</p>
<p>Nevertheless, valuable information can be extracted by conducting tailored analysis for specific applications <a class="reference external" href="https://doi.org/10.1002/wcc.523" rel="noreferrer" target="_blank">[3]</a>.</p>
<p>Overall, this analysis highlights how seasonal forecasts can not be used as an extension of weather predictions to derive information on expected climate anomalies at monthly or shorter time scales. The actual added value of the use of seasonal forecasts should be always assessed on the basis of the specific applications and decision making processes. Other use cases can be sensitive to different indicators of the quality of seasonal forecasts such as the chance above normal of multiple categories (see for example the <a class="reference external" href="https://www.metoffice.gov.uk/binaries/content/assets/metofficegovuk/pdf/business/public-sector/civil-contingency/3moutlook_jja_v2.pdf" rel="noreferrer" target="_blank">Met Office 3-month outlooks</a>) or the possibility of anticipating the likelihood of extreme events <a class="reference external" href="https://doi.org/10.1038/s41467-023-42377-1" rel="noreferrer" target="_blank">[16]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cbar_width</span> <span class="o">=</span> <span class="n">cbar_pad</span> <span class="o">=</span> <span class="mf">0.02</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">hit_rate_mask</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">var</span> <span class="o">!=</span> <span class="s1">&#39;2m_temperature&#39;</span><span class="p">:</span>
    <span class="n">da</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Hit-Rate&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">}</span>
    <span class="n">facet</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
        <span class="n">row</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;valid_month&quot;</span><span class="p">,</span>
        <span class="n">xticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="n">yticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">60.</span><span class="p">,</span><span class="mf">110.</span><span class="p">,</span><span class="mf">10.</span><span class="p">),</span>
        <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Create a colorbar for each row</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">cbar_pad</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">cbar_width</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/956e5ef483cdd29784aeceace6159f51360a1438173e75bb2f687608e910d2d6.png" src="../_images/956e5ef483cdd29784aeceace6159f51360a1438173e75bb2f687608e910d2d6.png" />
<img alt="../_images/eb48a95221d938c0f2a4faa169cfd7fb2d035f9ba6d8bff3d3ba37d72c8aef7a.png" src="../_images/eb48a95221d938c0f2a4faa169cfd7fb2d035f9ba6d8bff3d3ba37d72c8aef7a.png" />
<img alt="../_images/40ba69286d12fc45031a92ae71d3bbd4c092e88dd91b19f113ec4094cbeb74c8.png" src="../_images/40ba69286d12fc45031a92ae71d3bbd4c092e88dd91b19f113ec4094cbeb74c8.png" />
<img alt="../_images/ed91f4a164eba3e7f432492b197f4b71ac6df7c9c2fb99858676c622cc160f17.png" src="../_images/ed91f4a164eba3e7f432492b197f4b71ac6df7c9c2fb99858676c622cc160f17.png" />
</div>
</div>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Seasonal forecast monthly statistics on single levels: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/seasonal-monthly-single-levels?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/seasonal-monthly-single-levels?tab=overview</a></p></li>
<li><p>ERA5 monthly averaged data on single levels from 1940 to present: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means?tab=overview" rel="noreferrer" target="_blank">https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels-monthly-means?tab=overview</a></p></li>
</ul>
<p>More information on the verification of forecasts are available on the <a class="reference external" href="https://confluence.ecmwf.int/display/FUG/Forecast+User+Guide" rel="noreferrer" target="_blank">Forecast User Guide</a> at ECMWF. In particular, key concepts on the use of contingency tables are discussed in the section dedicated to <a class="reference external" href="https://confluence.ecmwf.int/display/FUG/Section+12.A+Statistical+Concepts+-+Deterministic+Data#Section12.AStatisticalConceptsDeterministicData-UsefulnessoftheForecast-ACost/BenefitApproach" rel="noreferrer" target="_blank">Usefulness of the forecast and Cost/Benefit Approach</a></p>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control" rel="noreferrer" target="_blank">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/" rel="noreferrer" target="_blank">B-Open</a></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">regionmask</span></code> package for the computation of regionalised statistics is available <a class="reference external" href="https://regionmask.readthedocs.io/en/stable/index.html" rel="noreferrer" target="_blank">here</a></p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://doi.org/10.1016/j.cliser.2024.100496" rel="noreferrer" target="_blank">[1]</a> Khosravi F,  Bruno Soares M, Teixeira M, Fontes N , Graca Antonio (2024), Assessing the usability and value of a climate service in the wine sector, Climate Services, Volume 34, 100496</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41612-023-00519-8" rel="noreferrer" target="_blank">[2]</a> Ludescher, J., Bunde, A. &amp; Schellnhuber, H.J (2023).  Forecasting the El Niño type well before the spring predictability barrier. npj Clim Atmos Sci 6, 196.</p>
<p><a class="reference external" href="https://doi.org/10.1002/wcc.523" rel="noreferrer" target="_blank">[3]</a> Bruno Soares M., Daly M, Dessai S (2018) Assessing the value of seasonal climate forecasts for decision-making. WIREs Clim Change. 9:e523.</p>
<p><a class="reference external" href="https://doi.org/10.1017/CBO9781139177245.006" rel="noreferrer" target="_blank">[4]</a> Seneviratne, S. I., Nicholls, N., Easterling, D., Goodess, C. M., Kanae, S., Kossin, J., Zwiers, F. W. (2012). Changes in Climate Extremes and their Impacts on the Natural Physical Environment. In C. B. Field, V. Barros, T. F. Stocker, &amp; Q. Dahe (Eds.), Managing the Risks of Extreme Events and Disasters to Advance Climate Change Adaptation: Special Report of the Intergovernmental Panel on Climate Change (pp. 109–230). chapter, Cambridge: Cambridge University Press.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.crm.2021.100375" rel="noreferrer" target="_blank">[5]</a> MacLeod D, Kniveton D R, Todd M C,(2021) Playing the long game: Anticipatory action based on seasonal forecasts, Climate Risk Management, Volume 34, 2021, 100375,</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.cliser.2023.100347" rel="noreferrer" target="_blank">[6]</a> Terrado M, Marcos R,  González-Reviriego N, Vigo I, Nicodemou A, Graça A, Teixeira M, Fontes N, Silva S, Dell’Aquila A, Ponti L, Calmanti S, Bruno Soares M, Khosravi F, Caboni F, (2023) Co-production pathway of an end-to-end climate service for improved decision-making in the wine sector, Climate Services, Volume 30, 100347,</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.cliser.2023.100346" rel="noreferrer" target="_blank">[7]</a> Dell’Aquila, A. Graça, A. Teixeira M Fontes N, Gonzalez-Reviriego N, Marcos-Matamoros R, Chou C, Terrado M, Giannakopoulos C, Varotsos K, Caboni F, Locci R, Nanu M, Porru S, Argiolas S, Bruno Soares M, Sanderson, M. Bruno Soares, M Sanderson, M. (2023)  Monitoring climate related risk and opportunities for the wine sector: The MED-GOLD pilot service, Climate Services, 2023, 30, 100346</p>
<p><a class="reference external" href="https://doi.org/10.1175/BAMS-D-19-0019.1" rel="noreferrer" target="_blank">[8]</a> Weisheimer, A., D. J. Befort, D. MacLeod, T. Palmer, C. O’Reilly, and K. Strømmen (2020) : Seasonal Forecasts of the Twentieth Century. Bull. Amer. Meteor. Soc., 101, E1413–E1426,</p>
<p><a class="reference external" href="https://doi.org/10.1175/WAF-D-19-0106.1" rel="noreferrer" target="_blank">[9]</a> Gubler, S., and Coauthors (2020)  Assessment of ECMWF SEAS5 Seasonal Forecast Performance over South America. Wea. Forecasting, 35, 561–584,</p>
<p><a class="reference external" href="https://doi.org/10.1007/s00704-018-2421-9" rel="noreferrer" target="_blank">[10]</a> Mohanty, U.C., Nageswararao, M.M., Sinha, P. et al. (2019) Evaluation of performance of seasonal precipitation prediction at regional scale over India. Theor Appl Climatol 135, 1123–1142</p>
<p><a class="reference external" href="https://doi.org/10.1175/JHM-D-19-0095.1" rel="noreferrer" target="_blank">[11]</a> Roy, T., X. He, P. Lin, H. E. Beck, C. Castro, and E. F. Wood (2020) Global Evaluation of Seasonal Precipitation and Temperature Forecasts from NMME. J. Hydrometeor., 21, 2473–2486</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-13-2701-2021" rel="noreferrer" target="_blank">[12]</a> Lorenz, C., Portele, T. C., Laux, P., and Kunstmann, H.(2021) Bias-corrected and spatially disaggregated seasonal forecasts: a long-term reference forecast product for the water sector in semi-arid regions, Earth Syst. Sci. Data, 13, 2701–2722,</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.renene.2019.03.134" rel="noreferrer" target="_blank">[13]</a> De Felice M, Bruno Soares M, Alessandri A, Troccoli A,(2019) Scoping the potential usefulness of seasonal climate forecasts for solar power management, Renewable Energy, Volume 142, Pages 215-223,</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.renene.2019.04.135" rel="noreferrer" target="_blank">[14]</a> Lledó Ll., Torralba V.,  Soret A, Ramon J, Doblas-Reyes FJ (2019) Seasonal forecasts of wind power generation, Renewable Energy, Volume 143, 91-100</p>
<p><a class="reference external" href="https://doi.org/10.1098/rsif.2013.1162" rel="noreferrer" target="_blank">[15]</a> Weisheimer A. and Palmer T. N. (2014) On the reliability of seasonal climate forecastsJ. R. Soc. Interface.1120131162</p>
<p><a class="reference external" href="https://doi.org/10.1038/s41467-023-42377-1" rel="noreferrer" target="_blank">[16]</a> Dunstone, N., Smith, D.M., Hardiman, S.C. et al. Windows of opportunity for predicting seasonal climate extremes highlighted by the Pakistan floods of 2022. Nat Commun 14, 6544 (2023).</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Seasonal_Forecasts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.1. </span>Seasonal forecasts bias assessment for impact models</p>
      </div>
    </a>
    <a class="right-next"
       href="seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Assessing possible outcomes of seasonal temperature forecast</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-a-national-hydro-met-service-informing-decisions-in-agricultural-or-energy-applications">🌍 Use case: A national hydro-met service informing decisions in agricultural or energy applications</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statement">📢 Quality assessment statement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-setup-the-code">1. Choose the data to use and setup the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-required-packages">Import required packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters-describing-regions-variables-and-data">Define parameters describing regions, variables, and data</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-chosen-regions">Plot the chosen regions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-required-functions">Define the required functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-data">2. Download and process data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-era5">Download and process ERA5</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#download-and-process-seasonal-forecasts">Download and process seasonal forecasts</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-score-analysis">3. Hit-score analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-terciles">Analysis of terciles</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-hit-score-and-show-a-sample-plot">Compute hit-score and show a sample plot</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-and-describe-results">4. Plot and describe results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-rate-for-2-m-temperature">Hit-rate for 2 m temperature</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hit-rate-for-other-variables">Hit-rate for other variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>