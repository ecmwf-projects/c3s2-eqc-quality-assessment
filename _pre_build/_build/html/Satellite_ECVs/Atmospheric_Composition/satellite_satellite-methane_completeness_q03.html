
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.2.2. Methane satellite observations completeness assessment for greenhouse gas monitoring &#8212; eqcbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q03';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.2.3. Methane satellite observations uncertainty and completeness assessment for carbon cycle" href="satellite_satellite-methane_uncertainty_q01.html" />
    <link rel="prev" title="1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">⚠️This is under development!⚠️</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="eqcbook - Home"/>
    <img src="../../_static/C3S–POS–LINE.png" class="logo__image only-dark pst-js-only" alt="eqcbook - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    C3S EQC quality assessments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../satellite.html">1. Quality assessments for Satellite Observations</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../Atmosphere_Physics/Atmosphere_Physics.html">1.1. Atmosphere Physics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Atmospheric_Composition.html">1.2. Atmospheric Composition</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html">1.2.1. Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">1.2.2. Methane satellite observations completeness assessment for greenhouse gas monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-methane_uncertainty_q01.html">1.2.3. Methane satellite observations uncertainty and completeness assessment for carbon cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="satellite_satellite-ozone-v1_climate-monitoring_q01.html">1.2.4. Temporal and spatial completeness of the satellite-derived Ozone for policy making and variability studies</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Cryosphere/Cryosphere.html">1.3. Cryosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-ice-sheet-elevation-change_trend-assessment_q01.html">1.3.1. Uncertainty of ice sheet surface elevation change data over Greenland for volume and mass change trend assessments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Cryosphere/satellite_satellite-sea-ice-edge-type_intercomparison_q01.html">1.3.2. Intercomparison of satellite multi-year sea ice extent estimates [Satellites - Intercomparison - Climate monitoring]</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Biosphere/Land_Biosphere.html">1.4. Land Biosphere</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_climate-and-weather-extremes_q01.html">1.4.1. Satellite fire burned area completeness for seasonal climatology maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Land_Biosphere/satellite_satellite-fire-burned-area_trend-assessment_q02.html">1.4.2. Satellite fire burned area trends assessment for climate monitoring</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Land_Hydrology/Land_Hydrology.html">1.5. Land Hydrology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Ocean/Ocean.html">1.6. Ocean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-ocean-colour_consistency-assessment_q01.html">1.6.1. Impact of using successive satellites on Ocean Colour time series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-ice-thickness_trend-assessment_q01.html">1.6.2. Suitability of satellite sea ice thickness data for studying climate change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-level-global_trend-assessment_q01.html">1.6.3. Regional sea level trend assessment in the Mediterranean Sea from Satellite (observations) at basin and sub-basin scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q01.html">1.6.4. Consistency Assessment of Satellite Sea Surface Temperature for Climate Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Ocean/satellite_satellite-sea-surface-temperature_consistency_q02.html">1.6.5. Satellite Sea Surface Temperature Consistency in representing Ocean Warming Trends</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Insitu Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../In_Situ/insitu.html">2. Quality assessments for Insitu Observations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Reanalysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Reanalyses/reanalysis.html">3. Quality assessments for Reanalysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal.html">4. Quality assessments for Seasonal Forecasts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q02.html">4.1. Seasonal forecasts bias assessment for impact models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_forecast-skill_q04.html">4.2. Evaluation of the hit-rate of seasonal forecasts for tercile categories of monthly anomalies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Seasonal_Forecasts/seasonal_seasonal-monthly-single-levels_uncertainty-quality-flags_q01.html">4.3. Assessing possible outcomes of seasonal temperature forecast</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">➡️ Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Climate_Projections/climate.html">5. Quality assessments for Climate Projections</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CMIP6/CMIP6.html">5.1. CMIP6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q01.html">5.1.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q02.html">5.1.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-and-weather-extremes_q03.html">5.1.3. Uncertainty in projected changes in extreme temperature indices at a 2°C Global Warming Level for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q01.html">5.1.4. Biases in energy-consumption-related indices in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q02.html">5.1.5. Uncertainty in projected changes of energy consumption in Europe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q03.html">5.1.6. Uncertainty in projected changes of energy consumption in Europe at a 2°C Global Warming Level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_climate-impact-indicators_q04.html">5.1.7. Projections of future ice-free periods for the Arctic and Antarctic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q02.html">5.1.8. Historical accuracy of sea ice extent in the CMIP6 projections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_model-performance_q03.html">5.1.9. Evaluation of the Arctic sea ice thickness in the CMIP6 historical experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q10.html">5.1.10. Testing the capability of CMIP6 GCMs to represent precipitation inter-annual variability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CMIP6/climate_projections-cmip6_validation_q11.html">5.1.11. Testing the capability of CMIP6 GCMs to represent precipitation intra-seasonal variability</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Climate_Projections/CORDEX/CORDEX.html">5.2. CORDEX</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q01.html">5.2.1. Bias in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q02.html">5.2.2. Uncertainty in projected changes in extreme temperature indices for the reinsurance sector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q03.html">5.2.3. Bias in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_climate-and-weather-extremes_q04.html">5.2.4. Projected changes in precipitation-based indices for impact models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Climate_Projections/CORDEX/climate_projections-cordex-domains-single-levels_validation_q05.html">5.2.5. CORDEX temperature biases over the Alpine region for the ski and hydrological sectors.</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quality assessment template</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../templates/template_instructions.html">Template instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templates/template.html">Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/c3s2-eqc-quality-assessment/issues/new?title=Issue%20on%20page%20%2FSatellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Satellite_ECVs/Atmospheric_Composition/satellite_satellite-methane_completeness_q03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Methane satellite observations completeness assessment for greenhouse gas monitoring</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-quantifying-global-trends-and-uncertainties-in-greenhouse-gas-concentrations">🌍 Use case: Using satellite observations for quantifying global trends and uncertainties in greenhouse gas concentrations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">📢 Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-temporal-and-spatial-coverage-land-mask">Choose temporal and spatial coverage, land mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chache-needed-functions">Chache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-xch-4-data-obs4mips">2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (Obs4MIPs)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-and-plot-the-global-variability-of-seasonal-xch-4">3. Compute and plot the global variability of seasonal XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-global-and-spatial-trends">4. Compute global and spatial trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-concerning-xch-4-uncertainties">5. Analysis concerning XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xch-4-uncertainties">Global maps of XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-analysis-for-the-different-variables">Time series analysis for the different variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../../_images/LogoLine_horizon_C3S1.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="methane-satellite-observations-completeness-assessment-for-greenhouse-gas-monitoring">
<h1><span class="section-number">1.2.2. </span>Methane satellite observations completeness assessment for greenhouse gas monitoring<a class="headerlink" href="#methane-satellite-observations-completeness-assessment-for-greenhouse-gas-monitoring" title="Link to this heading">#</a></h1>
<p>Production date: 03-06-2025</p>
<p>Produced by: CNR</p>
<section id="use-case-using-satellite-observations-for-quantifying-global-trends-and-uncertainties-in-greenhouse-gas-concentrations">
<h2>🌍 Use case: Using satellite observations for quantifying global trends and uncertainties in greenhouse gas concentrations<a class="headerlink" href="#use-case-using-satellite-observations-for-quantifying-global-trends-and-uncertainties-in-greenhouse-gas-concentrations" title="Link to this heading">#</a></h2>
</section>
<section id="quality-assessment-questions">
<h2>❓ Quality assessment questions<a class="headerlink" href="#quality-assessment-questions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>How can the variability of spatial and temporal data coverage affect the quantification of the long-term atmospheric methane trends by satellite measurements (XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 3 gridded product)?</strong></p></li>
<li><p><strong>What are the uncertainties related to the XCH<span class="math notranslate nohighlight">\(_4\)</span> satellite observations?</strong></p></li>
</ul>
<p>Methane (CH<span class="math notranslate nohighlight">\(_4\)</span>) is the second most important anthropogenic greenhouse gas after carbon dioxide (CO<span class="math notranslate nohighlight">\(_2\)</span>), representing about 19% of the total radiative forcing by long-lived greenhouse gases <a class="reference external" href="https://library.wmo.int/idurl/4/68532">[1]</a>. Atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> also adversely affects human health as a precursor of tropospheric ozone <a class="reference external" href="https://doi.org/10.1073/pnas.0600201103">[2]</a>. Monitoring the long-term CH<span class="math notranslate nohighlight">\(_4\)</span> variability is therefore crucial for monitoring the emission reductions <a class="reference external" href="https://doi.org/10.5194/essd-2024-115">[3]</a>. In this assessment, atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> spatial seasonal means and trends are analysed using the XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 3 gridded product (Obs4MIPs, version 4.5 <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[4]</a>), by adopting an approach similar to <a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020">[5]</a>. Furthermore, we also evaluate the uncertainty associated with this dataset.</p>
<p>The Obs4MIPs XCH<span class="math notranslate nohighlight">\(_4\)</span> product is generated by spatial (5°x5°) and temporal (monthly) gridding of the corresponding EMMA Level 2 data product. For more details see <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a>. By analysing an ensemble of different Level 2 datasets from various retrieval algorithms, the EMMA algorithm generates a dataset containing  XCH<span class="math notranslate nohighlight">\(_4\)</span> from individual retrievals. In particular, for each month and 10°×10° grid box, the algorithm with the grid box mean closest to the median is selected. The list of the considered retrieval algorithms is available from <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a>. The various retrieval algorithms are optimised for different instruments (SCIAMACHY, GOSAT, GOSAT-2) which measure backscattered solar radiation in the near-infrared for O<span class="math notranslate nohighlight">\(_2\)</span> as well as the absorption bands of CO<span class="math notranslate nohighlight">\(_2\)</span> or CH<span class="math notranslate nohighlight">\(_4\)</span>.</p>
<p>Code is included for transparency but also learning purposes and gives users the chance to adapt the code used for the assesment as they wish. Users should always check product documentation and associated peer-reviewed papers for a more complete reporting of the issues discussed here (e.g., <a class="reference external" href="https://doi.org/10.24381/14j9-s541">[7]</a>, <a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024">[8]</a>).</p>
</section>
<section id="quality-assessment-statements">
<h2>📢 Quality assessment statements<a class="headerlink" href="#quality-assessment-statements" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">These are the key outcomes of this assessment</p>
<ul class="simple">
<li><p>The dataset “Methane data from 2002 to present derived from satellite observations” can be used to evaluate CH<span class="math notranslate nohighlight">\(_4\)</span> mean values, climatology and growth rate over the globe, hemispheres or large regions.</p></li>
<li><p>Caution should be exercised in certain regions (high latitudes, regions with frequent cloud cover, oceans) where data availability varies along the temporal coverage of the dataset: this must be carefully considered when evaluating global or hemispheric information.</p></li>
<li><p>For data in high latitude regions or in regions with frequent cloud cover, users should consult uncertainty and quality flags as appropriate for their applications. In addition, for the years 2003-2008 only values over land are available, which has to be taken into account for possible applications of this dataset.</p></li>
<li><p>As the uncertainties associated with the dataset are not constant over space and time, users are advised to consider the evolution of their values over the spatial regions and time periods of interest. The highest uncertainty values were found over high latitudes, the Himalayas and the tropical rainforest zone.</p></li>
</ul>
</div>
</section>
<section id="methodology">
<h2>📋 Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h2>
<p>Spatial seasonal means and trends are presented and assessed using the XCH<span class="math notranslate nohighlight">\(_4\)</span> v4.5 Level 3 gridded product (Obs4MIPs), which has been generated using the Level 2 EMMA products <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[4]</a> as input.</p>
<p>To show how data coverage varies between years and seasons, we have calculated and plotted the average XCH<span class="math notranslate nohighlight">\(_4\)</span> values for the different seasons and years, over the period 2013-2022. This time period has been chosen for the purpose of comparing the calculated trends with the results in <a class="reference external" href="https://library.wmo.int/idurl/4/68532">[1]</a>.</p>
<p>Spatial trends are calculated using a linear model (i.e., Theil-Sen slope estimator) over monthly anomalies (i.e., actual monthly values minus climatological monthly means). This should be treated with caution as the long-term trend of atmospheric CH<span class="math notranslate nohighlight">\(_4\)</span> is not strictly linear. The statistical significance of the trends is assessed using the Mann-Kendall test. Similar to <a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/">[5]</a>, only land pixels are considered to avoid artefacts related to different data availability over oceans (the data product is land only for 2003-2008).</p>
<p>The global maps of the product uncertainties (“xch4_stderr”) for a specific subset of years (2015-2020) are shown, together with the time series of selected XCH<span class="math notranslate nohighlight">\(_4\)</span> variables (“xch4”, “xch4_stderr” and “xch4_nobs”). Please note that this analysis can be extended to one additional variable, not shown here (“xch4_stddev”), or can be customized by the user for specific regions of interest.</p>
<p>The analysis and results are organised in the following steps, which are detailed in the sections below:</p>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q03-template-section-1"><span class="std std-ref">1. Choose the data to use and set-up the code</span></a></strong></p>
<ul class="simple">
<li><p>Import all the relevant packages.</p></li>
<li><p>Choose the temporal and spatial coverage, land mask, and possible spatial regions for the analysis.</p></li>
<li><p>Cache needed functions.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q03-template-section-2"><span class="std std-ref">2. Retrieve XCH_4 data (Obs4MIPs)</span></a></strong></p>
<ul class="simple">
<li><p>In this section, we define the data request to CDS.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q03-template-section-3"><span class="std std-ref">3. Compute and plot the global variability of seasonal XCH_4</span></a></strong></p>
<ul class="simple">
<li><p>To show how data coverage varies between years and seasons, we have plotted spatial average XCH<span class="math notranslate nohighlight">\(_4\)</span> values for seasons and years. To avoid the production of too many maps, this analysis has been limited to the period 2013-2022. Seasons are defined as December-February (DJF), March-May (MAM), June-August (JJA) and September-November (SON).</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q03-template-section-4"><span class="std std-ref">4. Compute global and spatial trends</span></a></strong></p>
<ul class="simple">
<li><p>Trends (over 2013-2022) are calculated using a linear model (i.e., Theil-Sen slope estimator) over monthly anomalies (i.e., actual monthly values minus climatological monthly means). The statistical significance of the trends is assessed using the Mann-Kendall test.</p></li>
</ul>
<p><strong><a class="reference internal" href="#satellite-satellite-methane-completeness-q03-template-section-5"><span class="std std-ref">5. Analysis concerning XCH_4 uncertainties</span></a></strong></p>
<ul class="simple">
<li><p>Annual global maps of the XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties are presented, for a subset of data (2015-2020).</p></li>
<li><p>Global time series of XCH<span class="math notranslate nohighlight">\(_4\)</span>, related uncertainties and data availability over the entire data period (2003-2022) are shown.</p></li>
</ul>
</section>
<section id="analysis-and-results">
<h2>📈 Analysis and results<a class="headerlink" href="#analysis-and-results" title="Link to this heading">#</a></h2>
<section id="choose-the-data-to-use-and-set-up-the-code">
<span id="satellite-satellite-methane-completeness-q03-template-section-1"></span><h3>1. Choose the data to use and set-up the code<a class="headerlink" href="#choose-the-data-to-use-and-set-up-the-code" title="Link to this heading">#</a></h3>
<section id="import-all-relevant-packages">
<h4>Import all relevant packages<a class="headerlink" href="#import-all-relevant-packages" title="Link to this heading">#</a></h4>
<p>In this section, we import all the relevant packages needed for running the notebook.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">c3s_eqc_automatic_quality_control</span><span class="w"> </span><span class="kn">import</span> <span class="n">diagnostics</span><span class="p">,</span> <span class="n">download</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">xarrayMannKendall</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mann_Kendall_test</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn-v0_8-notebook&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;hatch.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> 

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CDSAPI_RC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~/putero_davide/.cdsapirc&quot;</span><span class="p">)</span>

<span class="n">download</span><span class="o">.</span><span class="n">INVALIDATE_CACHE</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1">#Set True to invalidate the caching</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="choose-temporal-and-spatial-coverage-land-mask">
<h4>Choose temporal and spatial coverage, land mask<a class="headerlink" href="#choose-temporal-and-spatial-coverage-land-mask" title="Link to this heading">#</a></h4>
<p>In this section, we define the parameters to be ingested by the code (that can be customized by the user), i.e.:</p>
<ul class="simple">
<li><p>the temporal period of analysis;</p></li>
<li><p>the activation/deactivation of the land masking;</p></li>
<li><p>the regions selected for the analysis. Please note that, for this notebook, only the global maps and time series are reported.</p></li>
</ul>
<p>The analyses presented in this notebook cover different time periods:</p>
<ul class="simple">
<li><p>with the aim to compare our results with existing literature <a class="reference external" href="https://library.wmo.int/records/item/68532-no-19-15-november-2023">[1]</a>, the global variability and trend analyses are limited to 2013-2022;</p></li>
<li><p>the global plots of the XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties refer to the years from 2015 to 2020;</p></li>
<li><p>the time series of XCH<span class="math notranslate nohighlight">\(_4\)</span>, related uncertainties and data availability cover the entire period of data coverage.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose variable</span>
<span class="n">variable</span> <span class="o">=</span> <span class="s2">&quot;xch4&quot;</span>
<span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">,</span> <span class="s2">&quot;xco2&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_nobs&quot;</span><span class="p">,</span> <span class="s2">&quot;_stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;_stddev&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Choose a time period (to be used for the global variability and trend analysis)</span>
<span class="n">year_start</span> <span class="o">=</span> <span class="mi">2013</span>
<span class="n">year_stop</span> <span class="o">=</span> <span class="mi">2022</span>

<span class="c1"># Minimum value of land fraction used for masking</span>
<span class="n">min_land_fraction</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># Use None to switch off</span>

<span class="c1"># Define regions for analysis</span>
<span class="n">lon_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">lat_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">),</span> <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="chache-needed-functions">
<h4>Chache needed functions<a class="headerlink" href="#chache-needed-functions" title="Link to this heading">#</a></h4>
<p>In this section, we cached a list of functions used in the analyses.</p>
<ul class="simple">
<li><p>The function <code class="docutils literal notranslate"><span class="pre">get_da</span></code> (<code class="docutils literal notranslate"><span class="pre">get_da_nomask</span></code>) is used to subset the data for the defined time period and spatial region by applying (not appliyng) the land mask (as a function of <em>min_land_fraction</em>).</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> rescales XCH<span class="math notranslate nohighlight">\(_4\)</span> mole fraction to parts per billion (ppb).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">seasonal_weighted_mean</span></code> function extracts the regional means over the selected domains. It uses spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids used for the reanalysis and for the forecast models. It is used by the function <code class="docutils literal notranslate"><span class="pre">compute_seasonal_timeseries_nomask</span></code> to provide the seasonal XCH<span class="math notranslate nohighlight">\(_4\)</span> average value for each year (Fig. 1).</p></li>
<li><p>The function <code class="docutils literal notranslate"><span class="pre">compute_anomaly_trends</span></code> is used to calculate the trend and the related statistical significance.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">compute_monthly_anomalies</span></code> function is used to derive the monthly XCH<span class="math notranslate nohighlight">\(_4\)</span> anomalies before calculating the trends.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">mask_scale_and_regionalise</span></code> function extracts the XCH<span class="math notranslate nohighlight">\(_4\)</span> data over the selected spatial region. It uses spatial weighting to account for the latitudinal dependence of the grid size in the lon/lat grids used for the reanalysis and for the forecast models. It uses the <code class="docutils literal notranslate"><span class="pre">convert_units</span></code> function for rescaling the values to ppb, and it applies the threshold (if any) on the minimum land fraction.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">transform_func_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;min_land_fraction&quot;</span><span class="p">:</span> <span class="n">min_land_fraction</span><span class="p">,</span>
    <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="p">,</span>
    <span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span><span class="p">,</span>
    <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">,</span>
    <span class="s2">&quot;lon_slice&quot;</span><span class="p">:</span> <span class="n">lon_slice</span><span class="p">,</span>
    <span class="s2">&quot;lat_slice&quot;</span><span class="p">:</span> <span class="n">lat_slice</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">transform_func_kwargs_nommask</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span><span class="p">,</span>
    <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_nobs&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">da</span>

    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xch4&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppb&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e9</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppb&quot;</span>
        <span class="k">elif</span> <span class="n">da</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;ppm&quot;</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">*=</span> <span class="mf">1.0e6</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ppm&quot;</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">mask_scale_and_regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">min_land_fraction</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fill_value</span> <span class="o">:=</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;fill_value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da</span> <span class="o">!=</span> <span class="n">fill_value</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">da</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
        <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_units</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lon_slice</span> <span class="ow">or</span> <span class="n">lat_slice</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_da</span><span class="p">(</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">min_land_fraction</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">,</span> <span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span>
<span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">mask_scale_and_regionalise</span><span class="p">(</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">year_start</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">year_stop</span><span class="p">))),</span>
        <span class="n">min_land_fraction</span><span class="p">,</span>
        <span class="n">lon_slice</span><span class="p">,</span>
        <span class="n">lat_slice</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">regionalise</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">lon_slice</span><span class="o">=</span><span class="n">lon_slice</span><span class="p">,</span> <span class="n">lat_slice</span><span class="o">=</span><span class="n">lat_slice</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_land_fraction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;land_fraction&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_land_fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_da_nomask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="n">year_start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">mask_scale_and_regionalise</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">(</span><span class="n">varname</span><span class="p">,)</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s2">&quot;xch4&quot;</span><span class="p">}</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_seasonal_timeseries_nomask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">):</span>
    <span class="c1"># Shift years (shift -1 to get D(year-1)J(year)F(year))</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_da_nomask</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
    <span class="c1"># Get rid of 1st JF and last D, so it become [MAM, JJA, SON, DJF, ..., SON]</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">seasonal_weighted_mean</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_statistics</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_da</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">)</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_statistics</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">da</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_monthly_anomalies</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">):</span>
    <span class="n">da</span> <span class="o">=</span> <span class="n">get_da</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">da</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_mann_kendall_trend</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">mann_kendall_kwargs</span><span class="p">):</span>
    <span class="n">coords_name</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;latitude&quot;</span><span class="p">}</span>
    <span class="n">ds_trend</span> <span class="o">=</span> <span class="n">Mann_Kendall_test</span><span class="p">(</span>
        <span class="n">da</span><span class="p">,</span> <span class="n">coords_name</span><span class="o">=</span><span class="n">coords_name</span><span class="p">,</span> <span class="o">**</span><span class="n">mann_kendall_kwargs</span>
    <span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ds_trend</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coords_name</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;time&quot;</span><span class="p">})</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_seasonal_detrended_anomaly</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="o">**</span><span class="n">polyfit_kwargs</span><span class="p">):</span>
    <span class="n">da_trend</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span>
        <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span> <span class="n">da</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">polyfit_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">polyfit_coefficients</span>
    <span class="p">)</span>
    <span class="n">da_detrended</span> <span class="o">=</span> <span class="n">da</span> <span class="o">-</span> <span class="n">da_trend</span>
    <span class="k">return</span> <span class="n">da_detrended</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">seasonal_weighted_mean</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_anomaly_trends</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">):</span>
    <span class="n">da_anomaly</span> <span class="o">=</span> <span class="n">compute_monthly_anomalies</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="o">**</span><span class="n">get_da_kwargs</span><span class="p">)</span>

    <span class="c1"># Mann-Kendall</span>
    <span class="n">ds_mann_kendall</span> <span class="o">=</span> <span class="n">compute_mann_kendall_trend</span><span class="p">(</span>
        <span class="n">da_anomaly</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;theilslopes&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
    <span class="n">ds_mann_kendall</span><span class="p">[</span><span class="s2">&quot;trend&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Trend of anomalies of </span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/month&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">ds_mann_kendall</span><span class="p">[</span><span class="s2">&quot;std_error&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Standard error of anomalies of </span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/month&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Detrended anomalies</span>
    <span class="n">da_detrended</span> <span class="o">=</span> <span class="n">compute_seasonal_detrended_anomaly</span><span class="p">(</span><span class="n">da_anomaly</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">da_detrended</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;long_name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Detrended of anomalies of </span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;long_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">da_anomaly</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">ds_mann_kendall</span><span class="p">[</span><span class="s2">&quot;detrended_anomaly&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">da_detrended</span>
    <span class="k">return</span> <span class="n">ds_mann_kendall</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="retrieve-xch-4-data-obs4mips">
<span id="satellite-satellite-methane-completeness-q03-template-section-2"></span><h3>2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (Obs4MIPs)<a class="headerlink" href="#retrieve-xch-4-data-obs4mips" title="Link to this heading">#</a></h3>
<p>In this section, we define the data request to CDS (data product Obs4MIPs, Level 3, version 4.5, XCH<span class="math notranslate nohighlight">\(_4\)</span>) and download the dataset.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;satellite-carbon-dioxide&quot;</span> <span class="k">if</span> <span class="n">variable</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;xco2&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;satellite-methane&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;processing_level&quot;</span><span class="p">:</span> <span class="s2">&quot;level_3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">variable</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;sensor_and_algorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;merged_obs4mips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;4_5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">kwargs</span> <span class="ow">in</span> <span class="n">regions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
        <span class="o">*</span><span class="n">request</span><span class="p">,</span>
        <span class="n">transform_func</span><span class="o">=</span><span class="n">mask_scale_and_regionalise</span><span class="p">,</span>
        <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;min_land_fraction&quot;</span><span class="p">:</span> <span class="n">min_land_fraction</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">da</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">da</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">)</span>
    <span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region=&#39;global&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/1 [00:00&lt;?, ?it/s]/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/cacholote/extra_encoders.py:297: SerializationWarning: cannot serialize global coordinates {&#39;time_bnds&#39;, &#39;lat_bnds&#39;, &#39;pre_bnds&#39;, &#39;lon_bnds&#39;} because the global attribute &#39;coordinates&#39; already exists. This may prevent faithful roundtrippingof xarray datasets
  obj.to_netcdf(tmpfilename)
100%|██████████| 1/1 [00:00&lt;00:00,  1.45it/s]
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/scipy/stats/_mstats_basic.py:1256: RuntimeWarning: All `x` coordinates are identical.
  return stats_theilslopes(y, x, alpha=alpha, method=method)
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/numpy/_core/fromnumeric.py:3860: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/numpy/_core/_methods.py:145: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-and-plot-the-global-variability-of-seasonal-xch-4">
<span id="satellite-satellite-methane-completeness-q03-template-section-3"></span><h3>3. Compute and plot the global variability of seasonal XCH<span class="math notranslate nohighlight">\(_4\)</span><a class="headerlink" href="#compute-and-plot-the-global-variability-of-seasonal-xch-4" title="Link to this heading">#</a></h3>
<p>To show how data coverage varies between years and seasons, in this section we plot the spatial average XCH<span class="math notranslate nohighlight">\(_4\)</span> values for seasons and years. To limit the number of plots produced, this analysis is limited to the period 2013-2022. Seasons are defined as: December-February (DJF), March-May (MAM), June-August (JJA), and September-November (SON). The seasonality of the availability of measurements is evident, with values available in the Southern Hemisphere (SH) mid and high latitudes from September to March, whereas values for the Northern Hemisphere (NH) mid and high latitudes are mostly available from April to August.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Analysis of global variability of seasonal XCH4</span>
<span class="c1"># To invalidate the cache you can pass the argument invalidate_cache=True</span>
<span class="n">ds_seasonal</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_seasonal_timeseries_nomask</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;year_start&quot;</span><span class="p">:</span> <span class="n">year_start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;year_stop&quot;</span><span class="p">:</span> <span class="n">year_stop</span><span class="p">},</span>
<span class="p">)</span>
<span class="n">ds_seasonal</span> <span class="o">=</span> <span class="n">ds_seasonal</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">year_start</span><span class="p">,</span> <span class="n">year_stop</span><span class="p">))</span>

<span class="n">da</span> <span class="o">=</span> <span class="n">ds_seasonal</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
<span class="n">da</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">da</span> <span class="o">&lt;</span> <span class="mf">1.0e4</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">da</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(),</span>
    <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/1 [00:00&lt;?, ?it/s]/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/duck_array_ops.py:237: RuntimeWarning: invalid value encountered in cast
  return data.astype(dtype, **kwargs)
100%|██████████| 1/1 [00:01&lt;00:00,  1.74s/it]
</pre></div>
</div>
<img alt="../../_images/0f148b1eed9e5504d64b26c58ad54b526d3d60636bede3e4feb8bb1f3847c696.png" src="../../_images/0f148b1eed9e5504d64b26c58ad54b526d3d60636bede3e4feb8bb1f3847c696.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/nputils.py:256: RankWarning: Polyfit may be poorly conditioned
  warn_on_deficient_rank(rank, x.shape[1])
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/nputils.py:256: RankWarning: Polyfit may be poorly conditioned
  warn_on_deficient_rank(rank, x.shape[1])
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/nputils.py:256: RankWarning: Polyfit may be poorly conditioned
  warn_on_deficient_rank(rank, x.shape[1])
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/nputils.py:256: RankWarning: Polyfit may be poorly conditioned
  warn_on_deficient_rank(rank, x.shape[1])
/data/common/miniforge3/envs/wp5/lib/python3.11/site-packages/xarray/core/nputils.py:256: RankWarning: Polyfit may be poorly conditioned
  warn_on_deficient_rank(rank, x.shape[1])
</pre></div>
</div>
</div>
</div>
<p><em>Global annual variability of seasonal XCH<span class="math notranslate nohighlight">\(_4\)</span>, over 2013-2022. The different panels represent the individual seasons (column) and years (rows). Seasons are defined as: December-February (DJF), March-May (MAM), June-August (JJA), and September-November (SON).</em></p>
</section>
<section id="compute-global-and-spatial-trends">
<span id="satellite-satellite-methane-completeness-q03-template-section-4"></span><h3>4. Compute global and spatial trends<a class="headerlink" href="#compute-global-and-spatial-trends" title="Link to this heading">#</a></h3>
<p>In this section, XCH<span class="math notranslate nohighlight">\(_4\)</span> spatial trends are calculated and statistical significance is assessed for land pixels (“land_fraction &gt; 0.5”). Global statistics for individual pixels are also reported as ppb/month. Please note that the low growth rates observed in the tropics are associated with high statistical errors in trend calculations. This is probably due to the frequent presence of clouds resulting in sparse data availability. Over Greenland, however, high retrieval uncertainty may be a factor due to the high surface albedo.</p>
<p>For 2013-2022, the mean global XCH<span class="math notranslate nohighlight">\(_4\)</span> growth rate is 9.71 <span class="math notranslate nohighlight">\(\pm\)</span> 2.21 ppb/yr (<span class="math notranslate nohighlight">\(\pm\)</span> standard error of the trend calculation). Taking into account the associated uncertainties, the different calculation methods and the different vertical representativeness of satellite observations with respect to near-surface measurements, this value is reasonably consistent with the mean absolute increase of 10.20 ppb/yr over the past 10 years, as reported by the WMO’s global in-situ observations <a class="reference external" href="https://library.wmo.int/idurl/4/68532">[1]</a>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculation of global and pixel trends</span>
<span class="c1">#To invalidate the cache you can pass the argument invalidate_cache=True</span>
<span class="n">ds_trend</span> <span class="o">=</span> <span class="n">download</span><span class="o">.</span><span class="n">download_and_transform</span><span class="p">(</span>
    <span class="o">*</span><span class="n">request</span><span class="p">,</span>
    <span class="n">transform_func</span><span class="o">=</span><span class="n">compute_anomaly_trends</span><span class="p">,</span>
    <span class="n">transform_func_kwargs</span><span class="o">=</span><span class="n">transform_func_kwargs</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">ds_trend</span><span class="p">[</span><span class="s2">&quot;trend&quot;</span><span class="p">],</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span>
<span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span>
    <span class="n">ds_trend</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span>
    <span class="n">plot_func</span><span class="o">=</span><span class="s2">&quot;contourf&quot;</span><span class="p">,</span>
    <span class="n">show_stats</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">hatches</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span> <span class="o">*</span> <span class="mi">5</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot; Trend </span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:03&lt;00:00,  3.63s/it]
</pre></div>
</div>
<img alt="../../_images/98d517c6748ad55aaebbd7ae2091ffe48a0a8dee1f72f5cb9e76d64d08a9e67e.png" src="../../_images/98d517c6748ad55aaebbd7ae2091ffe48a0a8dee1f72f5cb9e76d64d08a9e67e.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">ds_trend</span><span class="p">[</span><span class="s2">&quot;std_error&quot;</span><span class="p">],</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot; Standard error of trend </span><span class="si">{</span><span class="n">year_start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">year_stop</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/98dc5b932a69b3cf4321e8dac565b3ab4fcf8ce753362ca68c122b32f3499e12.png" src="../../_images/98dc5b932a69b3cf4321e8dac565b3ab4fcf8ce753362ca68c122b32f3499e12.png" />
</div>
</div>
<p><em>Trends (upper map) and related standard error (bottom map) of XCH<span class="math notranslate nohighlight">\(_4\)</span> given in ppb/month calculated by using linear model (Theil-Sen) and Mann-Kendall test for statistical significance. Over each pixel, trends are calculated for monthly anomalies over land (“land_fraction &gt; 0.5”). In the upper map, any shaded areas indicate pixels that did not pass the Mann-Kendall significance test. Global statistics for individual pixels are shown on the right of the plot.</em></p>
</section>
<section id="analysis-concerning-xch-4-uncertainties">
<span id="satellite-satellite-methane-completeness-q03-template-section-5"></span><h3>5. Analysis concerning XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties<a class="headerlink" href="#analysis-concerning-xch-4-uncertainties" title="Link to this heading">#</a></h3>
<section id="global-maps-of-xch-4-uncertainties">
<h4>Global maps of XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties<a class="headerlink" href="#global-maps-of-xch-4-uncertainties" title="Link to this heading">#</a></h4>
<p>In this section, we show the multi-year (for the 2015-2020 period) global maps of the XCH<span class="math notranslate nohighlight">\(_4\)</span> reported uncertainties, i.e., the “xch4_stderr” variable. This parameter is defined as the standard error of the average including single sounding noise and potential seasonal and regional biases <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[4]</a>. The yearly averages are calculated by averaging the monthly values provided by the considered dataset. Throughout all the selected years some features emerge, with higher uncertainties mainly over the Himalayas, South Asia, high latitudes, and the tropical rainforest zone. This is mainly due to the sparseness in sampling because of frequent cloud cover, as well as large solar zenith angles in high latitudes, which are a challenge for accurate XCH<span class="math notranslate nohighlight">\(_4\)</span> retrievals <a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020">[5]</a>. It is worth noting that regions characterised by large uncertainties were also affected by spatial trends that deviated from the global average (see the previous figure). Users should therefore exercise caution when deriving long-term trends for regions affected by high uncertainty.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_range</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;2015&quot;</span><span class="p">,</span> <span class="s2">&quot;2020&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;global&quot;</span><span class="p">]:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">region</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_range</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xch4_stderr&quot;</span><span class="p">]:</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">diagnostics</span><span class="o">.</span><span class="n">annual_weighted_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">])</span>
        <span class="n">facet</span> <span class="o">=</span> <span class="n">plot</span><span class="o">.</span><span class="n">projected_map</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="w"> </span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">variable</span><span class="w"> </span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/b1847b230328ebf2f22967086b9402e909e8f6b18ab32bd79b8bdcce102e18bc.png" src="../../_images/b1847b230328ebf2f22967086b9402e909e8f6b18ab32bd79b8bdcce102e18bc.png" />
</div>
</div>
<p><em>Multi-year global distribution of XCH<span class="math notranslate nohighlight">\(_4\)</span> standard error (from 2015 to 2020), derived from the XCH4_OBS4MIPS dataset (version 4.5). The title indicates the spatial region and the selected variable.</em></p>
</section>
<section id="time-series-analysis-for-the-different-variables">
<h4>Time series analysis for the different variables<a class="headerlink" href="#time-series-analysis-for-the-different-variables" title="Link to this heading">#</a></h4>
<p>In this section, we show the time series for three XCH<span class="math notranslate nohighlight">\(_4\)</span> variables (i.e., “xch4”, “xch4_stderr”, and “xch4_nobs”), considering the entire dataset. For each variable, each plot displays the monthly global spatial average, along with the corresponding monthly standard deviation (except for “xch4_nobs”).
This analysis would provide the user with:</p>
<ul class="simple">
<li><p>the global time series of XCH<span class="math notranslate nohighlight">\(_4\)</span> values (“xch4”), highlighting the overall positive trend;</p></li>
<li><p>the change over time of the uncertainty associated to the XCH<span class="math notranslate nohighlight">\(_4\)</span> values (“xch4_stderr”);</p></li>
<li><p>the time series of “xch4_nobs”, which denotes the number of individual XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 2 observations used to compute the monthly Level 3 data.</p></li>
</ul>
<p>The XCH<span class="math notranslate nohighlight">\(_4\)</span> values have been nearly constant until 2007, then a positive trend has been detected. This is likely due to a combination of increasing natural (e.g., wetlands) and anthropogenic (e.g., fossil-fuel related) emissions, and possible decreasing sinks, although this is currently under investigation (see <a class="reference external" href="https://doi.org/10.5194/essd-2024-115">[3]</a> and references therein).</p>
<p>By looking at the uncertainties (“xch4_stderr”), the most evident feature is the sharp decrease after 2009, likely due to the introduction of algorithms based on GOSAT observations used to calculate the median XCH<span class="math notranslate nohighlight">\(_4\)</span> data <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a>. A further increase in the uncertainties is observed from 2020 onwards, and this is probably linked to the introduction of GOSAT-2 measurements <a class="reference external" href="http://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a>.</p>
<p>The temporal variability of “xch4_nobs” traces the changes over time of the input data availability, and the number of used algorithms to obtain the merged Level 2 data products, from which the Obs4MIPs product is derived (please note that the standard deviations have not been reported for “xch4_nobs” to increase the plot readability). The first time period (up to April 2009) is characterized by a significant number of observations by the SCIAMACHY WFMD product only. The following period (up to 2022) reflects the reduced number of soundings provided by SCIAMACHY with the contributions from GOSAT and GOSAT-2 (from January 2019). For details about the different Level 2 products used as input for the generation of the Level 3 XCH<span class="math notranslate nohighlight">\(_4\)</span> data, see <a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020">[5]</a> and <a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a>.</p>
<p>Please note that this analysis can be customized by the user to limit it to specific regions, or to include one additional variable (not shown here): “xch4_stddev”, which represents the standard deviation of the XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 2 observations within each grid box.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;xch4&quot;</span><span class="p">,</span> <span class="s2">&quot;xch4_stderr&quot;</span><span class="p">,</span> <span class="s2">&quot;xch4_nobs&quot;</span><span class="p">]:</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">stds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">da</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_mean</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
        <span class="n">stds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">spatial_weighted_std</span><span class="p">(</span><span class="n">da</span><span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="p">[</span><span class="n">region</span><span class="p">]))</span>
    <span class="n">da_mean</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
    <span class="n">da_std</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">stds</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>

    <span class="n">facet</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">sel_dict</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">facet</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">facet</span><span class="o">.</span><span class="n">name_dicts</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;xch4_nobs&quot;</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">da_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span> <span class="o">-</span> <span class="n">da_std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">da</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">],</span>
            <span class="n">lower</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lower</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">da_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span> <span class="o">+</span> <span class="n">da_std</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># If variaable is xco2_nobs, use log scale for y-axis</span>
        <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s2">&quot;xch4_nobs&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
            <span class="c1">#ax.set_ylabel(&quot;n observations&quot;)</span>
            <span class="c1"># Imposta tick logaritmici automatici</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogLocator</span><span class="p">,</span> <span class="n">NullFormatter</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">LogLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">subs</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">facet</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.01</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../../_images/0aec55df0b622696b56839d9c9670e0432923ee546102db7a9341d17c54be70c.png" src="../../_images/0aec55df0b622696b56839d9c9670e0432923ee546102db7a9341d17c54be70c.png" />
<img alt="../../_images/e50a327b9b4ec9ea4ace3f81dc8980d064a599eb8cb25b734641576f706bcd01.png" src="../../_images/e50a327b9b4ec9ea4ace3f81dc8980d064a599eb8cb25b734641576f706bcd01.png" />
<img alt="../../_images/712b3498b8aafd513ef8521353b4a43f39034c2f03b585c80631b84d8a7d169c.png" src="../../_images/712b3498b8aafd513ef8521353b4a43f39034c2f03b585c80631b84d8a7d169c.png" />
</div>
</div>
<p><em>Global monthly time series of XCH<span class="math notranslate nohighlight">\(_4\)</span> (top panel) and their associated uncertainties (middle panel) for the entire dataset. The blue lines represent the monthly spatial average, while the shaded areas indicate <span class="math notranslate nohighlight">\(\pm\)</span>1 standard deviation. The bottom panel shows the time series of monthly spatial average of the number of individual XCH<span class="math notranslate nohighlight">\(_4\)</span> Level 2 observations used to compute Obs4MIPs (Level 3) data. The main titles indicate the variable shown, while the subtitles specify the corresponding region.</em></p>
</section>
</section>
</section>
<section id="i-if-you-want-to-know-more">
<h2>ℹ️ If you want to know more<a class="headerlink" href="#i-if-you-want-to-know-more" title="Link to this heading">#</a></h2>
<section id="key-resources">
<h3>Key resources<a class="headerlink" href="#key-resources" title="Link to this heading">#</a></h3>
<p>The CDS catalogue entries for the data used were:</p>
<ul class="simple">
<li><p>Methane data from 2002 to present derived from satellite observations: <a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview">https://cds.climate.copernicus.eu/datasets/satellite-methane?tab=overview</a></p></li>
</ul>
<p>Code libraries used:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/bopen/c3s-eqc-automatic-quality-control/tree/main/c3s_eqc_automatic_quality_control">C3S EQC custom functions</a>, <code class="docutils literal notranslate"><span class="pre">c3s_eqc_automatic_quality_control</span></code>,  prepared by <a class="reference external" href="https://www.bopen.eu/">B-Open</a></p></li>
</ul>
<p>Users interested in obtaining updated figures for methane growth rates and global trends are directed to official C3S sources for precise reporting: <a class="reference external" href="https://doi.org/10.24381/14j9-s541">[7]</a>, <a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024">[8]</a>.</p>
<p>Users interested in near-real time detection of hot-spot locations for methane emissions can consider to use the CAMS Methane Hotspot Explorer: <a class="reference external" href="https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;amp;utm_medium=referral&amp;amp;utm_campaign=CH4-app-2025">https://atmosphere.copernicus.eu/ghg-services/cams-methane-hotspot-explorer?utm_source=press&amp;utm_medium=referral&amp;utm_campaign=CH4-app-2025</a></p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://library.wmo.int/idurl/4/68532">[1]</a> World Meteorological Organization (2023). WMO Greenhouse Gas Bulletin, No. 19, ISSN 2078-0796.</p>
<p><a class="reference external" href="https://doi.org/10.1073/pnas.0600201103">[2]</a> West, J. J., Fiore, A. M., Horowitz, L. W., and Mauzerall, D. L. (2006). Global health benefits of mitigating ozone pollution with methane emission controls. Proceedings of the National Academy of Sciences USA, 103, 3988–3993.</p>
<p><a class="reference external" href="https://doi.org/10.5194/essd-2024-115">[3]</a> Saunois, M., Martinez, A., Poulter, B., Zhang, Z., Raymond, P., Regnier, P., Canadell, J. G., Jackson, R. B., Patra, P. K., Bousquet, P., Ciais, P., Dlugokencky, E. J., Lan, X., Allen, G. H., Bastviken, D., Beerling, D. J., Belikov, D. A., Blake, D. R., Castaldi, S., Crippa, M., Deemer, B. R., Dennison, F., Etiope, G., Gedney, N., Höglund-Isaksson, L., Holgerson, M. A., Hopcroft, P. O., Hugelius, G., Ito, A., Jain, A. K., Janardanan, R., Johnson, M. S., Kleinen, T., Krummel, P., Lauerwald, R., Li, T., Liu, X., McDonald, K. C., Melton, J. R., Mühle, J., Müller, J., Murguia-Flores, F., Niwa, Y., Noce, S., Pan, S., Parker, R. J., Peng, C., Ramonet, M., Riley, W. J., Rocher-Ros, G., Rosentreter, J. A., Sasakawa, M., Segers, A., Smith, S. J., Stanley, E. H., Thanwerdas, J., Tian, H., Tsuruta, A., Tubiello, F. N., Weber, T. S., van der Werf, G., Worthy, D. E., Xi, Y., Yoshida, Y., Zhang, W., Zheng, B., Zhu, Q., Zhu, Q., and Zhuang, Q. (2024). Global Methane Budget 2000–2020, Earth System Science Data Discussion, in review.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_PUGS_GHG_main_latest.pdf">[4]</a> Buchwitz, M. (2024). Product User Guide and Specification (PUGS) – Main document for Greenhouse Gas (GHG: CO<span class="math notranslate nohighlight">\(_2\)</span> &amp; CH<span class="math notranslate nohighlight">\(_4\)</span>) data set CDR7 (01.2003-12.2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.3.</p>
<p><a class="reference external" href="https://doi.org/10.5194/amt-13-789-2020">[5]</a> Reuter, M., Buchwitz, M., Schneising, O., Noël, S., Bovensmann, H., Burrows, J. P., Boesch, H., Di Noia, A., Anand, J., Parker, R. J., Somkuti, P., Wu, L., Hasekamp, O. P., Aben, I., Kuze, A., Suto, H., Shiomi, K., Yoshida, Y., Morino, I., Crisp, D., O’Dell, C. W., Notholt, J., Petri, C., Warneke, T., Velazco, V. A., Deutscher, N. M., Griffith, D. W. T., Kivi, R., Pollard, D. F., Hase, F., Sussmann, R., Té, Y. V., Strong, K., Roche, S., Sha, M. K., De Mazière, M., Feist, D. G., Iraci, L. T., Roehl, C. M., Retscher, C., and Schepers, D. (2020). Ensemble-based satellite-derived carbon dioxide and methane column-averaged dry-air mole fraction data sets (2003–2018) for carbon and climate applications, Atmospheric Measurement Techniques, 13, 789–819.</p>
<p><a class="reference external" href="https://wdc.dlr.de/C3S_312b_Lot2/Documentation/GHG/C3S2_312a_Lot2_ATBD_GHG_D_latest.pdf">[6]</a> Reuter,M. and Buchwitz, M. (2024). Algorithm Theoretical Basis Document (ATBD) – ANNEX D for products XCO2_EMMA, XCH4_EMMA, XCO2_OBS4MIPS, XCH4_OBS4MIPS (v4.5, CDR7, 2003-2022), C3S project 2021/C3S2_312a_Lot2_DLR/SC1, v7.1b.</p>
<p><a class="reference external" href="https://doi.org/10.24381/14j9-s541">[7]</a> Copernicus Climate Change Service (C3S) and World Meteorological Organization (WMO). (2025). European State of the Climate 2024. <a class="reference external" href="https://doi.org/10.24381/14j9-s541">https://doi.org/10.24381/14j9-s541</a></p>
<p><a class="reference external" href="https://climate.copernicus.eu/global-climate-highlights-2024">[8]</a> Copernicus Climate Change Service (C3S). (2025). Global Climate Highlights 2024.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Satellite_ECVs/Atmospheric_Composition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="satellite_satellite-carbon-dioxide_trend-assessment_q01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1.2.1. </span>Carbon dioxide satellite observations completeness assessment for greenhouse gas monitoring</p>
      </div>
    </a>
    <a class="right-next"
       href="satellite_satellite-methane_uncertainty_q01.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1.2.3. </span>Methane satellite observations uncertainty and completeness assessment for carbon cycle</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-using-satellite-observations-for-quantifying-global-trends-and-uncertainties-in-greenhouse-gas-concentrations">🌍 Use case: Using satellite observations for quantifying global trends and uncertainties in greenhouse gas concentrations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-questions">❓ Quality assessment questions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quality-assessment-statements">📢 Quality assessment statements</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">📋 Methodology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-and-results">📈 Analysis and results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-data-to-use-and-set-up-the-code">1. Choose the data to use and set-up the code</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#import-all-relevant-packages">Import all relevant packages</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-temporal-and-spatial-coverage-land-mask">Choose temporal and spatial coverage, land mask</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chache-needed-functions">Chache needed functions</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-xch-4-data-obs4mips">2. Retrieve XCH<span class="math notranslate nohighlight">\(_4\)</span> data (Obs4MIPs)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-and-plot-the-global-variability-of-seasonal-xch-4">3. Compute and plot the global variability of seasonal XCH<span class="math notranslate nohighlight">\(_4\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-global-and-spatial-trends">4. Compute global and spatial trends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-concerning-xch-4-uncertainties">5. Analysis concerning XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-maps-of-xch-4-uncertainties">Global maps of XCH<span class="math notranslate nohighlight">\(_4\)</span> uncertainties</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#time-series-analysis-for-the-different-variables">Time series analysis for the different variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-if-you-want-to-know-more">ℹ️ If you want to know more</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-resources">Key resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>